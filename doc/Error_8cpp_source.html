<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CUBRID Engine: src/oledb/Error.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CUBRID Engine
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('Error_8cpp_source.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Error.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="Error_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * Copyright (C) 2008 Search Solution Corporation. All rights reserved by Search Solution. </span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> * Redistribution and use in source and binary forms, with or without modification, </span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> * are permitted provided that the following conditions are met: </span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> * - Redistributions of source code must retain the above copyright notice, </span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> *   this list of conditions and the following disclaimer. </span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> * - Redistributions in binary form must reproduce the above copyright notice, </span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> *   this list of conditions and the following disclaimer in the documentation </span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> *   and/or other materials provided with the distribution. </span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> * - Neither the name of the &lt;ORGANIZATION&gt; nor the names of its contributors </span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> *   may be used to endorse or promote products derived from this software without </span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> *   specific prior written permission. </span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"> * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND </span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment"> * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED </span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"> * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. </span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment"> * IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, </span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment"> * INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, </span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment"> * BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, </span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment"> * OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, </span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment"> * WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) </span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment"> * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY </span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment"> * OF SUCH DAMAGE. </span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="oledb_2stdafx_8h.html">stdafx.h</a>&quot;</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="Error_8h.html">Error.h</a>&quot;</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="DataSource_8h.html">DataSource.h</a>&quot;</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment"> * ISQLErrorInfo는 custom error object</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment"> * (IErrorRecords::AddErrorRecord의 4번째 인자)</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment"> * 를 통해 지원한다.</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment"> * DISPPARAMS를 사용하면 좀 더 자세한 메시지를 만들 때 사용할 수 있다.</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment"> * 예를 들어 dwMinor에 1을 주고, pszText에 &#39;abcd&#39;를 주었다고 하자.</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment"> * IErrorLookup::GetErrorDescription 구현시 인자의 dwLookupID가 1이면  * DISPPARAMS를 읽어서(&#39;abcd&#39;가 들어있다) &#39;abcd를 열수 없음&#39;과 같은
 * 메시지를 생성해 consumer로 전달하게 할 수 있다.
 *
 * IErrorLookup::GetErrorDescription의 lcid는 로케일을 가리킨다.
 * 예를 들어 미국 영어는 0x0409, 한국어는 0x0412이다.
 * 이를 통해 원하는 언어로 에러 메시지를 생성할 수 있다.
 */
/*
 * TODO: 현재 iid를 RaiseError()시 설정하고 있다.
 *  여러 인터페이스에서 공통으로 쓰는 함수가 있으면 제대로 된 값을 설정할 수 없다.
 *  ClearError()시 iid를 받아서 저장해 두었다가
 *  RaiseError()시 사용하는 방법을 생각할 수 있다.
 *  다만 Thread등의 문제가 없는지 생각해 봐야 한다.
 */

void ClearError()
{
    SetErrorInfo(0, NULL);
}

HRESULT RaiseError(ERRORINFO &amp;info, CComVariant &amp;var, BSTR bstrSQLState)
{
    CComPtr&lt;IErrorInfo&gt; spErrorInfo;
    GetErrorInfo(0, &amp;spErrorInfo);

    // 에러 객체가 없으면 생성한다.
    // 에러 객체는 MDAC SDK가 제공한다.
    if(spErrorInfo==NULL)
        spErrorInfo.CoCreateInstance(CLSID_EXTENDEDERRORINFO,
                                    NULL, CLSCTX_INPROC_SERVER);

    // 추가할 에러
    DISPPARAMS dispparams = { NULL, NULL, 0, 0 };
    if(V_VT(&amp;var)!=VT_EMPTY)
    {
        dispparams.rgvarg = &amp;var;
        dispparams.cArgs = 1;
    }

    CComPtr&lt;IUnknown&gt; spSQLInfo;
    if(bstrSQLState)
    {
        CComPolyObject&lt;CCUBRIDErrorInfo&gt; *pObj;
        CComPolyObject&lt;CCUBRIDErrorInfo&gt;::CreateInstance(NULL, &amp;pObj);

        CCUBRIDErrorInfo *pSQLInfo = &amp;(pObj-&gt;m_contained);
        pSQLInfo-&gt;m_bstrSQLState = bstrSQLState;
        pSQLInfo-&gt;m_lNativeError = info.dwMinor;

        pSQLInfo-&gt;QueryInterface(__uuidof(IUnknown), (void **)&amp;spSQLInfo);
    }

    // IErrorRecords의 포인터를 구해서 에러를 추가한다.
    CComPtr&lt;IErrorRecords&gt; spErrorRecords;
    spErrorInfo-&gt;QueryInterface(__uuidof(IErrorRecords), (void **)&amp;spErrorRecords);
    spErrorRecords-&gt;AddErrorRecord(&amp;info, info.dwMinor, &amp;dispparams, spSQLInfo, 0);

    // 에러 객체 등록
 SetErrorInfo(0, spErrorInfo);

    return info.hrError;
}

HRESULT RaiseError(HRESULT hrError, DWORD dwMinor, IID iid, CComVariant &amp;var, BSTR bstrSQLState)
{
    ERRORINFO info;
    info.hrError = hrError;
    info.dwMinor = dwMinor;
    info.clsid = CCUBRIDDataSource::GetObjectCLSID();
    info.iid = iid;
    info.dispid = 0;
    return RaiseError(info, var, bstrSQLState);
}

HRESULT RaiseError(HRESULT hrError, DWORD dwMinor, IID iid, LPCSTR pszText, BSTR bstrSQLState)
{
    CComVariant var;
    if(pszText) var = pszText;
    return RaiseError(hrError, dwMinor, iid, var, bstrSQLState);
}

HRESULT RaiseError(HRESULT hrError, DWORD dwMinor, IID iid, LPWSTR pwszText, BSTR bstrSQLState)
{
    CComVariant var;
    if(pwszText) var = pwszText;
    return RaiseError(hrError, dwMinor, iid, var, bstrSQLState);
}

static LPOLESTR GetErrorDescriptionString(HRESULT hr)
{
    // 다음은 conformance tests의 cexterr.cpp에서 가져왔다.
    static struct
    {
        HRESULT hr;
        LPOLESTR str;
    } desc[] = {
        { E_UNEXPECTED, OLESTR(&quot;Catastrophic failure&quot;) },
        { E_FAIL, OLESTR(&quot;A provider-specific error occurred&quot;) },
        { E_NOINTERFACE, OLESTR(&quot;No such interface supported&quot;) },
        { E_INVALIDARG, OLESTR(&quot;The parameter is incorrect.&quot;) },
        { DB_E_BADACCESSORHANDLE, OLESTR(&quot;Accessor is invalid.&quot;) },
        { DB_E_ROWLIMITEXCEEDED, OLESTR(&quot;Row could not be inserted into the rowset without exceeding provider&#39;s maximum number of active rows.&quot;) },
        { DB_E_READONLYACCESSOR, OLESTR(&quot;Accessor is read-only. Operation failed.&quot;) },
        { DB_E_SCHEMAVIOLATION, OLESTR(&quot;Given values violate the database schema.&quot;) },
        { DB_E_BADROWHANDLE, OLESTR(&quot;Row handle is invalid.&quot;) },
        { DB_E_OBJECTOPEN, OLESTR(&quot;Object was open.&quot;) },
        { DB_E_BADCHAPTER, OLESTR(&quot;Chapter is invalid.&quot;) },
        { DB_E_CANTCONVERTVALUE, OLESTR(&quot;Data or literal value could not be converted to the type of the column in the data source, and the provider was unable to determine which columns could not be converted.  Data overflow or sign mismatch was not the cause.&quot;) },
        { DB_E_BADBINDINFO, OLESTR(&quot;Binding information is invalid.&quot;) },
        { DB_SEC_E_PERMISSIONDENIED, OLESTR(&quot;Permission denied.&quot;) },
        { DB_E_NOTAREFERENCECOLUMN, OLESTR(&quot;Specified column does not contain bookmarks or chapters.&quot;) },
        { DB_E_LIMITREJECTED, OLESTR(&quot;Cost limits were rejected.&quot;) },
        { DB_E_NOCOMMAND, OLESTR(&quot;Command text was not set for the command object.&quot;) },
        { DB_E_COSTLIMIT, OLESTR(&quot;Query plan within the cost limit cannot be found.&quot;) },
        { DB_E_BADBOOKMARK, OLESTR(&quot;Bookmark is invalid.&quot;) },
        { DB_E_BADLOCKMODE, OLESTR(&quot;Lock mode is invalid.&quot;) },
        { DB_E_PARAMNOTOPTIONAL, OLESTR(&quot;No value given for one or more required parameters.&quot;) },
        { DB_E_BADCOLUMNID, OLESTR(&quot;Column ID is invalid.&quot;) },
        { DB_E_BADRATIO, OLESTR(&quot;Numerator was greater than denominator. Values must express ratio between zero and 1.&quot;) },
        { DB_E_BADVALUES, OLESTR(&quot;Value is invalid.&quot;) },
        { DB_E_ERRORSINCOMMAND, OLESTR(&quot;One or more errors occurred during processing of command.&quot;) },
        { DB_E_CANTCANCEL, OLESTR(&quot;Command cannot be canceled.&quot;) },
        { DB_E_DIALECTNOTSUPPORTED, OLESTR(&quot;Command dialect is not supported by this provider.&quot;) },
        { DB_E_DUPLICATEDATASOURCE, OLESTR(&quot;Data source object could not be created because the named data source already exists.&quot;) },
        { DB_E_CANNOTRESTART, OLESTR(&quot;The rowset was built over a live data feed and cannot be restarted.&quot;) },
        { DB_E_NOTFOUND, OLESTR(&quot;No key matching the described characteristics could be found within the current range.&quot;) },
        { DB_E_NEWLYINSERTED, OLESTR(&quot;Identity cannot be determined for newly inserted rows.&quot;) },
        { DB_E_CANNOTFREE, OLESTR(&quot;Provider has ownership of this tree.&quot;) },
        { DB_E_GOALREJECTED, OLESTR(&quot;Goal was rejected because no nonzero weights were specified for any goals supported. Current goal was not changed.&quot;) },
        { DB_E_UNSUPPORTEDCONVERSION, OLESTR(&quot;Requested conversion is not supported.&quot;) },
        { DB_E_BADSTARTPOSITION, OLESTR(&quot;Goal was rejected because no nonzero weights were specified for any goals supported. Current goal was not changed.&quot;) },
        { DB_E_NOQUERY, OLESTR(&quot;Information was requested for a query, and the query was not set.&quot;) },
        { DB_E_NOTREENTRANT, OLESTR(&quot;Consumer&#39;s event handler called a non-reentrant method in the provider.&quot;) },
        { DB_E_ERRORSOCCURRED, OLESTR(&quot;Multiple-step OLE DB operation generated errors. Check each OLE DB status value, if available. No work was done.&quot;) },
        { DB_E_NOAGGREGATION, OLESTR(&quot;Non-NULL controlling IUnknown was specified, and either the requested interface was not IUnknown, or the provider does not support COM aggregation.&quot;) },
        { DB_E_DELETEDROW, OLESTR(&quot;Row handle referred to a deleted row or a row marked for deletion.&quot;) },
        { DB_E_CANTFETCHBACKWARDS, OLESTR(&quot;The rowset does not support fetching backwards.&quot;) },
        { DB_E_ROWSNOTRELEASED, OLESTR(&quot;Row handles must all be released before new ones can be obtained.&quot;) },
        { DB_E_BADSTORAGEFLAG, OLESTR(&quot;One or more storage flags are not supported.&quot;) },
        { DB_E_BADCOMPAREOP, OLESTR(&quot;Comparison operator is invalid.&quot;) },
        { DB_E_BADSTATUSVALUE, OLESTR(&quot;The specified status flag was neither DBCOLUMNSTATUS_OK nor DBCOLUMNSTATUS_ISNULL.&quot;) },
        { DB_E_CANTSCROLLBACKWARDS, OLESTR(&quot;Rowset does not support scrolling backward.&quot;) },
        { DB_E_BADREGIONHANDLE, OLESTR(&quot;Region handle is invalid.&quot;) },
        { DB_E_NONCONTIGUOUSRANGE, OLESTR(&quot;Set of rows is not contiguous to, or does not overlap, the rows in the watch region.&quot;) },
        { DB_E_INVALIDTRANSITION, OLESTR(&quot;A transition from ALL* to MOVE* or EXTEND* was specified.&quot;) },
        { DB_E_NOTASUBREGION, OLESTR(&quot;The specified region is not a proper subregion of the region identified by the given watch region handle.&quot;) },
        { DB_E_MULTIPLESTATEMENTS, OLESTR(&quot;Multiple-statement commands are not supported by this provider.&quot;) },
        { DB_E_INTEGRITYVIOLATION, OLESTR(&quot;A specified value violated the integrity constraints for a column or table.&quot;) },
        { DB_E_BADTYPENAME, OLESTR(&quot;Type name is invalid.&quot;) },
        { DB_E_ABORTLIMITREACHED, OLESTR(&quot;Execution stopped because a resource limit was reached. No results were returned.&quot;) },
        { DB_E_ROWSETINCOMMAND, OLESTR(&quot;Command object whose command tree contains a rowset or rowsets cannot be cloned.&quot;) },
        { DB_E_CANTTRANSLATE, OLESTR(&quot;Current tree cannot be represented as text.&quot;) },
        { DB_E_DUPLICATEINDEXID, OLESTR(&quot;The specified index already exists.&quot;) },
        { DB_E_NOINDEX, OLESTR(&quot;The specified index does not exist.&quot;) },
        { DB_E_INDEXINUSE, OLESTR(&quot;Index is in use.&quot;) },
        { DB_E_NOTABLE, OLESTR(&quot;The specified table does not exist.&quot;) },
        { DB_E_CONCURRENCYVIOLATION, OLESTR(&quot;The rowset was using optimistic concurrency and the value of a column has been changed since it was last read.&quot;) },
        { DB_E_BADCOPY, OLESTR(&quot;Errors were detected during the copy.&quot;) },
        { DB_E_BADPRECISION, OLESTR(&quot;Precision is invalid.&quot;) },
        { DB_E_BADSCALE, OLESTR(&quot;Scale is invalid.&quot;) },
        { DB_E_BADTABLEID, OLESTR(&quot;Table ID is invalid.&quot;) },
        { DB_E_BADTYPE, OLESTR(&quot;Type is invalid.&quot;) },
        { DB_E_DUPLICATECOLUMNID, OLESTR(&quot;Column ID already exists or occurred more than once in the array of columns.&quot;) },
        { DB_E_DUPLICATETABLEID, OLESTR(&quot;The specified table already exists.&quot;) },
        { DB_E_TABLEINUSE, OLESTR(&quot;Table is in use.&quot;) },
        { DB_E_NOLOCALE, OLESTR(&quot;The specified locale ID was not supported.&quot;) },
        { DB_E_BADRECORDNUM, OLESTR(&quot;Record number is invalid.&quot;) },
        { DB_E_BOOKMARKSKIPPED, OLESTR(&quot;Although the bookmark was validly formed, no row could be found to match it.&quot;) },
        { DB_E_BADPROPERTYVALUE, OLESTR(&quot;Property value is invalid.&quot;) },
        { DB_E_INVALID, OLESTR(&quot;The rowset was not chaptered.&quot;) },
        { DB_E_BADACCESSORFLAGS, OLESTR(&quot;One or more accessor flags were invalid.&quot;) },
        { DB_E_BADSTORAGEFLAGS, OLESTR(&quot;One or more storage flags are invalid.&quot;) },
        { DB_E_BYREFACCESSORNOTSUPPORTED, OLESTR(&quot;Reference accessors are not supported by this provider.&quot;) },
        { DB_E_NULLACCESSORNOTSUPPORTED, OLESTR(&quot;Null accessors are not supported by this provider.&quot;) },
        { DB_E_NOTPREPARED, OLESTR(&quot;The command was not prepared.&quot;) },
        { DB_E_BADACCESSORTYPE, OLESTR(&quot;The specified accessor was not a parameter accessor.&quot;) },
        { DB_E_WRITEONLYACCESSOR, OLESTR(&quot;The given accessor was write-only.&quot;) },
        { DB_SEC_E_AUTH_FAILED, OLESTR(&quot;Authentication failed.&quot;) },
        { DB_E_CANCELED, OLESTR(&quot;Operation was canceled.&quot;) },
        { DB_E_CHAPTERNOTRELEASED, OLESTR(&quot;The rowset was single-chaptered and the chapter was not released.&quot;) },
        { DB_E_BADSOURCEHANDLE, OLESTR(&quot;Source handle is invalid.&quot;) },
        { DB_E_PARAMUNAVAILABLE, OLESTR(&quot;Provider cannot derive parameter information and SetParameterInfo has not been called.&quot;) },
        { DB_E_ALREADYINITIALIZED, OLESTR(&quot;The data source object is already initialized.&quot;) },
        { DB_E_NOTSUPPORTED, OLESTR(&quot;Method is not supported by this provider.&quot;) },
        { DB_E_MAXPENDCHANGESEXCEEDED, OLESTR(&quot;Number of rows with pending changes exceeded the limit.&quot;) },
        { DB_E_BADORDINAL, OLESTR(&quot;The specified column did not exist.&quot;) },
        { DB_E_PENDINGCHANGES, OLESTR(&quot;There are pending changes on a row with a reference count of zero.&quot;) },
        { DB_E_DATAOVERFLOW, OLESTR(&quot;Literal value in the command exceeded the range of the type of the associated column.&quot;) },
        { DB_E_BADHRESULT, OLESTR(&quot;HRESULT is invalid.&quot;) },
        { DB_E_BADLOOKUPID, OLESTR(&quot;Lookup ID is invalid.&quot;) },
        { DB_E_BADDYNAMICERRORID, OLESTR(&quot;DynamicError ID is invalid.&quot;) },
        { DB_E_PENDINGINSERT, OLESTR(&quot;Most recent data for a newly inserted row could not be retrieved because the insert is pending.&quot;) },
        { DB_E_BADCONVERTFLAG, OLESTR(&quot;Conversion flag is invalid.&quot;) },
        { DB_E_OBJECTMISMATCH, OLESTR(&quot;Operation is not allowed to this column type&quot;) },
    };
    for(int i=0;i&lt;sizeof(desc)/sizeof(*desc);i++)
    {
        if(desc[i].hr==hr)
            return desc[i].str;
    }
    return OLESTR(&quot;The Error Description String&quot;);
}

STDMETHODIMP CCUBRIDErrorLookup::GetErrorDescription(HRESULT hrError,
                    DWORD dwLookupID, DISPPARAMS *pdispparams, LCID lcid,
                    BSTR *pbstrSource, BSTR *pbstrDescription)
{
    if(pbstrSource==NULL || pbstrDescription==NULL)
        return E_INVALIDARG;

    CComBSTR strSource = &quot;CUBRIDProvider&quot;;
    *pbstrSource = strSource.Detach();

    CComBSTR strDesc;

    if(dwLookupID==0)
    {
        strDesc = GetErrorDescriptionString(hrError);
    }
    else if(dwLookupID==1) // cci error
    {
        strDesc = V_BSTR(&amp;pdispparams[0].rgvarg[0]);
    }

    *pbstrDescription = strDesc.Detach();

    return S_OK;
}

STDMETHODIMP CCUBRIDErrorLookup::GetHelpInfo(HRESULT hrError, DWORD dwLookupID,
                    LCID lcid, BSTR *pbstrHelpFile, DWORD *pdwHelpContext)
{
    if(pbstrHelpFile==NULL || pdwHelpContext==NULL)
        return E_INVALIDARG;

    *pbstrHelpFile = 0;
    *pdwHelpContext = 0;
    return S_OK;
}

STDMETHODIMP CCUBRIDErrorLookup::ReleaseErrors(const DWORD dwDynamicErrorID)
{
    return S_OK;
}

STDMETHODIMP CCUBRIDErrorInfo::GetSQLInfo(BSTR *pbstrSQLState, LONG *plNativeError)
{
    if(pbstrSQLState) *pbstrSQLState = 0;
    if(plNativeError) *plNativeError = 0;
    if(pbstrSQLState==NULL || plNativeError==NULL)
        return E_INVALIDARG;

    *pbstrSQLState = SysAllocString(m_bstrSQLState);
    if(*pbstrSQLState==NULL)
        return E_OUTOFMEMORY;
    *plNativeError = m_lNativeError;

    return S_OK;
}</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment"> * DISPPARAMS를 읽어서(&#39;abcd&#39;가 들어있다) &#39;abcd를 열수 없음&#39;과 같은</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment"> * 메시지를 생성해 consumer로 전달하게 할 수 있다.</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment"> * IErrorLookup::GetErrorDescription의 lcid는 로케일을 가리킨다.</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment"> * 예를 들어 미국 영어는 0x0409, 한국어는 0x0412이다.</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment"> * 이를 통해 원하는 언어로 에러 메시지를 생성할 수 있다.</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment"> * TODO: 현재 iid를 RaiseError()시 설정하고 있다.</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment"> *  여러 인터페이스에서 공통으로 쓰는 함수가 있으면 제대로 된 값을 설정할 수 없다.</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment"> *  ClearError()시 iid를 받아서 저장해 두었다가</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment"> *  RaiseError()시 사용하는 방법을 생각할 수 있다.</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment"> *  다만 Thread등의 문제가 없는지 생각해 봐야 한다.</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div><div class="line"><a name="l00058"></a><span class="lineno"><a class="line" href="Error_8h.html#a93f7a306ed9bf1f41de89f2afea7f55d">   58</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="Error_8cpp.html#a93f7a306ed9bf1f41de89f2afea7f55d">ClearError</a>()</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;{</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    SetErrorInfo(0, <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;}</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div><div class="line"><a name="l00063"></a><span class="lineno"><a class="line" href="Error_8h.html#a4b0d5ee2f199e34056e394d513404cd3">   63</a></span>&#160;HRESULT <a class="code" href="Error_8cpp.html#afda786ad5a25ec751d57b3b84d89dfec">RaiseError</a>(ERRORINFO &amp;<a class="code" href="namespacebroker__log__top.html#a507e86f36aac24149f6038d40412d19f">info</a>, CComVariant &amp;var, BSTR bstrSQLState)</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;{</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    CComPtr&lt;IErrorInfo&gt; spErrorInfo;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    GetErrorInfo(0, &amp;spErrorInfo);</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="comment">// 에러 객체가 없으면 생성한다.</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="comment">// 에러 객체는 MDAC SDK가 제공한다.</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="keywordflow">if</span>(spErrorInfo==<a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        spErrorInfo.CoCreateInstance(CLSID_EXTENDEDERRORINFO,</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;                                    <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, CLSCTX_INPROC_SERVER);</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="comment">// 추가할 에러</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    DISPPARAMS dispparams = { <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, 0 };</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="keywordflow">if</span>(V_VT(&amp;var)!=VT_EMPTY)</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    {</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        dispparams.rgvarg = &amp;var;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        dispparams.cArgs = 1;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    }</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    CComPtr&lt;IUnknown&gt; spSQLInfo;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="keywordflow">if</span>(bstrSQLState)</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    {</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        CComPolyObject&lt;CCUBRIDErrorInfo&gt; *pObj;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        CComPolyObject&lt;CCUBRIDErrorInfo&gt;::CreateInstance(<a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, &amp;pObj);</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        <a class="code" href="classCCUBRIDErrorInfo.html">CCUBRIDErrorInfo</a> *pSQLInfo = &amp;(pObj-&gt;m_contained);</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        pSQLInfo-&gt;<a class="code" href="classCCUBRIDErrorInfo.html#a48f6ae6f1364994e43522418fe73fe47">m_bstrSQLState</a> = bstrSQLState;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        pSQLInfo-&gt;<a class="code" href="classCCUBRIDErrorInfo.html#aba1561a4f42f0f76924baf2b33ebdb7d">m_lNativeError</a> = <a class="code" href="namespacebroker__log__top.html#a507e86f36aac24149f6038d40412d19f">info</a>.dwMinor;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        pSQLInfo-&gt;QueryInterface(__uuidof(IUnknown), (<span class="keywordtype">void</span> **)&amp;spSQLInfo);</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    }</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="comment">// IErrorRecords의 포인터를 구해서 에러를 추가한다.</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    CComPtr&lt;IErrorRecords&gt; spErrorRecords;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    spErrorInfo-&gt;QueryInterface(__uuidof(IErrorRecords), (<span class="keywordtype">void</span> **)&amp;spErrorRecords);</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    spErrorRecords-&gt;AddErrorRecord(&amp;<a class="code" href="namespacebroker__log__top.html#a507e86f36aac24149f6038d40412d19f">info</a>, <a class="code" href="namespacebroker__log__top.html#a507e86f36aac24149f6038d40412d19f">info</a>.dwMinor, &amp;dispparams, spSQLInfo, 0);</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="comment">// 에러 객체 등록  SetErrorInfo(0, spErrorInfo);

    return info.hrError;
}

HRESULT RaiseError(HRESULT hrError, DWORD dwMinor, IID iid, CComVariant &amp;var, BSTR bstrSQLState)
{
    ERRORINFO info;
    info.hrError = hrError;
    info.dwMinor = dwMinor;
    info.clsid = CCUBRIDDataSource::GetObjectCLSID();
    info.iid = iid;
    info.dispid = 0;
    return RaiseError(info, var, bstrSQLState);
}

HRESULT RaiseError(HRESULT hrError, DWORD dwMinor, IID iid, LPCSTR pszText, BSTR bstrSQLState)
{
    CComVariant var;
    if(pszText) var = pszText;
    return RaiseError(hrError, dwMinor, iid, var, bstrSQLState);
}

HRESULT RaiseError(HRESULT hrError, DWORD dwMinor, IID iid, LPWSTR pwszText, BSTR bstrSQLState)
{
    CComVariant var;
    if(pwszText) var = pwszText;
    return RaiseError(hrError, dwMinor, iid, var, bstrSQLState);
}

static LPOLESTR GetErrorDescriptionString(HRESULT hr)
{
    // 다음은 conformance tests의 cexterr.cpp에서 가져왔다.
    static struct
    {
        HRESULT hr;
        LPOLESTR str;
    } desc[] = {
        { E_UNEXPECTED, OLESTR(&quot;Catastrophic failure&quot;) },
        { E_FAIL, OLESTR(&quot;A provider-specific error occurred&quot;) },
        { E_NOINTERFACE, OLESTR(&quot;No such interface supported&quot;) },
        { E_INVALIDARG, OLESTR(&quot;The parameter is incorrect.&quot;) },
        { DB_E_BADACCESSORHANDLE, OLESTR(&quot;Accessor is invalid.&quot;) },
        { DB_E_ROWLIMITEXCEEDED, OLESTR(&quot;Row could not be inserted into the rowset without exceeding provider&#39;s maximum number of active rows.&quot;) },
        { DB_E_READONLYACCESSOR, OLESTR(&quot;Accessor is read-only. Operation failed.&quot;) },
        { DB_E_SCHEMAVIOLATION, OLESTR(&quot;Given values violate the database schema.&quot;) },
        { DB_E_BADROWHANDLE, OLESTR(&quot;Row handle is invalid.&quot;) },
        { DB_E_OBJECTOPEN, OLESTR(&quot;Object was open.&quot;) },
        { DB_E_BADCHAPTER, OLESTR(&quot;Chapter is invalid.&quot;) },
        { DB_E_CANTCONVERTVALUE, OLESTR(&quot;Data or literal value could not be converted to the type of the column in the data source, and the provider was unable to determine which columns could not be converted.  Data overflow or sign mismatch was not the cause.&quot;) },
        { DB_E_BADBINDINFO, OLESTR(&quot;Binding information is invalid.&quot;) },
        { DB_SEC_E_PERMISSIONDENIED, OLESTR(&quot;Permission denied.&quot;) },
        { DB_E_NOTAREFERENCECOLUMN, OLESTR(&quot;Specified column does not contain bookmarks or chapters.&quot;) },
        { DB_E_LIMITREJECTED, OLESTR(&quot;Cost limits were rejected.&quot;) },
        { DB_E_NOCOMMAND, OLESTR(&quot;Command text was not set for the command object.&quot;) },
        { DB_E_COSTLIMIT, OLESTR(&quot;Query plan within the cost limit cannot be found.&quot;) },
        { DB_E_BADBOOKMARK, OLESTR(&quot;Bookmark is invalid.&quot;) },
        { DB_E_BADLOCKMODE, OLESTR(&quot;Lock mode is invalid.&quot;) },
        { DB_E_PARAMNOTOPTIONAL, OLESTR(&quot;No value given for one or more required parameters.&quot;) },
        { DB_E_BADCOLUMNID, OLESTR(&quot;Column ID is invalid.&quot;) },
        { DB_E_BADRATIO, OLESTR(&quot;Numerator was greater than denominator. Values must express ratio between zero and 1.&quot;) },
        { DB_E_BADVALUES, OLESTR(&quot;Value is invalid.&quot;) },
        { DB_E_ERRORSINCOMMAND, OLESTR(&quot;One or more errors occurred during processing of command.&quot;) },
        { DB_E_CANTCANCEL, OLESTR(&quot;Command cannot be canceled.&quot;) },
        { DB_E_DIALECTNOTSUPPORTED, OLESTR(&quot;Command dialect is not supported by this provider.&quot;) },
        { DB_E_DUPLICATEDATASOURCE, OLESTR(&quot;Data source object could not be created because the named data source already exists.&quot;) },
        { DB_E_CANNOTRESTART, OLESTR(&quot;The rowset was built over a live data feed and cannot be restarted.&quot;) },
        { DB_E_NOTFOUND, OLESTR(&quot;No key matching the described characteristics could be found within the current range.&quot;) },
        { DB_E_NEWLYINSERTED, OLESTR(&quot;Identity cannot be determined for newly inserted rows.&quot;) },
        { DB_E_CANNOTFREE, OLESTR(&quot;Provider has ownership of this tree.&quot;) },
        { DB_E_GOALREJECTED, OLESTR(&quot;Goal was rejected because no nonzero weights were specified for any goals supported. Current goal was not changed.&quot;) },
        { DB_E_UNSUPPORTEDCONVERSION, OLESTR(&quot;Requested conversion is not supported.&quot;) },
        { DB_E_BADSTARTPOSITION, OLESTR(&quot;Goal was rejected because no nonzero weights were specified for any goals supported. Current goal was not changed.&quot;) },
        { DB_E_NOQUERY, OLESTR(&quot;Information was requested for a query, and the query was not set.&quot;) },
        { DB_E_NOTREENTRANT, OLESTR(&quot;Consumer&#39;s event handler called a non-reentrant method in the provider.&quot;) },
        { DB_E_ERRORSOCCURRED, OLESTR(&quot;Multiple-step OLE DB operation generated errors. Check each OLE DB status value, if available. No work was done.&quot;) },
        { DB_E_NOAGGREGATION, OLESTR(&quot;Non-NULL controlling IUnknown was specified, and either the requested interface was not IUnknown, or the provider does not support COM aggregation.&quot;) },
        { DB_E_DELETEDROW, OLESTR(&quot;Row handle referred to a deleted row or a row marked for deletion.&quot;) },
        { DB_E_CANTFETCHBACKWARDS, OLESTR(&quot;The rowset does not support fetching backwards.&quot;) },
        { DB_E_ROWSNOTRELEASED, OLESTR(&quot;Row handles must all be released before new ones can be obtained.&quot;) },
        { DB_E_BADSTORAGEFLAG, OLESTR(&quot;One or more storage flags are not supported.&quot;) },
        { DB_E_BADCOMPAREOP, OLESTR(&quot;Comparison operator is invalid.&quot;) },
        { DB_E_BADSTATUSVALUE, OLESTR(&quot;The specified status flag was neither DBCOLUMNSTATUS_OK nor DBCOLUMNSTATUS_ISNULL.&quot;) },
        { DB_E_CANTSCROLLBACKWARDS, OLESTR(&quot;Rowset does not support scrolling backward.&quot;) },
        { DB_E_BADREGIONHANDLE, OLESTR(&quot;Region handle is invalid.&quot;) },
        { DB_E_NONCONTIGUOUSRANGE, OLESTR(&quot;Set of rows is not contiguous to, or does not overlap, the rows in the watch region.&quot;) },
        { DB_E_INVALIDTRANSITION, OLESTR(&quot;A transition from ALL* to MOVE* or EXTEND* was specified.&quot;) },
        { DB_E_NOTASUBREGION, OLESTR(&quot;The specified region is not a proper subregion of the region identified by the given watch region handle.&quot;) },
        { DB_E_MULTIPLESTATEMENTS, OLESTR(&quot;Multiple-statement commands are not supported by this provider.&quot;) },
        { DB_E_INTEGRITYVIOLATION, OLESTR(&quot;A specified value violated the integrity constraints for a column or table.&quot;) },
        { DB_E_BADTYPENAME, OLESTR(&quot;Type name is invalid.&quot;) },
        { DB_E_ABORTLIMITREACHED, OLESTR(&quot;Execution stopped because a resource limit was reached. No results were returned.&quot;) },
        { DB_E_ROWSETINCOMMAND, OLESTR(&quot;Command object whose command tree contains a rowset or rowsets cannot be cloned.&quot;) },
        { DB_E_CANTTRANSLATE, OLESTR(&quot;Current tree cannot be represented as text.&quot;) },
        { DB_E_DUPLICATEINDEXID, OLESTR(&quot;The specified index already exists.&quot;) },
        { DB_E_NOINDEX, OLESTR(&quot;The specified index does not exist.&quot;) },
        { DB_E_INDEXINUSE, OLESTR(&quot;Index is in use.&quot;) },
        { DB_E_NOTABLE, OLESTR(&quot;The specified table does not exist.&quot;) },
        { DB_E_CONCURRENCYVIOLATION, OLESTR(&quot;The rowset was using optimistic concurrency and the value of a column has been changed since it was last read.&quot;) },
        { DB_E_BADCOPY, OLESTR(&quot;Errors were detected during the copy.&quot;) },
        { DB_E_BADPRECISION, OLESTR(&quot;Precision is invalid.&quot;) },
        { DB_E_BADSCALE, OLESTR(&quot;Scale is invalid.&quot;) },
        { DB_E_BADTABLEID, OLESTR(&quot;Table ID is invalid.&quot;) },
        { DB_E_BADTYPE, OLESTR(&quot;Type is invalid.&quot;) },
        { DB_E_DUPLICATECOLUMNID, OLESTR(&quot;Column ID already exists or occurred more than once in the array of columns.&quot;) },
        { DB_E_DUPLICATETABLEID, OLESTR(&quot;The specified table already exists.&quot;) },
        { DB_E_TABLEINUSE, OLESTR(&quot;Table is in use.&quot;) },
        { DB_E_NOLOCALE, OLESTR(&quot;The specified locale ID was not supported.&quot;) },
        { DB_E_BADRECORDNUM, OLESTR(&quot;Record number is invalid.&quot;) },
        { DB_E_BOOKMARKSKIPPED, OLESTR(&quot;Although the bookmark was validly formed, no row could be found to match it.&quot;) },
        { DB_E_BADPROPERTYVALUE, OLESTR(&quot;Property value is invalid.&quot;) },
        { DB_E_INVALID, OLESTR(&quot;The rowset was not chaptered.&quot;) },
        { DB_E_BADACCESSORFLAGS, OLESTR(&quot;One or more accessor flags were invalid.&quot;) },
        { DB_E_BADSTORAGEFLAGS, OLESTR(&quot;One or more storage flags are invalid.&quot;) },
        { DB_E_BYREFACCESSORNOTSUPPORTED, OLESTR(&quot;Reference accessors are not supported by this provider.&quot;) },
        { DB_E_NULLACCESSORNOTSUPPORTED, OLESTR(&quot;Null accessors are not supported by this provider.&quot;) },
        { DB_E_NOTPREPARED, OLESTR(&quot;The command was not prepared.&quot;) },
        { DB_E_BADACCESSORTYPE, OLESTR(&quot;The specified accessor was not a parameter accessor.&quot;) },
        { DB_E_WRITEONLYACCESSOR, OLESTR(&quot;The given accessor was write-only.&quot;) },
        { DB_SEC_E_AUTH_FAILED, OLESTR(&quot;Authentication failed.&quot;) },
        { DB_E_CANCELED, OLESTR(&quot;Operation was canceled.&quot;) },
        { DB_E_CHAPTERNOTRELEASED, OLESTR(&quot;The rowset was single-chaptered and the chapter was not released.&quot;) },
        { DB_E_BADSOURCEHANDLE, OLESTR(&quot;Source handle is invalid.&quot;) },
        { DB_E_PARAMUNAVAILABLE, OLESTR(&quot;Provider cannot derive parameter information and SetParameterInfo has not been called.&quot;) },
        { DB_E_ALREADYINITIALIZED, OLESTR(&quot;The data source object is already initialized.&quot;) },
        { DB_E_NOTSUPPORTED, OLESTR(&quot;Method is not supported by this provider.&quot;) },
        { DB_E_MAXPENDCHANGESEXCEEDED, OLESTR(&quot;Number of rows with pending changes exceeded the limit.&quot;) },
        { DB_E_BADORDINAL, OLESTR(&quot;The specified column did not exist.&quot;) },
        { DB_E_PENDINGCHANGES, OLESTR(&quot;There are pending changes on a row with a reference count of zero.&quot;) },
        { DB_E_DATAOVERFLOW, OLESTR(&quot;Literal value in the command exceeded the range of the type of the associated column.&quot;) },
        { DB_E_BADHRESULT, OLESTR(&quot;HRESULT is invalid.&quot;) },
        { DB_E_BADLOOKUPID, OLESTR(&quot;Lookup ID is invalid.&quot;) },
        { DB_E_BADDYNAMICERRORID, OLESTR(&quot;DynamicError ID is invalid.&quot;) },
        { DB_E_PENDINGINSERT, OLESTR(&quot;Most recent data for a newly inserted row could not be retrieved because the insert is pending.&quot;) },
        { DB_E_BADCONVERTFLAG, OLESTR(&quot;Conversion flag is invalid.&quot;) },
        { DB_E_OBJECTMISMATCH, OLESTR(&quot;Operation is not allowed to this column type&quot;) },
    };
    for(int i=0;i&lt;sizeof(desc)/sizeof(*desc);i++)
    {
        if(desc[i].hr==hr)
            return desc[i].str;
    }
    return OLESTR(&quot;The Error Description String&quot;);
}

STDMETHODIMP CCUBRIDErrorLookup::GetErrorDescription(HRESULT hrError,
                    DWORD dwLookupID, DISPPARAMS *pdispparams, LCID lcid,
                    BSTR *pbstrSource, BSTR *pbstrDescription)
{
    if(pbstrSource==NULL || pbstrDescription==NULL)
        return E_INVALIDARG;

    CComBSTR strSource = &quot;CUBRIDProvider&quot;;
    *pbstrSource = strSource.Detach();

    CComBSTR strDesc;

    if(dwLookupID==0)
    {
        strDesc = GetErrorDescriptionString(hrError);
    }
    else if(dwLookupID==1) // cci error
    {
        strDesc = V_BSTR(&amp;pdispparams[0].rgvarg[0]);
    }

    *pbstrDescription = strDesc.Detach();

    return S_OK;
}

STDMETHODIMP CCUBRIDErrorLookup::GetHelpInfo(HRESULT hrError, DWORD dwLookupID,
                    LCID lcid, BSTR *pbstrHelpFile, DWORD *pdwHelpContext)
{
    if(pbstrHelpFile==NULL || pdwHelpContext==NULL)
        return E_INVALIDARG;

    *pbstrHelpFile = 0;
    *pdwHelpContext = 0;
    return S_OK;
}

STDMETHODIMP CCUBRIDErrorLookup::ReleaseErrors(const DWORD dwDynamicErrorID)
{
    return S_OK;
}

STDMETHODIMP CCUBRIDErrorInfo::GetSQLInfo(BSTR *pbstrSQLState, LONG *plNativeError)
{
    if(pbstrSQLState) *pbstrSQLState = 0;
    if(plNativeError) *plNativeError = 0;
    if(pbstrSQLState==NULL || plNativeError==NULL)
        return E_INVALIDARG;

    *pbstrSQLState = SysAllocString(m_bstrSQLState);
    if(*pbstrSQLState==NULL)
        return E_OUTOFMEMORY;
    *plNativeError = m_lNativeError;

    return S_OK;
}</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    SetErrorInfo(0, spErrorInfo);</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespacebroker__log__top.html#a507e86f36aac24149f6038d40412d19f">info</a>.hrError;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;}</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;</div><div class="line"><a name="l00106"></a><span class="lineno"><a class="line" href="Error_8h.html#a06a35e7e75e7845cc478e02f02b7eb36">  106</a></span>&#160;HRESULT <a class="code" href="Error_8cpp.html#afda786ad5a25ec751d57b3b84d89dfec">RaiseError</a>(HRESULT hrError, DWORD dwMinor, <a class="code" href="struct__IID.html">IID</a> <a class="code" href="Rowset_8h.html#ab3f03dce38c1f2d44581d106e758499a">iid</a>, CComVariant &amp;var, BSTR bstrSQLState)</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;{</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    ERRORINFO <a class="code" href="namespacebroker__log__top.html#a507e86f36aac24149f6038d40412d19f">info</a>;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <a class="code" href="namespacebroker__log__top.html#a507e86f36aac24149f6038d40412d19f">info</a>.hrError = hrError;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <a class="code" href="namespacebroker__log__top.html#a507e86f36aac24149f6038d40412d19f">info</a>.dwMinor = dwMinor;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <a class="code" href="namespacebroker__log__top.html#a507e86f36aac24149f6038d40412d19f">info</a>.clsid = CCUBRIDDataSource::GetObjectCLSID();</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <a class="code" href="namespacebroker__log__top.html#a507e86f36aac24149f6038d40412d19f">info</a>.iid = <a class="code" href="Rowset_8h.html#ab3f03dce38c1f2d44581d106e758499a">iid</a>;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <a class="code" href="namespacebroker__log__top.html#a507e86f36aac24149f6038d40412d19f">info</a>.dispid = 0;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="Error_8cpp.html#afda786ad5a25ec751d57b3b84d89dfec">RaiseError</a>(<a class="code" href="namespacebroker__log__top.html#a507e86f36aac24149f6038d40412d19f">info</a>, var, bstrSQLState);</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;}</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;</div><div class="line"><a name="l00117"></a><span class="lineno"><a class="line" href="Error_8h.html#aff8afe0c2c60dbfcd01358f6f4bf9eee">  117</a></span>&#160;HRESULT <a class="code" href="Error_8cpp.html#afda786ad5a25ec751d57b3b84d89dfec">RaiseError</a>(HRESULT hrError, DWORD dwMinor, <a class="code" href="struct__IID.html">IID</a> <a class="code" href="Rowset_8h.html#ab3f03dce38c1f2d44581d106e758499a">iid</a>, LPCSTR pszText, BSTR bstrSQLState)</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;{</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    CComVariant var;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <span class="keywordflow">if</span>(pszText) var = pszText;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="Error_8cpp.html#afda786ad5a25ec751d57b3b84d89dfec">RaiseError</a>(hrError, dwMinor, <a class="code" href="Rowset_8h.html#ab3f03dce38c1f2d44581d106e758499a">iid</a>, var, bstrSQLState);</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;}</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;</div><div class="line"><a name="l00124"></a><span class="lineno"><a class="line" href="Error_8h.html#a899fd0fc6da5619c4cb7542849a9965b">  124</a></span>&#160;HRESULT <a class="code" href="Error_8cpp.html#afda786ad5a25ec751d57b3b84d89dfec">RaiseError</a>(HRESULT hrError, DWORD dwMinor, <a class="code" href="struct__IID.html">IID</a> <a class="code" href="Rowset_8h.html#ab3f03dce38c1f2d44581d106e758499a">iid</a>, LPWSTR pwszText, BSTR bstrSQLState)</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;{</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    CComVariant var;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="keywordflow">if</span>(pwszText) var = pwszText;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="Error_8cpp.html#afda786ad5a25ec751d57b3b84d89dfec">RaiseError</a>(hrError, dwMinor, <a class="code" href="Rowset_8h.html#ab3f03dce38c1f2d44581d106e758499a">iid</a>, var, bstrSQLState);</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;}</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="keyword">static</span> LPOLESTR GetErrorDescriptionString(HRESULT hr)</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;{</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="comment">// 다음은 conformance tests의 cexterr.cpp에서 가져왔다.</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="keyword">static</span> <span class="keyword">struct</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    {</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        HRESULT hr;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        LPOLESTR str;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    } desc[] = {</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        { E_UNEXPECTED, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;Catastrophic failure&quot;</span>) },</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        { E_FAIL, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;A provider-specific error occurred&quot;</span>) },</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        { E_NOINTERFACE, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;No such interface supported&quot;</span>) },</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        { E_INVALIDARG, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;The parameter is incorrect.&quot;</span>) },</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        { DB_E_BADACCESSORHANDLE, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;Accessor is invalid.&quot;</span>) },</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        { DB_E_ROWLIMITEXCEEDED, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;Row could not be inserted into the rowset without exceeding provider&#39;s maximum number of active rows.&quot;</span>) },</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        { DB_E_READONLYACCESSOR, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;Accessor is read-only. Operation failed.&quot;</span>) },</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        { DB_E_SCHEMAVIOLATION, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;Given values violate the database schema.&quot;</span>) },</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        { DB_E_BADROWHANDLE, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;Row handle is invalid.&quot;</span>) },</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        { DB_E_OBJECTOPEN, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;Object was open.&quot;</span>) },</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        { DB_E_BADCHAPTER, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;Chapter is invalid.&quot;</span>) },</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        { DB_E_CANTCONVERTVALUE, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;Data or literal value could not be converted to the type of the column in the data source, and the provider was unable to determine which columns could not be converted.  Data overflow or sign mismatch was not the cause.&quot;</span>) },</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        { DB_E_BADBINDINFO, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;Binding information is invalid.&quot;</span>) },</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        { DB_SEC_E_PERMISSIONDENIED, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;Permission denied.&quot;</span>) },</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        { DB_E_NOTAREFERENCECOLUMN, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;Specified column does not contain bookmarks or chapters.&quot;</span>) },</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        { DB_E_LIMITREJECTED, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;Cost limits were rejected.&quot;</span>) },</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        { DB_E_NOCOMMAND, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;Command text was not set for the command object.&quot;</span>) },</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        { DB_E_COSTLIMIT, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;Query plan within the cost limit cannot be found.&quot;</span>) },</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        { DB_E_BADBOOKMARK, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;Bookmark is invalid.&quot;</span>) },</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        { DB_E_BADLOCKMODE, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;Lock mode is invalid.&quot;</span>) },</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        { DB_E_PARAMNOTOPTIONAL, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;No value given for one or more required parameters.&quot;</span>) },</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        { DB_E_BADCOLUMNID, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;Column ID is invalid.&quot;</span>) },</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        { DB_E_BADRATIO, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;Numerator was greater than denominator. Values must express ratio between zero and 1.&quot;</span>) },</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        { DB_E_BADVALUES, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;Value is invalid.&quot;</span>) },</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        { DB_E_ERRORSINCOMMAND, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;One or more errors occurred during processing of command.&quot;</span>) },</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        { DB_E_CANTCANCEL, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;Command cannot be canceled.&quot;</span>) },</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        { DB_E_DIALECTNOTSUPPORTED, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;Command dialect is not supported by this provider.&quot;</span>) },</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        { DB_E_DUPLICATEDATASOURCE, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;Data source object could not be created because the named data source already exists.&quot;</span>) },</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        { DB_E_CANNOTRESTART, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;The rowset was built over a live data feed and cannot be restarted.&quot;</span>) },</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        { DB_E_NOTFOUND, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;No key matching the described characteristics could be found within the current range.&quot;</span>) },</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        { DB_E_NEWLYINSERTED, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;Identity cannot be determined for newly inserted rows.&quot;</span>) },</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        { DB_E_CANNOTFREE, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;Provider has ownership of this tree.&quot;</span>) },</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        { DB_E_GOALREJECTED, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;Goal was rejected because no nonzero weights were specified for any goals supported. Current goal was not changed.&quot;</span>) },</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        { DB_E_UNSUPPORTEDCONVERSION, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;Requested conversion is not supported.&quot;</span>) },</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        { DB_E_BADSTARTPOSITION, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;Goal was rejected because no nonzero weights were specified for any goals supported. Current goal was not changed.&quot;</span>) },</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        { DB_E_NOQUERY, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;Information was requested for a query, and the query was not set.&quot;</span>) },</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        { DB_E_NOTREENTRANT, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;Consumer&#39;s event handler called a non-reentrant method in the provider.&quot;</span>) },</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        { DB_E_ERRORSOCCURRED, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;Multiple-step OLE DB operation generated errors. Check each OLE DB status value, if available. No work was done.&quot;</span>) },</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        { DB_E_NOAGGREGATION, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;Non-NULL controlling IUnknown was specified, and either the requested interface was not IUnknown, or the provider does not support COM aggregation.&quot;</span>) },</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        { DB_E_DELETEDROW, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;Row handle referred to a deleted row or a row marked for deletion.&quot;</span>) },</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        { DB_E_CANTFETCHBACKWARDS, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;The rowset does not support fetching backwards.&quot;</span>) },</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        { DB_E_ROWSNOTRELEASED, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;Row handles must all be released before new ones can be obtained.&quot;</span>) },</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        { DB_E_BADSTORAGEFLAG, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;One or more storage flags are not supported.&quot;</span>) },</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        { DB_E_BADCOMPAREOP, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;Comparison operator is invalid.&quot;</span>) },</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        { DB_E_BADSTATUSVALUE, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;The specified status flag was neither DBCOLUMNSTATUS_OK nor DBCOLUMNSTATUS_ISNULL.&quot;</span>) },</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        { DB_E_CANTSCROLLBACKWARDS, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;Rowset does not support scrolling backward.&quot;</span>) },</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        { DB_E_BADREGIONHANDLE, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;Region handle is invalid.&quot;</span>) },</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        { DB_E_NONCONTIGUOUSRANGE, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;Set of rows is not contiguous to, or does not overlap, the rows in the watch region.&quot;</span>) },</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        { DB_E_INVALIDTRANSITION, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;A transition from ALL* to MOVE* or EXTEND* was specified.&quot;</span>) },</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        { DB_E_NOTASUBREGION, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;The specified region is not a proper subregion of the region identified by the given watch region handle.&quot;</span>) },</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        { DB_E_MULTIPLESTATEMENTS, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;Multiple-statement commands are not supported by this provider.&quot;</span>) },</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        { DB_E_INTEGRITYVIOLATION, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;A specified value violated the integrity constraints for a column or table.&quot;</span>) },</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        { DB_E_BADTYPENAME, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;Type name is invalid.&quot;</span>) },</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        { DB_E_ABORTLIMITREACHED, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;Execution stopped because a resource limit was reached. No results were returned.&quot;</span>) },</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        { DB_E_ROWSETINCOMMAND, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;Command object whose command tree contains a rowset or rowsets cannot be cloned.&quot;</span>) },</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        { DB_E_CANTTRANSLATE, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;Current tree cannot be represented as text.&quot;</span>) },</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        { DB_E_DUPLICATEINDEXID, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;The specified index already exists.&quot;</span>) },</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        { DB_E_NOINDEX, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;The specified index does not exist.&quot;</span>) },</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        { DB_E_INDEXINUSE, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;Index is in use.&quot;</span>) },</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        { DB_E_NOTABLE, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;The specified table does not exist.&quot;</span>) },</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        { DB_E_CONCURRENCYVIOLATION, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;The rowset was using optimistic concurrency and the value of a column has been changed since it was last read.&quot;</span>) },</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        { DB_E_BADCOPY, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;Errors were detected during the copy.&quot;</span>) },</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        { DB_E_BADPRECISION, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;Precision is invalid.&quot;</span>) },</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        { DB_E_BADSCALE, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;Scale is invalid.&quot;</span>) },</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        { DB_E_BADTABLEID, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;Table ID is invalid.&quot;</span>) },</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        { DB_E_BADTYPE, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;Type is invalid.&quot;</span>) },</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        { DB_E_DUPLICATECOLUMNID, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;Column ID already exists or occurred more than once in the array of columns.&quot;</span>) },</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        { DB_E_DUPLICATETABLEID, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;The specified table already exists.&quot;</span>) },</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        { DB_E_TABLEINUSE, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;Table is in use.&quot;</span>) },</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        { DB_E_NOLOCALE, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;The specified locale ID was not supported.&quot;</span>) },</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        { DB_E_BADRECORDNUM, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;Record number is invalid.&quot;</span>) },</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        { DB_E_BOOKMARKSKIPPED, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;Although the bookmark was validly formed, no row could be found to match it.&quot;</span>) },</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        { DB_E_BADPROPERTYVALUE, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;Property value is invalid.&quot;</span>) },</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        { DB_E_INVALID, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;The rowset was not chaptered.&quot;</span>) },</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        { DB_E_BADACCESSORFLAGS, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;One or more accessor flags were invalid.&quot;</span>) },</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        { DB_E_BADSTORAGEFLAGS, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;One or more storage flags are invalid.&quot;</span>) },</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        { DB_E_BYREFACCESSORNOTSUPPORTED, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;Reference accessors are not supported by this provider.&quot;</span>) },</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        { DB_E_NULLACCESSORNOTSUPPORTED, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;Null accessors are not supported by this provider.&quot;</span>) },</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        { DB_E_NOTPREPARED, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;The command was not prepared.&quot;</span>) },</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        { DB_E_BADACCESSORTYPE, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;The specified accessor was not a parameter accessor.&quot;</span>) },</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        { DB_E_WRITEONLYACCESSOR, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;The given accessor was write-only.&quot;</span>) },</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        { DB_SEC_E_AUTH_FAILED, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;Authentication failed.&quot;</span>) },</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        { DB_E_CANCELED, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;Operation was canceled.&quot;</span>) },</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        { DB_E_CHAPTERNOTRELEASED, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;The rowset was single-chaptered and the chapter was not released.&quot;</span>) },</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        { DB_E_BADSOURCEHANDLE, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;Source handle is invalid.&quot;</span>) },</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        { DB_E_PARAMUNAVAILABLE, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;Provider cannot derive parameter information and SetParameterInfo has not been called.&quot;</span>) },</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        { DB_E_ALREADYINITIALIZED, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;The data source object is already initialized.&quot;</span>) },</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        { DB_E_NOTSUPPORTED, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;Method is not supported by this provider.&quot;</span>) },</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        { DB_E_MAXPENDCHANGESEXCEEDED, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;Number of rows with pending changes exceeded the limit.&quot;</span>) },</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        { DB_E_BADORDINAL, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;The specified column did not exist.&quot;</span>) },</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        { DB_E_PENDINGCHANGES, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;There are pending changes on a row with a reference count of zero.&quot;</span>) },</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        { DB_E_DATAOVERFLOW, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;Literal value in the command exceeded the range of the type of the associated column.&quot;</span>) },</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        { DB_E_BADHRESULT, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;HRESULT is invalid.&quot;</span>) },</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        { DB_E_BADLOOKUPID, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;Lookup ID is invalid.&quot;</span>) },</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        { DB_E_BADDYNAMICERRORID, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;DynamicError ID is invalid.&quot;</span>) },</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        { DB_E_PENDINGINSERT, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;Most recent data for a newly inserted row could not be retrieved because the insert is pending.&quot;</span>) },</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        { DB_E_BADCONVERTFLAG, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;Conversion flag is invalid.&quot;</span>) },</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        { DB_E_OBJECTMISMATCH, <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;Operation is not allowed to this column type&quot;</span>) },</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    };</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>=0;<a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;<span class="keyword">sizeof</span>(desc)/<span class="keyword">sizeof</span>(*desc);<a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    {</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        <span class="keywordflow">if</span>(desc[<a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>].hr==hr)</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;            <span class="keywordflow">return</span> desc[<a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>].str;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    }</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a>(<span class="stringliteral">&quot;The Error Description String&quot;</span>);</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;}</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;</div><div class="line"><a name="l00246"></a><span class="lineno"><a class="line" href="classCCUBRIDErrorLookup.html#a1b176b7f9d73206cee061861714fe1e4">  246</a></span>&#160;STDMETHODIMP <a class="code" href="classCCUBRIDErrorLookup.html#a1b176b7f9d73206cee061861714fe1e4">CCUBRIDErrorLookup::GetErrorDescription</a>(HRESULT hrError,</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                    DWORD dwLookupID, DISPPARAMS *pdispparams, LCID lcid,</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                    BSTR *pbstrSource, BSTR *pbstrDescription)</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;{</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="keywordflow">if</span>(pbstrSource==<a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || pbstrDescription==<a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        <span class="keywordflow">return</span> E_INVALIDARG;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    CComBSTR strSource = <span class="stringliteral">&quot;CUBRIDProvider&quot;</span>;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    *pbstrSource = strSource.Detach();</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    CComBSTR strDesc;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    <span class="keywordflow">if</span>(dwLookupID==0)</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    {</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        strDesc = GetErrorDescriptionString(hrError);</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    }</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(dwLookupID==1) <span class="comment">// cci error</span></div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    {</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        strDesc = V_BSTR(&amp;pdispparams[0].rgvarg[0]);</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    }</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    *pbstrDescription = strDesc.Detach();</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="atldb__cubrid_8h.html#a1c8f62bc38a50376a62d4dad41a5e2aa">S_OK</a>;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;}</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;</div><div class="line"><a name="l00272"></a><span class="lineno"><a class="line" href="classCCUBRIDErrorLookup.html#a91e74fa0756ef3b6bb5c997205c257fc">  272</a></span>&#160;STDMETHODIMP <a class="code" href="classCCUBRIDErrorLookup.html#a91e74fa0756ef3b6bb5c997205c257fc">CCUBRIDErrorLookup::GetHelpInfo</a>(HRESULT hrError, DWORD dwLookupID,</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                    LCID lcid, BSTR *pbstrHelpFile, DWORD *pdwHelpContext)</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;{</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <span class="keywordflow">if</span>(pbstrHelpFile==<a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || pdwHelpContext==<a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        <span class="keywordflow">return</span> E_INVALIDARG;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    *pbstrHelpFile = 0;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    *pdwHelpContext = 0;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="atldb__cubrid_8h.html#a1c8f62bc38a50376a62d4dad41a5e2aa">S_OK</a>;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;}</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;</div><div class="line"><a name="l00283"></a><span class="lineno"><a class="line" href="classCCUBRIDErrorLookup.html#a07b2cb31ff2dbc8523d106245ff2c3cf">  283</a></span>&#160;STDMETHODIMP <a class="code" href="classCCUBRIDErrorLookup.html#a07b2cb31ff2dbc8523d106245ff2c3cf">CCUBRIDErrorLookup::ReleaseErrors</a>(<span class="keyword">const</span> DWORD dwDynamicErrorID)</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;{</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="atldb__cubrid_8h.html#a1c8f62bc38a50376a62d4dad41a5e2aa">S_OK</a>;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;}</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;</div><div class="line"><a name="l00288"></a><span class="lineno"><a class="line" href="classCCUBRIDErrorInfo.html#a2a7c02f57ef8e44ed21efcc237826dc5">  288</a></span>&#160;STDMETHODIMP <a class="code" href="classCCUBRIDErrorInfo.html#a2a7c02f57ef8e44ed21efcc237826dc5">CCUBRIDErrorInfo::GetSQLInfo</a>(BSTR *pbstrSQLState, <a class="code" href="curl_8h.html#acaa7b8a7167a8214f499c71c413ddcca">LONG</a> *plNativeError)</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;{</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="keywordflow">if</span>(pbstrSQLState) *pbstrSQLState = 0;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="keywordflow">if</span>(plNativeError) *plNativeError = 0;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="keywordflow">if</span>(pbstrSQLState==<a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || plNativeError==<a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        <span class="keywordflow">return</span> E_INVALIDARG;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    *pbstrSQLState = SysAllocString(<a class="code" href="classCCUBRIDErrorInfo.html#a48f6ae6f1364994e43522418fe73fe47">m_bstrSQLState</a>);</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="keywordflow">if</span>(*pbstrSQLState==<a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="atldb__cubrid_8h.html#a384404dfdbf1a0d41047dbe021b216d7">E_OUTOFMEMORY</a>;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    *plNativeError = <a class="code" href="classCCUBRIDErrorInfo.html#aba1561a4f42f0f76924baf2b33ebdb7d">m_lNativeError</a>;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="atldb__cubrid_8h.html#a1c8f62bc38a50376a62d4dad41a5e2aa">S_OK</a>;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;}</div><div class="ttc" id="struct__IID_html"><div class="ttname"><a href="struct__IID.html">_IID</a></div><div class="ttdef"><b>Definition:</b> <a href="CUBRIDProvider__i_8c_source.html#l00055">CUBRIDProvider_i.c:55</a></div></div>
<div class="ttc" id="namespacebroker__log__top_html_a507e86f36aac24149f6038d40412d19f"><div class="ttname"><a href="namespacebroker__log__top.html#a507e86f36aac24149f6038d40412d19f">broker_log_top.info</a></div><div class="ttdeci">info</div><div class="ttdef"><b>Definition:</b> <a href="broker__log__top_8py_source.html#l00360">broker_log_top.py:360</a></div></div>
<div class="ttc" id="classCCUBRIDErrorLookup_html_a07b2cb31ff2dbc8523d106245ff2c3cf"><div class="ttname"><a href="classCCUBRIDErrorLookup.html#a07b2cb31ff2dbc8523d106245ff2c3cf">CCUBRIDErrorLookup::ReleaseErrors</a></div><div class="ttdeci">STDMETHOD() ReleaseErrors(const DWORD dwDynamicErrorID)</div><div class="ttdef"><b>Definition:</b> <a href="Error_8cpp_source.html#l00283">Error.cpp:283</a></div></div>
<div class="ttc" id="classCCUBRIDErrorLookup_html_a1b176b7f9d73206cee061861714fe1e4"><div class="ttname"><a href="classCCUBRIDErrorLookup.html#a1b176b7f9d73206cee061861714fe1e4">CCUBRIDErrorLookup::GetErrorDescription</a></div><div class="ttdeci">STDMETHOD() GetErrorDescription(HRESULT hrError, DWORD dwLookupID, DISPPARAMS *pdispparams, LCID lcid, BSTR *pbstrSource, BSTR *pbstrDescription)</div><div class="ttdef"><b>Definition:</b> <a href="Error_8cpp_source.html#l00246">Error.cpp:246</a></div></div>
<div class="ttc" id="classCCUBRIDErrorInfo_html"><div class="ttname"><a href="classCCUBRIDErrorInfo.html">CCUBRIDErrorInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="Error_8h_source.html#l00088">Error.h:88</a></div></div>
<div class="ttc" id="Error_8h_html"><div class="ttname"><a href="Error_8h.html">Error.h</a></div></div>
<div class="ttc" id="classCCUBRIDErrorInfo_html_a48f6ae6f1364994e43522418fe73fe47"><div class="ttname"><a href="classCCUBRIDErrorInfo.html#a48f6ae6f1364994e43522418fe73fe47">CCUBRIDErrorInfo::m_bstrSQLState</a></div><div class="ttdeci">CComBSTR m_bstrSQLState</div><div class="ttdef"><b>Definition:</b> <a href="Error_8h_source.html#l00094">Error.h:94</a></div></div>
<div class="ttc" id="curl_8h_html_acaa7b8a7167a8214f499c71c413ddcca"><div class="ttname"><a href="curl_8h.html#acaa7b8a7167a8214f499c71c413ddcca">LONG</a></div><div class="ttdeci">#define LONG</div><div class="ttdef"><b>Definition:</b> <a href="curl_8h_source.html#l00504">curl.h:504</a></div></div>
<div class="ttc" id="Rowset_8h_html_ab3f03dce38c1f2d44581d106e758499a"><div class="ttname"><a href="Rowset_8h.html#ab3f03dce38c1f2d44581d106e758499a">iid</a></div><div class="ttdeci">iid</div><div class="ttdef"><b>Definition:</b> <a href="Rowset_8h_source.html#l00087">Rowset.h:87</a></div></div>
<div class="ttc" id="Error_8cpp_html_a93f7a306ed9bf1f41de89f2afea7f55d"><div class="ttname"><a href="Error_8cpp.html#a93f7a306ed9bf1f41de89f2afea7f55d">ClearError</a></div><div class="ttdeci">void ClearError()</div><div class="ttdef"><b>Definition:</b> <a href="Error_8cpp_source.html#l00058">Error.cpp:58</a></div></div>
<div class="ttc" id="classCCUBRIDErrorInfo_html_aba1561a4f42f0f76924baf2b33ebdb7d"><div class="ttname"><a href="classCCUBRIDErrorInfo.html#aba1561a4f42f0f76924baf2b33ebdb7d">CCUBRIDErrorInfo::m_lNativeError</a></div><div class="ttdeci">LONG m_lNativeError</div><div class="ttdef"><b>Definition:</b> <a href="Error_8h_source.html#l00096">Error.h:96</a></div></div>
<div class="ttc" id="atldb__cubrid_8h_html_a3ac53bc34d58f029fe710ec5d714de6c"><div class="ttname"><a href="atldb__cubrid_8h.html#a3ac53bc34d58f029fe710ec5d714de6c">OLESTR</a></div><div class="ttdeci">LPOLESTR OLESTR(name)</div></div>
<div class="ttc" id="atldb__cubrid_8h_html_a384404dfdbf1a0d41047dbe021b216d7"><div class="ttname"><a href="atldb__cubrid_8h.html#a384404dfdbf1a0d41047dbe021b216d7">E_OUTOFMEMORY</a></div><div class="ttdeci">else return E_OUTOFMEMORY</div><div class="ttdef"><b>Definition:</b> <a href="atldb__cubrid_8h_source.html#l02074">atldb_cubrid.h:2074</a></div></div>
<div class="ttc" id="freelistheap_8h_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="freelistheap_8h_source.html#l00019">freelistheap.h:19</a></div></div>
<div class="ttc" id="classCCUBRIDErrorLookup_html_a91e74fa0756ef3b6bb5c997205c257fc"><div class="ttname"><a href="classCCUBRIDErrorLookup.html#a91e74fa0756ef3b6bb5c997205c257fc">CCUBRIDErrorLookup::GetHelpInfo</a></div><div class="ttdeci">STDMETHOD() GetHelpInfo(HRESULT hrError, DWORD dwLookupID, LCID lcid, BSTR *pbstrHelpFile, DWORD *pdwHelpContext)</div><div class="ttdef"><b>Definition:</b> <a href="Error_8cpp_source.html#l00272">Error.cpp:272</a></div></div>
<div class="ttc" id="Error_8cpp_html_afda786ad5a25ec751d57b3b84d89dfec"><div class="ttname"><a href="Error_8cpp.html#afda786ad5a25ec751d57b3b84d89dfec">RaiseError</a></div><div class="ttdeci">HRESULT RaiseError(ERRORINFO &amp;info, CComVariant &amp;var, BSTR bstrSQLState)</div><div class="ttdef"><b>Definition:</b> <a href="Error_8cpp_source.html#l00063">Error.cpp:63</a></div></div>
<div class="ttc" id="atldb__cubrid_8h_html_a1c8f62bc38a50376a62d4dad41a5e2aa"><div class="ttname"><a href="atldb__cubrid_8h.html#a1c8f62bc38a50376a62d4dad41a5e2aa">S_OK</a></div><div class="ttdeci">return S_OK</div><div class="ttdef"><b>Definition:</b> <a href="atldb__cubrid_8h_source.html#l02236">atldb_cubrid.h:2236</a></div></div>
<div class="ttc" id="classCCUBRIDErrorInfo_html_a2a7c02f57ef8e44ed21efcc237826dc5"><div class="ttname"><a href="classCCUBRIDErrorInfo.html#a2a7c02f57ef8e44ed21efcc237826dc5">CCUBRIDErrorInfo::GetSQLInfo</a></div><div class="ttdeci">STDMETHOD() GetSQLInfo(BSTR *pbstrSQLState, LONG *plNativeError)</div><div class="ttdef"><b>Definition:</b> <a href="Error_8cpp_source.html#l00288">Error.cpp:288</a></div></div>
<div class="ttc" id="dynamic__load_8c_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="dynamic__load_8c_source.html#l00955">dynamic_load.c:955</a></div></div>
<div class="ttc" id="oledb_2stdafx_8h_html"><div class="ttname"><a href="oledb_2stdafx_8h.html">stdafx.h</a></div></div>
<div class="ttc" id="DataSource_8h_html"><div class="ttname"><a href="DataSource_8h.html">DataSource.h</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_2c7dae788c48670d44a2add3356c436e.html">oledb</a></li><li class="navelem"><a class="el" href="Error_8cpp.html">Error.cpp</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
