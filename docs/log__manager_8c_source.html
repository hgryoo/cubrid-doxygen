<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CUBRID Engine: src/transaction/log_manager.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CUBRID Engine
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('log__manager_8c_source.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">log_manager.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="log__manager_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * Copyright (C) 2008 Search Solution Corporation. All rights reserved by Search Solution.</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> *   This program is free software; you can redistribute it and/or modify</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> *   it under the terms of the GNU General Public License as published by</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> *   the Free Software Foundation; either version 2 of the License, or</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> *   (at your option) any later version.</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> *  This program is distributed in the hope that it will be useful,</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> *  but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> *  GNU General Public License for more details.</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> *  You should have received a copy of the GNU General Public License</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> *  along with this program; if not, write to the Free Software</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> *  Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment"> * log_manager.c -</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#ident &quot;$Id$&quot;</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;config.h&quot;</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &lt;stdio.h&gt;</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &lt;string.h&gt;</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &lt;stddef.h&gt;</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &lt;stdlib.h&gt;</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &lt;time.h&gt;</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#if defined(SOLARIS)</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &lt;netdb.h&gt;</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* SOLARIS */</span><span class="preprocessor"></span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &lt;sys/stat.h&gt;</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &lt;assert.h&gt;</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#if defined(WINDOWS)</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &lt;io.h&gt;</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* WINDOWS */</span><span class="preprocessor"></span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &lt;sys/types.h&gt;</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#include &lt;sys/stat.h&gt;</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#include &lt;fcntl.h&gt;</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="preprocessor">#include &lt;cstdint&gt;</span></div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="log__manager_8h.html">log_manager.h</a>&quot;</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="recovery_8h.html">recovery.h</a>&quot;</span></div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="xserver__interface_8h.html">xserver_interface.h</a>&quot;</span></div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="page__buffer_8h.html">page_buffer.h</a>&quot;</span></div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="query__manager_8h.html">query_manager.h</a>&quot;</span></div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="message__catalog_8h.html">message_catalog.h</a>&quot;</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="environment__variable_8h.html">environment_variable.h</a>&quot;</span></div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="preprocessor">#if defined(SERVER_MODE)</span></div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="server__support_8h.html">server_support.h</a>&quot;</span></div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* SERVER_MODE */</span><span class="preprocessor"></span></div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="log__compress_8h.html">log_compress.h</a>&quot;</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="partition__sr_8h.html">partition_sr.h</a>&quot;</span></div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="log__writer_8h.html">log_writer.h</a>&quot;</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="filter__pred__cache_8h.html">filter_pred_cache.h</a>&quot;</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="heap__file_8h.html">heap_file.h</a>&quot;</span></div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="slotted__page_8h.html">slotted_page.h</a>&quot;</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="object__primitive_8h.html">object_primitive.h</a>&quot;</span></div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="db__date_8h.html">db_date.h</a>&quot;</span></div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="fault__injection_8h.html">fault_injection.h</a>&quot;</span></div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="preprocessor">#if defined (SA_MODE)</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="connection__support_8h.html">connection_support.h</a>&quot;</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* defined (SA_MODE) */</span><span class="preprocessor"></span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="db__value__printer_8hpp.html">db_value_printer.hpp</a>&quot;</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="mem__block_8hpp.html">mem_block.hpp</a>&quot;</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="string__buffer_8hpp.html">string_buffer.hpp</a>&quot;</span></div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="boot__sr_8h.html">boot_sr.h</a>&quot;</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="thread__daemon_8hpp.html">thread_daemon.hpp</a>&quot;</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="thread__entry__task_8hpp.html">thread_entry_task.hpp</a>&quot;</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="thread__manager_8hpp.html">thread_manager.hpp</a>&quot;</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="dbtype_8h.html">dbtype.h</a>&quot;</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="preprocessor">#if !defined(SERVER_MODE)</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div><div class="line"><a name="l00083"></a><span class="lineno"><a class="line" href="log__manager_8c.html#ac1ad8670a3aa848108fa8d020ab77111">   83</a></span>&#160;<span class="preprocessor">#define pthread_mutex_init(a, b)</span></div><div class="line"><a name="l00084"></a><span class="lineno"><a class="line" href="log__manager_8c.html#a3918fe11dbbcabb096eba6319e9b7745">   84</a></span>&#160;<span class="preprocessor">#define pthread_mutex_destroy(a)</span></div><div class="line"><a name="l00085"></a><span class="lineno"><a class="line" href="log__manager_8c.html#a3bd1ad5edf8fc93f783af77e8cd6ee9a">   85</a></span>&#160;<span class="preprocessor">#define pthread_mutex_lock(a)   0</span></div><div class="line"><a name="l00086"></a><span class="lineno"><a class="line" href="log__manager_8c.html#aa91b7ec8ae8a2d699fb09cc20c444fe8">   86</a></span>&#160;<span class="preprocessor">#define pthread_mutex_unlock(a)</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="mprec_8c.html#a115f98821af8b9ac2f97f2ac2cb2797f">rv</a>;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* !SERVER_MODE */</span><span class="preprocessor"></span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment"> *                      IS TIME TO EXECUTE A CHECKPOINT ?</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">/* A checkpoint is taken after a set of log pages has been used */</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;</div><div class="line"><a name="l00098"></a><span class="lineno"><a class="line" href="log__manager_8c.html#aff0ddf74133f090a894a4b4b68b7acb6">   98</a></span>&#160;<span class="preprocessor">#define LOG_ISCHECKPOINT_TIME() \</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="preprocessor">  (log_Gl.rcv_phase == LOG_RESTARTED \</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="preprocessor">   &amp;&amp; log_Gl.run_nxchkpt_atpageid != NULL_PAGEID \</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="preprocessor">   &amp;&amp; log_Gl.hdr.append_lsa.pageid &gt;= log_Gl.run_nxchkpt_atpageid)</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="preprocessor">#if defined(SERVER_MODE)</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="preprocessor">#define LOG_FLUSH_LOGGING_HAS_BEEN_SKIPPED(thread_p) \</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="preprocessor">  do { \</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="preprocessor">   if (log_Gl.hdr.has_logging_been_skipped != true) { \</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="preprocessor">     </span><span class="comment">/* Write in the log header that logging has been skipped */</span><span class="preprocessor"> \</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="preprocessor">      LOG_CS_ENTER((thread_p)); \</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="preprocessor">      if (log_Gl.hdr.has_logging_been_skipped != true) { \</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="preprocessor">    log_Gl.hdr.has_logging_been_skipped = true; \</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="preprocessor">    logpb_flush_header((thread_p)); \</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="preprocessor">      } \</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="preprocessor">      LOG_CS_EXIT(thread_p); \</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="preprocessor">    } \</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="preprocessor">  } while (0)</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="preprocessor">#else </span><span class="comment">/* SERVER_MODE */</span><span class="preprocessor"></span></div><div class="line"><a name="l00117"></a><span class="lineno"><a class="line" href="log__manager_8c.html#a62a934c871b6ec0f1feeecaea8cfc4dd">  117</a></span>&#160;<span class="preprocessor">#define LOG_FLUSH_LOGGING_HAS_BEEN_SKIPPED(thread_p) \</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="preprocessor">  do { \</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="preprocessor">   if (log_Gl.hdr.has_logging_been_skipped != true) { \</span></div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="preprocessor">     </span><span class="comment">/* Write in the log header that logging has been skipped */</span><span class="preprocessor"> \</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="preprocessor">      log_Gl.hdr.has_logging_been_skipped = true; \</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="preprocessor">      logpb_flush_header((thread_p)); \</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="preprocessor">    } \</span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="preprocessor">  } while (0)</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* SERVER_MODE */</span><span class="preprocessor"></span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  <span class="comment">/* </span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">   * Some log record rcvindex types should never be skipped.</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">   * In the case of LINK_PERM_VOLEXT, the link of a permanent temp</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">   * volume must be logged to support media failures.</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">   * See also canskip_undo. If there are others, add them here.</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l00133"></a><span class="lineno"><a class="line" href="log__manager_8c.html#a4b52943a60e04cf7685b2355ad7e1d4a">  133</a></span>&#160;<span class="preprocessor">#define LOG_ISUNSAFE_TO_SKIP_RCVINDEX(RCVI) \</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="preprocessor">   ((RCVI) == RVDK_LINK_PERM_VOLEXT)</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;</div><div class="line"><a name="l00136"></a><span class="lineno"><a class="line" href="log__manager_8c.html#acbe7c7db028f78d1f9ceda699b93c74e">  136</a></span>&#160;<span class="preprocessor">#define LOG_NEED_TO_SET_LSA(RCVI, PGPTR) \</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="preprocessor">   (((RCVI) != RVBT_MVCC_INCREMENTS_UPD) \</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="preprocessor">    &amp;&amp; ((RCVI) != RVBT_LOG_GLOBAL_UNIQUE_STATS_COMMIT) \</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="preprocessor">    &amp;&amp; ((RCVI) != RVBT_REMOVE_UNIQUE_STATS) \</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="preprocessor">    &amp;&amp; ((RCVI) != RVLOC_CLASSNAME_DUMMY) \</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="preprocessor">    &amp;&amp; ((RCVI) != RVDK_LINK_PERM_VOLEXT || !pgbuf_is_lsa_temporary(PGPTR)))</span></div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">/* Assume that locator end with &lt;path&gt;/&lt;meta_name&gt;.&lt;key_name&gt; */</span></div><div class="line"><a name="l00144"></a><span class="lineno"><a class="line" href="log__manager_8c.html#a857d88396b8d4d3ee5880e3005eeb90d">  144</a></span>&#160;<span class="preprocessor">#define LOCATOR_KEY(locator_) (strrchr (locator_, &#39;.&#39;) + 1)</span></div><div class="line"><a name="l00145"></a><span class="lineno"><a class="line" href="log__manager_8c.html#a2e83f32f5ca5ea01d8bc0077e489bca6">  145</a></span>&#160;<span class="preprocessor">#define LOCATOR_META(locator_) (strrchr (locator_, PATH_SEPARATOR) + 1)</span></div><div class="line"><a name="l00146"></a><span class="lineno"><a class="line" href="log__manager_8c.html#a0d4074e0032a75ccf74ad2fdc9264083">  146</a></span>&#160;<span class="preprocessor">#define PUT_LOCATOR_META(meta_name_, locator_) \</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="preprocessor">   do { \</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="preprocessor">     char *key_, *meta_; \</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="preprocessor">     key_ = LOCATOR_KEY (locator_); \</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="preprocessor">     meta_ = LOCATOR_META (locator_); \</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="preprocessor">     memcpy (meta_name_, meta_, (key_ - meta_) -1); \</span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="preprocessor">     meta_name_[(key_ - meta_) -1] = &#39;\0&#39;; \</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="preprocessor">   } while (0)</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment">/* definitions for lob locator tree */</span></div><div class="line"><a name="l00156"></a><span class="lineno"><a class="line" href="log__manager_8c.html#a6dd07f10ed5cc32175b7832711e6e4ff">  156</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structlob__savepoint__entry.html">lob_savepoint_entry</a> <a class="code" href="structlob__savepoint__entry.html">LOB_SAVEPOINT_ENTRY</a>;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;</div><div class="line"><a name="l00158"></a><span class="lineno"><a class="line" href="structlob__savepoint__entry.html">  158</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structlob__savepoint__entry.html">lob_savepoint_entry</a></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;{</div><div class="line"><a name="l00160"></a><span class="lineno"><a class="line" href="structlob__savepoint__entry.html#aa8e71ec03245bca07f9b9734738b4149">  160</a></span>&#160;  <a class="code" href="log__impl_8h.html#a860ddfff66bc38ab51576892904b975c">LOB_LOCATOR_STATE</a> <a class="code" href="structlob__savepoint__entry.html#aa8e71ec03245bca07f9b9734738b4149">state</a>;</div><div class="line"><a name="l00161"></a><span class="lineno"><a class="line" href="structlob__savepoint__entry.html#a8be0cf46b6d7ca084114befa450fcd4a">  161</a></span>&#160;  <a class="code" href="structlog__lsa.html">LOG_LSA</a> <a class="code" href="structlob__savepoint__entry.html#a8be0cf46b6d7ca084114befa450fcd4a">savept_lsa</a>;</div><div class="line"><a name="l00162"></a><span class="lineno"><a class="line" href="structlob__savepoint__entry.html#a3d018fd9135834945409660addac0520">  162</a></span>&#160;  <a class="code" href="structlob__savepoint__entry.html">LOB_SAVEPOINT_ENTRY</a> *<a class="code" href="structlob__savepoint__entry.html#a3d018fd9135834945409660addac0520">prev</a>;</div><div class="line"><a name="l00163"></a><span class="lineno"><a class="line" href="structlob__savepoint__entry.html#af8cc29daa202c0ddba6cbec4cf30882a">  163</a></span>&#160;  <a class="code" href="es_8h.html#abc5f1830c52f82388529df13a21535aa">ES_URI</a> <a class="code" href="structlob__savepoint__entry.html#af8cc29daa202c0ddba6cbec4cf30882a">locator</a>;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;};</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;</div><div class="line"><a name="l00166"></a><span class="lineno"><a class="line" href="structlob__locator__entry.html">  166</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structlob__locator__entry.html">lob_locator_entry</a></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;{</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  <span class="comment">/* RB_ENTRY defines red-black tree node header for this structure. see base/rb_tree.h for more information. */</span></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  <a class="code" href="src_2base_2rb__tree_8h.html#a9c7350c93a42f7c017405c95676a3092">RB_ENTRY</a> (<a class="code" href="structlob__locator__entry.html">lob_locator_entry</a>) head;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  <a class="code" href="structlob__savepoint__entry.html">LOB_SAVEPOINT_ENTRY</a> *top;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  <span class="comment">/* key_hash is used to reduce the number of strcmp. see the comment of lob_locator_cmp for more information */</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  <span class="keywordtype">int</span> key_hash;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <span class="comment">/* normal case: points &amp;key_data[0], search key: supplied */</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <span class="keywordtype">char</span> *key;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <span class="keywordtype">char</span> key_data[1];</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;};</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment">/* struct for active log header scan */</span></div><div class="line"><a name="l00179"></a><span class="lineno"><a class="line" href="log__manager_8c.html#a6f89c1c957b3e43599ac9880a9fca542">  179</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structactve__log__header__scan__context.html">actve_log_header_scan_context</a> <a class="code" href="structactve__log__header__scan__context.html">ACTIVE_LOG_HEADER_SCAN_CTX</a>;</div><div class="line"><a name="l00180"></a><span class="lineno"><a class="line" href="structactve__log__header__scan__context.html">  180</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structactve__log__header__scan__context.html">actve_log_header_scan_context</a></div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;{</div><div class="line"><a name="l00182"></a><span class="lineno"><a class="line" href="structactve__log__header__scan__context.html#ad72cbc85c66879e4a3fc3f2a310f197b">  182</a></span>&#160;  <a class="code" href="structlog__header.html">LOG_HEADER</a> <a class="code" href="structactve__log__header__scan__context.html#ad72cbc85c66879e4a3fc3f2a310f197b">header</a>;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;};</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment">/* struct for archive log header scan */</span></div><div class="line"><a name="l00186"></a><span class="lineno"><a class="line" href="log__manager_8c.html#abd675c1566354eb36029841791706131">  186</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structarchive__log__header__scan__context.html">archive_log_header_scan_context</a> <a class="code" href="structarchive__log__header__scan__context.html">ARCHIVE_LOG_HEADER_SCAN_CTX</a>;</div><div class="line"><a name="l00187"></a><span class="lineno"><a class="line" href="structarchive__log__header__scan__context.html">  187</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structarchive__log__header__scan__context.html">archive_log_header_scan_context</a></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;{</div><div class="line"><a name="l00189"></a><span class="lineno"><a class="line" href="structarchive__log__header__scan__context.html#a0637f5ec1505138e18d9ebb259352961">  189</a></span>&#160;  <a class="code" href="structlog__arv__header.html">LOG_ARV_HEADER</a> <a class="code" href="structarchive__log__header__scan__context.html#a0637f5ec1505138e18d9ebb259352961">header</a>;</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;};</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment"> * The maximum number of times to try to undo a log record.</span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment"> * It is only used by the log_undo_rec_restartable() function.</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> LOG_REC_UNDO_MAX_ATTEMPTS = 3;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment">/* true: Skip logging, false: Don&#39;t skip logging */</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> log_No_logging = <span class="keyword">false</span>;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="keyword">extern</span> INT32 <a class="code" href="log__manager_8c.html#a3ecc2751989b36deb454d7a32e1ee5b8">vacuum_Global_oldest_active_blockers_counter</a>;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;</div><div class="line"><a name="l00203"></a><span class="lineno"><a class="line" href="log__manager_8c.html#a514c12210485928e3c0446bf9e3d371c">  203</a></span>&#160;<span class="preprocessor">#define LOG_TDES_LAST_SYSOP(tdes) (&amp;(tdes)-&gt;topops.stack[(tdes)-&gt;topops.last])</span></div><div class="line"><a name="l00204"></a><span class="lineno"><a class="line" href="log__manager_8c.html#ab278939e239bb84cc9c118b55260a500">  204</a></span>&#160;<span class="preprocessor">#define LOG_TDES_LAST_SYSOP_PARENT_LSA(tdes) (&amp;LOG_TDES_LAST_SYSOP(tdes)-&gt;lastparent_lsa)</span></div><div class="line"><a name="l00205"></a><span class="lineno"><a class="line" href="log__manager_8c.html#a0f43301a77dc33dd0c1a66f9d1ec9aac">  205</a></span>&#160;<span class="preprocessor">#define LOG_TDES_LAST_SYSOP_POSP_LSA(tdes) (&amp;LOG_TDES_LAST_SYSOP(tdes)-&gt;posp_lsa)</span></div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="preprocessor">#if defined (SERVER_MODE)</span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment">/* Current time in milliseconds */</span></div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">// *INDENT-OFF*</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;std::atomic&lt;std::int64_t&gt; log_Clock_msec = {0};</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment">// *INDENT-ON*</span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* SERVER_MODE */</span><span class="preprocessor"></span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment">// *INDENT-OFF*</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="preprocessor">#if defined (SERVER_MODE)</span></div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="keyword">class </span>log_abort_task : <span class="keyword">public</span> <a class="code" href="classcubthread_1_1entry__task.html">cubthread::entry_task</a></div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;{</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  log_abort_task (<span class="keywordtype">void</span>) = <span class="keyword">delete</span>;</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  log_abort_task (<a class="code" href="structlog__tdes.html">log_tdes</a> &amp;tdes)</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  : m_tdes (tdes)</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  {</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  }</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classcubthread_1_1task.html#a623fd6821a2500a5827b609d76428ecd">execute</a> (context_type &amp;thread_ref) <span class="keyword">final</span> <span class="keyword">override</span>;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  <span class="comment">// retire deletes me</span></div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    </div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="keyword">private</span>:</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  <a class="code" href="structlog__tdes.html">log_tdes</a> &amp;m_tdes;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;};</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="preprocessor">#endif // SERVER_MODE</span></div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment">// *INDENT-ON*</span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> log_verify_dbcreation (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="storage__common_8h.html#a0da39ba47abe69bdc4cf837e4890d7ab">VOLID</a> volid, <span class="keyword">const</span> <a class="code" href="cm__broker__admin_8c.html#a8606fb1d53339b43e7417d2f96db025f">INT64</a> * log_dbcreation);</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> log_create_internal (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <span class="keyword">const</span> <span class="keywordtype">char</span> *db_fullname, <span class="keyword">const</span> <span class="keywordtype">char</span> *logpath,</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">char</span> *prefix_logname, <a class="code" href="storage__common_8h.html#a261e4bc7334f8eabe6e1f0a3d7f7dcb4">DKNPAGES</a> npages, <a class="code" href="cm__broker__admin_8c.html#a8606fb1d53339b43e7417d2f96db025f">INT64</a> * db_creation);</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> log_initialize_internal (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <span class="keyword">const</span> <span class="keywordtype">char</span> *db_fullname, <span class="keyword">const</span> <span class="keywordtype">char</span> *logpath,</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                    <span class="keyword">const</span> <span class="keywordtype">char</span> *prefix_logname, <span class="keywordtype">bool</span> ismedia_crash, <a class="code" href="structbo__restart__arg.html">BO_RESTART_ARG</a> * r_args,</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                    <span class="keywordtype">bool</span> init_emergency);</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="preprocessor">#if defined(SERVER_MODE)</span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> log_abort_by_tdes (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="structlog__tdes.html">LOG_TDES</a> * tdes);</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* SERVER_MODE */</span><span class="preprocessor"></span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="keyword">static</span> <a class="code" href="structlog__lsa.html">LOG_LSA</a> *log_get_savepoint_lsa (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <span class="keyword">const</span> <span class="keywordtype">char</span> *savept_name, <a class="code" href="structlog__tdes.html">LOG_TDES</a> * tdes,</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                       <a class="code" href="structlog__lsa.html">LOG_LSA</a> * savept_lsa);</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> log_can_skip_undo_logging (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2b">LOG_RCVINDEX</a> rcvindex, <span class="keyword">const</span> <a class="code" href="structlog__tdes.html">LOG_TDES</a> * tdes,</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                       <a class="code" href="structlog__data__addr.html">LOG_DATA_ADDR</a> * addr);</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> log_can_skip_redo_logging (<a class="code" href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2b">LOG_RCVINDEX</a> rcvindex, <span class="keyword">const</span> <a class="code" href="structlog__tdes.html">LOG_TDES</a> * ignore_tdes, <a class="code" href="structlog__data__addr.html">LOG_DATA_ADDR</a> * addr);</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> log_append_commit_postpone (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="structlog__tdes.html">LOG_TDES</a> * tdes, <a class="code" href="structlog__lsa.html">LOG_LSA</a> * start_postpone_lsa);</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> log_append_sysop_start_postpone (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="structlog__tdes.html">LOG_TDES</a> * tdes,</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                         <a class="code" href="structlog__rec__sysop__start__postpone.html">LOG_REC_SYSOP_START_POSTPONE</a> * sysop_start_postpone, <span class="keywordtype">int</span> data_size,</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                         <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="namespacestatdump__to__csv.html#aedcb70fde9c0b07a0732db70deeec616">data</a>);</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> log_append_sysop_end (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="structlog__tdes.html">LOG_TDES</a> * tdes, <a class="code" href="structlog__rec__sysop__end.html">LOG_REC_SYSOP_END</a> * sysop_end,</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                  <span class="keywordtype">int</span> data_size, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="namespacestatdump__to__csv.html#aedcb70fde9c0b07a0732db70deeec616">data</a>);</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> log_append_repl_info_internal (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="structlog__tdes.html">LOG_TDES</a> * tdes, <span class="keywordtype">bool</span> is_commit, <span class="keywordtype">int</span> with_lock);</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> log_append_repl_info_with_lock (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="structlog__tdes.html">LOG_TDES</a> * tdes, <span class="keywordtype">bool</span> is_commit);</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> log_append_repl_info_and_commit_log (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="structlog__tdes.html">LOG_TDES</a> * tdes, <a class="code" href="structlog__lsa.html">LOG_LSA</a> * commit_lsa);</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> log_append_donetime_internal (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="structlog__tdes.html">LOG_TDES</a> * tdes, <a class="code" href="structlog__lsa.html">LOG_LSA</a> * eot_lsa,</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                      <a class="code" href="log__impl_8h.html#ab85dbe80b115a32bf7a430c32ddc5b8b">LOG_RECTYPE</a> iscommitted, <span class="keyword">enum</span> <a class="code" href="log__impl_8h.html#ae1aad1a6b2c71bde2d1b93df8bc54e38">LOG_PRIOR_LSA_LOCK</a> with_lock);</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> log_change_tran_as_completed (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="structlog__tdes.html">LOG_TDES</a> * tdes, <a class="code" href="log__impl_8h.html#ab85dbe80b115a32bf7a430c32ddc5b8b">LOG_RECTYPE</a> iscommitted,</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                      <a class="code" href="structlog__lsa.html">LOG_LSA</a> * lsa);</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> log_append_commit_log (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="structlog__tdes.html">LOG_TDES</a> * tdes, <a class="code" href="structlog__lsa.html">LOG_LSA</a> * commit_lsa);</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> log_append_commit_log_with_lock (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="structlog__tdes.html">LOG_TDES</a> * tdes, <a class="code" href="structlog__lsa.html">LOG_LSA</a> * commit_lsa);</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> log_append_abort_log (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="structlog__tdes.html">LOG_TDES</a> * tdes, <a class="code" href="structlog__lsa.html">LOG_LSA</a> * abort_lsa);</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> log_rollback_classrepr_cache (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="structlog__tdes.html">LOG_TDES</a> * tdes, <a class="code" href="structlog__lsa.html">LOG_LSA</a> * upto_lsa);</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> log_free_lob_locator (<a class="code" href="structlob__locator__entry.html">LOB_LOCATOR_ENTRY</a> * entry);</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> lob_locator_cmp (<span class="keyword">const</span> <a class="code" href="structlob__locator__entry.html">LOB_LOCATOR_ENTRY</a> * e1, <span class="keyword">const</span> <a class="code" href="structlob__locator__entry.html">LOB_LOCATOR_ENTRY</a> * e2);</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment">/* RB_PROTOTYPE_STATIC declares red-black tree functions. see base/rb_tree.h */</span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<a class="code" href="log__manager_8c.html#a3d4edebd76e57a967b3cf677e1599c6c">RB_PROTOTYPE_STATIC</a> (lob_rb_root, <a class="code" href="structlob__locator__entry.html">lob_locator_entry</a>, head, lob_locator_cmp);</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> log_dump_record_header_to_string (<a class="code" href="structlog__rec__header.html">LOG_RECORD_HEADER</a> * log, <span class="keywordtype">char</span> *buf, <span class="keywordtype">size_t</span> <a class="code" href="expat_8h.html#afed088663f8704004425cdae2120b9b3">len</a>);</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> log_ascii_dump (FILE * out_fp, <span class="keywordtype">int</span> length, <span class="keywordtype">void</span> *<a class="code" href="namespacestatdump__to__csv.html#aedcb70fde9c0b07a0732db70deeec616">data</a>);</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> log_hexa_dump (FILE * out_fp, <span class="keywordtype">int</span> length, <span class="keywordtype">void</span> *<a class="code" href="namespacestatdump__to__csv.html#aedcb70fde9c0b07a0732db70deeec616">data</a>);</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> log_dump_data (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, FILE * out_fp, <span class="keywordtype">int</span> length, <a class="code" href="structlog__lsa.html">LOG_LSA</a> * <a class="code" href="structlog__lsa.html">log_lsa</a>, <a class="code" href="structlog__page.html">LOG_PAGE</a> * log_page_p,</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;               <span class="keywordtype">void</span> (*dumpfun) (FILE * fp, <span class="keywordtype">int</span>, <span class="keywordtype">void</span> *), <a class="code" href="structlog__zip.html">LOG_ZIP</a> * log_dump_ptr);</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> log_dump_header (FILE * out_fp, <a class="code" href="structlog__header.html">LOG_HEADER</a> * log_header_p);</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="keyword">static</span> <a class="code" href="structlog__page.html">LOG_PAGE</a> *log_dump_record_undoredo (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, FILE * out_fp, <a class="code" href="structlog__lsa.html">LOG_LSA</a> * lsa_p,</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                       <a class="code" href="structlog__page.html">LOG_PAGE</a> * log_page_p, <a class="code" href="structlog__zip.html">LOG_ZIP</a> * log_zip_p);</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="keyword">static</span> <a class="code" href="structlog__page.html">LOG_PAGE</a> *log_dump_record_undo (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, FILE * out_fp, <a class="code" href="structlog__lsa.html">LOG_LSA</a> * lsa_p, <a class="code" href="structlog__page.html">LOG_PAGE</a> * log_page_p,</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                       <a class="code" href="structlog__zip.html">LOG_ZIP</a> * log_zip_p);</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="keyword">static</span> <a class="code" href="structlog__page.html">LOG_PAGE</a> *log_dump_record_redo (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, FILE * out_fp, <a class="code" href="structlog__lsa.html">LOG_LSA</a> * lsa_p, <a class="code" href="structlog__page.html">LOG_PAGE</a> * log_page_p,</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                       <a class="code" href="structlog__zip.html">LOG_ZIP</a> * log_zip_p);</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="keyword">static</span> <a class="code" href="structlog__page.html">LOG_PAGE</a> *log_dump_record_mvcc_undoredo (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, FILE * out_fp, <a class="code" href="structlog__lsa.html">LOG_LSA</a> * lsa_p,</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                        <a class="code" href="structlog__page.html">LOG_PAGE</a> * log_page_p, <a class="code" href="structlog__zip.html">LOG_ZIP</a> * log_zip_p);</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="keyword">static</span> <a class="code" href="structlog__page.html">LOG_PAGE</a> *log_dump_record_mvcc_undo (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, FILE * out_fp, <a class="code" href="structlog__lsa.html">LOG_LSA</a> * lsa_p,</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                        <a class="code" href="structlog__page.html">LOG_PAGE</a> * log_page_p, <a class="code" href="structlog__zip.html">LOG_ZIP</a> * log_zip_p);</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="keyword">static</span> <a class="code" href="structlog__page.html">LOG_PAGE</a> *log_dump_record_mvcc_redo (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, FILE * out_fp, <a class="code" href="structlog__lsa.html">LOG_LSA</a> * lsa_p,</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;                        <a class="code" href="structlog__page.html">LOG_PAGE</a> * log_page_p, <a class="code" href="structlog__zip.html">LOG_ZIP</a> * log_zip_p);</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="keyword">static</span> <a class="code" href="structlog__page.html">LOG_PAGE</a> *log_dump_record_postpone (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, FILE * out_fp, <a class="code" href="structlog__lsa.html">LOG_LSA</a> * lsa_p,</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                       <a class="code" href="structlog__page.html">LOG_PAGE</a> * log_page_p);</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="keyword">static</span> <a class="code" href="structlog__page.html">LOG_PAGE</a> *log_dump_record_dbout_redo (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, FILE * out_fp, <a class="code" href="structlog__lsa.html">LOG_LSA</a> * lsa_p,</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                         <a class="code" href="structlog__page.html">LOG_PAGE</a> * log_page_p);</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="keyword">static</span> <a class="code" href="structlog__page.html">LOG_PAGE</a> *log_dump_record_compensate (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, FILE * out_fp, <a class="code" href="structlog__lsa.html">LOG_LSA</a> * lsa_p,</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                         <a class="code" href="structlog__page.html">LOG_PAGE</a> * log_page_p);</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="keyword">static</span> <a class="code" href="structlog__page.html">LOG_PAGE</a> *log_dump_record_commit_postpone (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, FILE * out_fp, <a class="code" href="structlog__lsa.html">LOG_LSA</a> * lsa_p,</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                          <a class="code" href="structlog__page.html">LOG_PAGE</a> * log_page_p);</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="keyword">static</span> <a class="code" href="structlog__page.html">LOG_PAGE</a> *log_dump_record_transaction_finish (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, FILE * out_fp, <a class="code" href="structlog__lsa.html">LOG_LSA</a> * lsa_p,</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                             <a class="code" href="structlog__page.html">LOG_PAGE</a> * log_page_p);</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="keyword">static</span> <a class="code" href="structlog__page.html">LOG_PAGE</a> *log_dump_record_replication (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, FILE * out_fp, <a class="code" href="structlog__lsa.html">LOG_LSA</a> * lsa_p,</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                          <a class="code" href="structlog__page.html">LOG_PAGE</a> * log_page_p);</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="keyword">static</span> <a class="code" href="structlog__page.html">LOG_PAGE</a> *log_dump_record_sysop_start_postpone (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, FILE * out_fp, <a class="code" href="structlog__lsa.html">LOG_LSA</a> * lsa_p,</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                               <a class="code" href="structlog__page.html">LOG_PAGE</a> * log_page_p, <a class="code" href="structlog__zip.html">LOG_ZIP</a> * log_zip_p);</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="keyword">static</span> <a class="code" href="structlog__page.html">LOG_PAGE</a> *log_dump_record_sysop_end (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="structlog__lsa.html">LOG_LSA</a> * <a class="code" href="structlog__lsa.html">log_lsa</a>, <a class="code" href="structlog__page.html">LOG_PAGE</a> * log_page_p,</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                        <a class="code" href="structlog__zip.html">LOG_ZIP</a> * log_zip_p, FILE * out_fp);</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="keyword">static</span> <a class="code" href="structlog__page.html">LOG_PAGE</a> *log_dump_record_sysop_end_internal (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="structlog__rec__sysop__end.html">LOG_REC_SYSOP_END</a> * sysop_end,</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                             <a class="code" href="structlog__lsa.html">LOG_LSA</a> * <a class="code" href="structlog__lsa.html">log_lsa</a>, <a class="code" href="structlog__page.html">LOG_PAGE</a> * log_page_p, <a class="code" href="structlog__zip.html">LOG_ZIP</a> * log_zip_p,</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;                             FILE * out_fp);</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="keyword">static</span> <a class="code" href="structlog__page.html">LOG_PAGE</a> *log_dump_record_checkpoint (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, FILE * out_fp, <a class="code" href="structlog__lsa.html">LOG_LSA</a> * lsa_p,</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;                         <a class="code" href="structlog__page.html">LOG_PAGE</a> * log_page_p);</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> log_dump_checkpoint_topops (FILE * out_fp, <span class="keywordtype">int</span> length, <span class="keywordtype">void</span> *<a class="code" href="namespacestatdump__to__csv.html#aedcb70fde9c0b07a0732db70deeec616">data</a>);</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="keyword">static</span> <a class="code" href="structlog__page.html">LOG_PAGE</a> *log_dump_record_save_point (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, FILE * out_fp, <a class="code" href="structlog__lsa.html">LOG_LSA</a> * lsa_p,</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;                         <a class="code" href="structlog__page.html">LOG_PAGE</a> * log_page_p);</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="keyword">static</span> <a class="code" href="structlog__page.html">LOG_PAGE</a> *log_dump_record_2pc_prepare_commit (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, FILE * out_fp, <a class="code" href="structlog__lsa.html">LOG_LSA</a> * lsa_p,</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                             <a class="code" href="structlog__page.html">LOG_PAGE</a> * log_page_p);</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="keyword">static</span> <a class="code" href="structlog__page.html">LOG_PAGE</a> *log_dump_record_2pc_start (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, FILE * out_fp, <a class="code" href="structlog__lsa.html">LOG_LSA</a> * lsa_p,</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                        <a class="code" href="structlog__page.html">LOG_PAGE</a> * log_page_p);</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="keyword">static</span> <a class="code" href="structlog__page.html">LOG_PAGE</a> *log_dump_record_2pc_acknowledgement (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, FILE * out_fp, <a class="code" href="structlog__lsa.html">LOG_LSA</a> * lsa_p,</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                              <a class="code" href="structlog__page.html">LOG_PAGE</a> * log_page_p);</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="keyword">static</span> <a class="code" href="structlog__page.html">LOG_PAGE</a> *log_dump_record_ha_server_state (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, FILE * out_fp, <a class="code" href="structlog__lsa.html">LOG_LSA</a> * <a class="code" href="structlog__lsa.html">log_lsa</a>,</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;                          <a class="code" href="structlog__page.html">LOG_PAGE</a> * log_page_p);</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="keyword">static</span> <a class="code" href="structlog__page.html">LOG_PAGE</a> *log_dump_record (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, FILE * out_fp, <a class="code" href="log__impl_8h.html#ab85dbe80b115a32bf7a430c32ddc5b8b">LOG_RECTYPE</a> record_type, <a class="code" href="structlog__lsa.html">LOG_LSA</a> * lsa_p,</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                  <a class="code" href="structlog__page.html">LOG_PAGE</a> * log_page_p, <a class="code" href="structlog__zip.html">LOG_ZIP</a> * log_zip_p);</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> log_rollback_record (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="structlog__lsa.html">LOG_LSA</a> * <a class="code" href="structlog__lsa.html">log_lsa</a>, <a class="code" href="structlog__page.html">LOG_PAGE</a> * log_page_p,</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;                 <a class="code" href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2b">LOG_RCVINDEX</a> rcvindex, <a class="code" href="structvpid.html">VPID</a> * rcv_vpid, <a class="code" href="structlog__rcv.html">LOG_RCV</a> * rcv, <a class="code" href="structlog__tdes.html">LOG_TDES</a> * tdes,</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                 <a class="code" href="structlog__zip.html">LOG_ZIP</a> * log_unzip_ptr);</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> log_undo_rec_restartable (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2b">LOG_RCVINDEX</a> rcvindex, <a class="code" href="structlog__rcv.html">LOG_RCV</a> * rcv);</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> log_rollback (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="structlog__tdes.html">LOG_TDES</a> * tdes, <span class="keyword">const</span> <a class="code" href="structlog__lsa.html">LOG_LSA</a> * upto_lsa_ptr);</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> log_run_postpone_op (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="structlog__lsa.html">LOG_LSA</a> * <a class="code" href="structlog__lsa.html">log_lsa</a>, <a class="code" href="structlog__page.html">LOG_PAGE</a> * log_pgptr);</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> log_find_end_log (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="structlog__lsa.html">LOG_LSA</a> * end_lsa);</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span> log_is_valid_locator (<span class="keyword">const</span> <span class="keywordtype">char</span> *locator);</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> log_cleanup_modified_class (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="structmodified__class__entry.html">MODIFIED_CLASS_ENTRY</a> * t, <span class="keywordtype">void</span> *<a class="code" href="expat_8h.html#a9ce2ec4812a92cb6ab39f6e81e9173a9">arg</a>);</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> log_map_modified_class_list (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="structlog__tdes.html">LOG_TDES</a> * tdes, <a class="code" href="structlog__lsa.html">LOG_LSA</a> * savept_lsa, <span class="keywordtype">bool</span> release,</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;                     <span class="keywordtype">void</span> (*map_func) (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="structmodified__class__entry.html">MODIFIED_CLASS_ENTRY</a> * clazz,</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;                               <span class="keywordtype">void</span> *<a class="code" href="expat_8h.html#a9ce2ec4812a92cb6ab39f6e81e9173a9">arg</a>), <span class="keywordtype">void</span> *<a class="code" href="expat_8h.html#a9ce2ec4812a92cb6ab39f6e81e9173a9">arg</a>);</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> log_cleanup_modified_class_list (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="structlog__tdes.html">LOG_TDES</a> * tdes, <a class="code" href="structlog__lsa.html">LOG_LSA</a> * savept_lsa,</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                         <span class="keywordtype">bool</span> release, <span class="keywordtype">bool</span> decache_classrepr);</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> log_append_compensate_internal (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2b">LOG_RCVINDEX</a> rcvindex, <span class="keyword">const</span> <a class="code" href="structvpid.html">VPID</a> * <a class="code" href="structvpid.html">vpid</a>,</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;                        <a class="code" href="storage__common_8h.html#ac3f9d7ae37c5a4cb27570f7313891bc8">PGLENGTH</a> <a class="code" href="expat_8h.html#ad0c30ee1add42468a6d7c022f2efdf70">offset</a>, <a class="code" href="storage__common_8h.html#ae4a052db40daa4a44a890bad45d8ecdc">PAGE_PTR</a> pgptr, <span class="keywordtype">int</span> length, <span class="keyword">const</span> <span class="keywordtype">void</span> *<a class="code" href="namespacestatdump__to__csv.html#aedcb70fde9c0b07a0732db70deeec616">data</a>,</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;                        <a class="code" href="structlog__tdes.html">LOG_TDES</a> * tdes, <span class="keyword">const</span> <a class="code" href="structlog__lsa.html">LOG_LSA</a> * undo_nxlsa);</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<a class="code" href="porting_8h.html#a718749e18d63ca0d6b0d1b918efb41d6">STATIC_INLINE</a> <span class="keywordtype">void</span> <a class="code" href="log__manager_8c.html#aa47fde07d75699fe2a4167ba8d760664">log_sysop_end_random_exit</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p) <a class="code" href="porting_8h.html#a0cbd627eb8cc7711df91bf84de75bd82">__attribute__</a> ((<a class="code" href="porting_8h.html#aa1dec568e79152c892dcf63f445cbd7a">ALWAYS_INLINE</a>));</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<a class="code" href="porting_8h.html#a718749e18d63ca0d6b0d1b918efb41d6">STATIC_INLINE</a> <span class="keywordtype">void</span> <a class="code" href="log__manager_8c.html#a1504524244c9badcc53c1bb8b0d4213f">log_sysop_end_begin</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <span class="keywordtype">int</span> *tran_index_out, <a class="code" href="structlog__tdes.html">LOG_TDES</a> ** tdes_out)</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  <a class="code" href="porting_8h.html#a0cbd627eb8cc7711df91bf84de75bd82">__attribute__</a> ((<a class="code" href="porting_8h.html#aa1dec568e79152c892dcf63f445cbd7a">ALWAYS_INLINE</a>));</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<a class="code" href="porting_8h.html#a718749e18d63ca0d6b0d1b918efb41d6">STATIC_INLINE</a> <span class="keywordtype">void</span> <a class="code" href="log__manager_8c.html#af1e00d30dcc26ca3a967f9bd1a82cb27">log_sysop_end_unstack</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="structlog__tdes.html">LOG_TDES</a> * tdes) <a class="code" href="porting_8h.html#a0cbd627eb8cc7711df91bf84de75bd82">__attribute__</a> ((<a class="code" href="porting_8h.html#aa1dec568e79152c892dcf63f445cbd7a">ALWAYS_INLINE</a>));</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<a class="code" href="porting_8h.html#a718749e18d63ca0d6b0d1b918efb41d6">STATIC_INLINE</a> <span class="keywordtype">void</span> <a class="code" href="log__manager_8c.html#acede8354bdcf6ae570ee030b4f57c07b">log_sysop_end_final</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="structlog__tdes.html">LOG_TDES</a> * tdes) <a class="code" href="porting_8h.html#a0cbd627eb8cc7711df91bf84de75bd82">__attribute__</a> ((<a class="code" href="porting_8h.html#aa1dec568e79152c892dcf63f445cbd7a">ALWAYS_INLINE</a>));</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> log_sysop_commit_internal (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="structlog__rec__sysop__end.html">LOG_REC_SYSOP_END</a> * log_record, <span class="keywordtype">int</span> data_size,</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                       <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="namespacestatdump__to__csv.html#aedcb70fde9c0b07a0732db70deeec616">data</a>, <span class="keywordtype">bool</span> is_rv_finish_postpone);</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<a class="code" href="porting_8h.html#a718749e18d63ca0d6b0d1b918efb41d6">STATIC_INLINE</a> <span class="keywordtype">void</span> <a class="code" href="log__manager_8c.html#ac6a08ce8b6271d689e48b7bd96a32c7a">log_sysop_get_tran_index_and_tdes</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <span class="keywordtype">int</span> *tran_index_out,</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                              <a class="code" href="structlog__tdes.html">LOG_TDES</a> ** tdes_out) <a class="code" href="porting_8h.html#a0cbd627eb8cc7711df91bf84de75bd82">__attribute__</a> ((<a class="code" href="porting_8h.html#aa1dec568e79152c892dcf63f445cbd7a">ALWAYS_INLINE</a>));</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<a class="code" href="porting_8h.html#a718749e18d63ca0d6b0d1b918efb41d6">STATIC_INLINE</a> <span class="keywordtype">int</span> <a class="code" href="log__manager_8c.html#a3cec5baaf013ea91aa2dca8fe7860686">log_sysop_get_level</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p) <a class="code" href="porting_8h.html#a0cbd627eb8cc7711df91bf84de75bd82">__attribute__</a> ((<a class="code" href="porting_8h.html#aa1dec568e79152c892dcf63f445cbd7a">ALWAYS_INLINE</a>));</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> log_tran_do_postpone (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="structlog__tdes.html">LOG_TDES</a> * tdes);</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> log_sysop_do_postpone (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="structlog__tdes.html">LOG_TDES</a> * tdes, <a class="code" href="structlog__rec__sysop__end.html">LOG_REC_SYSOP_END</a> * sysop_end,</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                   <span class="keywordtype">int</span> data_size, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="namespacestatdump__to__csv.html#aedcb70fde9c0b07a0732db70deeec616">data</a>);</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="preprocessor">#if defined(SERVER_MODE)</span></div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment">// *INDENT-OFF*</span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="keyword">static</span> <a class="code" href="classcubthread_1_1daemon.html">cubthread::daemon</a> *log_Clock_daemon = <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="keyword">static</span> <a class="code" href="classcubthread_1_1daemon.html">cubthread::daemon</a> *log_Checkpoint_daemon = <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="keyword">static</span> <a class="code" href="classcubthread_1_1daemon.html">cubthread::daemon</a> *log_Remove_log_archive_daemon = <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="keyword">static</span> <a class="code" href="classcubthread_1_1daemon.html">cubthread::daemon</a> *log_Check_ha_delay_info_daemon = <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="keyword">static</span> <a class="code" href="classcubthread_1_1daemon.html">cubthread::daemon</a> *log_Flush_daemon = <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="keyword">static</span> std::atomic_bool log_Flush_has_been_requested = {<span class="keyword">false</span>};</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="comment">// *INDENT-ON*</span></div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> log_daemons_init ();</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span> log_daemons_destroy ();</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="comment">// used by log_Check_ha_delay_info_daemon</span></div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="catalog__class_8c.html#ae5a7d7ee65169187ff2edadd52509381">catcls_get_apply_info_log_record_time</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, time_t * log_record_time);</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* SERVER_MODE */</span><span class="preprocessor"></span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="comment"> * log_rectype_string - RETURN TYPE OF LOG RECORD IN STRING FORMAT</span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="comment"> * return:</span></div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="comment"> *   type(in): Type of log record</span></div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="comment"> * NOTE: Return the type of the log record in string format</span></div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="keyword">const</span> <span class="keywordtype">char</span> *</div><div class="line"><a name="l00388"></a><span class="lineno"><a class="line" href="log__manager_8h.html#a6e093782f446a5806cc9631a97eba1c3">  388</a></span>&#160;<a class="code" href="log__manager_8c.html#a6e093782f446a5806cc9631a97eba1c3">log_to_string</a> (<a class="code" href="log__impl_8h.html#ab85dbe80b115a32bf7a430c32ddc5b8b">LOG_RECTYPE</a> <a class="code" href="atldb__cubrid_8h.html#ad939da76b5d12fca40de18001582d63a">type</a>)</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;{</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  <span class="keywordflow">switch</span> (<a class="code" href="atldb__cubrid_8h.html#ad939da76b5d12fca40de18001582d63a">type</a>)</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    {</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7aa0d885a58816898b0877635fc7f15716">LOG_UNDOREDO_DATA</a>:</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;LOG_UNDOREDO_DATA&quot;</span>;</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a1e8c5c5dbe12e8cc2388691db7011740">LOG_DIFF_UNDOREDO_DATA</a>:    <span class="comment">/* LOG DIFF undo and redo data */</span></div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;LOG_DIFF_UNDOREDO_DATA&quot;</span>;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a661c01f08dbb476251ceae0d99bb5412">LOG_UNDO_DATA</a>:</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;LOG_UNDO_DATA&quot;</span>;</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7ac17426d82957cd6c312341d4f5badd87">LOG_REDO_DATA</a>:</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;LOG_REDO_DATA&quot;</span>;</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7ab4e00d9048c5782ee68b646ff785f6de">LOG_MVCC_UNDOREDO_DATA</a>:</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;LOG_MVCC_UNDOREDO_DATA&quot;</span>;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7ae03e50858368a0a9e96e4cb7ce991354">LOG_MVCC_DIFF_UNDOREDO_DATA</a>:</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;LOG_MVCC_DIFF_UNDOREDO_DATA&quot;</span>;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a5eb32eedc7671f3f89c1b10c3d0229c1">LOG_MVCC_UNDO_DATA</a>:</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;LOG_MVCC_UNDO_DATA&quot;</span>;</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a4252bfab0a4f9fbbcd7bd68ba32dea1d">LOG_MVCC_REDO_DATA</a>:</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;LOG_MVCC_REDO_DATA&quot;</span>;</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a7557d9dfb53f14fd3b6eef04a165476b">LOG_DBEXTERN_REDO_DATA</a>:</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;LOG_DBEXTERN_REDO_DATA&quot;</span>;</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7ab9a91cb4efa2ad495c98d7dc7fef8ee1">LOG_DUMMY_HEAD_POSTPONE</a>:</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;LOG_DUMMY_HEAD_POSTPONE&quot;</span>;</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7acf273d42fe8e9c360fb16c8c0f96c480">LOG_POSTPONE</a>:</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;LOG_POSTPONE&quot;</span>;</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a59ac89fe85edd8011e84db21095290a7">LOG_RUN_POSTPONE</a>:</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;LOG_RUN_POSTPONE&quot;</span>;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a92e0794a329897d52f3345d13359914e">LOG_COMPENSATE</a>:</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;LOG_COMPENSATE&quot;</span>;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a40516d04f27c98062921adb5282b4933">LOG_WILL_COMMIT</a>:</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;LOG_WILL_COMMIT&quot;</span>;</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a6b03dd6d350881f805f7b3adeedcf10f">LOG_COMMIT_WITH_POSTPONE</a>:</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;LOG_COMMIT_WITH_POSTPONE&quot;</span>;</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a1903de7cf7fa88081eb8010a667e1839">LOG_COMMIT</a>:</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;LOG_COMMIT&quot;</span>;</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a198b93b13d51133e5e5d4b8e7c62f54e">LOG_SYSOP_START_POSTPONE</a>:</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;LOG_SYSOP_START_POSTPONE&quot;</span>;</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a29a7c510ffdadeb0e4c5304e6825a5ec">LOG_SYSOP_END</a>:</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;LOG_SYSOP_END&quot;</span>;</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a66f7a15b57486fb9081e733c142d35ea">LOG_ABORT</a>:</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;LOG_ABORT&quot;</span>;</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a9e2aba85fbc168e57ae1744fa9da8a88">LOG_START_CHKPT</a>:</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;LOG_START_CHKPT&quot;</span>;</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a76c06d374c551ca295e0594b74c9ff19">LOG_END_CHKPT</a>:</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;LOG_END_CHKPT&quot;</span>;</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7ae96755081dc4d3599f98356864dfd7e0">LOG_SAVEPOINT</a>:</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;LOG_SAVEPOINT&quot;</span>;</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7aa83e8becd5b186f65485f6e819e416ea">LOG_2PC_PREPARE</a>:</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;LOG_2PC_PREPARE&quot;</span>;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a69f87b42501f2ccfe66922ab196102d7">LOG_2PC_START</a>:</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;LOG_2PC_START&quot;</span>;</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a15a1ebeb5fd50ffb5ae73b0cb26f9e7e">LOG_2PC_COMMIT_DECISION</a>:</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;LOG_2PC_COMMIT_DECISION&quot;</span>;</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a869d94e68bfc3354ad6bd211130cf13b">LOG_2PC_ABORT_DECISION</a>:</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;LOG_2PC_ABORT_DECISION&quot;</span>;</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a1ea8bf762d53de919a4eec322ebe9a1d">LOG_2PC_COMMIT_INFORM_PARTICPS</a>:</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;LOG_2PC_COMMIT_INFORM_PARTICPS&quot;</span>;</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a017e6014fefb381f8583c7ccd87c4133">LOG_2PC_ABORT_INFORM_PARTICPS</a>:</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;LOG_2PC_ABORT_INFORM_PARTICPS&quot;</span>;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a4ab5b053c95a07cab41de19454b7663c">LOG_2PC_RECV_ACK</a>:</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;LOG_2PC_RECV_ACK&quot;</span>;</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a1ec512ba54217805936aa5afb03b3d98">LOG_DUMMY_CRASH_RECOVERY</a>:</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;LOG_DUMMY_CRASH_RECOVERY&quot;</span>;</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a034d486f56b110bc31fba3b6db5dd980">LOG_END_OF_LOG</a>:</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;LOG_END_OF_LOG&quot;</span>;</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a97003f753507d5a7a65a0bf078a078f4">LOG_REPLICATION_DATA</a>:</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;LOG_REPLICATION_DATA&quot;</span>;</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7ac9476ec323cd3909823f79ecc3938afd">LOG_REPLICATION_STATEMENT</a>:</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;LOG_REPLICATION_STATEMENT&quot;</span>;</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a3839799b1d15f4333e439c136a3a21ca">LOG_SYSOP_ATOMIC_START</a>:</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;LOG_SYSOP_ATOMIC_START&quot;</span>;</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a942105cb887dd1030b0c6151087d24ac">LOG_DUMMY_HA_SERVER_STATE</a>:</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;LOG_DUMMY_HA_SERVER_STATE&quot;</span>;</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a3d03de268419fc962e6ca48de324a644">LOG_DUMMY_OVF_RECORD</a>:</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;LOG_DUMMY_OVF_RECORD&quot;</span>;</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7aec133d8bc86aabdcf6dcda157999bd21">LOG_DUMMY_GENERIC</a>:</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;LOG_DUMMY_GENERIC&quot;</span>;</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a8fc57c015374d8ecf822c5ea0f39faa0">LOG_SMALLER_LOGREC_TYPE</a>:</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a25bfb5a0ac528c508558bd8be6704739">LOG_LARGER_LOGREC_TYPE</a>:</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    <span class="keywordflow">default</span>:</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;      <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (<span class="keyword">false</span>);</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    }</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;  <span class="keywordflow">return</span> <span class="stringliteral">&quot;UNKNOWN_LOG_REC_TYPE&quot;</span>;</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;}</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="comment"> * log_is_in_crash_recovery - are we in crash recovery ?</span></div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="comment"> * return:</span></div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="comment"> * NOTE: Are we in crash recovery time ?</span></div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="keywordtype">bool</span></div><div class="line"><a name="l00521"></a><span class="lineno"><a class="line" href="log__manager_8h.html#a2caab20af5b0e7a0a89abf77ffa8e404">  521</a></span>&#160;<a class="code" href="log__manager_8c.html#a2caab20af5b0e7a0a89abf77ffa8e404">log_is_in_crash_recovery</a> (<span class="keywordtype">void</span>)</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;{</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="log__impl_8h.html#a8f08025b469332f89fee8ce83dc2d3ff">LOG_ISRESTARTED</a> ())</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    {</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    }</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    {</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    }</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;}</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;<span class="comment"> * log_is_in_crash_recovery_and_not_year_complets_redo - completes redo recovery?</span></div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="comment"> * return:</span></div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="keywordtype">bool</span></div><div class="line"><a name="l00540"></a><span class="lineno"><a class="line" href="log__manager_8h.html#a473bb054a7d22bdf84f89cac923ea9ac">  540</a></span>&#160;<a class="code" href="log__manager_8c.html#a473bb054a7d22bdf84f89cac923ea9ac">log_is_in_crash_recovery_and_not_yet_completes_redo</a> (<span class="keywordtype">void</span>)</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;{</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a7f624279622c1c0c52492877129f95c6">rcv_phase</a> == <a class="code" href="log__impl_8h.html#a7377d8298f9fa6a5d11a79e4fb412729aef403ca21850fa90e6cdf48715ef9f94">LOG_RECOVERY_ANALYSIS_PHASE</a> || <a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a7f624279622c1c0c52492877129f95c6">rcv_phase</a> == <a class="code" href="log__impl_8h.html#a7377d8298f9fa6a5d11a79e4fb412729a786efe8f7626ad4859a7b0fd1880c18a">LOG_RECOVERY_REDO_PHASE</a>)</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    {</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    }</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    {</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    }</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;}</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;<span class="comment"> * log_get_restart_lsa - FIND RESTART LOG SEQUENCE ADDRESS</span></div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="comment"> * return:</span></div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;<span class="comment"> * NOTE: Find the restart log sequence address.</span></div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<a class="code" href="structlog__lsa.html">LOG_LSA</a> *</div><div class="line"><a name="l00560"></a><span class="lineno"><a class="line" href="log__manager_8h.html#ae1eeb2b0f7ebd757e323a4a866b4edc9">  560</a></span>&#160;<a class="code" href="log__manager_8c.html#ae1eeb2b0f7ebd757e323a4a866b4edc9">log_get_restart_lsa</a> (<span class="keywordtype">void</span>)</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;{</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="log__impl_8h.html#a8f08025b469332f89fee8ce83dc2d3ff">LOG_ISRESTARTED</a> ())</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    {</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;      <span class="keywordflow">return</span> &amp;<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a73c801b0d3d19a743cf3d20ec7ae63c6">rcv_phase_lsa</a>;</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    }</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    {</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;      <span class="keywordflow">return</span> &amp;<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>.<a class="code" href="structlog__header.html#abd3c92d1eb868dd630bdbfa3561ecf9e">chkpt_lsa</a>;</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    }</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;}</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;<span class="comment"> * log_get_crash_point_lsa - get last lsa address of the log before a crash</span></div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;<span class="comment"> * return:</span></div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;<span class="comment"> * NOTE: Find the log sequence address at the time of a crash.  This</span></div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;<span class="comment"> *   function can only be called during the recovery phases after analysis</span></div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<span class="comment"> *   and prior to RESTART.</span></div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<a class="code" href="structlog__lsa.html">LOG_LSA</a> *</div><div class="line"><a name="l00582"></a><span class="lineno"><a class="line" href="log__manager_8h.html#a656b541276983a5b1306515c1c568ec7">  582</a></span>&#160;<a class="code" href="log__manager_8c.html#a656b541276983a5b1306515c1c568ec7">log_get_crash_point_lsa</a> (<span class="keywordtype">void</span>)</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;{</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="preprocessor">#if defined(CUBRID_DEBUG)</span></div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a7f624279622c1c0c52492877129f95c6">rcv_phase</a> &lt;= <a class="code" href="log__impl_8h.html#a7377d8298f9fa6a5d11a79e4fb412729aef403ca21850fa90e6cdf48715ef9f94">LOG_RECOVERY_ANALYSIS_PHASE</a>)</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    {</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;      <span class="comment">/* i.e. cannot be RESTARTED or ANALYSIS */</span></div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;      <a class="code" href="error__manager_8h.html#a075eb8873354909bbe8edafa0f18f58c">er_log_debug</a> (<a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>,</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;            <span class="stringliteral">&quot;log_find_crash_point_lsa: Warning, only expected to be called during recovery phases.&quot;</span>);</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    }</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* CUBRID_DEBUG */</span><span class="preprocessor"></span></div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;  <span class="keywordflow">return</span> (&amp;<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a73c801b0d3d19a743cf3d20ec7ae63c6">rcv_phase_lsa</a>);</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;}</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;<span class="comment"> * log_find_find_lsa -</span></div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;<span class="comment"> * return:</span></div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;<span class="comment"> * NOTE:</span></div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;<a class="code" href="structlog__lsa.html">LOG_LSA</a> *</div><div class="line"><a name="l00604"></a><span class="lineno"><a class="line" href="log__manager_8h.html#ab54a94101ceaa616e6aafc64eba28387">  604</a></span>&#160;<a class="code" href="log__manager_8c.html#ab54a94101ceaa616e6aafc64eba28387">log_get_append_lsa</a> (<span class="keywordtype">void</span>)</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;{</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;  <span class="keywordflow">return</span> (&amp;<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>.<a class="code" href="structlog__header.html#a982b3e55dedc3dabc54a1a7fcddc144e">append_lsa</a>);</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;}</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;<span class="comment"> * log_get_eof_lsa -</span></div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;<span class="comment"> * return:</span></div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;<span class="comment"> * NOTE:</span></div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;<a class="code" href="structlog__lsa.html">LOG_LSA</a> *</div><div class="line"><a name="l00617"></a><span class="lineno"><a class="line" href="log__manager_8h.html#a90c9718c441f1c4a8c37c48542494fab">  617</a></span>&#160;<a class="code" href="log__manager_8c.html#a90c9718c441f1c4a8c37c48542494fab">log_get_eof_lsa</a> (<span class="keywordtype">void</span>)</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;{</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;  <span class="keywordflow">return</span> (&amp;<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>.<a class="code" href="structlog__header.html#a87b66e6b3d5872e8e0967a42abf04ea6">eof_lsa</a>);</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;}</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;<span class="comment"> * log_is_logged_since_restart - is log sequence address made after restart ?</span></div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;<span class="comment"> * return:</span></div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;<span class="comment"> *   lsa_ptr(in): Log sequence address attached to page</span></div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;<span class="comment"> * NOTE: Find if the log sequence address has been made after restart.</span></div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;<span class="comment"> *              This function is useful to detect bugs. For example, when a</span></div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;<span class="comment"> *              data page (actually a buffer)is freed, and the page is dirty,</span></div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;<span class="comment"> *              there should be a log record for some data of the page,</span></div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;<span class="comment"> *              otherwise, a potential error exists. It is clear that this</span></div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;<span class="comment"> *              function will not detect all kinds of errors, but it will help</span></div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;<span class="comment"> *              some.</span></div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;<span class="keywordtype">bool</span></div><div class="line"><a name="l00638"></a><span class="lineno"><a class="line" href="log__manager_8h.html#a9947563d0c9dba8024923957fb69bb85">  638</a></span>&#160;<a class="code" href="log__manager_8c.html#a9947563d0c9dba8024923957fb69bb85">log_is_logged_since_restart</a> (<span class="keyword">const</span> <a class="code" href="structlog__lsa.html">LOG_LSA</a> * lsa_ptr)</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;{</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;  <span class="keywordflow">return</span> (!<a class="code" href="log__impl_8h.html#a8f08025b469332f89fee8ce83dc2d3ff">LOG_ISRESTARTED</a> () || <a class="code" href="storage__common_8h.html#a7f9d98414f81d41e639e744027e15947">LSA_LE</a> (&amp;<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a73c801b0d3d19a743cf3d20ec7ae63c6">rcv_phase_lsa</a>, lsa_ptr));</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;}</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;<span class="preprocessor">#if defined(SA_MODE)</span></div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;<span class="comment"> * log_get_final_restored_lsa -</span></div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;<span class="comment"> * return:</span></div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;<span class="comment"> * NOTE:</span></div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;<a class="code" href="structlog__lsa.html">LOG_LSA</a> *</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;<a class="code" href="xserver__interface_8h.html#aa649c59686e25bf7fb7609f8c7dd0989">log_get_final_restored_lsa</a> (<span class="keywordtype">void</span>)</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;{</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;  <span class="keywordflow">return</span> (&amp;<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a54df6484811f3eeaceb445c50426e066">final_restored_lsa</a>);</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;}</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* SA_MODE */</span><span class="preprocessor"></span></div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;<span class="comment"> * FUNCTION RELATED TO INITIALIZATION AND TERMINATION OF LOG MANAGER</span></div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;<span class="comment"> * log_verify_dbcreation - verify database creation time</span></div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;<span class="comment"> * return:</span></div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;<span class="comment"> *   volid(in): Volume identifier</span></div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;<span class="comment"> *   log_dbcreation(in): Database creation time according to the log.</span></div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;<span class="comment"> * NOTE:Verify if database creation time according to the log matches</span></div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;<span class="comment"> *              the one according to the database volume. If they do not, it</span></div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;<span class="comment"> *              is likely that the log and data volume does not correspond to</span></div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;<span class="comment"> *              the same database.</span></div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span></div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;log_verify_dbcreation (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="storage__common_8h.html#a0da39ba47abe69bdc4cf837e4890d7ab">VOLID</a> volid, <span class="keyword">const</span> <a class="code" href="cm__broker__admin_8c.html#a8606fb1d53339b43e7417d2f96db025f">INT64</a> * log_dbcreation)</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;{</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;  <a class="code" href="cm__broker__admin_8c.html#a8606fb1d53339b43e7417d2f96db025f">INT64</a> vol_dbcreation;     <span class="comment">/* Database creation time in volume */</span></div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="disk__manager_8c.html#a24f513433165475abd985275f2eedda2">disk_get_creation_time</a> (thread_p, volid, &amp;vol_dbcreation) != <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>)</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    {</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    }</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;  <span class="keywordflow">if</span> (difftime ((time_t) vol_dbcreation, (time_t) (*log_dbcreation)) == 0)</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    {</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    }</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;    {</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    }</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;}</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;<span class="comment"> * log_get_db_start_parameters - Get start parameters</span></div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;<span class="comment"> * return: nothing</span></div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;<span class="comment"> *   db_creation(out): Database creation time</span></div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;<span class="comment"> *   chkpt_lsa(out): Last checkpoint address</span></div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;<span class="comment"> * NOTE: Get the start parameters: database creation time and the last</span></div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;<span class="comment"> *              checkpoint process.</span></div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;<span class="comment"> *              For safety reasons, the database creation time is included, in</span></div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;<span class="comment"> *              all database volumes and the log. This value allows verifying</span></div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;<span class="comment"> *              if a log and a data volume correspond to the same database.</span></div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;<span class="comment"> *       This function is used to obtain the database creation time and</span></div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;<span class="comment"> *              the last checkpoint address, so that they can be included in</span></div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;<span class="comment"> *              new defined volumes.</span></div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;<span class="keywordtype">int</span></div><div class="line"><a name="l00713"></a><span class="lineno"><a class="line" href="log__manager_8h.html#a261a2f1a76400a49a6d0babe12e31f98">  713</a></span>&#160;<a class="code" href="log__manager_8c.html#a261a2f1a76400a49a6d0babe12e31f98">log_get_db_start_parameters</a> (<a class="code" href="cm__broker__admin_8c.html#a8606fb1d53339b43e7417d2f96db025f">INT64</a> * db_creation, <a class="code" href="structlog__lsa.html">LOG_LSA</a> * chkpt_lsa)</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;{</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;<span class="preprocessor">#if defined(SERVER_MODE)</span></div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="mprec_8c.html#a115f98821af8b9ac2f97f2ac2cb2797f">rv</a>;</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* SERVER_MODE */</span><span class="preprocessor"></span></div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;  memcpy (db_creation, &amp;<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>.<a class="code" href="structlog__header.html#ab7c3c46056f412b19f447caf2ce7b861">db_creation</a>, sizeof (*db_creation));</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;  <a class="code" href="mprec_8c.html#a115f98821af8b9ac2f97f2ac2cb2797f">rv</a> = <a class="code" href="log__manager_8c.html#a3bd1ad5edf8fc93f783af77e8cd6ee9a">pthread_mutex_lock</a> (&amp;<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.chkpt_lsa_lock);</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;  memcpy (chkpt_lsa, &amp;<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>.<a class="code" href="structlog__header.html#abd3c92d1eb868dd630bdbfa3561ecf9e">chkpt_lsa</a>, sizeof (*chkpt_lsa));</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;  <a class="code" href="log__manager_8c.html#aa91b7ec8ae8a2d699fb09cc20c444fe8">pthread_mutex_unlock</a> (&amp;<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.chkpt_lsa_lock);</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>;</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;}</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;<span class="comment"> * log_get_num_pages_for_creation - find default number of pages for the log</span></div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;<span class="comment"> * return: number of pages</span></div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;<span class="comment"> *   db_npages(in): Estimated number of pages for database (for first volume of</span></div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;<span class="comment"> *               database) or -1</span></div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;<span class="comment"> * NOTE: Find the default number of pages to use during the creation of</span></div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;<span class="comment"> *              the log.</span></div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;<span class="comment"> *              If a negative value is given, the database should have been</span></div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;<span class="comment"> *              already created. That is, we are recreating the log</span></div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;<span class="keywordtype">int</span></div><div class="line"><a name="l00741"></a><span class="lineno"><a class="line" href="log__manager_8h.html#a62ffd154657b96161bcae79f707b4295">  741</a></span>&#160;<a class="code" href="log__manager_8c.html#a62ffd154657b96161bcae79f707b4295">log_get_num_pages_for_creation</a> (<span class="keywordtype">int</span> db_npages)</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;{</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;  <span class="keywordtype">int</span> log_npages;</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;  <span class="keywordtype">int</span> vdes;</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;  log_npages = db_npages;</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;  <span class="keywordflow">if</span> (log_npages &lt; 0)</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    {</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;      <span class="comment">/* </span></div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;<span class="comment">       * Use the default that is the size of the database</span></div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;<span class="comment">       * Don&#39;t use DK since the database may not be restarted at all.</span></div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;      vdes = <a class="code" href="file__io_8c.html#a9d683e94e5800584f0dfabf144fc758f">fileio_get_volume_descriptor</a> (<a class="code" href="log__impl_8h.html#a4012c5af4c2bbf3def3c0d6ffbd47edb">LOG_DBFIRST_VOLID</a>);</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;      <span class="keywordflow">if</span> (vdes != <a class="code" href="file__io_8h.html#af6836ff47a9fdc109eb60b2ed5a3093d">NULL_VOLDES</a>)</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;    {</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;      log_npages = <a class="code" href="file__io_8c.html#a6b98ae31a8457cd2e4775d6f00f1351c">fileio_get_number_of_volume_pages</a> (vdes, <a class="code" href="storage__common_8h.html#a097b8646f24ea98e209e18c53d74522a">IO_PAGESIZE</a>);</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    }</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;    }</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;  <span class="keywordflow">if</span> (log_npages &lt; 10)</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    {</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;      log_npages = 10;</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    }</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;  <span class="keywordflow">return</span> log_npages;</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;}</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;<span class="comment"> * log_create - create the active portion of the log</span></div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;<span class="comment"> * return:</span></div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;<span class="comment"> *   db_fullname(in): Full name of the database</span></div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;<span class="comment"> *   logpath(in): Directory where the log volumes reside</span></div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;<span class="comment"> *   prefix_logname(in): Name of the log volumes. It is usually set the same as</span></div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;<span class="comment"> *                      database name. For example, if the value is equal to</span></div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;<span class="comment"> *                      &quot;db&quot;, the names of the log volumes created are as</span></div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;<span class="comment"> *                      follow:</span></div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;<span class="comment"> *                      Active_log      = db_logactive</span></div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;<span class="comment"> *                      Archive_logs    = db_logarchive.0</span></div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;<span class="comment"> *                                        db_logarchive.1</span></div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;<span class="comment"> *                                             .</span></div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;<span class="comment"> *                                             .</span></div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;<span class="comment"> *                                             .</span></div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;<span class="comment"> *                                        db_logarchive.n</span></div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;<span class="comment"> *                      Log_information = db_loginfo</span></div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;<span class="comment"> *                      Database Backup = db_backup</span></div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;<span class="comment"> *   npages(in): Size of active log in pages</span></div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;<span class="comment"> * NOTE: Format/create the active log volume. The header of the volume</span></div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;<span class="comment"> *              is initialized.</span></div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;<span class="keywordtype">int</span></div><div class="line"><a name="l00794"></a><span class="lineno"><a class="line" href="log__manager_8h.html#ad2eeada203e066baffcd4c6207a573b8">  794</a></span>&#160;<a class="code" href="log__manager_8c.html#ad2eeada203e066baffcd4c6207a573b8">log_create</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <span class="keyword">const</span> <span class="keywordtype">char</span> *db_fullname, <span class="keyword">const</span> <span class="keywordtype">char</span> *logpath, <span class="keyword">const</span> <span class="keywordtype">char</span> *prefix_logname,</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;        <a class="code" href="storage__common_8h.html#a261e4bc7334f8eabe6e1f0a3d7f7dcb4">DKNPAGES</a> npages)</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;{</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;  <span class="keywordtype">int</span> error_code = <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>;</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;  <a class="code" href="cm__broker__admin_8c.html#a8606fb1d53339b43e7417d2f96db025f">INT64</a> db_creation;</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;  db_creation = <a class="code" href="namespacebrokerstatus__to__csv.html#ae075d9642cd7485bc938b7d65b2e6991">time</a> (<a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;  <span class="keywordflow">if</span> (db_creation == -1)</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    {</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;      error_code = <a class="code" href="error__code_8h.html#a51778caf175b7d6bfe9e8977d9a0032e">ER_FAILED</a>;</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;      <span class="keywordflow">return</span> error_code;</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;    }</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;  error_code = log_create_internal (thread_p, db_fullname, logpath, prefix_logname, npages, &amp;db_creation);</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;  <span class="keywordflow">if</span> (error_code != <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>)</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;    {</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;      <span class="keywordflow">return</span> error_code;</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;    }</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>;</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;}</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;<span class="comment"> * log_create_internal -</span></div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;<span class="comment"> * return:</span></div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;<span class="comment"> *   db_fullname(in):</span></div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;<span class="comment"> *   logpath(in):</span></div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;<span class="comment"> *   prefix_logname(in):</span></div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;<span class="comment"> *   npages(in):</span></div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;<span class="comment"> *   db_creation(in):</span></div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;<span class="comment"> * NOTE:</span></div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span></div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;log_create_internal (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <span class="keyword">const</span> <span class="keywordtype">char</span> *db_fullname, <span class="keyword">const</span> <span class="keywordtype">char</span> *logpath, <span class="keyword">const</span> <span class="keywordtype">char</span> *prefix_logname,</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;             <a class="code" href="storage__common_8h.html#a261e4bc7334f8eabe6e1f0a3d7f7dcb4">DKNPAGES</a> npages, <a class="code" href="cm__broker__admin_8c.html#a8606fb1d53339b43e7417d2f96db025f">INT64</a> * db_creation)</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;{</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;  <a class="code" href="structlog__page.html">LOG_PAGE</a> *loghdr_pgptr;   <span class="comment">/* Pointer to log header */</span></div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *catmsg;</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;  <span class="keywordtype">int</span> error_code = <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>;</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;  <a class="code" href="storage__common_8h.html#a0da39ba47abe69bdc4cf837e4890d7ab">VOLID</a> volid1, volid2;</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;  <a class="code" href="log__impl_8h.html#a5561d6b89dce60cfa780062fae1bb473">LOG_CS_ENTER</a> (thread_p);</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;  <span class="comment">/* Make sure that we are starting from a clean state */</span></div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a4cf383467135a4aa88ffe54e788b4706">trantable</a>.<a class="code" href="structtrantable.html#a51008043f102cad94fc4832a72f1aa47">area</a> != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;    {</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;      <a class="code" href="log__manager_8c.html#aae3120d951badf0f042b20d1039584ff">log_final</a> (thread_p);</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;    }</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;  <span class="comment">/* </span></div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;<span class="comment">   * Turn off creation bits for group and others</span></div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;  (void) umask (S_IRGRP | S_IWGRP | S_IROTH | S_IWOTH);</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;  <span class="comment">/* Initialize the log buffer pool and the log names */</span></div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;  error_code = <a class="code" href="log__impl_8h.html#a10dc05607248603c703e1c9d1e5a5b0f">logpb_initialize_pool</a> (thread_p);</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;  <span class="keywordflow">if</span> (error_code != <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>)</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    {</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="run-tests_8php.html#aaa193b0c1c2b93841472b26e2e281751">error</a>;</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    }</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;  error_code = <a class="code" href="log__impl_8h.html#aef2f79ba5cf874d653206f1a95017eb4">logpb_initialize_log_names</a> (thread_p, db_fullname, logpath, prefix_logname);</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;  <span class="keywordflow">if</span> (error_code != <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>)</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    {</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="run-tests_8php.html#aaa193b0c1c2b93841472b26e2e281751">error</a>;</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    }</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;  <a class="code" href="log__impl_8h.html#ac0cf574979e19ca9286ba21b23b482fa">logpb_decache_archive_info</a> (thread_p);</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;  <a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a7f624279622c1c0c52492877129f95c6">rcv_phase</a> = <a class="code" href="log__impl_8h.html#a7377d8298f9fa6a5d11a79e4fb412729aef403ca21850fa90e6cdf48715ef9f94">LOG_RECOVERY_ANALYSIS_PHASE</a>;</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;  <span class="comment">/* Initialize the log header */</span></div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;  error_code = <a class="code" href="log__impl_8h.html#a3a7892fc280ade1dfd26f3e21ac3da16">logpb_initialize_header</a> (thread_p, &amp;<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>, prefix_logname, npages, db_creation);</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;  <span class="keywordflow">if</span> (error_code != <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>)</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    {</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="run-tests_8php.html#aaa193b0c1c2b93841472b26e2e281751">error</a>;</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;    }</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;  loghdr_pgptr = <a class="code" href="log__impl_8h.html#a63624ee9f291d9eb7e727bc45775f09d">logpb_create_header_page</a> (thread_p);</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;  <span class="comment">/* </span></div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;<span class="comment">   * Format the volume and fetch the header page and the first append page</span></div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;  <a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a7e0857f2c37da4e5285573f7167ed5a1">append</a>.<a class="code" href="structlog__append__info.html#af6d8c5019dce873f9312d4a625d3febe">vdes</a> =</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;    <a class="code" href="file__io_8c.html#a118ecc6747be6cc833228db57b67941d">fileio_format</a> (thread_p, db_fullname, <a class="code" href="log__global_8c.html#aef1e7912abb0cade6fe0dd266292df20">log_Name_active</a>, <a class="code" href="log__impl_8h.html#a94895f5d3bc1246f3902870a56738763">LOG_DBLOG_ACTIVE_VOLID</a>, npages,</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;           <a class="code" href="system__parameter_8c.html#a678756564699cbc93bd758cf6f99a042">prm_get_bool_value</a> (<a class="code" href="system__parameter_8h.html#a23aaf6bca406b9b428f43ad1b6b2b3e0af85fd9025390891d6e2b7992f43082fb">PRM_ID_LOG_SWEEP_CLEAN</a>), <span class="keyword">true</span>, <span class="keyword">false</span>, <a class="code" href="storage__common_8h.html#a1a7b7663aee8b9e8b1df6b1fbd5a88b9">LOG_PAGESIZE</a>, 0, <span class="keyword">false</span>);</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a7e0857f2c37da4e5285573f7167ed5a1">append</a>.<a class="code" href="structlog__append__info.html#af6d8c5019dce873f9312d4a625d3febe">vdes</a> == <a class="code" href="file__io_8h.html#af6836ff47a9fdc109eb60b2ed5a3093d">NULL_VOLDES</a> || <a class="code" href="log__impl_8h.html#ac35dbc3c280632065bc9b67d1a29bc21">logpb_fetch_start_append_page</a> (thread_p) != <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a> || loghdr_pgptr == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;    {</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="run-tests_8php.html#aaa193b0c1c2b93841472b26e2e281751">error</a>;</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;    }</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;  <a class="code" href="storage__common_8h.html#a6a4baec606189dd320678e8f412ca957">LSA_SET_NULL</a> (&amp;<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a7e0857f2c37da4e5285573f7167ed5a1">append</a>.<a class="code" href="structlog__append__info.html#a749ad18f9d9d9fd65aaf1b9b8a25e926">prev_lsa</a>);</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;  <span class="comment">/* copy log_Gl.append.prev_lsa to log_Gl.prior_info.prev_lsa */</span></div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;  <a class="code" href="log__impl_8h.html#ab8ba4bbbc183a2fee8d21494c5afae34">LOG_RESET_PREV_LSA</a> (&amp;<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a7e0857f2c37da4e5285573f7167ed5a1">append</a>.<a class="code" href="structlog__append__info.html#a749ad18f9d9d9fd65aaf1b9b8a25e926">prev_lsa</a>);</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;  <span class="comment">/* </span></div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;<span class="comment">   * Flush the append page, so that the end of the log mark is written.</span></div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;<span class="comment">   * Then, free the page, same for the header page.</span></div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;  <a class="code" href="log__impl_8h.html#a7152cb8ed5c589ffd3b3ba8e753c2113">logpb_set_dirty</a> (thread_p, <a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a7e0857f2c37da4e5285573f7167ed5a1">append</a>.<a class="code" href="structlog__append__info.html#a2a19250fa5f61b17a808f3523394001f">log_pgptr</a>);</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;  <a class="code" href="log__impl_8h.html#ab5c84aff4d15372a2d150897ad6d2b80">logpb_flush_pages_direct</a> (thread_p);</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;  <a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a11014fae55d34fdc69e77941301a59a1">chkpt_every_npages</a> = <a class="code" href="system__parameter_8c.html#aae71e771e08cd2d0452c346650a8da98">prm_get_integer_value</a> (<a class="code" href="system__parameter_8h.html#a23aaf6bca406b9b428f43ad1b6b2b3e0a15ba2db908b5e054f48a2f74267fc92f">PRM_ID_LOG_CHECKPOINT_NPAGES</a>);</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;  <span class="comment">/* Flush the log header */</span></div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;  memcpy (loghdr_pgptr-&gt;<a class="code" href="structlog__page.html#a9b51b4623cdb8d1686f6f8fb64bc9ee2">area</a>, &amp;<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>, sizeof (<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>));</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;  <a class="code" href="log__impl_8h.html#a7152cb8ed5c589ffd3b3ba8e753c2113">logpb_set_dirty</a> (thread_p, loghdr_pgptr);</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;<span class="preprocessor">#if defined(CUBRID_DEBUG)</span></div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;  {</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;    <span class="keywordtype">char</span> temp_pgbuf[<a class="code" href="storage__common_8h.html#a0a3c7db68a92df0d34666257bb0f17dd">IO_MAX_PAGE_SIZE</a> + <a class="code" href="memory__alloc_8h.html#a81d7e4971ffc775a379eeb4c65fa30f8">MAX_ALIGNMENT</a>], *aligned_temp_pgbuf;</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;    <a class="code" href="structlog__page.html">LOG_PAGE</a> *temp_pgptr;</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;    aligned_temp_pgbuf = <a class="code" href="memory__alloc_8h.html#a79781c0dbfdd9510d275cba54f1f384f">PTR_ALIGN</a> (temp_pgbuf, <a class="code" href="memory__alloc_8h.html#a81d7e4971ffc775a379eeb4c65fa30f8">MAX_ALIGNMENT</a>);</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;    temp_pgptr = (<a class="code" href="structlog__page.html">LOG_PAGE</a> *) aligned_temp_pgbuf;</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;    memset (temp_pgptr, 0, <a class="code" href="storage__common_8h.html#a1a7b7663aee8b9e8b1df6b1fbd5a88b9">LOG_PAGESIZE</a>);</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;    <a class="code" href="log__impl_8h.html#a721f75e714fb216eb1c86e38c1640644">logpb_read_page_from_file</a> (thread_p, <a class="code" href="log__impl_8h.html#ae07522b7703365448895621aa8f48335">LOGPB_HEADER_PAGE_ID</a>, <a class="code" href="log__impl_8h.html#ab33fe5f69028f102e9910294e97ccd6babc4379db94a7ff5ff8491988a7c28bc1">LOG_CS_FORCE_USE</a>, temp_pgptr);</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;    <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (memcmp ((<a class="code" href="structlog__header.html">LOG_HEADER</a> *) temp_pgptr-&gt;<a class="code" href="structlog__page.html#a9b51b4623cdb8d1686f6f8fb64bc9ee2">area</a>, &amp;<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>, sizeof (<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>)) != 0);</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;  }</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* CUBRID_DEBUG */</span><span class="preprocessor"></span></div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;  error_code = <a class="code" href="log__impl_8h.html#a395681f78c8d3aa0e26c7132fb05e0df">logpb_flush_page</a> (thread_p, loghdr_pgptr);</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;  <span class="keywordflow">if</span> (error_code != <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>)</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;    {</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="run-tests_8php.html#aaa193b0c1c2b93841472b26e2e281751">error</a>;</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;    }</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;<span class="preprocessor">#if defined(CUBRID_DEBUG)</span></div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;  {</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;    <span class="keywordtype">char</span> temp_pgbuf[<a class="code" href="storage__common_8h.html#a0a3c7db68a92df0d34666257bb0f17dd">IO_MAX_PAGE_SIZE</a> + <a class="code" href="memory__alloc_8h.html#a81d7e4971ffc775a379eeb4c65fa30f8">MAX_ALIGNMENT</a>], *aligned_temp_pgbuf;</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;    <a class="code" href="structlog__page.html">LOG_PAGE</a> *temp_pgptr;</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;    aligned_temp_pgbuf = <a class="code" href="memory__alloc_8h.html#a79781c0dbfdd9510d275cba54f1f384f">PTR_ALIGN</a> (temp_pgbuf, <a class="code" href="memory__alloc_8h.html#a81d7e4971ffc775a379eeb4c65fa30f8">MAX_ALIGNMENT</a>);</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;    temp_pgptr = (<a class="code" href="structlog__page.html">LOG_PAGE</a> *) aligned_temp_pgbuf;</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;    memset (temp_pgptr, 0, <a class="code" href="storage__common_8h.html#a1a7b7663aee8b9e8b1df6b1fbd5a88b9">LOG_PAGESIZE</a>);</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;    <a class="code" href="log__impl_8h.html#a721f75e714fb216eb1c86e38c1640644">logpb_read_page_from_file</a> (thread_p, <a class="code" href="log__impl_8h.html#ae07522b7703365448895621aa8f48335">LOGPB_HEADER_PAGE_ID</a>, <a class="code" href="log__impl_8h.html#ab33fe5f69028f102e9910294e97ccd6babc4379db94a7ff5ff8491988a7c28bc1">LOG_CS_FORCE_USE</a>, temp_pgptr);</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (memcmp ((<a class="code" href="structlog__header.html">LOG_HEADER</a> *) temp_pgptr-&gt;<a class="code" href="structlog__page.html#a9b51b4623cdb8d1686f6f8fb64bc9ee2">area</a>, &amp;<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>, sizeof (<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>)) == 0);</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;  }</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* CUBRID_DEBUG */</span><span class="preprocessor"></span></div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;  <span class="comment">/* logpb_flush_header(); */</span></div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;  <span class="comment">/* </span></div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;<span class="comment">   * Free the append and header page and dismount the lg active volume</span></div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;  <a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a7e0857f2c37da4e5285573f7167ed5a1">append</a>.<a class="code" href="structlog__append__info.html#a2a19250fa5f61b17a808f3523394001f">log_pgptr</a> = <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;  <a class="code" href="file__io_8c.html#ac8f2a9a060d18cbc18f83c2804d18ec3">fileio_dismount</a> (thread_p, <a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a7e0857f2c37da4e5285573f7167ed5a1">append</a>.<a class="code" href="structlog__append__info.html#af6d8c5019dce873f9312d4a625d3febe">vdes</a>);</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;  error_code = <a class="code" href="log__impl_8h.html#a31cc6db6a89961d1f11c73edba048dc3">logpb_create_volume_info</a> (<a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;  <span class="keywordflow">if</span> (error_code != <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>)</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;    {</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="run-tests_8php.html#aaa193b0c1c2b93841472b26e2e281751">error</a>;</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;    }</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;  <span class="comment">/* Create the information file to append log info stuff to the DBA */</span></div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;  <a class="code" href="log__impl_8h.html#af2199b00d5310519162d48e131800e52">logpb_create_log_info</a> (<a class="code" href="log__global_8c.html#a65818d3fd50e018ad0787dee588d7b25">log_Name_info</a>, <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;  catmsg = <a class="code" href="message__catalog_8c.html#af9597674b8d4504be6fd55145b5af6f0">msgcat_message</a> (<a class="code" href="message__catalog_8h.html#a9b41bc5c782e79c0112014e50461e364">MSGCAT_CATALOG_CUBRID</a>, <a class="code" href="message__catalog_8h.html#aa04e075e72cdb43d5397319b05e9184f">MSGCAT_SET_LOG</a>, <a class="code" href="log__impl_8h.html#a2c4c459f1e7836725bc9a7ff4cbba64e">MSGCAT_LOG_LOGINFO_ACTIVE</a>);</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;  <span class="keywordflow">if</span> (catmsg == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;    {</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;      catmsg = <span class="stringliteral">&quot;ACTIVE: %s %d pages\n&quot;</span>;</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    }</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;  error_code = <a class="code" href="log__comm_8c.html#a915b9b45cf29a152ab733755f7986572">log_dump_log_info</a> (<a class="code" href="log__global_8c.html#a65818d3fd50e018ad0787dee588d7b25">log_Name_info</a>, <span class="keyword">false</span>, catmsg, <a class="code" href="log__global_8c.html#aef1e7912abb0cade6fe0dd266292df20">log_Name_active</a>, npages);</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;  <span class="keywordflow">if</span> (error_code == <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a> || error_code == <a class="code" href="error__code_8h.html#a2212df4c388a4b5343567efe29fc7bfa">ER_LOG_MOUNT_FAIL</a>)</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    {</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;      volid1 = <a class="code" href="log__impl_8h.html#a2ecd65770a4af1c8d61a8611e0177157">logpb_add_volume</a> (<a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="log__impl_8h.html#aaa68f52fa8fd0a57a73d5201e7214321">LOG_DBLOG_BKUPINFO_VOLID</a>, <a class="code" href="log__global_8c.html#a60bf1affc62af917b4de5664211c181f">log_Name_bkupinfo</a>, <a class="code" href="dbtype__def_8h.html#ae85379d0c7c731c668592fb40e8bc6f2aaf315bc853f080ca48aebf812eabcb71">DISK_UNKNOWN_PURPOSE</a>);</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;      <span class="keywordflow">if</span> (volid1 == <a class="code" href="log__impl_8h.html#aaa68f52fa8fd0a57a73d5201e7214321">LOG_DBLOG_BKUPINFO_VOLID</a>)</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;    {</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;      volid2 = <a class="code" href="log__impl_8h.html#a2ecd65770a4af1c8d61a8611e0177157">logpb_add_volume</a> (<a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="log__impl_8h.html#a94895f5d3bc1246f3902870a56738763">LOG_DBLOG_ACTIVE_VOLID</a>, <a class="code" href="log__global_8c.html#aef1e7912abb0cade6fe0dd266292df20">log_Name_active</a>, <a class="code" href="dbtype__def_8h.html#ae85379d0c7c731c668592fb40e8bc6f2aaf315bc853f080ca48aebf812eabcb71">DISK_UNKNOWN_PURPOSE</a>);</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;    }</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;      <span class="keywordflow">if</span> (volid1 != <a class="code" href="log__impl_8h.html#aaa68f52fa8fd0a57a73d5201e7214321">LOG_DBLOG_BKUPINFO_VOLID</a> || volid2 != <a class="code" href="log__impl_8h.html#a94895f5d3bc1246f3902870a56738763">LOG_DBLOG_ACTIVE_VOLID</a>)</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;    {</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="run-tests_8php.html#aaa193b0c1c2b93841472b26e2e281751">error</a>;</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;    }</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;    }</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;  <a class="code" href="log__impl_8h.html#a5ea6483fb4af95ef44ff7eb9d6d35a05">logpb_finalize_pool</a> (thread_p);</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;  <a class="code" href="log__impl_8h.html#a6a5f95ded1a2f38ed00c8e9c039a9f2e">LOG_CS_EXIT</a> (thread_p);</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>;</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;<a class="code" href="run-tests_8php.html#aaa193b0c1c2b93841472b26e2e281751">error</a>:</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;  <a class="code" href="log__impl_8h.html#a5ea6483fb4af95ef44ff7eb9d6d35a05">logpb_finalize_pool</a> (thread_p);</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;  <a class="code" href="log__impl_8h.html#a6a5f95ded1a2f38ed00c8e9c039a9f2e">LOG_CS_EXIT</a> (thread_p);</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;  <span class="keywordflow">return</span> (error_code == <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>) ? <a class="code" href="error__code_8h.html#a51778caf175b7d6bfe9e8977d9a0032e">ER_FAILED</a> : error_code;</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;}</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;<span class="comment"> * log_set_no_logging - Force the system to do no logging.</span></div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;<span class="comment"> * return: NO_ERROR or error code</span></div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;<span class="keywordtype">int</span></div><div class="line"><a name="l00996"></a><span class="lineno"><a class="line" href="log__manager_8c.html#a0b5c9a920835f24684e8d027792c0539">  996</a></span>&#160;<a class="code" href="log__manager_8c.html#a0b5c9a920835f24684e8d027792c0539">log_set_no_logging</a> (<span class="keywordtype">void</span>)</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;{</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;  <span class="keywordtype">int</span> error_code = <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>;</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;<span class="preprocessor">#if defined(SA_MODE)</span></div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a4cf383467135a4aa88ffe54e788b4706">trantable</a>.<a class="code" href="structtrantable.html#abf145892ae263e97866b85009e2ad425">num_prepared_loose_end_indices</a> != 0)</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;    {</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;      <a class="code" href="error__manager_8c.html#afdaf87ce30f2f557802a185ab85b6599">er_set</a> (<a class="code" href="error__manager_8h.html#a5d0d456c474e11fc70779873a30a7432a07ad8f9fda27124d297c94b7d3ea44e8">ER_ERROR_SEVERITY</a>, <a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <a class="code" href="error__code_8h.html#a5cdf624077306151c8e1e79fe224b83f">ER_LOG_THEREARE_PENDING_ACTIONS_MUST_LOG</a>, 0);</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;      error_code = <a class="code" href="error__code_8h.html#a5cdf624077306151c8e1e79fe224b83f">ER_LOG_THEREARE_PENDING_ACTIONS_MUST_LOG</a>;</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;    }</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;    {</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;      log_No_logging = <span class="keyword">true</span>;</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;      error_code = <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>;</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;<span class="preprocessor">#if !defined(NDEBUG)</span></div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="system__parameter_8c.html#a678756564699cbc93bd758cf6f99a042">prm_get_bool_value</a> (<a class="code" href="system__parameter_8h.html#a23aaf6bca406b9b428f43ad1b6b2b3e0a941dffd866597ae3fa646a852919fef4">PRM_ID_LOG_TRACE_DEBUG</a>) &amp;&amp; log_No_logging)</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;    {</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;      fprintf (stdout, <span class="stringliteral">&quot;**Running without logging**\n&quot;</span>);</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;      fflush (stdout);</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;    }</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* NDEBUG */</span><span class="preprocessor"></span></div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;    }</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;<span class="preprocessor">#else </span><span class="comment">/* SA_MODE */</span><span class="preprocessor"></span></div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;  <a class="code" href="error__manager_8c.html#afdaf87ce30f2f557802a185ab85b6599">er_set</a> (<a class="code" href="error__manager_8h.html#a5d0d456c474e11fc70779873a30a7432a07ad8f9fda27124d297c94b7d3ea44e8">ER_ERROR_SEVERITY</a>, <a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <a class="code" href="error__code_8h.html#aeb9b1799184e0af16d7395444437ff02">ER_ONLY_IN_STANDALONE</a>, 1, <span class="stringliteral">&quot;no logging&quot;</span>);</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;  error_code = <a class="code" href="error__code_8h.html#aeb9b1799184e0af16d7395444437ff02">ER_ONLY_IN_STANDALONE</a>;</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* SA_MODE */</span><span class="preprocessor"></span></div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;  <span class="keywordflow">return</span> error_code;</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;}</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;<span class="comment"> * log_initialize - Initialize the log manager</span></div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;<span class="comment"> * return: nothing</span></div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;<span class="comment"> *   db_fullname(in): Full name of the database</span></div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;<span class="comment"> *   logpath(in): Directory where the log volumes reside</span></div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;<span class="comment"> *   prefix_logname(in): Name of the log volumes. It must be the same as the</span></div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;<span class="comment"> *                      one given during the creation of the database.</span></div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;<span class="comment"> *   ismedia_crash(in): Are we recovering from media crash ?.</span></div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;<span class="comment"> *   stopat(in): If we are recovering from a media crash, we can stop</span></div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;<span class="comment"> *                      the recovery process at a given time.</span></div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;<span class="comment"> * NOTE:Initialize the log manager. If the database system crashed,</span></div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;<span class="comment"> *              before the system was shutdown, the recovery process is</span></div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;<span class="comment"> *              executed as part of the initialization. The recovery process</span></div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;<span class="comment"> *              consists of redoing any changes that were previously committed</span></div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;<span class="comment"> *              and currently missing from the database disk, and undoing any</span></div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;<span class="comment"> *              changes that were not committed but that are stored in the</span></div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;<span class="comment"> *              database disk.</span></div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l01050"></a><span class="lineno"><a class="line" href="log__manager_8h.html#a294c54799d2139f97b333e3123f69948"> 1050</a></span>&#160;<a class="code" href="log__manager_8c.html#a294c54799d2139f97b333e3123f69948">log_initialize</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <span class="keyword">const</span> <span class="keywordtype">char</span> *db_fullname, <span class="keyword">const</span> <span class="keywordtype">char</span> *logpath, <span class="keyword">const</span> <span class="keywordtype">char</span> *prefix_logname,</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;        <span class="keywordtype">int</span> ismedia_crash, <a class="code" href="structbo__restart__arg.html">BO_RESTART_ARG</a> * r_args)</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;{</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;  <a class="code" href="error__manager_8h.html#a075eb8873354909bbe8edafa0f18f58c">er_log_debug</a> (<a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <span class="stringliteral">&quot;LOG INITIALIZE\n&quot;</span> <span class="stringliteral">&quot;\tdb_fullname = %s \n&quot;</span> <span class="stringliteral">&quot;\tlogpath = %s \n&quot;</span></div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;        <span class="stringliteral">&quot;\tprefix_logname = %s \n&quot;</span> <span class="stringliteral">&quot;\tismedia_crash = %d \n&quot;</span>,</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;        db_fullname != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> ? db_fullname : <span class="stringliteral">&quot;(UNKNOWN)&quot;</span>,</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;        logpath != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> ? logpath : <span class="stringliteral">&quot;(UNKNOWN)&quot;</span>,</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;        prefix_logname != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> ? prefix_logname : <span class="stringliteral">&quot;(UNKNOWN)&quot;</span>, ismedia_crash);</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;  (void) log_initialize_internal (thread_p, db_fullname, logpath, prefix_logname, ismedia_crash, r_args, <span class="keyword">false</span>);</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;<span class="preprocessor">#if defined(SERVER_MODE)</span></div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;  log_daemons_init ();</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;<span class="preprocessor">#endif // SERVER_MODE</span></div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;  log_No_logging = <a class="code" href="system__parameter_8c.html#a678756564699cbc93bd758cf6f99a042">prm_get_bool_value</a> (<a class="code" href="system__parameter_8h.html#a23aaf6bca406b9b428f43ad1b6b2b3e0ae353cf7f659005063e2daf4371fe712c">PRM_ID_LOG_NO_LOGGING</a>);</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;<span class="preprocessor">#if !defined(NDEBUG)</span></div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="system__parameter_8c.html#a678756564699cbc93bd758cf6f99a042">prm_get_bool_value</a> (<a class="code" href="system__parameter_8h.html#a23aaf6bca406b9b428f43ad1b6b2b3e0a941dffd866597ae3fa646a852919fef4">PRM_ID_LOG_TRACE_DEBUG</a>) &amp;&amp; log_No_logging)</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;    {</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;      fprintf (stdout, <span class="stringliteral">&quot;**Running without logging**\n&quot;</span>);</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;      fflush (stdout);</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;    }</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* !NDEBUG */</span><span class="preprocessor"></span></div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;}</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;<span class="comment"> * log_initialize_internal -</span></div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;<span class="comment"> * return:</span></div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;<span class="comment"> *   db_fullname(in): Full name of the database</span></div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;<span class="comment"> *   logpath(in): Directory where the log volumes reside</span></div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;<span class="comment"> *   prefix_logname(in): Name of the log volumes. It must be the same as the</span></div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;<span class="comment"> *                      one given during the creation of the database.</span></div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;<span class="comment"> *   ismedia_crash(in): Are we recovering from media crash ?.</span></div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;<span class="comment"> *   stopat(in): If we are recovering from a media crash, we can stop</span></div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;<span class="comment"> *                      the recovery process at a given time. </span></div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;<span class="comment"> * NOTE:</span></div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span></div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;log_initialize_internal (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <span class="keyword">const</span> <span class="keywordtype">char</span> *db_fullname, <span class="keyword">const</span> <span class="keywordtype">char</span> *logpath,</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;             <span class="keyword">const</span> <span class="keywordtype">char</span> *prefix_logname, <span class="keywordtype">bool</span> ismedia_crash, <a class="code" href="structbo__restart__arg.html">BO_RESTART_ARG</a> * r_args, <span class="keywordtype">bool</span> init_emergency)</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;{</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;  <a class="code" href="structlog__rec__header.html">LOG_RECORD_HEADER</a> *eof;   <span class="comment">/* End of log record */</span></div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;  <a class="code" href="release__string_8h.html#a56d4a5f45afe109eadcb56d2d46dd1ac">REL_FIXUP_FUNCTION</a> *disk_compatibility_functions = <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;  <a class="code" href="release__string_8h.html#aa7483b60e70f1b66a28d488d26b04819">REL_COMPATIBILITY</a> compat;</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;  <span class="keywordtype">int</span> error_code = <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>;</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;  time_t *stopat = (r_args) ? &amp;r_args-&gt;<a class="code" href="structbo__restart__arg.html#afdb3d6eda54cdc30cd8beea186dc5957">stopat</a> : <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;#<span class="keywordflow">if</span> !defined (<a class="code" href="utils_8h.html#a8de3ed741dadc9c979a4ff17c0a9116e">NDEBUG</a>)</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;  <span class="comment">/* Make sure that the recovery function array is synchronized.. */</span></div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;  <a class="code" href="recovery_8c.html#a8f5d1d7742eaee7cb4d25c8250b9e565">rv_check_rvfuns</a> ();</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* !NDEBUG */</span><span class="preprocessor"></span></div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;  (void) umask (S_IRGRP | S_IWGRP | S_IROTH | S_IWOTH);</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;  <span class="comment">/* Make sure that the log is a valid one */</span></div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;  <a class="code" href="log__impl_8h.html#a84f37ef4ed6965224995a001ad15ba7e">LOG_SET_CURRENT_TRAN_INDEX</a> (thread_p, <a class="code" href="log__impl_8h.html#a644a0b1dcc4cd9fb30d50f076becdcae">LOG_SYSTEM_TRAN_INDEX</a>);</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;  <a class="code" href="log__impl_8h.html#a5561d6b89dce60cfa780062fae1bb473">LOG_CS_ENTER</a> (thread_p);</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a4cf383467135a4aa88ffe54e788b4706">trantable</a>.<a class="code" href="structtrantable.html#a51008043f102cad94fc4832a72f1aa47">area</a> != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;    {</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;      <a class="code" href="log__manager_8c.html#aae3120d951badf0f042b20d1039584ff">log_final</a> (thread_p);</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;    }</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;  <span class="comment">/* Initialize log name for log volumes */</span></div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;  error_code = <a class="code" href="log__impl_8h.html#aef2f79ba5cf874d653206f1a95017eb4">logpb_initialize_log_names</a> (thread_p, db_fullname, logpath, prefix_logname);</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;  <span class="keywordflow">if</span> (error_code != <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>)</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;    {</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;      <a class="code" href="log__impl_8h.html#a8e111eafc27b6e1383fbd0ee812b1167">logpb_fatal_error</a> (thread_p, !init_emergency, <a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <span class="stringliteral">&quot;log_xinit&quot;</span>);</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="run-tests_8php.html#aaa193b0c1c2b93841472b26e2e281751">error</a>;</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;    }</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;  <a class="code" href="log__impl_8h.html#ac0cf574979e19ca9286ba21b23b482fa">logpb_decache_archive_info</a> (thread_p);</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;  <a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a7083cc630872e035c2a886397b2dfdf6">run_nxchkpt_atpageid</a> = <a class="code" href="storage__common_8h.html#a7ed60eef43941f46fadae895f63ee033">NULL_PAGEID</a>;    <span class="comment">/* Don&#39;t run the checkpoint */</span></div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;  <a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a7f624279622c1c0c52492877129f95c6">rcv_phase</a> = <a class="code" href="log__impl_8h.html#a7377d8298f9fa6a5d11a79e4fb412729aef403ca21850fa90e6cdf48715ef9f94">LOG_RECOVERY_ANALYSIS_PHASE</a>;</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;  <a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#afdcd3ed7bb720aba887367ea88800c69">loghdr_pgptr</a> = (<a class="code" href="structlog__page.html">LOG_PAGE</a> *) <a class="code" href="leak__detector_8h.html#a99aa8fd9f4831e1b0fa9e1cdcde3e249">malloc</a> (<a class="code" href="storage__common_8h.html#a1a7b7663aee8b9e8b1df6b1fbd5a88b9">LOG_PAGESIZE</a>);</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#afdcd3ed7bb720aba887367ea88800c69">loghdr_pgptr</a> == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;    {</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;      <a class="code" href="error__manager_8c.html#afdaf87ce30f2f557802a185ab85b6599">er_set</a> (<a class="code" href="error__manager_8h.html#a5d0d456c474e11fc70779873a30a7432a07ad8f9fda27124d297c94b7d3ea44e8">ER_ERROR_SEVERITY</a>, <a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <a class="code" href="error__code_8h.html#a1f7116a1f1981bc7ef25fc6078518692">ER_OUT_OF_VIRTUAL_MEMORY</a>, 1, (<span class="keywordtype">size_t</span>) <a class="code" href="storage__common_8h.html#a1a7b7663aee8b9e8b1df6b1fbd5a88b9">LOG_PAGESIZE</a>);</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;      <a class="code" href="log__impl_8h.html#a8e111eafc27b6e1383fbd0ee812b1167">logpb_fatal_error</a> (thread_p, !init_emergency, <a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <span class="stringliteral">&quot;log_xinit&quot;</span>);</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;      error_code = <a class="code" href="error__code_8h.html#a1f7116a1f1981bc7ef25fc6078518692">ER_OUT_OF_VIRTUAL_MEMORY</a>;</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="run-tests_8php.html#aaa193b0c1c2b93841472b26e2e281751">error</a>;</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;    }</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;  error_code = <a class="code" href="log__impl_8h.html#a10dc05607248603c703e1c9d1e5a5b0f">logpb_initialize_pool</a> (thread_p);</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;  <span class="keywordflow">if</span> (error_code != <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>)</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;    {</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="run-tests_8php.html#aaa193b0c1c2b93841472b26e2e281751">error</a>;</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;    }</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;  <span class="comment">/* Mount the active log and read the log header */</span></div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;  <a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a7e0857f2c37da4e5285573f7167ed5a1">append</a>.<a class="code" href="structlog__append__info.html#af6d8c5019dce873f9312d4a625d3febe">vdes</a> = <a class="code" href="file__io_8c.html#a26c82a33f296d5b511cbdf8b157c3ef3">fileio_mount</a> (thread_p, db_fullname, <a class="code" href="log__global_8c.html#aef1e7912abb0cade6fe0dd266292df20">log_Name_active</a>, <a class="code" href="log__impl_8h.html#a94895f5d3bc1246f3902870a56738763">LOG_DBLOG_ACTIVE_VOLID</a>, <span class="keyword">true</span>, <span class="keyword">false</span>);</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a7e0857f2c37da4e5285573f7167ed5a1">append</a>.<a class="code" href="structlog__append__info.html#af6d8c5019dce873f9312d4a625d3febe">vdes</a> == <a class="code" href="file__io_8h.html#af6836ff47a9fdc109eb60b2ed5a3093d">NULL_VOLDES</a>)</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;    {</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;      <span class="keywordflow">if</span> (ismedia_crash != <span class="keyword">false</span>)</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;    {</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;      <span class="comment">/* </span></div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;<span class="comment">       * Set an approximate log header to continue the recovery process</span></div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;      <a class="code" href="cm__broker__admin_8c.html#a8606fb1d53339b43e7417d2f96db025f">INT64</a> db_creation = -1;   <span class="comment">/* Database creation time in volume */</span></div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;      <span class="keywordtype">int</span> log_npages;</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;      log_npages = <a class="code" href="log__manager_8c.html#a62ffd154657b96161bcae79f707b4295">log_get_num_pages_for_creation</a> (-1);</div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;      error_code = <a class="code" href="log__impl_8h.html#a3a7892fc280ade1dfd26f3e21ac3da16">logpb_initialize_header</a> (thread_p, &amp;<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>, prefix_logname, log_npages, &amp;db_creation);</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;      <span class="keywordflow">if</span> (error_code != <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>)</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;        {</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;          <span class="keywordflow">goto</span> <a class="code" href="run-tests_8php.html#aaa193b0c1c2b93841472b26e2e281751">error</a>;</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;        }</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;      <a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>.<a class="code" href="structlog__header.html#aa32d860a02d9a2da846a3b9dfc17ce97">fpageid</a> = <a class="code" href="storage__common_8h.html#a8cf9ddda54aae97036680d35fcd95fd5">LOGPAGEID_MAX</a>;</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;      <a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>.<a class="code" href="structlog__header.html#a982b3e55dedc3dabc54a1a7fcddc144e">append_lsa</a>.<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a> = <a class="code" href="storage__common_8h.html#a8cf9ddda54aae97036680d35fcd95fd5">LOGPAGEID_MAX</a>;</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;      <a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>.<a class="code" href="structlog__header.html#a982b3e55dedc3dabc54a1a7fcddc144e">append_lsa</a>.<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a> = 0;</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;      <span class="comment">/* sync append_lsa to prior_lsa */</span></div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;      <a class="code" href="log__impl_8h.html#aa501d3de75690fbad474f906ff686b19">LOG_RESET_APPEND_LSA</a> (&amp;<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>.<a class="code" href="structlog__header.html#a982b3e55dedc3dabc54a1a7fcddc144e">append_lsa</a>);</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;      <a class="code" href="storage__common_8h.html#a6a4baec606189dd320678e8f412ca957">LSA_SET_NULL</a> (&amp;<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>.<a class="code" href="structlog__header.html#abd3c92d1eb868dd630bdbfa3561ecf9e">chkpt_lsa</a>);</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;      <a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>.<a class="code" href="structlog__header.html#af5f33cf0ecf8a996d4646d2327f6540c">nxarv_pageid</a> = <a class="code" href="storage__common_8h.html#a8cf9ddda54aae97036680d35fcd95fd5">LOGPAGEID_MAX</a>;</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;      <a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>.<a class="code" href="structlog__header.html#afd7807a9da370474be5f75cb3aafcffd">nxarv_num</a> = <a class="code" href="dbtype__def_8h.html#ae14c1fc20d3372b987bc4ea936f180f7">DB_INT32_MAX</a>;</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;      <a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>.<a class="code" href="structlog__header.html#a56cefc057e0589c8e9454e3a36751c61">last_arv_num_for_syscrashes</a> = <a class="code" href="dbtype__def_8h.html#ae14c1fc20d3372b987bc4ea936f180f7">DB_INT32_MAX</a>;</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;    }</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;    {</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;      <span class="comment">/* Unable to mount the active log */</span></div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;      error_code = <a class="code" href="error__code_8h.html#aaeb0f3698022ae5f56094bff65b0528f">ER_IO_MOUNT_FAIL</a>;</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="run-tests_8php.html#aaa193b0c1c2b93841472b26e2e281751">error</a>;</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;    }</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;    }</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;    {</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;      <a class="code" href="log__impl_8h.html#a2e4a0eee53c67888cd1625c9884ff350">logpb_fetch_header</a> (thread_p, &amp;<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>);</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;    }</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;  <span class="keywordflow">if</span> (ismedia_crash != <span class="keyword">false</span> &amp;&amp; (r_args) &amp;&amp; r_args-&gt;<a class="code" href="structbo__restart__arg.html#ac2691a46737fc6a722755a50ad9b8e71">restore_slave</a>)</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;    {</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;      r_args-&gt;<a class="code" href="structbo__restart__arg.html#accfb5a74c1f5aa4e82c663cc0c844743">db_creation</a> = <a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>.<a class="code" href="structlog__header.html#ab7c3c46056f412b19f447caf2ce7b861">db_creation</a>;</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;      <a class="code" href="storage__common_8h.html#a4c9bc15296fe6728cf0351726cc6ad09">LSA_COPY</a> (&amp;r_args-&gt;<a class="code" href="structbo__restart__arg.html#a4570fd2224f3900da9fd22de143e51ab">restart_repl_lsa</a>, &amp;<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>.<a class="code" href="structlog__header.html#abfff061333884447d8cf359d48184620">smallest_lsa_at_last_chkpt</a>);</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;    }</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;  <a class="code" href="storage__common_8h.html#a4c9bc15296fe6728cf0351726cc6ad09">LSA_COPY</a> (&amp;<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1b54cbf9234422852527cbc8336d6b99">chkpt_redo_lsa</a>, &amp;<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>.<a class="code" href="structlog__header.html#abd3c92d1eb868dd630bdbfa3561ecf9e">chkpt_lsa</a>);</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;  <span class="comment">/* Make sure that this is the desired log */</span></div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;  <span class="keywordflow">if</span> (strcmp (<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>.<a class="code" href="structlog__header.html#a115c418fc5dd536dd0d8073897815513">prefix_name</a>, prefix_logname) != 0)</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;    {</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;      <span class="comment">/* </span></div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;<span class="comment">       * This looks like the log or the log was renamed. Incompatible</span></div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;<span class="comment">       * prefix name with the prefix stored on disk</span></div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;      <a class="code" href="error__manager_8c.html#afdaf87ce30f2f557802a185ab85b6599">er_set</a> (<a class="code" href="error__manager_8h.html#a5d0d456c474e11fc70779873a30a7432af9c76cd8146aafca7fb58dabd599e41b">ER_NOTIFICATION_SEVERITY</a>, <a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <a class="code" href="error__code_8h.html#aa588dd125f3c69e5b0cd960d3ed94e27">ER_LOG_INCOMPATIBLE_PREFIX_NAME</a>, 2, prefix_logname,</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;          <a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>.<a class="code" href="structlog__header.html#a115c418fc5dd536dd0d8073897815513">prefix_name</a>);</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;      <span class="comment">/* Continue anyhow */</span></div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;    }</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;  <span class="comment">/* </span></div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;<span class="comment">   * Make sure that we are running with the same page size. If we are not,</span></div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;<span class="comment">   * restart again since page and log buffers may reflect an incorrect</span></div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;<span class="comment">   * pagesize</span></div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;</div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>.<a class="code" href="structlog__header.html#a6e36b30ec4db6a60e287d0a48fa5c907">db_iopagesize</a> != <a class="code" href="storage__common_8h.html#a097b8646f24ea98e209e18c53d74522a">IO_PAGESIZE</a> || <a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>.<a class="code" href="structlog__header.html#a31fef6acfb938132c62b4623cd1ad953">db_logpagesize</a> != <a class="code" href="storage__common_8h.html#a1a7b7663aee8b9e8b1df6b1fbd5a88b9">LOG_PAGESIZE</a>)</div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;    {</div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;      <span class="comment">/* </span></div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;<span class="comment">       * Pagesize is incorrect. We need to undefine anything that has been</span></div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;<span class="comment">       * created with old pagesize and start again</span></div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="storage__common_8c.html#aa2fc36147d16be92850b4acfabeba733">db_set_page_size</a> (<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>.<a class="code" href="structlog__header.html#a6e36b30ec4db6a60e287d0a48fa5c907">db_iopagesize</a>, <a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>.<a class="code" href="structlog__header.html#a31fef6acfb938132c62b4623cd1ad953">db_logpagesize</a>) != <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>)</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;    {</div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;      <span class="comment">/* Pagesize is incompatible */</span></div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;      error_code = <a class="code" href="error__code_8h.html#a51778caf175b7d6bfe9e8977d9a0032e">ER_FAILED</a>;</div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="run-tests_8php.html#aaa193b0c1c2b93841472b26e2e281751">error</a>;</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;    }</div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;      <span class="comment">/* </span></div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;<span class="comment">       * Call the function again... since we have a different setting for the</span></div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;<span class="comment">       * page size</span></div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;      <a class="code" href="log__impl_8h.html#a5ea6483fb4af95ef44ff7eb9d6d35a05">logpb_finalize_pool</a> (thread_p);</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;      <a class="code" href="file__io_8c.html#ac8f2a9a060d18cbc18f83c2804d18ec3">fileio_dismount</a> (thread_p, <a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a7e0857f2c37da4e5285573f7167ed5a1">append</a>.<a class="code" href="structlog__append__info.html#af6d8c5019dce873f9312d4a625d3febe">vdes</a>);</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;      <a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a7e0857f2c37da4e5285573f7167ed5a1">append</a>.<a class="code" href="structlog__append__info.html#af6d8c5019dce873f9312d4a625d3febe">vdes</a> = <a class="code" href="file__io_8h.html#af6836ff47a9fdc109eb60b2ed5a3093d">NULL_VOLDES</a>;</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;      <a class="code" href="log__impl_8h.html#a84f37ef4ed6965224995a001ad15ba7e">LOG_SET_CURRENT_TRAN_INDEX</a> (thread_p, <a class="code" href="log__impl_8h.html#a644a0b1dcc4cd9fb30d50f076becdcae">LOG_SYSTEM_TRAN_INDEX</a>);</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;      <a class="code" href="log__impl_8h.html#a6a5f95ded1a2f38ed00c8e9c039a9f2e">LOG_CS_EXIT</a> (thread_p);</div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;</div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;      error_code = <a class="code" href="log__impl_8h.html#ac27166ed5a81c72375cfccc620c702da">logtb_define_trantable_log_latch</a> (thread_p, <a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a4cf383467135a4aa88ffe54e788b4706">trantable</a>.<a class="code" href="structtrantable.html#a4a29a2fef75af5ba908037e1ad1218e0">num_total_indices</a>);</div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;      <span class="keywordflow">if</span> (error_code != <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>)</div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;    {</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;      <span class="keywordflow">return</span> error_code;</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;    }</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;      error_code = log_initialize_internal (thread_p, db_fullname, logpath, prefix_logname, ismedia_crash,</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;                        r_args, init_emergency);</div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;</div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;      <span class="keywordflow">return</span> error_code;</div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;    }</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;</div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;  <span class="comment">/* Make sure that the database is compatible with the CUBRID version. This will compare the given level against the</span></div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;<span class="comment">   * value returned by rel_disk_compatible(). */</span></div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;  compat = <a class="code" href="release__string_8c.html#ac6111ab82c826c5ad99f66dbba0892a3">rel_get_disk_compatible</a> (<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>.<a class="code" href="structlog__header.html#ac84fc8c39ca403a029683a4ceeef9bd6">db_compatibility</a>, &amp;disk_compatibility_functions);</div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;</div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;  <span class="comment">/* If we&#39;re not completely compatible, signal an error. There had been no compatibility rules on R2.1 or earlier</span></div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;<span class="comment">   * version. However, a compatibility rule between R2.2 and R2.1 (or earlier) was added to provide restoration from</span></div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;<span class="comment">   * R2.1 to R2.2. */</span></div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;  <span class="keywordflow">if</span> (compat != <a class="code" href="release__string_8h.html#aa7483b60e70f1b66a28d488d26b04819aa6a56ca07bc482994856dd67d4769bfe">REL_FULLY_COMPATIBLE</a>)</div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;    {</div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;      <span class="comment">/* Database is incompatible with current release */</span></div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;      <a class="code" href="error__manager_8c.html#afdaf87ce30f2f557802a185ab85b6599">er_set</a> (<a class="code" href="error__manager_8h.html#a5d0d456c474e11fc70779873a30a7432a3314630dd19f90a68274cf737092c9f2">ER_FATAL_ERROR_SEVERITY</a>, <a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <a class="code" href="error__code_8h.html#ac0f36d84bb9db8341537c11fbe97ffeb">ER_LOG_INCOMPATIBLE_DATABASE</a>, 2, <a class="code" href="release__string_8c.html#acf0e9c4e17259551cf008bfa5f925dfe">rel_name</a> (),</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;          <a class="code" href="release__string_8c.html#a9ffcff225b06b8ad183c576ad9edb8c3">rel_release_string</a> ());</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;      error_code = <a class="code" href="error__code_8h.html#ac0f36d84bb9db8341537c11fbe97ffeb">ER_LOG_INCOMPATIBLE_DATABASE</a>;</div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="run-tests_8php.html#aaa193b0c1c2b93841472b26e2e281751">error</a>;</div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;    }</div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;</div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="release__string_8c.html#a3a3d73521805f4e99a61c68853e6f8d9">rel_is_log_compatible</a> (<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>.<a class="code" href="structlog__header.html#a69b0ace883f579f1f029b57b86901cda">db_release</a>, <a class="code" href="release__string_8c.html#a9ffcff225b06b8ad183c576ad9edb8c3">rel_release_string</a> ()) != <span class="keyword">true</span>)</div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;    {</div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;      <span class="comment">/* </span></div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;<span class="comment">       * First time this database is restarted using the current version of</span></div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;<span class="comment">       * CUBRID. Recovery should be done using the old version of the</span></div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;<span class="comment">       * system</span></div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>.<a class="code" href="structlog__header.html#a7d775819dc76af47b2615f39dc1c9019">is_shutdown</a> == <span class="keyword">false</span>)</div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;    {</div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">char</span> *env_value;</div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;      <span class="keywordtype">bool</span> unsafe;</div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;      <span class="comment">/* </span></div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;<span class="comment">       * Check environment variable to see if caller want to force to continue</span></div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;<span class="comment">       * the recovery using current version.</span></div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;      env_value = <a class="code" href="environment__variable_8c.html#ad0768cecff71f50ceac4edefb8958d30">envvar_get</a> (<span class="stringliteral">&quot;LOG_UNSAFE_RECOVER_NEW_RELEASE&quot;</span>);</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;      <span class="keywordflow">if</span> (env_value != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;        {</div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;          <span class="keywordflow">if</span> (atoi (env_value) != 0)</div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;        {</div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;          unsafe = <span class="keyword">true</span>;</div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;        }</div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;          <span class="keywordflow">else</span></div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;        {</div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;          unsafe = <span class="keyword">false</span>;</div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;        }</div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;        }</div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;        {</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;          unsafe = <span class="keyword">false</span>;</div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;        }</div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;</div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;      <span class="keywordflow">if</span> (unsafe == <span class="keyword">false</span>)</div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;        {</div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;          <a class="code" href="error__manager_8c.html#afdaf87ce30f2f557802a185ab85b6599">er_set</a> (<a class="code" href="error__manager_8h.html#a5d0d456c474e11fc70779873a30a7432a3314630dd19f90a68274cf737092c9f2">ER_FATAL_ERROR_SEVERITY</a>, <a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <a class="code" href="error__code_8h.html#a16424fdd574a5296db5db6e546034ab5">ER_LOG_RECOVER_ON_OLD_RELEASE</a>, 4, <a class="code" href="release__string_8c.html#acf0e9c4e17259551cf008bfa5f925dfe">rel_name</a> (),</div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;              <a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>.<a class="code" href="structlog__header.html#a69b0ace883f579f1f029b57b86901cda">db_release</a>, <a class="code" href="release__string_8c.html#a9ffcff225b06b8ad183c576ad9edb8c3">rel_release_string</a> (), <a class="code" href="release__string_8c.html#a9ffcff225b06b8ad183c576ad9edb8c3">rel_release_string</a> ());</div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;          error_code = <a class="code" href="error__code_8h.html#a16424fdd574a5296db5db6e546034ab5">ER_LOG_RECOVER_ON_OLD_RELEASE</a>;</div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;          <span class="keywordflow">goto</span> <a class="code" href="run-tests_8php.html#aaa193b0c1c2b93841472b26e2e281751">error</a>;</div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;        }</div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;    }</div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;</div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;      <span class="comment">/* </span></div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;<span class="comment">       * It seems safe to move to new version of the system</span></div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;</div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="intl__support_8c.html#ab543901c3564a54b2450303d63374f55">strlen</a> (<a class="code" href="release__string_8c.html#a9ffcff225b06b8ad183c576ad9edb8c3">rel_release_string</a> ()) &gt;= <a class="code" href="release__string_8h.html#ac57c963a6d505d37dd3989a52edf6299">REL_MAX_RELEASE_LENGTH</a>)</div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;    {</div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;      <a class="code" href="error__manager_8c.html#afdaf87ce30f2f557802a185ab85b6599">er_set</a> (<a class="code" href="error__manager_8h.html#a5d0d456c474e11fc70779873a30a7432a3314630dd19f90a68274cf737092c9f2">ER_FATAL_ERROR_SEVERITY</a>, <a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <a class="code" href="error__code_8h.html#a8554831fac0d3c50e5ab2fd0354bf495">ER_LOG_COMPILATION_RELEASE</a>, 2, <a class="code" href="release__string_8c.html#a9ffcff225b06b8ad183c576ad9edb8c3">rel_release_string</a> (),</div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;          <a class="code" href="release__string_8h.html#ac57c963a6d505d37dd3989a52edf6299">REL_MAX_RELEASE_LENGTH</a>);</div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;      error_code = <a class="code" href="error__code_8h.html#a8554831fac0d3c50e5ab2fd0354bf495">ER_LOG_COMPILATION_RELEASE</a>;</div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="run-tests_8php.html#aaa193b0c1c2b93841472b26e2e281751">error</a>;</div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;    }</div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;      strncpy (<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>.<a class="code" href="structlog__header.html#a69b0ace883f579f1f029b57b86901cda">db_release</a>, <a class="code" href="release__string_8c.html#a9ffcff225b06b8ad183c576ad9edb8c3">rel_release_string</a> (), <a class="code" href="release__string_8h.html#ac57c963a6d505d37dd3989a52edf6299">REL_MAX_RELEASE_LENGTH</a>);</div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;    }</div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;</div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;  <span class="comment">/* </span></div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;<span class="comment">   * Create the transaction table and make sure that data volumes and log</span></div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;<span class="comment">   * volumes belong to the same database</span></div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;<span class="preprocessor">#if 1</span></div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;  <span class="comment">/* </span></div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;<span class="comment">   * for XA support: there is prepared transaction after recovery.</span></div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;<span class="comment">   *                 so, can not recreate transaction description</span></div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;<span class="comment">   *                 table after recovery.</span></div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;<span class="comment">   *                 NEED MORE CONSIDERATION</span></div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;<span class="comment">   *</span></div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;<span class="comment">   * Total number of transaction descriptor is set to the value of</span></div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;<span class="comment">   * max_clients+1</span></div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;  error_code = <a class="code" href="log__impl_8h.html#ac27166ed5a81c72375cfccc620c702da">logtb_define_trantable_log_latch</a> (thread_p, -1);</div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;  <span class="keywordflow">if</span> (error_code != <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>)</div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;    {</div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="run-tests_8php.html#aaa193b0c1c2b93841472b26e2e281751">error</a>;</div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;    }</div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;  error_code = <a class="code" href="log__impl_8h.html#ac27166ed5a81c72375cfccc620c702da">logtb_define_trantable_log_latch</a> (<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>.<a class="code" href="structlog__header.html#acc35ee047773a1cca16705e989ba3456">avg_ntrans</a>);</div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;  <span class="keywordflow">if</span> (error_code != <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>)</div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;    {</div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="run-tests_8php.html#aaa193b0c1c2b93841472b26e2e281751">error</a>;</div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;    }</div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;</div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a7e0857f2c37da4e5285573f7167ed5a1">append</a>.<a class="code" href="structlog__append__info.html#af6d8c5019dce873f9312d4a625d3febe">vdes</a> != <a class="code" href="file__io_8h.html#af6836ff47a9fdc109eb60b2ed5a3093d">NULL_VOLDES</a>)</div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;    {</div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="file__io_8c.html#a4756450084f251e83a14fbe2c835e4d9">fileio_map_mounted</a> (thread_p, (<span class="keywordtype">bool</span> (*)(<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> *, <a class="code" href="storage__common_8h.html#a0da39ba47abe69bdc4cf837e4890d7ab">VOLID</a>, <span class="keywordtype">void</span> *)) log_verify_dbcreation,</div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;                  &amp;<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>.<a class="code" href="structlog__header.html#ab7c3c46056f412b19f447caf2ce7b861">db_creation</a>) != <span class="keyword">true</span>)</div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;    {</div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;      <span class="comment">/* The log does not belong to the given database */</span></div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;      <a class="code" href="log__impl_8h.html#af3b0bac26ee4d5867e1ae5fb093e798a">logtb_undefine_trantable</a> (thread_p);</div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;      <a class="code" href="error__manager_8c.html#afdaf87ce30f2f557802a185ab85b6599">er_set</a> (<a class="code" href="error__manager_8h.html#a5d0d456c474e11fc70779873a30a7432a3314630dd19f90a68274cf737092c9f2">ER_FATAL_ERROR_SEVERITY</a>, <a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <a class="code" href="error__code_8h.html#ae60295c7460c5059ecfcf7af1ef29615">ER_LOG_DOESNT_CORRESPOND_TO_DATABASE</a>, 1, <a class="code" href="log__global_8c.html#aef1e7912abb0cade6fe0dd266292df20">log_Name_active</a>);</div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;      error_code = <a class="code" href="error__code_8h.html#ae60295c7460c5059ecfcf7af1ef29615">ER_LOG_DOESNT_CORRESPOND_TO_DATABASE</a>;</div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="run-tests_8php.html#aaa193b0c1c2b93841472b26e2e281751">error</a>;</div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;    }</div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;    }</div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;</div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;  <a class="code" href="log__impl_8h.html#a4034ab2422d5e7947469cb6e2df3df4d">logtb_reset_bit_area_start_mvccid</a> ();</div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;</div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="system__parameter_8c.html#a678756564699cbc93bd758cf6f99a042">prm_get_bool_value</a> (<a class="code" href="system__parameter_8h.html#a23aaf6bca406b9b428f43ad1b6b2b3e0ad0b59ddf899047a33b1874b59ca09354">PRM_ID_FORCE_RESTART_TO_SKIP_RECOVERY</a>))</div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;    {</div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;      init_emergency = <span class="keyword">true</span>;</div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;    }</div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;</div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;  <span class="comment">/* </span></div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;<span class="comment">   * Was the database system shut down or was it involved in a crash ?</span></div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;  <span class="keywordflow">if</span> (init_emergency == <span class="keyword">false</span> &amp;&amp; (<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>.<a class="code" href="structlog__header.html#a7d775819dc76af47b2615f39dc1c9019">is_shutdown</a> == <span class="keyword">false</span> || ismedia_crash == <span class="keyword">true</span>))</div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;    {</div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;      <span class="comment">/* </span></div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;<span class="comment">       * System was involved in a crash.</span></div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;<span class="comment">       * Execute the recovery process</span></div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;      <a class="code" href="log__impl_8h.html#a25de713746a915b7dc019384ef68a8f0">log_recovery</a> (thread_p, ismedia_crash, stopat);</div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;    }</div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;    {</div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;      <span class="keywordflow">if</span> (init_emergency == <span class="keyword">true</span> &amp;&amp; <a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>.<a class="code" href="structlog__header.html#a7d775819dc76af47b2615f39dc1c9019">is_shutdown</a> == <span class="keyword">false</span>)</div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;    {</div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="storage__common_8h.html#a26dd766712df5b5c4fcd158f571a75e4">LSA_ISNULL</a> (&amp;<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>.<a class="code" href="structlog__header.html#a87b66e6b3d5872e8e0967a42abf04ea6">eof_lsa</a>) &amp;&amp; <a class="code" href="storage__common_8h.html#a467739272b1ee74686bae4be2354197a">LSA_GT</a> (&amp;<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>.<a class="code" href="structlog__header.html#a982b3e55dedc3dabc54a1a7fcddc144e">append_lsa</a>, &amp;<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>.<a class="code" href="structlog__header.html#a87b66e6b3d5872e8e0967a42abf04ea6">eof_lsa</a>))</div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;        {</div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;          <span class="comment">/* We cannot believe in append_lsa for this case. It points to an unflushed log page. Since we are</span></div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;<span class="comment">           * going to skip recovery for emergency startup, just replace it with eof_lsa. */</span></div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;          <a class="code" href="log__impl_8h.html#aa501d3de75690fbad474f906ff686b19">LOG_RESET_APPEND_LSA</a> (&amp;<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>.<a class="code" href="structlog__header.html#a87b66e6b3d5872e8e0967a42abf04ea6">eof_lsa</a>);</div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;        }</div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;    }</div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;</div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;      <span class="comment">/* </span></div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;<span class="comment">       * The system was shut down. There is nothing to recover.</span></div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;<span class="comment">       * Find the append page and start execution</span></div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="log__impl_8h.html#ac35dbc3c280632065bc9b67d1a29bc21">logpb_fetch_start_append_page</a> (thread_p) != <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>)</div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;    {</div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;      error_code = <a class="code" href="error__code_8h.html#a51778caf175b7d6bfe9e8977d9a0032e">ER_FAILED</a>;</div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="run-tests_8php.html#aaa193b0c1c2b93841472b26e2e281751">error</a>;</div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;    }</div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;</div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;      <span class="comment">/* Read the End of file record to find out the previous address */</span></div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>.<a class="code" href="structlog__header.html#a982b3e55dedc3dabc54a1a7fcddc144e">append_lsa</a>.<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a> &gt; 0 || <a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>.<a class="code" href="structlog__header.html#a982b3e55dedc3dabc54a1a7fcddc144e">append_lsa</a>.<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a> &gt; 0)</div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;    {</div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;      eof = (<a class="code" href="structlog__rec__header.html">LOG_RECORD_HEADER</a> *) <a class="code" href="log__impl_8h.html#a452399b8f7135d60770a82357dad5934">LOG_APPEND_PTR</a> ();</div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;      <a class="code" href="log__impl_8h.html#ab8ba4bbbc183a2fee8d21494c5afae34">LOG_RESET_PREV_LSA</a> (&amp;eof-&gt;<a class="code" href="structlog__rec__header.html#af86b0fae64edb2a53b87dc354baf543c">back_lsa</a>);</div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;    }</div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;</div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;<span class="preprocessor">#if defined(SERVER_MODE)</span></div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;      <span class="comment">/* fix flushed_lsa_lower_bound become NULL_LSA */</span></div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;      <a class="code" href="storage__common_8h.html#a4c9bc15296fe6728cf0351726cc6ad09">LSA_COPY</a> (&amp;<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.flushed_lsa_lower_bound, &amp;<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a7e0857f2c37da4e5285573f7167ed5a1">append</a>.<a class="code" href="structlog__append__info.html#a749ad18f9d9d9fd65aaf1b9b8a25e926">prev_lsa</a>);</div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* SERVER_MODE */</span><span class="preprocessor"></span></div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;</div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;      <span class="comment">/* </span></div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;<span class="comment">       * Indicate that database system is UP,... flush the header so that we</span></div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;<span class="comment">       * we know that the system was running in the even of crashes</span></div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;      <a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>.<a class="code" href="structlog__header.html#a7d775819dc76af47b2615f39dc1c9019">is_shutdown</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;      <a class="code" href="log__impl_8h.html#a48a9214aa55783d4ae5648457f686c6c">logpb_flush_header</a> (thread_p);</div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;    }</div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;  <a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a7f624279622c1c0c52492877129f95c6">rcv_phase</a> = <a class="code" href="log__impl_8h.html#a7377d8298f9fa6a5d11a79e4fb412729a1c16c3853a4b9406340b78d31d264b36">LOG_RESTARTED</a>;</div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;</div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;  <a class="code" href="storage__common_8h.html#a4c9bc15296fe6728cf0351726cc6ad09">LSA_COPY</a> (&amp;<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a73c801b0d3d19a743cf3d20ec7ae63c6">rcv_phase_lsa</a>, &amp;<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>.<a class="code" href="structlog__header.html#abd3c92d1eb868dd630bdbfa3561ecf9e">chkpt_lsa</a>);</div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;  <a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a11014fae55d34fdc69e77941301a59a1">chkpt_every_npages</a> = <a class="code" href="system__parameter_8c.html#aae71e771e08cd2d0452c346650a8da98">prm_get_integer_value</a> (<a class="code" href="system__parameter_8h.html#a23aaf6bca406b9b428f43ad1b6b2b3e0a15ba2db908b5e054f48a2f74267fc92f">PRM_ID_LOG_CHECKPOINT_NPAGES</a>);</div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;</div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="storage__common_8h.html#aa8d8ea0049b43e3faf4c471641af5f98">LSA_EQ</a> (&amp;<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a7e0857f2c37da4e5285573f7167ed5a1">append</a>.<a class="code" href="structlog__append__info.html#a749ad18f9d9d9fd65aaf1b9b8a25e926">prev_lsa</a>, &amp;<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1e76ccd9e44777acc719b8f1bdbb93bb">prior_info</a>.<a class="code" href="structlog__prior__lsa__info.html#a08e7110c91df43323c7bb53da0d38446">prev_lsa</a>))</div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;    {</div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;      <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (0);</div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;      <span class="comment">/* defense code */</span></div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;      <a class="code" href="log__impl_8h.html#ab8ba4bbbc183a2fee8d21494c5afae34">LOG_RESET_PREV_LSA</a> (&amp;<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a7e0857f2c37da4e5285573f7167ed5a1">append</a>.<a class="code" href="structlog__append__info.html#a749ad18f9d9d9fd65aaf1b9b8a25e926">prev_lsa</a>);</div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;    }</div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="storage__common_8h.html#aa8d8ea0049b43e3faf4c471641af5f98">LSA_EQ</a> (&amp;<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>.<a class="code" href="structlog__header.html#a982b3e55dedc3dabc54a1a7fcddc144e">append_lsa</a>, &amp;<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1e76ccd9e44777acc719b8f1bdbb93bb">prior_info</a>.<a class="code" href="structlog__prior__lsa__info.html#ac2dc752b216f5b6c9d60aa082d35609a">prior_lsa</a>))</div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;    {</div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;      <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (0);</div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;      <span class="comment">/* defense code */</span></div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;      <a class="code" href="log__impl_8h.html#aa501d3de75690fbad474f906ff686b19">LOG_RESET_APPEND_LSA</a> (&amp;<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>.<a class="code" href="structlog__header.html#a982b3e55dedc3dabc54a1a7fcddc144e">append_lsa</a>);</div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;    }</div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;</div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;  <span class="comment">/* </span></div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;<span class="comment">   *</span></div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;<span class="comment">   * Don&#39;t checkpoint to sizes smaller than the number of log buffers</span></div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a11014fae55d34fdc69e77941301a59a1">chkpt_every_npages</a> &lt; <a class="code" href="system__parameter_8c.html#aae71e771e08cd2d0452c346650a8da98">prm_get_integer_value</a> (<a class="code" href="system__parameter_8h.html#a23aaf6bca406b9b428f43ad1b6b2b3e0aaa655444407adc3dbc365fa01c062ec1">PRM_ID_LOG_NBUFFERS</a>))</div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;    {</div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;      <a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a11014fae55d34fdc69e77941301a59a1">chkpt_every_npages</a> = <a class="code" href="system__parameter_8c.html#aae71e771e08cd2d0452c346650a8da98">prm_get_integer_value</a> (<a class="code" href="system__parameter_8h.html#a23aaf6bca406b9b428f43ad1b6b2b3e0aaa655444407adc3dbc365fa01c062ec1">PRM_ID_LOG_NBUFFERS</a>);</div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;    }</div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;</div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;  <span class="comment">/* Next checkpoint should be run at ... */</span></div><div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;  <a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a7083cc630872e035c2a886397b2dfdf6">run_nxchkpt_atpageid</a> = (<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>.<a class="code" href="structlog__header.html#a982b3e55dedc3dabc54a1a7fcddc144e">append_lsa</a>.<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a> + <a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a11014fae55d34fdc69e77941301a59a1">chkpt_every_npages</a>);</div><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;</div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;  <a class="code" href="log__impl_8h.html#a84f37ef4ed6965224995a001ad15ba7e">LOG_SET_CURRENT_TRAN_INDEX</a> (thread_p, <a class="code" href="log__impl_8h.html#a644a0b1dcc4cd9fb30d50f076becdcae">LOG_SYSTEM_TRAN_INDEX</a>);</div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;</div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;  <span class="comment">/* run the compatibility functions if we have any */</span></div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;  <span class="keywordflow">if</span> (disk_compatibility_functions != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;    {</div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; disk_compatibility_functions[<a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>] != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>; <a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;    {</div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;      (*(disk_compatibility_functions[<a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>])) ();</div><div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;    }</div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;    }</div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;</div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;  <a class="code" href="log__impl_8h.html#a5774cee12f9750e57015dc32de76bc4a">logpb_initialize_arv_page_info_table</a> ();</div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;  <a class="code" href="log__impl_8h.html#abe26fd2d0581fbb5221bfcebec7db16e">logpb_initialize_logging_statistics</a> ();</div><div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;</div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="system__parameter_8c.html#a678756564699cbc93bd758cf6f99a042">prm_get_bool_value</a> (<a class="code" href="system__parameter_8h.html#a23aaf6bca406b9b428f43ad1b6b2b3e0a24522bca59b73bae2a49d5cfd7c5eed3">PRM_ID_LOG_BACKGROUND_ARCHIVING</a>))</div><div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;    {</div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;      <a class="code" href="structbackground__archiving__info.html">BACKGROUND_ARCHIVING_INFO</a> *bg_arv_info;</div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;</div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;      bg_arv_info = &amp;<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#af65edc6529edb3fbcebe3ab59ac209c1">bg_archive_info</a>;</div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;      bg_arv_info-&gt;<a class="code" href="structbackground__archiving__info.html#a762172b07fc9fff23ea47f01026f36df">start_page_id</a> = <a class="code" href="storage__common_8h.html#a7ed60eef43941f46fadae895f63ee033">NULL_PAGEID</a>;</div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;      bg_arv_info-&gt;<a class="code" href="structbackground__archiving__info.html#a1a185832de42bb7b9dd1a1d527161e64">current_page_id</a> = <a class="code" href="storage__common_8h.html#a7ed60eef43941f46fadae895f63ee033">NULL_PAGEID</a>;</div><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;      bg_arv_info-&gt;<a class="code" href="structbackground__archiving__info.html#a7dfeb28ac4961a979f87f1de8d93192b">last_sync_pageid</a> = <a class="code" href="storage__common_8h.html#a7ed60eef43941f46fadae895f63ee033">NULL_PAGEID</a>;</div><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;</div><div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;      bg_arv_info-&gt;<a class="code" href="structbackground__archiving__info.html#addf88471d7c9b883a744ed73332204c3">vdes</a> =</div><div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;    <a class="code" href="file__io_8c.html#a118ecc6747be6cc833228db57b67941d">fileio_format</a> (thread_p, <a class="code" href="log__global_8c.html#ac27e93d7a688f2c6a273eed757062705">log_Db_fullname</a>, <a class="code" href="log__global_8c.html#a9ee59aac2d33d791fecba2731f3fa531">log_Name_bg_archive</a>, <a class="code" href="log__impl_8h.html#a9bf9166a3f6ad5e2a402119016094fbc">LOG_DBLOG_BG_ARCHIVE_VOLID</a>,</div><div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;               <a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>.<a class="code" href="structlog__header.html#abf6f8b71041f36e854e9edaa910525be">npages</a> + 1, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <a class="code" href="storage__common_8h.html#a1a7b7663aee8b9e8b1df6b1fbd5a88b9">LOG_PAGESIZE</a>, 0, <span class="keyword">false</span>);</div><div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;      <span class="keywordflow">if</span> (bg_arv_info-&gt;<a class="code" href="structbackground__archiving__info.html#addf88471d7c9b883a744ed73332204c3">vdes</a> != <a class="code" href="file__io_8h.html#af6836ff47a9fdc109eb60b2ed5a3093d">NULL_VOLDES</a>)</div><div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;    {</div><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;      bg_arv_info-&gt;<a class="code" href="structbackground__archiving__info.html#a762172b07fc9fff23ea47f01026f36df">start_page_id</a> = <a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>.<a class="code" href="structlog__header.html#af5f33cf0ecf8a996d4646d2327f6540c">nxarv_pageid</a>;</div><div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;      bg_arv_info-&gt;<a class="code" href="structbackground__archiving__info.html#a1a185832de42bb7b9dd1a1d527161e64">current_page_id</a> = <a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>.<a class="code" href="structlog__header.html#af5f33cf0ecf8a996d4646d2327f6540c">nxarv_pageid</a>;</div><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;      bg_arv_info-&gt;<a class="code" href="structbackground__archiving__info.html#a7dfeb28ac4961a979f87f1de8d93192b">last_sync_pageid</a> = <a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>.<a class="code" href="structlog__header.html#af5f33cf0ecf8a996d4646d2327f6540c">nxarv_pageid</a>;</div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;    }</div><div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;    {</div><div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;      <a class="code" href="error__manager_8h.html#a075eb8873354909bbe8edafa0f18f58c">er_log_debug</a> (<a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <span class="stringliteral">&quot;Unable to create temporary archive log %s\n&quot;</span>, <a class="code" href="log__global_8c.html#a9ee59aac2d33d791fecba2731f3fa531">log_Name_bg_archive</a>);</div><div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;    }</div><div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;</div><div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;      <span class="keywordflow">if</span> (bg_arv_info-&gt;<a class="code" href="structbackground__archiving__info.html#addf88471d7c9b883a744ed73332204c3">vdes</a> != <a class="code" href="file__io_8h.html#af6836ff47a9fdc109eb60b2ed5a3093d">NULL_VOLDES</a>)</div><div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;    {</div><div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;      (void) <a class="code" href="log__impl_8h.html#a44eb784dcaf09b76943d76ad06af5832">logpb_background_archiving</a> (thread_p);</div><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;    }</div><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;    }</div><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;</div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;  <a class="code" href="log__impl_8h.html#a6a5f95ded1a2f38ed00c8e9c039a9f2e">LOG_CS_EXIT</a> (thread_p);</div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;</div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;  <a class="code" href="error__manager_8h.html#a075eb8873354909bbe8edafa0f18f58c">er_log_debug</a> (<a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <span class="stringliteral">&quot;log_initialize_internal: end of log initializaton, append_lsa = (%lld|%d) \n&quot;</span>,</div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;        (<span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span>) <a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>.<a class="code" href="structlog__header.html#a982b3e55dedc3dabc54a1a7fcddc144e">append_lsa</a>.<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a>, <a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>.<a class="code" href="structlog__header.html#a982b3e55dedc3dabc54a1a7fcddc144e">append_lsa</a>.<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a>);</div><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;</div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;  <span class="keywordflow">return</span> error_code;</div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;</div><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;<a class="code" href="run-tests_8php.html#aaa193b0c1c2b93841472b26e2e281751">error</a>:</div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;  <span class="comment">/* ***** */</span></div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;</div><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a7e0857f2c37da4e5285573f7167ed5a1">append</a>.<a class="code" href="structlog__append__info.html#af6d8c5019dce873f9312d4a625d3febe">vdes</a> != <a class="code" href="file__io_8h.html#af6836ff47a9fdc109eb60b2ed5a3093d">NULL_VOLDES</a>)</div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;    {</div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;      <a class="code" href="file__io_8c.html#ac8f2a9a060d18cbc18f83c2804d18ec3">fileio_dismount</a> (thread_p, <a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a7e0857f2c37da4e5285573f7167ed5a1">append</a>.<a class="code" href="structlog__append__info.html#af6d8c5019dce873f9312d4a625d3febe">vdes</a>);</div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;    }</div><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;</div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;  <a class="code" href="log__impl_8h.html#a84f37ef4ed6965224995a001ad15ba7e">LOG_SET_CURRENT_TRAN_INDEX</a> (thread_p, <a class="code" href="log__impl_8h.html#a644a0b1dcc4cd9fb30d50f076becdcae">LOG_SYSTEM_TRAN_INDEX</a>);</div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;</div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#afdcd3ed7bb720aba887367ea88800c69">loghdr_pgptr</a> != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;    {</div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;      <a class="code" href="memory__alloc_8h.html#a794b5a73adc277837a0c4d12da4af5af">free_and_init</a> (<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#afdcd3ed7bb720aba887367ea88800c69">loghdr_pgptr</a>);</div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;    }</div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;</div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;  <a class="code" href="log__impl_8h.html#a6a5f95ded1a2f38ed00c8e9c039a9f2e">LOG_CS_EXIT</a> (thread_p);</div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;</div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;  <a class="code" href="log__impl_8h.html#a8e111eafc27b6e1383fbd0ee812b1167">logpb_fatal_error</a> (thread_p, !init_emergency, <a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <span class="stringliteral">&quot;log_init&quot;</span>);</div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;</div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;  <span class="keywordflow">return</span> error_code;</div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;</div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;}</div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;</div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;<span class="preprocessor">#if defined (ENABLE_UNUSED_FUNCTION)</span></div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;<span class="comment"> * log_update_compatibility_and_release -</span></div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;<span class="comment"> * return: NO_ERROR</span></div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;<span class="comment"> *   compatibility(in):</span></div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;<span class="comment"> *   release(in):</span></div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;<span class="comment"> * NOTE:</span></div><div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;<span class="keywordtype">int</span></div><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;log_update_compatibility_and_release (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <span class="keywordtype">float</span> compatibility, <span class="keywordtype">char</span> release[])</div><div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;{</div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;  <a class="code" href="log__impl_8h.html#a5561d6b89dce60cfa780062fae1bb473">LOG_CS_ENTER</a> (thread_p);</div><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;</div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;  <a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>.<a class="code" href="structlog__header.html#ac84fc8c39ca403a029683a4ceeef9bd6">db_compatibility</a> = compatibility;</div><div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;  strncpy (<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>.<a class="code" href="structlog__header.html#a69b0ace883f579f1f029b57b86901cda">db_release</a>, release, <a class="code" href="release__string_8h.html#ac57c963a6d505d37dd3989a52edf6299">REL_MAX_RELEASE_LENGTH</a>);</div><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;</div><div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;  <a class="code" href="log__impl_8h.html#a48a9214aa55783d4ae5648457f686c6c">logpb_flush_header</a> (thread_p);</div><div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;</div><div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;  <a class="code" href="log__impl_8h.html#a6a5f95ded1a2f38ed00c8e9c039a9f2e">LOG_CS_EXIT</a> (thread_p);</div><div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;</div><div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>;</div><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;}</div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* ENABLE_UNUSED_FUNCTION */</span><span class="preprocessor"></span></div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;</div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;<span class="preprocessor">#if defined(SERVER_MODE) || defined(SA_MODE)</span></div><div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;<span class="comment"> * log_get_db_compatibility -</span></div><div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;<span class="comment"> * return:</span></div><div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;<span class="comment"> * NOTE:</span></div><div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;<span class="keywordtype">float</span></div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;<a class="code" href="xserver__interface_8h.html#a0a2c9ebbbfb3f4d8812e5fe0f9181d0d">log_get_db_compatibility</a> (<span class="keywordtype">void</span>)</div><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;{</div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>.<a class="code" href="structlog__header.html#ac84fc8c39ca403a029683a4ceeef9bd6">db_compatibility</a>;</div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;}</div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* SERVER_MODE || SA_MODE */</span><span class="preprocessor"></span></div><div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;</div><div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;<span class="preprocessor">#if defined(SERVER_MODE)</span></div><div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;<span class="comment"> * log_abort_by_tdes - Abort a transaction</span></div><div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;<span class="comment"> * return: NO_ERROR</span></div><div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;<span class="comment"> *   arg(in): Transaction descriptor</span></div><div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;<span class="comment"> * NOTE:</span></div><div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span></div><div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;log_abort_by_tdes (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="structlog__tdes.html">LOG_TDES</a> * tdes)</div><div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;{</div><div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;  <span class="keywordflow">if</span> (thread_p == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;    {</div><div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;      thread_p = <a class="code" href="thread__manager_8hpp.html#a40d17fa7739ffcbb231e21a1944c50d0">thread_get_thread_entry_info</a> ();</div><div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;    }</div><div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;</div><div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;  thread_p-&gt;tran_index = tdes-&gt;<a class="code" href="structlog__tdes.html#ae9437cf94e11e2307172ef5fc7b32aa9">tran_index</a>;</div><div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;  <a class="code" href="log__manager_8c.html#aa91b7ec8ae8a2d699fb09cc20c444fe8">pthread_mutex_unlock</a> (&amp;thread_p-&gt;tran_index_lock);</div><div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;</div><div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;  (void) <a class="code" href="log__manager_8c.html#a6ae789049ef769d2489e14fd6bec41f8">log_abort</a> (thread_p, tdes-&gt;<a class="code" href="structlog__tdes.html#ae9437cf94e11e2307172ef5fc7b32aa9">tran_index</a>);</div><div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;</div><div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>;</div><div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;}</div><div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* SERVER_MODE */</span><span class="preprocessor"></span></div><div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;</div><div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;<span class="comment"> * TODO : STL</span></div><div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;<span class="comment"> * log_abort_all_active_transaction -</span></div><div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;<span class="comment"> * return:</span></div><div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;<span class="comment"> * NOTE:</span></div><div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l01597"></a><span class="lineno"><a class="line" href="log__manager_8h.html#a43c3e6965dc07096503c8de506a1069f"> 1597</a></span>&#160;<a class="code" href="log__manager_8c.html#a43c3e6965dc07096503c8de506a1069f">log_abort_all_active_transaction</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p)</div><div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;{</div><div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div><div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;  <a class="code" href="structlog__tdes.html">LOG_TDES</a> *tdes;       <span class="comment">/* Transaction descriptor */</span></div><div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;<span class="preprocessor">#if defined(SERVER_MODE)</span></div><div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;  <span class="keywordtype">int</span> repeat_loop;</div><div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;  <span class="keywordtype">int</span> *abort_thread_running;</div><div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">int</span> already_called = 0;</div><div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;</div><div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;  <span class="keywordflow">if</span> (already_called)</div><div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;    {</div><div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;    }</div><div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;  already_called = 1;</div><div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;</div><div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a4cf383467135a4aa88ffe54e788b4706">trantable</a>.<a class="code" href="structtrantable.html#a51008043f102cad94fc4832a72f1aa47">area</a> == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;    {</div><div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;    }</div><div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;</div><div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;  abort_thread_running = (<span class="keywordtype">int</span> *) <a class="code" href="leak__detector_8h.html#a99aa8fd9f4831e1b0fa9e1cdcde3e249">malloc</a> (<span class="keyword">sizeof</span> (<span class="keywordtype">int</span>) * <a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a4cf383467135a4aa88ffe54e788b4706">trantable</a>.<a class="code" href="structtrantable.html#a4a29a2fef75af5ba908037e1ad1218e0">num_total_indices</a>);</div><div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;  <span class="keywordflow">if</span> (abort_thread_running == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;    {</div><div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;      <a class="code" href="error__manager_8c.html#afdaf87ce30f2f557802a185ab85b6599">er_set</a> (<a class="code" href="error__manager_8h.html#a5d0d456c474e11fc70779873a30a7432a07ad8f9fda27124d297c94b7d3ea44e8">ER_ERROR_SEVERITY</a>, <a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <a class="code" href="error__code_8h.html#a1f7116a1f1981bc7ef25fc6078518692">ER_OUT_OF_VIRTUAL_MEMORY</a>, 1,</div><div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;          <span class="keyword">sizeof</span> (<span class="keywordtype">int</span>) * <a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a4cf383467135a4aa88ffe54e788b4706">trantable</a>.<a class="code" href="structtrantable.html#a4a29a2fef75af5ba908037e1ad1218e0">num_total_indices</a>);</div><div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;    }</div><div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;  memset (abort_thread_running, 0, <span class="keyword">sizeof</span> (<span class="keywordtype">int</span>) * <a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a4cf383467135a4aa88ffe54e788b4706">trantable</a>.<a class="code" href="structtrantable.html#a4a29a2fef75af5ba908037e1ad1218e0">num_total_indices</a>);</div><div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;</div><div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;  <span class="comment">/* Abort all active transactions */</span></div><div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;loop:</div><div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;  repeat_loop = <span class="keyword">false</span>;</div><div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;</div><div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a4cf383467135a4aa88ffe54e788b4706">trantable</a>.<a class="code" href="structtrantable.html#a4a29a2fef75af5ba908037e1ad1218e0">num_total_indices</a>; <a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;    {</div><div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> != <a class="code" href="log__impl_8h.html#a644a0b1dcc4cd9fb30d50f076becdcae">LOG_SYSTEM_TRAN_INDEX</a> &amp;&amp; (tdes = <a class="code" href="log__impl_8h.html#a08fee41cfcf592e8afdbc4988ffbc8e4">LOG_FIND_TDES</a> (<a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>)) != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> &amp;&amp; tdes-&gt;<a class="code" href="structlog__tdes.html#a3baeff284ed2167bcef74c5ef34d4f3b">trid</a> != <a class="code" href="storage__common_8h.html#a65e269153dcbaf685a77e98b007b6a19">NULL_TRANID</a>)</div><div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;    {</div><div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="server__support_8c.html#a828e24952477283b9d9f5f3c6d88de04">css_count_transaction_worker_threads</a> (thread_p, <a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>, tdes-&gt;<a class="code" href="structlog__tdes.html#a192e60c7a47b3874e40d640a0f4fc8f5">client_id</a>) &gt; 0)</div><div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;        {</div><div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;          repeat_loop = <span class="keyword">true</span>;</div><div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;        }</div><div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="log__impl_8h.html#aa81dc352329c9f96467c795c1547be74">LOG_ISTRAN_ACTIVE</a> (tdes) &amp;&amp; abort_thread_running[<a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>] == 0)</div><div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;        {</div><div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;          <a class="code" href="server__support_8c.html#adc1b9bc6e1d670a3eacb31fc3c953820">css_push_external_task</a> (<a class="code" href="connection__sr_8c.html#a6a26eaa100bc11d5421afc8fadaed6f4">css_find_conn_by_tran_index</a> (<a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>), <span class="keyword">new</span> log_abort_task (*tdes));</div><div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;          abort_thread_running[<a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>] = 1;</div><div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;          repeat_loop = <span class="keyword">true</span>;</div><div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;        }</div><div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;    }</div><div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;    }</div><div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;</div><div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;  <span class="keywordflow">if</span> (repeat_loop)</div><div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;    {</div><div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;      <a class="code" href="thread__manager_8hpp.html#ac617fc70870fb0af15f7eb889c856e2d">thread_sleep</a> (50);    <span class="comment">/* sleep 0.05 sec */</span></div><div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="server__support_8c.html#a8b07e301b0f090fa52920cc1b48b4777">css_is_shutdown_timeout_expired</a> ())</div><div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;    {</div><div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;      <span class="keywordflow">if</span> (abort_thread_running != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;        {</div><div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;          <a class="code" href="memory__alloc_8h.html#a794b5a73adc277837a0c4d12da4af5af">free_and_init</a> (abort_thread_running);</div><div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;        }</div><div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;      <span class="comment">/* exit process after some tries */</span></div><div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;      <a class="code" href="error__manager_8h.html#a075eb8873354909bbe8edafa0f18f58c">er_log_debug</a> (<a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <span class="stringliteral">&quot;log_abort_all_active_transaction: _exit(0)\n&quot;</span>);</div><div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;      <a class="code" href="dynamic__load_8c.html#ac6b02e4f4d9489ed432b5074c4defd5d">_exit</a> (0);</div><div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;    }</div><div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;      <span class="keywordflow">goto</span> loop;</div><div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;    }</div><div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;</div><div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;  <span class="keywordflow">if</span> (abort_thread_running != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;    {</div><div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;      <a class="code" href="memory__alloc_8h.html#a794b5a73adc277837a0c4d12da4af5af">free_and_init</a> (abort_thread_running);</div><div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;    }</div><div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;</div><div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;<span class="preprocessor">#else </span><span class="comment">/* SERVER_MODE */</span><span class="preprocessor"></span></div><div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;  <span class="keywordtype">int</span> save_tran_index = <a class="code" href="perf__monitor_8h.html#a4411dd2d4a5c0b032f1f05805a48ecc4">log_Tran_index</a>; <span class="comment">/* Return to this index */</span></div><div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;</div><div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a4cf383467135a4aa88ffe54e788b4706">trantable</a>.<a class="code" href="structtrantable.html#a51008043f102cad94fc4832a72f1aa47">area</a> == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;    {</div><div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;    }</div><div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;</div><div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;  <span class="comment">/* Abort all active transactions */</span></div><div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a4cf383467135a4aa88ffe54e788b4706">trantable</a>.<a class="code" href="structtrantable.html#a4a29a2fef75af5ba908037e1ad1218e0">num_total_indices</a>; <a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;    {</div><div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;      tdes = <a class="code" href="log__impl_8h.html#a08fee41cfcf592e8afdbc4988ffbc8e4">LOG_FIND_TDES</a> (<a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> != <a class="code" href="log__impl_8h.html#a644a0b1dcc4cd9fb30d50f076becdcae">LOG_SYSTEM_TRAN_INDEX</a> &amp;&amp; tdes != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> &amp;&amp; tdes-&gt;<a class="code" href="structlog__tdes.html#a3baeff284ed2167bcef74c5ef34d4f3b">trid</a> != <a class="code" href="storage__common_8h.html#a65e269153dcbaf685a77e98b007b6a19">NULL_TRANID</a>)</div><div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;    {</div><div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="log__impl_8h.html#aa81dc352329c9f96467c795c1547be74">LOG_ISTRAN_ACTIVE</a> (tdes))</div><div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;        {</div><div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;          <a class="code" href="perf__monitor_8h.html#a4411dd2d4a5c0b032f1f05805a48ecc4">log_Tran_index</a> = <a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div><div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;          (void) <a class="code" href="log__manager_8c.html#a6ae789049ef769d2489e14fd6bec41f8">log_abort</a> (thread_p, <a class="code" href="perf__monitor_8h.html#a4411dd2d4a5c0b032f1f05805a48ecc4">log_Tran_index</a>);</div><div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;        }</div><div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;    }</div><div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;    }</div><div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;  <a class="code" href="perf__monitor_8h.html#a4411dd2d4a5c0b032f1f05805a48ecc4">log_Tran_index</a> = save_tran_index;</div><div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* SERVER_MODE */</span><span class="preprocessor"></span></div><div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;}</div><div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;</div><div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;<span class="comment"> * TODO : STL</span></div><div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;<span class="comment"> * log_final - Terminate the log manager</span></div><div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;<span class="comment"> * return: nothing</span></div><div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;<span class="comment"> * NOTE: Terminate the log correctly, so that no recovery will be</span></div><div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;<span class="comment"> *              needed when the database system is restarted again. If there</span></div><div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;<span class="comment"> *              are any active transactions, they are all aborted. The log is</span></div><div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;<span class="comment"> *              flushed and all dirty data pages are also flushed to disk.</span></div><div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l01705"></a><span class="lineno"><a class="line" href="log__manager_8h.html#aae3120d951badf0f042b20d1039584ff"> 1705</a></span>&#160;<a class="code" href="log__manager_8c.html#aae3120d951badf0f042b20d1039584ff">log_final</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p)</div><div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;{</div><div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div><div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;  <a class="code" href="structlog__tdes.html">LOG_TDES</a> *tdes;       <span class="comment">/* Transaction descriptor */</span></div><div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;  <span class="keywordtype">int</span> save_tran_index;</div><div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;  <span class="keywordtype">bool</span> anyloose_ends = <span class="keyword">false</span>;</div><div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;  <span class="keywordtype">int</span> error_code = <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>;</div><div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;</div><div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;<span class="preprocessor">#if defined(SERVER_MODE)</span></div><div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;  log_daemons_destroy ();</div><div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* SERVER_MODE */</span><span class="preprocessor"></span></div><div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;</div><div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;  <a class="code" href="log__impl_8h.html#a5561d6b89dce60cfa780062fae1bb473">LOG_CS_ENTER</a> (thread_p);</div><div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;</div><div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;  <span class="comment">/* reset log_Gl.rcv_phase */</span></div><div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;  <a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a7f624279622c1c0c52492877129f95c6">rcv_phase</a> = <a class="code" href="log__impl_8h.html#a7377d8298f9fa6a5d11a79e4fb412729aef403ca21850fa90e6cdf48715ef9f94">LOG_RECOVERY_ANALYSIS_PHASE</a>;</div><div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;</div><div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a4cf383467135a4aa88ffe54e788b4706">trantable</a>.<a class="code" href="structtrantable.html#a51008043f102cad94fc4832a72f1aa47">area</a> == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;    {</div><div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;      <a class="code" href="log__impl_8h.html#a6a5f95ded1a2f38ed00c8e9c039a9f2e">LOG_CS_EXIT</a> (thread_p);</div><div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;    }</div><div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;</div><div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;  save_tran_index = <a class="code" href="perf__monitor_8h.html#a55d27b01d605ba6ee2929ddfe8588320">LOG_FIND_THREAD_TRAN_INDEX</a> (thread_p);</div><div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;</div><div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="log__impl_8h.html#ae4025cb5dfaa1070ed2fafc0ec63943e">logpb_is_pool_initialized</a> ())</div><div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;    {</div><div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;      <a class="code" href="log__impl_8h.html#af3b0bac26ee4d5867e1ae5fb093e798a">logtb_undefine_trantable</a> (thread_p);</div><div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;      <a class="code" href="log__impl_8h.html#a6a5f95ded1a2f38ed00c8e9c039a9f2e">LOG_CS_EXIT</a> (thread_p);</div><div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;    }</div><div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;</div><div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a7e0857f2c37da4e5285573f7167ed5a1">append</a>.<a class="code" href="structlog__append__info.html#af6d8c5019dce873f9312d4a625d3febe">vdes</a> == <a class="code" href="file__io_8h.html#af6836ff47a9fdc109eb60b2ed5a3093d">NULL_VOLDES</a>)</div><div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;    {</div><div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;      <a class="code" href="log__impl_8h.html#a5ea6483fb4af95ef44ff7eb9d6d35a05">logpb_finalize_pool</a> (thread_p);</div><div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;      <a class="code" href="log__impl_8h.html#af3b0bac26ee4d5867e1ae5fb093e798a">logtb_undefine_trantable</a> (thread_p);</div><div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;      <a class="code" href="log__impl_8h.html#a6a5f95ded1a2f38ed00c8e9c039a9f2e">LOG_CS_EXIT</a> (thread_p);</div><div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;    }</div><div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;</div><div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;  <span class="comment">/* </span></div><div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;<span class="comment">   * Cannot use the critical section here since we are assigning the</span></div><div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;<span class="comment">   * transaction index and the critical sections are base on the transaction</span></div><div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;<span class="comment">   * index. Acquire the critical section and the get out immediately.. by</span></div><div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;<span class="comment">   * this time the scheduler will not preempt you.</span></div><div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;</div><div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;  <span class="comment">/* Abort all active transactions */</span></div><div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a4cf383467135a4aa88ffe54e788b4706">trantable</a>.<a class="code" href="structtrantable.html#a4a29a2fef75af5ba908037e1ad1218e0">num_total_indices</a>; <a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;    {</div><div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;      tdes = <a class="code" href="log__impl_8h.html#a08fee41cfcf592e8afdbc4988ffbc8e4">LOG_FIND_TDES</a> (<a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> != <a class="code" href="log__impl_8h.html#a644a0b1dcc4cd9fb30d50f076becdcae">LOG_SYSTEM_TRAN_INDEX</a> &amp;&amp; tdes != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> &amp;&amp; tdes-&gt;<a class="code" href="structlog__tdes.html#a3baeff284ed2167bcef74c5ef34d4f3b">trid</a> != <a class="code" href="storage__common_8h.html#a65e269153dcbaf685a77e98b007b6a19">NULL_TRANID</a>)</div><div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;    {</div><div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="log__impl_8h.html#aa81dc352329c9f96467c795c1547be74">LOG_ISTRAN_ACTIVE</a> (tdes))</div><div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;        {</div><div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;          <a class="code" href="log__impl_8h.html#a84f37ef4ed6965224995a001ad15ba7e">LOG_SET_CURRENT_TRAN_INDEX</a> (thread_p, <a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;          (void) <a class="code" href="log__manager_8c.html#a6ae789049ef769d2489e14fd6bec41f8">log_abort</a> (thread_p, <a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;        }</div><div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;        {</div><div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;          anyloose_ends = <span class="keyword">true</span>;</div><div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;        }</div><div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;    }</div><div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;    }</div><div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;</div><div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;  <a class="code" href="log__impl_8h.html#a84f37ef4ed6965224995a001ad15ba7e">LOG_SET_CURRENT_TRAN_INDEX</a> (thread_p, save_tran_index);</div><div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;</div><div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;  <span class="comment">/* </span></div><div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;<span class="comment">   * Flush all log append dirty pages and all data dirty pages</span></div><div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;  <a class="code" href="log__impl_8h.html#ab5c84aff4d15372a2d150897ad6d2b80">logpb_flush_pages_direct</a> (thread_p);</div><div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;</div><div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;  error_code = <a class="code" href="page__buffer_8c.html#afaab282d5976ee6db15214305dcae248">pgbuf_flush_all</a> (thread_p, <a class="code" href="storage__common_8h.html#a5859fbd2f7cd3c37c37e672f812388ff">NULL_VOLID</a>);</div><div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;  <span class="keywordflow">if</span> (error_code == <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>)</div><div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;    {</div><div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;      error_code = <a class="code" href="file__io_8c.html#a55c9040a1a605ecc2aae549ddc1f4cb0">fileio_synchronize_all</a> (thread_p, <span class="keyword">false</span>);</div><div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;    }</div><div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;</div><div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;  <a class="code" href="log__impl_8h.html#ac0cf574979e19ca9286ba21b23b482fa">logpb_decache_archive_info</a> (thread_p);</div><div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;</div><div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;  <span class="comment">/* </span></div><div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;<span class="comment">   * Flush the header of the log with information to restart the system</span></div><div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;<span class="comment">   * easily. For example, without a recovery process</span></div><div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;</div><div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;  <a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>.<a class="code" href="structlog__header.html#a8e11d6d1907cbdd412a9c3cb7d79e6f4">has_logging_been_skipped</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;  <span class="keywordflow">if</span> (anyloose_ends == <span class="keyword">false</span> &amp;&amp; error_code == <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>)</div><div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;    {</div><div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;      <a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>.<a class="code" href="structlog__header.html#a7d775819dc76af47b2615f39dc1c9019">is_shutdown</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;      <a class="code" href="storage__common_8h.html#a4c9bc15296fe6728cf0351726cc6ad09">LSA_COPY</a> (&amp;<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>.<a class="code" href="structlog__header.html#abd3c92d1eb868dd630bdbfa3561ecf9e">chkpt_lsa</a>, &amp;<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>.<a class="code" href="structlog__header.html#a982b3e55dedc3dabc54a1a7fcddc144e">append_lsa</a>);</div><div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;      <a class="code" href="storage__common_8h.html#a4c9bc15296fe6728cf0351726cc6ad09">LSA_COPY</a> (&amp;<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>.<a class="code" href="structlog__header.html#abfff061333884447d8cf359d48184620">smallest_lsa_at_last_chkpt</a>, &amp;<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>.<a class="code" href="structlog__header.html#abd3c92d1eb868dd630bdbfa3561ecf9e">chkpt_lsa</a>);</div><div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;    }</div><div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;    {</div><div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;      (void) <a class="code" href="log__impl_8h.html#a3afa13fd96a09f0686e865e34d4ba415">logpb_checkpoint</a> (thread_p);</div><div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;    }</div><div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;</div><div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;  <a class="code" href="log__impl_8h.html#a48a9214aa55783d4ae5648457f686c6c">logpb_flush_header</a> (thread_p);</div><div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;</div><div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;  <span class="comment">/* Undefine page buffer pool and transaction table */</span></div><div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;  <a class="code" href="log__impl_8h.html#a5ea6483fb4af95ef44ff7eb9d6d35a05">logpb_finalize_pool</a> (thread_p);</div><div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;</div><div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;  <a class="code" href="log__impl_8h.html#af3b0bac26ee4d5867e1ae5fb093e798a">logtb_undefine_trantable</a> (thread_p);</div><div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;</div><div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="system__parameter_8c.html#a678756564699cbc93bd758cf6f99a042">prm_get_bool_value</a> (<a class="code" href="system__parameter_8h.html#a23aaf6bca406b9b428f43ad1b6b2b3e0a24522bca59b73bae2a49d5cfd7c5eed3">PRM_ID_LOG_BACKGROUND_ARCHIVING</a>))</div><div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;    {</div><div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#af65edc6529edb3fbcebe3ab59ac209c1">bg_archive_info</a>.<a class="code" href="structbackground__archiving__info.html#addf88471d7c9b883a744ed73332204c3">vdes</a> != <a class="code" href="file__io_8h.html#af6836ff47a9fdc109eb60b2ed5a3093d">NULL_VOLDES</a>)</div><div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;    {</div><div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;      <a class="code" href="file__io_8c.html#ac8f2a9a060d18cbc18f83c2804d18ec3">fileio_dismount</a> (thread_p, <a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#af65edc6529edb3fbcebe3ab59ac209c1">bg_archive_info</a>.<a class="code" href="structbackground__archiving__info.html#addf88471d7c9b883a744ed73332204c3">vdes</a>);</div><div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;      <a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#af65edc6529edb3fbcebe3ab59ac209c1">bg_archive_info</a>.<a class="code" href="structbackground__archiving__info.html#addf88471d7c9b883a744ed73332204c3">vdes</a> = <a class="code" href="file__io_8h.html#af6836ff47a9fdc109eb60b2ed5a3093d">NULL_VOLDES</a>;</div><div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;    }</div><div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;    }</div><div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;</div><div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;  <span class="comment">/* Dismount the active log volume */</span></div><div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;  <a class="code" href="file__io_8c.html#ac8f2a9a060d18cbc18f83c2804d18ec3">fileio_dismount</a> (thread_p, <a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a7e0857f2c37da4e5285573f7167ed5a1">append</a>.<a class="code" href="structlog__append__info.html#af6d8c5019dce873f9312d4a625d3febe">vdes</a>);</div><div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;  <a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a7e0857f2c37da4e5285573f7167ed5a1">append</a>.<a class="code" href="structlog__append__info.html#af6d8c5019dce873f9312d4a625d3febe">vdes</a> = <a class="code" href="file__io_8h.html#af6836ff47a9fdc109eb60b2ed5a3093d">NULL_VOLDES</a>;</div><div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;</div><div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;  <a class="code" href="memory__alloc_8h.html#a794b5a73adc277837a0c4d12da4af5af">free_and_init</a> (<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#afdcd3ed7bb720aba887367ea88800c69">loghdr_pgptr</a>);</div><div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;</div><div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;  <a class="code" href="log__impl_8h.html#a6a5f95ded1a2f38ed00c8e9c039a9f2e">LOG_CS_EXIT</a> (thread_p);</div><div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;}</div><div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;</div><div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;<span class="comment"> * log_restart_emergency - Emergency restart of log manager</span></div><div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;<span class="comment"> * return: nothing</span></div><div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;<span class="comment"> *   db_fullname(in): Full name of the database</span></div><div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;<span class="comment"> *   logpath(in): Directory where the log volumes reside</span></div><div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;<span class="comment"> *   prefix_logname(in): Name of the log volumes. It must be the same as the</span></div><div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;<span class="comment"> *                      one given during the creation of the database.</span></div><div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;<span class="comment"> * NOTE: Initialize the log manager in emergency fashion. That is,</span></div><div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;<span class="comment"> *              restart recovery is ignored.</span></div><div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l01841"></a><span class="lineno"><a class="line" href="log__manager_8h.html#a425ed5fad08e748df89edfd0350986f9"> 1841</a></span>&#160;<a class="code" href="log__manager_8c.html#a425ed5fad08e748df89edfd0350986f9">log_restart_emergency</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <span class="keyword">const</span> <span class="keywordtype">char</span> *db_fullname, <span class="keyword">const</span> <span class="keywordtype">char</span> *logpath,</div><div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;               <span class="keyword">const</span> <span class="keywordtype">char</span> *prefix_logname)</div><div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;{</div><div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;  (void) log_initialize_internal (thread_p, db_fullname, logpath, prefix_logname, <span class="keyword">false</span>, <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <span class="keyword">true</span>);</div><div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;}</div><div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;</div><div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;<span class="comment"> *                    INTERFACE FUNCTION FOR LOGGING DATA</span></div><div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;</div><div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;<span class="comment"> * log_append_undoredo_data - LOG UNDO (BEFORE) + REDO (AFTER) DATA</span></div><div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;<span class="comment"> * return: nothing</span></div><div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;<span class="comment"> *   rcvindex(in): Index to recovery function</span></div><div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;<span class="comment"> *   addr(in): Address (Volume, page, and offset) of data</span></div><div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;<span class="comment"> *   undo_length(in): Length of undo(before) data</span></div><div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;<span class="comment"> *   redo_length(in): Length of redo(after) data</span></div><div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;<span class="comment"> *   undo_data(in): Undo (before) data</span></div><div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;<span class="comment"> *   redo_data(in): Redo (after) data</span></div><div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l01867"></a><span class="lineno"><a class="line" href="log__manager_8h.html#a5c4af392f84fee0ddddee9e29e94752b"> 1867</a></span>&#160;<a class="code" href="log__manager_8c.html#a5c4af392f84fee0ddddee9e29e94752b">log_append_undoredo_data</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2b">LOG_RCVINDEX</a> rcvindex, <a class="code" href="structlog__data__addr.html">LOG_DATA_ADDR</a> * addr, <span class="keywordtype">int</span> undo_length,</div><div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;              <span class="keywordtype">int</span> redo_length, <span class="keyword">const</span> <span class="keywordtype">void</span> *undo_data, <span class="keyword">const</span> <span class="keywordtype">void</span> *redo_data)</div><div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;{</div><div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;  <a class="code" href="structlog__crumb.html">LOG_CRUMB</a> undo_crumb;</div><div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;  <a class="code" href="structlog__crumb.html">LOG_CRUMB</a> redo_crumb;</div><div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;</div><div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;  <span class="comment">/* Set undo length/data to crumb */</span></div><div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;  <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (0 &lt;= undo_length);</div><div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;  <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (0 == undo_length || undo_data != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;</div><div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;  undo_crumb.<a class="code" href="structlog__crumb.html#a01a9e2039ac048536a6c4aaefaa78896">data</a> = undo_data;</div><div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;  undo_crumb.<a class="code" href="structlog__crumb.html#a27fa2f547d67332b369d31002bd7ea75">length</a> = undo_length;</div><div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;</div><div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;  <span class="comment">/* Set redo length/data to crumb */</span></div><div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;  <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (0 &lt;= redo_length);</div><div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;  <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (0 == redo_length || redo_data != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;</div><div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;  redo_crumb.<a class="code" href="structlog__crumb.html#a01a9e2039ac048536a6c4aaefaa78896">data</a> = redo_data;</div><div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;  redo_crumb.<a class="code" href="structlog__crumb.html#a27fa2f547d67332b369d31002bd7ea75">length</a> = redo_length;</div><div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;</div><div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;  <a class="code" href="log__manager_8c.html#a487dabcb7a4dc15bab76299fb5ff1660">log_append_undoredo_crumbs</a> (thread_p, rcvindex, addr, 1, 1, &amp;undo_crumb, &amp;redo_crumb);</div><div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;}</div><div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;</div><div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l01891"></a><span class="lineno"><a class="line" href="log__manager_8h.html#addfa3d47a458055afd11100d64b0865b"> 1891</a></span>&#160;<a class="code" href="log__manager_8c.html#addfa3d47a458055afd11100d64b0865b">log_append_undoredo_data2</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2b">LOG_RCVINDEX</a> rcvindex, <span class="keyword">const</span> <a class="code" href="structvfid.html">VFID</a> * <a class="code" href="structvfid.html">vfid</a>, <a class="code" href="storage__common_8h.html#ae4a052db40daa4a44a890bad45d8ecdc">PAGE_PTR</a> pgptr,</div><div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;               <a class="code" href="storage__common_8h.html#ac3f9d7ae37c5a4cb27570f7313891bc8">PGLENGTH</a> <a class="code" href="expat_8h.html#ad0c30ee1add42468a6d7c022f2efdf70">offset</a>, <span class="keywordtype">int</span> undo_length, <span class="keywordtype">int</span> redo_length, <span class="keyword">const</span> <span class="keywordtype">void</span> *undo_data,</div><div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;               <span class="keyword">const</span> <span class="keywordtype">void</span> *redo_data)</div><div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;{</div><div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;  <a class="code" href="structlog__data__addr.html">LOG_DATA_ADDR</a> addr;</div><div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;  <a class="code" href="structlog__crumb.html">LOG_CRUMB</a> undo_crumb;</div><div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;  <a class="code" href="structlog__crumb.html">LOG_CRUMB</a> redo_crumb;</div><div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;</div><div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;  <span class="comment">/* Set data address */</span></div><div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;  addr.<a class="code" href="structlog__data__addr.html#a23830dd623509faa8744024abec22ca8">vfid</a> = <a class="code" href="structvfid.html">vfid</a>;</div><div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;  addr.<a class="code" href="structlog__data__addr.html#a3c632dae3ad660a8572d9298716d9522">pgptr</a> = pgptr;</div><div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;  addr.<a class="code" href="structlog__data__addr.html#ab8ee0b45ab1d94bffa3626936b282d5f">offset</a> = <a class="code" href="expat_8h.html#ad0c30ee1add42468a6d7c022f2efdf70">offset</a>;</div><div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;</div><div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;  <span class="comment">/* Set undo length/data to crumb */</span></div><div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;  <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (0 &lt;= undo_length);</div><div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;  <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (0 == undo_length || undo_data != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;</div><div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;  undo_crumb.<a class="code" href="structlog__crumb.html#a01a9e2039ac048536a6c4aaefaa78896">data</a> = undo_data;</div><div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;  undo_crumb.<a class="code" href="structlog__crumb.html#a27fa2f547d67332b369d31002bd7ea75">length</a> = undo_length;</div><div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;</div><div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;  <span class="comment">/* Set redo length/data to crumb */</span></div><div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;  <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (0 &lt;= redo_length);</div><div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;  <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (0 == redo_length || redo_data != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;</div><div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;  redo_crumb.<a class="code" href="structlog__crumb.html#a01a9e2039ac048536a6c4aaefaa78896">data</a> = redo_data;</div><div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;  redo_crumb.<a class="code" href="structlog__crumb.html#a27fa2f547d67332b369d31002bd7ea75">length</a> = redo_length;</div><div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;</div><div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;  <a class="code" href="log__manager_8c.html#a487dabcb7a4dc15bab76299fb5ff1660">log_append_undoredo_crumbs</a> (thread_p, rcvindex, &amp;addr, 1, 1, &amp;undo_crumb, &amp;redo_crumb);</div><div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;}</div><div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;</div><div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;<span class="comment"> * log_append_undo_data - LOG UNDO (BEFORE) DATA</span></div><div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;<span class="comment"> * return: nothing</span></div><div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;<span class="comment"> *   rcvindex(in): Index to recovery function</span></div><div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;<span class="comment"> *   addr(in): Address (Volume, page, and offset) of data</span></div><div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;<span class="comment"> *   length(in): Length of undo(before) data</span></div><div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;<span class="comment"> *   data(in): Undo (before) data</span></div><div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;<span class="comment"> * NOTE: Log undo(before) data. A log record is constructed to recover</span></div><div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;<span class="comment"> *              data by undoing data during abort and during recovery.</span></div><div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;<span class="comment"> *              In the case of a rollback, the undo function described by</span></div><div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;<span class="comment"> *              rcvindex is called with a recovery structure which contains</span></div><div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;<span class="comment"> *              the page pointer and offset of the data to recover along with</span></div><div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;<span class="comment"> *              the undo data. It is up to this function to determine how to</span></div><div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;<span class="comment"> *              undo the data.</span></div><div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;<span class="comment"> *     1)       This function accepts either page operation logging (with a</span></div><div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;<span class="comment"> *              valid address) or logical log (with a null address).</span></div><div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;<span class="comment"> *     2)       Very IMPORTANT: If an update is associated with two individual</span></div><div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;<span class="comment"> *              log records, the undo record must be logged before the redo</span></div><div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;<span class="comment"> *              record.</span></div><div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l01947"></a><span class="lineno"><a class="line" href="log__manager_8h.html#ab689c730c941c75daa26b5d968070f3c"> 1947</a></span>&#160;<a class="code" href="log__manager_8c.html#ab689c730c941c75daa26b5d968070f3c">log_append_undo_data</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2b">LOG_RCVINDEX</a> rcvindex, <a class="code" href="structlog__data__addr.html">LOG_DATA_ADDR</a> * addr, <span class="keywordtype">int</span> length,</div><div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">void</span> *<a class="code" href="namespacestatdump__to__csv.html#aedcb70fde9c0b07a0732db70deeec616">data</a>)</div><div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;{</div><div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;  <a class="code" href="structlog__crumb.html">LOG_CRUMB</a> undo_crumb;</div><div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;</div><div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;  <span class="comment">/* Set length/data to crumb */</span></div><div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;  <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (0 &lt;= length);</div><div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;  <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (0 == length || <a class="code" href="namespacestatdump__to__csv.html#aedcb70fde9c0b07a0732db70deeec616">data</a> != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;</div><div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;  undo_crumb.<a class="code" href="structlog__crumb.html#a01a9e2039ac048536a6c4aaefaa78896">data</a> = <a class="code" href="namespacestatdump__to__csv.html#aedcb70fde9c0b07a0732db70deeec616">data</a>;</div><div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;  undo_crumb.<a class="code" href="structlog__crumb.html#a27fa2f547d67332b369d31002bd7ea75">length</a> = length;</div><div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;</div><div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;  <a class="code" href="log__manager_8c.html#a9ba19c0baec377fbab0da02a75c7260d">log_append_undo_crumbs</a> (thread_p, rcvindex, addr, 1, &amp;undo_crumb);</div><div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;}</div><div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;</div><div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l01963"></a><span class="lineno"><a class="line" href="log__manager_8h.html#a34b6f583b3036cd74a105b48d8f4be6d"> 1963</a></span>&#160;<a class="code" href="log__manager_8c.html#a34b6f583b3036cd74a105b48d8f4be6d">log_append_undo_data2</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2b">LOG_RCVINDEX</a> rcvindex, <span class="keyword">const</span> <a class="code" href="structvfid.html">VFID</a> * <a class="code" href="structvfid.html">vfid</a>, <a class="code" href="storage__common_8h.html#ae4a052db40daa4a44a890bad45d8ecdc">PAGE_PTR</a> pgptr,</div><div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;               <a class="code" href="storage__common_8h.html#ac3f9d7ae37c5a4cb27570f7313891bc8">PGLENGTH</a> <a class="code" href="expat_8h.html#ad0c30ee1add42468a6d7c022f2efdf70">offset</a>, <span class="keywordtype">int</span> length, <span class="keyword">const</span> <span class="keywordtype">void</span> *<a class="code" href="namespacestatdump__to__csv.html#aedcb70fde9c0b07a0732db70deeec616">data</a>)</div><div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;{</div><div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;  <a class="code" href="structlog__data__addr.html">LOG_DATA_ADDR</a> addr;</div><div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;  <a class="code" href="structlog__crumb.html">LOG_CRUMB</a> undo_crumb;</div><div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;</div><div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;  <span class="comment">/* Set data address */</span></div><div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;  addr.<a class="code" href="structlog__data__addr.html#a23830dd623509faa8744024abec22ca8">vfid</a> = <a class="code" href="structvfid.html">vfid</a>;</div><div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;  addr.<a class="code" href="structlog__data__addr.html#a3c632dae3ad660a8572d9298716d9522">pgptr</a> = pgptr;</div><div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;  addr.<a class="code" href="structlog__data__addr.html#ab8ee0b45ab1d94bffa3626936b282d5f">offset</a> = <a class="code" href="expat_8h.html#ad0c30ee1add42468a6d7c022f2efdf70">offset</a>;</div><div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;</div><div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;  <span class="comment">/* Set length/data to crumb */</span></div><div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;  <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (0 &lt;= length);</div><div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;  <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (0 == length || <a class="code" href="namespacestatdump__to__csv.html#aedcb70fde9c0b07a0732db70deeec616">data</a> != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;</div><div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;  undo_crumb.<a class="code" href="structlog__crumb.html#a01a9e2039ac048536a6c4aaefaa78896">data</a> = <a class="code" href="namespacestatdump__to__csv.html#aedcb70fde9c0b07a0732db70deeec616">data</a>;</div><div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;  undo_crumb.<a class="code" href="structlog__crumb.html#a27fa2f547d67332b369d31002bd7ea75">length</a> = length;</div><div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;</div><div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;  <a class="code" href="log__manager_8c.html#a9ba19c0baec377fbab0da02a75c7260d">log_append_undo_crumbs</a> (thread_p, rcvindex, &amp;addr, 1, &amp;undo_crumb);</div><div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;}</div><div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;</div><div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;<span class="comment"> * log_append_redo_data - LOG REDO (AFTER) DATA</span></div><div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;<span class="comment"> * return: nothing</span></div><div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;<span class="comment"> *   rcvindex(in): Index to recovery function</span></div><div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;<span class="comment"> *   addr(in): Address (Volume, page, and offset) of data</span></div><div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;<span class="comment"> *   length(in): Length of redo(after) data</span></div><div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;<span class="comment"> *   data(in): Redo (after) data</span></div><div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;<span class="comment"> * NOTE: Log redo(after) data. A log record is constructed to recover</span></div><div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;<span class="comment"> *              data by redoing data during recovery.</span></div><div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;<span class="comment"> *              During recovery(e.g., system crash recovery), the redo</span></div><div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;<span class="comment"> *              function described by rcvindex is called with a recovery</span></div><div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;<span class="comment"> *              structure which contains the page pointer and offset of the</span></div><div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;<span class="comment"> *              data to recover along with the redo data. It is up to this</span></div><div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;<span class="comment"> *              function to determine how to redo the data.</span></div><div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;<span class="comment"> *     1)       The only type of logging accepted by this function is page</span></div><div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;<span class="comment"> *              operation level logging, thus, an address must must be given.</span></div><div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;<span class="comment"> *     2)       During the redo phase of crash recovery, any redo logging is</span></div><div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;<span class="comment"> *              ignored.</span></div><div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l02009"></a><span class="lineno"><a class="line" href="log__manager_8h.html#a76afb51129a3be19c2520daa64bebf9e"> 2009</a></span>&#160;<a class="code" href="log__manager_8c.html#a76afb51129a3be19c2520daa64bebf9e">log_append_redo_data</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2b">LOG_RCVINDEX</a> rcvindex, <a class="code" href="structlog__data__addr.html">LOG_DATA_ADDR</a> * addr, <span class="keywordtype">int</span> length,</div><div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">void</span> *<a class="code" href="namespacestatdump__to__csv.html#aedcb70fde9c0b07a0732db70deeec616">data</a>)</div><div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;{</div><div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;  <a class="code" href="structlog__crumb.html">LOG_CRUMB</a> redo_crumb;</div><div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;</div><div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;  <span class="comment">/* Set length/data to crumb */</span></div><div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;  <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (0 &lt;= length);</div><div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;  <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (0 == length || <a class="code" href="namespacestatdump__to__csv.html#aedcb70fde9c0b07a0732db70deeec616">data</a> != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;</div><div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;  redo_crumb.<a class="code" href="structlog__crumb.html#a01a9e2039ac048536a6c4aaefaa78896">data</a> = <a class="code" href="namespacestatdump__to__csv.html#aedcb70fde9c0b07a0732db70deeec616">data</a>;</div><div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;  redo_crumb.<a class="code" href="structlog__crumb.html#a27fa2f547d67332b369d31002bd7ea75">length</a> = length;</div><div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;</div><div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;  <a class="code" href="log__manager_8c.html#ad39dc10a11df5427f5af4c203e9d98a6">log_append_redo_crumbs</a> (thread_p, rcvindex, addr, 1, &amp;redo_crumb);</div><div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;}</div><div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;</div><div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l02025"></a><span class="lineno"><a class="line" href="log__manager_8h.html#aac6bd2dc11adb08f6b6da5bcaf2986b3"> 2025</a></span>&#160;<a class="code" href="log__manager_8c.html#aac6bd2dc11adb08f6b6da5bcaf2986b3">log_append_redo_data2</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2b">LOG_RCVINDEX</a> rcvindex, <span class="keyword">const</span> <a class="code" href="structvfid.html">VFID</a> * <a class="code" href="structvfid.html">vfid</a>, <a class="code" href="storage__common_8h.html#ae4a052db40daa4a44a890bad45d8ecdc">PAGE_PTR</a> pgptr,</div><div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;               <a class="code" href="storage__common_8h.html#ac3f9d7ae37c5a4cb27570f7313891bc8">PGLENGTH</a> <a class="code" href="expat_8h.html#ad0c30ee1add42468a6d7c022f2efdf70">offset</a>, <span class="keywordtype">int</span> length, <span class="keyword">const</span> <span class="keywordtype">void</span> *<a class="code" href="namespacestatdump__to__csv.html#aedcb70fde9c0b07a0732db70deeec616">data</a>)</div><div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;{</div><div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;  <a class="code" href="structlog__data__addr.html">LOG_DATA_ADDR</a> addr;</div><div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;  <a class="code" href="structlog__crumb.html">LOG_CRUMB</a> redo_crumb;</div><div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;</div><div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;  <span class="comment">/* Set data address */</span></div><div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;  addr.<a class="code" href="structlog__data__addr.html#a23830dd623509faa8744024abec22ca8">vfid</a> = <a class="code" href="structvfid.html">vfid</a>;</div><div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;  addr.<a class="code" href="structlog__data__addr.html#a3c632dae3ad660a8572d9298716d9522">pgptr</a> = pgptr;</div><div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;  addr.<a class="code" href="structlog__data__addr.html#ab8ee0b45ab1d94bffa3626936b282d5f">offset</a> = <a class="code" href="expat_8h.html#ad0c30ee1add42468a6d7c022f2efdf70">offset</a>;</div><div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;</div><div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;  <span class="comment">/* Set length/data to crumb */</span></div><div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;  <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (0 &lt;= length);</div><div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;  <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (0 == length || <a class="code" href="namespacestatdump__to__csv.html#aedcb70fde9c0b07a0732db70deeec616">data</a> != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;</div><div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;  redo_crumb.<a class="code" href="structlog__crumb.html#a01a9e2039ac048536a6c4aaefaa78896">data</a> = <a class="code" href="namespacestatdump__to__csv.html#aedcb70fde9c0b07a0732db70deeec616">data</a>;</div><div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;  redo_crumb.<a class="code" href="structlog__crumb.html#a27fa2f547d67332b369d31002bd7ea75">length</a> = length;</div><div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;</div><div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;  <a class="code" href="log__manager_8c.html#ad39dc10a11df5427f5af4c203e9d98a6">log_append_redo_crumbs</a> (thread_p, rcvindex, &amp;addr, 1, &amp;redo_crumb);</div><div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;}</div><div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;</div><div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;<span class="comment"> * log_append_undoredo_crumbs -  LOG UNDO (BEFORE) + REDO (AFTER) CRUMBS OF DATA</span></div><div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;<span class="comment"> * return: nothing</span></div><div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;<span class="comment"> *   rcvindex(in): Index to recovery function</span></div><div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;<span class="comment"> *   addr(in): Address (Volume, page, and offset) of data</span></div><div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;<span class="comment"> *   num_undo_crumbs(in): Number of undo crumbs</span></div><div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;<span class="comment"> *   num_redo_crumbs(in): Number of redo crumbs</span></div><div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;<span class="comment"> *   undo_crumbs(in): The undo crumbs</span></div><div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;<span class="comment"> *   redo_crumbs(in): The redo crumbs</span></div><div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l02060"></a><span class="lineno"><a class="line" href="log__manager_8h.html#a487dabcb7a4dc15bab76299fb5ff1660"> 2060</a></span>&#160;<a class="code" href="log__manager_8c.html#a487dabcb7a4dc15bab76299fb5ff1660">log_append_undoredo_crumbs</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2b">LOG_RCVINDEX</a> rcvindex, <a class="code" href="structlog__data__addr.html">LOG_DATA_ADDR</a> * addr, <span class="keywordtype">int</span> num_undo_crumbs,</div><div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;                <span class="keywordtype">int</span> num_redo_crumbs, <span class="keyword">const</span> <a class="code" href="structlog__crumb.html">LOG_CRUMB</a> * undo_crumbs, <span class="keyword">const</span> <a class="code" href="structlog__crumb.html">LOG_CRUMB</a> * redo_crumbs)</div><div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;{</div><div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;  <a class="code" href="structlog__tdes.html">LOG_TDES</a> *tdes;       <span class="comment">/* Transaction descriptor */</span></div><div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;  <span class="keywordtype">int</span> tran_index;</div><div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;  <span class="keywordtype">int</span> error_code = <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>;</div><div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;  <a class="code" href="structlog__prior__node.html">LOG_PRIOR_NODE</a> *<a class="code" href="external_2include_2queue_8h.html#a465e28dbd1a1c60ff504d3ea275613ed">node</a>;</div><div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;  <a class="code" href="structlog__lsa.html">LOG_LSA</a> start_lsa;</div><div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;  <a class="code" href="log__impl_8h.html#ab85dbe80b115a32bf7a430c32ddc5b8b">LOG_RECTYPE</a> rectype = <a class="code" href="log__impl_8h.html#abb2a79de9a9c6b39a4137ba3417daa0b">LOG_IS_MVCC_OPERATION</a> (rcvindex) ? <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7ab4e00d9048c5782ee68b646ff785f6de">LOG_MVCC_UNDOREDO_DATA</a> : <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7aa0d885a58816898b0877635fc7f15716">LOG_UNDOREDO_DATA</a>;</div><div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;</div><div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;<span class="preprocessor">#if defined(CUBRID_DEBUG)</span></div><div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;  <span class="keywordflow">if</span> (addr-&gt;<a class="code" href="structlog__data__addr.html#a3c632dae3ad660a8572d9298716d9522">pgptr</a> == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;    {</div><div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;      <span class="comment">/* </span></div><div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;<span class="comment">       * Redo is always an operation page level logging. Thus, a data page</span></div><div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;<span class="comment">       * pointer must have been given as part of the address</span></div><div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;      <a class="code" href="error__manager_8c.html#afdaf87ce30f2f557802a185ab85b6599">er_set</a> (<a class="code" href="error__manager_8h.html#a5d0d456c474e11fc70779873a30a7432a07ad8f9fda27124d297c94b7d3ea44e8">ER_ERROR_SEVERITY</a>, <a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <a class="code" href="error__code_8h.html#a735645c59f194f130c655b1974b6df17">ER_LOG_REDO_INTERFACE</a>, 0);</div><div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;      error_code = <a class="code" href="error__code_8h.html#a735645c59f194f130c655b1974b6df17">ER_LOG_REDO_INTERFACE</a>;</div><div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;    }</div><div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="recovery_8c.html#ad2eee9d1e5914fa34d3a7868bf2549f4">RV_fun</a>[rcvindex].undofun == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || <a class="code" href="recovery_8c.html#ad2eee9d1e5914fa34d3a7868bf2549f4">RV_fun</a>[rcvindex].redofun == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;    {</div><div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;      <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (<span class="keyword">false</span>);</div><div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;    }</div><div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* CUBRID_DEBUG */</span><span class="preprocessor"></span></div><div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;</div><div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;<span class="preprocessor">#if !defined(SERVER_MODE)</span></div><div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;  <a class="code" href="error__manager_8h.html#a34b88b0e828e26dd5cf930a0b1dd57a7">assert_release</a> (!<a class="code" href="log__impl_8h.html#abb2a79de9a9c6b39a4137ba3417daa0b">LOG_IS_MVCC_OPERATION</a> (rcvindex));</div><div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* SERVER_MODE */</span><span class="preprocessor"></span></div><div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;</div><div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;  <span class="keywordflow">if</span> (log_No_logging)</div><div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;    {</div><div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;      <span class="comment">/* We are not logging */</span></div><div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;      <a class="code" href="log__manager_8c.html#a62a934c871b6ec0f1feeecaea8cfc4dd">LOG_FLUSH_LOGGING_HAS_BEEN_SKIPPED</a> (thread_p);</div><div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;      <a class="code" href="log__manager_8c.html#af7bfbd98d66410cc6e3d1d050cec24ec">log_skip_logging</a> (thread_p, addr);</div><div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;    }</div><div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;</div><div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;  <span class="comment">/* Find transaction descriptor for current logging transaction */</span></div><div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;  tran_index = <a class="code" href="perf__monitor_8h.html#a55d27b01d605ba6ee2929ddfe8588320">LOG_FIND_THREAD_TRAN_INDEX</a> (thread_p);</div><div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;</div><div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="vacuum_8h.html#ab0e1deb8da1aa663aa073b0ce78606a2">VACUUM_IS_THREAD_VACUUM</a> (thread_p) &amp;&amp; <a class="code" href="vacuum_8h.html#a6a1dc228ca433bf85d100084b318153f">vacuum_worker_state_is_topop</a> (thread_p))</div><div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;    {</div><div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;      <span class="comment">/* Vacuum worker has started system operations and all logging should use its reserved transaction descriptor</span></div><div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;<span class="comment">       * instead of system tdes. */</span></div><div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;      tdes = <a class="code" href="vacuum_8h.html#a3bae574be1c3bf9a786050397a1cde68">vacuum_get_worker_tdes</a> (thread_p);</div><div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;    }</div><div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;    {</div><div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;      <span class="comment">/* Find tdes from transaction table. */</span></div><div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;      tdes = <a class="code" href="log__impl_8h.html#a08fee41cfcf592e8afdbc4988ffbc8e4">LOG_FIND_TDES</a> (tran_index);</div><div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;    }</div><div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;  <span class="keywordflow">if</span> (tdes == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;    {</div><div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;      <a class="code" href="error__manager_8c.html#afdaf87ce30f2f557802a185ab85b6599">er_set</a> (<a class="code" href="error__manager_8h.html#a5d0d456c474e11fc70779873a30a7432a3314630dd19f90a68274cf737092c9f2">ER_FATAL_ERROR_SEVERITY</a>, <a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <a class="code" href="error__code_8h.html#a4b8e41e78be77c579a2c58f5248fefe2">ER_LOG_UNKNOWN_TRANINDEX</a>, 1, tran_index);</div><div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;      error_code = <a class="code" href="error__code_8h.html#a4b8e41e78be77c579a2c58f5248fefe2">ER_LOG_UNKNOWN_TRANINDEX</a>;</div><div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;    }</div><div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;</div><div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;  <span class="comment">/* </span></div><div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;<span class="comment">   * If we are not in a top system operation, the transaction is unactive, and</span></div><div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;<span class="comment">   * the transaction is not in the process of been aborted, we do nothing.</span></div><div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;  <span class="keywordflow">if</span> (tdes-&gt;<a class="code" href="structlog__tdes.html#a97c1d42917ab4d08ffe3194fc7233018">topops</a>.<a class="code" href="structlog__topops__stack.html#a5e509dcc15d89abc0c6ba486af6dba4d">last</a> &lt; 0 &amp;&amp; !<a class="code" href="log__impl_8h.html#aa81dc352329c9f96467c795c1547be74">LOG_ISTRAN_ACTIVE</a> (tdes) &amp;&amp; !<a class="code" href="log__impl_8h.html#ab0e135eabcb7c4a5d08244226f68f0ba">LOG_ISTRAN_ABORTED</a> (tdes))</div><div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;    {</div><div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;      <span class="comment">/* </span></div><div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;<span class="comment">       * We do not log anything when the transaction is unactive and it is not</span></div><div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;<span class="comment">       * in the process of aborting.</span></div><div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;    }</div><div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;</div><div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;  <span class="comment">/* </span></div><div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;<span class="comment">   * is undo logging needed ?</span></div><div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;</div><div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;  <span class="keywordflow">if</span> (log_can_skip_undo_logging (thread_p, rcvindex, tdes, addr) == <span class="keyword">true</span>)</div><div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;    {</div><div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;      <span class="comment">/* undo logging is ignored at this point */</span></div><div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;      <a class="code" href="log__manager_8c.html#ad39dc10a11df5427f5af4c203e9d98a6">log_append_redo_crumbs</a> (thread_p, rcvindex, addr, num_redo_crumbs, redo_crumbs);</div><div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;    }</div><div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;</div><div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;  <span class="comment">/* </span></div><div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;<span class="comment">   * Now do the UNDO &amp; REDO portion</span></div><div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;</div><div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;  <a class="code" href="structnodeptr.html">node</a> = <a class="code" href="log__impl_8h.html#a04538e7143a5fb7ccadf92186efc74db">prior_lsa_alloc_and_copy_crumbs</a> (thread_p, rectype, rcvindex, addr, num_undo_crumbs, undo_crumbs,</div><div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;                      num_redo_crumbs, redo_crumbs);</div><div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="structnodeptr.html">node</a> == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;    {</div><div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;    }</div><div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;</div><div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;  start_lsa = <a class="code" href="log__impl_8h.html#a8a3ce7b7aa59fe26c04eca3577e434e8">prior_lsa_next_record</a> (thread_p, <a class="code" href="structnodeptr.html">node</a>, tdes);</div><div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;</div><div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="log__manager_8c.html#acbe7c7db028f78d1f9ceda699b93c74e">LOG_NEED_TO_SET_LSA</a> (rcvindex, addr-&gt;<a class="code" href="structlog__data__addr.html#a3c632dae3ad660a8572d9298716d9522">pgptr</a>))</div><div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;    {</div><div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="page__buffer_8c.html#a95c9161ba3bb8e129b0c2407447c1b1b">pgbuf_set_lsa</a> (thread_p, addr-&gt;<a class="code" href="structlog__data__addr.html#a3c632dae3ad660a8572d9298716d9522">pgptr</a>, &amp;start_lsa) == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;    {</div><div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;      <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (<span class="keyword">false</span>);</div><div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;    }</div><div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;    }</div><div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;  <span class="keywordflow">if</span> (addr-&gt;<a class="code" href="structlog__data__addr.html#a3c632dae3ad660a8572d9298716d9522">pgptr</a> != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> &amp;&amp; <a class="code" href="log__impl_8h.html#abb2a79de9a9c6b39a4137ba3417daa0b">LOG_IS_MVCC_OPERATION</a> (rcvindex))</div><div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;    {</div><div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;      <a class="code" href="page__buffer_8c.html#a68c72a9eaad187a1b53344a25905e2fc">pgbuf_notify_vacuum_follows</a> (thread_p, addr-&gt;<a class="code" href="structlog__data__addr.html#a3c632dae3ad660a8572d9298716d9522">pgptr</a>);</div><div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;    }</div><div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;</div><div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="log__impl_8h.html#a2d9876809ffa8473b6b47c5edcff6ca2">LOG_CHECK_LOG_APPLIER</a> (thread_p) &amp;&amp; !<a class="code" href="vacuum_8h.html#ab0e1deb8da1aa663aa073b0ce78606a2">VACUUM_IS_THREAD_VACUUM</a> (thread_p) &amp;&amp; <a class="code" href="log__comm_8c.html#ae3b5771bd95aa37a187f3a6e0cb2b32d">log_does_allow_replication</a> () == <span class="keyword">true</span>)</div><div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;    {</div><div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;      <span class="keywordflow">if</span> (rcvindex == <a class="code" href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2bad08a05274deb3b86f225471a3763b75f">RVHF_UPDATE</a> || rcvindex == <a class="code" href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2badb0beae889294e6a1fce8fa119a8cfe3">RVOVF_CHANGE_LINK</a> || rcvindex == <a class="code" href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2ba62fd60ee126c842a43a0686dd479f3e7">RVHF_UPDATE_NOTIFY_VACUUM</a></div><div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;      || rcvindex == <a class="code" href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2ba0b40e1edf3b9938d9177487ef402c97a">RVHF_INSERT_NEWHOME</a>)</div><div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;    {</div><div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;      <a class="code" href="storage__common_8h.html#a4c9bc15296fe6728cf0351726cc6ad09">LSA_COPY</a> (&amp;tdes-&gt;<a class="code" href="structlog__tdes.html#ac6b6a36cbca989a3a6da12acc2227d56">repl_update_lsa</a>, &amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a5b128a08476a5b499cf82e3163e6d62b">tail_lsa</a>);</div><div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;    }</div><div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (rcvindex == <a class="code" href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2ba8f43c180538657b73f7f59fbefbd22c8">RVHF_INSERT</a> || rcvindex == <a class="code" href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2babafc7610a68e7852f0293731f9b004a5">RVHF_MVCC_INSERT</a>)</div><div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;    {</div><div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;      <a class="code" href="storage__common_8h.html#a4c9bc15296fe6728cf0351726cc6ad09">LSA_COPY</a> (&amp;tdes-&gt;<a class="code" href="structlog__tdes.html#aafccc5902319242f425656aaebdc615b">repl_insert_lsa</a>, &amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a5b128a08476a5b499cf82e3163e6d62b">tail_lsa</a>);</div><div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;    }</div><div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;    }</div><div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;}</div><div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;</div><div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;<span class="comment"> * log_append_undo_crumbs - LOG UNDO (BEFORE) CRUMBS OF DATA</span></div><div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;<span class="comment"> * return: nothing</span></div><div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;<span class="comment"> *   rcvindex(in): Index to recovery function</span></div><div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;<span class="comment"> *   addr(in): Address (Volume, page, and offset) of data</span></div><div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;<span class="comment"> *   num_crumbs(in): Number of undo crumbs</span></div><div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;<span class="comment"> *   crumbs(in): The undo crumbs</span></div><div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l02197"></a><span class="lineno"><a class="line" href="log__manager_8h.html#a9ba19c0baec377fbab0da02a75c7260d"> 2197</a></span>&#160;<a class="code" href="log__manager_8c.html#a9ba19c0baec377fbab0da02a75c7260d">log_append_undo_crumbs</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2b">LOG_RCVINDEX</a> rcvindex, <a class="code" href="structlog__data__addr.html">LOG_DATA_ADDR</a> * addr, <span class="keywordtype">int</span> num_crumbs,</div><div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;            <span class="keyword">const</span> <a class="code" href="structlog__crumb.html">LOG_CRUMB</a> * crumbs)</div><div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;{</div><div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;  <a class="code" href="structlog__tdes.html">LOG_TDES</a> *tdes;       <span class="comment">/* Transaction descriptor */</span></div><div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;  <span class="keywordtype">int</span> tran_index;</div><div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;  <span class="keywordtype">int</span> error_code = <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>;</div><div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;  <a class="code" href="structlog__prior__node.html">LOG_PRIOR_NODE</a> *<a class="code" href="external_2include_2queue_8h.html#a465e28dbd1a1c60ff504d3ea275613ed">node</a>;</div><div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;  <a class="code" href="structlog__lsa.html">LOG_LSA</a> start_lsa;</div><div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;  <a class="code" href="log__impl_8h.html#ab85dbe80b115a32bf7a430c32ddc5b8b">LOG_RECTYPE</a> rectype = <a class="code" href="log__impl_8h.html#abb2a79de9a9c6b39a4137ba3417daa0b">LOG_IS_MVCC_OPERATION</a> (rcvindex) ? <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a5eb32eedc7671f3f89c1b10c3d0229c1">LOG_MVCC_UNDO_DATA</a> : <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a661c01f08dbb476251ceae0d99bb5412">LOG_UNDO_DATA</a>;</div><div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;</div><div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;<span class="preprocessor">#if defined(CUBRID_DEBUG)</span></div><div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="recovery_8c.html#ad2eee9d1e5914fa34d3a7868bf2549f4">RV_fun</a>[rcvindex].undofun == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;    {</div><div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;      <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (<span class="keyword">false</span>);</div><div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;    }</div><div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* CUBRID_DEBUG */</span><span class="preprocessor"></span></div><div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;</div><div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;  <span class="keywordflow">if</span> (log_No_logging)</div><div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;    {</div><div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;      <span class="comment">/* We are not logging */</span></div><div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;      <a class="code" href="log__manager_8c.html#a62a934c871b6ec0f1feeecaea8cfc4dd">LOG_FLUSH_LOGGING_HAS_BEEN_SKIPPED</a> (thread_p);</div><div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;      <span class="keywordflow">if</span> (addr-&gt;<a class="code" href="structlog__data__addr.html#a3c632dae3ad660a8572d9298716d9522">pgptr</a> != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;    {</div><div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;      <a class="code" href="log__manager_8c.html#af7bfbd98d66410cc6e3d1d050cec24ec">log_skip_logging</a> (thread_p, addr);</div><div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;    }</div><div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;    }</div><div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;</div><div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;  <span class="comment">/* Find transaction descriptor for current logging transaction */</span></div><div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;  tran_index = <a class="code" href="perf__monitor_8h.html#a55d27b01d605ba6ee2929ddfe8588320">LOG_FIND_THREAD_TRAN_INDEX</a> (thread_p);</div><div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="vacuum_8h.html#ab0e1deb8da1aa663aa073b0ce78606a2">VACUUM_IS_THREAD_VACUUM</a> (thread_p) &amp;&amp; <a class="code" href="vacuum_8h.html#a6a1dc228ca433bf85d100084b318153f">vacuum_worker_state_is_topop</a> (thread_p))</div><div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;    {</div><div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;      <span class="comment">/* Vacuum worker has started system operations and all logging should use its reserved transaction descriptor</span></div><div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;<span class="comment">       * instead of system tdes. */</span></div><div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;      tdes = <a class="code" href="vacuum_8h.html#a3bae574be1c3bf9a786050397a1cde68">vacuum_get_worker_tdes</a> (thread_p);</div><div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;    }</div><div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;    {</div><div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;      <span class="comment">/* Find tdes in transaction table. */</span></div><div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;      tdes = <a class="code" href="log__impl_8h.html#a08fee41cfcf592e8afdbc4988ffbc8e4">LOG_FIND_TDES</a> (tran_index);</div><div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;    }</div><div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;  <span class="keywordflow">if</span> (tdes == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;    {</div><div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;      <a class="code" href="error__manager_8c.html#afdaf87ce30f2f557802a185ab85b6599">er_set</a> (<a class="code" href="error__manager_8h.html#a5d0d456c474e11fc70779873a30a7432a3314630dd19f90a68274cf737092c9f2">ER_FATAL_ERROR_SEVERITY</a>, <a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <a class="code" href="error__code_8h.html#a4b8e41e78be77c579a2c58f5248fefe2">ER_LOG_UNKNOWN_TRANINDEX</a>, 1, tran_index);</div><div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;      error_code = <a class="code" href="error__code_8h.html#a4b8e41e78be77c579a2c58f5248fefe2">ER_LOG_UNKNOWN_TRANINDEX</a>;</div><div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;    }</div><div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;</div><div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;  <span class="comment">/* </span></div><div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;<span class="comment">   * If we are not in a top system operation, the transaction is unactive, and</span></div><div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;<span class="comment">   * the transaction is not in the process of been aborted, we do nothing.</span></div><div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;  <span class="keywordflow">if</span> (tdes-&gt;<a class="code" href="structlog__tdes.html#a97c1d42917ab4d08ffe3194fc7233018">topops</a>.<a class="code" href="structlog__topops__stack.html#a5e509dcc15d89abc0c6ba486af6dba4d">last</a> &lt; 0 &amp;&amp; !<a class="code" href="log__impl_8h.html#aa81dc352329c9f96467c795c1547be74">LOG_ISTRAN_ACTIVE</a> (tdes) &amp;&amp; !<a class="code" href="log__impl_8h.html#ab0e135eabcb7c4a5d08244226f68f0ba">LOG_ISTRAN_ABORTED</a> (tdes))</div><div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;    {</div><div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;      <span class="comment">/* </span></div><div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;<span class="comment">       * We do not log anything when the transaction is unactive and it is not</span></div><div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;<span class="comment">       * in the process of aborting.</span></div><div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;    }</div><div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;</div><div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;  <span class="comment">/* </span></div><div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;<span class="comment">   * is undo logging needed ?</span></div><div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;  <span class="keywordflow">if</span> (log_can_skip_undo_logging (thread_p, rcvindex, tdes, addr) == <span class="keyword">true</span>)</div><div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;    {</div><div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;      <span class="comment">/* undo logging is ignored at this point */</span></div><div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;      ;             <span class="comment">/* NO-OP */</span></div><div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;    }</div><div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;</div><div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;  <span class="comment">/* </span></div><div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;<span class="comment">   * NOW do the UNDO ...</span></div><div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;</div><div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;  <a class="code" href="structnodeptr.html">node</a> = <a class="code" href="log__impl_8h.html#a04538e7143a5fb7ccadf92186efc74db">prior_lsa_alloc_and_copy_crumbs</a> (thread_p, rectype, rcvindex, addr, num_crumbs, crumbs, 0, <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="structnodeptr.html">node</a> == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;    {</div><div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;      <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (<span class="keyword">false</span>);</div><div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;    }</div><div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;</div><div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;  start_lsa = <a class="code" href="log__impl_8h.html#a8a3ce7b7aa59fe26c04eca3577e434e8">prior_lsa_next_record</a> (thread_p, <a class="code" href="structnodeptr.html">node</a>, tdes);</div><div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;</div><div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;  <span class="keywordflow">if</span> (addr-&gt;<a class="code" href="structlog__data__addr.html#a3c632dae3ad660a8572d9298716d9522">pgptr</a> != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> &amp;&amp; <a class="code" href="log__manager_8c.html#acbe7c7db028f78d1f9ceda699b93c74e">LOG_NEED_TO_SET_LSA</a> (rcvindex, addr-&gt;<a class="code" href="structlog__data__addr.html#a3c632dae3ad660a8572d9298716d9522">pgptr</a>))</div><div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;    {</div><div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="page__buffer_8c.html#a95c9161ba3bb8e129b0c2407447c1b1b">pgbuf_set_lsa</a> (thread_p, addr-&gt;<a class="code" href="structlog__data__addr.html#a3c632dae3ad660a8572d9298716d9522">pgptr</a>, &amp;start_lsa) == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;    {</div><div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;      <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (<span class="keyword">false</span>);</div><div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;    }</div><div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;    }</div><div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;  <span class="keywordflow">if</span> (addr-&gt;<a class="code" href="structlog__data__addr.html#a3c632dae3ad660a8572d9298716d9522">pgptr</a> != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> &amp;&amp; <a class="code" href="log__impl_8h.html#abb2a79de9a9c6b39a4137ba3417daa0b">LOG_IS_MVCC_OPERATION</a> (rcvindex))</div><div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;    {</div><div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;      <a class="code" href="page__buffer_8c.html#a68c72a9eaad187a1b53344a25905e2fc">pgbuf_notify_vacuum_follows</a> (thread_p, addr-&gt;<a class="code" href="structlog__data__addr.html#a3c632dae3ad660a8572d9298716d9522">pgptr</a>);</div><div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;    }</div><div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;}</div><div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;</div><div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;<span class="comment"> * log_append_redo_crumbs - LOG REDO (AFTER) CRUMBS OF DATA</span></div><div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;<span class="comment"> * return: nothing</span></div><div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;<span class="comment"> *   rcvindex(in): Index to recovery function</span></div><div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;<span class="comment"> *   addr(in): Address (Volume, page, and offset) of data</span></div><div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;<span class="comment"> *   num_crumbs(in): Number of undo crumbs</span></div><div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;<span class="comment"> *   crumbs(in): The undo crumbs</span></div><div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;<span class="comment"> * NOTE: Log redo(after) crumbs of data. A log record is constructed to</span></div><div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;<span class="comment"> *              recover data by redoing data during recovery.</span></div><div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;<span class="comment"> *              The log manager does not really store crumbs of data, instead</span></div><div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;<span class="comment"> *              the log manager glues them together as a stream of data, and</span></div><div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;<span class="comment"> *              thus, it looses the knowledge that the data was from crumbs.</span></div><div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;<span class="comment"> *              This is done to avoid extra storage overhead. It is the</span></div><div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;<span class="comment"> *              responsibility of the recovery functions to build the crumbs</span></div><div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;<span class="comment"> *              when needed from the glued data.</span></div><div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;<span class="comment"> *              During recovery(e.g., system crash recovery), the redo</span></div><div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;<span class="comment"> *              function described by rcvindex is called with a recovery</span></div><div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;<span class="comment"> *              structure which contains the page pointer and offset of the</span></div><div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;<span class="comment"> *              data to recover along with the redo glued data. The redo</span></div><div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;<span class="comment"> *              function must construct the crumbs when needed. It is up to</span></div><div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;<span class="comment"> *              this function, how to undo the data.</span></div><div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;<span class="comment"> *     1)       Same notes as log_append_redo_data (see this function)</span></div><div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;<span class="comment"> *     2)       The only purpose of this function is to avoid extra data</span></div><div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;<span class="comment"> *              copying (the glue into one contiguous area) by the caller,</span></div><div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;<span class="comment"> *              otherwise, the same as log_append_redo_data.</span></div><div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l02328"></a><span class="lineno"><a class="line" href="log__manager_8h.html#ad39dc10a11df5427f5af4c203e9d98a6"> 2328</a></span>&#160;<a class="code" href="log__manager_8c.html#ad39dc10a11df5427f5af4c203e9d98a6">log_append_redo_crumbs</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2b">LOG_RCVINDEX</a> rcvindex, <a class="code" href="structlog__data__addr.html">LOG_DATA_ADDR</a> * addr, <span class="keywordtype">int</span> num_crumbs,</div><div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;            <span class="keyword">const</span> <a class="code" href="structlog__crumb.html">LOG_CRUMB</a> * crumbs)</div><div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;{</div><div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;  <a class="code" href="structlog__tdes.html">LOG_TDES</a> *tdes;       <span class="comment">/* Transaction descriptor */</span></div><div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;  <span class="keywordtype">int</span> tran_index;</div><div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;  <span class="keywordtype">int</span> error_code = <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>;</div><div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;  <a class="code" href="structlog__prior__node.html">LOG_PRIOR_NODE</a> *<a class="code" href="external_2include_2queue_8h.html#a465e28dbd1a1c60ff504d3ea275613ed">node</a>;</div><div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;  <a class="code" href="structlog__lsa.html">LOG_LSA</a> start_lsa;</div><div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;  <a class="code" href="log__impl_8h.html#ab85dbe80b115a32bf7a430c32ddc5b8b">LOG_RECTYPE</a> rectype = <a class="code" href="log__impl_8h.html#abb2a79de9a9c6b39a4137ba3417daa0b">LOG_IS_MVCC_OPERATION</a> (rcvindex) ? <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a4252bfab0a4f9fbbcd7bd68ba32dea1d">LOG_MVCC_REDO_DATA</a> : <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7ac17426d82957cd6c312341d4f5badd87">LOG_REDO_DATA</a>;</div><div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;</div><div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;<span class="preprocessor">#if defined(CUBRID_DEBUG)</span></div><div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;  <span class="keywordflow">if</span> (addr-&gt;<a class="code" href="structlog__data__addr.html#a3c632dae3ad660a8572d9298716d9522">pgptr</a> == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;    {</div><div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;      <span class="comment">/* </span></div><div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;<span class="comment">       * Redo is always an operation page level logging. Thus, a data page</span></div><div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;<span class="comment">       * pointer must have been given as part of the address</span></div><div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;      <a class="code" href="error__manager_8c.html#afdaf87ce30f2f557802a185ab85b6599">er_set</a> (<a class="code" href="error__manager_8h.html#a5d0d456c474e11fc70779873a30a7432a07ad8f9fda27124d297c94b7d3ea44e8">ER_ERROR_SEVERITY</a>, <a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <a class="code" href="error__code_8h.html#a735645c59f194f130c655b1974b6df17">ER_LOG_REDO_INTERFACE</a>, 0);</div><div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;      error_code = <a class="code" href="error__code_8h.html#a735645c59f194f130c655b1974b6df17">ER_LOG_REDO_INTERFACE</a>;</div><div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;    }</div><div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="recovery_8c.html#ad2eee9d1e5914fa34d3a7868bf2549f4">RV_fun</a>[rcvindex].redofun == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;    {</div><div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;      <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (<span class="keyword">false</span>);</div><div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;    }</div><div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* CUBRID_DEBUG */</span><span class="preprocessor"></span></div><div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;</div><div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;  <span class="keywordflow">if</span> (log_No_logging)</div><div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;    {</div><div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;      <span class="comment">/* We are not logging */</span></div><div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;      <a class="code" href="log__manager_8c.html#a62a934c871b6ec0f1feeecaea8cfc4dd">LOG_FLUSH_LOGGING_HAS_BEEN_SKIPPED</a> (thread_p);</div><div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;      <a class="code" href="log__manager_8c.html#af7bfbd98d66410cc6e3d1d050cec24ec">log_skip_logging</a> (thread_p, addr);</div><div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;    }</div><div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;</div><div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;  <span class="comment">/* Find transaction descriptor for current logging transaction */</span></div><div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;  tran_index = <a class="code" href="perf__monitor_8h.html#a55d27b01d605ba6ee2929ddfe8588320">LOG_FIND_THREAD_TRAN_INDEX</a> (thread_p);</div><div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="vacuum_8h.html#ab0e1deb8da1aa663aa073b0ce78606a2">VACUUM_IS_THREAD_VACUUM</a> (thread_p) &amp;&amp; <a class="code" href="vacuum_8h.html#a6a1dc228ca433bf85d100084b318153f">vacuum_worker_state_is_topop</a> (thread_p))</div><div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;    {</div><div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;      <span class="comment">/* Vacuum worker has started system operations and all logging should use its reserved transaction descriptor</span></div><div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;<span class="comment">       * instead of system tdes. */</span></div><div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;      tdes = <a class="code" href="vacuum_8h.html#a3bae574be1c3bf9a786050397a1cde68">vacuum_get_worker_tdes</a> (thread_p);</div><div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;    }</div><div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;    {</div><div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;      <span class="comment">/* Find tdes in transaction table. */</span></div><div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;      tdes = <a class="code" href="log__impl_8h.html#a08fee41cfcf592e8afdbc4988ffbc8e4">LOG_FIND_TDES</a> (tran_index);</div><div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;    }</div><div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;  <span class="keywordflow">if</span> (tdes == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;    {</div><div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;      <a class="code" href="error__manager_8c.html#afdaf87ce30f2f557802a185ab85b6599">er_set</a> (<a class="code" href="error__manager_8h.html#a5d0d456c474e11fc70779873a30a7432a3314630dd19f90a68274cf737092c9f2">ER_FATAL_ERROR_SEVERITY</a>, <a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <a class="code" href="error__code_8h.html#a4b8e41e78be77c579a2c58f5248fefe2">ER_LOG_UNKNOWN_TRANINDEX</a>, 1, tran_index);</div><div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;      error_code = <a class="code" href="error__code_8h.html#a4b8e41e78be77c579a2c58f5248fefe2">ER_LOG_UNKNOWN_TRANINDEX</a>;</div><div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;    }</div><div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;</div><div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;  <span class="comment">/* </span></div><div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;<span class="comment">   * If we are not in a top system operation, the transaction is unactive, and</span></div><div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;<span class="comment">   * the transaction is not in the process of been aborted, we do nothing.</span></div><div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;  <span class="keywordflow">if</span> (tdes-&gt;<a class="code" href="structlog__tdes.html#a97c1d42917ab4d08ffe3194fc7233018">topops</a>.<a class="code" href="structlog__topops__stack.html#a5e509dcc15d89abc0c6ba486af6dba4d">last</a> &lt; 0 &amp;&amp; !<a class="code" href="log__impl_8h.html#aa81dc352329c9f96467c795c1547be74">LOG_ISTRAN_ACTIVE</a> (tdes) &amp;&amp; !<a class="code" href="log__impl_8h.html#ab0e135eabcb7c4a5d08244226f68f0ba">LOG_ISTRAN_ABORTED</a> (tdes))</div><div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;    {</div><div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;      <span class="comment">/* </span></div><div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;<span class="comment">       * We do not log anything when the transaction is unactive and it is not</span></div><div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;<span class="comment">       * in the process of aborting.</span></div><div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;    }</div><div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;</div><div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;  <span class="keywordflow">if</span> (log_can_skip_redo_logging (rcvindex, tdes, addr) == <span class="keyword">true</span>)</div><div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;    {</div><div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;    }</div><div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;</div><div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;  <a class="code" href="structnodeptr.html">node</a> = <a class="code" href="log__impl_8h.html#a04538e7143a5fb7ccadf92186efc74db">prior_lsa_alloc_and_copy_crumbs</a> (thread_p, rectype, rcvindex, addr, 0, <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, num_crumbs, crumbs);</div><div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="structnodeptr.html">node</a> == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;    {</div><div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;    }</div><div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;</div><div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;  start_lsa = <a class="code" href="log__impl_8h.html#a8a3ce7b7aa59fe26c04eca3577e434e8">prior_lsa_next_record</a> (thread_p, <a class="code" href="structnodeptr.html">node</a>, tdes);</div><div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;</div><div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;  <span class="comment">/* </span></div><div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;<span class="comment">   * Set the LSA on the data page of the corresponding log record for page</span></div><div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;<span class="comment">   * operation logging.</span></div><div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;<span class="comment">   *</span></div><div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;<span class="comment">   * Make sure that I should log. Page operational logging is not done for</span></div><div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;<span class="comment">   * temporary data of temporary files and volumes</span></div><div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="log__manager_8c.html#acbe7c7db028f78d1f9ceda699b93c74e">LOG_NEED_TO_SET_LSA</a> (rcvindex, addr-&gt;<a class="code" href="structlog__data__addr.html#a3c632dae3ad660a8572d9298716d9522">pgptr</a>))</div><div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;    {</div><div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="page__buffer_8c.html#a95c9161ba3bb8e129b0c2407447c1b1b">pgbuf_set_lsa</a> (thread_p, addr-&gt;<a class="code" href="structlog__data__addr.html#a3c632dae3ad660a8572d9298716d9522">pgptr</a>, &amp;start_lsa) == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;    {</div><div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;      <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (<span class="keyword">false</span>);</div><div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;    }</div><div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;    }</div><div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;</div><div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="log__impl_8h.html#a2d9876809ffa8473b6b47c5edcff6ca2">LOG_CHECK_LOG_APPLIER</a> (thread_p) &amp;&amp; !<a class="code" href="vacuum_8h.html#ab0e1deb8da1aa663aa073b0ce78606a2">VACUUM_IS_THREAD_VACUUM</a> (thread_p) &amp;&amp; <a class="code" href="log__comm_8c.html#ae3b5771bd95aa37a187f3a6e0cb2b32d">log_does_allow_replication</a> () == <span class="keyword">true</span>)</div><div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;    {</div><div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;      <span class="keywordflow">if</span> (rcvindex == <a class="code" href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2bad08a05274deb3b86f225471a3763b75f">RVHF_UPDATE</a> || rcvindex == <a class="code" href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2badb0beae889294e6a1fce8fa119a8cfe3">RVOVF_CHANGE_LINK</a> || rcvindex == <a class="code" href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2ba62fd60ee126c842a43a0686dd479f3e7">RVHF_UPDATE_NOTIFY_VACUUM</a>)</div><div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;    {</div><div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;      <a class="code" href="storage__common_8h.html#a4c9bc15296fe6728cf0351726cc6ad09">LSA_COPY</a> (&amp;tdes-&gt;<a class="code" href="structlog__tdes.html#ac6b6a36cbca989a3a6da12acc2227d56">repl_update_lsa</a>, &amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a5b128a08476a5b499cf82e3163e6d62b">tail_lsa</a>);</div><div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;    }</div><div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (rcvindex == <a class="code" href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2ba8f43c180538657b73f7f59fbefbd22c8">RVHF_INSERT</a> || rcvindex == <a class="code" href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2babafc7610a68e7852f0293731f9b004a5">RVHF_MVCC_INSERT</a>)</div><div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;    {</div><div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;      <a class="code" href="storage__common_8h.html#a4c9bc15296fe6728cf0351726cc6ad09">LSA_COPY</a> (&amp;tdes-&gt;<a class="code" href="structlog__tdes.html#aafccc5902319242f425656aaebdc615b">repl_insert_lsa</a>, &amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a5b128a08476a5b499cf82e3163e6d62b">tail_lsa</a>);</div><div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;    }</div><div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;    }</div><div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;}</div><div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;</div><div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;<span class="comment"> * log_append_undoredo_recdes - LOG UNDO (BEFORE) + REDO (AFTER) RECORD DESCRIPTOR</span></div><div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;<span class="comment"> * return: nothing</span></div><div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;<span class="comment"> *   rcvindex(in): Index to recovery function</span></div><div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;<span class="comment"> *   addr(in): Address (Volume, page, and offset) of data</span></div><div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;<span class="comment"> *   undo_recdes(in): Undo(before) record descriptor</span></div><div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;<span class="comment"> *   redo_recdes(in): Redo(after) record descriptor</span></div><div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l02451"></a><span class="lineno"><a class="line" href="log__manager_8h.html#a9b372c8c519e6c4760653da1bff49851"> 2451</a></span>&#160;<a class="code" href="log__manager_8c.html#a9b372c8c519e6c4760653da1bff49851">log_append_undoredo_recdes</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2b">LOG_RCVINDEX</a> rcvindex, <a class="code" href="structlog__data__addr.html">LOG_DATA_ADDR</a> * addr,</div><div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;                <span class="keyword">const</span> <a class="code" href="structrecdes.html">RECDES</a> * undo_recdes, <span class="keyword">const</span> <a class="code" href="structrecdes.html">RECDES</a> * redo_recdes)</div><div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;{</div><div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;  <a class="code" href="log__manager_8c.html#a5b86861d06b273efd9a45cfefc83d3f6">log_append_undoredo_recdes2</a> (thread_p, rcvindex, addr-&gt;<a class="code" href="structlog__data__addr.html#a23830dd623509faa8744024abec22ca8">vfid</a>, addr-&gt;<a class="code" href="structlog__data__addr.html#a3c632dae3ad660a8572d9298716d9522">pgptr</a>, addr-&gt;<a class="code" href="structlog__data__addr.html#ab8ee0b45ab1d94bffa3626936b282d5f">offset</a>, undo_recdes, redo_recdes);</div><div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;}</div><div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;</div><div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l02458"></a><span class="lineno"><a class="line" href="log__manager_8h.html#a5b86861d06b273efd9a45cfefc83d3f6"> 2458</a></span>&#160;<a class="code" href="log__manager_8c.html#a5b86861d06b273efd9a45cfefc83d3f6">log_append_undoredo_recdes2</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2b">LOG_RCVINDEX</a> rcvindex, <span class="keyword">const</span> <a class="code" href="structvfid.html">VFID</a> * <a class="code" href="structvfid.html">vfid</a>, <a class="code" href="storage__common_8h.html#ae4a052db40daa4a44a890bad45d8ecdc">PAGE_PTR</a> pgptr,</div><div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;                 <a class="code" href="storage__common_8h.html#ac3f9d7ae37c5a4cb27570f7313891bc8">PGLENGTH</a> <a class="code" href="expat_8h.html#ad0c30ee1add42468a6d7c022f2efdf70">offset</a>, <span class="keyword">const</span> <a class="code" href="structrecdes.html">RECDES</a> * undo_recdes, <span class="keyword">const</span> <a class="code" href="structrecdes.html">RECDES</a> * redo_recdes)</div><div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;{</div><div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;  <a class="code" href="structlog__crumb.html">LOG_CRUMB</a> crumbs[4];</div><div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;  <a class="code" href="structlog__crumb.html">LOG_CRUMB</a> *undo_crumbs = &amp;crumbs[0];</div><div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;  <a class="code" href="structlog__crumb.html">LOG_CRUMB</a> *redo_crumbs = &amp;crumbs[2];</div><div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;  <span class="keywordtype">int</span> num_undo_crumbs;</div><div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;  <span class="keywordtype">int</span> num_redo_crumbs;</div><div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;  <a class="code" href="structlog__data__addr.html">LOG_DATA_ADDR</a> addr;</div><div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;</div><div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;  addr.<a class="code" href="structlog__data__addr.html#a23830dd623509faa8744024abec22ca8">vfid</a> = <a class="code" href="structvfid.html">vfid</a>;</div><div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;  addr.<a class="code" href="structlog__data__addr.html#a3c632dae3ad660a8572d9298716d9522">pgptr</a> = pgptr;</div><div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;  addr.<a class="code" href="structlog__data__addr.html#ab8ee0b45ab1d94bffa3626936b282d5f">offset</a> = <a class="code" href="expat_8h.html#ad0c30ee1add42468a6d7c022f2efdf70">offset</a>;</div><div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;</div><div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;<span class="preprocessor">#if 0</span></div><div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;  <span class="keywordflow">if</span> (rcvindex == <a class="code" href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2bad08a05274deb3b86f225471a3763b75f">RVHF_UPDATE</a>)</div><div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;    {</div><div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;      <a class="code" href="structlog__tdes.html">LOG_TDES</a> *tdes = <a class="code" href="log__impl_8h.html#a4d2d36199fa78b84a55e80f87d2146a7">LOG_FIND_CURRENT_TDES</a> (thread_p);</div><div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;      <span class="keywordflow">if</span> (tdes &amp;&amp; tdes-&gt;null_log.is_set &amp;&amp; undo_recdes &amp;&amp; redo_recdes)</div><div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;    {</div><div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;      tdes-&gt;null_log.recdes = <a class="code" href="leak__detector_8h.html#a99aa8fd9f4831e1b0fa9e1cdcde3e249">malloc</a> (<span class="keyword">sizeof</span> (<a class="code" href="structrecdes.html">RECDES</a>));</div><div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;      <span class="keywordflow">if</span> (tdes == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;        {</div><div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;          <span class="keywordflow">return</span>;       <span class="comment">/* error */</span></div><div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;        }</div><div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;      *(tdes-&gt;null_log.recdes) = *undo_recdes;</div><div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;      tdes-&gt;null_log.recdes-&gt;data = <a class="code" href="leak__detector_8h.html#a99aa8fd9f4831e1b0fa9e1cdcde3e249">malloc</a> (undo_recdes-&gt;<a class="code" href="structrecdes.html#ad79507ad26c0f557815cb78ce391be8b">length</a>);</div><div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;      <span class="keywordflow">if</span> (tdes-&gt;null_log.recdes-&gt;data == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;        {</div><div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;          <a class="code" href="memory__alloc_8h.html#a794b5a73adc277837a0c4d12da4af5af">free_and_init</a> (tdes-&gt;null_log.recdes);</div><div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;          <span class="keywordflow">return</span>;       <span class="comment">/* error */</span></div><div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;        }</div><div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;      (void) memcpy (tdes-&gt;null_log.recdes-&gt;data, undo_recdes-&gt;<a class="code" href="structrecdes.html#a78fb3ee3142e50670d431d8f7c302b62">data</a>, undo_recdes-&gt;<a class="code" href="structrecdes.html#ad79507ad26c0f557815cb78ce391be8b">length</a>);</div><div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;    }</div><div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;      undo_crumbs[0].<a class="code" href="structlog__crumb.html#a27fa2f547d67332b369d31002bd7ea75">length</a> = <span class="keyword">sizeof</span> (undo_recdes-&gt;<a class="code" href="structrecdes.html#a67343783639754b873ee300e3c742bc4">type</a>);</div><div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;      undo_crumbs[0].<a class="code" href="structlog__crumb.html#a01a9e2039ac048536a6c4aaefaa78896">data</a> = (<span class="keywordtype">char</span> *) &amp;undo_recdes-&gt;<a class="code" href="structrecdes.html#a67343783639754b873ee300e3c742bc4">type</a>;</div><div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;      undo_crumbs[1].<a class="code" href="structlog__crumb.html#a27fa2f547d67332b369d31002bd7ea75">length</a> = 0;</div><div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;      undo_crumbs[1].<a class="code" href="structlog__crumb.html#a01a9e2039ac048536a6c4aaefaa78896">data</a> = <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;      num_undo_crumbs = 2;</div><div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;      redo_crumbs[0].<a class="code" href="structlog__crumb.html#a27fa2f547d67332b369d31002bd7ea75">length</a> = sizeof (redo_recdes-&gt;<a class="code" href="structrecdes.html#a67343783639754b873ee300e3c742bc4">type</a>);</div><div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;      redo_crumbs[0].<a class="code" href="structlog__crumb.html#a01a9e2039ac048536a6c4aaefaa78896">data</a> = (<span class="keywordtype">char</span> *) &amp;redo_recdes-&gt;<a class="code" href="structrecdes.html#a67343783639754b873ee300e3c742bc4">type</a>;</div><div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;      redo_crumbs[1].<a class="code" href="structlog__crumb.html#a27fa2f547d67332b369d31002bd7ea75">length</a> = 0;</div><div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;      redo_crumbs[1].<a class="code" href="structlog__crumb.html#a01a9e2039ac048536a6c4aaefaa78896">data</a> = <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;      num_redo_crumbs = 2;</div><div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;      <a class="code" href="log__manager_8c.html#a487dabcb7a4dc15bab76299fb5ff1660">log_append_undoredo_crumbs</a> (rcvindex, addr, num_undo_crumbs, num_redo_crumbs, undo_crumbs, redo_crumbs);</div><div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;    }</div><div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;</div><div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;  <span class="keywordflow">if</span> (undo_recdes != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;    {</div><div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;      undo_crumbs[0].<a class="code" href="structlog__crumb.html#a27fa2f547d67332b369d31002bd7ea75">length</a> = <span class="keyword">sizeof</span> (undo_recdes-&gt;<a class="code" href="structrecdes.html#a67343783639754b873ee300e3c742bc4">type</a>);</div><div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;      undo_crumbs[0].<a class="code" href="structlog__crumb.html#a01a9e2039ac048536a6c4aaefaa78896">data</a> = (<span class="keywordtype">char</span> *) &amp;undo_recdes-&gt;<a class="code" href="structrecdes.html#a67343783639754b873ee300e3c742bc4">type</a>;</div><div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;      undo_crumbs[1].<a class="code" href="structlog__crumb.html#a27fa2f547d67332b369d31002bd7ea75">length</a> = undo_recdes-&gt;<a class="code" href="structrecdes.html#ad79507ad26c0f557815cb78ce391be8b">length</a>;</div><div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;      undo_crumbs[1].<a class="code" href="structlog__crumb.html#a01a9e2039ac048536a6c4aaefaa78896">data</a> = undo_recdes-&gt;<a class="code" href="structrecdes.html#a78fb3ee3142e50670d431d8f7c302b62">data</a>;</div><div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;      num_undo_crumbs = 2;</div><div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;    }</div><div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;    {</div><div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;      undo_crumbs = <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;      num_undo_crumbs = 0;</div><div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;    }</div><div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;</div><div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;  <span class="keywordflow">if</span> (redo_recdes != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;    {</div><div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;      redo_crumbs[0].<a class="code" href="structlog__crumb.html#a27fa2f547d67332b369d31002bd7ea75">length</a> = <span class="keyword">sizeof</span> (redo_recdes-&gt;<a class="code" href="structrecdes.html#a67343783639754b873ee300e3c742bc4">type</a>);</div><div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;      redo_crumbs[0].<a class="code" href="structlog__crumb.html#a01a9e2039ac048536a6c4aaefaa78896">data</a> = (<span class="keywordtype">char</span> *) &amp;redo_recdes-&gt;<a class="code" href="structrecdes.html#a67343783639754b873ee300e3c742bc4">type</a>;</div><div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;      redo_crumbs[1].<a class="code" href="structlog__crumb.html#a27fa2f547d67332b369d31002bd7ea75">length</a> = redo_recdes-&gt;<a class="code" href="structrecdes.html#ad79507ad26c0f557815cb78ce391be8b">length</a>;</div><div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;      redo_crumbs[1].<a class="code" href="structlog__crumb.html#a01a9e2039ac048536a6c4aaefaa78896">data</a> = redo_recdes-&gt;<a class="code" href="structrecdes.html#a78fb3ee3142e50670d431d8f7c302b62">data</a>;</div><div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;      num_redo_crumbs = 2;</div><div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;    }</div><div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;    {</div><div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;      redo_crumbs = <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;      num_redo_crumbs = 0;</div><div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;    }</div><div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;</div><div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;  <a class="code" href="log__manager_8c.html#a487dabcb7a4dc15bab76299fb5ff1660">log_append_undoredo_crumbs</a> (thread_p, rcvindex, &amp;addr, num_undo_crumbs, num_redo_crumbs, undo_crumbs, redo_crumbs);</div><div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;}</div><div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;</div><div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;<span class="preprocessor">#if defined (ENABLE_UNUSED_FUNCTION)</span></div><div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;<span class="comment"> * log_append_undo_recdes - LOG UNDO (BEFORE) RECORD DESCRIPTOR</span></div><div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;<span class="comment"> * return: nothing</span></div><div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;<span class="comment"> *   rcvindex(in): Index to recovery function</span></div><div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;<span class="comment"> *   addr(in): Address (Volume, page, and offset) of data</span></div><div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;<span class="comment"> *   recdes(in): Undo(before) record descriptor</span></div><div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;log_append_undo_recdes (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2b">LOG_RCVINDEX</a> rcvindex, <a class="code" href="structlog__data__addr.html">LOG_DATA_ADDR</a> * addr, <span class="keyword">const</span> <a class="code" href="structrecdes.html">RECDES</a> * <a class="code" href="structrecdes.html">recdes</a>)</div><div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;{</div><div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;  <a class="code" href="log__manager_8c.html#a699da5ea92f9390e4ae6169d7b2ac73a">log_append_undo_recdes2</a> (thread_p, rcvindex, addr-&gt;<a class="code" href="structlog__data__addr.html#a23830dd623509faa8744024abec22ca8">vfid</a>, addr-&gt;<a class="code" href="structlog__data__addr.html#a3c632dae3ad660a8572d9298716d9522">pgptr</a>, addr-&gt;<a class="code" href="structlog__data__addr.html#ab8ee0b45ab1d94bffa3626936b282d5f">offset</a>, <a class="code" href="structrecdes.html">recdes</a>);</div><div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;}</div><div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* ENABLE_UNUSED_FUNCTION */</span><span class="preprocessor"></span></div><div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;</div><div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l02557"></a><span class="lineno"><a class="line" href="log__manager_8h.html#a699da5ea92f9390e4ae6169d7b2ac73a"> 2557</a></span>&#160;<a class="code" href="log__manager_8c.html#a699da5ea92f9390e4ae6169d7b2ac73a">log_append_undo_recdes2</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2b">LOG_RCVINDEX</a> rcvindex, <span class="keyword">const</span> <a class="code" href="structvfid.html">VFID</a> * <a class="code" href="structvfid.html">vfid</a>, <a class="code" href="storage__common_8h.html#ae4a052db40daa4a44a890bad45d8ecdc">PAGE_PTR</a> pgptr,</div><div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;             <a class="code" href="storage__common_8h.html#ac3f9d7ae37c5a4cb27570f7313891bc8">PGLENGTH</a> <a class="code" href="expat_8h.html#ad0c30ee1add42468a6d7c022f2efdf70">offset</a>, <span class="keyword">const</span> <a class="code" href="structrecdes.html">RECDES</a> * <a class="code" href="structrecdes.html">recdes</a>)</div><div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;{</div><div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;  <a class="code" href="structlog__crumb.html">LOG_CRUMB</a> crumbs[2];</div><div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;  <a class="code" href="structlog__data__addr.html">LOG_DATA_ADDR</a> addr;</div><div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;</div><div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;  addr.<a class="code" href="structlog__data__addr.html#a23830dd623509faa8744024abec22ca8">vfid</a> = <a class="code" href="structvfid.html">vfid</a>;</div><div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;  addr.<a class="code" href="structlog__data__addr.html#a3c632dae3ad660a8572d9298716d9522">pgptr</a> = pgptr;</div><div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;  addr.<a class="code" href="structlog__data__addr.html#ab8ee0b45ab1d94bffa3626936b282d5f">offset</a> = <a class="code" href="expat_8h.html#ad0c30ee1add42468a6d7c022f2efdf70">offset</a>;</div><div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;</div><div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="structrecdes.html">recdes</a> != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;    {</div><div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;      crumbs[0].<a class="code" href="structlog__crumb.html#a27fa2f547d67332b369d31002bd7ea75">length</a> = <span class="keyword">sizeof</span> (<a class="code" href="structrecdes.html">recdes</a>-&gt;<a class="code" href="structrecdes.html#a67343783639754b873ee300e3c742bc4">type</a>);</div><div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;      crumbs[0].<a class="code" href="structlog__crumb.html#a01a9e2039ac048536a6c4aaefaa78896">data</a> = (<span class="keywordtype">char</span> *) &amp;<a class="code" href="structrecdes.html">recdes</a>-&gt;<a class="code" href="structrecdes.html#a67343783639754b873ee300e3c742bc4">type</a>;</div><div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;      crumbs[1].<a class="code" href="structlog__crumb.html#a27fa2f547d67332b369d31002bd7ea75">length</a> = <a class="code" href="structrecdes.html">recdes</a>-&gt;<a class="code" href="structrecdes.html#ad79507ad26c0f557815cb78ce391be8b">length</a>;</div><div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;      crumbs[1].<a class="code" href="structlog__crumb.html#a01a9e2039ac048536a6c4aaefaa78896">data</a> = <a class="code" href="structrecdes.html">recdes</a>-&gt;<a class="code" href="structrecdes.html#a78fb3ee3142e50670d431d8f7c302b62">data</a>;</div><div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;      <a class="code" href="log__manager_8c.html#a9ba19c0baec377fbab0da02a75c7260d">log_append_undo_crumbs</a> (thread_p, rcvindex, &amp;addr, 2, crumbs);</div><div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;    }</div><div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;    {</div><div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;      <a class="code" href="log__manager_8c.html#a9ba19c0baec377fbab0da02a75c7260d">log_append_undo_crumbs</a> (thread_p, rcvindex, &amp;addr, 0, <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;    }</div><div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;}</div><div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;</div><div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;<span class="comment"> * log_append_redo_recdes - LOG REDO (AFTER) RECORD DESCRIPTOR</span></div><div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;<span class="comment"> * return: nothing</span></div><div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;<span class="comment"> *   rcvindex(in): Index to recovery function</span></div><div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;<span class="comment"> *   addr(in): Address (Volume, page, and offset) of data</span></div><div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;<span class="comment"> *   recdes(in): Redo(after) record descriptor</span></div><div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l02592"></a><span class="lineno"><a class="line" href="log__manager_8h.html#ad746664fdeb839dc9faf0d92e0623c3d"> 2592</a></span>&#160;<a class="code" href="log__manager_8c.html#ad746664fdeb839dc9faf0d92e0623c3d">log_append_redo_recdes</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2b">LOG_RCVINDEX</a> rcvindex, <a class="code" href="structlog__data__addr.html">LOG_DATA_ADDR</a> * addr, <span class="keyword">const</span> <a class="code" href="structrecdes.html">RECDES</a> * <a class="code" href="structrecdes.html">recdes</a>)</div><div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;{</div><div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;  <a class="code" href="log__manager_8c.html#ada4567801f3c4fec0f0dcd8096408fd8">log_append_redo_recdes2</a> (thread_p, rcvindex, addr-&gt;<a class="code" href="structlog__data__addr.html#a23830dd623509faa8744024abec22ca8">vfid</a>, addr-&gt;<a class="code" href="structlog__data__addr.html#a3c632dae3ad660a8572d9298716d9522">pgptr</a>, addr-&gt;<a class="code" href="structlog__data__addr.html#ab8ee0b45ab1d94bffa3626936b282d5f">offset</a>, <a class="code" href="structrecdes.html">recdes</a>);</div><div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;}</div><div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;</div><div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l02598"></a><span class="lineno"><a class="line" href="log__manager_8h.html#ada4567801f3c4fec0f0dcd8096408fd8"> 2598</a></span>&#160;<a class="code" href="log__manager_8c.html#ada4567801f3c4fec0f0dcd8096408fd8">log_append_redo_recdes2</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2b">LOG_RCVINDEX</a> rcvindex, <span class="keyword">const</span> <a class="code" href="structvfid.html">VFID</a> * <a class="code" href="structvfid.html">vfid</a>, <a class="code" href="storage__common_8h.html#ae4a052db40daa4a44a890bad45d8ecdc">PAGE_PTR</a> pgptr,</div><div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;             <a class="code" href="storage__common_8h.html#ac3f9d7ae37c5a4cb27570f7313891bc8">PGLENGTH</a> <a class="code" href="expat_8h.html#ad0c30ee1add42468a6d7c022f2efdf70">offset</a>, <span class="keyword">const</span> <a class="code" href="structrecdes.html">RECDES</a> * <a class="code" href="structrecdes.html">recdes</a>)</div><div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;{</div><div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;  <a class="code" href="structlog__crumb.html">LOG_CRUMB</a> crumbs[2];</div><div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;  <a class="code" href="structlog__data__addr.html">LOG_DATA_ADDR</a> addr;</div><div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;</div><div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;  addr.<a class="code" href="structlog__data__addr.html#a23830dd623509faa8744024abec22ca8">vfid</a> = <a class="code" href="structvfid.html">vfid</a>;</div><div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;  addr.<a class="code" href="structlog__data__addr.html#a3c632dae3ad660a8572d9298716d9522">pgptr</a> = pgptr;</div><div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;  addr.<a class="code" href="structlog__data__addr.html#ab8ee0b45ab1d94bffa3626936b282d5f">offset</a> = <a class="code" href="expat_8h.html#ad0c30ee1add42468a6d7c022f2efdf70">offset</a>;</div><div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;</div><div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="structrecdes.html">recdes</a> != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;    {</div><div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;      crumbs[0].<a class="code" href="structlog__crumb.html#a27fa2f547d67332b369d31002bd7ea75">length</a> = <span class="keyword">sizeof</span> (<a class="code" href="structrecdes.html">recdes</a>-&gt;<a class="code" href="structrecdes.html#a67343783639754b873ee300e3c742bc4">type</a>);</div><div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;      crumbs[0].<a class="code" href="structlog__crumb.html#a01a9e2039ac048536a6c4aaefaa78896">data</a> = (<span class="keywordtype">char</span> *) &amp;<a class="code" href="structrecdes.html">recdes</a>-&gt;<a class="code" href="structrecdes.html#a67343783639754b873ee300e3c742bc4">type</a>;</div><div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;      crumbs[1].<a class="code" href="structlog__crumb.html#a27fa2f547d67332b369d31002bd7ea75">length</a> = <a class="code" href="structrecdes.html">recdes</a>-&gt;<a class="code" href="structrecdes.html#ad79507ad26c0f557815cb78ce391be8b">length</a>;</div><div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;      crumbs[1].<a class="code" href="structlog__crumb.html#a01a9e2039ac048536a6c4aaefaa78896">data</a> = <a class="code" href="structrecdes.html">recdes</a>-&gt;<a class="code" href="structrecdes.html#a78fb3ee3142e50670d431d8f7c302b62">data</a>;</div><div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;      <a class="code" href="log__manager_8c.html#ad39dc10a11df5427f5af4c203e9d98a6">log_append_redo_crumbs</a> (thread_p, rcvindex, &amp;addr, 2, crumbs);</div><div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;    }</div><div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;    {</div><div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;      <a class="code" href="log__manager_8c.html#ad39dc10a11df5427f5af4c203e9d98a6">log_append_redo_crumbs</a> (thread_p, rcvindex, &amp;addr, 0, <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;    }</div><div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;}</div><div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;</div><div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;<span class="comment"> * log_append_dboutside_redo - Log redo (after) data for operations outside the db</span></div><div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;<span class="comment"> * return: nothing</span></div><div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;<span class="comment"> *   rcvindex(in): Index to recovery function</span></div><div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;<span class="comment"> *   length(in): Length of redo(after) data</span></div><div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;<span class="comment"> *   data(in): Redo (after) data</span></div><div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;<span class="comment"> * NOTE: A log record is constructed to recover external (outside of</span></div><div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;<span class="comment"> *              database) data by always redoing data during recovery.</span></div><div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;<span class="comment"> *              During recovery(e.g., system crash recovery), the redo</span></div><div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;<span class="comment"> *              function described by rcvindex is called with a recovery</span></div><div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;<span class="comment"> *              structure which contains the page pointer and offset of the</span></div><div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;<span class="comment"> *              data to recover along with the redo data. It is up to this</span></div><div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;<span class="comment"> *              function to determine how to redo the data.</span></div><div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;<span class="comment"> *     1)       The logging of this function is logical since it is for</span></div><div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;<span class="comment"> *              external data.</span></div><div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;<span class="comment"> *     2)       Both during the redo and undo phase, dboutside redo is</span></div><div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;<span class="comment"> *              ignored.</span></div><div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l02646"></a><span class="lineno"><a class="line" href="log__manager_8h.html#a4f05d5c0a4f3f3106fe28a2d45424683"> 2646</a></span>&#160;<a class="code" href="log__manager_8c.html#a4f05d5c0a4f3f3106fe28a2d45424683">log_append_dboutside_redo</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2b">LOG_RCVINDEX</a> rcvindex, <span class="keywordtype">int</span> length, <span class="keyword">const</span> <span class="keywordtype">void</span> *<a class="code" href="namespacestatdump__to__csv.html#aedcb70fde9c0b07a0732db70deeec616">data</a>)</div><div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;{</div><div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;  <a class="code" href="structlog__tdes.html">LOG_TDES</a> *tdes;       <span class="comment">/* Transaction descriptor */</span></div><div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;  <span class="keywordtype">int</span> tran_index;</div><div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;  <span class="keywordtype">int</span> error_code = <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>;</div><div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;  <a class="code" href="structlog__prior__node.html">LOG_PRIOR_NODE</a> *<a class="code" href="external_2include_2queue_8h.html#a465e28dbd1a1c60ff504d3ea275613ed">node</a>;</div><div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;</div><div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;<span class="preprocessor">#if defined(CUBRID_DEBUG)</span></div><div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="recovery_8c.html#ad2eee9d1e5914fa34d3a7868bf2549f4">RV_fun</a>[rcvindex].redofun == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;    {</div><div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;      <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (<span class="keyword">false</span>);</div><div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;    }</div><div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* CUBRID_DEBUG */</span><span class="preprocessor"></span></div><div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;</div><div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;  <span class="keywordflow">if</span> (log_No_logging)</div><div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;    {</div><div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;      <span class="comment">/* We are not logging */</span></div><div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;      <a class="code" href="log__manager_8c.html#a62a934c871b6ec0f1feeecaea8cfc4dd">LOG_FLUSH_LOGGING_HAS_BEEN_SKIPPED</a> (thread_p);</div><div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;    }</div><div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;</div><div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;  <span class="comment">/* Vacuum workers are not allowed to use this type of log records. */</span></div><div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;  <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (!<a class="code" href="vacuum_8h.html#addf44811efa9c66ec7896f7dc2dc20eb">VACUUM_IS_THREAD_VACUUM_WORKER</a> (thread_p));</div><div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;</div><div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;  <span class="comment">/* Find transaction descriptor for current logging transaction */</span></div><div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;  tran_index = <a class="code" href="perf__monitor_8h.html#a55d27b01d605ba6ee2929ddfe8588320">LOG_FIND_THREAD_TRAN_INDEX</a> (thread_p);</div><div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;  tdes = <a class="code" href="log__impl_8h.html#a08fee41cfcf592e8afdbc4988ffbc8e4">LOG_FIND_TDES</a> (tran_index);</div><div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;  <span class="keywordflow">if</span> (tdes == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;    {</div><div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;      <a class="code" href="error__manager_8c.html#afdaf87ce30f2f557802a185ab85b6599">er_set</a> (<a class="code" href="error__manager_8h.html#a5d0d456c474e11fc70779873a30a7432a3314630dd19f90a68274cf737092c9f2">ER_FATAL_ERROR_SEVERITY</a>, <a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <a class="code" href="error__code_8h.html#a4b8e41e78be77c579a2c58f5248fefe2">ER_LOG_UNKNOWN_TRANINDEX</a>, 1, tran_index);</div><div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;      error_code = <a class="code" href="error__code_8h.html#a4b8e41e78be77c579a2c58f5248fefe2">ER_LOG_UNKNOWN_TRANINDEX</a>;</div><div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;    }</div><div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;</div><div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;  <span class="comment">/* </span></div><div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;<span class="comment">   * If we are not in a top system operation, the transaction is unactive, and</span></div><div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;<span class="comment">   * the transaction is not in the process of been aborted, we do nothing.</span></div><div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;  <span class="keywordflow">if</span> (tdes-&gt;<a class="code" href="structlog__tdes.html#a97c1d42917ab4d08ffe3194fc7233018">topops</a>.<a class="code" href="structlog__topops__stack.html#a5e509dcc15d89abc0c6ba486af6dba4d">last</a> &lt; 0 &amp;&amp; !<a class="code" href="log__impl_8h.html#aa81dc352329c9f96467c795c1547be74">LOG_ISTRAN_ACTIVE</a> (tdes) &amp;&amp; !<a class="code" href="log__impl_8h.html#ab0e135eabcb7c4a5d08244226f68f0ba">LOG_ISTRAN_ABORTED</a> (tdes))</div><div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;    {</div><div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;      <span class="comment">/* </span></div><div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;<span class="comment">       * We do not log anything when the transaction is unactive and it is not</span></div><div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;<span class="comment">       * in the process of aborting.</span></div><div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;    }</div><div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;</div><div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;  <a class="code" href="structnodeptr.html">node</a> =</div><div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;    <a class="code" href="log__impl_8h.html#a2b616997f446dcb588a6addcc65cf5b7">prior_lsa_alloc_and_copy_data</a> (thread_p, <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a7557d9dfb53f14fd3b6eef04a165476b">LOG_DBEXTERN_REDO_DATA</a>, rcvindex, <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, length, (<span class="keywordtype">char</span> *) <a class="code" href="namespacestatdump__to__csv.html#aedcb70fde9c0b07a0732db70deeec616">data</a>);</div><div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="structnodeptr.html">node</a> == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;    {</div><div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;    }</div><div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;</div><div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;  (void) <a class="code" href="log__impl_8h.html#a8a3ce7b7aa59fe26c04eca3577e434e8">prior_lsa_next_record</a> (thread_p, <a class="code" href="structnodeptr.html">node</a>, tdes);</div><div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;}</div><div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;</div><div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;<span class="comment"> * log_append_postpone - Log postpone after data, for redo</span></div><div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;<span class="comment"> * return: nothing</span></div><div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;<span class="comment"> *   rcvindex(in): Index to recovery function</span></div><div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;<span class="comment"> *   addr(in): Index to recovery function</span></div><div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;<span class="comment"> *   length(in): Length of postpone redo(after) data</span></div><div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;<span class="comment"> *   data(in): Postpone redo (after) data</span></div><div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;<span class="comment"> * NOTE: A postpone data operation is postponed after the transaction</span></div><div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;<span class="comment"> *              commits. Once it is executed, it becomes a log_redo operation.</span></div><div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;<span class="comment"> *              This distinction is needed due to log sequence number in the</span></div><div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;<span class="comment"> *              log and the data pages which are used to avoid redos.</span></div><div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l02720"></a><span class="lineno"><a class="line" href="log__manager_8h.html#a853fd7ef5f6abc4a182d6e79f0a4846f"> 2720</a></span>&#160;<a class="code" href="log__manager_8c.html#a853fd7ef5f6abc4a182d6e79f0a4846f">log_append_postpone</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2b">LOG_RCVINDEX</a> rcvindex, <a class="code" href="structlog__data__addr.html">LOG_DATA_ADDR</a> * addr, <span class="keywordtype">int</span> length, <span class="keyword">const</span> <span class="keywordtype">void</span> *<a class="code" href="namespacestatdump__to__csv.html#aedcb70fde9c0b07a0732db70deeec616">data</a>)</div><div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;{</div><div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;  <a class="code" href="structlog__tdes.html">LOG_TDES</a> *tdes;       <span class="comment">/* Transaction descriptor */</span></div><div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;  <a class="code" href="structlog__rcv.html">LOG_RCV</a> rcv;          <span class="comment">/* Recovery structure for execution */</span></div><div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;  <span class="keywordtype">bool</span> skipredo;</div><div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;  <a class="code" href="structlog__lsa.html">LOG_LSA</a> *crash_lsa;</div><div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;  <span class="keywordtype">int</span> tran_index;</div><div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;  <span class="keywordtype">int</span> error_code = <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>;</div><div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;  <a class="code" href="structlog__prior__node.html">LOG_PRIOR_NODE</a> *<a class="code" href="external_2include_2queue_8h.html#a465e28dbd1a1c60ff504d3ea275613ed">node</a>;</div><div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;  <a class="code" href="structlog__lsa.html">LOG_LSA</a> start_lsa = <a class="code" href="storage__common_8h.html#a9a90f006879719246747fb497b16a663">LSA_INITIALIZER</a>;</div><div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;</div><div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;<span class="preprocessor">#if defined(CUBRID_DEBUG)</span></div><div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;  <span class="keywordflow">if</span> (addr-&gt;<a class="code" href="structlog__data__addr.html#a3c632dae3ad660a8572d9298716d9522">pgptr</a> == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;    {</div><div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;      <span class="comment">/* </span></div><div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;<span class="comment">       * Postpone is always an operation page level logging. Thus, a data page</span></div><div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;<span class="comment">       * pointer must have been given as part of the address</span></div><div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;      <a class="code" href="error__manager_8c.html#afdaf87ce30f2f557802a185ab85b6599">er_set</a> (<a class="code" href="error__manager_8h.html#a5d0d456c474e11fc70779873a30a7432a07ad8f9fda27124d297c94b7d3ea44e8">ER_ERROR_SEVERITY</a>, <a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <a class="code" href="error__code_8h.html#a525962e6b4784dd775c34b2a7fdffcc5">ER_LOG_POSTPONE_INTERFACE</a>, 0);</div><div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;      error_code = <a class="code" href="error__code_8h.html#a525962e6b4784dd775c34b2a7fdffcc5">ER_LOG_POSTPONE_INTERFACE</a>;</div><div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;    }</div><div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="recovery_8c.html#ad2eee9d1e5914fa34d3a7868bf2549f4">RV_fun</a>[rcvindex].redofun == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;    {</div><div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;      <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (<span class="keyword">false</span>);</div><div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;    }</div><div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* CUBRID_DEBUG */</span><span class="preprocessor"></span></div><div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;</div><div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;  <span class="keywordflow">if</span> (log_No_logging)</div><div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;    {</div><div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;      <span class="comment">/* </span></div><div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;<span class="comment">       * We are not logging. Execute the postpone operation immediately since</span></div><div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;<span class="comment">       * we cannot undo</span></div><div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;      rcv.<a class="code" href="structlog__rcv.html#aa86dfb9bbc9edce109df26aacf699915">length</a> = length;</div><div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;      rcv.<a class="code" href="structlog__rcv.html#a4acc4ed244fcaa09adea314ee4f7b861">offset</a> = addr-&gt;<a class="code" href="structlog__data__addr.html#ab8ee0b45ab1d94bffa3626936b282d5f">offset</a>;</div><div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;      rcv.<a class="code" href="structlog__rcv.html#a04db9f252907cff6ca339534e8c4f642">pgptr</a> = addr-&gt;<a class="code" href="structlog__data__addr.html#a3c632dae3ad660a8572d9298716d9522">pgptr</a>;</div><div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;      rcv.<a class="code" href="structlog__rcv.html#afc672de81dd88914d00281fada1acc13">data</a> = (<span class="keywordtype">char</span> *) <a class="code" href="namespacestatdump__to__csv.html#aedcb70fde9c0b07a0732db70deeec616">data</a>;</div><div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;</div><div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;      <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (<a class="code" href="recovery_8c.html#ad2eee9d1e5914fa34d3a7868bf2549f4">RV_fun</a>[rcvindex].redofun != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;      (void) (*<a class="code" href="recovery_8c.html#ad2eee9d1e5914fa34d3a7868bf2549f4">RV_fun</a>[rcvindex].redofun) (thread_p, &amp;rcv);</div><div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;</div><div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;      <a class="code" href="log__manager_8c.html#a62a934c871b6ec0f1feeecaea8cfc4dd">LOG_FLUSH_LOGGING_HAS_BEEN_SKIPPED</a> (thread_p);</div><div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;      <a class="code" href="log__manager_8c.html#af7bfbd98d66410cc6e3d1d050cec24ec">log_skip_logging</a> (thread_p, addr);</div><div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;    }</div><div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;</div><div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;  <span class="comment">/* Find transaction descriptor for current logging transaction */</span></div><div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;  tran_index = <a class="code" href="perf__monitor_8h.html#a55d27b01d605ba6ee2929ddfe8588320">LOG_FIND_THREAD_TRAN_INDEX</a> (thread_p);</div><div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;</div><div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="vacuum_8h.html#ab0e1deb8da1aa663aa073b0ce78606a2">VACUUM_IS_THREAD_VACUUM</a> (thread_p))</div><div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;    {</div><div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;      <span class="comment">/* Vacuum worker */</span></div><div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;      <span class="comment">/* Must be under a system operation, otherwise postpone records will not work. */</span></div><div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;      <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (<a class="code" href="vacuum_8h.html#a6a1dc228ca433bf85d100084b318153f">vacuum_worker_state_is_topop</a> (thread_p));</div><div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;      <span class="comment">/* Use reserved transaction descriptor instead of system tdes. */</span></div><div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;      tdes = <a class="code" href="vacuum_8h.html#a3bae574be1c3bf9a786050397a1cde68">vacuum_get_worker_tdes</a> (thread_p);</div><div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;    }</div><div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;    {</div><div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;      <span class="comment">/* Find tdes in transaction table. */</span></div><div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;      tdes = <a class="code" href="log__impl_8h.html#a08fee41cfcf592e8afdbc4988ffbc8e4">LOG_FIND_TDES</a> (tran_index);</div><div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;    }</div><div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;</div><div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;  <span class="keywordflow">if</span> (tdes == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;    {</div><div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;      <a class="code" href="error__manager_8c.html#afdaf87ce30f2f557802a185ab85b6599">er_set</a> (<a class="code" href="error__manager_8h.html#a5d0d456c474e11fc70779873a30a7432a3314630dd19f90a68274cf737092c9f2">ER_FATAL_ERROR_SEVERITY</a>, <a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <a class="code" href="error__code_8h.html#a4b8e41e78be77c579a2c58f5248fefe2">ER_LOG_UNKNOWN_TRANINDEX</a>, 1, tran_index);</div><div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;      error_code = <a class="code" href="error__code_8h.html#a4b8e41e78be77c579a2c58f5248fefe2">ER_LOG_UNKNOWN_TRANINDEX</a>;</div><div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;    }</div><div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;</div><div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;  skipredo = log_can_skip_redo_logging (rcvindex, tdes, addr);</div><div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;  <span class="keywordflow">if</span> (skipredo == <span class="keyword">true</span> || (tdes-&gt;<a class="code" href="structlog__tdes.html#a97c1d42917ab4d08ffe3194fc7233018">topops</a>.<a class="code" href="structlog__topops__stack.html#a5e509dcc15d89abc0c6ba486af6dba4d">last</a> &lt; 0 &amp;&amp; !<a class="code" href="log__impl_8h.html#aa81dc352329c9f96467c795c1547be74">LOG_ISTRAN_ACTIVE</a> (tdes) &amp;&amp; !<a class="code" href="log__impl_8h.html#ab0e135eabcb7c4a5d08244226f68f0ba">LOG_ISTRAN_ABORTED</a> (tdes)))</div><div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;    {</div><div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;      <span class="comment">/* </span></div><div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;<span class="comment">       * Warning postpone logging is ignored during REDO recovery, normal</span></div><div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;<span class="comment">       * rollbacks, and for temporary data pages</span></div><div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;      rcv.<a class="code" href="structlog__rcv.html#aa86dfb9bbc9edce109df26aacf699915">length</a> = length;</div><div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;      rcv.<a class="code" href="structlog__rcv.html#a4acc4ed244fcaa09adea314ee4f7b861">offset</a> = addr-&gt;<a class="code" href="structlog__data__addr.html#ab8ee0b45ab1d94bffa3626936b282d5f">offset</a>;</div><div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;      rcv.<a class="code" href="structlog__rcv.html#a04db9f252907cff6ca339534e8c4f642">pgptr</a> = addr-&gt;<a class="code" href="structlog__data__addr.html#a3c632dae3ad660a8572d9298716d9522">pgptr</a>;</div><div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;      rcv.<a class="code" href="structlog__rcv.html#afc672de81dd88914d00281fada1acc13">data</a> = (<span class="keywordtype">char</span> *) <a class="code" href="namespacestatdump__to__csv.html#aedcb70fde9c0b07a0732db70deeec616">data</a>;</div><div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;</div><div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;      <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (<a class="code" href="recovery_8c.html#ad2eee9d1e5914fa34d3a7868bf2549f4">RV_fun</a>[rcvindex].redofun != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;      (void) (*<a class="code" href="recovery_8c.html#ad2eee9d1e5914fa34d3a7868bf2549f4">RV_fun</a>[rcvindex].redofun) (thread_p, &amp;rcv);</div><div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;      <span class="keywordflow">if</span> (skipredo == <span class="keyword">false</span>)</div><div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;    {</div><div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;      <a class="code" href="log__manager_8c.html#a76afb51129a3be19c2520daa64bebf9e">log_append_redo_data</a> (thread_p, rcvindex, addr, length, <a class="code" href="namespacestatdump__to__csv.html#aedcb70fde9c0b07a0732db70deeec616">data</a>);</div><div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;    }</div><div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;</div><div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;    }</div><div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;</div><div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;  <span class="comment">/* </span></div><div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;<span class="comment">   * If the transaction has not logged any record, add a dummy record to</span></div><div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;<span class="comment">   * start the postpone purposes during the commit.</span></div><div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;</div><div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="storage__common_8h.html#a26dd766712df5b5c4fcd158f571a75e4">LSA_ISNULL</a> (&amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a5b128a08476a5b499cf82e3163e6d62b">tail_lsa</a>)</div><div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;      || (<a class="code" href="log__manager_8c.html#a2caab20af5b0e7a0a89abf77ffa8e404">log_is_in_crash_recovery</a> () &amp;&amp; (crash_lsa = <a class="code" href="log__manager_8c.html#a656b541276983a5b1306515c1c568ec7">log_get_crash_point_lsa</a> ()) != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;      &amp;&amp; <a class="code" href="storage__common_8h.html#a7f9d98414f81d41e639e744027e15947">LSA_LE</a> (&amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a5b128a08476a5b499cf82e3163e6d62b">tail_lsa</a>, crash_lsa)))</div><div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;    {</div><div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;      <a class="code" href="log__manager_8c.html#a1315d00aaa26d2a280a675338f59c9ac">log_append_empty_record</a> (thread_p, <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7ab9a91cb4efa2ad495c98d7dc7fef8ee1">LOG_DUMMY_HEAD_POSTPONE</a>, addr);</div><div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;    }</div><div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;</div><div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;  <a class="code" href="structnodeptr.html">node</a> = <a class="code" href="log__impl_8h.html#a2b616997f446dcb588a6addcc65cf5b7">prior_lsa_alloc_and_copy_data</a> (thread_p, <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7acf273d42fe8e9c360fb16c8c0f96c480">LOG_POSTPONE</a>, rcvindex, addr, 0, <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, length, (<span class="keywordtype">char</span> *) <a class="code" href="namespacestatdump__to__csv.html#aedcb70fde9c0b07a0732db70deeec616">data</a>);</div><div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="structnodeptr.html">node</a> == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;    {</div><div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;    }</div><div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="vacuum_8h.html#ab0e1deb8da1aa663aa073b0ce78606a2">VACUUM_IS_THREAD_VACUUM</a> (thread_p))</div><div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;    {</div><div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;      <span class="comment">/* Cache postpone log record. Redo data must be saved before calling prior_lsa_next_record, which may free this</span></div><div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;<span class="comment">       * prior node. */</span></div><div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;      <a class="code" href="vacuum_8c.html#a28d7f980eeb489f0a736fa1c8cc61546">vacuum_cache_log_postpone_redo_data</a> (thread_p, <a class="code" href="structnodeptr.html">node</a>-&gt;data_header, <a class="code" href="structnodeptr.html">node</a>-&gt;rdata, <a class="code" href="structnodeptr.html">node</a>-&gt;rlength);</div><div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;    }</div><div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;</div><div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;  start_lsa = <a class="code" href="log__impl_8h.html#a8a3ce7b7aa59fe26c04eca3577e434e8">prior_lsa_next_record</a> (thread_p, <a class="code" href="structnodeptr.html">node</a>, tdes);</div><div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="vacuum_8h.html#ab0e1deb8da1aa663aa073b0ce78606a2">VACUUM_IS_THREAD_VACUUM</a> (thread_p))</div><div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;    {</div><div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;      <span class="comment">/* Cache postpone log record. An entry for this postpone log record was already created and we also need to save</span></div><div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;<span class="comment">       * its LSA. */</span></div><div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;      <a class="code" href="vacuum_8c.html#a91948a8e1d29a833fa70822b8e64ccdf">vacuum_cache_log_postpone_lsa</a> (thread_p, &amp;start_lsa);</div><div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;    }</div><div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;</div><div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;  <span class="comment">/* Set address early in case there is a crash, because of skip_head */</span></div><div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;  <span class="keywordflow">if</span> (tdes-&gt;<a class="code" href="structlog__tdes.html#a97c1d42917ab4d08ffe3194fc7233018">topops</a>.<a class="code" href="structlog__topops__stack.html#a5e509dcc15d89abc0c6ba486af6dba4d">last</a> &gt;= 0)</div><div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;    {</div><div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="storage__common_8h.html#a26dd766712df5b5c4fcd158f571a75e4">LSA_ISNULL</a> (&amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a97c1d42917ab4d08ffe3194fc7233018">topops</a>.<a class="code" href="structlog__topops__stack.html#aeeae85de5bdc4f49b8ba730b25ab092b">stack</a>[tdes-&gt;<a class="code" href="structlog__tdes.html#a97c1d42917ab4d08ffe3194fc7233018">topops</a>.<a class="code" href="structlog__topops__stack.html#a5e509dcc15d89abc0c6ba486af6dba4d">last</a>].<a class="code" href="structlog__topops__addresses.html#a94da18d9054fe91a3b114b4262301737">posp_lsa</a>))</div><div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;    {</div><div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;      <a class="code" href="storage__common_8h.html#a4c9bc15296fe6728cf0351726cc6ad09">LSA_COPY</a> (&amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a97c1d42917ab4d08ffe3194fc7233018">topops</a>.<a class="code" href="structlog__topops__stack.html#aeeae85de5bdc4f49b8ba730b25ab092b">stack</a>[tdes-&gt;<a class="code" href="structlog__tdes.html#a97c1d42917ab4d08ffe3194fc7233018">topops</a>.<a class="code" href="structlog__topops__stack.html#a5e509dcc15d89abc0c6ba486af6dba4d">last</a>].<a class="code" href="structlog__topops__addresses.html#a94da18d9054fe91a3b114b4262301737">posp_lsa</a>, &amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a5b128a08476a5b499cf82e3163e6d62b">tail_lsa</a>);</div><div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;    }</div><div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;    }</div><div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="storage__common_8h.html#a26dd766712df5b5c4fcd158f571a75e4">LSA_ISNULL</a> (&amp;tdes-&gt;<a class="code" href="structlog__tdes.html#aef11834afdfbe3e8bd7f530ec269b327">posp_nxlsa</a>))</div><div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;    {</div><div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;      <a class="code" href="storage__common_8h.html#a4c9bc15296fe6728cf0351726cc6ad09">LSA_COPY</a> (&amp;tdes-&gt;<a class="code" href="structlog__tdes.html#aef11834afdfbe3e8bd7f530ec269b327">posp_nxlsa</a>, &amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a5b128a08476a5b499cf82e3163e6d62b">tail_lsa</a>);</div><div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;    }</div><div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;</div><div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;  <span class="comment">/* </span></div><div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;<span class="comment">   * Note: The lsa of the page is not set for postpone log records since</span></div><div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;<span class="comment">   * the change has not been done (has been postpone) to the page.</span></div><div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;}</div><div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;</div><div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;<span class="comment"> * log_run_postpone - Log run redo (after) postpone data</span></div><div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;<span class="comment"> * return: nothing</span></div><div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;<span class="comment"> *   rcvindex(in): Index to recovery function</span></div><div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;<span class="comment"> *   addr(in): Address (Volume, page, and offset) of data</span></div><div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;<span class="comment"> *   rcv_vpid(in):</span></div><div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;<span class="comment"> *   length(in): Length of redo(after) data</span></div><div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;<span class="comment"> *   data(in): Redo (after) data</span></div><div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;<span class="comment"> *   ref_lsa(in): Log sequence address of original postpone record</span></div><div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;<span class="comment"> * NOTE: Log run_redo(after) postpone data. This function is only used</span></div><div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;<span class="comment"> *              when the transaction has been declared as a committed with</span></div><div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;<span class="comment"> *              postpone actions. A system log record is constructed to</span></div><div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;<span class="comment"> *              recover data by redoing data during recovery.</span></div><div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;<span class="comment"> *              During recovery(e.g., system crash recovery), the redo</span></div><div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;<span class="comment"> *              function described by rcvindex is called with a recovery</span></div><div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;<span class="comment"> *              structure which contains the page pointer and offset of the</span></div><div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;<span class="comment"> *              data to recover along with the redo data. It is up to this</span></div><div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;<span class="comment"> *              function how to redo the data.</span></div><div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;<span class="comment"> *     1)       The only type of logging accepted by this function is page</span></div><div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;<span class="comment"> *              operation level logging, thus, an address must be given.</span></div><div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l02892"></a><span class="lineno"><a class="line" href="log__manager_8h.html#ab82d5be060189c3aa56e57399a458e3a"> 2892</a></span>&#160;<a class="code" href="log__manager_8c.html#ab82d5be060189c3aa56e57399a458e3a">log_append_run_postpone</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2b">LOG_RCVINDEX</a> rcvindex, <a class="code" href="structlog__data__addr.html">LOG_DATA_ADDR</a> * addr, <span class="keyword">const</span> <a class="code" href="structvpid.html">VPID</a> * rcv_vpid,</div><div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;             <span class="keywordtype">int</span> length, <span class="keyword">const</span> <span class="keywordtype">void</span> *<a class="code" href="namespacestatdump__to__csv.html#aedcb70fde9c0b07a0732db70deeec616">data</a>, <span class="keyword">const</span> <a class="code" href="structlog__lsa.html">LOG_LSA</a> * ref_lsa)</div><div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;{</div><div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;  <a class="code" href="structlog__rec__run__postpone.html">LOG_REC_RUN_POSTPONE</a> *run_posp;   <span class="comment">/* A run postpone record */</span></div><div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;  <a class="code" href="structlog__tdes.html">LOG_TDES</a> *tdes;       <span class="comment">/* Transaction descriptor */</span></div><div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;  <span class="keywordtype">int</span> tran_index;</div><div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;  <span class="keywordtype">int</span> error_code = <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>;</div><div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;  <a class="code" href="structlog__prior__node.html">LOG_PRIOR_NODE</a> *<a class="code" href="external_2include_2queue_8h.html#a465e28dbd1a1c60ff504d3ea275613ed">node</a>;</div><div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;  <a class="code" href="structlog__lsa.html">LOG_LSA</a> start_lsa;</div><div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;</div><div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;  <span class="comment">/* Find transaction descriptor for current logging transaction */</span></div><div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;  tran_index = <a class="code" href="perf__monitor_8h.html#a55d27b01d605ba6ee2929ddfe8588320">LOG_FIND_THREAD_TRAN_INDEX</a> (thread_p);</div><div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="vacuum_8h.html#ab0e1deb8da1aa663aa073b0ce78606a2">VACUUM_IS_THREAD_VACUUM</a> (thread_p))</div><div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;    {</div><div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;      <span class="comment">/* Vacuum worker */</span></div><div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;      <span class="comment">/* Must be at the end of a system operation or during recovery. */</span></div><div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;      <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (<a class="code" href="vacuum_8h.html#a6a1dc228ca433bf85d100084b318153f">vacuum_worker_state_is_topop</a> (thread_p) || <a class="code" href="vacuum_8h.html#ac8a084d067e28ed6cf7989a1597af721">vacuum_worker_state_is_recovery</a> (thread_p));</div><div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;      <span class="comment">/* Use reserved transaction descriptor instead of system tdes. */</span></div><div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;      tdes = <a class="code" href="vacuum_8h.html#a3bae574be1c3bf9a786050397a1cde68">vacuum_get_worker_tdes</a> (thread_p);</div><div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;    }</div><div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;    {</div><div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;      <span class="comment">/* Find tdes in transaction table. */</span></div><div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;      tdes = <a class="code" href="log__impl_8h.html#a08fee41cfcf592e8afdbc4988ffbc8e4">LOG_FIND_TDES</a> (tran_index);</div><div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160;    }</div><div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;  <span class="keywordflow">if</span> (tdes == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;    {</div><div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;      <a class="code" href="error__manager_8c.html#afdaf87ce30f2f557802a185ab85b6599">er_set</a> (<a class="code" href="error__manager_8h.html#a5d0d456c474e11fc70779873a30a7432a3314630dd19f90a68274cf737092c9f2">ER_FATAL_ERROR_SEVERITY</a>, <a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <a class="code" href="error__code_8h.html#a4b8e41e78be77c579a2c58f5248fefe2">ER_LOG_UNKNOWN_TRANINDEX</a>, 1, tran_index);</div><div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;      error_code = <a class="code" href="error__code_8h.html#a4b8e41e78be77c579a2c58f5248fefe2">ER_LOG_UNKNOWN_TRANINDEX</a>;</div><div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;    }</div><div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;</div><div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;  <span class="keywordflow">if</span> (tdes-&gt;<a class="code" href="structlog__tdes.html#ad924146690490b840ef5c3f65c3a5a6c">state</a> != <a class="code" href="log__comm_8h.html#a3c0be9b9f104459ab90ee18af95c4b3ea10373ab725a87c9ac3126b85a1400846">TRAN_UNACTIVE_WILL_COMMIT</a> &amp;&amp; tdes-&gt;<a class="code" href="structlog__tdes.html#ad924146690490b840ef5c3f65c3a5a6c">state</a> != <a class="code" href="log__comm_8h.html#a3c0be9b9f104459ab90ee18af95c4b3eaef0e7c96ca3684ce2422a33afe8f35fc">TRAN_UNACTIVE_COMMITTED_WITH_POSTPONE</a></div><div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;      &amp;&amp; tdes-&gt;<a class="code" href="structlog__tdes.html#ad924146690490b840ef5c3f65c3a5a6c">state</a> != <a class="code" href="log__comm_8h.html#a3c0be9b9f104459ab90ee18af95c4b3ea04e4c5688a6020948963e1e0fffe9c15">TRAN_UNACTIVE_TOPOPE_COMMITTED_WITH_POSTPONE</a>)</div><div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;    {</div><div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;      <span class="comment">/* Warning run postpone is ignored when transaction is not committed */</span></div><div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;<span class="preprocessor">#if defined(CUBRID_DEBUG)</span></div><div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;      <a class="code" href="error__manager_8h.html#a075eb8873354909bbe8edafa0f18f58c">er_log_debug</a> (<a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>,</div><div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;            <span class="stringliteral">&quot;log_run_postpone: Warning run postpone logging is ignored when transaction is not committed\n&quot;</span>);</div><div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* CUBRID_DEBUG */</span><span class="preprocessor"></span></div><div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;      <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (<span class="keyword">false</span>);</div><div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160;    }</div><div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;    {</div><div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;      <a class="code" href="structnodeptr.html">node</a> =</div><div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;    <a class="code" href="log__impl_8h.html#a2b616997f446dcb588a6addcc65cf5b7">prior_lsa_alloc_and_copy_data</a> (thread_p, <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a59ac89fe85edd8011e84db21095290a7">LOG_RUN_POSTPONE</a>, <a class="code" href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2ba6ea83d694355ec2c529960461a086f26">RV_NOT_DEFINED</a>, <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, length, (<span class="keywordtype">char</span> *) <a class="code" href="namespacestatdump__to__csv.html#aedcb70fde9c0b07a0732db70deeec616">data</a>, 0,</div><div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;                       <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="structnodeptr.html">node</a> == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;    {</div><div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;    }</div><div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;</div><div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;      run_posp = (<a class="code" href="structlog__rec__run__postpone.html">LOG_REC_RUN_POSTPONE</a> *) <a class="code" href="structnodeptr.html">node</a>-&gt;data_header;</div><div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;      run_posp-&gt;<a class="code" href="structlog__rec__run__postpone.html#a239cb60ac50b699715ef2dc143ba25e5">data</a>.<a class="code" href="structlog__data.html#ab1a17fceea659d32f5187b81a7b80412">rcvindex</a> = rcvindex;</div><div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;      run_posp-&gt;<a class="code" href="structlog__rec__run__postpone.html#a239cb60ac50b699715ef2dc143ba25e5">data</a>.<a class="code" href="structlog__data.html#a8410b9d70cc70d2bc6fb6df88ea48bb4">pageid</a> = rcv_vpid-&gt;<a class="code" href="structvpid.html#a5863283d85ba76aaec01bf80c89a9d36">pageid</a>;</div><div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;      run_posp-&gt;<a class="code" href="structlog__rec__run__postpone.html#a239cb60ac50b699715ef2dc143ba25e5">data</a>.<a class="code" href="structlog__data.html#ad5635159b85ee07322bf30e39a5dee76">volid</a> = rcv_vpid-&gt;<a class="code" href="structvpid.html#a54e222d402e758d24ae0df524a9e677d">volid</a>;</div><div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;      run_posp-&gt;<a class="code" href="structlog__rec__run__postpone.html#a239cb60ac50b699715ef2dc143ba25e5">data</a>.<a class="code" href="structlog__data.html#afd25836b0952561036b01b5a50c310b2">offset</a> = addr-&gt;<a class="code" href="structlog__data__addr.html#ab8ee0b45ab1d94bffa3626936b282d5f">offset</a>;</div><div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;      <a class="code" href="storage__common_8h.html#a4c9bc15296fe6728cf0351726cc6ad09">LSA_COPY</a> (&amp;run_posp-&gt;<a class="code" href="structlog__rec__run__postpone.html#adee9338343c1891a51bb05e32dc6d120">ref_lsa</a>, ref_lsa);</div><div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;      run_posp-&gt;<a class="code" href="structlog__rec__run__postpone.html#af54dfa4bc67af1f75ddbda8c6f070e74">length</a> = length;</div><div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;</div><div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;      start_lsa = <a class="code" href="log__impl_8h.html#a8a3ce7b7aa59fe26c04eca3577e434e8">prior_lsa_next_record</a> (thread_p, <a class="code" href="structnodeptr.html">node</a>, tdes);</div><div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;</div><div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;      <span class="comment">/* </span></div><div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;<span class="comment">       * Set the LSA on the data page of the corresponding log record for page operation logging.</span></div><div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;<span class="comment">       * Make sure that I should log. Page operational logging is not done for temporary data of temporary files/volumes</span></div><div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;      <span class="keywordflow">if</span> (addr-&gt;<a class="code" href="structlog__data__addr.html#a3c632dae3ad660a8572d9298716d9522">pgptr</a> != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> &amp;&amp; <a class="code" href="log__manager_8c.html#acbe7c7db028f78d1f9ceda699b93c74e">LOG_NEED_TO_SET_LSA</a> (rcvindex, addr-&gt;<a class="code" href="structlog__data__addr.html#a3c632dae3ad660a8572d9298716d9522">pgptr</a>))</div><div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;    {</div><div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="page__buffer_8c.html#a95c9161ba3bb8e129b0c2407447c1b1b">pgbuf_set_lsa</a> (thread_p, addr-&gt;<a class="code" href="structlog__data__addr.html#a3c632dae3ad660a8572d9298716d9522">pgptr</a>, &amp;start_lsa) == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;        {</div><div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;          <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (<span class="keyword">false</span>);</div><div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160;          <span class="keywordflow">return</span>;</div><div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;        }</div><div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;    }</div><div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;    }</div><div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;}</div><div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160;</div><div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;<span class="comment"> * log_append_compensate - LOG COMPENSATE DATA</span></div><div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160;<span class="comment"> * return: nothing</span></div><div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;<span class="comment"> *   rcvindex(in): Index to recovery function</span></div><div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160;<span class="comment"> *   vpid(in): Volume-page address of compensate data</span></div><div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160;<span class="comment"> *   offset(in): Offset of compensate data</span></div><div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160;<span class="comment"> *   pgptr(in): Page pointer where compensating data resides. It may be</span></div><div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;<span class="comment"> *                     NULL when the page is not available during recovery.</span></div><div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160;<span class="comment"> *   length(in): Length of compensating data (kind of redo(after) data)</span></div><div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;<span class="comment"> *   data(in): Compensating data (kind of redo(after) data)</span></div><div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;<span class="comment"> *   tdes(in/out): State structure of transaction of the log record</span></div><div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;<span class="comment"> * NOTE: Log a compensating log record. An undo performed during a</span></div><div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;<span class="comment"> *              rollback or recovery is logged using what is called a</span></div><div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160;<span class="comment"> *              compensation log record. A compensation log record undoes the</span></div><div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160;<span class="comment"> *              redo of an aborted transaction during the redo phase of the</span></div><div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160;<span class="comment"> *              recovery process. Compensating log records are quite useful to</span></div><div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;<span class="comment"> *              make system and media crash recovery faster. Compensating log</span></div><div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;<span class="comment"> *              records are redo log records and thus, they are never undone.</span></div><div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l02992"></a><span class="lineno"><a class="line" href="log__manager_8h.html#a1b9d7ef3a0e157511a172c7dc6439ca5"> 2992</a></span>&#160;<a class="code" href="log__manager_8c.html#a1b9d7ef3a0e157511a172c7dc6439ca5">log_append_compensate</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2b">LOG_RCVINDEX</a> rcvindex, <span class="keyword">const</span> <a class="code" href="structvpid.html">VPID</a> * <a class="code" href="structvpid.html">vpid</a>, <a class="code" href="storage__common_8h.html#ac3f9d7ae37c5a4cb27570f7313891bc8">PGLENGTH</a> <a class="code" href="expat_8h.html#ad0c30ee1add42468a6d7c022f2efdf70">offset</a>,</div><div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;               <a class="code" href="storage__common_8h.html#ae4a052db40daa4a44a890bad45d8ecdc">PAGE_PTR</a> pgptr, <span class="keywordtype">int</span> length, <span class="keyword">const</span> <span class="keywordtype">void</span> *<a class="code" href="namespacestatdump__to__csv.html#aedcb70fde9c0b07a0732db70deeec616">data</a>, <a class="code" href="structlog__tdes.html">LOG_TDES</a> * tdes)</div><div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;{</div><div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;  log_append_compensate_internal (thread_p, rcvindex, <a class="code" href="structvpid.html">vpid</a>, <a class="code" href="expat_8h.html#ad0c30ee1add42468a6d7c022f2efdf70">offset</a>, pgptr, length, <a class="code" href="namespacestatdump__to__csv.html#aedcb70fde9c0b07a0732db70deeec616">data</a>, tdes, <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;}</div><div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160;</div><div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160;<span class="comment"> * log_append_compensate_with_undo_nxlsa () - Append compensate log record</span></div><div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;<span class="comment"> *                        and overwrite its undo_nxlsa.</span></div><div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;<span class="comment"> * return      : Void.</span></div><div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;<span class="comment"> * thread_p (in)   : Thread entry.</span></div><div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;<span class="comment"> * rcvindex (in)   : Index to recovery function.</span></div><div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160;<span class="comment"> * vpid (in)       : Volume-page address of compensate data</span></div><div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160;<span class="comment"> * offset(in)      : Offset of compensate data</span></div><div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160;<span class="comment"> * pgptr(in)       : Page pointer where compensating data resides. It may be</span></div><div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;<span class="comment"> *           NULL when the page is not available during recovery.</span></div><div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;<span class="comment"> * length (in)     : Length of compensating data (kind of redo(after) data)</span></div><div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;<span class="comment"> * data (in)       : Compensating data (kind of redo(after) data)</span></div><div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;<span class="comment"> * tdes (in/out)   : State structure of transaction of the log record</span></div><div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;<span class="comment"> * undo_nxlsa (in) : Use a different undo_nxlsa than tdes-&gt;undo_nxlsa.</span></div><div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;<span class="comment"> *           Necessary for cases when log records may be added before</span></div><div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;<span class="comment"> *           compensation (one example being index merge/split before</span></div><div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;<span class="comment"> *           undoing b-tree operation).</span></div><div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l03018"></a><span class="lineno"><a class="line" href="log__manager_8h.html#abb91bc4aca8cb9ed6264576e8102979e"> 3018</a></span>&#160;<a class="code" href="log__manager_8c.html#abb91bc4aca8cb9ed6264576e8102979e">log_append_compensate_with_undo_nxlsa</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2b">LOG_RCVINDEX</a> rcvindex, <span class="keyword">const</span> <a class="code" href="structvpid.html">VPID</a> * <a class="code" href="structvpid.html">vpid</a>,</div><div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160;                       <a class="code" href="storage__common_8h.html#ac3f9d7ae37c5a4cb27570f7313891bc8">PGLENGTH</a> <a class="code" href="expat_8h.html#ad0c30ee1add42468a6d7c022f2efdf70">offset</a>, <a class="code" href="storage__common_8h.html#ae4a052db40daa4a44a890bad45d8ecdc">PAGE_PTR</a> pgptr, <span class="keywordtype">int</span> length, <span class="keyword">const</span> <span class="keywordtype">void</span> *<a class="code" href="namespacestatdump__to__csv.html#aedcb70fde9c0b07a0732db70deeec616">data</a>, <a class="code" href="structlog__tdes.html">LOG_TDES</a> * tdes,</div><div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160;                       <span class="keyword">const</span> <a class="code" href="structlog__lsa.html">LOG_LSA</a> * undo_nxlsa)</div><div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;{</div><div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;  <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (undo_nxlsa != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;</div><div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;  log_append_compensate_internal (thread_p, rcvindex, <a class="code" href="structvpid.html">vpid</a>, <a class="code" href="expat_8h.html#ad0c30ee1add42468a6d7c022f2efdf70">offset</a>, pgptr, length, <a class="code" href="namespacestatdump__to__csv.html#aedcb70fde9c0b07a0732db70deeec616">data</a>, tdes, undo_nxlsa);</div><div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;}</div><div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;</div><div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160;<span class="comment"> * log_append_compensate - LOG COMPENSATE DATA</span></div><div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;<span class="comment"> * return: nothing</span></div><div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;<span class="comment"> *   rcvindex(in): Index to recovery function</span></div><div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;<span class="comment"> *   vpid(in): Volume-page address of compensate data</span></div><div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160;<span class="comment"> *   offset(in): Offset of compensate data</span></div><div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;<span class="comment"> *   pgptr(in): Page pointer where compensating data resides. It may be</span></div><div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160;<span class="comment"> *                     NULL when the page is not available during recovery.</span></div><div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;<span class="comment"> *   length(in): Length of compensating data (kind of redo(after) data)</span></div><div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;<span class="comment"> *   data(in): Compensating data (kind of redo(after) data)</span></div><div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160;<span class="comment"> *   tdes(in/out): State structure of transaction of the log record</span></div><div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;<span class="comment"> *   undo_nxlsa(in): Use a different undo_nxlsa than tdes-&gt;undo_nxlsa.</span></div><div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;<span class="comment"> *           Necessary for cases when log records may be added before</span></div><div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;<span class="comment"> *           compensation (one example being index merge/split before</span></div><div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160;<span class="comment"> *           undoing b-tree operation).</span></div><div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160;<span class="comment"> * NOTE: Log a compensating log record. An undo performed during a</span></div><div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160;<span class="comment"> *              rollback or recovery is logged using what is called a</span></div><div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160;<span class="comment"> *              compensation log record. A compensation log record undoes the</span></div><div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160;<span class="comment"> *              redo of an aborted transaction during the redo phase of the</span></div><div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;<span class="comment"> *              recovery process. Compensating log records are quite useful to</span></div><div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160;<span class="comment"> *              make system and media crash recovery faster. Compensating log</span></div><div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160;<span class="comment"> *              records are redo log records and thus, they are never undone.</span></div><div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div><div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160;log_append_compensate_internal (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2b">LOG_RCVINDEX</a> rcvindex, <span class="keyword">const</span> <a class="code" href="structvpid.html">VPID</a> * <a class="code" href="structvpid.html">vpid</a>, <a class="code" href="storage__common_8h.html#ac3f9d7ae37c5a4cb27570f7313891bc8">PGLENGTH</a> <a class="code" href="expat_8h.html#ad0c30ee1add42468a6d7c022f2efdf70">offset</a>,</div><div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160;                <a class="code" href="storage__common_8h.html#ae4a052db40daa4a44a890bad45d8ecdc">PAGE_PTR</a> pgptr, <span class="keywordtype">int</span> length, <span class="keyword">const</span> <span class="keywordtype">void</span> *<a class="code" href="namespacestatdump__to__csv.html#aedcb70fde9c0b07a0732db70deeec616">data</a>, <a class="code" href="structlog__tdes.html">LOG_TDES</a> * tdes,</div><div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160;                <span class="keyword">const</span> <a class="code" href="structlog__lsa.html">LOG_LSA</a> * undo_nxlsa)</div><div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;{</div><div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160;  <a class="code" href="structlog__rec__compensate.html">LOG_REC_COMPENSATE</a> *compensate;   <span class="comment">/* Compensate log record */</span></div><div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160;  <a class="code" href="structlog__lsa.html">LOG_LSA</a> prev_lsa;     <span class="comment">/* LSA of next record to undo */</span></div><div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160;  <a class="code" href="structlog__prior__node.html">LOG_PRIOR_NODE</a> *<a class="code" href="external_2include_2queue_8h.html#a465e28dbd1a1c60ff504d3ea275613ed">node</a>;</div><div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160;  <a class="code" href="structlog__lsa.html">LOG_LSA</a> start_lsa;</div><div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;</div><div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160;<span class="preprocessor">#if defined(CUBRID_DEBUG)</span></div><div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160;  <span class="keywordtype">int</span> error_code = <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>;</div><div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160;</div><div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="structvpid.html">vpid</a>-&gt;<a class="code" href="structvpid.html#a54e222d402e758d24ae0df524a9e677d">volid</a> == <a class="code" href="storage__common_8h.html#a5859fbd2f7cd3c37c37e672f812388ff">NULL_VOLID</a> || <a class="code" href="structvpid.html">vpid</a>-&gt;<a class="code" href="structvpid.html#a5863283d85ba76aaec01bf80c89a9d36">pageid</a> == <a class="code" href="storage__common_8h.html#a7ed60eef43941f46fadae895f63ee033">NULL_PAGEID</a>)</div><div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;    {</div><div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;      <span class="comment">/* </span></div><div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;<span class="comment">       * Compensate is always an operation page level logging. Thus, a data page</span></div><div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160;<span class="comment">       * pointer must have been given as part of the address</span></div><div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160;      <a class="code" href="error__manager_8c.html#afdaf87ce30f2f557802a185ab85b6599">er_set</a> (<a class="code" href="error__manager_8h.html#a5d0d456c474e11fc70779873a30a7432a07ad8f9fda27124d297c94b7d3ea44e8">ER_ERROR_SEVERITY</a>, <a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <a class="code" href="error__code_8h.html#a80b3ce28a965d5be79dc7b4c22566853">ER_LOG_COMPENSATE_INTERFACE</a>, 0);</div><div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160;      error_code = <a class="code" href="error__code_8h.html#a80b3ce28a965d5be79dc7b4c22566853">ER_LOG_COMPENSATE_INTERFACE</a>;</div><div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160;    }</div><div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* CUBRID_DEBUG */</span><span class="preprocessor"></span></div><div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160;</div><div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160;  <a class="code" href="structnodeptr.html">node</a> =</div><div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160;    <a class="code" href="log__impl_8h.html#a2b616997f446dcb588a6addcc65cf5b7">prior_lsa_alloc_and_copy_data</a> (thread_p, <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a92e0794a329897d52f3345d13359914e">LOG_COMPENSATE</a>, rcvindex, <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, length, (<span class="keywordtype">char</span> *) <a class="code" href="namespacestatdump__to__csv.html#aedcb70fde9c0b07a0732db70deeec616">data</a>, 0, (<span class="keywordtype">char</span> *) <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="structnodeptr.html">node</a> == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160;    {</div><div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160;    }</div><div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160;</div><div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160;  <a class="code" href="storage__common_8h.html#a4c9bc15296fe6728cf0351726cc6ad09">LSA_COPY</a> (&amp;prev_lsa, &amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a4e3335b7f0e4ca7f858416446ae8f782">undo_nxlsa</a>);</div><div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160;</div><div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160;  compensate = (<a class="code" href="structlog__rec__compensate.html">LOG_REC_COMPENSATE</a> *) <a class="code" href="structnodeptr.html">node</a>-&gt;data_header;</div><div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160;</div><div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160;  compensate-&gt;<a class="code" href="structlog__rec__compensate.html#a1cf8b84dd2777a88d87f1401c1799a2b">data</a>.<a class="code" href="structlog__data.html#ab1a17fceea659d32f5187b81a7b80412">rcvindex</a> = rcvindex;</div><div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;  compensate-&gt;<a class="code" href="structlog__rec__compensate.html#a1cf8b84dd2777a88d87f1401c1799a2b">data</a>.<a class="code" href="structlog__data.html#a8410b9d70cc70d2bc6fb6df88ea48bb4">pageid</a> = <a class="code" href="structvpid.html">vpid</a>-&gt;<a class="code" href="structvpid.html#a5863283d85ba76aaec01bf80c89a9d36">pageid</a>;</div><div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160;  compensate-&gt;<a class="code" href="structlog__rec__compensate.html#a1cf8b84dd2777a88d87f1401c1799a2b">data</a>.<a class="code" href="structlog__data.html#afd25836b0952561036b01b5a50c310b2">offset</a> = <a class="code" href="expat_8h.html#ad0c30ee1add42468a6d7c022f2efdf70">offset</a>;</div><div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;  compensate-&gt;<a class="code" href="structlog__rec__compensate.html#a1cf8b84dd2777a88d87f1401c1799a2b">data</a>.<a class="code" href="structlog__data.html#ad5635159b85ee07322bf30e39a5dee76">volid</a> = <a class="code" href="structvpid.html">vpid</a>-&gt;<a class="code" href="structvpid.html#a54e222d402e758d24ae0df524a9e677d">volid</a>;</div><div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;  <a class="code" href="cubrid__data__seek__test_8php.html#a7bf795f554c1ff05baccf023cc804198">if</a> (undo_nxlsa != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160;    {</div><div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160;      <a class="code" href="storage__common_8h.html#a4c9bc15296fe6728cf0351726cc6ad09">LSA_COPY</a> (&amp;compensate-&gt;<a class="code" href="structlog__rec__compensate.html#a7222173e854c1f68568c5ce564325a7a">undo_nxlsa</a>, undo_nxlsa);</div><div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160;    }</div><div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160;    {</div><div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160;      <a class="code" href="storage__common_8h.html#a4c9bc15296fe6728cf0351726cc6ad09">LSA_COPY</a> (&amp;compensate-&gt;<a class="code" href="structlog__rec__compensate.html#a7222173e854c1f68568c5ce564325a7a">undo_nxlsa</a>, &amp;prev_lsa);</div><div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160;    }</div><div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160;  compensate-&gt;<a class="code" href="structlog__rec__compensate.html#aa7dd1825a2cbaacc90ad2c40a8d5f97f">length</a> = length;</div><div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160;</div><div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160;  start_lsa = <a class="code" href="log__impl_8h.html#a8a3ce7b7aa59fe26c04eca3577e434e8">prior_lsa_next_record</a> (thread_p, <a class="code" href="structnodeptr.html">node</a>, tdes);</div><div class="line"><a name="l03104"></a><span class="lineno"> 3104</span>&#160;</div><div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;  <span class="comment">/* </span></div><div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160;<span class="comment">   * Set the LSA on the data page of the corresponding log record for page</span></div><div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160;<span class="comment">   * operation logging.</span></div><div class="line"><a name="l03108"></a><span class="lineno"> 3108</span>&#160;<span class="comment">   * Make sure that I should log. Page operational logging is not done for</span></div><div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160;<span class="comment">   * temporary data of temporary files and volumes</span></div><div class="line"><a name="l03110"></a><span class="lineno"> 3110</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l03111"></a><span class="lineno"> 3111</span>&#160;  <span class="keywordflow">if</span> (pgptr != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> &amp;&amp; <a class="code" href="page__buffer_8c.html#a95c9161ba3bb8e129b0c2407447c1b1b">pgbuf_set_lsa</a> (thread_p, pgptr, &amp;start_lsa) == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l03112"></a><span class="lineno"> 3112</span>&#160;    {</div><div class="line"><a name="l03113"></a><span class="lineno"> 3113</span>&#160;      <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (<span class="keyword">false</span>);</div><div class="line"><a name="l03114"></a><span class="lineno"> 3114</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l03115"></a><span class="lineno"> 3115</span>&#160;    }</div><div class="line"><a name="l03116"></a><span class="lineno"> 3116</span>&#160;</div><div class="line"><a name="l03117"></a><span class="lineno"> 3117</span>&#160;  <span class="comment">/* Go back to our undo link */</span></div><div class="line"><a name="l03118"></a><span class="lineno"> 3118</span>&#160;  <a class="code" href="storage__common_8h.html#a4c9bc15296fe6728cf0351726cc6ad09">LSA_COPY</a> (&amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a4e3335b7f0e4ca7f858416446ae8f782">undo_nxlsa</a>, &amp;prev_lsa);</div><div class="line"><a name="l03119"></a><span class="lineno"> 3119</span>&#160;}</div><div class="line"><a name="l03120"></a><span class="lineno"> 3120</span>&#160;</div><div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l03122"></a><span class="lineno"> 3122</span>&#160;<span class="comment"> * log_append_empty_record -</span></div><div class="line"><a name="l03123"></a><span class="lineno"> 3123</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160;<span class="comment"> * return: nothing</span></div><div class="line"><a name="l03125"></a><span class="lineno"> 3125</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l03126"></a><span class="lineno"> 3126</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l03127"></a><span class="lineno"><a class="line" href="log__manager_8h.html#a1315d00aaa26d2a280a675338f59c9ac"> 3127</a></span>&#160;<a class="code" href="log__manager_8c.html#a1315d00aaa26d2a280a675338f59c9ac">log_append_empty_record</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="log__impl_8h.html#ab85dbe80b115a32bf7a430c32ddc5b8b">LOG_RECTYPE</a> logrec_type, <a class="code" href="structlog__data__addr.html">LOG_DATA_ADDR</a> * addr)</div><div class="line"><a name="l03128"></a><span class="lineno"> 3128</span>&#160;{</div><div class="line"><a name="l03129"></a><span class="lineno"> 3129</span>&#160;  <span class="keywordtype">int</span> tran_index;</div><div class="line"><a name="l03130"></a><span class="lineno"> 3130</span>&#160;  <span class="keywordtype">bool</span> skip = <span class="keyword">false</span>;</div><div class="line"><a name="l03131"></a><span class="lineno"> 3131</span>&#160;  <a class="code" href="structlog__tdes.html">LOG_TDES</a> *tdes;</div><div class="line"><a name="l03132"></a><span class="lineno"> 3132</span>&#160;  <a class="code" href="structlog__prior__node.html">LOG_PRIOR_NODE</a> *<a class="code" href="external_2include_2queue_8h.html#a465e28dbd1a1c60ff504d3ea275613ed">node</a>;</div><div class="line"><a name="l03133"></a><span class="lineno"> 3133</span>&#160;</div><div class="line"><a name="l03134"></a><span class="lineno"> 3134</span>&#160;  tran_index = <a class="code" href="perf__monitor_8h.html#a55d27b01d605ba6ee2929ddfe8588320">LOG_FIND_THREAD_TRAN_INDEX</a> (thread_p);</div><div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="vacuum_8h.html#ab0e1deb8da1aa663aa073b0ce78606a2">VACUUM_IS_THREAD_VACUUM</a> (thread_p))</div><div class="line"><a name="l03136"></a><span class="lineno"> 3136</span>&#160;    {</div><div class="line"><a name="l03137"></a><span class="lineno"> 3137</span>&#160;      <span class="comment">/* Vacuum worker */</span></div><div class="line"><a name="l03138"></a><span class="lineno"> 3138</span>&#160;      <span class="comment">/* Must be under a system operation, otherwise postpone records will not work. */</span></div><div class="line"><a name="l03139"></a><span class="lineno"> 3139</span>&#160;      <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (<a class="code" href="vacuum_8h.html#a6a1dc228ca433bf85d100084b318153f">vacuum_worker_state_is_topop</a> (thread_p));</div><div class="line"><a name="l03140"></a><span class="lineno"> 3140</span>&#160;      <span class="comment">/* Use reserved transaction descriptor instead of system tdes. */</span></div><div class="line"><a name="l03141"></a><span class="lineno"> 3141</span>&#160;      tdes = <a class="code" href="vacuum_8h.html#a3bae574be1c3bf9a786050397a1cde68">vacuum_get_worker_tdes</a> (thread_p);</div><div class="line"><a name="l03142"></a><span class="lineno"> 3142</span>&#160;    }</div><div class="line"><a name="l03143"></a><span class="lineno"> 3143</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l03144"></a><span class="lineno"> 3144</span>&#160;    {</div><div class="line"><a name="l03145"></a><span class="lineno"> 3145</span>&#160;      <span class="comment">/* Find tdes in transaction table. */</span></div><div class="line"><a name="l03146"></a><span class="lineno"> 3146</span>&#160;      tdes = <a class="code" href="log__impl_8h.html#a08fee41cfcf592e8afdbc4988ffbc8e4">LOG_FIND_TDES</a> (tran_index);</div><div class="line"><a name="l03147"></a><span class="lineno"> 3147</span>&#160;    }</div><div class="line"><a name="l03148"></a><span class="lineno"> 3148</span>&#160;  <span class="keywordflow">if</span> (tdes == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l03149"></a><span class="lineno"> 3149</span>&#160;    {</div><div class="line"><a name="l03150"></a><span class="lineno"> 3150</span>&#160;      <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (<span class="keyword">false</span>);</div><div class="line"><a name="l03151"></a><span class="lineno"> 3151</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160;    }</div><div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;</div><div class="line"><a name="l03154"></a><span class="lineno"> 3154</span>&#160;  <span class="keywordflow">if</span> (addr != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l03155"></a><span class="lineno"> 3155</span>&#160;    {</div><div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160;      skip = log_can_skip_redo_logging (<a class="code" href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2ba6ea83d694355ec2c529960461a086f26">RV_NOT_DEFINED</a>, tdes, addr);</div><div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160;      <span class="keywordflow">if</span> (skip == <span class="keyword">true</span>)</div><div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160;    {</div><div class="line"><a name="l03159"></a><span class="lineno"> 3159</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l03160"></a><span class="lineno"> 3160</span>&#160;    }</div><div class="line"><a name="l03161"></a><span class="lineno"> 3161</span>&#160;    }</div><div class="line"><a name="l03162"></a><span class="lineno"> 3162</span>&#160;</div><div class="line"><a name="l03163"></a><span class="lineno"> 3163</span>&#160;  <a class="code" href="structnodeptr.html">node</a> = <a class="code" href="log__impl_8h.html#a2b616997f446dcb588a6addcc65cf5b7">prior_lsa_alloc_and_copy_data</a> (thread_p, logrec_type, <a class="code" href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2ba6ea83d694355ec2c529960461a086f26">RV_NOT_DEFINED</a>, <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l03164"></a><span class="lineno"> 3164</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="structnodeptr.html">node</a> == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l03165"></a><span class="lineno"> 3165</span>&#160;    {</div><div class="line"><a name="l03166"></a><span class="lineno"> 3166</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l03167"></a><span class="lineno"> 3167</span>&#160;    }</div><div class="line"><a name="l03168"></a><span class="lineno"> 3168</span>&#160;</div><div class="line"><a name="l03169"></a><span class="lineno"> 3169</span>&#160;  (void) <a class="code" href="log__impl_8h.html#a8a3ce7b7aa59fe26c04eca3577e434e8">prior_lsa_next_record</a> (thread_p, <a class="code" href="structnodeptr.html">node</a>, tdes);</div><div class="line"><a name="l03170"></a><span class="lineno"> 3170</span>&#160;}</div><div class="line"><a name="l03171"></a><span class="lineno"> 3171</span>&#160;</div><div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l03173"></a><span class="lineno"> 3173</span>&#160;<span class="comment"> * log_append_ha_server_state -</span></div><div class="line"><a name="l03174"></a><span class="lineno"> 3174</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l03175"></a><span class="lineno"> 3175</span>&#160;<span class="comment"> * return: nothing</span></div><div class="line"><a name="l03176"></a><span class="lineno"> 3176</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l03177"></a><span class="lineno"> 3177</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l03178"></a><span class="lineno"><a class="line" href="log__manager_8h.html#a7ef2b913287067a2beccb363958ee1ae"> 3178</a></span>&#160;<a class="code" href="log__manager_8c.html#a7ef2b913287067a2beccb363958ee1ae">log_append_ha_server_state</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <span class="keywordtype">int</span> state)</div><div class="line"><a name="l03179"></a><span class="lineno"> 3179</span>&#160;{</div><div class="line"><a name="l03180"></a><span class="lineno"> 3180</span>&#160;  <span class="keywordtype">int</span> tran_index;</div><div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160;  <a class="code" href="structlog__tdes.html">LOG_TDES</a> *tdes;</div><div class="line"><a name="l03182"></a><span class="lineno"> 3182</span>&#160;  <a class="code" href="structlog__rec__ha__server__state.html">LOG_REC_HA_SERVER_STATE</a> *<a class="code" href="boot_8h.html#aced830d72ca3bc3b775113c1d75a2368">ha_server_state</a>;</div><div class="line"><a name="l03183"></a><span class="lineno"> 3183</span>&#160;  <a class="code" href="structlog__prior__node.html">LOG_PRIOR_NODE</a> *<a class="code" href="external_2include_2queue_8h.html#a465e28dbd1a1c60ff504d3ea275613ed">node</a>;</div><div class="line"><a name="l03184"></a><span class="lineno"> 3184</span>&#160;  <a class="code" href="structlog__lsa.html">LOG_LSA</a> start_lsa;</div><div class="line"><a name="l03185"></a><span class="lineno"> 3185</span>&#160;</div><div class="line"><a name="l03186"></a><span class="lineno"> 3186</span>&#160;  <span class="comment">/* Vacuum workers are not allowed to use this type of log records. */</span></div><div class="line"><a name="l03187"></a><span class="lineno"> 3187</span>&#160;  <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (!<a class="code" href="vacuum_8h.html#ab0e1deb8da1aa663aa073b0ce78606a2">VACUUM_IS_THREAD_VACUUM</a> (thread_p));</div><div class="line"><a name="l03188"></a><span class="lineno"> 3188</span>&#160;</div><div class="line"><a name="l03189"></a><span class="lineno"> 3189</span>&#160;  tran_index = <a class="code" href="perf__monitor_8h.html#a55d27b01d605ba6ee2929ddfe8588320">LOG_FIND_THREAD_TRAN_INDEX</a> (thread_p);</div><div class="line"><a name="l03190"></a><span class="lineno"> 3190</span>&#160;  tdes = <a class="code" href="log__impl_8h.html#a08fee41cfcf592e8afdbc4988ffbc8e4">LOG_FIND_TDES</a> (tran_index);</div><div class="line"><a name="l03191"></a><span class="lineno"> 3191</span>&#160;  <span class="keywordflow">if</span> (tdes == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l03192"></a><span class="lineno"> 3192</span>&#160;    {</div><div class="line"><a name="l03193"></a><span class="lineno"> 3193</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l03194"></a><span class="lineno"> 3194</span>&#160;    }</div><div class="line"><a name="l03195"></a><span class="lineno"> 3195</span>&#160;</div><div class="line"><a name="l03196"></a><span class="lineno"> 3196</span>&#160;  <a class="code" href="structnodeptr.html">node</a> = <a class="code" href="log__impl_8h.html#a2b616997f446dcb588a6addcc65cf5b7">prior_lsa_alloc_and_copy_data</a> (thread_p, <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a942105cb887dd1030b0c6151087d24ac">LOG_DUMMY_HA_SERVER_STATE</a>, <a class="code" href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2ba6ea83d694355ec2c529960461a086f26">RV_NOT_DEFINED</a>, <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l03197"></a><span class="lineno"> 3197</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="structnodeptr.html">node</a> == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l03198"></a><span class="lineno"> 3198</span>&#160;    {</div><div class="line"><a name="l03199"></a><span class="lineno"> 3199</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l03200"></a><span class="lineno"> 3200</span>&#160;    }</div><div class="line"><a name="l03201"></a><span class="lineno"> 3201</span>&#160;</div><div class="line"><a name="l03202"></a><span class="lineno"> 3202</span>&#160;  <a class="code" href="boot_8h.html#aced830d72ca3bc3b775113c1d75a2368">ha_server_state</a> = (<a class="code" href="structlog__rec__ha__server__state.html">LOG_REC_HA_SERVER_STATE</a> *) <a class="code" href="structnodeptr.html">node</a>-&gt;data_header;</div><div class="line"><a name="l03203"></a><span class="lineno"> 3203</span>&#160;  memset (<a class="code" href="boot_8h.html#aced830d72ca3bc3b775113c1d75a2368">ha_server_state</a>, 0, <span class="keyword">sizeof</span> (<a class="code" href="structlog__rec__ha__server__state.html">LOG_REC_HA_SERVER_STATE</a>));</div><div class="line"><a name="l03204"></a><span class="lineno"> 3204</span>&#160;</div><div class="line"><a name="l03205"></a><span class="lineno"> 3205</span>&#160;  <a class="code" href="boot_8h.html#aced830d72ca3bc3b775113c1d75a2368">ha_server_state</a>-&gt;state = state;</div><div class="line"><a name="l03206"></a><span class="lineno"> 3206</span>&#160;  <a class="code" href="boot_8h.html#aced830d72ca3bc3b775113c1d75a2368">ha_server_state</a>-&gt;at_time = <a class="code" href="namespacebrokerstatus__to__csv.html#ae075d9642cd7485bc938b7d65b2e6991">time</a> (<a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l03207"></a><span class="lineno"> 3207</span>&#160;</div><div class="line"><a name="l03208"></a><span class="lineno"> 3208</span>&#160;  start_lsa = <a class="code" href="log__impl_8h.html#a8a3ce7b7aa59fe26c04eca3577e434e8">prior_lsa_next_record</a> (thread_p, <a class="code" href="structnodeptr.html">node</a>, tdes);</div><div class="line"><a name="l03209"></a><span class="lineno"> 3209</span>&#160;</div><div class="line"><a name="l03210"></a><span class="lineno"> 3210</span>&#160;  <a class="code" href="log__impl_8h.html#aa91abaf89af63e703737ac5c00d7cd7d">logpb_flush_pages</a> (thread_p, &amp;start_lsa);</div><div class="line"><a name="l03211"></a><span class="lineno"> 3211</span>&#160;}</div><div class="line"><a name="l03212"></a><span class="lineno"> 3212</span>&#160;</div><div class="line"><a name="l03213"></a><span class="lineno"> 3213</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l03214"></a><span class="lineno"> 3214</span>&#160;<span class="comment"> * log_skip_logging_set_lsa -  A log entry was not recorded intentionally</span></div><div class="line"><a name="l03215"></a><span class="lineno"> 3215</span>&#160;<span class="comment"> *                             by the caller. set page LSA</span></div><div class="line"><a name="l03216"></a><span class="lineno"> 3216</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l03217"></a><span class="lineno"> 3217</span>&#160;<span class="comment"> * return: nothing</span></div><div class="line"><a name="l03218"></a><span class="lineno"> 3218</span>&#160;<span class="comment">*</span></div><div class="line"><a name="l03219"></a><span class="lineno"> 3219</span>&#160;<span class="comment"> *   addr(in): Address (Volume, page, and offset) of data</span></div><div class="line"><a name="l03220"></a><span class="lineno"> 3220</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l03221"></a><span class="lineno"> 3221</span>&#160;<span class="comment"> * NOTE: A log entry was not recorded intentionally by the caller. For</span></div><div class="line"><a name="l03222"></a><span class="lineno"> 3222</span>&#160;<span class="comment"> *              example, if the data is not accurate, the logging could be</span></div><div class="line"><a name="l03223"></a><span class="lineno"> 3223</span>&#160;<span class="comment"> *              avoided since it will be brought up to date later by the</span></div><div class="line"><a name="l03224"></a><span class="lineno"> 3224</span>&#160;<span class="comment"> *              normal execution of the database.</span></div><div class="line"><a name="l03225"></a><span class="lineno"> 3225</span>&#160;<span class="comment"> *              This function is used to avoid warning of unlogged pages.</span></div><div class="line"><a name="l03226"></a><span class="lineno"> 3226</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l03227"></a><span class="lineno"> 3227</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l03228"></a><span class="lineno"><a class="line" href="log__manager_8h.html#a710b4ca5cba1f04821a8bd736e64b485"> 3228</a></span>&#160;<a class="code" href="log__manager_8c.html#a710b4ca5cba1f04821a8bd736e64b485">log_skip_logging_set_lsa</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="structlog__data__addr.html">LOG_DATA_ADDR</a> * addr)</div><div class="line"><a name="l03229"></a><span class="lineno"> 3229</span>&#160;{</div><div class="line"><a name="l03230"></a><span class="lineno"> 3230</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="mprec_8c.html#a115f98821af8b9ac2f97f2ac2cb2797f">rv</a>;</div><div class="line"><a name="l03231"></a><span class="lineno"> 3231</span>&#160;</div><div class="line"><a name="l03232"></a><span class="lineno"> 3232</span>&#160;  <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (addr &amp;&amp; addr-&gt;<a class="code" href="structlog__data__addr.html#a3c632dae3ad660a8572d9298716d9522">pgptr</a> != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l03233"></a><span class="lineno"> 3233</span>&#160;</div><div class="line"><a name="l03234"></a><span class="lineno"> 3234</span>&#160;<span class="preprocessor">#if defined(CUBRID_DEBUG)</span></div><div class="line"><a name="l03235"></a><span class="lineno"> 3235</span>&#160;  <span class="keywordflow">if</span> (addr-&gt;<a class="code" href="structlog__data__addr.html#a3c632dae3ad660a8572d9298716d9522">pgptr</a> == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l03236"></a><span class="lineno"> 3236</span>&#160;    {</div><div class="line"><a name="l03237"></a><span class="lineno"> 3237</span>&#160;      <a class="code" href="error__manager_8h.html#a075eb8873354909bbe8edafa0f18f58c">er_log_debug</a> (<a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>,</div><div class="line"><a name="l03238"></a><span class="lineno"> 3238</span>&#160;            <span class="stringliteral">&quot;log_skip_logging_set_lsa: A data page pointer must&quot;</span></div><div class="line"><a name="l03239"></a><span class="lineno"> 3239</span>&#160;            <span class="stringliteral">&quot; be given as part of the address... ignored\n&quot;</span>);</div><div class="line"><a name="l03240"></a><span class="lineno"> 3240</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l03241"></a><span class="lineno"> 3241</span>&#160;    }</div><div class="line"><a name="l03242"></a><span class="lineno"> 3242</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* CUBRID_DEBUG */</span><span class="preprocessor"></span></div><div class="line"><a name="l03243"></a><span class="lineno"> 3243</span>&#160;</div><div class="line"><a name="l03244"></a><span class="lineno"> 3244</span>&#160;  <span class="comment">/* Don&#39;t need to log */</span></div><div class="line"><a name="l03245"></a><span class="lineno"> 3245</span>&#160;</div><div class="line"><a name="l03246"></a><span class="lineno"> 3246</span>&#160;  <a class="code" href="mprec_8c.html#a115f98821af8b9ac2f97f2ac2cb2797f">rv</a> = <a class="code" href="log__manager_8c.html#a3bd1ad5edf8fc93f783af77e8cd6ee9a">pthread_mutex_lock</a> (&amp;<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1e76ccd9e44777acc719b8f1bdbb93bb">prior_info</a>.<a class="code" href="structlog__prior__lsa__info.html#adb03b78b697ffe97dce7c7d1fc763dc4">prior_lsa_mutex</a>);</div><div class="line"><a name="l03247"></a><span class="lineno"> 3247</span>&#160;</div><div class="line"><a name="l03248"></a><span class="lineno"> 3248</span>&#160;  (void) <a class="code" href="page__buffer_8c.html#a95c9161ba3bb8e129b0c2407447c1b1b">pgbuf_set_lsa</a> (thread_p, addr-&gt;<a class="code" href="structlog__data__addr.html#a3c632dae3ad660a8572d9298716d9522">pgptr</a>, &amp;<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1e76ccd9e44777acc719b8f1bdbb93bb">prior_info</a>.<a class="code" href="structlog__prior__lsa__info.html#ac2dc752b216f5b6c9d60aa082d35609a">prior_lsa</a>);</div><div class="line"><a name="l03249"></a><span class="lineno"> 3249</span>&#160;</div><div class="line"><a name="l03250"></a><span class="lineno"> 3250</span>&#160;  <a class="code" href="log__manager_8c.html#aa91b7ec8ae8a2d699fb09cc20c444fe8">pthread_mutex_unlock</a> (&amp;<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1e76ccd9e44777acc719b8f1bdbb93bb">prior_info</a>.<a class="code" href="structlog__prior__lsa__info.html#adb03b78b697ffe97dce7c7d1fc763dc4">prior_lsa_mutex</a>);</div><div class="line"><a name="l03251"></a><span class="lineno"> 3251</span>&#160;</div><div class="line"><a name="l03252"></a><span class="lineno"> 3252</span>&#160;  <span class="keywordflow">return</span>;</div><div class="line"><a name="l03253"></a><span class="lineno"> 3253</span>&#160;}</div><div class="line"><a name="l03254"></a><span class="lineno"> 3254</span>&#160;</div><div class="line"><a name="l03255"></a><span class="lineno"> 3255</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l03256"></a><span class="lineno"> 3256</span>&#160;<span class="comment"> * log_skip_logging -  A log entry was not recorded intentionally by the</span></div><div class="line"><a name="l03257"></a><span class="lineno"> 3257</span>&#160;<span class="comment"> *                      caller</span></div><div class="line"><a name="l03258"></a><span class="lineno"> 3258</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l03259"></a><span class="lineno"> 3259</span>&#160;<span class="comment"> * return: nothing</span></div><div class="line"><a name="l03260"></a><span class="lineno"> 3260</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l03261"></a><span class="lineno"> 3261</span>&#160;<span class="comment"> *   addr(in): Address (Volume, page, and offset) of data</span></div><div class="line"><a name="l03262"></a><span class="lineno"> 3262</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l03263"></a><span class="lineno"> 3263</span>&#160;<span class="comment"> * NOTE: A log entry was not recorded intentionally by the caller. For</span></div><div class="line"><a name="l03264"></a><span class="lineno"> 3264</span>&#160;<span class="comment"> *              example, if the data is not accurate, the logging could be</span></div><div class="line"><a name="l03265"></a><span class="lineno"> 3265</span>&#160;<span class="comment"> *              avoided since it will be brought up to date later by the</span></div><div class="line"><a name="l03266"></a><span class="lineno"> 3266</span>&#160;<span class="comment"> *              normal execution of the database.</span></div><div class="line"><a name="l03267"></a><span class="lineno"> 3267</span>&#160;<span class="comment"> *              This function is used to avoid warning of unlogged pages.</span></div><div class="line"><a name="l03268"></a><span class="lineno"> 3268</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l03269"></a><span class="lineno"> 3269</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l03270"></a><span class="lineno"><a class="line" href="log__manager_8h.html#af7bfbd98d66410cc6e3d1d050cec24ec"> 3270</a></span>&#160;<a class="code" href="log__manager_8c.html#af7bfbd98d66410cc6e3d1d050cec24ec">log_skip_logging</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="structlog__data__addr.html">LOG_DATA_ADDR</a> * addr)</div><div class="line"><a name="l03271"></a><span class="lineno"> 3271</span>&#160;{</div><div class="line"><a name="l03272"></a><span class="lineno"> 3272</span>&#160;<span class="preprocessor">#if 0</span></div><div class="line"><a name="l03273"></a><span class="lineno"> 3273</span>&#160;  <a class="code" href="structlog__tdes.html">LOG_TDES</a> *tdes;       <span class="comment">/* Transaction descriptor */</span></div><div class="line"><a name="l03274"></a><span class="lineno"> 3274</span>&#160;  <a class="code" href="structlog__lsa.html">LOG_LSA</a> *page_lsa;</div><div class="line"><a name="l03275"></a><span class="lineno"> 3275</span>&#160;<span class="preprocessor">#if defined(SERVER_MODE)</span></div><div class="line"><a name="l03276"></a><span class="lineno"> 3276</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="mprec_8c.html#a115f98821af8b9ac2f97f2ac2cb2797f">rv</a>;</div><div class="line"><a name="l03277"></a><span class="lineno"> 3277</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* SERVER_MODE */</span><span class="preprocessor"></span></div><div class="line"><a name="l03278"></a><span class="lineno"> 3278</span>&#160;  <span class="keywordtype">int</span> tran_index;</div><div class="line"><a name="l03279"></a><span class="lineno"> 3279</span>&#160;  <span class="keywordtype">int</span> error_code = <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>;</div><div class="line"><a name="l03280"></a><span class="lineno"> 3280</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l03281"></a><span class="lineno"> 3281</span>&#160;</div><div class="line"><a name="l03282"></a><span class="lineno"> 3282</span>&#160;<span class="preprocessor">#if defined(CUBRID_DEBUG)</span></div><div class="line"><a name="l03283"></a><span class="lineno"> 3283</span>&#160;  <span class="keywordflow">if</span> (addr-&gt;<a class="code" href="structlog__data__addr.html#a3c632dae3ad660a8572d9298716d9522">pgptr</a> == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l03284"></a><span class="lineno"> 3284</span>&#160;    {</div><div class="line"><a name="l03285"></a><span class="lineno"> 3285</span>&#160;      <a class="code" href="error__manager_8h.html#a075eb8873354909bbe8edafa0f18f58c">er_log_debug</a> (<a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>,</div><div class="line"><a name="l03286"></a><span class="lineno"> 3286</span>&#160;            <span class="stringliteral">&quot;log_skip_logging: A data page pointer must be given as part of the address... ignored\n&quot;</span>);</div><div class="line"><a name="l03287"></a><span class="lineno"> 3287</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l03288"></a><span class="lineno"> 3288</span>&#160;    }</div><div class="line"><a name="l03289"></a><span class="lineno"> 3289</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* CUBRID_DEBUG */</span><span class="preprocessor"></span></div><div class="line"><a name="l03290"></a><span class="lineno"> 3290</span>&#160;</div><div class="line"><a name="l03291"></a><span class="lineno"> 3291</span>&#160;  <span class="keywordflow">return</span>;</div><div class="line"><a name="l03292"></a><span class="lineno"> 3292</span>&#160;</div><div class="line"><a name="l03293"></a><span class="lineno"> 3293</span>&#160;<span class="preprocessor">#if 0</span></div><div class="line"><a name="l03294"></a><span class="lineno"> 3294</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="page__buffer_8c.html#ad57fb80ce30a5d3a727768a9198e51fc">pgbuf_is_lsa_temporary</a> (addr-&gt;<a class="code" href="structlog__data__addr.html#a3c632dae3ad660a8572d9298716d9522">pgptr</a>))</div><div class="line"><a name="l03295"></a><span class="lineno"> 3295</span>&#160;    {</div><div class="line"><a name="l03296"></a><span class="lineno"> 3296</span>&#160;      tran_index = <a class="code" href="perf__monitor_8h.html#a55d27b01d605ba6ee2929ddfe8588320">LOG_FIND_THREAD_TRAN_INDEX</a> (thread_p);</div><div class="line"><a name="l03297"></a><span class="lineno"> 3297</span>&#160;      tdes = <a class="code" href="log__impl_8h.html#a08fee41cfcf592e8afdbc4988ffbc8e4">LOG_FIND_TDES</a> (tran_index);</div><div class="line"><a name="l03298"></a><span class="lineno"> 3298</span>&#160;      <span class="keywordflow">if</span> (tdes == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l03299"></a><span class="lineno"> 3299</span>&#160;    {</div><div class="line"><a name="l03300"></a><span class="lineno"> 3300</span>&#160;      <a class="code" href="error__manager_8c.html#afdaf87ce30f2f557802a185ab85b6599">er_set</a> (<a class="code" href="error__manager_8h.html#a5d0d456c474e11fc70779873a30a7432a3314630dd19f90a68274cf737092c9f2">ER_FATAL_ERROR_SEVERITY</a>, <a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <a class="code" href="error__code_8h.html#a4b8e41e78be77c579a2c58f5248fefe2">ER_LOG_UNKNOWN_TRANINDEX</a>, 1, tran_index);</div><div class="line"><a name="l03301"></a><span class="lineno"> 3301</span>&#160;      error_code = <a class="code" href="error__code_8h.html#a4b8e41e78be77c579a2c58f5248fefe2">ER_LOG_UNKNOWN_TRANINDEX</a>;</div><div class="line"><a name="l03302"></a><span class="lineno"> 3302</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l03303"></a><span class="lineno"> 3303</span>&#160;    }</div><div class="line"><a name="l03304"></a><span class="lineno"> 3304</span>&#160;</div><div class="line"><a name="l03305"></a><span class="lineno"> 3305</span>&#160;      <span class="comment">/* </span></div><div class="line"><a name="l03306"></a><span class="lineno"> 3306</span>&#160;<span class="comment">       * If the page LSA has not been changed since the lsa checkpoint record,</span></div><div class="line"><a name="l03307"></a><span class="lineno"> 3307</span>&#160;<span class="comment">       * change it to either the checkpoint record or the restart LSA.</span></div><div class="line"><a name="l03308"></a><span class="lineno"> 3308</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l03309"></a><span class="lineno"> 3309</span>&#160;</div><div class="line"><a name="l03310"></a><span class="lineno"> 3310</span>&#160;      page_lsa = <a class="code" href="page__buffer_8c.html#a4d36b807bfa07b2b42d1faa0274655e3">pgbuf_get_lsa</a> (addr-&gt;<a class="code" href="structlog__data__addr.html#a3c632dae3ad660a8572d9298716d9522">pgptr</a>);</div><div class="line"><a name="l03311"></a><span class="lineno"> 3311</span>&#160;</div><div class="line"><a name="l03312"></a><span class="lineno"> 3312</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="storage__common_8h.html#a26dd766712df5b5c4fcd158f571a75e4">LSA_ISNULL</a> (&amp;<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a73c801b0d3d19a743cf3d20ec7ae63c6">rcv_phase_lsa</a>))</div><div class="line"><a name="l03313"></a><span class="lineno"> 3313</span>&#160;    {</div><div class="line"><a name="l03314"></a><span class="lineno"> 3314</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="storage__common_8h.html#aa90a06bd1f1a9925ac8ef0f856d1d872">LSA_GE</a> (&amp;<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a73c801b0d3d19a743cf3d20ec7ae63c6">rcv_phase_lsa</a>, page_lsa))</div><div class="line"><a name="l03315"></a><span class="lineno"> 3315</span>&#160;        {</div><div class="line"><a name="l03316"></a><span class="lineno"> 3316</span>&#160;          <a class="code" href="structlog__lsa.html">LOG_LSA</a> chkpt_lsa;</div><div class="line"><a name="l03317"></a><span class="lineno"> 3317</span>&#160;</div><div class="line"><a name="l03318"></a><span class="lineno"> 3318</span>&#160;          <a class="code" href="mprec_8c.html#a115f98821af8b9ac2f97f2ac2cb2797f">rv</a> = <a class="code" href="log__manager_8c.html#a3bd1ad5edf8fc93f783af77e8cd6ee9a">pthread_mutex_lock</a> (&amp;<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.chkpt_lsa_lock);</div><div class="line"><a name="l03319"></a><span class="lineno"> 3319</span>&#160;          <a class="code" href="storage__common_8h.html#a4c9bc15296fe6728cf0351726cc6ad09">LSA_COPY</a> (&amp;chkpt_lsa, &amp;<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>.<a class="code" href="structlog__header.html#abd3c92d1eb868dd630bdbfa3561ecf9e">chkpt_lsa</a>);</div><div class="line"><a name="l03320"></a><span class="lineno"> 3320</span>&#160;          <a class="code" href="log__manager_8c.html#aa91b7ec8ae8a2d699fb09cc20c444fe8">pthread_mutex_unlock</a> (&amp;<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.chkpt_lsa_lock);</div><div class="line"><a name="l03321"></a><span class="lineno"> 3321</span>&#160;</div><div class="line"><a name="l03322"></a><span class="lineno"> 3322</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="storage__common_8h.html#a467739272b1ee74686bae4be2354197a">LSA_GT</a> (&amp;chkpt_lsa, &amp;<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a73c801b0d3d19a743cf3d20ec7ae63c6">rcv_phase_lsa</a>))</div><div class="line"><a name="l03323"></a><span class="lineno"> 3323</span>&#160;        {</div><div class="line"><a name="l03324"></a><span class="lineno"> 3324</span>&#160;          (void) <a class="code" href="page__buffer_8c.html#a95c9161ba3bb8e129b0c2407447c1b1b">pgbuf_set_lsa</a> (thread_p, addr-&gt;<a class="code" href="structlog__data__addr.html#a3c632dae3ad660a8572d9298716d9522">pgptr</a>, &amp;chkpt_lsa);</div><div class="line"><a name="l03325"></a><span class="lineno"> 3325</span>&#160;        }</div><div class="line"><a name="l03326"></a><span class="lineno"> 3326</span>&#160;          <span class="keywordflow">else</span></div><div class="line"><a name="l03327"></a><span class="lineno"> 3327</span>&#160;        {</div><div class="line"><a name="l03328"></a><span class="lineno"> 3328</span>&#160;          (void) <a class="code" href="page__buffer_8c.html#a95c9161ba3bb8e129b0c2407447c1b1b">pgbuf_set_lsa</a> (thread_p, addr-&gt;<a class="code" href="structlog__data__addr.html#a3c632dae3ad660a8572d9298716d9522">pgptr</a>, &amp;<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a73c801b0d3d19a743cf3d20ec7ae63c6">rcv_phase_lsa</a>);</div><div class="line"><a name="l03329"></a><span class="lineno"> 3329</span>&#160;        }</div><div class="line"><a name="l03330"></a><span class="lineno"> 3330</span>&#160;        }</div><div class="line"><a name="l03331"></a><span class="lineno"> 3331</span>&#160;    }</div><div class="line"><a name="l03332"></a><span class="lineno"> 3332</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l03333"></a><span class="lineno"> 3333</span>&#160;    {</div><div class="line"><a name="l03334"></a><span class="lineno"> 3334</span>&#160;      <span class="comment">/* </span></div><div class="line"><a name="l03335"></a><span class="lineno"> 3335</span>&#160;<span class="comment">       * Likely the system is not restarted</span></div><div class="line"><a name="l03336"></a><span class="lineno"> 3336</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l03337"></a><span class="lineno"> 3337</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="storage__common_8h.html#a467739272b1ee74686bae4be2354197a">LSA_GT</a> (&amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a5b128a08476a5b499cf82e3163e6d62b">tail_lsa</a>, page_lsa))</div><div class="line"><a name="l03338"></a><span class="lineno"> 3338</span>&#160;        {</div><div class="line"><a name="l03339"></a><span class="lineno"> 3339</span>&#160;          (void) <a class="code" href="page__buffer_8c.html#a95c9161ba3bb8e129b0c2407447c1b1b">pgbuf_set_lsa</a> (thread_p, addr-&gt;<a class="code" href="structlog__data__addr.html#a3c632dae3ad660a8572d9298716d9522">pgptr</a>, &amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a5b128a08476a5b499cf82e3163e6d62b">tail_lsa</a>);</div><div class="line"><a name="l03340"></a><span class="lineno"> 3340</span>&#160;        }</div><div class="line"><a name="l03341"></a><span class="lineno"> 3341</span>&#160;    }</div><div class="line"><a name="l03342"></a><span class="lineno"> 3342</span>&#160;    }</div><div class="line"><a name="l03343"></a><span class="lineno"> 3343</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l03344"></a><span class="lineno"> 3344</span>&#160;}</div><div class="line"><a name="l03345"></a><span class="lineno"> 3345</span>&#160;</div><div class="line"><a name="l03346"></a><span class="lineno"> 3346</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l03347"></a><span class="lineno"> 3347</span>&#160;<span class="comment"> * log_append_savepoint - DECLARE A USER SAVEPOINT</span></div><div class="line"><a name="l03348"></a><span class="lineno"> 3348</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l03349"></a><span class="lineno"> 3349</span>&#160;<span class="comment"> * return: LSA</span></div><div class="line"><a name="l03350"></a><span class="lineno"> 3350</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l03351"></a><span class="lineno"> 3351</span>&#160;<span class="comment"> *   savept_name(in): Name of the savepoint</span></div><div class="line"><a name="l03352"></a><span class="lineno"> 3352</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l03353"></a><span class="lineno"> 3353</span>&#160;<span class="comment"> * NOTE: A savepoint is established for the current transaction, so</span></div><div class="line"><a name="l03354"></a><span class="lineno"> 3354</span>&#160;<span class="comment"> *              that future transaction actions can be rolled back to this</span></div><div class="line"><a name="l03355"></a><span class="lineno"> 3355</span>&#160;<span class="comment"> *              established savepoint. We call this operation a partial abort</span></div><div class="line"><a name="l03356"></a><span class="lineno"> 3356</span>&#160;<span class="comment"> *              (rollback). That is, all database actions affected by the</span></div><div class="line"><a name="l03357"></a><span class="lineno"> 3357</span>&#160;<span class="comment"> *              transaction after the savepoint are undone, and all effects</span></div><div class="line"><a name="l03358"></a><span class="lineno"> 3358</span>&#160;<span class="comment"> *              of the transaction preceding the savepoint remain. The</span></div><div class="line"><a name="l03359"></a><span class="lineno"> 3359</span>&#160;<span class="comment"> *              transaction can then continue executing other database</span></div><div class="line"><a name="l03360"></a><span class="lineno"> 3360</span>&#160;<span class="comment"> *              statements. It is permissible to abort to the same savepoint</span></div><div class="line"><a name="l03361"></a><span class="lineno"> 3361</span>&#160;<span class="comment"> *              repeatedly within the same transaction.</span></div><div class="line"><a name="l03362"></a><span class="lineno"> 3362</span>&#160;<span class="comment"> *              If the same savepoint name is used in multiple savepoint</span></div><div class="line"><a name="l03363"></a><span class="lineno"> 3363</span>&#160;<span class="comment"> *              declarations within the same transaction, then only the latest</span></div><div class="line"><a name="l03364"></a><span class="lineno"> 3364</span>&#160;<span class="comment"> *              savepoint with that name is available for aborts and the</span></div><div class="line"><a name="l03365"></a><span class="lineno"> 3365</span>&#160;<span class="comment"> *              others are forgotten.</span></div><div class="line"><a name="l03366"></a><span class="lineno"> 3366</span>&#160;<span class="comment"> *              There are no limits on the number of savepoints that a</span></div><div class="line"><a name="l03367"></a><span class="lineno"> 3367</span>&#160;<span class="comment"> *              transaction can have.</span></div><div class="line"><a name="l03368"></a><span class="lineno"> 3368</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l03369"></a><span class="lineno"> 3369</span>&#160;<a class="code" href="structlog__lsa.html">LOG_LSA</a> *</div><div class="line"><a name="l03370"></a><span class="lineno"><a class="line" href="log__manager_8h.html#a0ee86d15ed1d1d8ba92e9cbdd43badf5"> 3370</a></span>&#160;<a class="code" href="log__manager_8c.html#a0ee86d15ed1d1d8ba92e9cbdd43badf5">log_append_savepoint</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <span class="keyword">const</span> <span class="keywordtype">char</span> *savept_name)</div><div class="line"><a name="l03371"></a><span class="lineno"> 3371</span>&#160;{</div><div class="line"><a name="l03372"></a><span class="lineno"> 3372</span>&#160;  <a class="code" href="structlog__rec__savept.html">LOG_REC_SAVEPT</a> *savept;   <span class="comment">/* A savept log record */</span></div><div class="line"><a name="l03373"></a><span class="lineno"> 3373</span>&#160;  <a class="code" href="structlog__tdes.html">LOG_TDES</a> *tdes;       <span class="comment">/* Transaction descriptor */</span></div><div class="line"><a name="l03374"></a><span class="lineno"> 3374</span>&#160;  <span class="keywordtype">int</span> length;           <span class="comment">/* Length of the name of the save point */</span></div><div class="line"><a name="l03375"></a><span class="lineno"> 3375</span>&#160;  <span class="keywordtype">int</span> tran_index;</div><div class="line"><a name="l03376"></a><span class="lineno"> 3376</span>&#160;  <span class="keywordtype">int</span> error_code;</div><div class="line"><a name="l03377"></a><span class="lineno"> 3377</span>&#160;  <a class="code" href="structlog__prior__node.html">LOG_PRIOR_NODE</a> *<a class="code" href="external_2include_2queue_8h.html#a465e28dbd1a1c60ff504d3ea275613ed">node</a>;</div><div class="line"><a name="l03378"></a><span class="lineno"> 3378</span>&#160;</div><div class="line"><a name="l03379"></a><span class="lineno"> 3379</span>&#160;  <span class="comment">/* Find transaction descriptor for current logging transaction */</span></div><div class="line"><a name="l03380"></a><span class="lineno"> 3380</span>&#160;</div><div class="line"><a name="l03381"></a><span class="lineno"> 3381</span>&#160;  <span class="comment">/* Vacuum workers cannot use save points. */</span></div><div class="line"><a name="l03382"></a><span class="lineno"> 3382</span>&#160;  <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (!<a class="code" href="vacuum_8h.html#ab0e1deb8da1aa663aa073b0ce78606a2">VACUUM_IS_THREAD_VACUUM</a> (thread_p));</div><div class="line"><a name="l03383"></a><span class="lineno"> 3383</span>&#160;</div><div class="line"><a name="l03384"></a><span class="lineno"> 3384</span>&#160;  tran_index = <a class="code" href="perf__monitor_8h.html#a55d27b01d605ba6ee2929ddfe8588320">LOG_FIND_THREAD_TRAN_INDEX</a> (thread_p);</div><div class="line"><a name="l03385"></a><span class="lineno"> 3385</span>&#160;  tdes = <a class="code" href="log__impl_8h.html#a08fee41cfcf592e8afdbc4988ffbc8e4">LOG_FIND_TDES</a> (tran_index);</div><div class="line"><a name="l03386"></a><span class="lineno"> 3386</span>&#160;  <span class="keywordflow">if</span> (tdes == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l03387"></a><span class="lineno"> 3387</span>&#160;    {</div><div class="line"><a name="l03388"></a><span class="lineno"> 3388</span>&#160;      <a class="code" href="error__manager_8c.html#afdaf87ce30f2f557802a185ab85b6599">er_set</a> (<a class="code" href="error__manager_8h.html#a5d0d456c474e11fc70779873a30a7432a3314630dd19f90a68274cf737092c9f2">ER_FATAL_ERROR_SEVERITY</a>, <a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <a class="code" href="error__code_8h.html#a4b8e41e78be77c579a2c58f5248fefe2">ER_LOG_UNKNOWN_TRANINDEX</a>, 1, tran_index);</div><div class="line"><a name="l03389"></a><span class="lineno"> 3389</span>&#160;      error_code = <a class="code" href="error__code_8h.html#a4b8e41e78be77c579a2c58f5248fefe2">ER_LOG_UNKNOWN_TRANINDEX</a>;</div><div class="line"><a name="l03390"></a><span class="lineno"> 3390</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03391"></a><span class="lineno"> 3391</span>&#160;    }</div><div class="line"><a name="l03392"></a><span class="lineno"> 3392</span>&#160;</div><div class="line"><a name="l03393"></a><span class="lineno"> 3393</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="log__impl_8h.html#aa81dc352329c9f96467c795c1547be74">LOG_ISTRAN_ACTIVE</a> (tdes))</div><div class="line"><a name="l03394"></a><span class="lineno"> 3394</span>&#160;    {</div><div class="line"><a name="l03395"></a><span class="lineno"> 3395</span>&#160;      <span class="comment">/* </span></div><div class="line"><a name="l03396"></a><span class="lineno"> 3396</span>&#160;<span class="comment">       * Error, a user savepoint cannot be added when the transaction is not</span></div><div class="line"><a name="l03397"></a><span class="lineno"> 3397</span>&#160;<span class="comment">       * active</span></div><div class="line"><a name="l03398"></a><span class="lineno"> 3398</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l03399"></a><span class="lineno"> 3399</span>&#160;      <a class="code" href="error__manager_8c.html#afdaf87ce30f2f557802a185ab85b6599">er_set</a> (<a class="code" href="error__manager_8h.html#a5d0d456c474e11fc70779873a30a7432a3314630dd19f90a68274cf737092c9f2">ER_FATAL_ERROR_SEVERITY</a>, <a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <a class="code" href="error__code_8h.html#afda48b732466fde2809e572b896f59f3">ER_LOG_CANNOT_ADD_SAVEPOINT</a>, 0);</div><div class="line"><a name="l03400"></a><span class="lineno"> 3400</span>&#160;      error_code = <a class="code" href="error__code_8h.html#afda48b732466fde2809e572b896f59f3">ER_LOG_CANNOT_ADD_SAVEPOINT</a>;</div><div class="line"><a name="l03401"></a><span class="lineno"> 3401</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03402"></a><span class="lineno"> 3402</span>&#160;    }</div><div class="line"><a name="l03403"></a><span class="lineno"> 3403</span>&#160;</div><div class="line"><a name="l03404"></a><span class="lineno"> 3404</span>&#160;  <span class="keywordflow">if</span> (savept_name == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l03405"></a><span class="lineno"> 3405</span>&#160;    {</div><div class="line"><a name="l03406"></a><span class="lineno"> 3406</span>&#160;      <a class="code" href="error__manager_8c.html#afdaf87ce30f2f557802a185ab85b6599">er_set</a> (<a class="code" href="error__manager_8h.html#a5d0d456c474e11fc70779873a30a7432a07ad8f9fda27124d297c94b7d3ea44e8">ER_ERROR_SEVERITY</a>, <a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <a class="code" href="error__code_8h.html#ad2e133a8a3c778d3231f733d9e9f960d">ER_LOG_NONAME_SAVEPOINT</a>, 0);</div><div class="line"><a name="l03407"></a><span class="lineno"> 3407</span>&#160;      error_code = <a class="code" href="error__code_8h.html#ad2e133a8a3c778d3231f733d9e9f960d">ER_LOG_NONAME_SAVEPOINT</a>;</div><div class="line"><a name="l03408"></a><span class="lineno"> 3408</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03409"></a><span class="lineno"> 3409</span>&#160;    }</div><div class="line"><a name="l03410"></a><span class="lineno"> 3410</span>&#160;</div><div class="line"><a name="l03411"></a><span class="lineno"> 3411</span>&#160;  length = (<a class="code" href="mprec_8c.html#a61569f2965b7a369eb10b6d75d410d11">int</a>) <a class="code" href="intl__support_8c.html#ab543901c3564a54b2450303d63374f55">strlen</a> (savept_name) + 1;</div><div class="line"><a name="l03412"></a><span class="lineno"> 3412</span>&#160;</div><div class="line"><a name="l03413"></a><span class="lineno"> 3413</span>&#160;  <a class="code" href="structnodeptr.html">node</a> =</div><div class="line"><a name="l03414"></a><span class="lineno"> 3414</span>&#160;    <a class="code" href="log__impl_8h.html#a2b616997f446dcb588a6addcc65cf5b7">prior_lsa_alloc_and_copy_data</a> (thread_p, <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7ae96755081dc4d3599f98356864dfd7e0">LOG_SAVEPOINT</a>, <a class="code" href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2ba6ea83d694355ec2c529960461a086f26">RV_NOT_DEFINED</a>, <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, length, (<span class="keywordtype">char</span> *) savept_name, 0,</div><div class="line"><a name="l03415"></a><span class="lineno"> 3415</span>&#160;                   (<span class="keywordtype">char</span> *) <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l03416"></a><span class="lineno"> 3416</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="structnodeptr.html">node</a> == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l03417"></a><span class="lineno"> 3417</span>&#160;    {</div><div class="line"><a name="l03418"></a><span class="lineno"> 3418</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03419"></a><span class="lineno"> 3419</span>&#160;    }</div><div class="line"><a name="l03420"></a><span class="lineno"> 3420</span>&#160;</div><div class="line"><a name="l03421"></a><span class="lineno"> 3421</span>&#160;  savept = (<a class="code" href="structlog__rec__savept.html">LOG_REC_SAVEPT</a> *) <a class="code" href="structnodeptr.html">node</a>-&gt;data_header;</div><div class="line"><a name="l03422"></a><span class="lineno"> 3422</span>&#160;  savept-&gt;<a class="code" href="structlog__rec__savept.html#af4be23754ed4d5067cff4a7e2bc4f726">length</a> = length;</div><div class="line"><a name="l03423"></a><span class="lineno"> 3423</span>&#160;  <a class="code" href="storage__common_8h.html#a4c9bc15296fe6728cf0351726cc6ad09">LSA_COPY</a> (&amp;savept-&gt;<a class="code" href="structlog__rec__savept.html#aa2bda94b58670443b2a14129a78a06fb">prv_savept</a>, &amp;tdes-&gt;<a class="code" href="structlog__tdes.html#ac2dac7e98c4049c6787fccd7faf3d92a">savept_lsa</a>);</div><div class="line"><a name="l03424"></a><span class="lineno"> 3424</span>&#160;</div><div class="line"><a name="l03425"></a><span class="lineno"> 3425</span>&#160;  (void) <a class="code" href="log__impl_8h.html#a8a3ce7b7aa59fe26c04eca3577e434e8">prior_lsa_next_record</a> (thread_p, <a class="code" href="structnodeptr.html">node</a>, tdes);</div><div class="line"><a name="l03426"></a><span class="lineno"> 3426</span>&#160;</div><div class="line"><a name="l03427"></a><span class="lineno"> 3427</span>&#160;  <a class="code" href="storage__common_8h.html#a4c9bc15296fe6728cf0351726cc6ad09">LSA_COPY</a> (&amp;tdes-&gt;<a class="code" href="structlog__tdes.html#ac2dac7e98c4049c6787fccd7faf3d92a">savept_lsa</a>, &amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a5b128a08476a5b499cf82e3163e6d62b">tail_lsa</a>);</div><div class="line"><a name="l03428"></a><span class="lineno"> 3428</span>&#160;</div><div class="line"><a name="l03429"></a><span class="lineno"> 3429</span>&#160;  <a class="code" href="perf__monitor_8h.html#af4850f6b1c604051a0aa7704883eeb07">perfmon_inc_stat</a> (thread_p, <a class="code" href="perf__monitor_8h.html#a165b76d14ae9e30731ed3ca4cf856903a45f0a392cf22a81f266b6b6c70bd8a60">PSTAT_TRAN_NUM_SAVEPOINTS</a>);</div><div class="line"><a name="l03430"></a><span class="lineno"> 3430</span>&#160;</div><div class="line"><a name="l03431"></a><span class="lineno"> 3431</span>&#160;  <span class="keywordflow">return</span> &amp;tdes-&gt;<a class="code" href="structlog__tdes.html#ac2dac7e98c4049c6787fccd7faf3d92a">savept_lsa</a>;</div><div class="line"><a name="l03432"></a><span class="lineno"> 3432</span>&#160;}</div><div class="line"><a name="l03433"></a><span class="lineno"> 3433</span>&#160;</div><div class="line"><a name="l03434"></a><span class="lineno"> 3434</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l03435"></a><span class="lineno"> 3435</span>&#160;<span class="comment"> * log_find_savept_lsa - FIND LSA ADDRESS OF GIVEN SAVEPOINT</span></div><div class="line"><a name="l03436"></a><span class="lineno"> 3436</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l03437"></a><span class="lineno"> 3437</span>&#160;<span class="comment"> * return: savept_lsa or NULL</span></div><div class="line"><a name="l03438"></a><span class="lineno"> 3438</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l03439"></a><span class="lineno"> 3439</span>&#160;<span class="comment"> *   savept_name(in):  Name of the savept</span></div><div class="line"><a name="l03440"></a><span class="lineno"> 3440</span>&#160;<span class="comment"> *   tdes(in): State structure of transaction of the log record  or NULL</span></div><div class="line"><a name="l03441"></a><span class="lineno"> 3441</span>&#160;<span class="comment"> *                when unknown</span></div><div class="line"><a name="l03442"></a><span class="lineno"> 3442</span>&#160;<span class="comment"> *   savept_lsa(in/out): Address of the savept_name</span></div><div class="line"><a name="l03443"></a><span class="lineno"> 3443</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l03444"></a><span class="lineno"> 3444</span>&#160;<span class="comment"> * NOTE:The LSA address of the given savept_name is found.</span></div><div class="line"><a name="l03445"></a><span class="lineno"> 3445</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l03446"></a><span class="lineno"> 3446</span>&#160;<span class="keyword">static</span> <a class="code" href="structlog__lsa.html">LOG_LSA</a> *</div><div class="line"><a name="l03447"></a><span class="lineno"> 3447</span>&#160;log_get_savepoint_lsa (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <span class="keyword">const</span> <span class="keywordtype">char</span> *savept_name, <a class="code" href="structlog__tdes.html">LOG_TDES</a> * tdes, <a class="code" href="structlog__lsa.html">LOG_LSA</a> * savept_lsa)</div><div class="line"><a name="l03448"></a><span class="lineno"> 3448</span>&#160;{</div><div class="line"><a name="l03449"></a><span class="lineno"> 3449</span>&#160;  <span class="keywordtype">char</span> *<a class="code" href="expat_8h.html#aaf0497a3bd20a0066017546af6bf80be">ptr</a>;            <span class="comment">/* Pointer to savepoint name */</span></div><div class="line"><a name="l03450"></a><span class="lineno"> 3450</span>&#160;  <span class="keywordtype">char</span> log_pgbuf[<a class="code" href="storage__common_8h.html#a0a3c7db68a92df0d34666257bb0f17dd">IO_MAX_PAGE_SIZE</a> + <a class="code" href="memory__alloc_8h.html#a81d7e4971ffc775a379eeb4c65fa30f8">MAX_ALIGNMENT</a>], *aligned_log_pgbuf;</div><div class="line"><a name="l03451"></a><span class="lineno"> 3451</span>&#160;  <a class="code" href="structlog__page.html">LOG_PAGE</a> *log_pgptr = <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;   <span class="comment">/* Log page pointer where a savepoint log record is located */</span></div><div class="line"><a name="l03452"></a><span class="lineno"> 3452</span>&#160;  <a class="code" href="structlog__rec__header.html">LOG_RECORD_HEADER</a> *log_rec;   <span class="comment">/* Pointer to log record */</span></div><div class="line"><a name="l03453"></a><span class="lineno"> 3453</span>&#160;  <a class="code" href="structlog__rec__savept.html">LOG_REC_SAVEPT</a> *savept;   <span class="comment">/* A savepoint log record */</span></div><div class="line"><a name="l03454"></a><span class="lineno"> 3454</span>&#160;  <a class="code" href="structlog__lsa.html">LOG_LSA</a> prev_lsa;     <span class="comment">/* Previous savepoint */</span></div><div class="line"><a name="l03455"></a><span class="lineno"> 3455</span>&#160;  <a class="code" href="structlog__lsa.html">LOG_LSA</a> <a class="code" href="structlog__lsa.html">log_lsa</a>;</div><div class="line"><a name="l03456"></a><span class="lineno"> 3456</span>&#160;  <span class="keywordtype">int</span> length;           <span class="comment">/* Length of savepoint name */</span></div><div class="line"><a name="l03457"></a><span class="lineno"> 3457</span>&#160;  <span class="keywordtype">bool</span> found = <span class="keyword">false</span>;</div><div class="line"><a name="l03458"></a><span class="lineno"> 3458</span>&#160;</div><div class="line"><a name="l03459"></a><span class="lineno"> 3459</span>&#160;  aligned_log_pgbuf = <a class="code" href="memory__alloc_8h.html#a79781c0dbfdd9510d275cba54f1f384f">PTR_ALIGN</a> (log_pgbuf, <a class="code" href="memory__alloc_8h.html#a81d7e4971ffc775a379eeb4c65fa30f8">MAX_ALIGNMENT</a>);</div><div class="line"><a name="l03460"></a><span class="lineno"> 3460</span>&#160;</div><div class="line"><a name="l03461"></a><span class="lineno"> 3461</span>&#160;  <span class="comment">/* Find the savepoint LSA, for the given savepoint name */</span></div><div class="line"><a name="l03462"></a><span class="lineno"> 3462</span>&#160;  <a class="code" href="storage__common_8h.html#a4c9bc15296fe6728cf0351726cc6ad09">LSA_COPY</a> (&amp;prev_lsa, &amp;tdes-&gt;<a class="code" href="structlog__tdes.html#ac2dac7e98c4049c6787fccd7faf3d92a">savept_lsa</a>);</div><div class="line"><a name="l03463"></a><span class="lineno"> 3463</span>&#160;</div><div class="line"><a name="l03464"></a><span class="lineno"> 3464</span>&#160;  log_pgptr = (<a class="code" href="structlog__page.html">LOG_PAGE</a> *) aligned_log_pgbuf;</div><div class="line"><a name="l03465"></a><span class="lineno"> 3465</span>&#160;</div><div class="line"><a name="l03466"></a><span class="lineno"> 3466</span>&#160;  <span class="keywordflow">while</span> (!<a class="code" href="storage__common_8h.html#a26dd766712df5b5c4fcd158f571a75e4">LSA_ISNULL</a> (&amp;prev_lsa) &amp;&amp; found == <span class="keyword">false</span>)</div><div class="line"><a name="l03467"></a><span class="lineno"> 3467</span>&#160;    {</div><div class="line"><a name="l03468"></a><span class="lineno"> 3468</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="log__impl_8h.html#ac67cba94ac6c10da3ae0ab474155ea1a">logpb_fetch_page</a> (thread_p, &amp;prev_lsa, <a class="code" href="log__impl_8h.html#ab33fe5f69028f102e9910294e97ccd6babc4379db94a7ff5ff8491988a7c28bc1">LOG_CS_FORCE_USE</a>, log_pgptr) != <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>)</div><div class="line"><a name="l03469"></a><span class="lineno"> 3469</span>&#160;    {</div><div class="line"><a name="l03470"></a><span class="lineno"> 3470</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l03471"></a><span class="lineno"> 3471</span>&#160;    }</div><div class="line"><a name="l03472"></a><span class="lineno"> 3472</span>&#160;</div><div class="line"><a name="l03473"></a><span class="lineno"> 3473</span>&#160;      savept_lsa-&gt;<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a> = <a class="code" href="structlog__lsa.html">log_lsa</a>.<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a> = prev_lsa.<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a>;</div><div class="line"><a name="l03474"></a><span class="lineno"> 3474</span>&#160;</div><div class="line"><a name="l03475"></a><span class="lineno"> 3475</span>&#160;      <span class="keywordflow">while</span> (found == <span class="keyword">false</span> &amp;&amp; prev_lsa.<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a> == <a class="code" href="structlog__lsa.html">log_lsa</a>.<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a>)</div><div class="line"><a name="l03476"></a><span class="lineno"> 3476</span>&#160;    {</div><div class="line"><a name="l03477"></a><span class="lineno"> 3477</span>&#160;      <span class="comment">/* Find the savepoint record */</span></div><div class="line"><a name="l03478"></a><span class="lineno"> 3478</span>&#160;      savept_lsa-&gt;<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a> = <a class="code" href="structlog__lsa.html">log_lsa</a>.<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a> = prev_lsa.<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a>;</div><div class="line"><a name="l03479"></a><span class="lineno"> 3479</span>&#160;      log_rec = <a class="code" href="log__impl_8h.html#ae37437431a8ea417a8e768ed5fa8f5f6">LOG_GET_LOG_RECORD_HEADER</a> (log_pgptr, &amp;<a class="code" href="structlog__lsa.html">log_lsa</a>);</div><div class="line"><a name="l03480"></a><span class="lineno"> 3480</span>&#160;      <span class="keywordflow">if</span> (log_rec-&gt;<a class="code" href="structlog__rec__header.html#aa9be1266bf7fdca13a0a789dc5ae11bb">type</a> != <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7ae96755081dc4d3599f98356864dfd7e0">LOG_SAVEPOINT</a> &amp;&amp; log_rec-&gt;<a class="code" href="structlog__rec__header.html#a210194ed9baf246456495d89fb411725">trid</a> != tdes-&gt;<a class="code" href="structlog__tdes.html#a3baeff284ed2167bcef74c5ef34d4f3b">trid</a>)</div><div class="line"><a name="l03481"></a><span class="lineno"> 3481</span>&#160;        {</div><div class="line"><a name="l03482"></a><span class="lineno"> 3482</span>&#160;          <span class="comment">/* System error... */</span></div><div class="line"><a name="l03483"></a><span class="lineno"> 3483</span>&#160;          <a class="code" href="error__manager_8h.html#a075eb8873354909bbe8edafa0f18f58c">er_log_debug</a> (<a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <span class="stringliteral">&quot;log_find_savept_lsa: Corrupted log rec&quot;</span>);</div><div class="line"><a name="l03484"></a><span class="lineno"> 3484</span>&#160;          <a class="code" href="storage__common_8h.html#a6a4baec606189dd320678e8f412ca957">LSA_SET_NULL</a> (&amp;prev_lsa);</div><div class="line"><a name="l03485"></a><span class="lineno"> 3485</span>&#160;          <span class="keywordflow">break</span>;</div><div class="line"><a name="l03486"></a><span class="lineno"> 3486</span>&#160;        }</div><div class="line"><a name="l03487"></a><span class="lineno"> 3487</span>&#160;</div><div class="line"><a name="l03488"></a><span class="lineno"> 3488</span>&#160;      <span class="comment">/* Advance the pointer to read the savepoint log record */</span></div><div class="line"><a name="l03489"></a><span class="lineno"> 3489</span>&#160;</div><div class="line"><a name="l03490"></a><span class="lineno"> 3490</span>&#160;      <a class="code" href="log__impl_8h.html#afdaa9fdf7d83212b3eec2d515e807686">LOG_READ_ADD_ALIGN</a> (thread_p, <span class="keyword">sizeof</span> (*log_rec), &amp;<a class="code" href="structlog__lsa.html">log_lsa</a>, log_pgptr);</div><div class="line"><a name="l03491"></a><span class="lineno"> 3491</span>&#160;      <a class="code" href="log__impl_8h.html#a108c8143796ad50c65f64d4a483e9453">LOG_READ_ADVANCE_WHEN_DOESNT_FIT</a> (thread_p, <span class="keyword">sizeof</span> (*savept), &amp;<a class="code" href="structlog__lsa.html">log_lsa</a>, log_pgptr);</div><div class="line"><a name="l03492"></a><span class="lineno"> 3492</span>&#160;</div><div class="line"><a name="l03493"></a><span class="lineno"> 3493</span>&#160;      savept = (<a class="code" href="structlog__rec__savept.html">LOG_REC_SAVEPT</a> *) ((<span class="keywordtype">char</span> *) log_pgptr-&gt;<a class="code" href="structlog__page.html#a9b51b4623cdb8d1686f6f8fb64bc9ee2">area</a> + <a class="code" href="structlog__lsa.html">log_lsa</a>.<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a>);</div><div class="line"><a name="l03494"></a><span class="lineno"> 3494</span>&#160;      <a class="code" href="storage__common_8h.html#a4c9bc15296fe6728cf0351726cc6ad09">LSA_COPY</a> (&amp;prev_lsa, &amp;savept-&gt;<a class="code" href="structlog__rec__savept.html#aa2bda94b58670443b2a14129a78a06fb">prv_savept</a>);</div><div class="line"><a name="l03495"></a><span class="lineno"> 3495</span>&#160;      length = savept-&gt;<a class="code" href="structlog__rec__savept.html#af4be23754ed4d5067cff4a7e2bc4f726">length</a>;</div><div class="line"><a name="l03496"></a><span class="lineno"> 3496</span>&#160;</div><div class="line"><a name="l03497"></a><span class="lineno"> 3497</span>&#160;      <a class="code" href="log__impl_8h.html#afdaa9fdf7d83212b3eec2d515e807686">LOG_READ_ADD_ALIGN</a> (thread_p, <span class="keyword">sizeof</span> (*savept), &amp;<a class="code" href="structlog__lsa.html">log_lsa</a>, log_pgptr);</div><div class="line"><a name="l03498"></a><span class="lineno"> 3498</span>&#160;      <span class="comment">/* </span></div><div class="line"><a name="l03499"></a><span class="lineno"> 3499</span>&#160;<span class="comment">       * Is the name contained in only one buffer, or in several buffers</span></div><div class="line"><a name="l03500"></a><span class="lineno"> 3500</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l03501"></a><span class="lineno"> 3501</span>&#160;</div><div class="line"><a name="l03502"></a><span class="lineno"> 3502</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="structlog__lsa.html">log_lsa</a>.<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a> + length &lt; (<span class="keywordtype">int</span>) <a class="code" href="log__impl_8h.html#a7790a20af76ed5282450723f2e09c4e2">LOGAREA_SIZE</a>)</div><div class="line"><a name="l03503"></a><span class="lineno"> 3503</span>&#160;        {</div><div class="line"><a name="l03504"></a><span class="lineno"> 3504</span>&#160;          <span class="comment">/* Savepoint name is in one buffer */</span></div><div class="line"><a name="l03505"></a><span class="lineno"> 3505</span>&#160;          <a class="code" href="expat_8h.html#aaf0497a3bd20a0066017546af6bf80be">ptr</a> = (<span class="keywordtype">char</span> *) log_pgptr-&gt;<a class="code" href="structlog__page.html#a9b51b4623cdb8d1686f6f8fb64bc9ee2">area</a> + <a class="code" href="structlog__lsa.html">log_lsa</a>.<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a>;</div><div class="line"><a name="l03506"></a><span class="lineno"> 3506</span>&#160;          <a class="code" href="cubrid__data__seek__test_8php.html#a7bf795f554c1ff05baccf023cc804198">if</a> (strcmp (savept_name, <a class="code" href="expat_8h.html#aaf0497a3bd20a0066017546af6bf80be">ptr</a>) == 0)</div><div class="line"><a name="l03507"></a><span class="lineno"> 3507</span>&#160;        {</div><div class="line"><a name="l03508"></a><span class="lineno"> 3508</span>&#160;          found = <span class="keyword">true</span>;</div><div class="line"><a name="l03509"></a><span class="lineno"> 3509</span>&#160;        }</div><div class="line"><a name="l03510"></a><span class="lineno"> 3510</span>&#160;        }</div><div class="line"><a name="l03511"></a><span class="lineno"> 3511</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l03512"></a><span class="lineno"> 3512</span>&#160;        {</div><div class="line"><a name="l03513"></a><span class="lineno"> 3513</span>&#160;          <span class="comment">/* Need to copy the data into a contiguous area */</span></div><div class="line"><a name="l03514"></a><span class="lineno"> 3514</span>&#160;          <span class="keywordtype">int</span> area_offset;  <span class="comment">/* The area offset */</span></div><div class="line"><a name="l03515"></a><span class="lineno"> 3515</span>&#160;          <span class="keywordtype">int</span> remains_length;   <span class="comment">/* Length of data that remains to be copied */</span></div><div class="line"><a name="l03516"></a><span class="lineno"> 3516</span>&#160;          <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> copy_length; <span class="comment">/* Length to copy into area */</span></div><div class="line"><a name="l03517"></a><span class="lineno"> 3517</span>&#160;</div><div class="line"><a name="l03518"></a><span class="lineno"> 3518</span>&#160;          <a class="code" href="expat_8h.html#aaf0497a3bd20a0066017546af6bf80be">ptr</a> = (<span class="keywordtype">char</span> *) <a class="code" href="memory__alloc_8h.html#a8b903d0a51cce71105b6a706159717e4">db_private_alloc</a> (thread_p, length);</div><div class="line"><a name="l03519"></a><span class="lineno"> 3519</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="expat_8h.html#aaf0497a3bd20a0066017546af6bf80be">ptr</a> == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l03520"></a><span class="lineno"> 3520</span>&#160;        {</div><div class="line"><a name="l03521"></a><span class="lineno"> 3521</span>&#160;          <a class="code" href="storage__common_8h.html#a6a4baec606189dd320678e8f412ca957">LSA_SET_NULL</a> (&amp;prev_lsa);</div><div class="line"><a name="l03522"></a><span class="lineno"> 3522</span>&#160;          <span class="keywordflow">break</span>;</div><div class="line"><a name="l03523"></a><span class="lineno"> 3523</span>&#160;        }</div><div class="line"><a name="l03524"></a><span class="lineno"> 3524</span>&#160;          <span class="comment">/* Copy the name */</span></div><div class="line"><a name="l03525"></a><span class="lineno"> 3525</span>&#160;          remains_length = length;</div><div class="line"><a name="l03526"></a><span class="lineno"> 3526</span>&#160;          area_offset = 0;</div><div class="line"><a name="l03527"></a><span class="lineno"> 3527</span>&#160;          <span class="keywordflow">while</span> (remains_length &gt; 0)</div><div class="line"><a name="l03528"></a><span class="lineno"> 3528</span>&#160;        {</div><div class="line"><a name="l03529"></a><span class="lineno"> 3529</span>&#160;          <a class="code" href="log__impl_8h.html#a108c8143796ad50c65f64d4a483e9453">LOG_READ_ADVANCE_WHEN_DOESNT_FIT</a> (thread_p, 0, &amp;<a class="code" href="structlog__lsa.html">log_lsa</a>, log_pgptr);</div><div class="line"><a name="l03530"></a><span class="lineno"> 3530</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="structlog__lsa.html">log_lsa</a>.<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a> + remains_length &lt; (<span class="keywordtype">int</span>) <a class="code" href="log__impl_8h.html#a7790a20af76ed5282450723f2e09c4e2">LOGAREA_SIZE</a>)</div><div class="line"><a name="l03531"></a><span class="lineno"> 3531</span>&#160;            {</div><div class="line"><a name="l03532"></a><span class="lineno"> 3532</span>&#160;              copy_length = remains_length;</div><div class="line"><a name="l03533"></a><span class="lineno"> 3533</span>&#160;            }</div><div class="line"><a name="l03534"></a><span class="lineno"> 3534</span>&#160;          <span class="keywordflow">else</span></div><div class="line"><a name="l03535"></a><span class="lineno"> 3535</span>&#160;            {</div><div class="line"><a name="l03536"></a><span class="lineno"> 3536</span>&#160;              copy_length = <a class="code" href="log__impl_8h.html#a7790a20af76ed5282450723f2e09c4e2">LOGAREA_SIZE</a> - (<a class="code" href="mprec_8c.html#a61569f2965b7a369eb10b6d75d410d11">int</a>) (<a class="code" href="structlog__lsa.html">log_lsa</a>.<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a>);</div><div class="line"><a name="l03537"></a><span class="lineno"> 3537</span>&#160;            }</div><div class="line"><a name="l03538"></a><span class="lineno"> 3538</span>&#160;</div><div class="line"><a name="l03539"></a><span class="lineno"> 3539</span>&#160;          memcpy (<a class="code" href="expat_8h.html#aaf0497a3bd20a0066017546af6bf80be">ptr</a> + area_offset, (<span class="keywordtype">char</span> *) log_pgptr-&gt;<a class="code" href="structlog__page.html#a9b51b4623cdb8d1686f6f8fb64bc9ee2">area</a> + <a class="code" href="structlog__lsa.html">log_lsa</a>.<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a>, copy_length);</div><div class="line"><a name="l03540"></a><span class="lineno"> 3540</span>&#160;          remains_length -= copy_length;</div><div class="line"><a name="l03541"></a><span class="lineno"> 3541</span>&#160;          area_offset += copy_length;</div><div class="line"><a name="l03542"></a><span class="lineno"> 3542</span>&#160;          <a class="code" href="structlog__lsa.html">log_lsa</a>.<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a> += copy_length;</div><div class="line"><a name="l03543"></a><span class="lineno"> 3543</span>&#160;        }</div><div class="line"><a name="l03544"></a><span class="lineno"> 3544</span>&#160;          <span class="keywordflow">if</span> (strcmp (savept_name, <a class="code" href="expat_8h.html#aaf0497a3bd20a0066017546af6bf80be">ptr</a>) == 0)</div><div class="line"><a name="l03545"></a><span class="lineno"> 3545</span>&#160;        {</div><div class="line"><a name="l03546"></a><span class="lineno"> 3546</span>&#160;          found = <span class="keyword">true</span>;</div><div class="line"><a name="l03547"></a><span class="lineno"> 3547</span>&#160;        }</div><div class="line"><a name="l03548"></a><span class="lineno"> 3548</span>&#160;          <a class="code" href="memory__alloc_8h.html#a8a4aab7481b74342b82c75f8e028bcf8">db_private_free_and_init</a> (thread_p, <a class="code" href="expat_8h.html#aaf0497a3bd20a0066017546af6bf80be">ptr</a>);</div><div class="line"><a name="l03549"></a><span class="lineno"> 3549</span>&#160;        }</div><div class="line"><a name="l03550"></a><span class="lineno"> 3550</span>&#160;    }</div><div class="line"><a name="l03551"></a><span class="lineno"> 3551</span>&#160;    }</div><div class="line"><a name="l03552"></a><span class="lineno"> 3552</span>&#160;</div><div class="line"><a name="l03553"></a><span class="lineno"> 3553</span>&#160;  <span class="keywordflow">if</span> (found)</div><div class="line"><a name="l03554"></a><span class="lineno"> 3554</span>&#160;    {</div><div class="line"><a name="l03555"></a><span class="lineno"> 3555</span>&#160;      <span class="keywordflow">return</span> savept_lsa;</div><div class="line"><a name="l03556"></a><span class="lineno"> 3556</span>&#160;    }</div><div class="line"><a name="l03557"></a><span class="lineno"> 3557</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l03558"></a><span class="lineno"> 3558</span>&#160;    {</div><div class="line"><a name="l03559"></a><span class="lineno"> 3559</span>&#160;      <a class="code" href="storage__common_8h.html#a6a4baec606189dd320678e8f412ca957">LSA_SET_NULL</a> (savept_lsa);</div><div class="line"><a name="l03560"></a><span class="lineno"> 3560</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03561"></a><span class="lineno"> 3561</span>&#160;    }</div><div class="line"><a name="l03562"></a><span class="lineno"> 3562</span>&#160;}</div><div class="line"><a name="l03563"></a><span class="lineno"> 3563</span>&#160;</div><div class="line"><a name="l03564"></a><span class="lineno"> 3564</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l03565"></a><span class="lineno"> 3565</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l03566"></a><span class="lineno"> 3566</span>&#160;<span class="comment"> *       FUNCTIONS RELATED TO TERMINATION OF TRANSACTIONS AND OPERATIONS</span></div><div class="line"><a name="l03567"></a><span class="lineno"> 3567</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l03568"></a><span class="lineno"> 3568</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l03569"></a><span class="lineno"> 3569</span>&#160;</div><div class="line"><a name="l03570"></a><span class="lineno"> 3570</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l03571"></a><span class="lineno"> 3571</span>&#160;<span class="comment"> * log_sysop_end_type_string () - string for log sys op end type</span></div><div class="line"><a name="l03572"></a><span class="lineno"> 3572</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l03573"></a><span class="lineno"> 3573</span>&#160;<span class="comment"> * return        : string for log sys op end type</span></div><div class="line"><a name="l03574"></a><span class="lineno"> 3574</span>&#160;<span class="comment"> * end_type (in) : log sys op end type</span></div><div class="line"><a name="l03575"></a><span class="lineno"> 3575</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l03576"></a><span class="lineno"> 3576</span>&#160;<span class="keyword">const</span> <span class="keywordtype">char</span> *</div><div class="line"><a name="l03577"></a><span class="lineno"><a class="line" href="log__manager_8h.html#aaa9c09a7c8de8d4a759762633f07c8a1"> 3577</a></span>&#160;<a class="code" href="log__manager_8c.html#aaa9c09a7c8de8d4a759762633f07c8a1">log_sysop_end_type_string</a> (<a class="code" href="log__impl_8h.html#ad2c80360c1561744c3631fa2570ff1c4">LOG_SYSOP_END_TYPE</a> end_type)</div><div class="line"><a name="l03578"></a><span class="lineno"> 3578</span>&#160;{</div><div class="line"><a name="l03579"></a><span class="lineno"> 3579</span>&#160;  <span class="keywordflow">switch</span> (end_type)</div><div class="line"><a name="l03580"></a><span class="lineno"> 3580</span>&#160;    {</div><div class="line"><a name="l03581"></a><span class="lineno"> 3581</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#a24797b2fe67e0ec8631d7a92fbef25c9a9e1c6cb1f049797b7b3f9230308663a3">LOG_SYSOP_END_COMMIT</a>:</div><div class="line"><a name="l03582"></a><span class="lineno"> 3582</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;LOG_SYSOP_END_COMMIT&quot;</span>;</div><div class="line"><a name="l03583"></a><span class="lineno"> 3583</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#a24797b2fe67e0ec8631d7a92fbef25c9a9530c67a9b21ab7a54d7c906f900a247">LOG_SYSOP_END_ABORT</a>:</div><div class="line"><a name="l03584"></a><span class="lineno"> 3584</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;LOG_SYSOP_END_ABORT&quot;</span>;</div><div class="line"><a name="l03585"></a><span class="lineno"> 3585</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#a24797b2fe67e0ec8631d7a92fbef25c9ac4566a4bae57d0a42fa6e37cc65e5329">LOG_SYSOP_END_LOGICAL_UNDO</a>:</div><div class="line"><a name="l03586"></a><span class="lineno"> 3586</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;LOG_SYSOP_END_LOGICAL_UNDO&quot;</span>;</div><div class="line"><a name="l03587"></a><span class="lineno"> 3587</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#a24797b2fe67e0ec8631d7a92fbef25c9a571011a0354832edf02d40490f512716">LOG_SYSOP_END_LOGICAL_MVCC_UNDO</a>:</div><div class="line"><a name="l03588"></a><span class="lineno"> 3588</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;LOG_SYSOP_END_LOGICAL_MVCC_UNDO&quot;</span>;</div><div class="line"><a name="l03589"></a><span class="lineno"> 3589</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#a24797b2fe67e0ec8631d7a92fbef25c9a69f84e9574e7f583c88733bdea3a415f">LOG_SYSOP_END_LOGICAL_COMPENSATE</a>:</div><div class="line"><a name="l03590"></a><span class="lineno"> 3590</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;LOG_SYSOP_END_LOGICAL_COMPENSATE&quot;</span>;</div><div class="line"><a name="l03591"></a><span class="lineno"> 3591</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#a24797b2fe67e0ec8631d7a92fbef25c9ada41432cf121d5aafecae01984edd8e7">LOG_SYSOP_END_LOGICAL_RUN_POSTPONE</a>:</div><div class="line"><a name="l03592"></a><span class="lineno"> 3592</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;LOG_SYSOP_END_LOGICAL_RUN_POSTPONE&quot;</span>;</div><div class="line"><a name="l03593"></a><span class="lineno"> 3593</span>&#160;    <span class="keywordflow">default</span>:</div><div class="line"><a name="l03594"></a><span class="lineno"> 3594</span>&#160;      <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (<span class="keyword">false</span>);</div><div class="line"><a name="l03595"></a><span class="lineno"> 3595</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;UNKNOWN LOG_SYSOP_END_TYPE&quot;</span>;</div><div class="line"><a name="l03596"></a><span class="lineno"> 3596</span>&#160;    }</div><div class="line"><a name="l03597"></a><span class="lineno"> 3597</span>&#160;}</div><div class="line"><a name="l03598"></a><span class="lineno"> 3598</span>&#160;</div><div class="line"><a name="l03599"></a><span class="lineno"> 3599</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l03600"></a><span class="lineno"> 3600</span>&#160;<span class="comment"> * log_sysop_start () - Start a new system operation. This can also be nested in another system operation.</span></div><div class="line"><a name="l03601"></a><span class="lineno"> 3601</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l03602"></a><span class="lineno"> 3602</span>&#160;<span class="comment"> * return    : Error code.</span></div><div class="line"><a name="l03603"></a><span class="lineno"> 3603</span>&#160;<span class="comment"> * thread_p (in) : Thread entry.</span></div><div class="line"><a name="l03604"></a><span class="lineno"> 3604</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l03605"></a><span class="lineno"> 3605</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l03606"></a><span class="lineno"><a class="line" href="log__manager_8h.html#acbc3a63215e8924ed23841fb2321cd78"> 3606</a></span>&#160;<a class="code" href="log__manager_8c.html#acbc3a63215e8924ed23841fb2321cd78">log_sysop_start</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p)</div><div class="line"><a name="l03607"></a><span class="lineno"> 3607</span>&#160;{</div><div class="line"><a name="l03608"></a><span class="lineno"> 3608</span>&#160;  <a class="code" href="structlog__tdes.html">LOG_TDES</a> *tdes = <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03609"></a><span class="lineno"> 3609</span>&#160;  <span class="keywordtype">int</span> tran_index;</div><div class="line"><a name="l03610"></a><span class="lineno"> 3610</span>&#160;  <span class="keywordtype">int</span> r = <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>;</div><div class="line"><a name="l03611"></a><span class="lineno"> 3611</span>&#160;</div><div class="line"><a name="l03612"></a><span class="lineno"> 3612</span>&#160;  tran_index = <a class="code" href="perf__monitor_8h.html#a55d27b01d605ba6ee2929ddfe8588320">LOG_FIND_THREAD_TRAN_INDEX</a> (thread_p);</div><div class="line"><a name="l03613"></a><span class="lineno"> 3613</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="vacuum_8h.html#ab0e1deb8da1aa663aa073b0ce78606a2">VACUUM_IS_THREAD_VACUUM</a> (thread_p))</div><div class="line"><a name="l03614"></a><span class="lineno"> 3614</span>&#160;    {</div><div class="line"><a name="l03615"></a><span class="lineno"> 3615</span>&#160;      <span class="comment">/* System operations must be isolated and allow undo. It is impossible to use system tdes for more than one</span></div><div class="line"><a name="l03616"></a><span class="lineno"> 3616</span>&#160;<span class="comment">       * thread, so vacuum workers use a reserved tdes instead. */</span></div><div class="line"><a name="l03617"></a><span class="lineno"> 3617</span>&#160;      tdes = <a class="code" href="vacuum_8h.html#a3bae574be1c3bf9a786050397a1cde68">vacuum_get_worker_tdes</a> (thread_p);</div><div class="line"><a name="l03618"></a><span class="lineno"> 3618</span>&#160;</div><div class="line"><a name="l03619"></a><span class="lineno"> 3619</span>&#160;      <span class="comment">/* Vacuum worker state should be either VACUUM_WORKER_STATE_EXECUTE or VACUUM_WORKER_STATE_TOPOP (or</span></div><div class="line"><a name="l03620"></a><span class="lineno"> 3620</span>&#160;<span class="comment">       * VACUUM_WORKER_STATE_RECOVERY during database recovery phase). */</span></div><div class="line"><a name="l03621"></a><span class="lineno"> 3621</span>&#160;      <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (<a class="code" href="vacuum_8h.html#af90b05fa6c5fb7fbc6797de411b6d466">vacuum_worker_state_is_execute</a> (thread_p) || <a class="code" href="vacuum_8h.html#a6a1dc228ca433bf85d100084b318153f">vacuum_worker_state_is_topop</a> (thread_p)</div><div class="line"><a name="l03622"></a><span class="lineno"> 3622</span>&#160;          || <a class="code" href="vacuum_8h.html#ac8a084d067e28ed6cf7989a1597af721">vacuum_worker_state_is_recovery</a> (thread_p));</div><div class="line"><a name="l03623"></a><span class="lineno"> 3623</span>&#160;</div><div class="line"><a name="l03624"></a><span class="lineno"> 3624</span>&#160;      <a class="code" href="vacuum_8h.html#a914ef372e17262e546187ec8506ed689">vacuum_er_log</a> (<a class="code" href="vacuum_8h.html#a086e1f02468f0051c19a0f8d66cad1be">VACUUM_ER_LOG_TOPOPS</a> | <a class="code" href="vacuum_8h.html#a21f8b652e2aa9c21a099d1eea14dc0e3">VACUUM_ER_LOG_WORKER</a>,</div><div class="line"><a name="l03625"></a><span class="lineno"> 3625</span>&#160;             <span class="stringliteral">&quot;Start system operation. Current worker tdes: tdes-&gt;trid=%d, tdes-&gt;topops.last=%d, &quot;</span></div><div class="line"><a name="l03626"></a><span class="lineno"> 3626</span>&#160;             <span class="stringliteral">&quot;tdes-&gt;tail_lsa=(%lld, %d). Worker state=%d.&quot;</span>, tdes-&gt;<a class="code" href="structlog__tdes.html#a3baeff284ed2167bcef74c5ef34d4f3b">trid</a>, tdes-&gt;<a class="code" href="structlog__tdes.html#a97c1d42917ab4d08ffe3194fc7233018">topops</a>.<a class="code" href="structlog__topops__stack.html#a5e509dcc15d89abc0c6ba486af6dba4d">last</a>,</div><div class="line"><a name="l03627"></a><span class="lineno"> 3627</span>&#160;             (<span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span>) tdes-&gt;<a class="code" href="structlog__tdes.html#a5b128a08476a5b499cf82e3163e6d62b">tail_lsa</a>.<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a>, (<span class="keywordtype">int</span>) tdes-&gt;<a class="code" href="structlog__tdes.html#a5b128a08476a5b499cf82e3163e6d62b">tail_lsa</a>.<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a>,</div><div class="line"><a name="l03628"></a><span class="lineno"> 3628</span>&#160;             <a class="code" href="vacuum_8h.html#a34562043d3500a01b17bd84ca27940ad">vacuum_get_worker_state</a> (thread_p));</div><div class="line"><a name="l03629"></a><span class="lineno"> 3629</span>&#160;</div><div class="line"><a name="l03630"></a><span class="lineno"> 3630</span>&#160;      <span class="comment">/* Change worker state to VACUUM_WORKER_STATE_TOPOP */</span></div><div class="line"><a name="l03631"></a><span class="lineno"> 3631</span>&#160;      <a class="code" href="vacuum_8h.html#aa06eb2e938f101b0b1b6c75c329e3f9d">vacuum_set_worker_state</a> (thread_p, <a class="code" href="vacuum_8h.html#a85a0ab6d41bb8ef710931f6dba63d611a37ecce03b3ae2c51389cc18c8365e788">VACUUM_WORKER_STATE_TOPOP</a>);</div><div class="line"><a name="l03632"></a><span class="lineno"> 3632</span>&#160;</div><div class="line"><a name="l03633"></a><span class="lineno"> 3633</span>&#160;      <span class="keywordflow">if</span> (tdes-&gt;<a class="code" href="structlog__tdes.html#a97c1d42917ab4d08ffe3194fc7233018">topops</a>.<a class="code" href="structlog__topops__stack.html#a5e509dcc15d89abc0c6ba486af6dba4d">last</a> &lt; 0)</div><div class="line"><a name="l03634"></a><span class="lineno"> 3634</span>&#160;    {</div><div class="line"><a name="l03635"></a><span class="lineno"> 3635</span>&#160;      <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (tdes-&gt;<a class="code" href="structlog__tdes.html#a97c1d42917ab4d08ffe3194fc7233018">topops</a>.<a class="code" href="structlog__topops__stack.html#a5e509dcc15d89abc0c6ba486af6dba4d">last</a> == -1);</div><div class="line"><a name="l03636"></a><span class="lineno"> 3636</span>&#160;</div><div class="line"><a name="l03637"></a><span class="lineno"> 3637</span>&#160;      <span class="comment">/* Vacuum workers/master don&#39;t have a parent transaction that is committed. Different system operations that</span></div><div class="line"><a name="l03638"></a><span class="lineno"> 3638</span>&#160;<span class="comment">       * are not  nested shouldn&#39;t be linked between them. Otherwise, undo recovery, in the attempt to find log</span></div><div class="line"><a name="l03639"></a><span class="lineno"> 3639</span>&#160;<span class="comment">       * records to undo will process all system operations until the first one. Since vacuum workers.master never</span></div><div class="line"><a name="l03640"></a><span class="lineno"> 3640</span>&#160;<span class="comment">       * rollback, once the last system operation is ended, we can reset all modified LSA&#39;s. This way, different</span></div><div class="line"><a name="l03641"></a><span class="lineno"> 3641</span>&#160;<span class="comment">       * system operations will not be linked between them. */</span></div><div class="line"><a name="l03642"></a><span class="lineno"> 3642</span>&#160;      <a class="code" href="storage__common_8h.html#a6a4baec606189dd320678e8f412ca957">LSA_SET_NULL</a> (&amp;tdes-&gt;<a class="code" href="structlog__tdes.html#ad1e00bb06c2561a9600ed0ba6c410943">head_lsa</a>);</div><div class="line"><a name="l03643"></a><span class="lineno"> 3643</span>&#160;      <a class="code" href="storage__common_8h.html#a6a4baec606189dd320678e8f412ca957">LSA_SET_NULL</a> (&amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a5b128a08476a5b499cf82e3163e6d62b">tail_lsa</a>);</div><div class="line"><a name="l03644"></a><span class="lineno"> 3644</span>&#160;      <a class="code" href="storage__common_8h.html#a6a4baec606189dd320678e8f412ca957">LSA_SET_NULL</a> (&amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a4e3335b7f0e4ca7f858416446ae8f782">undo_nxlsa</a>);</div><div class="line"><a name="l03645"></a><span class="lineno"> 3645</span>&#160;      <a class="code" href="storage__common_8h.html#a6a4baec606189dd320678e8f412ca957">LSA_SET_NULL</a> (&amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a35e52753b9c8d5e70696ae8f0479072f">tail_topresult_lsa</a>);</div><div class="line"><a name="l03646"></a><span class="lineno"> 3646</span>&#160;      <a class="code" href="storage__common_8h.html#a6a4baec606189dd320678e8f412ca957">LSA_SET_NULL</a> (&amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a916fdc86e53965a678853a935599ad1d">rcv</a>.<a class="code" href="structlog__rcv__tdes.html#a320d4df908ebab286b06e64c5cfb2cd9">tran_start_postpone_lsa</a>);</div><div class="line"><a name="l03647"></a><span class="lineno"> 3647</span>&#160;      <a class="code" href="storage__common_8h.html#a6a4baec606189dd320678e8f412ca957">LSA_SET_NULL</a> (&amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a916fdc86e53965a678853a935599ad1d">rcv</a>.<a class="code" href="structlog__rcv__tdes.html#a4b7c5dcb737ffa720f8981b314627080">sysop_start_postpone_lsa</a>);</div><div class="line"><a name="l03648"></a><span class="lineno"> 3648</span>&#160;    }</div><div class="line"><a name="l03649"></a><span class="lineno"> 3649</span>&#160;    }</div><div class="line"><a name="l03650"></a><span class="lineno"> 3650</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l03651"></a><span class="lineno"> 3651</span>&#160;    {</div><div class="line"><a name="l03652"></a><span class="lineno"> 3652</span>&#160;      <span class="comment">/* Active transaction */</span></div><div class="line"><a name="l03653"></a><span class="lineno"> 3653</span>&#160;      tdes = <a class="code" href="log__impl_8h.html#a08fee41cfcf592e8afdbc4988ffbc8e4">LOG_FIND_TDES</a> (tran_index);</div><div class="line"><a name="l03654"></a><span class="lineno"> 3654</span>&#160;      <span class="keywordflow">if</span> (tdes == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l03655"></a><span class="lineno"> 3655</span>&#160;    {</div><div class="line"><a name="l03656"></a><span class="lineno"> 3656</span>&#160;      <a class="code" href="error__manager_8c.html#afdaf87ce30f2f557802a185ab85b6599">er_set</a> (<a class="code" href="error__manager_8h.html#a5d0d456c474e11fc70779873a30a7432a3314630dd19f90a68274cf737092c9f2">ER_FATAL_ERROR_SEVERITY</a>, <a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <a class="code" href="error__code_8h.html#a4b8e41e78be77c579a2c58f5248fefe2">ER_LOG_UNKNOWN_TRANINDEX</a>, 1, tran_index);</div><div class="line"><a name="l03657"></a><span class="lineno"> 3657</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l03658"></a><span class="lineno"> 3658</span>&#160;    }</div><div class="line"><a name="l03659"></a><span class="lineno"> 3659</span>&#160;</div><div class="line"><a name="l03660"></a><span class="lineno"> 3660</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="log__impl_8h.html#a8f08025b469332f89fee8ce83dc2d3ff">LOG_ISRESTARTED</a> ())</div><div class="line"><a name="l03661"></a><span class="lineno"> 3661</span>&#160;    {</div><div class="line"><a name="l03662"></a><span class="lineno"> 3662</span>&#160;      r = <a class="code" href="critical__section_8h.html#a9cf8d48fdcf0a6b0bd8391d6083c63e5">rmutex_lock</a> (thread_p, &amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a1118927d0fabac722cf0f9d04dee1378">rmutex_topop</a>);</div><div class="line"><a name="l03663"></a><span class="lineno"> 3663</span>&#160;      <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (r == <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>);</div><div class="line"><a name="l03664"></a><span class="lineno"> 3664</span>&#160;    }</div><div class="line"><a name="l03665"></a><span class="lineno"> 3665</span>&#160;    }</div><div class="line"><a name="l03666"></a><span class="lineno"> 3666</span>&#160;</div><div class="line"><a name="l03667"></a><span class="lineno"> 3667</span>&#160;  <span class="comment">/* Can current tdes.topops stack handle another system operation? */</span></div><div class="line"><a name="l03668"></a><span class="lineno"> 3668</span>&#160;  <span class="keywordflow">if</span> (tdes-&gt;<a class="code" href="structlog__tdes.html#a97c1d42917ab4d08ffe3194fc7233018">topops</a>.<a class="code" href="structlog__topops__stack.html#a332cd1918ade0476cdb34f2b478b6944">max</a> == 0 || (tdes-&gt;<a class="code" href="structlog__tdes.html#a97c1d42917ab4d08ffe3194fc7233018">topops</a>.<a class="code" href="structlog__topops__stack.html#a5e509dcc15d89abc0c6ba486af6dba4d">last</a> + 1) &gt;= tdes-&gt;<a class="code" href="structlog__tdes.html#a97c1d42917ab4d08ffe3194fc7233018">topops</a>.<a class="code" href="structlog__topops__stack.html#a332cd1918ade0476cdb34f2b478b6944">max</a>)</div><div class="line"><a name="l03669"></a><span class="lineno"> 3669</span>&#160;    {</div><div class="line"><a name="l03670"></a><span class="lineno"> 3670</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="log__impl_8h.html#adab64773ba835fc0f3e7ab4f9b382e5c">logtb_realloc_topops_stack</a> (tdes, 1) == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l03671"></a><span class="lineno"> 3671</span>&#160;    {</div><div class="line"><a name="l03672"></a><span class="lineno"> 3672</span>&#160;      <span class="comment">/* Out of memory */</span></div><div class="line"><a name="l03673"></a><span class="lineno"> 3673</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="log__impl_8h.html#a8f08025b469332f89fee8ce83dc2d3ff">LOG_ISRESTARTED</a> () &amp;&amp; !<a class="code" href="vacuum_8h.html#ab0e1deb8da1aa663aa073b0ce78606a2">VACUUM_IS_THREAD_VACUUM</a> (thread_p))</div><div class="line"><a name="l03674"></a><span class="lineno"> 3674</span>&#160;        {</div><div class="line"><a name="l03675"></a><span class="lineno"> 3675</span>&#160;          r = <a class="code" href="critical__section_8h.html#a3059160b974349c3ccbc8d9489a38709">rmutex_unlock</a> (thread_p, &amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a1118927d0fabac722cf0f9d04dee1378">rmutex_topop</a>);</div><div class="line"><a name="l03676"></a><span class="lineno"> 3676</span>&#160;          <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (r == <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>);</div><div class="line"><a name="l03677"></a><span class="lineno"> 3677</span>&#160;        }</div><div class="line"><a name="l03678"></a><span class="lineno"> 3678</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="vacuum_8h.html#ab0e1deb8da1aa663aa073b0ce78606a2">VACUUM_IS_THREAD_VACUUM</a> (thread_p))</div><div class="line"><a name="l03679"></a><span class="lineno"> 3679</span>&#160;        {</div><div class="line"><a name="l03680"></a><span class="lineno"> 3680</span>&#160;          <span class="comment">/* Restore state */</span></div><div class="line"><a name="l03681"></a><span class="lineno"> 3681</span>&#160;          <span class="keywordflow">if</span> (tdes-&gt;<a class="code" href="structlog__tdes.html#a97c1d42917ab4d08ffe3194fc7233018">topops</a>.<a class="code" href="structlog__topops__stack.html#a5e509dcc15d89abc0c6ba486af6dba4d">last</a> &lt; 0)</div><div class="line"><a name="l03682"></a><span class="lineno"> 3682</span>&#160;        {</div><div class="line"><a name="l03683"></a><span class="lineno"> 3683</span>&#160;          <a class="code" href="vacuum_8h.html#aa06eb2e938f101b0b1b6c75c329e3f9d">vacuum_set_worker_state</a> (thread_p, <a class="code" href="vacuum_8h.html#a85a0ab6d41bb8ef710931f6dba63d611aa6dd4742f38124c2af51869d50e6c040">VACUUM_WORKER_STATE_EXECUTE</a>);</div><div class="line"><a name="l03684"></a><span class="lineno"> 3684</span>&#160;        }</div><div class="line"><a name="l03685"></a><span class="lineno"> 3685</span>&#160;          <span class="comment">/* Else */</span></div><div class="line"><a name="l03686"></a><span class="lineno"> 3686</span>&#160;          <span class="comment">/* Leave state as VACUUM_WORKER_STATE_TOPOP */</span></div><div class="line"><a name="l03687"></a><span class="lineno"> 3687</span>&#160;        }</div><div class="line"><a name="l03688"></a><span class="lineno"> 3688</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l03689"></a><span class="lineno"> 3689</span>&#160;    }</div><div class="line"><a name="l03690"></a><span class="lineno"> 3690</span>&#160;    }</div><div class="line"><a name="l03691"></a><span class="lineno"> 3691</span>&#160;</div><div class="line"><a name="l03692"></a><span class="lineno"> 3692</span>&#160;  <span class="comment">/* NOTE if tdes-&gt;topops.last &gt;= 0, there is an already defined top system operation. */</span></div><div class="line"><a name="l03693"></a><span class="lineno"> 3693</span>&#160;  tdes-&gt;<a class="code" href="structlog__tdes.html#a97c1d42917ab4d08ffe3194fc7233018">topops</a>.<a class="code" href="structlog__topops__stack.html#a5e509dcc15d89abc0c6ba486af6dba4d">last</a>++;</div><div class="line"><a name="l03694"></a><span class="lineno"> 3694</span>&#160;  <a class="code" href="storage__common_8h.html#a4c9bc15296fe6728cf0351726cc6ad09">LSA_COPY</a> (&amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a97c1d42917ab4d08ffe3194fc7233018">topops</a>.<a class="code" href="structlog__topops__stack.html#aeeae85de5bdc4f49b8ba730b25ab092b">stack</a>[tdes-&gt;<a class="code" href="structlog__tdes.html#a97c1d42917ab4d08ffe3194fc7233018">topops</a>.<a class="code" href="structlog__topops__stack.html#a5e509dcc15d89abc0c6ba486af6dba4d">last</a>].<a class="code" href="structlog__topops__addresses.html#afe759effcd137f8d3ecfdb7e89814e7c">lastparent_lsa</a>, &amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a5b128a08476a5b499cf82e3163e6d62b">tail_lsa</a>);</div><div class="line"><a name="l03695"></a><span class="lineno"> 3695</span>&#160;  <a class="code" href="storage__common_8h.html#a4c9bc15296fe6728cf0351726cc6ad09">LSA_COPY</a> (&amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a27e8d1fddf3a2b68196b2c02a5318a21">topop_lsa</a>, &amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a5b128a08476a5b499cf82e3163e6d62b">tail_lsa</a>);</div><div class="line"><a name="l03696"></a><span class="lineno"> 3696</span>&#160;</div><div class="line"><a name="l03697"></a><span class="lineno"> 3697</span>&#160;  <a class="code" href="storage__common_8h.html#a6a4baec606189dd320678e8f412ca957">LSA_SET_NULL</a> (&amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a97c1d42917ab4d08ffe3194fc7233018">topops</a>.<a class="code" href="structlog__topops__stack.html#aeeae85de5bdc4f49b8ba730b25ab092b">stack</a>[tdes-&gt;<a class="code" href="structlog__tdes.html#a97c1d42917ab4d08ffe3194fc7233018">topops</a>.<a class="code" href="structlog__topops__stack.html#a5e509dcc15d89abc0c6ba486af6dba4d">last</a>].<a class="code" href="structlog__topops__addresses.html#a94da18d9054fe91a3b114b4262301737">posp_lsa</a>);</div><div class="line"><a name="l03698"></a><span class="lineno"> 3698</span>&#160;</div><div class="line"><a name="l03699"></a><span class="lineno"> 3699</span>&#160;  <a class="code" href="perf__monitor_8h.html#af4850f6b1c604051a0aa7704883eeb07">perfmon_inc_stat</a> (thread_p, <a class="code" href="perf__monitor_8h.html#a165b76d14ae9e30731ed3ca4cf856903acec1ac222608da8bd2b15687f12223eb">PSTAT_TRAN_NUM_START_TOPOPS</a>);</div><div class="line"><a name="l03700"></a><span class="lineno"> 3700</span>&#160;}</div><div class="line"><a name="l03701"></a><span class="lineno"> 3701</span>&#160;</div><div class="line"><a name="l03702"></a><span class="lineno"> 3702</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l03703"></a><span class="lineno"> 3703</span>&#160;<span class="comment"> * log_sysop_start_atomic () - start a system operation that required to be atomic. it is aborted during recovery before</span></div><div class="line"><a name="l03704"></a><span class="lineno"> 3704</span>&#160;<span class="comment"> *                             all postpones are finished.</span></div><div class="line"><a name="l03705"></a><span class="lineno"> 3705</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l03706"></a><span class="lineno"> 3706</span>&#160;<span class="comment"> * return        : void</span></div><div class="line"><a name="l03707"></a><span class="lineno"> 3707</span>&#160;<span class="comment"> * thread_p (in) : thread entry</span></div><div class="line"><a name="l03708"></a><span class="lineno"> 3708</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l03709"></a><span class="lineno"> 3709</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l03710"></a><span class="lineno"><a class="line" href="log__manager_8h.html#ae26c12c22d460e7b63ac626074a4cf4c"> 3710</a></span>&#160;<a class="code" href="log__manager_8c.html#ae26c12c22d460e7b63ac626074a4cf4c">log_sysop_start_atomic</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p)</div><div class="line"><a name="l03711"></a><span class="lineno"> 3711</span>&#160;{</div><div class="line"><a name="l03712"></a><span class="lineno"> 3712</span>&#160;  <a class="code" href="structlog__tdes.html">LOG_TDES</a> *tdes = <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03713"></a><span class="lineno"> 3713</span>&#160;  <span class="keywordtype">int</span> tran_index;</div><div class="line"><a name="l03714"></a><span class="lineno"> 3714</span>&#160;</div><div class="line"><a name="l03715"></a><span class="lineno"> 3715</span>&#160;  <a class="code" href="log__manager_8c.html#acbc3a63215e8924ed23841fb2321cd78">log_sysop_start</a> (thread_p);</div><div class="line"><a name="l03716"></a><span class="lineno"> 3716</span>&#160;  <a class="code" href="log__manager_8c.html#ac6a08ce8b6271d689e48b7bd96a32c7a">log_sysop_get_tran_index_and_tdes</a> (thread_p, &amp;tran_index, &amp;tdes);</div><div class="line"><a name="l03717"></a><span class="lineno"> 3717</span>&#160;  <span class="keywordflow">if</span> (tdes == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || tdes-&gt;<a class="code" href="structlog__tdes.html#a97c1d42917ab4d08ffe3194fc7233018">topops</a>.<a class="code" href="structlog__topops__stack.html#a5e509dcc15d89abc0c6ba486af6dba4d">last</a> &lt; 0)</div><div class="line"><a name="l03718"></a><span class="lineno"> 3718</span>&#160;    {</div><div class="line"><a name="l03719"></a><span class="lineno"> 3719</span>&#160;      <span class="comment">/* not a good context. must be in a system operation */</span></div><div class="line"><a name="l03720"></a><span class="lineno"> 3720</span>&#160;      <a class="code" href="error__manager_8h.html#a34b88b0e828e26dd5cf930a0b1dd57a7">assert_release</a> (<span class="keyword">false</span>);</div><div class="line"><a name="l03721"></a><span class="lineno"> 3721</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l03722"></a><span class="lineno"> 3722</span>&#160;    }</div><div class="line"><a name="l03723"></a><span class="lineno"> 3723</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="storage__common_8h.html#a26dd766712df5b5c4fcd158f571a75e4">LSA_ISNULL</a> (&amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a916fdc86e53965a678853a935599ad1d">rcv</a>.<a class="code" href="structlog__rcv__tdes.html#a3c513a5b19b9c04ebcf6bc57b76261e7">atomic_sysop_start_lsa</a>))</div><div class="line"><a name="l03724"></a><span class="lineno"> 3724</span>&#160;    {</div><div class="line"><a name="l03725"></a><span class="lineno"> 3725</span>&#160;      <a class="code" href="structlog__prior__node.html">LOG_PRIOR_NODE</a> *<a class="code" href="structnodeptr.html">node</a> =</div><div class="line"><a name="l03726"></a><span class="lineno"> 3726</span>&#160;    <a class="code" href="log__impl_8h.html#a2b616997f446dcb588a6addcc65cf5b7">prior_lsa_alloc_and_copy_data</a> (thread_p, <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a3839799b1d15f4333e439c136a3a21ca">LOG_SYSOP_ATOMIC_START</a>, <a class="code" href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2ba6ea83d694355ec2c529960461a086f26">RV_NOT_DEFINED</a>, <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l03727"></a><span class="lineno"> 3727</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="structnodeptr.html">node</a> == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l03728"></a><span class="lineno"> 3728</span>&#160;    {</div><div class="line"><a name="l03729"></a><span class="lineno"> 3729</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l03730"></a><span class="lineno"> 3730</span>&#160;    }</div><div class="line"><a name="l03731"></a><span class="lineno"> 3731</span>&#160;</div><div class="line"><a name="l03732"></a><span class="lineno"> 3732</span>&#160;      (void) <a class="code" href="log__impl_8h.html#a8a3ce7b7aa59fe26c04eca3577e434e8">prior_lsa_next_record</a> (thread_p, <a class="code" href="structnodeptr.html">node</a>, tdes);</div><div class="line"><a name="l03733"></a><span class="lineno"> 3733</span>&#160;    }</div><div class="line"><a name="l03734"></a><span class="lineno"> 3734</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l03735"></a><span class="lineno"> 3735</span>&#160;    {</div><div class="line"><a name="l03736"></a><span class="lineno"> 3736</span>&#160;      <span class="comment">/* this must be a nested atomic system operation. If parent is atomic, we&#39;ll be atomic too. */</span></div><div class="line"><a name="l03737"></a><span class="lineno"> 3737</span>&#160;      <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (tdes-&gt;<a class="code" href="structlog__tdes.html#a97c1d42917ab4d08ffe3194fc7233018">topops</a>.<a class="code" href="structlog__topops__stack.html#a5e509dcc15d89abc0c6ba486af6dba4d">last</a> &gt; 0);</div><div class="line"><a name="l03738"></a><span class="lineno"> 3738</span>&#160;</div><div class="line"><a name="l03739"></a><span class="lineno"> 3739</span>&#160;      <span class="comment">/* oh, and please tell me this is not a nested system operation during postpone of system operation nested to</span></div><div class="line"><a name="l03740"></a><span class="lineno"> 3740</span>&#160;<span class="comment">       * another atomic system operation... */</span></div><div class="line"><a name="l03741"></a><span class="lineno"> 3741</span>&#160;      <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (<a class="code" href="storage__common_8h.html#a26dd766712df5b5c4fcd158f571a75e4">LSA_ISNULL</a> (&amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a916fdc86e53965a678853a935599ad1d">rcv</a>.<a class="code" href="structlog__rcv__tdes.html#a4b7c5dcb737ffa720f8981b314627080">sysop_start_postpone_lsa</a>));</div><div class="line"><a name="l03742"></a><span class="lineno"> 3742</span>&#160;    }</div><div class="line"><a name="l03743"></a><span class="lineno"> 3743</span>&#160;}</div><div class="line"><a name="l03744"></a><span class="lineno"> 3744</span>&#160;</div><div class="line"><a name="l03745"></a><span class="lineno"> 3745</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l03746"></a><span class="lineno"> 3746</span>&#160;<span class="comment"> * log_sysop_end_random_exit () - Random exit from system operation end functions. Used to simulate crashes.</span></div><div class="line"><a name="l03747"></a><span class="lineno"> 3747</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l03748"></a><span class="lineno"> 3748</span>&#160;<span class="comment"> * return    : Void.</span></div><div class="line"><a name="l03749"></a><span class="lineno"> 3749</span>&#160;<span class="comment"> * thread_p (in) : Thread entry.</span></div><div class="line"><a name="l03750"></a><span class="lineno"> 3750</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l03751"></a><span class="lineno"> 3751</span>&#160;<a class="code" href="porting_8h.html#a718749e18d63ca0d6b0d1b918efb41d6">STATIC_INLINE</a> <span class="keywordtype">void</span></div><div class="line"><a name="l03752"></a><span class="lineno"><a class="line" href="log__manager_8c.html#aa47fde07d75699fe2a4167ba8d760664"> 3752</a></span>&#160;<a class="code" href="log__manager_8c.html#aa47fde07d75699fe2a4167ba8d760664">log_sysop_end_random_exit</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p)</div><div class="line"><a name="l03753"></a><span class="lineno"> 3753</span>&#160;{</div><div class="line"><a name="l03754"></a><span class="lineno"> 3754</span>&#160;  <span class="keywordtype">int</span> mod_factor = 5000;    <span class="comment">/* 0.02% */</span></div><div class="line"><a name="l03755"></a><span class="lineno"> 3755</span>&#160;</div><div class="line"><a name="l03756"></a><span class="lineno"> 3756</span>&#160;  <a class="code" href="fault__injection_8h.html#a388a03eac9117728e2ff741e6dccde37">FI_TEST_ARG</a> (thread_p, <a class="code" href="fault__injection_8h.html#ad69d24ac236045dc719cbc6ea7b8bc77ab2710d25847fddeee711f9f106dbc50f">FI_TEST_LOG_MANAGER_RANDOM_EXIT_AT_END_SYSTEMOP</a>, &amp;mod_factor, 0);</div><div class="line"><a name="l03757"></a><span class="lineno"> 3757</span>&#160;}</div><div class="line"><a name="l03758"></a><span class="lineno"> 3758</span>&#160;</div><div class="line"><a name="l03759"></a><span class="lineno"> 3759</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l03760"></a><span class="lineno"> 3760</span>&#160;<span class="comment"> * log_sysop_end_begin () - Used at the beginning of system operation end functions. Verifies valid context and outputs</span></div><div class="line"><a name="l03761"></a><span class="lineno"> 3761</span>&#160;<span class="comment"> *              transaction index and descriptor.</span></div><div class="line"><a name="l03762"></a><span class="lineno"> 3762</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l03763"></a><span class="lineno"> 3763</span>&#160;<span class="comment"> * return       : Void.</span></div><div class="line"><a name="l03764"></a><span class="lineno"> 3764</span>&#160;<span class="comment"> * thread_p (in)    : Thread entry.</span></div><div class="line"><a name="l03765"></a><span class="lineno"> 3765</span>&#160;<span class="comment"> * tran_index_out (out) : Transaction index.</span></div><div class="line"><a name="l03766"></a><span class="lineno"> 3766</span>&#160;<span class="comment"> * tdes_out (out)       : Transaction descriptor.</span></div><div class="line"><a name="l03767"></a><span class="lineno"> 3767</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l03768"></a><span class="lineno"> 3768</span>&#160;<a class="code" href="porting_8h.html#a718749e18d63ca0d6b0d1b918efb41d6">STATIC_INLINE</a> <span class="keywordtype">void</span></div><div class="line"><a name="l03769"></a><span class="lineno"><a class="line" href="log__manager_8c.html#a1504524244c9badcc53c1bb8b0d4213f"> 3769</a></span>&#160;<a class="code" href="log__manager_8c.html#a1504524244c9badcc53c1bb8b0d4213f">log_sysop_end_begin</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <span class="keywordtype">int</span> *tran_index_out, <a class="code" href="structlog__tdes.html">LOG_TDES</a> ** tdes_out)</div><div class="line"><a name="l03770"></a><span class="lineno"> 3770</span>&#160;{</div><div class="line"><a name="l03771"></a><span class="lineno"> 3771</span>&#160;  <a class="code" href="log__manager_8c.html#aa47fde07d75699fe2a4167ba8d760664">log_sysop_end_random_exit</a> (thread_p);</div><div class="line"><a name="l03772"></a><span class="lineno"> 3772</span>&#160;</div><div class="line"><a name="l03773"></a><span class="lineno"> 3773</span>&#160;  <a class="code" href="log__manager_8c.html#ac6a08ce8b6271d689e48b7bd96a32c7a">log_sysop_get_tran_index_and_tdes</a> (thread_p, tran_index_out, tdes_out);</div><div class="line"><a name="l03774"></a><span class="lineno"> 3774</span>&#160;  <span class="keywordflow">if</span> ((*tdes_out) != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> &amp;&amp; (*tdes_out)-&gt;topops.last &lt; 0)</div><div class="line"><a name="l03775"></a><span class="lineno"> 3775</span>&#160;    {</div><div class="line"><a name="l03776"></a><span class="lineno"> 3776</span>&#160;      <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (<span class="keyword">false</span>);</div><div class="line"><a name="l03777"></a><span class="lineno"> 3777</span>&#160;      <a class="code" href="error__manager_8c.html#afdaf87ce30f2f557802a185ab85b6599">er_set</a> (<a class="code" href="error__manager_8h.html#a5d0d456c474e11fc70779873a30a7432a07ad8f9fda27124d297c94b7d3ea44e8">ER_ERROR_SEVERITY</a>, <a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <a class="code" href="error__code_8h.html#a0ecbcb61ebdccc9cfdb2e8284ef5a3d3">ER_LOG_NOTACTIVE_TOPOPS</a>, 0);</div><div class="line"><a name="l03778"></a><span class="lineno"> 3778</span>&#160;      *tdes_out = <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03779"></a><span class="lineno"> 3779</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l03780"></a><span class="lineno"> 3780</span>&#160;    }</div><div class="line"><a name="l03781"></a><span class="lineno"> 3781</span>&#160;}</div><div class="line"><a name="l03782"></a><span class="lineno"> 3782</span>&#160;</div><div class="line"><a name="l03783"></a><span class="lineno"> 3783</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l03784"></a><span class="lineno"> 3784</span>&#160;<span class="comment"> * log_sysop_end_unstack () - Used for ending system operations, removes last sysop from transaction descriptor&#39;s stack.</span></div><div class="line"><a name="l03785"></a><span class="lineno"> 3785</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l03786"></a><span class="lineno"> 3786</span>&#160;<span class="comment"> * return    : Void.</span></div><div class="line"><a name="l03787"></a><span class="lineno"> 3787</span>&#160;<span class="comment"> * thread_p (in) : Thread entry.</span></div><div class="line"><a name="l03788"></a><span class="lineno"> 3788</span>&#160;<span class="comment"> * tdes (in/out) : Transaction descriptor.</span></div><div class="line"><a name="l03789"></a><span class="lineno"> 3789</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l03790"></a><span class="lineno"> 3790</span>&#160;<a class="code" href="porting_8h.html#a718749e18d63ca0d6b0d1b918efb41d6">STATIC_INLINE</a> <span class="keywordtype">void</span></div><div class="line"><a name="l03791"></a><span class="lineno"><a class="line" href="log__manager_8c.html#af1e00d30dcc26ca3a967f9bd1a82cb27"> 3791</a></span>&#160;<a class="code" href="log__manager_8c.html#af1e00d30dcc26ca3a967f9bd1a82cb27">log_sysop_end_unstack</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="structlog__tdes.html">LOG_TDES</a> * tdes)</div><div class="line"><a name="l03792"></a><span class="lineno"> 3792</span>&#160;{</div><div class="line"><a name="l03793"></a><span class="lineno"> 3793</span>&#160;  tdes-&gt;<a class="code" href="structlog__tdes.html#a97c1d42917ab4d08ffe3194fc7233018">topops</a>.<a class="code" href="structlog__topops__stack.html#a5e509dcc15d89abc0c6ba486af6dba4d">last</a>--;</div><div class="line"><a name="l03794"></a><span class="lineno"> 3794</span>&#160;  <span class="keywordflow">if</span> (tdes-&gt;<a class="code" href="structlog__tdes.html#a97c1d42917ab4d08ffe3194fc7233018">topops</a>.<a class="code" href="structlog__topops__stack.html#a5e509dcc15d89abc0c6ba486af6dba4d">last</a> &gt;= 0)</div><div class="line"><a name="l03795"></a><span class="lineno"> 3795</span>&#160;    {</div><div class="line"><a name="l03796"></a><span class="lineno"> 3796</span>&#160;      <a class="code" href="storage__common_8h.html#a4c9bc15296fe6728cf0351726cc6ad09">LSA_COPY</a> (&amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a27e8d1fddf3a2b68196b2c02a5318a21">topop_lsa</a>, &amp;<a class="code" href="log__manager_8c.html#a514c12210485928e3c0446bf9e3d371c">LOG_TDES_LAST_SYSOP</a> (tdes)-&gt;lastparent_lsa);</div><div class="line"><a name="l03797"></a><span class="lineno"> 3797</span>&#160;    }</div><div class="line"><a name="l03798"></a><span class="lineno"> 3798</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l03799"></a><span class="lineno"> 3799</span>&#160;    {</div><div class="line"><a name="l03800"></a><span class="lineno"> 3800</span>&#160;      <a class="code" href="storage__common_8h.html#a6a4baec606189dd320678e8f412ca957">LSA_SET_NULL</a> (&amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a27e8d1fddf3a2b68196b2c02a5318a21">topop_lsa</a>);</div><div class="line"><a name="l03801"></a><span class="lineno"> 3801</span>&#160;    }</div><div class="line"><a name="l03802"></a><span class="lineno"> 3802</span>&#160;}</div><div class="line"><a name="l03803"></a><span class="lineno"> 3803</span>&#160;</div><div class="line"><a name="l03804"></a><span class="lineno"> 3804</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l03805"></a><span class="lineno"> 3805</span>&#160;<span class="comment"> * log_sysop_end_final () - Used to complete a system operation at the end of system operation end functions.</span></div><div class="line"><a name="l03806"></a><span class="lineno"> 3806</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l03807"></a><span class="lineno"> 3807</span>&#160;<span class="comment"> * return    : Void.</span></div><div class="line"><a name="l03808"></a><span class="lineno"> 3808</span>&#160;<span class="comment"> * thread_p (in) : Thread entry.</span></div><div class="line"><a name="l03809"></a><span class="lineno"> 3809</span>&#160;<span class="comment"> * tdes (in/out) : Transaction descriptor.</span></div><div class="line"><a name="l03810"></a><span class="lineno"> 3810</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l03811"></a><span class="lineno"> 3811</span>&#160;<a class="code" href="porting_8h.html#a718749e18d63ca0d6b0d1b918efb41d6">STATIC_INLINE</a> <span class="keywordtype">void</span></div><div class="line"><a name="l03812"></a><span class="lineno"><a class="line" href="log__manager_8c.html#acede8354bdcf6ae570ee030b4f57c07b"> 3812</a></span>&#160;<a class="code" href="log__manager_8c.html#acede8354bdcf6ae570ee030b4f57c07b">log_sysop_end_final</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="structlog__tdes.html">LOG_TDES</a> * tdes)</div><div class="line"><a name="l03813"></a><span class="lineno"> 3813</span>&#160;{</div><div class="line"><a name="l03814"></a><span class="lineno"> 3814</span>&#160;  <span class="keywordtype">int</span> r = <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>;</div><div class="line"><a name="l03815"></a><span class="lineno"> 3815</span>&#160;</div><div class="line"><a name="l03816"></a><span class="lineno"> 3816</span>&#160;  <a class="code" href="log__manager_8c.html#af1e00d30dcc26ca3a967f9bd1a82cb27">log_sysop_end_unstack</a> (thread_p, tdes);</div><div class="line"><a name="l03817"></a><span class="lineno"> 3817</span>&#160;</div><div class="line"><a name="l03818"></a><span class="lineno"> 3818</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="log__impl_8h.html#a8f08025b469332f89fee8ce83dc2d3ff">LOG_ISRESTARTED</a> () &amp;&amp; !<a class="code" href="vacuum_8h.html#ab0e1deb8da1aa663aa073b0ce78606a2">VACUUM_IS_THREAD_VACUUM</a> (thread_p))</div><div class="line"><a name="l03819"></a><span class="lineno"> 3819</span>&#160;    {</div><div class="line"><a name="l03820"></a><span class="lineno"> 3820</span>&#160;      r = <a class="code" href="critical__section_8h.html#a3059160b974349c3ccbc8d9489a38709">rmutex_unlock</a> (thread_p, &amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a1118927d0fabac722cf0f9d04dee1378">rmutex_topop</a>);</div><div class="line"><a name="l03821"></a><span class="lineno"> 3821</span>&#160;      <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (r == <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>);</div><div class="line"><a name="l03822"></a><span class="lineno"> 3822</span>&#160;    }</div><div class="line"><a name="l03823"></a><span class="lineno"> 3823</span>&#160;</div><div class="line"><a name="l03824"></a><span class="lineno"> 3824</span>&#160;  <a class="code" href="perf__monitor_8h.html#af4850f6b1c604051a0aa7704883eeb07">perfmon_inc_stat</a> (thread_p, <a class="code" href="perf__monitor_8h.html#a165b76d14ae9e30731ed3ca4cf856903a1dc9e18210b62c04850a1bb49dc3472b">PSTAT_TRAN_NUM_END_TOPOPS</a>);</div><div class="line"><a name="l03825"></a><span class="lineno"> 3825</span>&#160;</div><div class="line"><a name="l03826"></a><span class="lineno"> 3826</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="vacuum_8h.html#ab0e1deb8da1aa663aa073b0ce78606a2">VACUUM_IS_THREAD_VACUUM</a> (thread_p))</div><div class="line"><a name="l03827"></a><span class="lineno"> 3827</span>&#160;    {</div><div class="line"><a name="l03828"></a><span class="lineno"> 3828</span>&#160;      <span class="keywordflow">if</span> (tdes-&gt;<a class="code" href="structlog__tdes.html#a97c1d42917ab4d08ffe3194fc7233018">topops</a>.<a class="code" href="structlog__topops__stack.html#a5e509dcc15d89abc0c6ba486af6dba4d">last</a> &lt; 0)</div><div class="line"><a name="l03829"></a><span class="lineno"> 3829</span>&#160;    {</div><div class="line"><a name="l03830"></a><span class="lineno"> 3830</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="log__impl_8h.html#a8f08025b469332f89fee8ce83dc2d3ff">LOG_ISRESTARTED</a> ())</div><div class="line"><a name="l03831"></a><span class="lineno"> 3831</span>&#160;        {</div><div class="line"><a name="l03832"></a><span class="lineno"> 3832</span>&#160;          <span class="comment">/* Change the worker state back to VACUUM_WORKER_STATE_EXECUTE. */</span></div><div class="line"><a name="l03833"></a><span class="lineno"> 3833</span>&#160;          <a class="code" href="vacuum_8h.html#aa06eb2e938f101b0b1b6c75c329e3f9d">vacuum_set_worker_state</a> (thread_p, <a class="code" href="vacuum_8h.html#a85a0ab6d41bb8ef710931f6dba63d611aa6dd4742f38124c2af51869d50e6c040">VACUUM_WORKER_STATE_EXECUTE</a>);</div><div class="line"><a name="l03834"></a><span class="lineno"> 3834</span>&#160;        }</div><div class="line"><a name="l03835"></a><span class="lineno"> 3835</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l03836"></a><span class="lineno"> 3836</span>&#160;        {</div><div class="line"><a name="l03837"></a><span class="lineno"> 3837</span>&#160;          <span class="comment">/* Change the worker state back to VACUUM_WORKER_STATE_RECOVERY. */</span></div><div class="line"><a name="l03838"></a><span class="lineno"> 3838</span>&#160;          <a class="code" href="vacuum_8h.html#aa06eb2e938f101b0b1b6c75c329e3f9d">vacuum_set_worker_state</a> (thread_p, <a class="code" href="vacuum_8h.html#a85a0ab6d41bb8ef710931f6dba63d611a9245875052e8a4c44961fa17f81aff27">VACUUM_WORKER_STATE_RECOVERY</a>);</div><div class="line"><a name="l03839"></a><span class="lineno"> 3839</span>&#160;        }</div><div class="line"><a name="l03840"></a><span class="lineno"> 3840</span>&#160;</div><div class="line"><a name="l03841"></a><span class="lineno"> 3841</span>&#160;      <a class="code" href="vacuum_8h.html#a914ef372e17262e546187ec8506ed689">vacuum_er_log</a> (<a class="code" href="vacuum_8h.html#a086e1f02468f0051c19a0f8d66cad1be">VACUUM_ER_LOG_TOPOPS</a>,</div><div class="line"><a name="l03842"></a><span class="lineno"> 3842</span>&#160;             <span class="stringliteral">&quot;Ended all top operations. Tdes: tdes-&gt;trid=%d tdes-&gt;head_lsa=(%lld, %d), &quot;</span></div><div class="line"><a name="l03843"></a><span class="lineno"> 3843</span>&#160;             <span class="stringliteral">&quot;tdes-&gt;tail_lsa=(%lld, %d), tdes-&gt;undo_nxlsa=(%lld, %d), &quot;</span></div><div class="line"><a name="l03844"></a><span class="lineno"> 3844</span>&#160;             <span class="stringliteral">&quot;tdes-&gt;tail_topresult_lsa=(%lld, %d). Worker state=%d.&quot;</span>, tdes-&gt;<a class="code" href="structlog__tdes.html#a3baeff284ed2167bcef74c5ef34d4f3b">trid</a>,</div><div class="line"><a name="l03845"></a><span class="lineno"> 3845</span>&#160;             (<span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span>) tdes-&gt;<a class="code" href="structlog__tdes.html#ad1e00bb06c2561a9600ed0ba6c410943">head_lsa</a>.<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a>, (<span class="keywordtype">int</span>) tdes-&gt;<a class="code" href="structlog__tdes.html#ad1e00bb06c2561a9600ed0ba6c410943">head_lsa</a>.<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a>,</div><div class="line"><a name="l03846"></a><span class="lineno"> 3846</span>&#160;             (<span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span>) tdes-&gt;<a class="code" href="structlog__tdes.html#a5b128a08476a5b499cf82e3163e6d62b">tail_lsa</a>.<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a>, (<span class="keywordtype">int</span>) tdes-&gt;<a class="code" href="structlog__tdes.html#a5b128a08476a5b499cf82e3163e6d62b">tail_lsa</a>.<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a>,</div><div class="line"><a name="l03847"></a><span class="lineno"> 3847</span>&#160;             (<span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span>) tdes-&gt;<a class="code" href="structlog__tdes.html#a4e3335b7f0e4ca7f858416446ae8f782">undo_nxlsa</a>.<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a>, (<span class="keywordtype">int</span>) tdes-&gt;<a class="code" href="structlog__tdes.html#a4e3335b7f0e4ca7f858416446ae8f782">undo_nxlsa</a>.<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a>,</div><div class="line"><a name="l03848"></a><span class="lineno"> 3848</span>&#160;             (<span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span>) tdes-&gt;<a class="code" href="structlog__tdes.html#a35e52753b9c8d5e70696ae8f0479072f">tail_topresult_lsa</a>.<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a>, (<span class="keywordtype">int</span>) tdes-&gt;<a class="code" href="structlog__tdes.html#a35e52753b9c8d5e70696ae8f0479072f">tail_topresult_lsa</a>.<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a>,</div><div class="line"><a name="l03849"></a><span class="lineno"> 3849</span>&#160;             <a class="code" href="vacuum_8h.html#a34562043d3500a01b17bd84ca27940ad">vacuum_get_worker_state</a> (thread_p));</div><div class="line"><a name="l03850"></a><span class="lineno"> 3850</span>&#160;</div><div class="line"><a name="l03851"></a><span class="lineno"> 3851</span>&#160;      <span class="comment">/* Vacuum workers/master don&#39;t have a parent transaction that is committed. Different system operations that</span></div><div class="line"><a name="l03852"></a><span class="lineno"> 3852</span>&#160;<span class="comment">       * are not nested shouldn&#39;t be linked between them. Otherwise, undo recovery, in the attempt to find log</span></div><div class="line"><a name="l03853"></a><span class="lineno"> 3853</span>&#160;<span class="comment">       * records to undo will process all system operations until the first one. Since vacuum workers/master never</span></div><div class="line"><a name="l03854"></a><span class="lineno"> 3854</span>&#160;<span class="comment">       * rollback, once the last system operation is ended, we can reset all modified LSA&#39;s. This way, different</span></div><div class="line"><a name="l03855"></a><span class="lineno"> 3855</span>&#160;<span class="comment">       * system operations will not be linked between them. */</span></div><div class="line"><a name="l03856"></a><span class="lineno"> 3856</span>&#160;      <a class="code" href="storage__common_8h.html#a6a4baec606189dd320678e8f412ca957">LSA_SET_NULL</a> (&amp;tdes-&gt;<a class="code" href="structlog__tdes.html#ad1e00bb06c2561a9600ed0ba6c410943">head_lsa</a>);</div><div class="line"><a name="l03857"></a><span class="lineno"> 3857</span>&#160;      <a class="code" href="storage__common_8h.html#a6a4baec606189dd320678e8f412ca957">LSA_SET_NULL</a> (&amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a5b128a08476a5b499cf82e3163e6d62b">tail_lsa</a>);</div><div class="line"><a name="l03858"></a><span class="lineno"> 3858</span>&#160;      <a class="code" href="storage__common_8h.html#a6a4baec606189dd320678e8f412ca957">LSA_SET_NULL</a> (&amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a4e3335b7f0e4ca7f858416446ae8f782">undo_nxlsa</a>);</div><div class="line"><a name="l03859"></a><span class="lineno"> 3859</span>&#160;      <a class="code" href="storage__common_8h.html#a6a4baec606189dd320678e8f412ca957">LSA_SET_NULL</a> (&amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a35e52753b9c8d5e70696ae8f0479072f">tail_topresult_lsa</a>);</div><div class="line"><a name="l03860"></a><span class="lineno"> 3860</span>&#160;    }</div><div class="line"><a name="l03861"></a><span class="lineno"> 3861</span>&#160;    }</div><div class="line"><a name="l03862"></a><span class="lineno"> 3862</span>&#160;</div><div class="line"><a name="l03863"></a><span class="lineno"> 3863</span>&#160;  <a class="code" href="log__manager_8c.html#aa47fde07d75699fe2a4167ba8d760664">log_sysop_end_random_exit</a> (thread_p);</div><div class="line"><a name="l03864"></a><span class="lineno"> 3864</span>&#160;</div><div class="line"><a name="l03865"></a><span class="lineno"> 3865</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="log__manager_8c.html#aff0ddf74133f090a894a4b4b68b7acb6">LOG_ISCHECKPOINT_TIME</a> ())</div><div class="line"><a name="l03866"></a><span class="lineno"> 3866</span>&#160;    {</div><div class="line"><a name="l03867"></a><span class="lineno"> 3867</span>&#160;<span class="preprocessor">#if defined(SERVER_MODE)</span></div><div class="line"><a name="l03868"></a><span class="lineno"> 3868</span>&#160;      <a class="code" href="log__manager_8h.html#a6160ad5bb57554497e3183a7d61b3598">log_wakeup_checkpoint_daemon</a> ();</div><div class="line"><a name="l03869"></a><span class="lineno"> 3869</span>&#160;<span class="preprocessor">#else </span><span class="comment">/* SERVER_MODE */</span><span class="preprocessor"></span></div><div class="line"><a name="l03870"></a><span class="lineno"> 3870</span>&#160;      (void) <a class="code" href="log__impl_8h.html#a3afa13fd96a09f0686e865e34d4ba415">logpb_checkpoint</a> (thread_p);</div><div class="line"><a name="l03871"></a><span class="lineno"> 3871</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* SERVER_MODE */</span><span class="preprocessor"></span></div><div class="line"><a name="l03872"></a><span class="lineno"> 3872</span>&#160;    }</div><div class="line"><a name="l03873"></a><span class="lineno"> 3873</span>&#160;}</div><div class="line"><a name="l03874"></a><span class="lineno"> 3874</span>&#160;</div><div class="line"><a name="l03875"></a><span class="lineno"> 3875</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l03876"></a><span class="lineno"> 3876</span>&#160;<span class="comment"> * log_sysop_commit_internal () - Commit system operation. This can be used just to guarantee atomicity or permanence of</span></div><div class="line"><a name="l03877"></a><span class="lineno"> 3877</span>&#160;<span class="comment"> *                all changes in system operation. Or it can be extended to also act as an undo,</span></div><div class="line"><a name="l03878"></a><span class="lineno"> 3878</span>&#160;<span class="comment"> *                compensate or run postpone log record. The type is decided using log_record argument.</span></div><div class="line"><a name="l03879"></a><span class="lineno"> 3879</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l03880"></a><span class="lineno"> 3880</span>&#160;<span class="comment"> * return                 : Void.</span></div><div class="line"><a name="l03881"></a><span class="lineno"> 3881</span>&#160;<span class="comment"> * thread_p (in)              : Thread entry.</span></div><div class="line"><a name="l03882"></a><span class="lineno"> 3882</span>&#160;<span class="comment"> * log_record (in)            : All information that are required to build the log record for commit system operation.</span></div><div class="line"><a name="l03883"></a><span class="lineno"> 3883</span>&#160;<span class="comment"> * data_size (in)             : recovery data size</span></div><div class="line"><a name="l03884"></a><span class="lineno"> 3884</span>&#160;<span class="comment"> * data (in)                  : recovery data</span></div><div class="line"><a name="l03885"></a><span class="lineno"> 3885</span>&#160;<span class="comment"> * is_rv_finish_postpone (in) : true if this is called during recovery to finish a system op postpone</span></div><div class="line"><a name="l03886"></a><span class="lineno"> 3886</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l03887"></a><span class="lineno"> 3887</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l03888"></a><span class="lineno"> 3888</span>&#160;log_sysop_commit_internal (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="structlog__rec__sysop__end.html">LOG_REC_SYSOP_END</a> * log_record, <span class="keywordtype">int</span> data_size, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="namespacestatdump__to__csv.html#aedcb70fde9c0b07a0732db70deeec616">data</a>,</div><div class="line"><a name="l03889"></a><span class="lineno"> 3889</span>&#160;               <span class="keywordtype">bool</span> is_rv_finish_postpone)</div><div class="line"><a name="l03890"></a><span class="lineno"> 3890</span>&#160;{</div><div class="line"><a name="l03891"></a><span class="lineno"> 3891</span>&#160;  <span class="keywordtype">int</span> tran_index;</div><div class="line"><a name="l03892"></a><span class="lineno"> 3892</span>&#160;  <a class="code" href="structlog__tdes.html">LOG_TDES</a> *tdes = <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l03893"></a><span class="lineno"> 3893</span>&#160;</div><div class="line"><a name="l03894"></a><span class="lineno"> 3894</span>&#160;  <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (log_record != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l03895"></a><span class="lineno"> 3895</span>&#160;  <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (log_record-&gt;<a class="code" href="structlog__rec__sysop__end.html#a3ea9d3ebfe5a0ed547670f1409fb385f">type</a> != <a class="code" href="log__impl_8h.html#a24797b2fe67e0ec8631d7a92fbef25c9a9530c67a9b21ab7a54d7c906f900a247">LOG_SYSOP_END_ABORT</a>);</div><div class="line"><a name="l03896"></a><span class="lineno"> 3896</span>&#160;</div><div class="line"><a name="l03897"></a><span class="lineno"> 3897</span>&#160;  <a class="code" href="log__manager_8c.html#a1504524244c9badcc53c1bb8b0d4213f">log_sysop_end_begin</a> (thread_p, &amp;tran_index, &amp;tdes);</div><div class="line"><a name="l03898"></a><span class="lineno"> 3898</span>&#160;  <span class="keywordflow">if</span> (tdes == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l03899"></a><span class="lineno"> 3899</span>&#160;    {</div><div class="line"><a name="l03900"></a><span class="lineno"> 3900</span>&#160;      <a class="code" href="error__manager_8h.html#a34b88b0e828e26dd5cf930a0b1dd57a7">assert_release</a> (<span class="keyword">false</span>);</div><div class="line"><a name="l03901"></a><span class="lineno"> 3901</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l03902"></a><span class="lineno"> 3902</span>&#160;    }</div><div class="line"><a name="l03903"></a><span class="lineno"> 3903</span>&#160;</div><div class="line"><a name="l03904"></a><span class="lineno"> 3904</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="storage__common_8h.html#a26dd766712df5b5c4fcd158f571a75e4">LSA_ISNULL</a> (&amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a5b128a08476a5b499cf82e3163e6d62b">tail_lsa</a>) || <a class="code" href="storage__common_8h.html#a7f9d98414f81d41e639e744027e15947">LSA_LE</a> (&amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a5b128a08476a5b499cf82e3163e6d62b">tail_lsa</a>, <a class="code" href="log__manager_8c.html#ab278939e239bb84cc9c118b55260a500">LOG_TDES_LAST_SYSOP_PARENT_LSA</a> (tdes)))</div><div class="line"><a name="l03905"></a><span class="lineno"> 3905</span>&#160;      &amp;&amp; log_record-&gt;<a class="code" href="structlog__rec__sysop__end.html#a3ea9d3ebfe5a0ed547670f1409fb385f">type</a> == <a class="code" href="log__impl_8h.html#a24797b2fe67e0ec8631d7a92fbef25c9a9e1c6cb1f049797b7b3f9230308663a3">LOG_SYSOP_END_COMMIT</a>)</div><div class="line"><a name="l03906"></a><span class="lineno"> 3906</span>&#160;    {</div><div class="line"><a name="l03907"></a><span class="lineno"> 3907</span>&#160;      <span class="comment">/* No change. */</span></div><div class="line"><a name="l03908"></a><span class="lineno"> 3908</span>&#160;      <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (<a class="code" href="storage__common_8h.html#a26dd766712df5b5c4fcd158f571a75e4">LSA_ISNULL</a> (&amp;<a class="code" href="log__manager_8c.html#a514c12210485928e3c0446bf9e3d371c">LOG_TDES_LAST_SYSOP</a> (tdes)-&gt;posp_lsa));</div><div class="line"><a name="l03909"></a><span class="lineno"> 3909</span>&#160;    }</div><div class="line"><a name="l03910"></a><span class="lineno"> 3910</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l03911"></a><span class="lineno"> 3911</span>&#160;    {</div><div class="line"><a name="l03912"></a><span class="lineno"> 3912</span>&#160;      <span class="comment">/* we are here because either system operation is not empty, or this is the end of a logical system operation.</span></div><div class="line"><a name="l03913"></a><span class="lineno"> 3913</span>&#160;<span class="comment">       * we don&#39;t actually allow empty logical system operation because it might hide a logic flaw. however, there are</span></div><div class="line"><a name="l03914"></a><span class="lineno"> 3914</span>&#160;<span class="comment">       * unusual cases when a logical operation does not really require logging (see RVPGBUF_FLUSH_PAGE). if you create</span></div><div class="line"><a name="l03915"></a><span class="lineno"> 3915</span>&#160;<span class="comment">       * such a case, you should add a dummy log record to trick this assert. */</span></div><div class="line"><a name="l03916"></a><span class="lineno"> 3916</span>&#160;      <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (!<a class="code" href="storage__common_8h.html#a26dd766712df5b5c4fcd158f571a75e4">LSA_ISNULL</a> (&amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a5b128a08476a5b499cf82e3163e6d62b">tail_lsa</a>) &amp;&amp; <a class="code" href="storage__common_8h.html#a467739272b1ee74686bae4be2354197a">LSA_GT</a> (&amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a5b128a08476a5b499cf82e3163e6d62b">tail_lsa</a>, <a class="code" href="log__manager_8c.html#ab278939e239bb84cc9c118b55260a500">LOG_TDES_LAST_SYSOP_PARENT_LSA</a> (tdes)));</div><div class="line"><a name="l03917"></a><span class="lineno"> 3917</span>&#160;</div><div class="line"><a name="l03918"></a><span class="lineno"> 3918</span>&#160;      <span class="comment">/* now that we have access to tdes, we can do some updates on log record and sanity checks */</span></div><div class="line"><a name="l03919"></a><span class="lineno"> 3919</span>&#160;      <span class="keywordflow">if</span> (log_record-&gt;<a class="code" href="structlog__rec__sysop__end.html#a3ea9d3ebfe5a0ed547670f1409fb385f">type</a> == <a class="code" href="log__impl_8h.html#a24797b2fe67e0ec8631d7a92fbef25c9ada41432cf121d5aafecae01984edd8e7">LOG_SYSOP_END_LOGICAL_RUN_POSTPONE</a>)</div><div class="line"><a name="l03920"></a><span class="lineno"> 3920</span>&#160;    {</div><div class="line"><a name="l03921"></a><span class="lineno"> 3921</span>&#160;      <span class="comment">/* only allowed for postpones */</span></div><div class="line"><a name="l03922"></a><span class="lineno"> 3922</span>&#160;      <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (tdes-&gt;<a class="code" href="structlog__tdes.html#ad924146690490b840ef5c3f65c3a5a6c">state</a> == <a class="code" href="log__comm_8h.html#a3c0be9b9f104459ab90ee18af95c4b3eaef0e7c96ca3684ce2422a33afe8f35fc">TRAN_UNACTIVE_COMMITTED_WITH_POSTPONE</a></div><div class="line"><a name="l03923"></a><span class="lineno"> 3923</span>&#160;          || tdes-&gt;<a class="code" href="structlog__tdes.html#ad924146690490b840ef5c3f65c3a5a6c">state</a> == <a class="code" href="log__comm_8h.html#a3c0be9b9f104459ab90ee18af95c4b3ea04e4c5688a6020948963e1e0fffe9c15">TRAN_UNACTIVE_TOPOPE_COMMITTED_WITH_POSTPONE</a>);</div><div class="line"><a name="l03924"></a><span class="lineno"> 3924</span>&#160;</div><div class="line"><a name="l03925"></a><span class="lineno"> 3925</span>&#160;      <span class="comment">/* this is relevant for proper recovery */</span></div><div class="line"><a name="l03926"></a><span class="lineno"> 3926</span>&#160;      log_record-&gt;<a class="code" href="structlog__rec__sysop__end.html#a972f4330fb7cee921ad0dd2dbd6677ae">run_postpone</a>.is_sysop_postpone =</div><div class="line"><a name="l03927"></a><span class="lineno"> 3927</span>&#160;        (tdes-&gt;<a class="code" href="structlog__tdes.html#ad924146690490b840ef5c3f65c3a5a6c">state</a> == <a class="code" href="log__comm_8h.html#a3c0be9b9f104459ab90ee18af95c4b3ea04e4c5688a6020948963e1e0fffe9c15">TRAN_UNACTIVE_TOPOPE_COMMITTED_WITH_POSTPONE</a> &amp;&amp; !is_rv_finish_postpone);</div><div class="line"><a name="l03928"></a><span class="lineno"> 3928</span>&#160;    }</div><div class="line"><a name="l03929"></a><span class="lineno"> 3929</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (log_record-&gt;<a class="code" href="structlog__rec__sysop__end.html#a3ea9d3ebfe5a0ed547670f1409fb385f">type</a> == <a class="code" href="log__impl_8h.html#a24797b2fe67e0ec8631d7a92fbef25c9a69f84e9574e7f583c88733bdea3a415f">LOG_SYSOP_END_LOGICAL_COMPENSATE</a>)</div><div class="line"><a name="l03930"></a><span class="lineno"> 3930</span>&#160;    {</div><div class="line"><a name="l03931"></a><span class="lineno"> 3931</span>&#160;      <span class="comment">/* we should be doing rollback or undo recovery */</span></div><div class="line"><a name="l03932"></a><span class="lineno"> 3932</span>&#160;      <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (tdes-&gt;<a class="code" href="structlog__tdes.html#ad924146690490b840ef5c3f65c3a5a6c">state</a> == <a class="code" href="log__comm_8h.html#a3c0be9b9f104459ab90ee18af95c4b3eac19d6ad89f93ec75c1e1904db0e5c0ad">TRAN_UNACTIVE_ABORTED</a> || tdes-&gt;<a class="code" href="structlog__tdes.html#ad924146690490b840ef5c3f65c3a5a6c">state</a> == <a class="code" href="log__comm_8h.html#a3c0be9b9f104459ab90ee18af95c4b3ea83800b7312eba64d331b924c80ce32b4">TRAN_UNACTIVE_UNILATERALLY_ABORTED</a></div><div class="line"><a name="l03933"></a><span class="lineno"> 3933</span>&#160;          || (is_rv_finish_postpone &amp;&amp; (tdes-&gt;<a class="code" href="structlog__tdes.html#ad924146690490b840ef5c3f65c3a5a6c">state</a> == <a class="code" href="log__comm_8h.html#a3c0be9b9f104459ab90ee18af95c4b3ea04e4c5688a6020948963e1e0fffe9c15">TRAN_UNACTIVE_TOPOPE_COMMITTED_WITH_POSTPONE</a></div><div class="line"><a name="l03934"></a><span class="lineno"> 3934</span>&#160;                        || tdes-&gt;<a class="code" href="structlog__tdes.html#ad924146690490b840ef5c3f65c3a5a6c">state</a> == <a class="code" href="log__comm_8h.html#a3c0be9b9f104459ab90ee18af95c4b3eaef0e7c96ca3684ce2422a33afe8f35fc">TRAN_UNACTIVE_COMMITTED_WITH_POSTPONE</a>)));</div><div class="line"><a name="l03935"></a><span class="lineno"> 3935</span>&#160;    }</div><div class="line"><a name="l03936"></a><span class="lineno"> 3936</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (log_record-&gt;<a class="code" href="structlog__rec__sysop__end.html#a3ea9d3ebfe5a0ed547670f1409fb385f">type</a> == <a class="code" href="log__impl_8h.html#a24797b2fe67e0ec8631d7a92fbef25c9ac4566a4bae57d0a42fa6e37cc65e5329">LOG_SYSOP_END_LOGICAL_UNDO</a> || log_record-&gt;<a class="code" href="structlog__rec__sysop__end.html#a3ea9d3ebfe5a0ed547670f1409fb385f">type</a> == <a class="code" href="log__impl_8h.html#a24797b2fe67e0ec8631d7a92fbef25c9a571011a0354832edf02d40490f512716">LOG_SYSOP_END_LOGICAL_MVCC_UNDO</a>)</div><div class="line"><a name="l03937"></a><span class="lineno"> 3937</span>&#160;    {</div><div class="line"><a name="l03938"></a><span class="lineno"> 3938</span>&#160;      <span class="comment">/* ... no restrictions I can think of */</span></div><div class="line"><a name="l03939"></a><span class="lineno"> 3939</span>&#160;    }</div><div class="line"><a name="l03940"></a><span class="lineno"> 3940</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l03941"></a><span class="lineno"> 3941</span>&#160;    {</div><div class="line"><a name="l03942"></a><span class="lineno"> 3942</span>&#160;      <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (log_record-&gt;<a class="code" href="structlog__rec__sysop__end.html#a3ea9d3ebfe5a0ed547670f1409fb385f">type</a> == <a class="code" href="log__impl_8h.html#a24797b2fe67e0ec8631d7a92fbef25c9a9e1c6cb1f049797b7b3f9230308663a3">LOG_SYSOP_END_COMMIT</a>);</div><div class="line"><a name="l03943"></a><span class="lineno"> 3943</span>&#160;      <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (tdes-&gt;<a class="code" href="structlog__tdes.html#ad924146690490b840ef5c3f65c3a5a6c">state</a> != <a class="code" href="log__comm_8h.html#a3c0be9b9f104459ab90ee18af95c4b3eaef0e7c96ca3684ce2422a33afe8f35fc">TRAN_UNACTIVE_COMMITTED_WITH_POSTPONE</a></div><div class="line"><a name="l03944"></a><span class="lineno"> 3944</span>&#160;          &amp;&amp; (tdes-&gt;<a class="code" href="structlog__tdes.html#ad924146690490b840ef5c3f65c3a5a6c">state</a> != <a class="code" href="log__comm_8h.html#a3c0be9b9f104459ab90ee18af95c4b3ea04e4c5688a6020948963e1e0fffe9c15">TRAN_UNACTIVE_TOPOPE_COMMITTED_WITH_POSTPONE</a> || is_rv_finish_postpone));</div><div class="line"><a name="l03945"></a><span class="lineno"> 3945</span>&#160;    }</div><div class="line"><a name="l03946"></a><span class="lineno"> 3946</span>&#160;</div><div class="line"><a name="l03947"></a><span class="lineno"> 3947</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="log__impl_8h.html#a2d9876809ffa8473b6b47c5edcff6ca2">LOG_CHECK_LOG_APPLIER</a> (thread_p) &amp;&amp; !<a class="code" href="vacuum_8h.html#ab0e1deb8da1aa663aa073b0ce78606a2">VACUUM_IS_THREAD_VACUUM</a> (thread_p)</div><div class="line"><a name="l03948"></a><span class="lineno"> 3948</span>&#160;      &amp;&amp; <a class="code" href="log__comm_8c.html#ae3b5771bd95aa37a187f3a6e0cb2b32d">log_does_allow_replication</a> () == <span class="keyword">true</span>)</div><div class="line"><a name="l03949"></a><span class="lineno"> 3949</span>&#160;    {</div><div class="line"><a name="l03950"></a><span class="lineno"> 3950</span>&#160;      <span class="comment">/* for the replication agent guarantee the order of transaction */</span></div><div class="line"><a name="l03951"></a><span class="lineno"> 3951</span>&#160;      <span class="comment">/* for CC(Click Counter) : at here */</span></div><div class="line"><a name="l03952"></a><span class="lineno"> 3952</span>&#160;      <a class="code" href="log__manager_8c.html#acc276f18c02a976bd38d99c017921401">log_append_repl_info</a> (thread_p, tdes, <span class="keyword">false</span>);</div><div class="line"><a name="l03953"></a><span class="lineno"> 3953</span>&#160;    }</div><div class="line"><a name="l03954"></a><span class="lineno"> 3954</span>&#160;</div><div class="line"><a name="l03955"></a><span class="lineno"> 3955</span>&#160;      log_record-&gt;<a class="code" href="structlog__rec__sysop__end.html#ac228866b1723dfd1165550c037fdc3aa">lastparent_lsa</a> = *<a class="code" href="log__manager_8c.html#ab278939e239bb84cc9c118b55260a500">LOG_TDES_LAST_SYSOP_PARENT_LSA</a> (tdes);</div><div class="line"><a name="l03956"></a><span class="lineno"> 3956</span>&#160;      log_record-&gt;<a class="code" href="structlog__rec__sysop__end.html#aee18ec7d007cfa72f33ca61fcb93e7b3">prv_topresult_lsa</a> = tdes-&gt;<a class="code" href="structlog__tdes.html#a35e52753b9c8d5e70696ae8f0479072f">tail_topresult_lsa</a>;</div><div class="line"><a name="l03957"></a><span class="lineno"> 3957</span>&#160;</div><div class="line"><a name="l03958"></a><span class="lineno"> 3958</span>&#160;      <span class="comment">/* do postpone */</span></div><div class="line"><a name="l03959"></a><span class="lineno"> 3959</span>&#160;      log_sysop_do_postpone (thread_p, tdes, log_record, data_size, <a class="code" href="namespacestatdump__to__csv.html#aedcb70fde9c0b07a0732db70deeec616">data</a>);</div><div class="line"><a name="l03960"></a><span class="lineno"> 3960</span>&#160;</div><div class="line"><a name="l03961"></a><span class="lineno"> 3961</span>&#160;      <span class="comment">/* log system operation end */</span></div><div class="line"><a name="l03962"></a><span class="lineno"> 3962</span>&#160;      log_append_sysop_end (thread_p, tdes, log_record, data_size, <a class="code" href="namespacestatdump__to__csv.html#aedcb70fde9c0b07a0732db70deeec616">data</a>);</div><div class="line"><a name="l03963"></a><span class="lineno"> 3963</span>&#160;</div><div class="line"><a name="l03964"></a><span class="lineno"> 3964</span>&#160;      <span class="comment">/* Remember last partial result */</span></div><div class="line"><a name="l03965"></a><span class="lineno"> 3965</span>&#160;      <a class="code" href="storage__common_8h.html#a4c9bc15296fe6728cf0351726cc6ad09">LSA_COPY</a> (&amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a35e52753b9c8d5e70696ae8f0479072f">tail_topresult_lsa</a>, &amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a5b128a08476a5b499cf82e3163e6d62b">tail_lsa</a>);</div><div class="line"><a name="l03966"></a><span class="lineno"> 3966</span>&#160;    }</div><div class="line"><a name="l03967"></a><span class="lineno"> 3967</span>&#160;</div><div class="line"><a name="l03968"></a><span class="lineno"> 3968</span>&#160;  <a class="code" href="log__manager_8c.html#acede8354bdcf6ae570ee030b4f57c07b">log_sysop_end_final</a> (thread_p, tdes);</div><div class="line"><a name="l03969"></a><span class="lineno"> 3969</span>&#160;}</div><div class="line"><a name="l03970"></a><span class="lineno"> 3970</span>&#160;</div><div class="line"><a name="l03971"></a><span class="lineno"> 3971</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l03972"></a><span class="lineno"> 3972</span>&#160;<span class="comment"> * log_sysop_commit () - Commit system operation. This is the default type to end a system operation successfully and</span></div><div class="line"><a name="l03973"></a><span class="lineno"> 3973</span>&#160;<span class="comment"> *           to guarantee atomicity/permanency of all its operations.</span></div><div class="line"><a name="l03974"></a><span class="lineno"> 3974</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l03975"></a><span class="lineno"> 3975</span>&#160;<span class="comment"> * return    : Void.</span></div><div class="line"><a name="l03976"></a><span class="lineno"> 3976</span>&#160;<span class="comment"> * thread_p (in) : Thread entry.</span></div><div class="line"><a name="l03977"></a><span class="lineno"> 3977</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l03978"></a><span class="lineno"> 3978</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l03979"></a><span class="lineno"><a class="line" href="log__manager_8h.html#a328d8671b52e43b27fdaa575415c61ed"> 3979</a></span>&#160;<a class="code" href="log__manager_8c.html#a328d8671b52e43b27fdaa575415c61ed">log_sysop_commit</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p)</div><div class="line"><a name="l03980"></a><span class="lineno"> 3980</span>&#160;{</div><div class="line"><a name="l03981"></a><span class="lineno"> 3981</span>&#160;  <a class="code" href="structlog__rec__sysop__end.html">LOG_REC_SYSOP_END</a> log_record;</div><div class="line"><a name="l03982"></a><span class="lineno"> 3982</span>&#160;</div><div class="line"><a name="l03983"></a><span class="lineno"> 3983</span>&#160;  log_record.<a class="code" href="structlog__rec__sysop__end.html#a3ea9d3ebfe5a0ed547670f1409fb385f">type</a> = <a class="code" href="log__impl_8h.html#a24797b2fe67e0ec8631d7a92fbef25c9a9e1c6cb1f049797b7b3f9230308663a3">LOG_SYSOP_END_COMMIT</a>;</div><div class="line"><a name="l03984"></a><span class="lineno"> 3984</span>&#160;</div><div class="line"><a name="l03985"></a><span class="lineno"> 3985</span>&#160;  log_sysop_commit_internal (thread_p, &amp;log_record, 0, <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <span class="keyword">false</span>);</div><div class="line"><a name="l03986"></a><span class="lineno"> 3986</span>&#160;}</div><div class="line"><a name="l03987"></a><span class="lineno"> 3987</span>&#160;</div><div class="line"><a name="l03988"></a><span class="lineno"> 3988</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l03989"></a><span class="lineno"> 3989</span>&#160;<span class="comment"> * log_sysop_end_logical_undo () - Commit system operation and add an undo log record. This is a logical undo for complex</span></div><div class="line"><a name="l03990"></a><span class="lineno"> 3990</span>&#160;<span class="comment"> *                operations that cannot be easily located when rollback or recovery undo is executed.</span></div><div class="line"><a name="l03991"></a><span class="lineno"> 3991</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l03992"></a><span class="lineno"> 3992</span>&#160;<span class="comment"> * return     : Void.</span></div><div class="line"><a name="l03993"></a><span class="lineno"> 3993</span>&#160;<span class="comment"> * thread_p (in)  : Thread entry.</span></div><div class="line"><a name="l03994"></a><span class="lineno"> 3994</span>&#160;<span class="comment"> * rcvindex (in)  : Recovery index for undo operation.</span></div><div class="line"><a name="l03995"></a><span class="lineno"> 3995</span>&#160;<span class="comment"> * vfid (in)      : NULL or file identifier. Must be not NULL for mvcc operations.</span></div><div class="line"><a name="l03996"></a><span class="lineno"> 3996</span>&#160;<span class="comment"> * undo_size (in) : Undo data size.</span></div><div class="line"><a name="l03997"></a><span class="lineno"> 3997</span>&#160;<span class="comment"> * undo_data (in) : Undo data.</span></div><div class="line"><a name="l03998"></a><span class="lineno"> 3998</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l03999"></a><span class="lineno"> 3999</span>&#160;<span class="comment"> * note: sys ops used for logical undo have a limitation: they cannot use postpone log records. this limitation can</span></div><div class="line"><a name="l04000"></a><span class="lineno"> 4000</span>&#160;<span class="comment"> *       be changed if needed by extending sys op start postpone log record to support undo data. so far, the extension</span></div><div class="line"><a name="l04001"></a><span class="lineno"> 4001</span>&#160;<span class="comment"> *       was not necessary.</span></div><div class="line"><a name="l04002"></a><span class="lineno"> 4002</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l04003"></a><span class="lineno"> 4003</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l04004"></a><span class="lineno"><a class="line" href="log__manager_8h.html#af6c9cbd5b7eedd3a08ed81eba4dc5556"> 4004</a></span>&#160;<a class="code" href="log__manager_8c.html#af6c9cbd5b7eedd3a08ed81eba4dc5556">log_sysop_end_logical_undo</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2b">LOG_RCVINDEX</a> rcvindex, <span class="keyword">const</span> <a class="code" href="structvfid.html">VFID</a> * <a class="code" href="structvfid.html">vfid</a>, <span class="keywordtype">int</span> undo_size,</div><div class="line"><a name="l04005"></a><span class="lineno"> 4005</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">char</span> *undo_data)</div><div class="line"><a name="l04006"></a><span class="lineno"> 4006</span>&#160;{</div><div class="line"><a name="l04007"></a><span class="lineno"> 4007</span>&#160;  <a class="code" href="structlog__rec__sysop__end.html">LOG_REC_SYSOP_END</a> log_record;</div><div class="line"><a name="l04008"></a><span class="lineno"> 4008</span>&#160;</div><div class="line"><a name="l04009"></a><span class="lineno"> 4009</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="log__impl_8h.html#abb2a79de9a9c6b39a4137ba3417daa0b">LOG_IS_MVCC_OPERATION</a> (rcvindex))</div><div class="line"><a name="l04010"></a><span class="lineno"> 4010</span>&#160;    {</div><div class="line"><a name="l04011"></a><span class="lineno"> 4011</span>&#160;      log_record.<a class="code" href="structlog__rec__sysop__end.html#a3ea9d3ebfe5a0ed547670f1409fb385f">type</a> = <a class="code" href="log__impl_8h.html#a24797b2fe67e0ec8631d7a92fbef25c9a571011a0354832edf02d40490f512716">LOG_SYSOP_END_LOGICAL_MVCC_UNDO</a>;</div><div class="line"><a name="l04012"></a><span class="lineno"> 4012</span>&#160;      log_record.<a class="code" href="structlog__rec__sysop__end.html#a013e84a84232dee701d8083c07a172c9">mvcc_undo</a>.<a class="code" href="structlog__rec__mvcc__undo.html#a7f17cde1def984989174d8aca50307b6">undo</a>.<a class="code" href="structlog__rec__undo.html#a08b364e1c642e56ea610a5e51beb7d2b">data</a>.<a class="code" href="structlog__data.html#afd25836b0952561036b01b5a50c310b2">offset</a> = <a class="code" href="storage__common_8h.html#a5b0ca3ea530f289fa3f19921e5b0faf3">NULL_OFFSET</a>;</div><div class="line"><a name="l04013"></a><span class="lineno"> 4013</span>&#160;      log_record.<a class="code" href="structlog__rec__sysop__end.html#a013e84a84232dee701d8083c07a172c9">mvcc_undo</a>.<a class="code" href="structlog__rec__mvcc__undo.html#a7f17cde1def984989174d8aca50307b6">undo</a>.<a class="code" href="structlog__rec__undo.html#a08b364e1c642e56ea610a5e51beb7d2b">data</a>.<a class="code" href="structlog__data.html#ad5635159b85ee07322bf30e39a5dee76">volid</a> = <a class="code" href="storage__common_8h.html#a5859fbd2f7cd3c37c37e672f812388ff">NULL_VOLID</a>;</div><div class="line"><a name="l04014"></a><span class="lineno"> 4014</span>&#160;      log_record.<a class="code" href="structlog__rec__sysop__end.html#a013e84a84232dee701d8083c07a172c9">mvcc_undo</a>.<a class="code" href="structlog__rec__mvcc__undo.html#a7f17cde1def984989174d8aca50307b6">undo</a>.<a class="code" href="structlog__rec__undo.html#a08b364e1c642e56ea610a5e51beb7d2b">data</a>.<a class="code" href="structlog__data.html#a8410b9d70cc70d2bc6fb6df88ea48bb4">pageid</a> = <a class="code" href="storage__common_8h.html#a7ed60eef43941f46fadae895f63ee033">NULL_PAGEID</a>;</div><div class="line"><a name="l04015"></a><span class="lineno"> 4015</span>&#160;      log_record.<a class="code" href="structlog__rec__sysop__end.html#a013e84a84232dee701d8083c07a172c9">mvcc_undo</a>.<a class="code" href="structlog__rec__mvcc__undo.html#a7f17cde1def984989174d8aca50307b6">undo</a>.<a class="code" href="structlog__rec__undo.html#a08b364e1c642e56ea610a5e51beb7d2b">data</a>.<a class="code" href="structlog__data.html#ab1a17fceea659d32f5187b81a7b80412">rcvindex</a> = rcvindex;</div><div class="line"><a name="l04016"></a><span class="lineno"> 4016</span>&#160;      log_record.<a class="code" href="structlog__rec__sysop__end.html#a013e84a84232dee701d8083c07a172c9">mvcc_undo</a>.<a class="code" href="structlog__rec__mvcc__undo.html#a7f17cde1def984989174d8aca50307b6">undo</a>.<a class="code" href="structlog__rec__undo.html#a50bcc130d05619893dbb63c284c3e874">length</a> = undo_size;</div><div class="line"><a name="l04017"></a><span class="lineno"> 4017</span>&#160;      log_record.<a class="code" href="structlog__rec__sysop__end.html#a013e84a84232dee701d8083c07a172c9">mvcc_undo</a>.<a class="code" href="structlog__rec__mvcc__undo.html#ae7c1bf9c8eb5a86167f621ac40445f96">mvccid</a> = <a class="code" href="log__impl_8h.html#acf5f6153472b3cc0416da31dd9f276c0">logtb_get_current_mvccid</a> (thread_p);</div><div class="line"><a name="l04018"></a><span class="lineno"> 4018</span>&#160;      log_record.<a class="code" href="structlog__rec__sysop__end.html#a013e84a84232dee701d8083c07a172c9">mvcc_undo</a>.<a class="code" href="structlog__rec__mvcc__undo.html#afb6e7f17fc0d9cbb25f0d94e0bba4efd">vacuum_info</a>.<a class="code" href="structlog__vacuum__info.html#aeb919b86c45ee91e08f67f3c13bb9465">vfid</a> = *<a class="code" href="structvfid.html">vfid</a>;</div><div class="line"><a name="l04019"></a><span class="lineno"> 4019</span>&#160;      <a class="code" href="storage__common_8h.html#a6a4baec606189dd320678e8f412ca957">LSA_SET_NULL</a> (&amp;log_record.<a class="code" href="structlog__rec__sysop__end.html#a013e84a84232dee701d8083c07a172c9">mvcc_undo</a>.<a class="code" href="structlog__rec__mvcc__undo.html#afb6e7f17fc0d9cbb25f0d94e0bba4efd">vacuum_info</a>.<a class="code" href="structlog__vacuum__info.html#a1fc0aeb2562118f210e453ffff9d75da">prev_mvcc_op_log_lsa</a>);</div><div class="line"><a name="l04020"></a><span class="lineno"> 4020</span>&#160;    }</div><div class="line"><a name="l04021"></a><span class="lineno"> 4021</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l04022"></a><span class="lineno"> 4022</span>&#160;    {</div><div class="line"><a name="l04023"></a><span class="lineno"> 4023</span>&#160;      log_record.<a class="code" href="structlog__rec__sysop__end.html#a3ea9d3ebfe5a0ed547670f1409fb385f">type</a> = <a class="code" href="log__impl_8h.html#a24797b2fe67e0ec8631d7a92fbef25c9ac4566a4bae57d0a42fa6e37cc65e5329">LOG_SYSOP_END_LOGICAL_UNDO</a>;</div><div class="line"><a name="l04024"></a><span class="lineno"> 4024</span>&#160;      log_record.<a class="code" href="structlog__rec__sysop__end.html#a34c029c46715b2edc97a8f2c5ce9d309">undo</a>.<a class="code" href="structlog__rec__undo.html#a08b364e1c642e56ea610a5e51beb7d2b">data</a>.<a class="code" href="structlog__data.html#afd25836b0952561036b01b5a50c310b2">offset</a> = <a class="code" href="storage__common_8h.html#a5b0ca3ea530f289fa3f19921e5b0faf3">NULL_OFFSET</a>;</div><div class="line"><a name="l04025"></a><span class="lineno"> 4025</span>&#160;      log_record.<a class="code" href="structlog__rec__sysop__end.html#a34c029c46715b2edc97a8f2c5ce9d309">undo</a>.<a class="code" href="structlog__rec__undo.html#a08b364e1c642e56ea610a5e51beb7d2b">data</a>.<a class="code" href="structlog__data.html#ad5635159b85ee07322bf30e39a5dee76">volid</a> = <a class="code" href="storage__common_8h.html#a5859fbd2f7cd3c37c37e672f812388ff">NULL_VOLID</a>;</div><div class="line"><a name="l04026"></a><span class="lineno"> 4026</span>&#160;      log_record.<a class="code" href="structlog__rec__sysop__end.html#a34c029c46715b2edc97a8f2c5ce9d309">undo</a>.<a class="code" href="structlog__rec__undo.html#a08b364e1c642e56ea610a5e51beb7d2b">data</a>.<a class="code" href="structlog__data.html#a8410b9d70cc70d2bc6fb6df88ea48bb4">pageid</a> = <a class="code" href="storage__common_8h.html#a7ed60eef43941f46fadae895f63ee033">NULL_PAGEID</a>;</div><div class="line"><a name="l04027"></a><span class="lineno"> 4027</span>&#160;      log_record.<a class="code" href="structlog__rec__sysop__end.html#a34c029c46715b2edc97a8f2c5ce9d309">undo</a>.<a class="code" href="structlog__rec__undo.html#a08b364e1c642e56ea610a5e51beb7d2b">data</a>.<a class="code" href="structlog__data.html#ab1a17fceea659d32f5187b81a7b80412">rcvindex</a> = rcvindex;</div><div class="line"><a name="l04028"></a><span class="lineno"> 4028</span>&#160;      log_record.<a class="code" href="structlog__rec__sysop__end.html#a34c029c46715b2edc97a8f2c5ce9d309">undo</a>.<a class="code" href="structlog__rec__undo.html#a50bcc130d05619893dbb63c284c3e874">length</a> = undo_size;</div><div class="line"><a name="l04029"></a><span class="lineno"> 4029</span>&#160;    }</div><div class="line"><a name="l04030"></a><span class="lineno"> 4030</span>&#160;</div><div class="line"><a name="l04031"></a><span class="lineno"> 4031</span>&#160;  log_sysop_commit_internal (thread_p, &amp;log_record, undo_size, undo_data, <span class="keyword">false</span>);</div><div class="line"><a name="l04032"></a><span class="lineno"> 4032</span>&#160;}</div><div class="line"><a name="l04033"></a><span class="lineno"> 4033</span>&#160;</div><div class="line"><a name="l04034"></a><span class="lineno"> 4034</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l04035"></a><span class="lineno"> 4035</span>&#160;<span class="comment"> * log_sysop_commit_and_compensate () - Commit system operation and add a compensate log record. This is a logical</span></div><div class="line"><a name="l04036"></a><span class="lineno"> 4036</span>&#160;<span class="comment"> *                  compensation that is too complex to be included in a single log record.</span></div><div class="line"><a name="l04037"></a><span class="lineno"> 4037</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04038"></a><span class="lineno"> 4038</span>&#160;<span class="comment"> * return      : Void.</span></div><div class="line"><a name="l04039"></a><span class="lineno"> 4039</span>&#160;<span class="comment"> * thread_p (in)   : Thread entry.</span></div><div class="line"><a name="l04040"></a><span class="lineno"> 4040</span>&#160;<span class="comment"> * undo_nxlsa (in) : LSA of next undo LSA (equivalent to compensated undo record previous LSA).</span></div><div class="line"><a name="l04041"></a><span class="lineno"> 4041</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l04042"></a><span class="lineno"> 4042</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l04043"></a><span class="lineno"><a class="line" href="log__manager_8h.html#afd1a2421cd94bcd23d1eae834e6a1d28"> 4043</a></span>&#160;<a class="code" href="log__manager_8c.html#afd1a2421cd94bcd23d1eae834e6a1d28">log_sysop_end_logical_compensate</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="structlog__lsa.html">LOG_LSA</a> * undo_nxlsa)</div><div class="line"><a name="l04044"></a><span class="lineno"> 4044</span>&#160;{</div><div class="line"><a name="l04045"></a><span class="lineno"> 4045</span>&#160;  <a class="code" href="structlog__rec__sysop__end.html">LOG_REC_SYSOP_END</a> log_record;</div><div class="line"><a name="l04046"></a><span class="lineno"> 4046</span>&#160;</div><div class="line"><a name="l04047"></a><span class="lineno"> 4047</span>&#160;  log_record.<a class="code" href="structlog__rec__sysop__end.html#a3ea9d3ebfe5a0ed547670f1409fb385f">type</a> = <a class="code" href="log__impl_8h.html#a24797b2fe67e0ec8631d7a92fbef25c9a69f84e9574e7f583c88733bdea3a415f">LOG_SYSOP_END_LOGICAL_COMPENSATE</a>;</div><div class="line"><a name="l04048"></a><span class="lineno"> 4048</span>&#160;  log_record.<a class="code" href="structlog__rec__sysop__end.html#ab094b81b70e8d75dbb0d38f29cc18f62">compensate_lsa</a> = *undo_nxlsa;</div><div class="line"><a name="l04049"></a><span class="lineno"> 4049</span>&#160;</div><div class="line"><a name="l04050"></a><span class="lineno"> 4050</span>&#160;  log_sysop_commit_internal (thread_p, &amp;log_record, 0, <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <span class="keyword">false</span>);</div><div class="line"><a name="l04051"></a><span class="lineno"> 4051</span>&#160;}</div><div class="line"><a name="l04052"></a><span class="lineno"> 4052</span>&#160;</div><div class="line"><a name="l04053"></a><span class="lineno"> 4053</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l04054"></a><span class="lineno"> 4054</span>&#160;<span class="comment"> * log_sysop_end_logical_run_postpone () - Commit system operation and add a run postpone log record. This is a logical</span></div><div class="line"><a name="l04055"></a><span class="lineno"> 4055</span>&#160;<span class="comment"> *                     run postpone that is too complex to be included in a single log record.</span></div><div class="line"><a name="l04056"></a><span class="lineno"> 4056</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04057"></a><span class="lineno"> 4057</span>&#160;<span class="comment"> * return    : Void.</span></div><div class="line"><a name="l04058"></a><span class="lineno"> 4058</span>&#160;<span class="comment"> * thread_p (in) : Thread entry.</span></div><div class="line"><a name="l04059"></a><span class="lineno"> 4059</span>&#160;<span class="comment"> * posp_lsa (in) : The LSA of postpone record which was executed by this run postpone.</span></div><div class="line"><a name="l04060"></a><span class="lineno"> 4060</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l04061"></a><span class="lineno"> 4061</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l04062"></a><span class="lineno"><a class="line" href="log__manager_8h.html#a00976c440ea1347035bf5d8a707279e5"> 4062</a></span>&#160;<a class="code" href="log__manager_8c.html#a00976c440ea1347035bf5d8a707279e5">log_sysop_end_logical_run_postpone</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="structlog__lsa.html">LOG_LSA</a> * posp_lsa)</div><div class="line"><a name="l04063"></a><span class="lineno"> 4063</span>&#160;{</div><div class="line"><a name="l04064"></a><span class="lineno"> 4064</span>&#160;  <a class="code" href="structlog__rec__sysop__end.html">LOG_REC_SYSOP_END</a> log_record;</div><div class="line"><a name="l04065"></a><span class="lineno"> 4065</span>&#160;</div><div class="line"><a name="l04066"></a><span class="lineno"> 4066</span>&#160;  log_record.<a class="code" href="structlog__rec__sysop__end.html#a3ea9d3ebfe5a0ed547670f1409fb385f">type</a> = <a class="code" href="log__impl_8h.html#a24797b2fe67e0ec8631d7a92fbef25c9ada41432cf121d5aafecae01984edd8e7">LOG_SYSOP_END_LOGICAL_RUN_POSTPONE</a>;</div><div class="line"><a name="l04067"></a><span class="lineno"> 4067</span>&#160;  log_record.<a class="code" href="structlog__rec__sysop__end.html#a972f4330fb7cee921ad0dd2dbd6677ae">run_postpone</a>.postpone_lsa = *posp_lsa;</div><div class="line"><a name="l04068"></a><span class="lineno"> 4068</span>&#160;  <span class="comment">/* is_sysop_postpone will be set in log_sysop_commit_internal */</span></div><div class="line"><a name="l04069"></a><span class="lineno"> 4069</span>&#160;</div><div class="line"><a name="l04070"></a><span class="lineno"> 4070</span>&#160;  log_sysop_commit_internal (thread_p, &amp;log_record, 0, <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <span class="keyword">false</span>);</div><div class="line"><a name="l04071"></a><span class="lineno"> 4071</span>&#160;}</div><div class="line"><a name="l04072"></a><span class="lineno"> 4072</span>&#160;</div><div class="line"><a name="l04073"></a><span class="lineno"> 4073</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l04074"></a><span class="lineno"> 4074</span>&#160;<span class="comment"> * log_sysop_end_recovery_postpone () - called during recovery to finish the postpone phase of system op</span></div><div class="line"><a name="l04075"></a><span class="lineno"> 4075</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04076"></a><span class="lineno"> 4076</span>&#160;<span class="comment"> * return          : void</span></div><div class="line"><a name="l04077"></a><span class="lineno"> 4077</span>&#160;<span class="comment"> * thread_p (in)   : thread entry</span></div><div class="line"><a name="l04078"></a><span class="lineno"> 4078</span>&#160;<span class="comment"> * log_record (in) : end system op log record as it was read from start postpone log record</span></div><div class="line"><a name="l04079"></a><span class="lineno"> 4079</span>&#160;<span class="comment"> * data_size (in)  : undo data size</span></div><div class="line"><a name="l04080"></a><span class="lineno"> 4080</span>&#160;<span class="comment"> * data (in)       : undo data</span></div><div class="line"><a name="l04081"></a><span class="lineno"> 4081</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l04082"></a><span class="lineno"> 4082</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l04083"></a><span class="lineno"><a class="line" href="log__manager_8h.html#a7dabe9d7858297fd2182b90398ca3a94"> 4083</a></span>&#160;<a class="code" href="log__manager_8c.html#a7dabe9d7858297fd2182b90398ca3a94">log_sysop_end_recovery_postpone</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="structlog__rec__sysop__end.html">LOG_REC_SYSOP_END</a> * log_record, <span class="keywordtype">int</span> data_size,</div><div class="line"><a name="l04084"></a><span class="lineno"> 4084</span>&#160;                 <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="namespacestatdump__to__csv.html#aedcb70fde9c0b07a0732db70deeec616">data</a>)</div><div class="line"><a name="l04085"></a><span class="lineno"> 4085</span>&#160;{</div><div class="line"><a name="l04086"></a><span class="lineno"> 4086</span>&#160;  log_sysop_commit_internal (thread_p, log_record, data_size, <a class="code" href="namespacestatdump__to__csv.html#aedcb70fde9c0b07a0732db70deeec616">data</a>, <span class="keyword">true</span>);</div><div class="line"><a name="l04087"></a><span class="lineno"> 4087</span>&#160;}</div><div class="line"><a name="l04088"></a><span class="lineno"> 4088</span>&#160;</div><div class="line"><a name="l04089"></a><span class="lineno"> 4089</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l04090"></a><span class="lineno"> 4090</span>&#160;<span class="comment"> * log_sysop_abort () - Abort sytem operations (usually due to errors). All changes in this system operation are</span></div><div class="line"><a name="l04091"></a><span class="lineno"> 4091</span>&#160;<span class="comment"> *          rollbacked.</span></div><div class="line"><a name="l04092"></a><span class="lineno"> 4092</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04093"></a><span class="lineno"> 4093</span>&#160;<span class="comment"> * return    : Void.</span></div><div class="line"><a name="l04094"></a><span class="lineno"> 4094</span>&#160;<span class="comment"> * thread_p (in) : Thread entry.</span></div><div class="line"><a name="l04095"></a><span class="lineno"> 4095</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l04096"></a><span class="lineno"> 4096</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l04097"></a><span class="lineno"><a class="line" href="log__manager_8h.html#a8ba8a8666ca892dac7b456367d153965"> 4097</a></span>&#160;<a class="code" href="log__manager_8c.html#a8ba8a8666ca892dac7b456367d153965">log_sysop_abort</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p)</div><div class="line"><a name="l04098"></a><span class="lineno"> 4098</span>&#160;{</div><div class="line"><a name="l04099"></a><span class="lineno"> 4099</span>&#160;  <span class="keywordtype">int</span> tran_index;</div><div class="line"><a name="l04100"></a><span class="lineno"> 4100</span>&#160;  <a class="code" href="structlog__tdes.html">LOG_TDES</a> *tdes = <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l04101"></a><span class="lineno"> 4101</span>&#160;  <a class="code" href="structlog__rec__sysop__end.html">LOG_REC_SYSOP_END</a> sysop_end;</div><div class="line"><a name="l04102"></a><span class="lineno"> 4102</span>&#160;</div><div class="line"><a name="l04103"></a><span class="lineno"> 4103</span>&#160;  <a class="code" href="log__manager_8c.html#a1504524244c9badcc53c1bb8b0d4213f">log_sysop_end_begin</a> (thread_p, &amp;tran_index, &amp;tdes);</div><div class="line"><a name="l04104"></a><span class="lineno"> 4104</span>&#160;  <span class="keywordflow">if</span> (tdes == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l04105"></a><span class="lineno"> 4105</span>&#160;    {</div><div class="line"><a name="l04106"></a><span class="lineno"> 4106</span>&#160;      <a class="code" href="error__manager_8h.html#a34b88b0e828e26dd5cf930a0b1dd57a7">assert_release</a> (<span class="keyword">false</span>);</div><div class="line"><a name="l04107"></a><span class="lineno"> 4107</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l04108"></a><span class="lineno"> 4108</span>&#160;    }</div><div class="line"><a name="l04109"></a><span class="lineno"> 4109</span>&#160;</div><div class="line"><a name="l04110"></a><span class="lineno"> 4110</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="storage__common_8h.html#a26dd766712df5b5c4fcd158f571a75e4">LSA_ISNULL</a> (&amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a5b128a08476a5b499cf82e3163e6d62b">tail_lsa</a>) || <a class="code" href="storage__common_8h.html#a7f9d98414f81d41e639e744027e15947">LSA_LE</a> (&amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a5b128a08476a5b499cf82e3163e6d62b">tail_lsa</a>, &amp;<a class="code" href="log__manager_8c.html#a514c12210485928e3c0446bf9e3d371c">LOG_TDES_LAST_SYSOP</a> (tdes)-&gt;lastparent_lsa))</div><div class="line"><a name="l04111"></a><span class="lineno"> 4111</span>&#160;    {</div><div class="line"><a name="l04112"></a><span class="lineno"> 4112</span>&#160;      <span class="comment">/* No change. */</span></div><div class="line"><a name="l04113"></a><span class="lineno"> 4113</span>&#160;    }</div><div class="line"><a name="l04114"></a><span class="lineno"> 4114</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l04115"></a><span class="lineno"> 4115</span>&#160;    {</div><div class="line"><a name="l04116"></a><span class="lineno"> 4116</span>&#160;      <a class="code" href="log__comm_8h.html#a3c0be9b9f104459ab90ee18af95c4b3e">TRAN_STATE</a> save_state;</div><div class="line"><a name="l04117"></a><span class="lineno"> 4117</span>&#160;</div><div class="line"><a name="l04118"></a><span class="lineno"> 4118</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="log__impl_8h.html#a2d9876809ffa8473b6b47c5edcff6ca2">LOG_CHECK_LOG_APPLIER</a> (thread_p) &amp;&amp; !<a class="code" href="vacuum_8h.html#ab0e1deb8da1aa663aa073b0ce78606a2">VACUUM_IS_THREAD_VACUUM</a> (thread_p)</div><div class="line"><a name="l04119"></a><span class="lineno"> 4119</span>&#160;      &amp;&amp; <a class="code" href="log__comm_8c.html#ae3b5771bd95aa37a187f3a6e0cb2b32d">log_does_allow_replication</a> () == <span class="keyword">true</span>)</div><div class="line"><a name="l04120"></a><span class="lineno"> 4120</span>&#160;    {</div><div class="line"><a name="l04121"></a><span class="lineno"> 4121</span>&#160;      repl_log_abort_after_lsa (tdes, <a class="code" href="log__manager_8c.html#ab278939e239bb84cc9c118b55260a500">LOG_TDES_LAST_SYSOP_PARENT_LSA</a> (tdes));</div><div class="line"><a name="l04122"></a><span class="lineno"> 4122</span>&#160;    }</div><div class="line"><a name="l04123"></a><span class="lineno"> 4123</span>&#160;</div><div class="line"><a name="l04124"></a><span class="lineno"> 4124</span>&#160;      <span class="comment">/* Abort changes in system op. */</span></div><div class="line"><a name="l04125"></a><span class="lineno"> 4125</span>&#160;      save_state = tdes-&gt;<a class="code" href="structlog__tdes.html#ad924146690490b840ef5c3f65c3a5a6c">state</a>;</div><div class="line"><a name="l04126"></a><span class="lineno"> 4126</span>&#160;      tdes-&gt;<a class="code" href="structlog__tdes.html#ad924146690490b840ef5c3f65c3a5a6c">state</a> = <a class="code" href="log__comm_8h.html#a3c0be9b9f104459ab90ee18af95c4b3eac19d6ad89f93ec75c1e1904db0e5c0ad">TRAN_UNACTIVE_ABORTED</a>;</div><div class="line"><a name="l04127"></a><span class="lineno"> 4127</span>&#160;</div><div class="line"><a name="l04128"></a><span class="lineno"> 4128</span>&#160;      <span class="comment">/* Rollback changes. */</span></div><div class="line"><a name="l04129"></a><span class="lineno"> 4129</span>&#160;      log_rollback (thread_p, tdes, <a class="code" href="log__manager_8c.html#ab278939e239bb84cc9c118b55260a500">LOG_TDES_LAST_SYSOP_PARENT_LSA</a> (tdes));</div><div class="line"><a name="l04130"></a><span class="lineno"> 4130</span>&#160;      log_rollback_classrepr_cache (thread_p, tdes, <a class="code" href="log__manager_8c.html#ab278939e239bb84cc9c118b55260a500">LOG_TDES_LAST_SYSOP_PARENT_LSA</a> (tdes));</div><div class="line"><a name="l04131"></a><span class="lineno"> 4131</span>&#160;</div><div class="line"><a name="l04132"></a><span class="lineno"> 4132</span>&#160;      <span class="comment">/* Log abort system operation. */</span></div><div class="line"><a name="l04133"></a><span class="lineno"> 4133</span>&#160;      sysop_end.<a class="code" href="structlog__rec__sysop__end.html#a3ea9d3ebfe5a0ed547670f1409fb385f">type</a> = <a class="code" href="log__impl_8h.html#a24797b2fe67e0ec8631d7a92fbef25c9a9530c67a9b21ab7a54d7c906f900a247">LOG_SYSOP_END_ABORT</a>;</div><div class="line"><a name="l04134"></a><span class="lineno"> 4134</span>&#160;      sysop_end.<a class="code" href="structlog__rec__sysop__end.html#ac228866b1723dfd1165550c037fdc3aa">lastparent_lsa</a> = *<a class="code" href="log__manager_8c.html#ab278939e239bb84cc9c118b55260a500">LOG_TDES_LAST_SYSOP_PARENT_LSA</a> (tdes);</div><div class="line"><a name="l04135"></a><span class="lineno"> 4135</span>&#160;      sysop_end.<a class="code" href="structlog__rec__sysop__end.html#aee18ec7d007cfa72f33ca61fcb93e7b3">prv_topresult_lsa</a> = tdes-&gt;<a class="code" href="structlog__tdes.html#a35e52753b9c8d5e70696ae8f0479072f">tail_topresult_lsa</a>;</div><div class="line"><a name="l04136"></a><span class="lineno"> 4136</span>&#160;      log_append_sysop_end (thread_p, tdes, &amp;sysop_end, 0, <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l04137"></a><span class="lineno"> 4137</span>&#160;</div><div class="line"><a name="l04138"></a><span class="lineno"> 4138</span>&#160;      <span class="comment">/* Remember last partial result */</span></div><div class="line"><a name="l04139"></a><span class="lineno"> 4139</span>&#160;      <a class="code" href="storage__common_8h.html#a4c9bc15296fe6728cf0351726cc6ad09">LSA_COPY</a> (&amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a35e52753b9c8d5e70696ae8f0479072f">tail_topresult_lsa</a>, &amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a5b128a08476a5b499cf82e3163e6d62b">tail_lsa</a>);</div><div class="line"><a name="l04140"></a><span class="lineno"> 4140</span>&#160;</div><div class="line"><a name="l04141"></a><span class="lineno"> 4141</span>&#160;      <span class="comment">/* Restore transaction state. */</span></div><div class="line"><a name="l04142"></a><span class="lineno"> 4142</span>&#160;      tdes-&gt;<a class="code" href="structlog__tdes.html#ad924146690490b840ef5c3f65c3a5a6c">state</a> = save_state;</div><div class="line"><a name="l04143"></a><span class="lineno"> 4143</span>&#160;    }</div><div class="line"><a name="l04144"></a><span class="lineno"> 4144</span>&#160;</div><div class="line"><a name="l04145"></a><span class="lineno"> 4145</span>&#160;  <a class="code" href="log__manager_8c.html#acede8354bdcf6ae570ee030b4f57c07b">log_sysop_end_final</a> (thread_p, tdes);</div><div class="line"><a name="l04146"></a><span class="lineno"> 4146</span>&#160;}</div><div class="line"><a name="l04147"></a><span class="lineno"> 4147</span>&#160;</div><div class="line"><a name="l04148"></a><span class="lineno"> 4148</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l04149"></a><span class="lineno"> 4149</span>&#160;<span class="comment"> * log_sysop_attach_to_outer () - Attach system operation to its immediate parent (another system operation or, if this</span></div><div class="line"><a name="l04150"></a><span class="lineno"> 4150</span>&#160;<span class="comment"> *                is top system operation, to transaction descriptor).</span></div><div class="line"><a name="l04151"></a><span class="lineno"> 4151</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04152"></a><span class="lineno"> 4152</span>&#160;<span class="comment"> * return    : Void.</span></div><div class="line"><a name="l04153"></a><span class="lineno"> 4153</span>&#160;<span class="comment"> * thread_p (in) : Thread entry.</span></div><div class="line"><a name="l04154"></a><span class="lineno"> 4154</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l04155"></a><span class="lineno"> 4155</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l04156"></a><span class="lineno"><a class="line" href="log__manager_8h.html#a5e97a30aa978dafbca4f7180c5d3909f"> 4156</a></span>&#160;<a class="code" href="log__manager_8c.html#a5e97a30aa978dafbca4f7180c5d3909f">log_sysop_attach_to_outer</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p)</div><div class="line"><a name="l04157"></a><span class="lineno"> 4157</span>&#160;{</div><div class="line"><a name="l04158"></a><span class="lineno"> 4158</span>&#160;  <span class="keywordtype">int</span> tran_index;</div><div class="line"><a name="l04159"></a><span class="lineno"> 4159</span>&#160;  <a class="code" href="structlog__tdes.html">LOG_TDES</a> *tdes = <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l04160"></a><span class="lineno"> 4160</span>&#160;</div><div class="line"><a name="l04161"></a><span class="lineno"> 4161</span>&#160;  <a class="code" href="log__manager_8c.html#a1504524244c9badcc53c1bb8b0d4213f">log_sysop_end_begin</a> (thread_p, &amp;tran_index, &amp;tdes);</div><div class="line"><a name="l04162"></a><span class="lineno"> 4162</span>&#160;  <span class="keywordflow">if</span> (tdes == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l04163"></a><span class="lineno"> 4163</span>&#160;    {</div><div class="line"><a name="l04164"></a><span class="lineno"> 4164</span>&#160;      <a class="code" href="error__manager_8h.html#a34b88b0e828e26dd5cf930a0b1dd57a7">assert_release</a> (<span class="keyword">false</span>);</div><div class="line"><a name="l04165"></a><span class="lineno"> 4165</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l04166"></a><span class="lineno"> 4166</span>&#160;    }</div><div class="line"><a name="l04167"></a><span class="lineno"> 4167</span>&#160;</div><div class="line"><a name="l04168"></a><span class="lineno"> 4168</span>&#160;  <span class="comment">/* Is attach to outer allowed? */</span></div><div class="line"><a name="l04169"></a><span class="lineno"> 4169</span>&#160;  <span class="keywordflow">if</span> (tdes-&gt;<a class="code" href="structlog__tdes.html#a97c1d42917ab4d08ffe3194fc7233018">topops</a>.<a class="code" href="structlog__topops__stack.html#a5e509dcc15d89abc0c6ba486af6dba4d">last</a> == 0 &amp;&amp; (!<a class="code" href="log__impl_8h.html#aa81dc352329c9f96467c795c1547be74">LOG_ISTRAN_ACTIVE</a> (tdes) || <a class="code" href="vacuum_8h.html#ab0e1deb8da1aa663aa073b0ce78606a2">VACUUM_IS_THREAD_VACUUM</a> (thread_p)))</div><div class="line"><a name="l04170"></a><span class="lineno"> 4170</span>&#160;    {</div><div class="line"><a name="l04171"></a><span class="lineno"> 4171</span>&#160;      <span class="comment">/* Nothing to attach to. Be conservative and commit the transaction. */</span></div><div class="line"><a name="l04172"></a><span class="lineno"> 4172</span>&#160;      <a class="code" href="error__manager_8h.html#a34b88b0e828e26dd5cf930a0b1dd57a7">assert_release</a> (<span class="keyword">false</span>);</div><div class="line"><a name="l04173"></a><span class="lineno"> 4173</span>&#160;      <a class="code" href="log__manager_8c.html#a328d8671b52e43b27fdaa575415c61ed">log_sysop_commit</a> (thread_p);</div><div class="line"><a name="l04174"></a><span class="lineno"> 4174</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l04175"></a><span class="lineno"> 4175</span>&#160;    }</div><div class="line"><a name="l04176"></a><span class="lineno"> 4176</span>&#160;</div><div class="line"><a name="l04177"></a><span class="lineno"> 4177</span>&#160;  <span class="comment">/* Attach to outer: transfer postpone LSA. Not much to do really :) */</span></div><div class="line"><a name="l04178"></a><span class="lineno"> 4178</span>&#160;  <span class="keywordflow">if</span> (tdes-&gt;<a class="code" href="structlog__tdes.html#a97c1d42917ab4d08ffe3194fc7233018">topops</a>.<a class="code" href="structlog__topops__stack.html#a5e509dcc15d89abc0c6ba486af6dba4d">last</a> - 1 &gt;= 0)</div><div class="line"><a name="l04179"></a><span class="lineno"> 4179</span>&#160;    {</div><div class="line"><a name="l04180"></a><span class="lineno"> 4180</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="storage__common_8h.html#a26dd766712df5b5c4fcd158f571a75e4">LSA_ISNULL</a> (&amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a97c1d42917ab4d08ffe3194fc7233018">topops</a>.<a class="code" href="structlog__topops__stack.html#aeeae85de5bdc4f49b8ba730b25ab092b">stack</a>[tdes-&gt;<a class="code" href="structlog__tdes.html#a97c1d42917ab4d08ffe3194fc7233018">topops</a>.<a class="code" href="structlog__topops__stack.html#a5e509dcc15d89abc0c6ba486af6dba4d">last</a> - 1].<a class="code" href="structlog__topops__addresses.html#a94da18d9054fe91a3b114b4262301737">posp_lsa</a>))</div><div class="line"><a name="l04181"></a><span class="lineno"> 4181</span>&#160;    {</div><div class="line"><a name="l04182"></a><span class="lineno"> 4182</span>&#160;      <a class="code" href="storage__common_8h.html#a4c9bc15296fe6728cf0351726cc6ad09">LSA_COPY</a> (&amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a97c1d42917ab4d08ffe3194fc7233018">topops</a>.<a class="code" href="structlog__topops__stack.html#aeeae85de5bdc4f49b8ba730b25ab092b">stack</a>[tdes-&gt;<a class="code" href="structlog__tdes.html#a97c1d42917ab4d08ffe3194fc7233018">topops</a>.<a class="code" href="structlog__topops__stack.html#a5e509dcc15d89abc0c6ba486af6dba4d">last</a> - 1].<a class="code" href="structlog__topops__addresses.html#a94da18d9054fe91a3b114b4262301737">posp_lsa</a>,</div><div class="line"><a name="l04183"></a><span class="lineno"> 4183</span>&#160;            &amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a97c1d42917ab4d08ffe3194fc7233018">topops</a>.<a class="code" href="structlog__topops__stack.html#aeeae85de5bdc4f49b8ba730b25ab092b">stack</a>[tdes-&gt;<a class="code" href="structlog__tdes.html#a97c1d42917ab4d08ffe3194fc7233018">topops</a>.<a class="code" href="structlog__topops__stack.html#a5e509dcc15d89abc0c6ba486af6dba4d">last</a>].<a class="code" href="structlog__topops__addresses.html#a94da18d9054fe91a3b114b4262301737">posp_lsa</a>);</div><div class="line"><a name="l04184"></a><span class="lineno"> 4184</span>&#160;    }</div><div class="line"><a name="l04185"></a><span class="lineno"> 4185</span>&#160;    }</div><div class="line"><a name="l04186"></a><span class="lineno"> 4186</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l04187"></a><span class="lineno"> 4187</span>&#160;    {</div><div class="line"><a name="l04188"></a><span class="lineno"> 4188</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="storage__common_8h.html#a26dd766712df5b5c4fcd158f571a75e4">LSA_ISNULL</a> (&amp;tdes-&gt;<a class="code" href="structlog__tdes.html#aef11834afdfbe3e8bd7f530ec269b327">posp_nxlsa</a>))</div><div class="line"><a name="l04189"></a><span class="lineno"> 4189</span>&#160;    {</div><div class="line"><a name="l04190"></a><span class="lineno"> 4190</span>&#160;      <a class="code" href="storage__common_8h.html#a4c9bc15296fe6728cf0351726cc6ad09">LSA_COPY</a> (&amp;tdes-&gt;<a class="code" href="structlog__tdes.html#aef11834afdfbe3e8bd7f530ec269b327">posp_nxlsa</a>, &amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a97c1d42917ab4d08ffe3194fc7233018">topops</a>.<a class="code" href="structlog__topops__stack.html#aeeae85de5bdc4f49b8ba730b25ab092b">stack</a>[tdes-&gt;<a class="code" href="structlog__tdes.html#a97c1d42917ab4d08ffe3194fc7233018">topops</a>.<a class="code" href="structlog__topops__stack.html#a5e509dcc15d89abc0c6ba486af6dba4d">last</a>].<a class="code" href="structlog__topops__addresses.html#a94da18d9054fe91a3b114b4262301737">posp_lsa</a>);</div><div class="line"><a name="l04191"></a><span class="lineno"> 4191</span>&#160;    }</div><div class="line"><a name="l04192"></a><span class="lineno"> 4192</span>&#160;    }</div><div class="line"><a name="l04193"></a><span class="lineno"> 4193</span>&#160;</div><div class="line"><a name="l04194"></a><span class="lineno"> 4194</span>&#160;  <a class="code" href="log__manager_8c.html#acede8354bdcf6ae570ee030b4f57c07b">log_sysop_end_final</a> (thread_p, tdes);</div><div class="line"><a name="l04195"></a><span class="lineno"> 4195</span>&#160;}</div><div class="line"><a name="l04196"></a><span class="lineno"> 4196</span>&#160;</div><div class="line"><a name="l04197"></a><span class="lineno"> 4197</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l04198"></a><span class="lineno"> 4198</span>&#160;<span class="comment"> * log_sysop_get_level () - Get current system operation level. If no system operation is started, it returns -1.</span></div><div class="line"><a name="l04199"></a><span class="lineno"> 4199</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04200"></a><span class="lineno"> 4200</span>&#160;<span class="comment"> * return        : System op level</span></div><div class="line"><a name="l04201"></a><span class="lineno"> 4201</span>&#160;<span class="comment"> * thread_p (in) : Thread entry</span></div><div class="line"><a name="l04202"></a><span class="lineno"> 4202</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l04203"></a><span class="lineno"> 4203</span>&#160;<a class="code" href="porting_8h.html#a718749e18d63ca0d6b0d1b918efb41d6">STATIC_INLINE</a> <span class="keywordtype">int</span></div><div class="line"><a name="l04204"></a><span class="lineno"><a class="line" href="log__manager_8c.html#a3cec5baaf013ea91aa2dca8fe7860686"> 4204</a></span>&#160;<a class="code" href="log__manager_8c.html#a3cec5baaf013ea91aa2dca8fe7860686">log_sysop_get_level</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p)</div><div class="line"><a name="l04205"></a><span class="lineno"> 4205</span>&#160;{</div><div class="line"><a name="l04206"></a><span class="lineno"> 4206</span>&#160;  <span class="keywordtype">int</span> tran_index;</div><div class="line"><a name="l04207"></a><span class="lineno"> 4207</span>&#160;  <a class="code" href="structlog__tdes.html">LOG_TDES</a> *tdes = <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l04208"></a><span class="lineno"> 4208</span>&#160;</div><div class="line"><a name="l04209"></a><span class="lineno"> 4209</span>&#160;  <a class="code" href="log__manager_8c.html#ac6a08ce8b6271d689e48b7bd96a32c7a">log_sysop_get_tran_index_and_tdes</a> (thread_p, &amp;tran_index, &amp;tdes);</div><div class="line"><a name="l04210"></a><span class="lineno"> 4210</span>&#160;  <span class="keywordflow">if</span> (tdes == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l04211"></a><span class="lineno"> 4211</span>&#160;    {</div><div class="line"><a name="l04212"></a><span class="lineno"> 4212</span>&#160;      <a class="code" href="error__manager_8h.html#a34b88b0e828e26dd5cf930a0b1dd57a7">assert_release</a> (<span class="keyword">false</span>);</div><div class="line"><a name="l04213"></a><span class="lineno"> 4213</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l04214"></a><span class="lineno"> 4214</span>&#160;    }</div><div class="line"><a name="l04215"></a><span class="lineno"> 4215</span>&#160;  <span class="keywordflow">return</span> tdes-&gt;<a class="code" href="structlog__tdes.html#a97c1d42917ab4d08ffe3194fc7233018">topops</a>.<a class="code" href="structlog__topops__stack.html#a5e509dcc15d89abc0c6ba486af6dba4d">last</a>;</div><div class="line"><a name="l04216"></a><span class="lineno"> 4216</span>&#160;}</div><div class="line"><a name="l04217"></a><span class="lineno"> 4217</span>&#160;</div><div class="line"><a name="l04218"></a><span class="lineno"> 4218</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l04219"></a><span class="lineno"> 4219</span>&#160;<span class="comment"> * log_sysop_get_tran_index_and_tdes () - Get transaction descriptor for system operations (in case of VACUUM, it will</span></div><div class="line"><a name="l04220"></a><span class="lineno"> 4220</span>&#160;<span class="comment"> *                                        return the thread special tdes instead of system tdes).</span></div><div class="line"><a name="l04221"></a><span class="lineno"> 4221</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04222"></a><span class="lineno"> 4222</span>&#160;<span class="comment"> * return               : Void</span></div><div class="line"><a name="l04223"></a><span class="lineno"> 4223</span>&#160;<span class="comment"> * thread_p (in)        : Thread entry</span></div><div class="line"><a name="l04224"></a><span class="lineno"> 4224</span>&#160;<span class="comment"> * tran_index_out (out) : Transaction index</span></div><div class="line"><a name="l04225"></a><span class="lineno"> 4225</span>&#160;<span class="comment"> * tdes_out (out)       : Transaction descriptor</span></div><div class="line"><a name="l04226"></a><span class="lineno"> 4226</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l04227"></a><span class="lineno"> 4227</span>&#160;<a class="code" href="porting_8h.html#a718749e18d63ca0d6b0d1b918efb41d6">STATIC_INLINE</a> <span class="keywordtype">void</span></div><div class="line"><a name="l04228"></a><span class="lineno"><a class="line" href="log__manager_8c.html#ac6a08ce8b6271d689e48b7bd96a32c7a"> 4228</a></span>&#160;<a class="code" href="log__manager_8c.html#ac6a08ce8b6271d689e48b7bd96a32c7a">log_sysop_get_tran_index_and_tdes</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <span class="keywordtype">int</span> *tran_index_out, <a class="code" href="structlog__tdes.html">LOG_TDES</a> ** tdes_out)</div><div class="line"><a name="l04229"></a><span class="lineno"> 4229</span>&#160;{</div><div class="line"><a name="l04230"></a><span class="lineno"> 4230</span>&#160;  *tran_index_out = <a class="code" href="perf__monitor_8h.html#a55d27b01d605ba6ee2929ddfe8588320">LOG_FIND_THREAD_TRAN_INDEX</a> (thread_p);</div><div class="line"><a name="l04231"></a><span class="lineno"> 4231</span>&#160;</div><div class="line"><a name="l04232"></a><span class="lineno"> 4232</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="vacuum_8h.html#ab0e1deb8da1aa663aa073b0ce78606a2">VACUUM_IS_THREAD_VACUUM</a> (thread_p))</div><div class="line"><a name="l04233"></a><span class="lineno"> 4233</span>&#160;    {</div><div class="line"><a name="l04234"></a><span class="lineno"> 4234</span>&#160;      <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (<a class="code" href="vacuum_8h.html#a6a1dc228ca433bf85d100084b318153f">vacuum_worker_state_is_topop</a> (thread_p) || <a class="code" href="vacuum_8h.html#ac8a084d067e28ed6cf7989a1597af721">vacuum_worker_state_is_recovery</a> (thread_p));</div><div class="line"><a name="l04235"></a><span class="lineno"> 4235</span>&#160;      *tdes_out = <a class="code" href="vacuum_8h.html#a3bae574be1c3bf9a786050397a1cde68">vacuum_get_worker_tdes</a> (thread_p);</div><div class="line"><a name="l04236"></a><span class="lineno"> 4236</span>&#160;    }</div><div class="line"><a name="l04237"></a><span class="lineno"> 4237</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l04238"></a><span class="lineno"> 4238</span>&#160;    {</div><div class="line"><a name="l04239"></a><span class="lineno"> 4239</span>&#160;      *tdes_out = <a class="code" href="log__impl_8h.html#a08fee41cfcf592e8afdbc4988ffbc8e4">LOG_FIND_TDES</a> (*tran_index_out);</div><div class="line"><a name="l04240"></a><span class="lineno"> 4240</span>&#160;    }</div><div class="line"><a name="l04241"></a><span class="lineno"> 4241</span>&#160;</div><div class="line"><a name="l04242"></a><span class="lineno"> 4242</span>&#160;  <span class="keywordflow">if</span> (*tdes_out == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l04243"></a><span class="lineno"> 4243</span>&#160;    {</div><div class="line"><a name="l04244"></a><span class="lineno"> 4244</span>&#160;      <a class="code" href="error__manager_8h.html#a34b88b0e828e26dd5cf930a0b1dd57a7">assert_release</a> (<span class="keyword">false</span>);</div><div class="line"><a name="l04245"></a><span class="lineno"> 4245</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l04246"></a><span class="lineno"> 4246</span>&#160;    }</div><div class="line"><a name="l04247"></a><span class="lineno"> 4247</span>&#160;}</div><div class="line"><a name="l04248"></a><span class="lineno"> 4248</span>&#160;</div><div class="line"><a name="l04249"></a><span class="lineno"> 4249</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l04250"></a><span class="lineno"> 4250</span>&#160;<span class="comment"> * log_check_system_op_is_started () - Check system op is started.</span></div><div class="line"><a name="l04251"></a><span class="lineno"> 4251</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04252"></a><span class="lineno"> 4252</span>&#160;<span class="comment"> * return    : Error code.</span></div><div class="line"><a name="l04253"></a><span class="lineno"> 4253</span>&#160;<span class="comment"> * thread_p (in) : Thread entry.</span></div><div class="line"><a name="l04254"></a><span class="lineno"> 4254</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l04255"></a><span class="lineno"> 4255</span>&#160;<span class="keywordtype">bool</span></div><div class="line"><a name="l04256"></a><span class="lineno"><a class="line" href="log__manager_8h.html#a057f42ec8bf86c3671408fa458a7166a"> 4256</a></span>&#160;<a class="code" href="log__manager_8c.html#a057f42ec8bf86c3671408fa458a7166a">log_check_system_op_is_started</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p)</div><div class="line"><a name="l04257"></a><span class="lineno"> 4257</span>&#160;{</div><div class="line"><a name="l04258"></a><span class="lineno"> 4258</span>&#160;  <a class="code" href="structlog__tdes.html">LOG_TDES</a> *tdes;       <span class="comment">/* Transaction descriptor */</span></div><div class="line"><a name="l04259"></a><span class="lineno"> 4259</span>&#160;  <span class="keywordtype">int</span> tran_index;</div><div class="line"><a name="l04260"></a><span class="lineno"> 4260</span>&#160;</div><div class="line"><a name="l04261"></a><span class="lineno"> 4261</span>&#160;  tran_index = <a class="code" href="perf__monitor_8h.html#a55d27b01d605ba6ee2929ddfe8588320">LOG_FIND_THREAD_TRAN_INDEX</a> (thread_p);</div><div class="line"><a name="l04262"></a><span class="lineno"> 4262</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="vacuum_8h.html#ab0e1deb8da1aa663aa073b0ce78606a2">VACUUM_IS_THREAD_VACUUM</a> (thread_p))</div><div class="line"><a name="l04263"></a><span class="lineno"> 4263</span>&#160;    {</div><div class="line"><a name="l04264"></a><span class="lineno"> 4264</span>&#160;      <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (<a class="code" href="vacuum_8h.html#a6a1dc228ca433bf85d100084b318153f">vacuum_worker_state_is_topop</a> (thread_p) || <a class="code" href="vacuum_8h.html#ac8a084d067e28ed6cf7989a1597af721">vacuum_worker_state_is_recovery</a> (thread_p));</div><div class="line"><a name="l04265"></a><span class="lineno"> 4265</span>&#160;      tdes = <a class="code" href="vacuum_8h.html#a3bae574be1c3bf9a786050397a1cde68">vacuum_get_worker_tdes</a> (thread_p);</div><div class="line"><a name="l04266"></a><span class="lineno"> 4266</span>&#160;    }</div><div class="line"><a name="l04267"></a><span class="lineno"> 4267</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l04268"></a><span class="lineno"> 4268</span>&#160;    {</div><div class="line"><a name="l04269"></a><span class="lineno"> 4269</span>&#160;      tdes = <a class="code" href="log__impl_8h.html#a08fee41cfcf592e8afdbc4988ffbc8e4">LOG_FIND_TDES</a> (tran_index);</div><div class="line"><a name="l04270"></a><span class="lineno"> 4270</span>&#160;    }</div><div class="line"><a name="l04271"></a><span class="lineno"> 4271</span>&#160;</div><div class="line"><a name="l04272"></a><span class="lineno"> 4272</span>&#160;  <span class="keywordflow">if</span> (tdes == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l04273"></a><span class="lineno"> 4273</span>&#160;    {</div><div class="line"><a name="l04274"></a><span class="lineno"> 4274</span>&#160;      <a class="code" href="error__manager_8h.html#a34b88b0e828e26dd5cf930a0b1dd57a7">assert_release</a> (<span class="keyword">false</span>);</div><div class="line"><a name="l04275"></a><span class="lineno"> 4275</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l04276"></a><span class="lineno"> 4276</span>&#160;    }</div><div class="line"><a name="l04277"></a><span class="lineno"> 4277</span>&#160;</div><div class="line"><a name="l04278"></a><span class="lineno"> 4278</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="log__manager_8h.html#a82c9a5b14b839795ad6792b5e633ed14">LOG_IS_SYSTEM_OP_STARTED</a> (tdes))</div><div class="line"><a name="l04279"></a><span class="lineno"> 4279</span>&#160;    {</div><div class="line"><a name="l04280"></a><span class="lineno"> 4280</span>&#160;      <a class="code" href="error__manager_8h.html#a34b88b0e828e26dd5cf930a0b1dd57a7">assert_release</a> (<span class="keyword">false</span>);</div><div class="line"><a name="l04281"></a><span class="lineno"> 4281</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l04282"></a><span class="lineno"> 4282</span>&#160;    }</div><div class="line"><a name="l04283"></a><span class="lineno"> 4283</span>&#160;</div><div class="line"><a name="l04284"></a><span class="lineno"> 4284</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l04285"></a><span class="lineno"> 4285</span>&#160;}</div><div class="line"><a name="l04286"></a><span class="lineno"> 4286</span>&#160;</div><div class="line"><a name="l04287"></a><span class="lineno"> 4287</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l04288"></a><span class="lineno"> 4288</span>&#160;<span class="comment"> * log_get_parent_lsa_system_op - Get parent lsa of top operation</span></div><div class="line"><a name="l04289"></a><span class="lineno"> 4289</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04290"></a><span class="lineno"> 4290</span>&#160;<span class="comment"> * return: lsa of parent or NULL</span></div><div class="line"><a name="l04291"></a><span class="lineno"> 4291</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04292"></a><span class="lineno"> 4292</span>&#160;<span class="comment"> *   parent_lsa(in/out): The topop LSA for current top operation</span></div><div class="line"><a name="l04293"></a><span class="lineno"> 4293</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04294"></a><span class="lineno"> 4294</span>&#160;<span class="comment"> * NOTE: Find the address of the parent of top operation.</span></div><div class="line"><a name="l04295"></a><span class="lineno"> 4295</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l04296"></a><span class="lineno"> 4296</span>&#160;<a class="code" href="structlog__lsa.html">LOG_LSA</a> *</div><div class="line"><a name="l04297"></a><span class="lineno"><a class="line" href="log__manager_8h.html#a5350790c3500298962602bf4b728bb1e"> 4297</a></span>&#160;<a class="code" href="log__manager_8c.html#a5350790c3500298962602bf4b728bb1e">log_get_parent_lsa_system_op</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="structlog__lsa.html">LOG_LSA</a> * parent_lsa)</div><div class="line"><a name="l04298"></a><span class="lineno"> 4298</span>&#160;{</div><div class="line"><a name="l04299"></a><span class="lineno"> 4299</span>&#160;  <a class="code" href="structlog__tdes.html">LOG_TDES</a> *tdes;       <span class="comment">/* Transaction descriptor */</span></div><div class="line"><a name="l04300"></a><span class="lineno"> 4300</span>&#160;  <span class="keywordtype">int</span> tran_index;</div><div class="line"><a name="l04301"></a><span class="lineno"> 4301</span>&#160;  <span class="keywordtype">int</span> error_code = <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>;</div><div class="line"><a name="l04302"></a><span class="lineno"> 4302</span>&#160;</div><div class="line"><a name="l04303"></a><span class="lineno"> 4303</span>&#160;  tran_index = <a class="code" href="perf__monitor_8h.html#a55d27b01d605ba6ee2929ddfe8588320">LOG_FIND_THREAD_TRAN_INDEX</a> (thread_p);</div><div class="line"><a name="l04304"></a><span class="lineno"> 4304</span>&#160;  tdes = <a class="code" href="log__impl_8h.html#a08fee41cfcf592e8afdbc4988ffbc8e4">LOG_FIND_TDES</a> (tran_index);</div><div class="line"><a name="l04305"></a><span class="lineno"> 4305</span>&#160;  <span class="keywordflow">if</span> (tdes == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l04306"></a><span class="lineno"> 4306</span>&#160;    {</div><div class="line"><a name="l04307"></a><span class="lineno"> 4307</span>&#160;      <a class="code" href="error__manager_8c.html#afdaf87ce30f2f557802a185ab85b6599">er_set</a> (<a class="code" href="error__manager_8h.html#a5d0d456c474e11fc70779873a30a7432a3314630dd19f90a68274cf737092c9f2">ER_FATAL_ERROR_SEVERITY</a>, <a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <a class="code" href="error__code_8h.html#a4b8e41e78be77c579a2c58f5248fefe2">ER_LOG_UNKNOWN_TRANINDEX</a>, 1, tran_index);</div><div class="line"><a name="l04308"></a><span class="lineno"> 4308</span>&#160;      error_code = <a class="code" href="error__code_8h.html#a4b8e41e78be77c579a2c58f5248fefe2">ER_LOG_UNKNOWN_TRANINDEX</a>;</div><div class="line"><a name="l04309"></a><span class="lineno"> 4309</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l04310"></a><span class="lineno"> 4310</span>&#160;    }</div><div class="line"><a name="l04311"></a><span class="lineno"> 4311</span>&#160;</div><div class="line"><a name="l04312"></a><span class="lineno"> 4312</span>&#160;  <span class="keywordflow">if</span> (tdes-&gt;<a class="code" href="structlog__tdes.html#a97c1d42917ab4d08ffe3194fc7233018">topops</a>.<a class="code" href="structlog__topops__stack.html#a5e509dcc15d89abc0c6ba486af6dba4d">last</a> &lt; 0)</div><div class="line"><a name="l04313"></a><span class="lineno"> 4313</span>&#160;    {</div><div class="line"><a name="l04314"></a><span class="lineno"> 4314</span>&#160;      <a class="code" href="storage__common_8h.html#a6a4baec606189dd320678e8f412ca957">LSA_SET_NULL</a> (parent_lsa);</div><div class="line"><a name="l04315"></a><span class="lineno"> 4315</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l04316"></a><span class="lineno"> 4316</span>&#160;    }</div><div class="line"><a name="l04317"></a><span class="lineno"> 4317</span>&#160;</div><div class="line"><a name="l04318"></a><span class="lineno"> 4318</span>&#160;  <a class="code" href="storage__common_8h.html#a4c9bc15296fe6728cf0351726cc6ad09">LSA_COPY</a> (parent_lsa, &amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a97c1d42917ab4d08ffe3194fc7233018">topops</a>.<a class="code" href="structlog__topops__stack.html#aeeae85de5bdc4f49b8ba730b25ab092b">stack</a>[tdes-&gt;<a class="code" href="structlog__tdes.html#a97c1d42917ab4d08ffe3194fc7233018">topops</a>.<a class="code" href="structlog__topops__stack.html#a5e509dcc15d89abc0c6ba486af6dba4d">last</a>].<a class="code" href="structlog__topops__addresses.html#afe759effcd137f8d3ecfdb7e89814e7c">lastparent_lsa</a>);</div><div class="line"><a name="l04319"></a><span class="lineno"> 4319</span>&#160;</div><div class="line"><a name="l04320"></a><span class="lineno"> 4320</span>&#160;  <span class="keywordflow">return</span> parent_lsa;</div><div class="line"><a name="l04321"></a><span class="lineno"> 4321</span>&#160;}</div><div class="line"><a name="l04322"></a><span class="lineno"> 4322</span>&#160;</div><div class="line"><a name="l04323"></a><span class="lineno"> 4323</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l04324"></a><span class="lineno"> 4324</span>&#160;<span class="comment"> * log_is_tran_in_system_op - Find if current transaction is doing a top nested</span></div><div class="line"><a name="l04325"></a><span class="lineno"> 4325</span>&#160;<span class="comment"> *                         system operation</span></div><div class="line"><a name="l04326"></a><span class="lineno"> 4326</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04327"></a><span class="lineno"> 4327</span>&#160;<span class="comment"> * return:</span></div><div class="line"><a name="l04328"></a><span class="lineno"> 4328</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04329"></a><span class="lineno"> 4329</span>&#160;<span class="comment"> * NOTE: Find if the current transaction is doing a top nested system</span></div><div class="line"><a name="l04330"></a><span class="lineno"> 4330</span>&#160;<span class="comment"> *              operation.</span></div><div class="line"><a name="l04331"></a><span class="lineno"> 4331</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l04332"></a><span class="lineno"> 4332</span>&#160;<span class="keywordtype">bool</span></div><div class="line"><a name="l04333"></a><span class="lineno"><a class="line" href="log__manager_8h.html#a03a220d809fc3d4eaaf0e1c12b297ea1"> 4333</a></span>&#160;<a class="code" href="log__manager_8c.html#a03a220d809fc3d4eaaf0e1c12b297ea1">log_is_tran_in_system_op</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p)</div><div class="line"><a name="l04334"></a><span class="lineno"> 4334</span>&#160;{</div><div class="line"><a name="l04335"></a><span class="lineno"> 4335</span>&#160;  <a class="code" href="structlog__tdes.html">LOG_TDES</a> *tdes;       <span class="comment">/* Transaction descriptor */</span></div><div class="line"><a name="l04336"></a><span class="lineno"> 4336</span>&#160;  <span class="keywordtype">int</span> tran_index;</div><div class="line"><a name="l04337"></a><span class="lineno"> 4337</span>&#160;  <span class="keywordtype">int</span> error_code = <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>;</div><div class="line"><a name="l04338"></a><span class="lineno"> 4338</span>&#160;</div><div class="line"><a name="l04339"></a><span class="lineno"> 4339</span>&#160;  tran_index = <a class="code" href="perf__monitor_8h.html#a55d27b01d605ba6ee2929ddfe8588320">LOG_FIND_THREAD_TRAN_INDEX</a> (thread_p);</div><div class="line"><a name="l04340"></a><span class="lineno"> 4340</span>&#160;  tdes = <a class="code" href="log__impl_8h.html#a08fee41cfcf592e8afdbc4988ffbc8e4">LOG_FIND_TDES</a> (tran_index);</div><div class="line"><a name="l04341"></a><span class="lineno"> 4341</span>&#160;  <span class="keywordflow">if</span> (tdes == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l04342"></a><span class="lineno"> 4342</span>&#160;    {</div><div class="line"><a name="l04343"></a><span class="lineno"> 4343</span>&#160;      <a class="code" href="error__manager_8c.html#afdaf87ce30f2f557802a185ab85b6599">er_set</a> (<a class="code" href="error__manager_8h.html#a5d0d456c474e11fc70779873a30a7432a3314630dd19f90a68274cf737092c9f2">ER_FATAL_ERROR_SEVERITY</a>, <a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <a class="code" href="error__code_8h.html#a4b8e41e78be77c579a2c58f5248fefe2">ER_LOG_UNKNOWN_TRANINDEX</a>, 1, tran_index);</div><div class="line"><a name="l04344"></a><span class="lineno"> 4344</span>&#160;      error_code = <a class="code" href="error__code_8h.html#a4b8e41e78be77c579a2c58f5248fefe2">ER_LOG_UNKNOWN_TRANINDEX</a>;</div><div class="line"><a name="l04345"></a><span class="lineno"> 4345</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l04346"></a><span class="lineno"> 4346</span>&#160;    }</div><div class="line"><a name="l04347"></a><span class="lineno"> 4347</span>&#160;</div><div class="line"><a name="l04348"></a><span class="lineno"> 4348</span>&#160;  <span class="keywordflow">if</span> (tdes-&gt;<a class="code" href="structlog__tdes.html#a97c1d42917ab4d08ffe3194fc7233018">topops</a>.<a class="code" href="structlog__topops__stack.html#a5e509dcc15d89abc0c6ba486af6dba4d">last</a> &lt; 0 &amp;&amp; <a class="code" href="storage__common_8h.html#a26dd766712df5b5c4fcd158f571a75e4">LSA_ISNULL</a> (&amp;tdes-&gt;<a class="code" href="structlog__tdes.html#ac2dac7e98c4049c6787fccd7faf3d92a">savept_lsa</a>))</div><div class="line"><a name="l04349"></a><span class="lineno"> 4349</span>&#160;    {</div><div class="line"><a name="l04350"></a><span class="lineno"> 4350</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l04351"></a><span class="lineno"> 4351</span>&#160;    }</div><div class="line"><a name="l04352"></a><span class="lineno"> 4352</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l04353"></a><span class="lineno"> 4353</span>&#160;    {</div><div class="line"><a name="l04354"></a><span class="lineno"> 4354</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l04355"></a><span class="lineno"> 4355</span>&#160;    }</div><div class="line"><a name="l04356"></a><span class="lineno"> 4356</span>&#160;}</div><div class="line"><a name="l04357"></a><span class="lineno"> 4357</span>&#160;</div><div class="line"><a name="l04358"></a><span class="lineno"> 4358</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l04359"></a><span class="lineno"> 4359</span>&#160;<span class="comment"> * log_can_skip_undo_logging - Is it safe to skip undo logging for given file ?</span></div><div class="line"><a name="l04360"></a><span class="lineno"> 4360</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04361"></a><span class="lineno"> 4361</span>&#160;<span class="comment"> * return:</span></div><div class="line"><a name="l04362"></a><span class="lineno"> 4362</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04363"></a><span class="lineno"> 4363</span>&#160;<span class="comment"> *   rcvindex(in): Index to recovery function</span></div><div class="line"><a name="l04364"></a><span class="lineno"> 4364</span>&#160;<span class="comment"> *   tdes(in):</span></div><div class="line"><a name="l04365"></a><span class="lineno"> 4365</span>&#160;<span class="comment"> *   addr(in):</span></div><div class="line"><a name="l04366"></a><span class="lineno"> 4366</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04367"></a><span class="lineno"> 4367</span>&#160;<span class="comment"> * NOTE: Find if it is safe to skip undo logging for data related to given file.</span></div><div class="line"><a name="l04368"></a><span class="lineno"> 4368</span>&#160;<span class="comment"> *       Some rcvindex values should never be skipped.</span></div><div class="line"><a name="l04369"></a><span class="lineno"> 4369</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l04370"></a><span class="lineno"> 4370</span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span></div><div class="line"><a name="l04371"></a><span class="lineno"> 4371</span>&#160;log_can_skip_undo_logging (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2b">LOG_RCVINDEX</a> rcvindex, <span class="keyword">const</span> <a class="code" href="structlog__tdes.html">LOG_TDES</a> * tdes, <a class="code" href="structlog__data__addr.html">LOG_DATA_ADDR</a> * addr)</div><div class="line"><a name="l04372"></a><span class="lineno"> 4372</span>&#160;{</div><div class="line"><a name="l04373"></a><span class="lineno"> 4373</span>&#160;  <span class="comment">/* </span></div><div class="line"><a name="l04374"></a><span class="lineno"> 4374</span>&#160;<span class="comment">   * Some log record types (rcvindex) should never be skipped.</span></div><div class="line"><a name="l04375"></a><span class="lineno"> 4375</span>&#160;<span class="comment">   * In the case of LINK_PERM_VOLEXT, the link of a permanent temp volume must be logged to support media failures.</span></div><div class="line"><a name="l04376"></a><span class="lineno"> 4376</span>&#160;<span class="comment">   * See also log_can_skip_redo_logging.</span></div><div class="line"><a name="l04377"></a><span class="lineno"> 4377</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l04378"></a><span class="lineno"> 4378</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="log__manager_8c.html#a4b52943a60e04cf7685b2355ad7e1d4a">LOG_ISUNSAFE_TO_SKIP_RCVINDEX</a> (rcvindex))</div><div class="line"><a name="l04379"></a><span class="lineno"> 4379</span>&#160;    {</div><div class="line"><a name="l04380"></a><span class="lineno"> 4380</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l04381"></a><span class="lineno"> 4381</span>&#160;    }</div><div class="line"><a name="l04382"></a><span class="lineno"> 4382</span>&#160;</div><div class="line"><a name="l04383"></a><span class="lineno"> 4383</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="vacuum_8h.html#a6d5983bac579d9dfbc3b22e6542380fa">vacuum_is_skip_undo_allowed</a> (thread_p))</div><div class="line"><a name="l04384"></a><span class="lineno"> 4384</span>&#160;    {</div><div class="line"><a name="l04385"></a><span class="lineno"> 4385</span>&#160;      <span class="comment">/* If vacuum worker has not started a system operation, it can skip using undo logging. */</span></div><div class="line"><a name="l04386"></a><span class="lineno"> 4386</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l04387"></a><span class="lineno"> 4387</span>&#160;    }</div><div class="line"><a name="l04388"></a><span class="lineno"> 4388</span>&#160;</div><div class="line"><a name="l04389"></a><span class="lineno"> 4389</span>&#160;  <span class="comment">/* </span></div><div class="line"><a name="l04390"></a><span class="lineno"> 4390</span>&#160;<span class="comment">   * Operation level undo can be skipped on temporary pages. For example, those of temporary files.</span></div><div class="line"><a name="l04391"></a><span class="lineno"> 4391</span>&#160;<span class="comment">   * No-operational level undo (i.e., logical logging) can be skipped for temporary files.</span></div><div class="line"><a name="l04392"></a><span class="lineno"> 4392</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l04393"></a><span class="lineno"> 4393</span>&#160;  <span class="keywordflow">if</span> (addr-&gt;<a class="code" href="structlog__data__addr.html#a3c632dae3ad660a8572d9298716d9522">pgptr</a> != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> &amp;&amp; <a class="code" href="page__buffer_8c.html#ad57fb80ce30a5d3a727768a9198e51fc">pgbuf_is_lsa_temporary</a> (addr-&gt;<a class="code" href="structlog__data__addr.html#a3c632dae3ad660a8572d9298716d9522">pgptr</a>) == <span class="keyword">true</span>)</div><div class="line"><a name="l04394"></a><span class="lineno"> 4394</span>&#160;    {</div><div class="line"><a name="l04395"></a><span class="lineno"> 4395</span>&#160;      <span class="comment">/* why do we log temporary files */</span></div><div class="line"><a name="l04396"></a><span class="lineno"> 4396</span>&#160;      <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (<span class="keyword">false</span>);</div><div class="line"><a name="l04397"></a><span class="lineno"> 4397</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l04398"></a><span class="lineno"> 4398</span>&#160;    }</div><div class="line"><a name="l04399"></a><span class="lineno"> 4399</span>&#160;</div><div class="line"><a name="l04400"></a><span class="lineno"> 4400</span>&#160;  <span class="keywordflow">if</span> (addr-&gt;<a class="code" href="structlog__data__addr.html#a23830dd623509faa8744024abec22ca8">vfid</a> == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || <a class="code" href="file__manager_8h.html#a3c0dad2de1e9fca1501e28181db1c688">VFID_ISNULL</a> (addr-&gt;<a class="code" href="structlog__data__addr.html#a23830dd623509faa8744024abec22ca8">vfid</a>))</div><div class="line"><a name="l04401"></a><span class="lineno"> 4401</span>&#160;    {</div><div class="line"><a name="l04402"></a><span class="lineno"> 4402</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l04403"></a><span class="lineno"> 4403</span>&#160;    }</div><div class="line"><a name="l04404"></a><span class="lineno"> 4404</span>&#160;</div><div class="line"><a name="l04405"></a><span class="lineno"> 4405</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l04406"></a><span class="lineno"> 4406</span>&#160;}</div><div class="line"><a name="l04407"></a><span class="lineno"> 4407</span>&#160;</div><div class="line"><a name="l04408"></a><span class="lineno"> 4408</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l04409"></a><span class="lineno"> 4409</span>&#160;<span class="comment"> * log_can_skip_redo_logging - Is it safe to skip redo logging for given file ?</span></div><div class="line"><a name="l04410"></a><span class="lineno"> 4410</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04411"></a><span class="lineno"> 4411</span>&#160;<span class="comment"> * return:</span></div><div class="line"><a name="l04412"></a><span class="lineno"> 4412</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04413"></a><span class="lineno"> 4413</span>&#160;<span class="comment"> *   rcvindex(in): Index to recovery function</span></div><div class="line"><a name="l04414"></a><span class="lineno"> 4414</span>&#160;<span class="comment"> *   ignore_tdes(in):</span></div><div class="line"><a name="l04415"></a><span class="lineno"> 4415</span>&#160;<span class="comment"> *   addr(in): Address (Volume, page, and offset) of data</span></div><div class="line"><a name="l04416"></a><span class="lineno"> 4416</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04417"></a><span class="lineno"> 4417</span>&#160;<span class="comment"> * NOTE: Find if it is safe to skip redo logging for data related to given file. </span></div><div class="line"><a name="l04418"></a><span class="lineno"> 4418</span>&#160;<span class="comment"> *       Redo logging can be skip on any temporary page. For example, pages of temporary files on any volume.</span></div><div class="line"><a name="l04419"></a><span class="lineno"> 4419</span>&#160;<span class="comment"> *       Some rcvindex values should never be skipped.</span></div><div class="line"><a name="l04420"></a><span class="lineno"> 4420</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l04421"></a><span class="lineno"> 4421</span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span></div><div class="line"><a name="l04422"></a><span class="lineno"> 4422</span>&#160;log_can_skip_redo_logging (<a class="code" href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2b">LOG_RCVINDEX</a> rcvindex, <span class="keyword">const</span> <a class="code" href="structlog__tdes.html">LOG_TDES</a> * ignore_tdes, <a class="code" href="structlog__data__addr.html">LOG_DATA_ADDR</a> * addr)</div><div class="line"><a name="l04423"></a><span class="lineno"> 4423</span>&#160;{</div><div class="line"><a name="l04424"></a><span class="lineno"> 4424</span>&#160;  <span class="comment">/* </span></div><div class="line"><a name="l04425"></a><span class="lineno"> 4425</span>&#160;<span class="comment">   * Some log record types (rcvindex) should never be skipped.</span></div><div class="line"><a name="l04426"></a><span class="lineno"> 4426</span>&#160;<span class="comment">   * In the case of LINK_PERM_VOLEXT, the link of a permanent temp volume must be logged to support media failures.</span></div><div class="line"><a name="l04427"></a><span class="lineno"> 4427</span>&#160;<span class="comment">   * See also log_can_skip_undo_logging.</span></div><div class="line"><a name="l04428"></a><span class="lineno"> 4428</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l04429"></a><span class="lineno"> 4429</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="log__manager_8c.html#a4b52943a60e04cf7685b2355ad7e1d4a">LOG_ISUNSAFE_TO_SKIP_RCVINDEX</a> (rcvindex))</div><div class="line"><a name="l04430"></a><span class="lineno"> 4430</span>&#160;    {</div><div class="line"><a name="l04431"></a><span class="lineno"> 4431</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l04432"></a><span class="lineno"> 4432</span>&#160;    }</div><div class="line"><a name="l04433"></a><span class="lineno"> 4433</span>&#160;</div><div class="line"><a name="l04434"></a><span class="lineno"> 4434</span>&#160;  <span class="comment">/* </span></div><div class="line"><a name="l04435"></a><span class="lineno"> 4435</span>&#160;<span class="comment">   * Operation level redo can be skipped on temporary pages. For example, those of temporary files</span></div><div class="line"><a name="l04436"></a><span class="lineno"> 4436</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l04437"></a><span class="lineno"> 4437</span>&#160;  <span class="keywordflow">if</span> (addr-&gt;<a class="code" href="structlog__data__addr.html#a3c632dae3ad660a8572d9298716d9522">pgptr</a> != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> &amp;&amp; <a class="code" href="page__buffer_8c.html#ad57fb80ce30a5d3a727768a9198e51fc">pgbuf_is_lsa_temporary</a> (addr-&gt;<a class="code" href="structlog__data__addr.html#a3c632dae3ad660a8572d9298716d9522">pgptr</a>) == <span class="keyword">true</span>)</div><div class="line"><a name="l04438"></a><span class="lineno"> 4438</span>&#160;    {</div><div class="line"><a name="l04439"></a><span class="lineno"> 4439</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l04440"></a><span class="lineno"> 4440</span>&#160;    }</div><div class="line"><a name="l04441"></a><span class="lineno"> 4441</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l04442"></a><span class="lineno"> 4442</span>&#160;    {</div><div class="line"><a name="l04443"></a><span class="lineno"> 4443</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l04444"></a><span class="lineno"> 4444</span>&#160;    }</div><div class="line"><a name="l04445"></a><span class="lineno"> 4445</span>&#160;}</div><div class="line"><a name="l04446"></a><span class="lineno"> 4446</span>&#160;</div><div class="line"><a name="l04447"></a><span class="lineno"> 4447</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l04448"></a><span class="lineno"> 4448</span>&#160;<span class="comment"> * log_append_commit_postpone - APPEND COMMIT WITH POSTPONE</span></div><div class="line"><a name="l04449"></a><span class="lineno"> 4449</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04450"></a><span class="lineno"> 4450</span>&#160;<span class="comment"> * return: nothing</span></div><div class="line"><a name="l04451"></a><span class="lineno"> 4451</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04452"></a><span class="lineno"> 4452</span>&#160;<span class="comment"> *   tdes(in/out): State structure of transaction being committed</span></div><div class="line"><a name="l04453"></a><span class="lineno"> 4453</span>&#160;<span class="comment"> *   start_posplsa(in): Address where the first postpone log record start</span></div><div class="line"><a name="l04454"></a><span class="lineno"> 4454</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04455"></a><span class="lineno"> 4455</span>&#160;<span class="comment"> * NOTE: The transaction is declared as committed with postpone actions.</span></div><div class="line"><a name="l04456"></a><span class="lineno"> 4456</span>&#160;<span class="comment"> *       The transaction is not fully committed until all postpone actions are executed.</span></div><div class="line"><a name="l04457"></a><span class="lineno"> 4457</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04458"></a><span class="lineno"> 4458</span>&#160;<span class="comment"> *       The postpone operations are not invoked by this function.</span></div><div class="line"><a name="l04459"></a><span class="lineno"> 4459</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l04460"></a><span class="lineno"> 4460</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div><div class="line"><a name="l04461"></a><span class="lineno"> 4461</span>&#160;log_append_commit_postpone (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="structlog__tdes.html">LOG_TDES</a> * tdes, <a class="code" href="structlog__lsa.html">LOG_LSA</a> * start_postpone_lsa)</div><div class="line"><a name="l04462"></a><span class="lineno"> 4462</span>&#160;{</div><div class="line"><a name="l04463"></a><span class="lineno"> 4463</span>&#160;  <a class="code" href="structlog__rec__start__postpone.html">LOG_REC_START_POSTPONE</a> *start_posp;   <span class="comment">/* Start postpone actions */</span></div><div class="line"><a name="l04464"></a><span class="lineno"> 4464</span>&#160;  <a class="code" href="structlog__prior__node.html">LOG_PRIOR_NODE</a> *<a class="code" href="external_2include_2queue_8h.html#a465e28dbd1a1c60ff504d3ea275613ed">node</a>;</div><div class="line"><a name="l04465"></a><span class="lineno"> 4465</span>&#160;  <a class="code" href="structlog__lsa.html">LOG_LSA</a> start_lsa;</div><div class="line"><a name="l04466"></a><span class="lineno"> 4466</span>&#160;</div><div class="line"><a name="l04467"></a><span class="lineno"> 4467</span>&#160;  <a class="code" href="structnodeptr.html">node</a> = <a class="code" href="log__impl_8h.html#a2b616997f446dcb588a6addcc65cf5b7">prior_lsa_alloc_and_copy_data</a> (thread_p, <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a6b03dd6d350881f805f7b3adeedcf10f">LOG_COMMIT_WITH_POSTPONE</a>, <a class="code" href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2ba6ea83d694355ec2c529960461a086f26">RV_NOT_DEFINED</a>, <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l04468"></a><span class="lineno"> 4468</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="structnodeptr.html">node</a> == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l04469"></a><span class="lineno"> 4469</span>&#160;    {</div><div class="line"><a name="l04470"></a><span class="lineno"> 4470</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l04471"></a><span class="lineno"> 4471</span>&#160;    }</div><div class="line"><a name="l04472"></a><span class="lineno"> 4472</span>&#160;</div><div class="line"><a name="l04473"></a><span class="lineno"> 4473</span>&#160;  start_posp = (<a class="code" href="structlog__rec__start__postpone.html">LOG_REC_START_POSTPONE</a> *) <a class="code" href="structnodeptr.html">node</a>-&gt;data_header;</div><div class="line"><a name="l04474"></a><span class="lineno"> 4474</span>&#160;  <a class="code" href="storage__common_8h.html#a4c9bc15296fe6728cf0351726cc6ad09">LSA_COPY</a> (&amp;start_posp-&gt;<a class="code" href="structlog__rec__start__postpone.html#a4743d8c14a75a36ff44fa8e41e659283">posp_lsa</a>, start_postpone_lsa);</div><div class="line"><a name="l04475"></a><span class="lineno"> 4475</span>&#160;</div><div class="line"><a name="l04476"></a><span class="lineno"> 4476</span>&#160;  start_lsa = <a class="code" href="log__impl_8h.html#a8a3ce7b7aa59fe26c04eca3577e434e8">prior_lsa_next_record</a> (thread_p, <a class="code" href="structnodeptr.html">node</a>, tdes);</div><div class="line"><a name="l04477"></a><span class="lineno"> 4477</span>&#160;</div><div class="line"><a name="l04478"></a><span class="lineno"> 4478</span>&#160;  tdes-&gt;<a class="code" href="structlog__tdes.html#ad924146690490b840ef5c3f65c3a5a6c">state</a> = <a class="code" href="log__comm_8h.html#a3c0be9b9f104459ab90ee18af95c4b3eaef0e7c96ca3684ce2422a33afe8f35fc">TRAN_UNACTIVE_COMMITTED_WITH_POSTPONE</a>;</div><div class="line"><a name="l04479"></a><span class="lineno"> 4479</span>&#160;</div><div class="line"><a name="l04480"></a><span class="lineno"> 4480</span>&#160;  <a class="code" href="log__impl_8h.html#aa91abaf89af63e703737ac5c00d7cd7d">logpb_flush_pages</a> (thread_p, &amp;start_lsa);</div><div class="line"><a name="l04481"></a><span class="lineno"> 4481</span>&#160;}</div><div class="line"><a name="l04482"></a><span class="lineno"> 4482</span>&#160;</div><div class="line"><a name="l04483"></a><span class="lineno"> 4483</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l04484"></a><span class="lineno"> 4484</span>&#160;<span class="comment"> * log_append_sysop_start_postpone () - append a log record when system op starts postpone.</span></div><div class="line"><a name="l04485"></a><span class="lineno"> 4485</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04486"></a><span class="lineno"> 4486</span>&#160;<span class="comment"> * return                    : void</span></div><div class="line"><a name="l04487"></a><span class="lineno"> 4487</span>&#160;<span class="comment"> * thread_p (in)             : thread entry</span></div><div class="line"><a name="l04488"></a><span class="lineno"> 4488</span>&#160;<span class="comment"> * tdes (in)                 : transaction descriptor</span></div><div class="line"><a name="l04489"></a><span class="lineno"> 4489</span>&#160;<span class="comment"> * sysop_start_postpone (in) : start postpone log record</span></div><div class="line"><a name="l04490"></a><span class="lineno"> 4490</span>&#160;<span class="comment"> * data_size (in)            : undo data size</span></div><div class="line"><a name="l04491"></a><span class="lineno"> 4491</span>&#160;<span class="comment"> * data (in)                 : undo data</span></div><div class="line"><a name="l04492"></a><span class="lineno"> 4492</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l04493"></a><span class="lineno"> 4493</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div><div class="line"><a name="l04494"></a><span class="lineno"> 4494</span>&#160;log_append_sysop_start_postpone (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="structlog__tdes.html">LOG_TDES</a> * tdes,</div><div class="line"><a name="l04495"></a><span class="lineno"> 4495</span>&#160;                 <a class="code" href="structlog__rec__sysop__start__postpone.html">LOG_REC_SYSOP_START_POSTPONE</a> * sysop_start_postpone, <span class="keywordtype">int</span> data_size, <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="namespacestatdump__to__csv.html#aedcb70fde9c0b07a0732db70deeec616">data</a>)</div><div class="line"><a name="l04496"></a><span class="lineno"> 4496</span>&#160;{</div><div class="line"><a name="l04497"></a><span class="lineno"> 4497</span>&#160;  <a class="code" href="structlog__prior__node.html">LOG_PRIOR_NODE</a> *<a class="code" href="external_2include_2queue_8h.html#a465e28dbd1a1c60ff504d3ea275613ed">node</a>;</div><div class="line"><a name="l04498"></a><span class="lineno"> 4498</span>&#160;</div><div class="line"><a name="l04499"></a><span class="lineno"> 4499</span>&#160;  <a class="code" href="structnodeptr.html">node</a> =</div><div class="line"><a name="l04500"></a><span class="lineno"> 4500</span>&#160;    <a class="code" href="log__impl_8h.html#a2b616997f446dcb588a6addcc65cf5b7">prior_lsa_alloc_and_copy_data</a> (thread_p, <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a198b93b13d51133e5e5d4b8e7c62f54e">LOG_SYSOP_START_POSTPONE</a>, <a class="code" href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2ba6ea83d694355ec2c529960461a086f26">RV_NOT_DEFINED</a>, <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, data_size, (<span class="keywordtype">char</span> *) <a class="code" href="namespacestatdump__to__csv.html#aedcb70fde9c0b07a0732db70deeec616">data</a>,</div><div class="line"><a name="l04501"></a><span class="lineno"> 4501</span>&#160;                   0, <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l04502"></a><span class="lineno"> 4502</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="structnodeptr.html">node</a> == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l04503"></a><span class="lineno"> 4503</span>&#160;    {</div><div class="line"><a name="l04504"></a><span class="lineno"> 4504</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l04505"></a><span class="lineno"> 4505</span>&#160;    }</div><div class="line"><a name="l04506"></a><span class="lineno"> 4506</span>&#160;</div><div class="line"><a name="l04507"></a><span class="lineno"> 4507</span>&#160;  *(<a class="code" href="structlog__rec__sysop__start__postpone.html">LOG_REC_SYSOP_START_POSTPONE</a> *) <a class="code" href="structnodeptr.html">node</a>-&gt;data_header = *sysop_start_postpone;</div><div class="line"><a name="l04508"></a><span class="lineno"> 4508</span>&#160;  (<span class="keywordtype">void</span>) <a class="code" href="log__impl_8h.html#a8a3ce7b7aa59fe26c04eca3577e434e8">prior_lsa_next_record</a> (thread_p, <a class="code" href="structnodeptr.html">node</a>, tdes);</div><div class="line"><a name="l04509"></a><span class="lineno"> 4509</span>&#160;}</div><div class="line"><a name="l04510"></a><span class="lineno"> 4510</span>&#160;</div><div class="line"><a name="l04511"></a><span class="lineno"> 4511</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l04512"></a><span class="lineno"> 4512</span>&#160;<span class="comment"> * log_append_sysop_end () - append sys op end log record</span></div><div class="line"><a name="l04513"></a><span class="lineno"> 4513</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04514"></a><span class="lineno"> 4514</span>&#160;<span class="comment"> * return         : void</span></div><div class="line"><a name="l04515"></a><span class="lineno"> 4515</span>&#160;<span class="comment"> * thread_p (in)  : thread entry</span></div><div class="line"><a name="l04516"></a><span class="lineno"> 4516</span>&#160;<span class="comment"> * tdes (in)      : transaction descriptor</span></div><div class="line"><a name="l04517"></a><span class="lineno"> 4517</span>&#160;<span class="comment"> * sysop_end (in) : sys op end log record</span></div><div class="line"><a name="l04518"></a><span class="lineno"> 4518</span>&#160;<span class="comment"> * data_size (in) : data size</span></div><div class="line"><a name="l04519"></a><span class="lineno"> 4519</span>&#160;<span class="comment"> * data (in)      : recovery data</span></div><div class="line"><a name="l04520"></a><span class="lineno"> 4520</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l04521"></a><span class="lineno"> 4521</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div><div class="line"><a name="l04522"></a><span class="lineno"> 4522</span>&#160;log_append_sysop_end (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="structlog__tdes.html">LOG_TDES</a> * tdes, <a class="code" href="structlog__rec__sysop__end.html">LOG_REC_SYSOP_END</a> * sysop_end, <span class="keywordtype">int</span> data_size,</div><div class="line"><a name="l04523"></a><span class="lineno"> 4523</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="namespacestatdump__to__csv.html#aedcb70fde9c0b07a0732db70deeec616">data</a>)</div><div class="line"><a name="l04524"></a><span class="lineno"> 4524</span>&#160;{</div><div class="line"><a name="l04525"></a><span class="lineno"> 4525</span>&#160;  <a class="code" href="structlog__prior__node.html">LOG_PRIOR_NODE</a> *<a class="code" href="structnodeptr.html">node</a> = <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l04526"></a><span class="lineno"> 4526</span>&#160;</div><div class="line"><a name="l04527"></a><span class="lineno"> 4527</span>&#160;  <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (tdes != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l04528"></a><span class="lineno"> 4528</span>&#160;  <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (sysop_end != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l04529"></a><span class="lineno"> 4529</span>&#160;  <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (data_size == 0 || <a class="code" href="namespacestatdump__to__csv.html#aedcb70fde9c0b07a0732db70deeec616">data</a> != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l04530"></a><span class="lineno"> 4530</span>&#160;</div><div class="line"><a name="l04531"></a><span class="lineno"> 4531</span>&#160;  <a class="code" href="structnodeptr.html">node</a> = <a class="code" href="log__impl_8h.html#a2b616997f446dcb588a6addcc65cf5b7">prior_lsa_alloc_and_copy_data</a> (thread_p, <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a29a7c510ffdadeb0e4c5304e6825a5ec">LOG_SYSOP_END</a>, <a class="code" href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2ba6ea83d694355ec2c529960461a086f26">RV_NOT_DEFINED</a>, <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, data_size, <a class="code" href="namespacestatdump__to__csv.html#aedcb70fde9c0b07a0732db70deeec616">data</a>, 0, <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l04532"></a><span class="lineno"> 4532</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="structnodeptr.html">node</a> == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l04533"></a><span class="lineno"> 4533</span>&#160;    {</div><div class="line"><a name="l04534"></a><span class="lineno"> 4534</span>&#160;      <span class="comment">/* Is this possible? */</span></div><div class="line"><a name="l04535"></a><span class="lineno"> 4535</span>&#160;      <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (<span class="keyword">false</span>);</div><div class="line"><a name="l04536"></a><span class="lineno"> 4536</span>&#160;    }</div><div class="line"><a name="l04537"></a><span class="lineno"> 4537</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l04538"></a><span class="lineno"> 4538</span>&#160;    {</div><div class="line"><a name="l04539"></a><span class="lineno"> 4539</span>&#160;      <span class="comment">/* Save data head. */</span></div><div class="line"><a name="l04540"></a><span class="lineno"> 4540</span>&#160;      <span class="comment">/* First save lastparent_lsa and prv_topresult_lsa. */</span></div><div class="line"><a name="l04541"></a><span class="lineno"> 4541</span>&#160;      <a class="code" href="structlog__lsa.html">LOG_LSA</a> start_lsa = <a class="code" href="storage__common_8h.html#a9a90f006879719246747fb497b16a663">LSA_INITIALIZER</a>;</div><div class="line"><a name="l04542"></a><span class="lineno"> 4542</span>&#160;</div><div class="line"><a name="l04543"></a><span class="lineno"> 4543</span>&#160;      memcpy (<a class="code" href="structnodeptr.html">node</a>-&gt;data_header, sysop_end, <a class="code" href="structnodeptr.html">node</a>-&gt;data_header_length);</div><div class="line"><a name="l04544"></a><span class="lineno"> 4544</span>&#160;</div><div class="line"><a name="l04545"></a><span class="lineno"> 4545</span>&#160;      start_lsa = <a class="code" href="log__impl_8h.html#a8a3ce7b7aa59fe26c04eca3577e434e8">prior_lsa_next_record</a> (thread_p, <a class="code" href="structnodeptr.html">node</a>, tdes);</div><div class="line"><a name="l04546"></a><span class="lineno"> 4546</span>&#160;      <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (!<a class="code" href="storage__common_8h.html#a26dd766712df5b5c4fcd158f571a75e4">LSA_ISNULL</a> (&amp;start_lsa));</div><div class="line"><a name="l04547"></a><span class="lineno"> 4547</span>&#160;    }</div><div class="line"><a name="l04548"></a><span class="lineno"> 4548</span>&#160;}</div><div class="line"><a name="l04549"></a><span class="lineno"> 4549</span>&#160;</div><div class="line"><a name="l04550"></a><span class="lineno"> 4550</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l04551"></a><span class="lineno"> 4551</span>&#160;<span class="comment"> * log_append_repl_info_internal - APPEND REPLICATION LOG RECORD</span></div><div class="line"><a name="l04552"></a><span class="lineno"> 4552</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04553"></a><span class="lineno"> 4553</span>&#160;<span class="comment"> * return: nothing</span></div><div class="line"><a name="l04554"></a><span class="lineno"> 4554</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04555"></a><span class="lineno"> 4555</span>&#160;<span class="comment"> *   thread_p(in):</span></div><div class="line"><a name="l04556"></a><span class="lineno"> 4556</span>&#160;<span class="comment"> *   tdes(in): State structure of transaction being committed/aborted.</span></div><div class="line"><a name="l04557"></a><span class="lineno"> 4557</span>&#160;<span class="comment"> *   is_commit(in):</span></div><div class="line"><a name="l04558"></a><span class="lineno"> 4558</span>&#160;<span class="comment"> *   with_lock(in):</span></div><div class="line"><a name="l04559"></a><span class="lineno"> 4559</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04560"></a><span class="lineno"> 4560</span>&#160;<span class="comment"> * NOTE:critical section is set by its caller function.</span></div><div class="line"><a name="l04561"></a><span class="lineno"> 4561</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l04562"></a><span class="lineno"> 4562</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div><div class="line"><a name="l04563"></a><span class="lineno"> 4563</span>&#160;log_append_repl_info_internal (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="structlog__tdes.html">LOG_TDES</a> * tdes, <span class="keywordtype">bool</span> is_commit, <span class="keywordtype">int</span> with_lock)</div><div class="line"><a name="l04564"></a><span class="lineno"> 4564</span>&#160;{</div><div class="line"><a name="l04565"></a><span class="lineno"> 4565</span>&#160;  <a class="code" href="structlog__repl.html">LOG_REPL_RECORD</a> *repl_rec;</div><div class="line"><a name="l04566"></a><span class="lineno"> 4566</span>&#160;  <a class="code" href="structlog__rec__replication.html">LOG_REC_REPLICATION</a> *log;</div><div class="line"><a name="l04567"></a><span class="lineno"> 4567</span>&#160;  <a class="code" href="structlog__prior__node.html">LOG_PRIOR_NODE</a> *<a class="code" href="external_2include_2queue_8h.html#a465e28dbd1a1c60ff504d3ea275613ed">node</a>;</div><div class="line"><a name="l04568"></a><span class="lineno"> 4568</span>&#160;</div><div class="line"><a name="l04569"></a><span class="lineno"> 4569</span>&#160;  <span class="keywordflow">if</span> (tdes-&gt;<a class="code" href="structlog__tdes.html#a6889e1a9d5092d507af7143097394692">append_repl_recidx</a> == -1    <span class="comment">/* the first time */</span></div><div class="line"><a name="l04570"></a><span class="lineno"> 4570</span>&#160;      || is_commit)</div><div class="line"><a name="l04571"></a><span class="lineno"> 4571</span>&#160;    {</div><div class="line"><a name="l04572"></a><span class="lineno"> 4572</span>&#160;      tdes-&gt;<a class="code" href="structlog__tdes.html#a6889e1a9d5092d507af7143097394692">append_repl_recidx</a> = 0;</div><div class="line"><a name="l04573"></a><span class="lineno"> 4573</span>&#160;    }</div><div class="line"><a name="l04574"></a><span class="lineno"> 4574</span>&#160;</div><div class="line"><a name="l04575"></a><span class="lineno"> 4575</span>&#160;  <span class="comment">/* there is any replication info */</span></div><div class="line"><a name="l04576"></a><span class="lineno"> 4576</span>&#160;  <span class="keywordflow">while</span> (tdes-&gt;<a class="code" href="structlog__tdes.html#a6889e1a9d5092d507af7143097394692">append_repl_recidx</a> &lt; tdes-&gt;<a class="code" href="structlog__tdes.html#a85697ad65f1a480fcc83d865e14f5818">cur_repl_record</a>)</div><div class="line"><a name="l04577"></a><span class="lineno"> 4577</span>&#160;    {</div><div class="line"><a name="l04578"></a><span class="lineno"> 4578</span>&#160;      repl_rec = (<a class="code" href="structlog__repl.html">LOG_REPL_RECORD</a> *) (&amp;(tdes-&gt;<a class="code" href="structlog__tdes.html#ab60d7bef0b3e1d89b1a0a9865a2a4bef">repl_records</a>[tdes-&gt;<a class="code" href="structlog__tdes.html#a6889e1a9d5092d507af7143097394692">append_repl_recidx</a>]));</div><div class="line"><a name="l04579"></a><span class="lineno"> 4579</span>&#160;</div><div class="line"><a name="l04580"></a><span class="lineno"> 4580</span>&#160;      <span class="keywordflow">if</span> ((repl_rec-&gt;<a class="code" href="structlog__repl.html#ad89451a257ef66d62f1bb92bec8c99b6">repl_type</a> == <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a97003f753507d5a7a65a0bf078a078f4">LOG_REPLICATION_DATA</a> || repl_rec-&gt;<a class="code" href="structlog__repl.html#ad89451a257ef66d62f1bb92bec8c99b6">repl_type</a> == <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7ac9476ec323cd3909823f79ecc3938afd">LOG_REPLICATION_STATEMENT</a>)</div><div class="line"><a name="l04581"></a><span class="lineno"> 4581</span>&#160;      &amp;&amp; ((is_commit &amp;&amp; repl_rec-&gt;<a class="code" href="structlog__repl.html#a631c551c097c7f5d7e15bb59f4ec5219">must_flush</a> != <a class="code" href="log__impl_8h.html#aa72336694761e5c0510f22416b65a0e2a20282e762d82417e44db85f0fb56bd2b">LOG_REPL_DONT_NEED_FLUSH</a>)</div><div class="line"><a name="l04582"></a><span class="lineno"> 4582</span>&#160;          || repl_rec-&gt;<a class="code" href="structlog__repl.html#a631c551c097c7f5d7e15bb59f4ec5219">must_flush</a> == <a class="code" href="log__impl_8h.html#aa72336694761e5c0510f22416b65a0e2a4b8883515586d53ebdb4fb072300076f">LOG_REPL_NEED_FLUSH</a>))</div><div class="line"><a name="l04583"></a><span class="lineno"> 4583</span>&#160;    {</div><div class="line"><a name="l04584"></a><span class="lineno"> 4584</span>&#160;      <a class="code" href="structnodeptr.html">node</a> =</div><div class="line"><a name="l04585"></a><span class="lineno"> 4585</span>&#160;        <a class="code" href="log__impl_8h.html#a2b616997f446dcb588a6addcc65cf5b7">prior_lsa_alloc_and_copy_data</a> (thread_p, repl_rec-&gt;<a class="code" href="structlog__repl.html#ad89451a257ef66d62f1bb92bec8c99b6">repl_type</a>, <a class="code" href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2ba6ea83d694355ec2c529960461a086f26">RV_NOT_DEFINED</a>, <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, repl_rec-&gt;<a class="code" href="structlog__repl.html#ab796c9584a750f2604278befaefbdb93">length</a>,</div><div class="line"><a name="l04586"></a><span class="lineno"> 4586</span>&#160;                       repl_rec-&gt;<a class="code" href="structlog__repl.html#a7e74ec3812134e817a9b2a455ee5de1f">repl_data</a>, 0, <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l04587"></a><span class="lineno"> 4587</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="structnodeptr.html">node</a> == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l04588"></a><span class="lineno"> 4588</span>&#160;        {</div><div class="line"><a name="l04589"></a><span class="lineno"> 4589</span>&#160;          <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (<span class="keyword">false</span>);</div><div class="line"><a name="l04590"></a><span class="lineno"> 4590</span>&#160;          <span class="keywordflow">continue</span>;</div><div class="line"><a name="l04591"></a><span class="lineno"> 4591</span>&#160;        }</div><div class="line"><a name="l04592"></a><span class="lineno"> 4592</span>&#160;</div><div class="line"><a name="l04593"></a><span class="lineno"> 4593</span>&#160;      log = (<a class="code" href="structlog__rec__replication.html">LOG_REC_REPLICATION</a> *) <a class="code" href="structnodeptr.html">node</a>-&gt;data_header;</div><div class="line"><a name="l04594"></a><span class="lineno"> 4594</span>&#160;      <a class="code" href="cubrid__data__seek__test_8php.html#a7bf795f554c1ff05baccf023cc804198">if</a> (repl_rec-&gt;<a class="code" href="structlog__repl.html#a5e4f8edc08618b5369397f68a1edb949">rcvindex</a> == <a class="code" href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2ba2d4bae310e581efb860f5b180b730527">RVREPL_DATA_DELETE</a> || repl_rec-&gt;<a class="code" href="structlog__repl.html#a5e4f8edc08618b5369397f68a1edb949">rcvindex</a> == <a class="code" href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2bac974752cd664dc6af0946c1d7ef4ce74">RVREPL_STATEMENT</a>)</div><div class="line"><a name="l04595"></a><span class="lineno"> 4595</span>&#160;        {</div><div class="line"><a name="l04596"></a><span class="lineno"> 4596</span>&#160;          <a class="code" href="storage__common_8h.html#a6a4baec606189dd320678e8f412ca957">LSA_SET_NULL</a> (&amp;log-&gt;<a class="code" href="structlog__rec__replication.html#a8d945514d95904e726b652d4c7e034d8">lsa</a>);</div><div class="line"><a name="l04597"></a><span class="lineno"> 4597</span>&#160;        }</div><div class="line"><a name="l04598"></a><span class="lineno"> 4598</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l04599"></a><span class="lineno"> 4599</span>&#160;        {</div><div class="line"><a name="l04600"></a><span class="lineno"> 4600</span>&#160;          <a class="code" href="storage__common_8h.html#a4c9bc15296fe6728cf0351726cc6ad09">LSA_COPY</a> (&amp;log-&gt;<a class="code" href="structlog__rec__replication.html#a8d945514d95904e726b652d4c7e034d8">lsa</a>, &amp;repl_rec-&gt;<a class="code" href="structlog__repl.html#a6f07078be78c9519a03b298baccbe5fd">lsa</a>);</div><div class="line"><a name="l04601"></a><span class="lineno"> 4601</span>&#160;        }</div><div class="line"><a name="l04602"></a><span class="lineno"> 4602</span>&#160;      log-&gt;<a class="code" href="structlog__rec__replication.html#abe7a28ec1533b0903038b517c3a7d1d1">length</a> = repl_rec-&gt;<a class="code" href="structlog__repl.html#ab796c9584a750f2604278befaefbdb93">length</a>;</div><div class="line"><a name="l04603"></a><span class="lineno"> 4603</span>&#160;      log-&gt;<a class="code" href="structlog__rec__replication.html#ae914ee167eab6535e3072163d40ff2c3">rcvindex</a> = repl_rec-&gt;<a class="code" href="structlog__repl.html#a5e4f8edc08618b5369397f68a1edb949">rcvindex</a>;</div><div class="line"><a name="l04604"></a><span class="lineno"> 4604</span>&#160;</div><div class="line"><a name="l04605"></a><span class="lineno"> 4605</span>&#160;      <span class="keywordflow">if</span> (with_lock == <a class="code" href="log__impl_8h.html#ae1aad1a6b2c71bde2d1b93df8bc54e38a6c10b3c3be256976a47bf7f85174c7d3">LOG_PRIOR_LSA_WITH_LOCK</a>)</div><div class="line"><a name="l04606"></a><span class="lineno"> 4606</span>&#160;        {</div><div class="line"><a name="l04607"></a><span class="lineno"> 4607</span>&#160;          (void) <a class="code" href="log__impl_8h.html#ad6e16f99d29b73760a0855d9b0ac7e1b">prior_lsa_next_record_with_lock</a> (thread_p, <a class="code" href="structnodeptr.html">node</a>, tdes);</div><div class="line"><a name="l04608"></a><span class="lineno"> 4608</span>&#160;        }</div><div class="line"><a name="l04609"></a><span class="lineno"> 4609</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l04610"></a><span class="lineno"> 4610</span>&#160;        {</div><div class="line"><a name="l04611"></a><span class="lineno"> 4611</span>&#160;          (void) <a class="code" href="log__impl_8h.html#a8a3ce7b7aa59fe26c04eca3577e434e8">prior_lsa_next_record</a> (thread_p, <a class="code" href="structnodeptr.html">node</a>, tdes);</div><div class="line"><a name="l04612"></a><span class="lineno"> 4612</span>&#160;        }</div><div class="line"><a name="l04613"></a><span class="lineno"> 4613</span>&#160;</div><div class="line"><a name="l04614"></a><span class="lineno"> 4614</span>&#160;      repl_rec-&gt;<a class="code" href="structlog__repl.html#a631c551c097c7f5d7e15bb59f4ec5219">must_flush</a> = <a class="code" href="log__impl_8h.html#aa72336694761e5c0510f22416b65a0e2a20282e762d82417e44db85f0fb56bd2b">LOG_REPL_DONT_NEED_FLUSH</a>;</div><div class="line"><a name="l04615"></a><span class="lineno"> 4615</span>&#160;    }</div><div class="line"><a name="l04616"></a><span class="lineno"> 4616</span>&#160;</div><div class="line"><a name="l04617"></a><span class="lineno"> 4617</span>&#160;      tdes-&gt;<a class="code" href="structlog__tdes.html#a6889e1a9d5092d507af7143097394692">append_repl_recidx</a>++;</div><div class="line"><a name="l04618"></a><span class="lineno"> 4618</span>&#160;    }</div><div class="line"><a name="l04619"></a><span class="lineno"> 4619</span>&#160;}</div><div class="line"><a name="l04620"></a><span class="lineno"> 4620</span>&#160;</div><div class="line"><a name="l04621"></a><span class="lineno"> 4621</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l04622"></a><span class="lineno"><a class="line" href="log__manager_8h.html#acc276f18c02a976bd38d99c017921401"> 4622</a></span>&#160;<a class="code" href="log__manager_8c.html#acc276f18c02a976bd38d99c017921401">log_append_repl_info</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="structlog__tdes.html">LOG_TDES</a> * tdes, <span class="keywordtype">bool</span> is_commit)</div><div class="line"><a name="l04623"></a><span class="lineno"> 4623</span>&#160;{</div><div class="line"><a name="l04624"></a><span class="lineno"> 4624</span>&#160;  log_append_repl_info_internal (thread_p, tdes, is_commit, <a class="code" href="log__impl_8h.html#ae1aad1a6b2c71bde2d1b93df8bc54e38a64cd568849ed79c339bd3b320dcacb25">LOG_PRIOR_LSA_WITHOUT_LOCK</a>);</div><div class="line"><a name="l04625"></a><span class="lineno"> 4625</span>&#160;}</div><div class="line"><a name="l04626"></a><span class="lineno"> 4626</span>&#160;</div><div class="line"><a name="l04627"></a><span class="lineno"> 4627</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div><div class="line"><a name="l04628"></a><span class="lineno"> 4628</span>&#160;log_append_repl_info_with_lock (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="structlog__tdes.html">LOG_TDES</a> * tdes, <span class="keywordtype">bool</span> is_commit)</div><div class="line"><a name="l04629"></a><span class="lineno"> 4629</span>&#160;{</div><div class="line"><a name="l04630"></a><span class="lineno"> 4630</span>&#160;  log_append_repl_info_internal (thread_p, tdes, is_commit, <a class="code" href="log__impl_8h.html#ae1aad1a6b2c71bde2d1b93df8bc54e38a6c10b3c3be256976a47bf7f85174c7d3">LOG_PRIOR_LSA_WITH_LOCK</a>);</div><div class="line"><a name="l04631"></a><span class="lineno"> 4631</span>&#160;}</div><div class="line"><a name="l04632"></a><span class="lineno"> 4632</span>&#160;</div><div class="line"><a name="l04633"></a><span class="lineno"> 4633</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l04634"></a><span class="lineno"> 4634</span>&#160;<span class="comment"> * log_append_repl_info_and_commit_log - append repl log along with commit log.</span></div><div class="line"><a name="l04635"></a><span class="lineno"> 4635</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04636"></a><span class="lineno"> 4636</span>&#160;<span class="comment"> * return: none</span></div><div class="line"><a name="l04637"></a><span class="lineno"> 4637</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04638"></a><span class="lineno"> 4638</span>&#160;<span class="comment"> *   tdes(in): </span></div><div class="line"><a name="l04639"></a><span class="lineno"> 4639</span>&#160;<span class="comment"> *   commit_lsa(out): LSA of commit log</span></div><div class="line"><a name="l04640"></a><span class="lineno"> 4640</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04641"></a><span class="lineno"> 4641</span>&#160;<span class="comment"> * NOTE: Atomic write of replication log and commit log is crucial for replication consistencies. </span></div><div class="line"><a name="l04642"></a><span class="lineno"> 4642</span>&#160;<span class="comment"> *       When a commit log of others is written in the middle of one&#39;s replication and commit log, </span></div><div class="line"><a name="l04643"></a><span class="lineno"> 4643</span>&#160;<span class="comment"> *       a restart of replication will break consistencies of slaves/replicas.</span></div><div class="line"><a name="l04644"></a><span class="lineno"> 4644</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l04645"></a><span class="lineno"> 4645</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div><div class="line"><a name="l04646"></a><span class="lineno"> 4646</span>&#160;log_append_repl_info_and_commit_log (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="structlog__tdes.html">LOG_TDES</a> * tdes, <a class="code" href="structlog__lsa.html">LOG_LSA</a> * commit_lsa)</div><div class="line"><a name="l04647"></a><span class="lineno"> 4647</span>&#160;{</div><div class="line"><a name="l04648"></a><span class="lineno"> 4648</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="mprec_8c.html#a115f98821af8b9ac2f97f2ac2cb2797f">rv</a>;</div><div class="line"><a name="l04649"></a><span class="lineno"> 4649</span>&#160;</div><div class="line"><a name="l04650"></a><span class="lineno"> 4650</span>&#160;  <a class="code" href="mprec_8c.html#a115f98821af8b9ac2f97f2ac2cb2797f">rv</a> = <a class="code" href="log__manager_8c.html#a3bd1ad5edf8fc93f783af77e8cd6ee9a">pthread_mutex_lock</a> (&amp;<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1e76ccd9e44777acc719b8f1bdbb93bb">prior_info</a>.<a class="code" href="structlog__prior__lsa__info.html#adb03b78b697ffe97dce7c7d1fc763dc4">prior_lsa_mutex</a>);</div><div class="line"><a name="l04651"></a><span class="lineno"> 4651</span>&#160;</div><div class="line"><a name="l04652"></a><span class="lineno"> 4652</span>&#160;  log_append_repl_info_with_lock (thread_p, tdes, <span class="keyword">true</span>);</div><div class="line"><a name="l04653"></a><span class="lineno"> 4653</span>&#160;  log_append_commit_log_with_lock (thread_p, tdes, commit_lsa);</div><div class="line"><a name="l04654"></a><span class="lineno"> 4654</span>&#160;</div><div class="line"><a name="l04655"></a><span class="lineno"> 4655</span>&#160;  <a class="code" href="log__manager_8c.html#aa91b7ec8ae8a2d699fb09cc20c444fe8">pthread_mutex_unlock</a> (&amp;<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1e76ccd9e44777acc719b8f1bdbb93bb">prior_info</a>.<a class="code" href="structlog__prior__lsa__info.html#adb03b78b697ffe97dce7c7d1fc763dc4">prior_lsa_mutex</a>);</div><div class="line"><a name="l04656"></a><span class="lineno"> 4656</span>&#160;}</div><div class="line"><a name="l04657"></a><span class="lineno"> 4657</span>&#160;</div><div class="line"><a name="l04658"></a><span class="lineno"> 4658</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l04659"></a><span class="lineno"> 4659</span>&#160;<span class="comment"> * log_append_donetime_internal - APPEND COMMIT/ABORT LOG RECORD ALONG WITH TIME OF TERMINATION.</span></div><div class="line"><a name="l04660"></a><span class="lineno"> 4660</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04661"></a><span class="lineno"> 4661</span>&#160;<span class="comment"> * return: none</span></div><div class="line"><a name="l04662"></a><span class="lineno"> 4662</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04663"></a><span class="lineno"> 4663</span>&#160;<span class="comment"> *   tdes(in): </span></div><div class="line"><a name="l04664"></a><span class="lineno"> 4664</span>&#160;<span class="comment"> *   eot_lsa(out): LSA of COMMIT/ABORT log</span></div><div class="line"><a name="l04665"></a><span class="lineno"> 4665</span>&#160;<span class="comment"> *   iscommitted(in): Is transaction been finished as committed?</span></div><div class="line"><a name="l04666"></a><span class="lineno"> 4666</span>&#160;<span class="comment"> *   with_lock(in): whether it has mutex or not.</span></div><div class="line"><a name="l04667"></a><span class="lineno"> 4667</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04668"></a><span class="lineno"> 4668</span>&#160;<span class="comment"> * NOTE: a commit or abort record is recorded along with the current time as the termination time of the transaction.</span></div><div class="line"><a name="l04669"></a><span class="lineno"> 4669</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l04670"></a><span class="lineno"> 4670</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div><div class="line"><a name="l04671"></a><span class="lineno"> 4671</span>&#160;log_append_donetime_internal (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="structlog__tdes.html">LOG_TDES</a> * tdes, <a class="code" href="structlog__lsa.html">LOG_LSA</a> * eot_lsa, <a class="code" href="log__impl_8h.html#ab85dbe80b115a32bf7a430c32ddc5b8b">LOG_RECTYPE</a> iscommitted,</div><div class="line"><a name="l04672"></a><span class="lineno"> 4672</span>&#160;                  <span class="keyword">enum</span> <a class="code" href="log__impl_8h.html#ae1aad1a6b2c71bde2d1b93df8bc54e38">LOG_PRIOR_LSA_LOCK</a> with_lock)</div><div class="line"><a name="l04673"></a><span class="lineno"> 4673</span>&#160;{</div><div class="line"><a name="l04674"></a><span class="lineno"> 4674</span>&#160;  <a class="code" href="structlog__rec__donetime.html">LOG_REC_DONETIME</a> *donetime;</div><div class="line"><a name="l04675"></a><span class="lineno"> 4675</span>&#160;  <a class="code" href="structlog__prior__node.html">LOG_PRIOR_NODE</a> *<a class="code" href="external_2include_2queue_8h.html#a465e28dbd1a1c60ff504d3ea275613ed">node</a>;</div><div class="line"><a name="l04676"></a><span class="lineno"> 4676</span>&#160;  <a class="code" href="structlog__lsa.html">LOG_LSA</a> lsa;</div><div class="line"><a name="l04677"></a><span class="lineno"> 4677</span>&#160;</div><div class="line"><a name="l04678"></a><span class="lineno"> 4678</span>&#160;  eot_lsa-&gt;<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a> = <a class="code" href="storage__common_8h.html#a7ed60eef43941f46fadae895f63ee033">NULL_PAGEID</a>;</div><div class="line"><a name="l04679"></a><span class="lineno"> 4679</span>&#160;  eot_lsa-&gt;<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a> = <a class="code" href="storage__common_8h.html#a5b0ca3ea530f289fa3f19921e5b0faf3">NULL_OFFSET</a>;</div><div class="line"><a name="l04680"></a><span class="lineno"> 4680</span>&#160;</div><div class="line"><a name="l04681"></a><span class="lineno"> 4681</span>&#160;  <a class="code" href="structnodeptr.html">node</a> = <a class="code" href="log__impl_8h.html#a2b616997f446dcb588a6addcc65cf5b7">prior_lsa_alloc_and_copy_data</a> (thread_p, iscommitted, <a class="code" href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2ba6ea83d694355ec2c529960461a086f26">RV_NOT_DEFINED</a>, <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l04682"></a><span class="lineno"> 4682</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="structnodeptr.html">node</a> == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l04683"></a><span class="lineno"> 4683</span>&#160;    {</div><div class="line"><a name="l04684"></a><span class="lineno"> 4684</span>&#160;      <span class="comment">/* FIXME */</span></div><div class="line"><a name="l04685"></a><span class="lineno"> 4685</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l04686"></a><span class="lineno"> 4686</span>&#160;    }</div><div class="line"><a name="l04687"></a><span class="lineno"> 4687</span>&#160;</div><div class="line"><a name="l04688"></a><span class="lineno"> 4688</span>&#160;  donetime = (<a class="code" href="structlog__rec__donetime.html">LOG_REC_DONETIME</a> *) <a class="code" href="structnodeptr.html">node</a>-&gt;data_header;</div><div class="line"><a name="l04689"></a><span class="lineno"> 4689</span>&#160;  donetime-&gt;<a class="code" href="structlog__rec__donetime.html#ab2f504036b88c922a0a3f1db4524d70b">at_time</a> = <a class="code" href="namespacebrokerstatus__to__csv.html#ae075d9642cd7485bc938b7d65b2e6991">time</a> (<a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l04690"></a><span class="lineno"> 4690</span>&#160;</div><div class="line"><a name="l04691"></a><span class="lineno"> 4691</span>&#160;  <span class="keywordflow">if</span> (with_lock == <a class="code" href="log__impl_8h.html#ae1aad1a6b2c71bde2d1b93df8bc54e38a6c10b3c3be256976a47bf7f85174c7d3">LOG_PRIOR_LSA_WITH_LOCK</a>)</div><div class="line"><a name="l04692"></a><span class="lineno"> 4692</span>&#160;    {</div><div class="line"><a name="l04693"></a><span class="lineno"> 4693</span>&#160;      lsa = <a class="code" href="log__impl_8h.html#ad6e16f99d29b73760a0855d9b0ac7e1b">prior_lsa_next_record_with_lock</a> (thread_p, <a class="code" href="structnodeptr.html">node</a>, tdes);</div><div class="line"><a name="l04694"></a><span class="lineno"> 4694</span>&#160;    }</div><div class="line"><a name="l04695"></a><span class="lineno"> 4695</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l04696"></a><span class="lineno"> 4696</span>&#160;    {</div><div class="line"><a name="l04697"></a><span class="lineno"> 4697</span>&#160;      lsa = <a class="code" href="log__impl_8h.html#a8a3ce7b7aa59fe26c04eca3577e434e8">prior_lsa_next_record</a> (thread_p, <a class="code" href="structnodeptr.html">node</a>, tdes);</div><div class="line"><a name="l04698"></a><span class="lineno"> 4698</span>&#160;    }</div><div class="line"><a name="l04699"></a><span class="lineno"> 4699</span>&#160;</div><div class="line"><a name="l04700"></a><span class="lineno"> 4700</span>&#160;  <a class="code" href="storage__common_8h.html#a4c9bc15296fe6728cf0351726cc6ad09">LSA_COPY</a> (eot_lsa, &amp;lsa);</div><div class="line"><a name="l04701"></a><span class="lineno"> 4701</span>&#160;}</div><div class="line"><a name="l04702"></a><span class="lineno"> 4702</span>&#160;</div><div class="line"><a name="l04703"></a><span class="lineno"> 4703</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l04704"></a><span class="lineno"> 4704</span>&#160;<span class="comment"> * log_change_tran_as_completed - change the state of a transaction as committed/aborted</span></div><div class="line"><a name="l04705"></a><span class="lineno"> 4705</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04706"></a><span class="lineno"> 4706</span>&#160;<span class="comment"> * return: nothing</span></div><div class="line"><a name="l04707"></a><span class="lineno"> 4707</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04708"></a><span class="lineno"> 4708</span>&#160;<span class="comment"> *   tdes(in/out): State structure of transaction being committed/aborted.</span></div><div class="line"><a name="l04709"></a><span class="lineno"> 4709</span>&#160;<span class="comment"> *   iscommitted(in): Is transaction been finished as committed ?</span></div><div class="line"><a name="l04710"></a><span class="lineno"> 4710</span>&#160;<span class="comment"> *   lsa(in): commit lsa to flush logs</span></div><div class="line"><a name="l04711"></a><span class="lineno"> 4711</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04712"></a><span class="lineno"> 4712</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l04713"></a><span class="lineno"> 4713</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div><div class="line"><a name="l04714"></a><span class="lineno"> 4714</span>&#160;log_change_tran_as_completed (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="structlog__tdes.html">LOG_TDES</a> * tdes, <a class="code" href="log__impl_8h.html#ab85dbe80b115a32bf7a430c32ddc5b8b">LOG_RECTYPE</a> iscommitted, <a class="code" href="structlog__lsa.html">LOG_LSA</a> * lsa)</div><div class="line"><a name="l04715"></a><span class="lineno"> 4715</span>&#160;{</div><div class="line"><a name="l04716"></a><span class="lineno"> 4716</span>&#160;  <span class="keywordflow">if</span> (iscommitted == <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a1903de7cf7fa88081eb8010a667e1839">LOG_COMMIT</a>)</div><div class="line"><a name="l04717"></a><span class="lineno"> 4717</span>&#160;    {</div><div class="line"><a name="l04718"></a><span class="lineno"> 4718</span>&#160;      tdes-&gt;<a class="code" href="structlog__tdes.html#ad924146690490b840ef5c3f65c3a5a6c">state</a> = <a class="code" href="log__comm_8h.html#a3c0be9b9f104459ab90ee18af95c4b3ea6ddb25e9eb5bdd0477b4da46f8edcaba">TRAN_UNACTIVE_COMMITTED</a>;</div><div class="line"><a name="l04719"></a><span class="lineno"> 4719</span>&#160;</div><div class="line"><a name="l04720"></a><span class="lineno"> 4720</span>&#160;      <a class="code" href="log__impl_8h.html#af18a3c0b2ebcb342344e71db70c4f1c1">log_Stat</a>.<a class="code" href="structlog__logging__stat.html#a38ace8b59ae1ca20fec2e0d648834d5a">commit_count</a>++;</div><div class="line"><a name="l04721"></a><span class="lineno"> 4721</span>&#160;</div><div class="line"><a name="l04722"></a><span class="lineno"> 4722</span>&#160;      <a class="code" href="log__impl_8h.html#aa91abaf89af63e703737ac5c00d7cd7d">logpb_flush_pages</a> (thread_p, lsa);</div><div class="line"><a name="l04723"></a><span class="lineno"> 4723</span>&#160;    }</div><div class="line"><a name="l04724"></a><span class="lineno"> 4724</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l04725"></a><span class="lineno"> 4725</span>&#160;    {</div><div class="line"><a name="l04726"></a><span class="lineno"> 4726</span>&#160;      tdes-&gt;<a class="code" href="structlog__tdes.html#ad924146690490b840ef5c3f65c3a5a6c">state</a> = <a class="code" href="log__comm_8h.html#a3c0be9b9f104459ab90ee18af95c4b3eac19d6ad89f93ec75c1e1904db0e5c0ad">TRAN_UNACTIVE_ABORTED</a>;</div><div class="line"><a name="l04727"></a><span class="lineno"> 4727</span>&#160;    }</div><div class="line"><a name="l04728"></a><span class="lineno"> 4728</span>&#160;</div><div class="line"><a name="l04729"></a><span class="lineno"> 4729</span>&#160;<span class="preprocessor">#if !defined (NDEBUG)</span></div><div class="line"><a name="l04730"></a><span class="lineno"> 4730</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="system__parameter_8c.html#a678756564699cbc93bd758cf6f99a042">prm_get_bool_value</a> (<a class="code" href="system__parameter_8h.html#a23aaf6bca406b9b428f43ad1b6b2b3e0a941dffd866597ae3fa646a852919fef4">PRM_ID_LOG_TRACE_DEBUG</a>))</div><div class="line"><a name="l04731"></a><span class="lineno"> 4731</span>&#160;    {</div><div class="line"><a name="l04732"></a><span class="lineno"> 4732</span>&#160;      <span class="keywordtype">char</span> time_val[<a class="code" href="porting_8h.html#a7b4ba06a388856deeb25508d04470eaa">CTIME_MAX</a>];</div><div class="line"><a name="l04733"></a><span class="lineno"> 4733</span>&#160;      time_t xxtime = <a class="code" href="namespacebrokerstatus__to__csv.html#ae075d9642cd7485bc938b7d65b2e6991">time</a> (<a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l04734"></a><span class="lineno"> 4734</span>&#160;</div><div class="line"><a name="l04735"></a><span class="lineno"> 4735</span>&#160;      (void) ctime_r (&amp;xxtime, time_val);</div><div class="line"><a name="l04736"></a><span class="lineno"> 4736</span>&#160;      fprintf (stdout,</div><div class="line"><a name="l04737"></a><span class="lineno"> 4737</span>&#160;           <a class="code" href="message__catalog_8c.html#af9597674b8d4504be6fd55145b5af6f0">msgcat_message</a> (<a class="code" href="message__catalog_8h.html#a9b41bc5c782e79c0112014e50461e364">MSGCAT_CATALOG_CUBRID</a>, <a class="code" href="message__catalog_8h.html#aa04e075e72cdb43d5397319b05e9184f">MSGCAT_SET_LOG</a>,</div><div class="line"><a name="l04738"></a><span class="lineno"> 4738</span>&#160;                   ((iscommitted == <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a1903de7cf7fa88081eb8010a667e1839">LOG_COMMIT</a>) ? <a class="code" href="log__impl_8h.html#a0d3a513ea8174d22b361c70c7df970bc">MSGCAT_LOG_FINISH_COMMIT</a> : <a class="code" href="log__impl_8h.html#af7b3d3d0155756e96ceaaf24df4b1bb6">MSGCAT_LOG_FINISH_ABORT</a>)),</div><div class="line"><a name="l04739"></a><span class="lineno"> 4739</span>&#160;           tdes-&gt;<a class="code" href="structlog__tdes.html#ae9437cf94e11e2307172ef5fc7b32aa9">tran_index</a>, tdes-&gt;<a class="code" href="structlog__tdes.html#a3baeff284ed2167bcef74c5ef34d4f3b">trid</a>, <a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>.<a class="code" href="structlog__header.html#a982b3e55dedc3dabc54a1a7fcddc144e">append_lsa</a>.<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a>, <a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>.<a class="code" href="structlog__header.html#a982b3e55dedc3dabc54a1a7fcddc144e">append_lsa</a>.<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a>, time_val);</div><div class="line"><a name="l04740"></a><span class="lineno"> 4740</span>&#160;      fflush (stdout);</div><div class="line"><a name="l04741"></a><span class="lineno"> 4741</span>&#160;    }</div><div class="line"><a name="l04742"></a><span class="lineno"> 4742</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* !NDEBUG */</span><span class="preprocessor"></span></div><div class="line"><a name="l04743"></a><span class="lineno"> 4743</span>&#160;}</div><div class="line"><a name="l04744"></a><span class="lineno"> 4744</span>&#160;</div><div class="line"><a name="l04745"></a><span class="lineno"> 4745</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l04746"></a><span class="lineno"> 4746</span>&#160;<span class="comment"> * log_append_commit_log - append commit log record along with time of termination.</span></div><div class="line"><a name="l04747"></a><span class="lineno"> 4747</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04748"></a><span class="lineno"> 4748</span>&#160;<span class="comment"> * return: nothing</span></div><div class="line"><a name="l04749"></a><span class="lineno"> 4749</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04750"></a><span class="lineno"> 4750</span>&#160;<span class="comment"> *   tdes(in/out): State structure of transaction being committed.</span></div><div class="line"><a name="l04751"></a><span class="lineno"> 4751</span>&#160;<span class="comment"> *   commit_lsa(out): LSA of commit log.</span></div><div class="line"><a name="l04752"></a><span class="lineno"> 4752</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l04753"></a><span class="lineno"> 4753</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div><div class="line"><a name="l04754"></a><span class="lineno"> 4754</span>&#160;log_append_commit_log (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="structlog__tdes.html">LOG_TDES</a> * tdes, <a class="code" href="structlog__lsa.html">LOG_LSA</a> * commit_lsa)</div><div class="line"><a name="l04755"></a><span class="lineno"> 4755</span>&#160;{</div><div class="line"><a name="l04756"></a><span class="lineno"> 4756</span>&#160;  log_append_donetime_internal (thread_p, tdes, commit_lsa, <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a1903de7cf7fa88081eb8010a667e1839">LOG_COMMIT</a>, <a class="code" href="log__impl_8h.html#ae1aad1a6b2c71bde2d1b93df8bc54e38a64cd568849ed79c339bd3b320dcacb25">LOG_PRIOR_LSA_WITHOUT_LOCK</a>);</div><div class="line"><a name="l04757"></a><span class="lineno"> 4757</span>&#160;}</div><div class="line"><a name="l04758"></a><span class="lineno"> 4758</span>&#160;</div><div class="line"><a name="l04759"></a><span class="lineno"> 4759</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l04760"></a><span class="lineno"> 4760</span>&#160;<span class="comment"> * log_append_commit_log_with_lock - append commit log record along with time of termination with prior lsa mutex.</span></div><div class="line"><a name="l04761"></a><span class="lineno"> 4761</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04762"></a><span class="lineno"> 4762</span>&#160;<span class="comment"> * return: none</span></div><div class="line"><a name="l04763"></a><span class="lineno"> 4763</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04764"></a><span class="lineno"> 4764</span>&#160;<span class="comment"> *   tdes(in/out): State structure of transaction being committed.</span></div><div class="line"><a name="l04765"></a><span class="lineno"> 4765</span>&#160;<span class="comment"> *   commit_lsa(out): LSA of commit log.</span></div><div class="line"><a name="l04766"></a><span class="lineno"> 4766</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l04767"></a><span class="lineno"> 4767</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div><div class="line"><a name="l04768"></a><span class="lineno"> 4768</span>&#160;log_append_commit_log_with_lock (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="structlog__tdes.html">LOG_TDES</a> * tdes, <a class="code" href="structlog__lsa.html">LOG_LSA</a> * commit_lsa)</div><div class="line"><a name="l04769"></a><span class="lineno"> 4769</span>&#160;{</div><div class="line"><a name="l04770"></a><span class="lineno"> 4770</span>&#160;  log_append_donetime_internal (thread_p, tdes, commit_lsa, <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a1903de7cf7fa88081eb8010a667e1839">LOG_COMMIT</a>, <a class="code" href="log__impl_8h.html#ae1aad1a6b2c71bde2d1b93df8bc54e38a6c10b3c3be256976a47bf7f85174c7d3">LOG_PRIOR_LSA_WITH_LOCK</a>);</div><div class="line"><a name="l04771"></a><span class="lineno"> 4771</span>&#160;}</div><div class="line"><a name="l04772"></a><span class="lineno"> 4772</span>&#160;</div><div class="line"><a name="l04773"></a><span class="lineno"> 4773</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l04774"></a><span class="lineno"> 4774</span>&#160;<span class="comment"> * log_append_abort_log - append abort log record along with time of termination </span></div><div class="line"><a name="l04775"></a><span class="lineno"> 4775</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04776"></a><span class="lineno"> 4776</span>&#160;<span class="comment"> * return: nothing</span></div><div class="line"><a name="l04777"></a><span class="lineno"> 4777</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04778"></a><span class="lineno"> 4778</span>&#160;<span class="comment"> *   tdes(in/out): State structure of transaction being aborted.</span></div><div class="line"><a name="l04779"></a><span class="lineno"> 4779</span>&#160;<span class="comment"> *   abort_lsa(out): LSA of abort log.</span></div><div class="line"><a name="l04780"></a><span class="lineno"> 4780</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l04781"></a><span class="lineno"> 4781</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div><div class="line"><a name="l04782"></a><span class="lineno"> 4782</span>&#160;log_append_abort_log (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="structlog__tdes.html">LOG_TDES</a> * tdes, <a class="code" href="structlog__lsa.html">LOG_LSA</a> * abort_lsa)</div><div class="line"><a name="l04783"></a><span class="lineno"> 4783</span>&#160;{</div><div class="line"><a name="l04784"></a><span class="lineno"> 4784</span>&#160;  log_append_donetime_internal (thread_p, tdes, abort_lsa, <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a66f7a15b57486fb9081e733c142d35ea">LOG_ABORT</a>, <a class="code" href="log__impl_8h.html#ae1aad1a6b2c71bde2d1b93df8bc54e38a64cd568849ed79c339bd3b320dcacb25">LOG_PRIOR_LSA_WITHOUT_LOCK</a>);</div><div class="line"><a name="l04785"></a><span class="lineno"> 4785</span>&#160;}</div><div class="line"><a name="l04786"></a><span class="lineno"> 4786</span>&#160;</div><div class="line"><a name="l04787"></a><span class="lineno"> 4787</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l04788"></a><span class="lineno"> 4788</span>&#160;<span class="comment"> * log_add_to_modified_class_list -</span></div><div class="line"><a name="l04789"></a><span class="lineno"> 4789</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04790"></a><span class="lineno"> 4790</span>&#160;<span class="comment"> * return:</span></div><div class="line"><a name="l04791"></a><span class="lineno"> 4791</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04792"></a><span class="lineno"> 4792</span>&#160;<span class="comment"> *   classname(in):</span></div><div class="line"><a name="l04793"></a><span class="lineno"> 4793</span>&#160;<span class="comment"> *   class_oid(in):</span></div><div class="line"><a name="l04794"></a><span class="lineno"> 4794</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04795"></a><span class="lineno"> 4795</span>&#160;<span class="comment"> * NOTE: Function for LOG_TDES.modified_class_list</span></div><div class="line"><a name="l04796"></a><span class="lineno"> 4796</span>&#160;<span class="comment"> *       This list keeps the following information:</span></div><div class="line"><a name="l04797"></a><span class="lineno"> 4797</span>&#160;<span class="comment"> *        {name, OID} of modified class and LSA for the last modification</span></div><div class="line"><a name="l04798"></a><span class="lineno"> 4798</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l04799"></a><span class="lineno"> 4799</span>&#160;<span class="keywordtype">int</span></div><div class="line"><a name="l04800"></a><span class="lineno"><a class="line" href="log__manager_8h.html#a965680d1292c6bd89c0353d65b2074cb"> 4800</a></span>&#160;<a class="code" href="log__manager_8c.html#a965680d1292c6bd89c0353d65b2074cb">log_add_to_modified_class_list</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <span class="keyword">const</span> <span class="keywordtype">char</span> *classname, <span class="keyword">const</span> <a class="code" href="structdb__identifier.html">OID</a> * class_oid)</div><div class="line"><a name="l04801"></a><span class="lineno"> 4801</span>&#160;{</div><div class="line"><a name="l04802"></a><span class="lineno"> 4802</span>&#160;  <a class="code" href="structlog__tdes.html">LOG_TDES</a> *tdes;</div><div class="line"><a name="l04803"></a><span class="lineno"> 4803</span>&#160;  <a class="code" href="structmodified__class__entry.html">MODIFIED_CLASS_ENTRY</a> *t = <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l04804"></a><span class="lineno"> 4804</span>&#160;<span class="preprocessor">#if !defined(NDEBUG)</span></div><div class="line"><a name="l04805"></a><span class="lineno"> 4805</span>&#160;  <a class="code" href="structmodified__class__entry.html">MODIFIED_CLASS_ENTRY</a> *<a class="code" href="dtoa_8c.html#aeab71244afb687f16d8c4f5ee9d6ef0e">n</a> = <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l04806"></a><span class="lineno"> 4806</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l04807"></a><span class="lineno"> 4807</span>&#160;  <span class="keywordtype">int</span> tran_index;</div><div class="line"><a name="l04808"></a><span class="lineno"> 4808</span>&#160;</div><div class="line"><a name="l04809"></a><span class="lineno"> 4809</span>&#160;  <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (classname != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l04810"></a><span class="lineno"> 4810</span>&#160;  <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (class_oid != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l04811"></a><span class="lineno"> 4811</span>&#160;  <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (!<a class="code" href="oid_8h.html#a0f82ba684a0a36730f8373de8d4ba9ef">OID_ISNULL</a> (class_oid));</div><div class="line"><a name="l04812"></a><span class="lineno"> 4812</span>&#160;  <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (class_oid-&gt;<a class="code" href="structdb__identifier.html#a07604ea396d24b1babeab350ff10d07d">volid</a> &gt;= 0);   <span class="comment">/* is not temp_oid */</span></div><div class="line"><a name="l04813"></a><span class="lineno"> 4813</span>&#160;</div><div class="line"><a name="l04814"></a><span class="lineno"> 4814</span>&#160;  tran_index = <a class="code" href="perf__monitor_8h.html#a55d27b01d605ba6ee2929ddfe8588320">LOG_FIND_THREAD_TRAN_INDEX</a> (thread_p);</div><div class="line"><a name="l04815"></a><span class="lineno"> 4815</span>&#160;  tdes = <a class="code" href="log__impl_8h.html#a08fee41cfcf592e8afdbc4988ffbc8e4">LOG_FIND_TDES</a> (tran_index);</div><div class="line"><a name="l04816"></a><span class="lineno"> 4816</span>&#160;  <span class="keywordflow">if</span> (tdes == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l04817"></a><span class="lineno"> 4817</span>&#160;    {</div><div class="line"><a name="l04818"></a><span class="lineno"> 4818</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="error__code_8h.html#a51778caf175b7d6bfe9e8977d9a0032e">ER_FAILED</a>;</div><div class="line"><a name="l04819"></a><span class="lineno"> 4819</span>&#160;    }</div><div class="line"><a name="l04820"></a><span class="lineno"> 4820</span>&#160;</div><div class="line"><a name="l04821"></a><span class="lineno"> 4821</span>&#160;<span class="preprocessor">#if !defined(NDEBUG)</span></div><div class="line"><a name="l04822"></a><span class="lineno"> 4822</span>&#160;  <span class="comment">/* check iff duplicated {classname, class_oid} pair */</span></div><div class="line"><a name="l04823"></a><span class="lineno"> 4823</span>&#160;  <span class="keywordflow">for</span> (t = tdes-&gt;<a class="code" href="structlog__tdes.html#ac9e24cb7fdff0af7ecdaed07174fb170">modified_class_list</a>; t != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>; t = t-&gt;<a class="code" href="structmodified__class__entry.html#a25d46b6e46ce413b419562bfd54fe841">m_next</a>)</div><div class="line"><a name="l04824"></a><span class="lineno"> 4824</span>&#160;    {</div><div class="line"><a name="l04825"></a><span class="lineno"> 4825</span>&#160;      <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (t-&gt;<a class="code" href="structmodified__class__entry.html#aa2c44513a27ed926f4547a0ae65c9d31">m_classname</a> != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l04826"></a><span class="lineno"> 4826</span>&#160;      <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (!<a class="code" href="oid_8h.html#a0f82ba684a0a36730f8373de8d4ba9ef">OID_ISNULL</a> (&amp;t-&gt;<a class="code" href="structmodified__class__entry.html#ad721351a182c9e8df087382283d495c7">m_class_oid</a>));</div><div class="line"><a name="l04827"></a><span class="lineno"> 4827</span>&#160;      <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (t-&gt;<a class="code" href="structmodified__class__entry.html#ad721351a182c9e8df087382283d495c7">m_class_oid</a>.<a class="code" href="structdb__identifier.html#a07604ea396d24b1babeab350ff10d07d">volid</a> &gt;= 0);   <span class="comment">/* is not temp_oid */</span></div><div class="line"><a name="l04828"></a><span class="lineno"> 4828</span>&#160;</div><div class="line"><a name="l04829"></a><span class="lineno"> 4829</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="dtoa_8c.html#aeab71244afb687f16d8c4f5ee9d6ef0e">n</a> = t-&gt;<a class="code" href="structmodified__class__entry.html#a25d46b6e46ce413b419562bfd54fe841">m_next</a>; <a class="code" href="dtoa_8c.html#aeab71244afb687f16d8c4f5ee9d6ef0e">n</a> != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>; <a class="code" href="dtoa_8c.html#aeab71244afb687f16d8c4f5ee9d6ef0e">n</a> = <a class="code" href="dtoa_8c.html#aeab71244afb687f16d8c4f5ee9d6ef0e">n</a>-&gt;m_next)</div><div class="line"><a name="l04830"></a><span class="lineno"> 4830</span>&#160;    {</div><div class="line"><a name="l04831"></a><span class="lineno"> 4831</span>&#160;      <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (!(strcmp (t-&gt;<a class="code" href="structmodified__class__entry.html#aa2c44513a27ed926f4547a0ae65c9d31">m_classname</a>, <a class="code" href="dtoa_8c.html#aeab71244afb687f16d8c4f5ee9d6ef0e">n</a>-&gt;m_classname) == 0 &amp;&amp; <a class="code" href="oid_8h.html#a2e75f71b34eb92af87dbbe5abc3974e7">OID_EQ</a> (&amp;t-&gt;<a class="code" href="structmodified__class__entry.html#ad721351a182c9e8df087382283d495c7">m_class_oid</a>, &amp;<a class="code" href="dtoa_8c.html#aeab71244afb687f16d8c4f5ee9d6ef0e">n</a>-&gt;m_class_oid)));</div><div class="line"><a name="l04832"></a><span class="lineno"> 4832</span>&#160;    }</div><div class="line"><a name="l04833"></a><span class="lineno"> 4833</span>&#160;    }</div><div class="line"><a name="l04834"></a><span class="lineno"> 4834</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l04835"></a><span class="lineno"> 4835</span>&#160;</div><div class="line"><a name="l04836"></a><span class="lineno"> 4836</span>&#160;  <span class="keywordflow">for</span> (t = tdes-&gt;<a class="code" href="structlog__tdes.html#ac9e24cb7fdff0af7ecdaed07174fb170">modified_class_list</a>; t != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>; t = t-&gt;<a class="code" href="structmodified__class__entry.html#a25d46b6e46ce413b419562bfd54fe841">m_next</a>)</div><div class="line"><a name="l04837"></a><span class="lineno"> 4837</span>&#160;    {</div><div class="line"><a name="l04838"></a><span class="lineno"> 4838</span>&#160;      <span class="keywordflow">if</span> (strcmp (t-&gt;<a class="code" href="structmodified__class__entry.html#aa2c44513a27ed926f4547a0ae65c9d31">m_classname</a>, classname) == 0 &amp;&amp; <a class="code" href="oid_8h.html#a2e75f71b34eb92af87dbbe5abc3974e7">OID_EQ</a> (&amp;t-&gt;<a class="code" href="structmodified__class__entry.html#ad721351a182c9e8df087382283d495c7">m_class_oid</a>, class_oid))</div><div class="line"><a name="l04839"></a><span class="lineno"> 4839</span>&#160;    {</div><div class="line"><a name="l04840"></a><span class="lineno"> 4840</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l04841"></a><span class="lineno"> 4841</span>&#160;    }</div><div class="line"><a name="l04842"></a><span class="lineno"> 4842</span>&#160;    }</div><div class="line"><a name="l04843"></a><span class="lineno"> 4843</span>&#160;</div><div class="line"><a name="l04844"></a><span class="lineno"> 4844</span>&#160;  <span class="keywordflow">if</span> (t == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l04845"></a><span class="lineno"> 4845</span>&#160;    {               <span class="comment">/* class is not in modified_class_list */</span></div><div class="line"><a name="l04846"></a><span class="lineno"> 4846</span>&#160;      t = (<a class="code" href="structmodified__class__entry.html">MODIFIED_CLASS_ENTRY</a> *) <a class="code" href="leak__detector_8h.html#a99aa8fd9f4831e1b0fa9e1cdcde3e249">malloc</a> (<span class="keyword">sizeof</span> (<a class="code" href="structmodified__class__entry.html">MODIFIED_CLASS_ENTRY</a>));</div><div class="line"><a name="l04847"></a><span class="lineno"> 4847</span>&#160;      <span class="keywordflow">if</span> (t == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l04848"></a><span class="lineno"> 4848</span>&#160;    {</div><div class="line"><a name="l04849"></a><span class="lineno"> 4849</span>&#160;      <a class="code" href="error__manager_8c.html#afdaf87ce30f2f557802a185ab85b6599">er_set</a> (<a class="code" href="error__manager_8h.html#a5d0d456c474e11fc70779873a30a7432a07ad8f9fda27124d297c94b7d3ea44e8">ER_ERROR_SEVERITY</a>, <a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <a class="code" href="error__code_8h.html#a1f7116a1f1981bc7ef25fc6078518692">ER_OUT_OF_VIRTUAL_MEMORY</a>, 1, <span class="keyword">sizeof</span> (<a class="code" href="structmodified__class__entry.html">MODIFIED_CLASS_ENTRY</a>));</div><div class="line"><a name="l04850"></a><span class="lineno"> 4850</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="error__code_8h.html#a1f7116a1f1981bc7ef25fc6078518692">ER_OUT_OF_VIRTUAL_MEMORY</a>;</div><div class="line"><a name="l04851"></a><span class="lineno"> 4851</span>&#160;    }</div><div class="line"><a name="l04852"></a><span class="lineno"> 4852</span>&#160;</div><div class="line"><a name="l04853"></a><span class="lineno"> 4853</span>&#160;      t-&gt;<a class="code" href="structmodified__class__entry.html#aa2c44513a27ed926f4547a0ae65c9d31">m_classname</a> = <a class="code" href="leak__detector_8h.html#ad832104a69551cf1e4e347fffa9dc77c">strdup</a> (classname);</div><div class="line"><a name="l04854"></a><span class="lineno"> 4854</span>&#160;      <span class="keywordflow">if</span> (t-&gt;<a class="code" href="structmodified__class__entry.html#aa2c44513a27ed926f4547a0ae65c9d31">m_classname</a> == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l04855"></a><span class="lineno"> 4855</span>&#160;    {</div><div class="line"><a name="l04856"></a><span class="lineno"> 4856</span>&#160;      <a class="code" href="memory__alloc_8h.html#a794b5a73adc277837a0c4d12da4af5af">free_and_init</a> (t);</div><div class="line"><a name="l04857"></a><span class="lineno"> 4857</span>&#160;      <a class="code" href="error__manager_8c.html#afdaf87ce30f2f557802a185ab85b6599">er_set</a> (<a class="code" href="error__manager_8h.html#a5d0d456c474e11fc70779873a30a7432a07ad8f9fda27124d297c94b7d3ea44e8">ER_ERROR_SEVERITY</a>, <a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <a class="code" href="error__code_8h.html#a1f7116a1f1981bc7ef25fc6078518692">ER_OUT_OF_VIRTUAL_MEMORY</a>, 1, <a class="code" href="intl__support_8c.html#ab543901c3564a54b2450303d63374f55">strlen</a> (classname));</div><div class="line"><a name="l04858"></a><span class="lineno"> 4858</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="error__code_8h.html#a1f7116a1f1981bc7ef25fc6078518692">ER_OUT_OF_VIRTUAL_MEMORY</a>;</div><div class="line"><a name="l04859"></a><span class="lineno"> 4859</span>&#160;    }</div><div class="line"><a name="l04860"></a><span class="lineno"> 4860</span>&#160;</div><div class="line"><a name="l04861"></a><span class="lineno"> 4861</span>&#160;      <a class="code" href="oid_8h.html#a05700e09529ceccd047f910e9ff64d3c">COPY_OID</a> (&amp;t-&gt;<a class="code" href="structmodified__class__entry.html#ad721351a182c9e8df087382283d495c7">m_class_oid</a>, class_oid);</div><div class="line"><a name="l04862"></a><span class="lineno"> 4862</span>&#160;      <a class="code" href="storage__common_8h.html#a6a4baec606189dd320678e8f412ca957">LSA_SET_NULL</a> (&amp;t-&gt;<a class="code" href="structmodified__class__entry.html#a8e554ffc2197d19b7f0fdcaac385ea15">m_last_modified_lsa</a>);</div><div class="line"><a name="l04863"></a><span class="lineno"> 4863</span>&#160;</div><div class="line"><a name="l04864"></a><span class="lineno"> 4864</span>&#160;      t-&gt;<a class="code" href="structmodified__class__entry.html#a25d46b6e46ce413b419562bfd54fe841">m_next</a> = tdes-&gt;<a class="code" href="structlog__tdes.html#ac9e24cb7fdff0af7ecdaed07174fb170">modified_class_list</a>;</div><div class="line"><a name="l04865"></a><span class="lineno"> 4865</span>&#160;      tdes-&gt;<a class="code" href="structlog__tdes.html#ac9e24cb7fdff0af7ecdaed07174fb170">modified_class_list</a> = t;</div><div class="line"><a name="l04866"></a><span class="lineno"> 4866</span>&#160;    }</div><div class="line"><a name="l04867"></a><span class="lineno"> 4867</span>&#160;</div><div class="line"><a name="l04868"></a><span class="lineno"> 4868</span>&#160;  <a class="code" href="storage__common_8h.html#a4c9bc15296fe6728cf0351726cc6ad09">LSA_COPY</a> (&amp;t-&gt;<a class="code" href="structmodified__class__entry.html#a8e554ffc2197d19b7f0fdcaac385ea15">m_last_modified_lsa</a>, &amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a5b128a08476a5b499cf82e3163e6d62b">tail_lsa</a>);</div><div class="line"><a name="l04869"></a><span class="lineno"> 4869</span>&#160;</div><div class="line"><a name="l04870"></a><span class="lineno"> 4870</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>;</div><div class="line"><a name="l04871"></a><span class="lineno"> 4871</span>&#160;}</div><div class="line"><a name="l04872"></a><span class="lineno"> 4872</span>&#160;</div><div class="line"><a name="l04873"></a><span class="lineno"> 4873</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l04874"></a><span class="lineno"> 4874</span>&#160;<span class="comment"> * log_is_class_being_modified () - check if a class is being modified by the transaction which is executed by the</span></div><div class="line"><a name="l04875"></a><span class="lineno"> 4875</span>&#160;<span class="comment"> *                  thread parameter</span></div><div class="line"><a name="l04876"></a><span class="lineno"> 4876</span>&#160;<span class="comment"> * return : true if the class is being modified, false otherwise</span></div><div class="line"><a name="l04877"></a><span class="lineno"> 4877</span>&#160;<span class="comment"> * thread_p (in)  : thread entry</span></div><div class="line"><a name="l04878"></a><span class="lineno"> 4878</span>&#160;<span class="comment"> * class_oid (in) : class identifier</span></div><div class="line"><a name="l04879"></a><span class="lineno"> 4879</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l04880"></a><span class="lineno"> 4880</span>&#160;<span class="keywordtype">bool</span></div><div class="line"><a name="l04881"></a><span class="lineno"><a class="line" href="log__manager_8h.html#ab903fb10f0ff9d3073f703ab991cf8a3"> 4881</a></span>&#160;<a class="code" href="log__manager_8c.html#ab903fb10f0ff9d3073f703ab991cf8a3">log_is_class_being_modified</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <span class="keyword">const</span> <a class="code" href="structdb__identifier.html">OID</a> * class_oid)</div><div class="line"><a name="l04882"></a><span class="lineno"> 4882</span>&#160;{</div><div class="line"><a name="l04883"></a><span class="lineno"> 4883</span>&#160;  <a class="code" href="structlog__tdes.html">LOG_TDES</a> *tdes;</div><div class="line"><a name="l04884"></a><span class="lineno"> 4884</span>&#160;  <span class="keywordtype">int</span> tran_index;</div><div class="line"><a name="l04885"></a><span class="lineno"> 4885</span>&#160;  <a class="code" href="structmodified__class__entry.html">MODIFIED_CLASS_ENTRY</a> *t = <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l04886"></a><span class="lineno"> 4886</span>&#160;</div><div class="line"><a name="l04887"></a><span class="lineno"> 4887</span>&#160;  <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (class_oid != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l04888"></a><span class="lineno"> 4888</span>&#160;  <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (!<a class="code" href="oid_8h.html#a0f82ba684a0a36730f8373de8d4ba9ef">OID_ISNULL</a> (class_oid));</div><div class="line"><a name="l04889"></a><span class="lineno"> 4889</span>&#160;  <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (class_oid-&gt;<a class="code" href="structdb__identifier.html#a07604ea396d24b1babeab350ff10d07d">volid</a> &gt;= 0);   <span class="comment">/* is not temp_oid */</span></div><div class="line"><a name="l04890"></a><span class="lineno"> 4890</span>&#160;</div><div class="line"><a name="l04891"></a><span class="lineno"> 4891</span>&#160;  tran_index = <a class="code" href="perf__monitor_8h.html#a55d27b01d605ba6ee2929ddfe8588320">LOG_FIND_THREAD_TRAN_INDEX</a> (thread_p);</div><div class="line"><a name="l04892"></a><span class="lineno"> 4892</span>&#160;  tdes = <a class="code" href="log__impl_8h.html#a08fee41cfcf592e8afdbc4988ffbc8e4">LOG_FIND_TDES</a> (tran_index);</div><div class="line"><a name="l04893"></a><span class="lineno"> 4893</span>&#160;</div><div class="line"><a name="l04894"></a><span class="lineno"> 4894</span>&#160;  <span class="keywordflow">if</span> (tdes == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l04895"></a><span class="lineno"> 4895</span>&#160;    {</div><div class="line"><a name="l04896"></a><span class="lineno"> 4896</span>&#160;      <span class="comment">/* this is an error but this is not the place for handling it */</span></div><div class="line"><a name="l04897"></a><span class="lineno"> 4897</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l04898"></a><span class="lineno"> 4898</span>&#160;    }</div><div class="line"><a name="l04899"></a><span class="lineno"> 4899</span>&#160;</div><div class="line"><a name="l04900"></a><span class="lineno"> 4900</span>&#160;  <span class="keywordflow">for</span> (t = tdes-&gt;<a class="code" href="structlog__tdes.html#ac9e24cb7fdff0af7ecdaed07174fb170">modified_class_list</a>; t != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>; t = t-&gt;<a class="code" href="structmodified__class__entry.html#a25d46b6e46ce413b419562bfd54fe841">m_next</a>)</div><div class="line"><a name="l04901"></a><span class="lineno"> 4901</span>&#160;    {</div><div class="line"><a name="l04902"></a><span class="lineno"> 4902</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="oid_8h.html#a2e75f71b34eb92af87dbbe5abc3974e7">OID_EQ</a> (&amp;t-&gt;<a class="code" href="structmodified__class__entry.html#ad721351a182c9e8df087382283d495c7">m_class_oid</a>, class_oid))</div><div class="line"><a name="l04903"></a><span class="lineno"> 4903</span>&#160;    {</div><div class="line"><a name="l04904"></a><span class="lineno"> 4904</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l04905"></a><span class="lineno"> 4905</span>&#160;    }</div><div class="line"><a name="l04906"></a><span class="lineno"> 4906</span>&#160;    }</div><div class="line"><a name="l04907"></a><span class="lineno"> 4907</span>&#160;</div><div class="line"><a name="l04908"></a><span class="lineno"> 4908</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l04909"></a><span class="lineno"> 4909</span>&#160;}</div><div class="line"><a name="l04910"></a><span class="lineno"> 4910</span>&#160;</div><div class="line"><a name="l04911"></a><span class="lineno"> 4911</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l04912"></a><span class="lineno"> 4912</span>&#160;<span class="comment"> * log_cleanup_modified_class -</span></div><div class="line"><a name="l04913"></a><span class="lineno"> 4913</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04914"></a><span class="lineno"> 4914</span>&#160;<span class="comment"> * return:</span></div><div class="line"><a name="l04915"></a><span class="lineno"> 4915</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04916"></a><span class="lineno"> 4916</span>&#160;<span class="comment"> *   t(in):</span></div><div class="line"><a name="l04917"></a><span class="lineno"> 4917</span>&#160;<span class="comment"> *   arg(in):</span></div><div class="line"><a name="l04918"></a><span class="lineno"> 4918</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04919"></a><span class="lineno"> 4919</span>&#160;<span class="comment"> * NOTE: Function for LOG_TDES.modified_class_list</span></div><div class="line"><a name="l04920"></a><span class="lineno"> 4920</span>&#160;<span class="comment"> *       This will be used to decache the class representations and XASLs when a transaction is finished.</span></div><div class="line"><a name="l04921"></a><span class="lineno"> 4921</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l04922"></a><span class="lineno"> 4922</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div><div class="line"><a name="l04923"></a><span class="lineno"> 4923</span>&#160;log_cleanup_modified_class (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="structmodified__class__entry.html">MODIFIED_CLASS_ENTRY</a> * t, <span class="keywordtype">void</span> *<a class="code" href="expat_8h.html#a9ce2ec4812a92cb6ab39f6e81e9173a9">arg</a>)</div><div class="line"><a name="l04924"></a><span class="lineno"> 4924</span>&#160;{</div><div class="line"><a name="l04925"></a><span class="lineno"> 4925</span>&#160;  <span class="keywordtype">bool</span> decache_classrepr = (<a class="code" href="system_8h.html#abb452686968e48b67397da5f97445f5b">bool</a>) * ((<span class="keywordtype">bool</span> *) <a class="code" href="expat_8h.html#a9ce2ec4812a92cb6ab39f6e81e9173a9">arg</a>);</div><div class="line"><a name="l04926"></a><span class="lineno"> 4926</span>&#160;</div><div class="line"><a name="l04927"></a><span class="lineno"> 4927</span>&#160;  <span class="keywordflow">if</span> (decache_classrepr &amp;&amp; !<a class="code" href="storage__common_8h.html#a26dd766712df5b5c4fcd158f571a75e4">LSA_ISNULL</a> (&amp;t-&gt;<a class="code" href="structmodified__class__entry.html#a8e554ffc2197d19b7f0fdcaac385ea15">m_last_modified_lsa</a>))</div><div class="line"><a name="l04928"></a><span class="lineno"> 4928</span>&#160;    {</div><div class="line"><a name="l04929"></a><span class="lineno"> 4929</span>&#160;      (void) <a class="code" href="heap__file_8c.html#a6adbab21addd8609c2d132eb1ed5e609">heap_classrepr_decache</a> (thread_p, &amp;t-&gt;<a class="code" href="structmodified__class__entry.html#ad721351a182c9e8df087382283d495c7">m_class_oid</a>);</div><div class="line"><a name="l04930"></a><span class="lineno"> 4930</span>&#160;    }</div><div class="line"><a name="l04931"></a><span class="lineno"> 4931</span>&#160;  <span class="comment">/* decache this class from the partitions cache also */</span></div><div class="line"><a name="l04932"></a><span class="lineno"> 4932</span>&#160;  (void) <a class="code" href="partition_8c.html#a52a95bcc2d70fec238c91c2b07d02230">partition_decache_class</a> (thread_p, &amp;t-&gt;<a class="code" href="structmodified__class__entry.html#ad721351a182c9e8df087382283d495c7">m_class_oid</a>);</div><div class="line"><a name="l04933"></a><span class="lineno"> 4933</span>&#160;</div><div class="line"><a name="l04934"></a><span class="lineno"> 4934</span>&#160;  <span class="comment">/* remove XASL cache entries which are relevant with this class */</span></div><div class="line"><a name="l04935"></a><span class="lineno"> 4935</span>&#160;  <a class="code" href="xasl__cache_8c.html#a5bb382a71045eea422d2ce819c1d0736">xcache_remove_by_oid</a> (thread_p, &amp;t-&gt;<a class="code" href="structmodified__class__entry.html#ad721351a182c9e8df087382283d495c7">m_class_oid</a>);</div><div class="line"><a name="l04936"></a><span class="lineno"> 4936</span>&#160;  <span class="comment">/* remove filter predicate cache entries which are relevant with this class */</span></div><div class="line"><a name="l04937"></a><span class="lineno"> 4937</span>&#160;  <a class="code" href="filter__pred__cache_8c.html#a7f6fe5a24f5b913ff994c9482252c6bc">fpcache_remove_by_class</a> (thread_p, &amp;t-&gt;<a class="code" href="structmodified__class__entry.html#ad721351a182c9e8df087382283d495c7">m_class_oid</a>);</div><div class="line"><a name="l04938"></a><span class="lineno"> 4938</span>&#160;}</div><div class="line"><a name="l04939"></a><span class="lineno"> 4939</span>&#160;</div><div class="line"><a name="l04940"></a><span class="lineno"> 4940</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="log__manager_8c.html#a922a0c5f839b07dc18e05320911311f4">locator_drop_transient_class_name_entries</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="structlog__lsa.html">LOG_LSA</a> * savep_lsa);</div><div class="line"><a name="l04941"></a><span class="lineno"> 4941</span>&#160;</div><div class="line"><a name="l04942"></a><span class="lineno"> 4942</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l04943"></a><span class="lineno"> 4943</span>&#160;<span class="comment"> * log_map_modified_class_list -</span></div><div class="line"><a name="l04944"></a><span class="lineno"> 4944</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04945"></a><span class="lineno"> 4945</span>&#160;<span class="comment"> * return:</span></div><div class="line"><a name="l04946"></a><span class="lineno"> 4946</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04947"></a><span class="lineno"> 4947</span>&#160;<span class="comment"> *   tdes(in):</span></div><div class="line"><a name="l04948"></a><span class="lineno"> 4948</span>&#160;<span class="comment"> *   savept_lsa(in): savepoint lsa to rollback</span></div><div class="line"><a name="l04949"></a><span class="lineno"> 4949</span>&#160;<span class="comment"> *   release(in): release the memory or not</span></div><div class="line"><a name="l04950"></a><span class="lineno"> 4950</span>&#160;<span class="comment"> *   map_func(in): optinal</span></div><div class="line"><a name="l04951"></a><span class="lineno"> 4951</span>&#160;<span class="comment"> *   arg(in): optional</span></div><div class="line"><a name="l04952"></a><span class="lineno"> 4952</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04953"></a><span class="lineno"> 4953</span>&#160;<span class="comment"> * NOTE: Function for LOG_TDES.modified_class_list</span></div><div class="line"><a name="l04954"></a><span class="lineno"> 4954</span>&#160;<span class="comment"> *       This will be used to traverse a modified class list and to do something on each entry.</span></div><div class="line"><a name="l04955"></a><span class="lineno"> 4955</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l04956"></a><span class="lineno"> 4956</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div><div class="line"><a name="l04957"></a><span class="lineno"> 4957</span>&#160;log_map_modified_class_list (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="structlog__tdes.html">LOG_TDES</a> * tdes, <a class="code" href="structlog__lsa.html">LOG_LSA</a> * savept_lsa, <span class="keywordtype">bool</span> release,</div><div class="line"><a name="l04958"></a><span class="lineno"> 4958</span>&#160;                 <span class="keywordtype">void</span> (*map_func) (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="structmodified__class__entry.html">MODIFIED_CLASS_ENTRY</a> * clazz, <span class="keywordtype">void</span> *<a class="code" href="expat_8h.html#a9ce2ec4812a92cb6ab39f6e81e9173a9">arg</a>),</div><div class="line"><a name="l04959"></a><span class="lineno"> 4959</span>&#160;                 <span class="keywordtype">void</span> *<a class="code" href="expat_8h.html#a9ce2ec4812a92cb6ab39f6e81e9173a9">arg</a>)</div><div class="line"><a name="l04960"></a><span class="lineno"> 4960</span>&#160;{</div><div class="line"><a name="l04961"></a><span class="lineno"> 4961</span>&#160;  <a class="code" href="structmodified__class__entry.html">MODIFIED_CLASS_ENTRY</a> *t = <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l04962"></a><span class="lineno"> 4962</span>&#160;</div><div class="line"><a name="l04963"></a><span class="lineno"> 4963</span>&#160;  <span class="keywordflow">if</span> (map_func)</div><div class="line"><a name="l04964"></a><span class="lineno"> 4964</span>&#160;    {</div><div class="line"><a name="l04965"></a><span class="lineno"> 4965</span>&#160;      t = tdes-&gt;<a class="code" href="structlog__tdes.html#ac9e24cb7fdff0af7ecdaed07174fb170">modified_class_list</a>;</div><div class="line"><a name="l04966"></a><span class="lineno"> 4966</span>&#160;      <span class="keywordflow">while</span> (t != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l04967"></a><span class="lineno"> 4967</span>&#160;    {</div><div class="line"><a name="l04968"></a><span class="lineno"> 4968</span>&#160;      (void) (*map_func) (thread_p, t, <a class="code" href="expat_8h.html#a9ce2ec4812a92cb6ab39f6e81e9173a9">arg</a>);</div><div class="line"><a name="l04969"></a><span class="lineno"> 4969</span>&#160;      t = t-&gt;<a class="code" href="structmodified__class__entry.html#a25d46b6e46ce413b419562bfd54fe841">m_next</a>;</div><div class="line"><a name="l04970"></a><span class="lineno"> 4970</span>&#160;    }</div><div class="line"><a name="l04971"></a><span class="lineno"> 4971</span>&#160;    }</div><div class="line"><a name="l04972"></a><span class="lineno"> 4972</span>&#160;</div><div class="line"><a name="l04973"></a><span class="lineno"> 4973</span>&#160;  <span class="comment">/* always execute for defense */</span></div><div class="line"><a name="l04974"></a><span class="lineno"> 4974</span>&#160;  (void) <a class="code" href="log__manager_8c.html#a922a0c5f839b07dc18e05320911311f4">locator_drop_transient_class_name_entries</a> (thread_p, savept_lsa);</div><div class="line"><a name="l04975"></a><span class="lineno"> 4975</span>&#160;</div><div class="line"><a name="l04976"></a><span class="lineno"> 4976</span>&#160;  <span class="keywordflow">if</span> (release)</div><div class="line"><a name="l04977"></a><span class="lineno"> 4977</span>&#160;    {</div><div class="line"><a name="l04978"></a><span class="lineno"> 4978</span>&#160;      t = tdes-&gt;<a class="code" href="structlog__tdes.html#ac9e24cb7fdff0af7ecdaed07174fb170">modified_class_list</a>;</div><div class="line"><a name="l04979"></a><span class="lineno"> 4979</span>&#160;      <span class="keywordflow">while</span> (t != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l04980"></a><span class="lineno"> 4980</span>&#160;    {</div><div class="line"><a name="l04981"></a><span class="lineno"> 4981</span>&#160;      tdes-&gt;<a class="code" href="structlog__tdes.html#ac9e24cb7fdff0af7ecdaed07174fb170">modified_class_list</a> = t-&gt;<a class="code" href="structmodified__class__entry.html#a25d46b6e46ce413b419562bfd54fe841">m_next</a>;</div><div class="line"><a name="l04982"></a><span class="lineno"> 4982</span>&#160;      <a class="code" href="leak__detector_8h.html#a9d4b5df3530d1bc733070a4669ba6ebc">free</a> ((<span class="keywordtype">char</span> *) t-&gt;<a class="code" href="structmodified__class__entry.html#aa2c44513a27ed926f4547a0ae65c9d31">m_classname</a>);</div><div class="line"><a name="l04983"></a><span class="lineno"> 4983</span>&#160;      <a class="code" href="leak__detector_8h.html#a9d4b5df3530d1bc733070a4669ba6ebc">free</a> (t);</div><div class="line"><a name="l04984"></a><span class="lineno"> 4984</span>&#160;      t = tdes-&gt;<a class="code" href="structlog__tdes.html#ac9e24cb7fdff0af7ecdaed07174fb170">modified_class_list</a>;</div><div class="line"><a name="l04985"></a><span class="lineno"> 4985</span>&#160;    }</div><div class="line"><a name="l04986"></a><span class="lineno"> 4986</span>&#160;    }</div><div class="line"><a name="l04987"></a><span class="lineno"> 4987</span>&#160;}</div><div class="line"><a name="l04988"></a><span class="lineno"> 4988</span>&#160;</div><div class="line"><a name="l04989"></a><span class="lineno"> 4989</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l04990"></a><span class="lineno"> 4990</span>&#160;<span class="comment"> * log_cleanup_modified_class_list -</span></div><div class="line"><a name="l04991"></a><span class="lineno"> 4991</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04992"></a><span class="lineno"> 4992</span>&#160;<span class="comment"> * return:</span></div><div class="line"><a name="l04993"></a><span class="lineno"> 4993</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04994"></a><span class="lineno"> 4994</span>&#160;<span class="comment"> *   tdes(in):</span></div><div class="line"><a name="l04995"></a><span class="lineno"> 4995</span>&#160;<span class="comment"> *   savept_lsa(in): savepoint lsa to rollback</span></div><div class="line"><a name="l04996"></a><span class="lineno"> 4996</span>&#160;<span class="comment"> *   bool(in): release the memory or not</span></div><div class="line"><a name="l04997"></a><span class="lineno"> 4997</span>&#160;<span class="comment"> *   decache_classrepr(in): decache the class representation or not</span></div><div class="line"><a name="l04998"></a><span class="lineno"> 4998</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l04999"></a><span class="lineno"> 4999</span>&#160;<span class="comment"> * NOTE: Function for LOG_TDES.modified_class_list</span></div><div class="line"><a name="l05000"></a><span class="lineno"> 5000</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l05001"></a><span class="lineno"> 5001</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div><div class="line"><a name="l05002"></a><span class="lineno"> 5002</span>&#160;log_cleanup_modified_class_list (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="structlog__tdes.html">LOG_TDES</a> * tdes, <a class="code" href="structlog__lsa.html">LOG_LSA</a> * savept_lsa, <span class="keywordtype">bool</span> release,</div><div class="line"><a name="l05003"></a><span class="lineno"> 5003</span>&#160;                 <span class="keywordtype">bool</span> decache_classrepr)</div><div class="line"><a name="l05004"></a><span class="lineno"> 5004</span>&#160;{</div><div class="line"><a name="l05005"></a><span class="lineno"> 5005</span>&#160;  (void) log_map_modified_class_list (thread_p, tdes, savept_lsa, release, log_cleanup_modified_class,</div><div class="line"><a name="l05006"></a><span class="lineno"> 5006</span>&#160;                      &amp;decache_classrepr);</div><div class="line"><a name="l05007"></a><span class="lineno"> 5007</span>&#160;}</div><div class="line"><a name="l05008"></a><span class="lineno"> 5008</span>&#160;</div><div class="line"><a name="l05009"></a><span class="lineno"> 5009</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l05010"></a><span class="lineno"> 5010</span>&#160;<span class="comment"> * log_rollback_classrepr_cache - Decache class repr to rollback</span></div><div class="line"><a name="l05011"></a><span class="lineno"> 5011</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l05012"></a><span class="lineno"> 5012</span>&#160;<span class="comment"> * return:</span></div><div class="line"><a name="l05013"></a><span class="lineno"> 5013</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l05014"></a><span class="lineno"> 5014</span>&#160;<span class="comment"> *   thread_p(in):</span></div><div class="line"><a name="l05015"></a><span class="lineno"> 5015</span>&#160;<span class="comment"> *   tdes(in): transaction description</span></div><div class="line"><a name="l05016"></a><span class="lineno"> 5016</span>&#160;<span class="comment"> *   upto_lsa(in): LSA to rollback</span></div><div class="line"><a name="l05017"></a><span class="lineno"> 5017</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l05018"></a><span class="lineno"> 5018</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l05019"></a><span class="lineno"> 5019</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div><div class="line"><a name="l05020"></a><span class="lineno"> 5020</span>&#160;log_rollback_classrepr_cache (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="structlog__tdes.html">LOG_TDES</a> * tdes, <a class="code" href="structlog__lsa.html">LOG_LSA</a> * upto_lsa)</div><div class="line"><a name="l05021"></a><span class="lineno"> 5021</span>&#160;{</div><div class="line"><a name="l05022"></a><span class="lineno"> 5022</span>&#160;  <a class="code" href="structmodified__class__entry.html">MODIFIED_CLASS_ENTRY</a> *t = <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l05023"></a><span class="lineno"> 5023</span>&#160;</div><div class="line"><a name="l05024"></a><span class="lineno"> 5024</span>&#160;  <span class="keywordflow">for</span> (t = tdes-&gt;<a class="code" href="structlog__tdes.html#ac9e24cb7fdff0af7ecdaed07174fb170">modified_class_list</a>; t != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>; t = t-&gt;<a class="code" href="structmodified__class__entry.html#a25d46b6e46ce413b419562bfd54fe841">m_next</a>)</div><div class="line"><a name="l05025"></a><span class="lineno"> 5025</span>&#160;    {</div><div class="line"><a name="l05026"></a><span class="lineno"> 5026</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="storage__common_8h.html#a467739272b1ee74686bae4be2354197a">LSA_GT</a> (&amp;t-&gt;<a class="code" href="structmodified__class__entry.html#a8e554ffc2197d19b7f0fdcaac385ea15">m_last_modified_lsa</a>, upto_lsa))</div><div class="line"><a name="l05027"></a><span class="lineno"> 5027</span>&#160;    {</div><div class="line"><a name="l05028"></a><span class="lineno"> 5028</span>&#160;      (void) <a class="code" href="heap__file_8c.html#a6adbab21addd8609c2d132eb1ed5e609">heap_classrepr_decache</a> (thread_p, &amp;t-&gt;<a class="code" href="structmodified__class__entry.html#ad721351a182c9e8df087382283d495c7">m_class_oid</a>);</div><div class="line"><a name="l05029"></a><span class="lineno"> 5029</span>&#160;      <a class="code" href="storage__common_8h.html#a6a4baec606189dd320678e8f412ca957">LSA_SET_NULL</a> (&amp;t-&gt;<a class="code" href="structmodified__class__entry.html#a8e554ffc2197d19b7f0fdcaac385ea15">m_last_modified_lsa</a>);</div><div class="line"><a name="l05030"></a><span class="lineno"> 5030</span>&#160;    }</div><div class="line"><a name="l05031"></a><span class="lineno"> 5031</span>&#160;    }</div><div class="line"><a name="l05032"></a><span class="lineno"> 5032</span>&#160;}</div><div class="line"><a name="l05033"></a><span class="lineno"> 5033</span>&#160;</div><div class="line"><a name="l05034"></a><span class="lineno"> 5034</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l05035"></a><span class="lineno"> 5035</span>&#160;<span class="comment"> * log_is_valid_locator -</span></div><div class="line"><a name="l05036"></a><span class="lineno"> 5036</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l05037"></a><span class="lineno"> 5037</span>&#160;<span class="comment"> * return: true if the locator is valid, false otherwise</span></div><div class="line"><a name="l05038"></a><span class="lineno"> 5038</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l05039"></a><span class="lineno"> 5039</span>&#160;<span class="comment"> *   locator(in):</span></div><div class="line"><a name="l05040"></a><span class="lineno"> 5040</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l05041"></a><span class="lineno"> 5041</span>&#160;<span class="comment"> * NOTE:</span></div><div class="line"><a name="l05042"></a><span class="lineno"> 5042</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l05043"></a><span class="lineno"> 5043</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span></div><div class="line"><a name="l05044"></a><span class="lineno"> 5044</span>&#160;log_is_valid_locator (<span class="keyword">const</span> <span class="keywordtype">char</span> *locator)</div><div class="line"><a name="l05045"></a><span class="lineno"> 5045</span>&#160;{</div><div class="line"><a name="l05046"></a><span class="lineno"> 5046</span>&#160;  <span class="keywordflow">if</span> (locator)</div><div class="line"><a name="l05047"></a><span class="lineno"> 5047</span>&#160;    {</div><div class="line"><a name="l05048"></a><span class="lineno"> 5048</span>&#160;      <span class="keywordtype">char</span> *key, *meta;</div><div class="line"><a name="l05049"></a><span class="lineno"> 5049</span>&#160;</div><div class="line"><a name="l05050"></a><span class="lineno"> 5050</span>&#160;      key = (<span class="keywordtype">char</span> *) <a class="code" href="log__manager_8c.html#a857d88396b8d4d3ee5880e3005eeb90d">LOCATOR_KEY</a> (locator);</div><div class="line"><a name="l05051"></a><span class="lineno"> 5051</span>&#160;      meta = (<span class="keywordtype">char</span> *) <a class="code" href="log__manager_8c.html#a2e83f32f5ca5ea01d8bc0077e489bca6">LOCATOR_META</a> (locator);</div><div class="line"><a name="l05052"></a><span class="lineno"> 5052</span>&#160;      <span class="keywordflow">if</span> (key &amp;&amp; meta &amp;&amp; (key &gt; meta))</div><div class="line"><a name="l05053"></a><span class="lineno"> 5053</span>&#160;    {</div><div class="line"><a name="l05054"></a><span class="lineno"> 5054</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l05055"></a><span class="lineno"> 5055</span>&#160;    }</div><div class="line"><a name="l05056"></a><span class="lineno"> 5056</span>&#160;    }</div><div class="line"><a name="l05057"></a><span class="lineno"> 5057</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l05058"></a><span class="lineno"> 5058</span>&#160;}</div><div class="line"><a name="l05059"></a><span class="lineno"> 5059</span>&#160;</div><div class="line"><a name="l05060"></a><span class="lineno"> 5060</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l05061"></a><span class="lineno"> 5061</span>&#160;<span class="comment"> * xlog_find_lob_locator -</span></div><div class="line"><a name="l05062"></a><span class="lineno"> 5062</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l05063"></a><span class="lineno"> 5063</span>&#160;<span class="comment"> * return: state of locator</span></div><div class="line"><a name="l05064"></a><span class="lineno"> 5064</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l05065"></a><span class="lineno"> 5065</span>&#160;<span class="comment"> *   thread_p(in):</span></div><div class="line"><a name="l05066"></a><span class="lineno"> 5066</span>&#160;<span class="comment"> *   locator(in):</span></div><div class="line"><a name="l05067"></a><span class="lineno"> 5067</span>&#160;<span class="comment"> *   real_loc_ptr(out):</span></div><div class="line"><a name="l05068"></a><span class="lineno"> 5068</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l05069"></a><span class="lineno"> 5069</span>&#160;<span class="comment"> * NOTE:</span></div><div class="line"><a name="l05070"></a><span class="lineno"> 5070</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l05071"></a><span class="lineno"> 5071</span>&#160;<a class="code" href="log__impl_8h.html#a860ddfff66bc38ab51576892904b975c">LOB_LOCATOR_STATE</a></div><div class="line"><a name="l05072"></a><span class="lineno"><a class="line" href="log__manager_8c.html#acfafced0123d02511d2ec4590684f89f"> 5072</a></span>&#160;<a class="code" href="log__manager_8c.html#acfafced0123d02511d2ec4590684f89f">xlog_find_lob_locator</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <span class="keyword">const</span> <span class="keywordtype">char</span> *locator, <span class="keywordtype">char</span> *real_locator)</div><div class="line"><a name="l05073"></a><span class="lineno"> 5073</span>&#160;{</div><div class="line"><a name="l05074"></a><span class="lineno"> 5074</span>&#160;  <span class="keywordtype">int</span> tran_index;</div><div class="line"><a name="l05075"></a><span class="lineno"> 5075</span>&#160;  <a class="code" href="structlog__tdes.html">LOG_TDES</a> *tdes;</div><div class="line"><a name="l05076"></a><span class="lineno"> 5076</span>&#160;</div><div class="line"><a name="l05077"></a><span class="lineno"> 5077</span>&#160;  <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (log_is_valid_locator (locator));</div><div class="line"><a name="l05078"></a><span class="lineno"> 5078</span>&#160;  <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (real_locator != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l05079"></a><span class="lineno"> 5079</span>&#160;</div><div class="line"><a name="l05080"></a><span class="lineno"> 5080</span>&#160;  tran_index = <a class="code" href="perf__monitor_8h.html#a55d27b01d605ba6ee2929ddfe8588320">LOG_FIND_THREAD_TRAN_INDEX</a> (thread_p);</div><div class="line"><a name="l05081"></a><span class="lineno"> 5081</span>&#160;  tdes = <a class="code" href="log__impl_8h.html#a08fee41cfcf592e8afdbc4988ffbc8e4">LOG_FIND_TDES</a> (tran_index);</div><div class="line"><a name="l05082"></a><span class="lineno"> 5082</span>&#160;</div><div class="line"><a name="l05083"></a><span class="lineno"> 5083</span>&#160;  <span class="keywordflow">if</span> (tdes != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l05084"></a><span class="lineno"> 5084</span>&#160;    {</div><div class="line"><a name="l05085"></a><span class="lineno"> 5085</span>&#160;      <a class="code" href="structlob__locator__entry.html">LOB_LOCATOR_ENTRY</a> *entry, find;</div><div class="line"><a name="l05086"></a><span class="lineno"> 5086</span>&#160;</div><div class="line"><a name="l05087"></a><span class="lineno"> 5087</span>&#160;      find.key = (<span class="keywordtype">char</span> *) <a class="code" href="log__manager_8c.html#a857d88396b8d4d3ee5880e3005eeb90d">LOCATOR_KEY</a> (locator);</div><div class="line"><a name="l05088"></a><span class="lineno"> 5088</span>&#160;      find.key_hash = (<a class="code" href="mprec_8c.html#a61569f2965b7a369eb10b6d75d410d11">int</a>) <a class="code" href="memory__hash_8c.html#ac22328249a11f6113491897b4cf4a08d">mht_5strhash</a> (find.key, INT_MAX);</div><div class="line"><a name="l05089"></a><span class="lineno"> 5089</span>&#160;      <span class="comment">/* Find entry from red-black tree (see base/rb_tree.h) */</span></div><div class="line"><a name="l05090"></a><span class="lineno"> 5090</span>&#160;      entry = <a class="code" href="src_2base_2rb__tree_8h.html#af0ae89dc9239fbe8c056eeed595cedac">RB_FIND</a> (lob_rb_root, &amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a034edbe7866ca98df7b9e54e1b5e3de2">lob_locator_root</a>, &amp;find);</div><div class="line"><a name="l05091"></a><span class="lineno"> 5091</span>&#160;      <span class="keywordflow">if</span> (entry != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l05092"></a><span class="lineno"> 5092</span>&#160;    {</div><div class="line"><a name="l05093"></a><span class="lineno"> 5093</span>&#160;      memcpy (real_locator, entry-&gt;top-&gt;locator, <a class="code" href="intl__support_8c.html#ab543901c3564a54b2450303d63374f55">strlen</a> (entry-&gt;top-&gt;locator) + 1);</div><div class="line"><a name="l05094"></a><span class="lineno"> 5094</span>&#160;      <span class="keywordflow">return</span> entry-&gt;top-&gt;state;</div><div class="line"><a name="l05095"></a><span class="lineno"> 5095</span>&#160;    }</div><div class="line"><a name="l05096"></a><span class="lineno"> 5096</span>&#160;    }</div><div class="line"><a name="l05097"></a><span class="lineno"> 5097</span>&#160;</div><div class="line"><a name="l05098"></a><span class="lineno"> 5098</span>&#160;  memcpy (real_locator, locator, <a class="code" href="intl__support_8c.html#ab543901c3564a54b2450303d63374f55">strlen</a> (locator) + 1);</div><div class="line"><a name="l05099"></a><span class="lineno"> 5099</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="log__impl_8h.html#a40a91713414be68a8000f379f883ad06aa0fe8afc3a13afb48be4dcd5d704655a">LOB_NOT_FOUND</a>;</div><div class="line"><a name="l05100"></a><span class="lineno"> 5100</span>&#160;}</div><div class="line"><a name="l05101"></a><span class="lineno"> 5101</span>&#160;</div><div class="line"><a name="l05102"></a><span class="lineno"> 5102</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l05103"></a><span class="lineno"> 5103</span>&#160;<span class="comment"> * xlog_add_lob_locator -</span></div><div class="line"><a name="l05104"></a><span class="lineno"> 5104</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l05105"></a><span class="lineno"> 5105</span>&#160;<span class="comment"> * return: error code</span></div><div class="line"><a name="l05106"></a><span class="lineno"> 5106</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l05107"></a><span class="lineno"> 5107</span>&#160;<span class="comment"> *   thread_p(in):</span></div><div class="line"><a name="l05108"></a><span class="lineno"> 5108</span>&#160;<span class="comment"> *   locator(in):</span></div><div class="line"><a name="l05109"></a><span class="lineno"> 5109</span>&#160;<span class="comment"> *   state(in):</span></div><div class="line"><a name="l05110"></a><span class="lineno"> 5110</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l05111"></a><span class="lineno"> 5111</span>&#160;<span class="comment"> * NOTE:</span></div><div class="line"><a name="l05112"></a><span class="lineno"> 5112</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l05113"></a><span class="lineno"> 5113</span>&#160;<span class="keywordtype">int</span></div><div class="line"><a name="l05114"></a><span class="lineno"><a class="line" href="log__manager_8c.html#a0bff5e1b57f5aa9e8dceb0b5e34ca1e2"> 5114</a></span>&#160;<a class="code" href="log__manager_8c.html#a0bff5e1b57f5aa9e8dceb0b5e34ca1e2">xlog_add_lob_locator</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <span class="keyword">const</span> <span class="keywordtype">char</span> *locator, <a class="code" href="log__impl_8h.html#a860ddfff66bc38ab51576892904b975c">LOB_LOCATOR_STATE</a> state)</div><div class="line"><a name="l05115"></a><span class="lineno"> 5115</span>&#160;{</div><div class="line"><a name="l05116"></a><span class="lineno"> 5116</span>&#160;  <span class="keywordtype">int</span> tran_index;</div><div class="line"><a name="l05117"></a><span class="lineno"> 5117</span>&#160;  <a class="code" href="structlog__tdes.html">LOG_TDES</a> *tdes;</div><div class="line"><a name="l05118"></a><span class="lineno"> 5118</span>&#160;  <a class="code" href="structlob__locator__entry.html">LOB_LOCATOR_ENTRY</a> *entry;</div><div class="line"><a name="l05119"></a><span class="lineno"> 5119</span>&#160;  <a class="code" href="structlob__savepoint__entry.html">LOB_SAVEPOINT_ENTRY</a> *savept;</div><div class="line"><a name="l05120"></a><span class="lineno"> 5120</span>&#160;  <span class="keywordtype">char</span> *key;</div><div class="line"><a name="l05121"></a><span class="lineno"> 5121</span>&#160;  <span class="keywordtype">size_t</span> key_len;</div><div class="line"><a name="l05122"></a><span class="lineno"> 5122</span>&#160;</div><div class="line"><a name="l05123"></a><span class="lineno"> 5123</span>&#160;  <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (log_is_valid_locator (locator));</div><div class="line"><a name="l05124"></a><span class="lineno"> 5124</span>&#160;</div><div class="line"><a name="l05125"></a><span class="lineno"> 5125</span>&#160;  tran_index = <a class="code" href="perf__monitor_8h.html#a55d27b01d605ba6ee2929ddfe8588320">LOG_FIND_THREAD_TRAN_INDEX</a> (thread_p);</div><div class="line"><a name="l05126"></a><span class="lineno"> 5126</span>&#160;  tdes = <a class="code" href="log__impl_8h.html#a08fee41cfcf592e8afdbc4988ffbc8e4">LOG_FIND_TDES</a> (tran_index);</div><div class="line"><a name="l05127"></a><span class="lineno"> 5127</span>&#160;  <span class="keywordflow">if</span> (tdes == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l05128"></a><span class="lineno"> 5128</span>&#160;    {</div><div class="line"><a name="l05129"></a><span class="lineno"> 5129</span>&#160;      <a class="code" href="error__manager_8c.html#afdaf87ce30f2f557802a185ab85b6599">er_set</a> (<a class="code" href="error__manager_8h.html#a5d0d456c474e11fc70779873a30a7432a3314630dd19f90a68274cf737092c9f2">ER_FATAL_ERROR_SEVERITY</a>, <a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <a class="code" href="error__code_8h.html#a4b8e41e78be77c579a2c58f5248fefe2">ER_LOG_UNKNOWN_TRANINDEX</a>, 1, tran_index);</div><div class="line"><a name="l05130"></a><span class="lineno"> 5130</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="error__code_8h.html#a4b8e41e78be77c579a2c58f5248fefe2">ER_LOG_UNKNOWN_TRANINDEX</a>;</div><div class="line"><a name="l05131"></a><span class="lineno"> 5131</span>&#160;    }</div><div class="line"><a name="l05132"></a><span class="lineno"> 5132</span>&#160;</div><div class="line"><a name="l05133"></a><span class="lineno"> 5133</span>&#160;  key = (<span class="keywordtype">char</span> *) <a class="code" href="log__manager_8c.html#a857d88396b8d4d3ee5880e3005eeb90d">LOCATOR_KEY</a> (locator);</div><div class="line"><a name="l05134"></a><span class="lineno"> 5134</span>&#160;  key_len = <a class="code" href="intl__support_8c.html#ab543901c3564a54b2450303d63374f55">strlen</a> (key);</div><div class="line"><a name="l05135"></a><span class="lineno"> 5135</span>&#160;</div><div class="line"><a name="l05136"></a><span class="lineno"> 5136</span>&#160;  entry = (<a class="code" href="structlob__locator__entry.html">LOB_LOCATOR_ENTRY</a> *) <a class="code" href="leak__detector_8h.html#a99aa8fd9f4831e1b0fa9e1cdcde3e249">malloc</a> (<span class="keyword">sizeof</span> (<a class="code" href="structlob__locator__entry.html">LOB_LOCATOR_ENTRY</a>) + key_len);</div><div class="line"><a name="l05137"></a><span class="lineno"> 5137</span>&#160;  <span class="keywordflow">if</span> (entry == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l05138"></a><span class="lineno"> 5138</span>&#160;    {</div><div class="line"><a name="l05139"></a><span class="lineno"> 5139</span>&#160;      <a class="code" href="error__manager_8c.html#afdaf87ce30f2f557802a185ab85b6599">er_set</a> (<a class="code" href="error__manager_8h.html#a5d0d456c474e11fc70779873a30a7432a07ad8f9fda27124d297c94b7d3ea44e8">ER_ERROR_SEVERITY</a>, <a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <a class="code" href="error__code_8h.html#a1f7116a1f1981bc7ef25fc6078518692">ER_OUT_OF_VIRTUAL_MEMORY</a>, 1, <span class="keyword">sizeof</span> (<a class="code" href="structlob__locator__entry.html">LOB_LOCATOR_ENTRY</a>) + key_len);</div><div class="line"><a name="l05140"></a><span class="lineno"> 5140</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="error__code_8h.html#a1f7116a1f1981bc7ef25fc6078518692">ER_OUT_OF_VIRTUAL_MEMORY</a>;</div><div class="line"><a name="l05141"></a><span class="lineno"> 5141</span>&#160;    }</div><div class="line"><a name="l05142"></a><span class="lineno"> 5142</span>&#160;</div><div class="line"><a name="l05143"></a><span class="lineno"> 5143</span>&#160;  savept = (<a class="code" href="structlob__savepoint__entry.html">LOB_SAVEPOINT_ENTRY</a> *) <a class="code" href="leak__detector_8h.html#a99aa8fd9f4831e1b0fa9e1cdcde3e249">malloc</a> (<span class="keyword">sizeof</span> (<a class="code" href="structlob__savepoint__entry.html">LOB_SAVEPOINT_ENTRY</a>));</div><div class="line"><a name="l05144"></a><span class="lineno"> 5144</span>&#160;  <span class="keywordflow">if</span> (savept == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l05145"></a><span class="lineno"> 5145</span>&#160;    {</div><div class="line"><a name="l05146"></a><span class="lineno"> 5146</span>&#160;      <a class="code" href="memory__alloc_8h.html#a794b5a73adc277837a0c4d12da4af5af">free_and_init</a> (entry);</div><div class="line"><a name="l05147"></a><span class="lineno"> 5147</span>&#160;      <a class="code" href="error__manager_8c.html#afdaf87ce30f2f557802a185ab85b6599">er_set</a> (<a class="code" href="error__manager_8h.html#a5d0d456c474e11fc70779873a30a7432a07ad8f9fda27124d297c94b7d3ea44e8">ER_ERROR_SEVERITY</a>, <a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <a class="code" href="error__code_8h.html#a1f7116a1f1981bc7ef25fc6078518692">ER_OUT_OF_VIRTUAL_MEMORY</a>, 1, <span class="keyword">sizeof</span> (<a class="code" href="structlob__savepoint__entry.html">LOB_SAVEPOINT_ENTRY</a>));</div><div class="line"><a name="l05148"></a><span class="lineno"> 5148</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="error__code_8h.html#a1f7116a1f1981bc7ef25fc6078518692">ER_OUT_OF_VIRTUAL_MEMORY</a>;</div><div class="line"><a name="l05149"></a><span class="lineno"> 5149</span>&#160;    }</div><div class="line"><a name="l05150"></a><span class="lineno"> 5150</span>&#160;</div><div class="line"><a name="l05151"></a><span class="lineno"> 5151</span>&#160;  entry-&gt;top = savept;</div><div class="line"><a name="l05152"></a><span class="lineno"> 5152</span>&#160;  entry-&gt;key = &amp;entry-&gt;key_data[0];</div><div class="line"><a name="l05153"></a><span class="lineno"> 5153</span>&#160;  memcpy (entry-&gt;key_data, key, key_len + 1);</div><div class="line"><a name="l05154"></a><span class="lineno"> 5154</span>&#160;  entry-&gt;key_hash = (<a class="code" href="mprec_8c.html#a61569f2965b7a369eb10b6d75d410d11">int</a>) <a class="code" href="memory__hash_8c.html#ac22328249a11f6113491897b4cf4a08d">mht_5strhash</a> (entry-&gt;key, INT_MAX);</div><div class="line"><a name="l05155"></a><span class="lineno"> 5155</span>&#160;</div><div class="line"><a name="l05156"></a><span class="lineno"> 5156</span>&#160;  savept-&gt;<a class="code" href="structlob__savepoint__entry.html#aa8e71ec03245bca07f9b9734738b4149">state</a> = state;</div><div class="line"><a name="l05157"></a><span class="lineno"> 5157</span>&#160;  savept-&gt;<a class="code" href="structlob__savepoint__entry.html#a8be0cf46b6d7ca084114befa450fcd4a">savept_lsa</a> = <a class="code" href="storage__common_8h.html#a478797f01d6a6ad24c0203c09a639db2">LSA_LT</a> (&amp;tdes-&gt;<a class="code" href="structlog__tdes.html#ac2dac7e98c4049c6787fccd7faf3d92a">savept_lsa</a>, &amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a27e8d1fddf3a2b68196b2c02a5318a21">topop_lsa</a>) ? tdes-&gt;<a class="code" href="structlog__tdes.html#a27e8d1fddf3a2b68196b2c02a5318a21">topop_lsa</a> : tdes-&gt;<a class="code" href="structlog__tdes.html#ac2dac7e98c4049c6787fccd7faf3d92a">savept_lsa</a>;</div><div class="line"><a name="l05158"></a><span class="lineno"> 5158</span>&#160;  savept-&gt;<a class="code" href="structlob__savepoint__entry.html#a3d018fd9135834945409660addac0520">prev</a> = <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l05159"></a><span class="lineno"> 5159</span>&#160;  <a class="code" href="porting_8c.html#aeb79f86261de904967d433c1b5e9a1de">strlcpy</a> (savept-&gt;<a class="code" href="structlob__savepoint__entry.html#af8cc29daa202c0ddba6cbec4cf30882a">locator</a>, locator, sizeof (<a class="code" href="es_8h.html#abc5f1830c52f82388529df13a21535aa">ES_URI</a>));</div><div class="line"><a name="l05160"></a><span class="lineno"> 5160</span>&#160;</div><div class="line"><a name="l05161"></a><span class="lineno"> 5161</span>&#160;  <span class="comment">/* Insert entry to the red-black tree (see base/rb_tree.h) */</span></div><div class="line"><a name="l05162"></a><span class="lineno"> 5162</span>&#160;  <a class="code" href="src_2base_2rb__tree_8h.html#a5b9861a8925c953340e483ae0a0f5120">RB_INSERT</a> (lob_rb_root, &amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a034edbe7866ca98df7b9e54e1b5e3de2">lob_locator_root</a>, entry);</div><div class="line"><a name="l05163"></a><span class="lineno"> 5163</span>&#160;</div><div class="line"><a name="l05164"></a><span class="lineno"> 5164</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>;</div><div class="line"><a name="l05165"></a><span class="lineno"> 5165</span>&#160;}</div><div class="line"><a name="l05166"></a><span class="lineno"> 5166</span>&#160;</div><div class="line"><a name="l05167"></a><span class="lineno"> 5167</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l05168"></a><span class="lineno"> 5168</span>&#160;<span class="comment"> * xlog_change_state_of_locator</span></div><div class="line"><a name="l05169"></a><span class="lineno"> 5169</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l05170"></a><span class="lineno"> 5170</span>&#160;<span class="comment"> * return: error code</span></div><div class="line"><a name="l05171"></a><span class="lineno"> 5171</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l05172"></a><span class="lineno"> 5172</span>&#160;<span class="comment"> *   thread_p(in):</span></div><div class="line"><a name="l05173"></a><span class="lineno"> 5173</span>&#160;<span class="comment"> *   locator(in):</span></div><div class="line"><a name="l05174"></a><span class="lineno"> 5174</span>&#160;<span class="comment"> *   new_locator(in):</span></div><div class="line"><a name="l05175"></a><span class="lineno"> 5175</span>&#160;<span class="comment"> *   state(in):</span></div><div class="line"><a name="l05176"></a><span class="lineno"> 5176</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l05177"></a><span class="lineno"> 5177</span>&#160;<span class="comment"> * NOTE:</span></div><div class="line"><a name="l05178"></a><span class="lineno"> 5178</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l05179"></a><span class="lineno"> 5179</span>&#160;<span class="keywordtype">int</span></div><div class="line"><a name="l05180"></a><span class="lineno"><a class="line" href="log__manager_8c.html#a0731525f63330e65340e1b0b61c0c158"> 5180</a></span>&#160;<a class="code" href="log__manager_8c.html#a0731525f63330e65340e1b0b61c0c158">xlog_change_state_of_locator</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <span class="keyword">const</span> <span class="keywordtype">char</span> *locator, <span class="keyword">const</span> <span class="keywordtype">char</span> *new_locator,</div><div class="line"><a name="l05181"></a><span class="lineno"> 5181</span>&#160;                  <a class="code" href="log__impl_8h.html#a860ddfff66bc38ab51576892904b975c">LOB_LOCATOR_STATE</a> state)</div><div class="line"><a name="l05182"></a><span class="lineno"> 5182</span>&#160;{</div><div class="line"><a name="l05183"></a><span class="lineno"> 5183</span>&#160;  <span class="keywordtype">int</span> tran_index;</div><div class="line"><a name="l05184"></a><span class="lineno"> 5184</span>&#160;  <a class="code" href="structlog__tdes.html">LOG_TDES</a> *tdes;</div><div class="line"><a name="l05185"></a><span class="lineno"> 5185</span>&#160;  <a class="code" href="structlob__locator__entry.html">LOB_LOCATOR_ENTRY</a> *entry, find;</div><div class="line"><a name="l05186"></a><span class="lineno"> 5186</span>&#160;</div><div class="line"><a name="l05187"></a><span class="lineno"> 5187</span>&#160;  <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (log_is_valid_locator (locator));</div><div class="line"><a name="l05188"></a><span class="lineno"> 5188</span>&#160;</div><div class="line"><a name="l05189"></a><span class="lineno"> 5189</span>&#160;  tran_index = <a class="code" href="perf__monitor_8h.html#a55d27b01d605ba6ee2929ddfe8588320">LOG_FIND_THREAD_TRAN_INDEX</a> (thread_p);</div><div class="line"><a name="l05190"></a><span class="lineno"> 5190</span>&#160;  tdes = <a class="code" href="log__impl_8h.html#a08fee41cfcf592e8afdbc4988ffbc8e4">LOG_FIND_TDES</a> (tran_index);</div><div class="line"><a name="l05191"></a><span class="lineno"> 5191</span>&#160;  <span class="keywordflow">if</span> (tdes == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l05192"></a><span class="lineno"> 5192</span>&#160;    {</div><div class="line"><a name="l05193"></a><span class="lineno"> 5193</span>&#160;      <a class="code" href="error__manager_8c.html#afdaf87ce30f2f557802a185ab85b6599">er_set</a> (<a class="code" href="error__manager_8h.html#a5d0d456c474e11fc70779873a30a7432a3314630dd19f90a68274cf737092c9f2">ER_FATAL_ERROR_SEVERITY</a>, <a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <a class="code" href="error__code_8h.html#a4b8e41e78be77c579a2c58f5248fefe2">ER_LOG_UNKNOWN_TRANINDEX</a>, 1, tran_index);</div><div class="line"><a name="l05194"></a><span class="lineno"> 5194</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="error__code_8h.html#a4b8e41e78be77c579a2c58f5248fefe2">ER_LOG_UNKNOWN_TRANINDEX</a>;</div><div class="line"><a name="l05195"></a><span class="lineno"> 5195</span>&#160;    }</div><div class="line"><a name="l05196"></a><span class="lineno"> 5196</span>&#160;</div><div class="line"><a name="l05197"></a><span class="lineno"> 5197</span>&#160;  find.key = (<span class="keywordtype">char</span> *) <a class="code" href="log__manager_8c.html#a857d88396b8d4d3ee5880e3005eeb90d">LOCATOR_KEY</a> (locator);</div><div class="line"><a name="l05198"></a><span class="lineno"> 5198</span>&#160;  find.key_hash = (<a class="code" href="mprec_8c.html#a61569f2965b7a369eb10b6d75d410d11">int</a>) <a class="code" href="memory__hash_8c.html#ac22328249a11f6113491897b4cf4a08d">mht_5strhash</a> (find.key, INT_MAX);</div><div class="line"><a name="l05199"></a><span class="lineno"> 5199</span>&#160;  entry = <a class="code" href="src_2base_2rb__tree_8h.html#af0ae89dc9239fbe8c056eeed595cedac">RB_FIND</a> (lob_rb_root, &amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a034edbe7866ca98df7b9e54e1b5e3de2">lob_locator_root</a>, &amp;find);</div><div class="line"><a name="l05200"></a><span class="lineno"> 5200</span>&#160;</div><div class="line"><a name="l05201"></a><span class="lineno"> 5201</span>&#160;  <span class="keywordflow">if</span> (entry != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l05202"></a><span class="lineno"> 5202</span>&#160;    {</div><div class="line"><a name="l05203"></a><span class="lineno"> 5203</span>&#160;      <a class="code" href="structlog__lsa.html">LOG_LSA</a> last_lsa;</div><div class="line"><a name="l05204"></a><span class="lineno"> 5204</span>&#160;</div><div class="line"><a name="l05205"></a><span class="lineno"> 5205</span>&#160;      last_lsa = <a class="code" href="storage__common_8h.html#aa90a06bd1f1a9925ac8ef0f856d1d872">LSA_GE</a> (&amp;tdes-&gt;<a class="code" href="structlog__tdes.html#ac2dac7e98c4049c6787fccd7faf3d92a">savept_lsa</a>, &amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a27e8d1fddf3a2b68196b2c02a5318a21">topop_lsa</a>) ? tdes-&gt;<a class="code" href="structlog__tdes.html#ac2dac7e98c4049c6787fccd7faf3d92a">savept_lsa</a> : tdes-&gt;<a class="code" href="structlog__tdes.html#a27e8d1fddf3a2b68196b2c02a5318a21">topop_lsa</a>;</div><div class="line"><a name="l05206"></a><span class="lineno"> 5206</span>&#160;</div><div class="line"><a name="l05207"></a><span class="lineno"> 5207</span>&#160;      <span class="comment">/* if it is created prior to current savepoint, push the previous state in the savepoint list */</span></div><div class="line"><a name="l05208"></a><span class="lineno"> 5208</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="storage__common_8h.html#a478797f01d6a6ad24c0203c09a639db2">LSA_LT</a> (&amp;entry-&gt;top-&gt;savept_lsa, &amp;last_lsa))</div><div class="line"><a name="l05209"></a><span class="lineno"> 5209</span>&#160;    {</div><div class="line"><a name="l05210"></a><span class="lineno"> 5210</span>&#160;      <a class="code" href="structlob__savepoint__entry.html">LOB_SAVEPOINT_ENTRY</a> *savept;</div><div class="line"><a name="l05211"></a><span class="lineno"> 5211</span>&#160;</div><div class="line"><a name="l05212"></a><span class="lineno"> 5212</span>&#160;      savept = (<a class="code" href="structlob__savepoint__entry.html">LOB_SAVEPOINT_ENTRY</a> *) <a class="code" href="leak__detector_8h.html#a99aa8fd9f4831e1b0fa9e1cdcde3e249">malloc</a> (<span class="keyword">sizeof</span> (<a class="code" href="structlob__savepoint__entry.html">LOB_SAVEPOINT_ENTRY</a>));</div><div class="line"><a name="l05213"></a><span class="lineno"> 5213</span>&#160;      <span class="keywordflow">if</span> (savept == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l05214"></a><span class="lineno"> 5214</span>&#160;        {</div><div class="line"><a name="l05215"></a><span class="lineno"> 5215</span>&#160;          <a class="code" href="error__manager_8c.html#afdaf87ce30f2f557802a185ab85b6599">er_set</a> (<a class="code" href="error__manager_8h.html#a5d0d456c474e11fc70779873a30a7432a07ad8f9fda27124d297c94b7d3ea44e8">ER_ERROR_SEVERITY</a>, <a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <a class="code" href="error__code_8h.html#a1f7116a1f1981bc7ef25fc6078518692">ER_OUT_OF_VIRTUAL_MEMORY</a>, 1, <span class="keyword">sizeof</span> (<a class="code" href="structlob__savepoint__entry.html">LOB_SAVEPOINT_ENTRY</a>));</div><div class="line"><a name="l05216"></a><span class="lineno"> 5216</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="error__code_8h.html#a1f7116a1f1981bc7ef25fc6078518692">ER_OUT_OF_VIRTUAL_MEMORY</a>;</div><div class="line"><a name="l05217"></a><span class="lineno"> 5217</span>&#160;        }</div><div class="line"><a name="l05218"></a><span class="lineno"> 5218</span>&#160;</div><div class="line"><a name="l05219"></a><span class="lineno"> 5219</span>&#160;      <span class="comment">/* copy structure (avoid reduncant memory copy) */</span></div><div class="line"><a name="l05220"></a><span class="lineno"> 5220</span>&#160;      savept-&gt;<a class="code" href="structlob__savepoint__entry.html#aa8e71ec03245bca07f9b9734738b4149">state</a> = entry-&gt;top-&gt;state;</div><div class="line"><a name="l05221"></a><span class="lineno"> 5221</span>&#160;      savept-&gt;<a class="code" href="structlob__savepoint__entry.html#a8be0cf46b6d7ca084114befa450fcd4a">savept_lsa</a> = entry-&gt;top-&gt;savept_lsa;</div><div class="line"><a name="l05222"></a><span class="lineno"> 5222</span>&#160;      memcpy (savept-&gt;<a class="code" href="structlob__savepoint__entry.html#af8cc29daa202c0ddba6cbec4cf30882a">locator</a>, entry-&gt;top-&gt;locator, <a class="code" href="intl__support_8c.html#ab543901c3564a54b2450303d63374f55">strlen</a> (entry-&gt;top-&gt;locator) + 1);</div><div class="line"><a name="l05223"></a><span class="lineno"> 5223</span>&#160;      savept-&gt;<a class="code" href="structlob__savepoint__entry.html#a3d018fd9135834945409660addac0520">prev</a> = entry-&gt;top;</div><div class="line"><a name="l05224"></a><span class="lineno"> 5224</span>&#160;      entry-&gt;top = savept;</div><div class="line"><a name="l05225"></a><span class="lineno"> 5225</span>&#160;    }</div><div class="line"><a name="l05226"></a><span class="lineno"> 5226</span>&#160;</div><div class="line"><a name="l05227"></a><span class="lineno"> 5227</span>&#160;      <span class="comment">/* set the current state */</span></div><div class="line"><a name="l05228"></a><span class="lineno"> 5228</span>&#160;      <span class="keywordflow">if</span> (new_locator != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l05229"></a><span class="lineno"> 5229</span>&#160;    {</div><div class="line"><a name="l05230"></a><span class="lineno"> 5230</span>&#160;      <a class="code" href="porting_8c.html#aeb79f86261de904967d433c1b5e9a1de">strlcpy</a> (entry-&gt;top-&gt;locator, new_locator, sizeof (<a class="code" href="es_8h.html#abc5f1830c52f82388529df13a21535aa">ES_URI</a>));</div><div class="line"><a name="l05231"></a><span class="lineno"> 5231</span>&#160;    }</div><div class="line"><a name="l05232"></a><span class="lineno"> 5232</span>&#160;      entry-&gt;top-&gt;state = state;</div><div class="line"><a name="l05233"></a><span class="lineno"> 5233</span>&#160;      entry-&gt;top-&gt;savept_lsa = last_lsa;</div><div class="line"><a name="l05234"></a><span class="lineno"> 5234</span>&#160;    }</div><div class="line"><a name="l05235"></a><span class="lineno"> 5235</span>&#160;</div><div class="line"><a name="l05236"></a><span class="lineno"> 5236</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>;</div><div class="line"><a name="l05237"></a><span class="lineno"> 5237</span>&#160;}</div><div class="line"><a name="l05238"></a><span class="lineno"> 5238</span>&#160;</div><div class="line"><a name="l05239"></a><span class="lineno"> 5239</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l05240"></a><span class="lineno"> 5240</span>&#160;<span class="comment"> * xlog_drop_lob_locator -</span></div><div class="line"><a name="l05241"></a><span class="lineno"> 5241</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l05242"></a><span class="lineno"> 5242</span>&#160;<span class="comment"> * return: error code</span></div><div class="line"><a name="l05243"></a><span class="lineno"> 5243</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l05244"></a><span class="lineno"> 5244</span>&#160;<span class="comment"> *   thread_p(in):</span></div><div class="line"><a name="l05245"></a><span class="lineno"> 5245</span>&#160;<span class="comment"> *   locator(in):</span></div><div class="line"><a name="l05246"></a><span class="lineno"> 5246</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l05247"></a><span class="lineno"> 5247</span>&#160;<span class="comment"> * NOTE:</span></div><div class="line"><a name="l05248"></a><span class="lineno"> 5248</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l05249"></a><span class="lineno"> 5249</span>&#160;<span class="keywordtype">int</span></div><div class="line"><a name="l05250"></a><span class="lineno"><a class="line" href="log__manager_8c.html#a7a434244945b53f5459db505d15068fe"> 5250</a></span>&#160;<a class="code" href="log__manager_8c.html#a7a434244945b53f5459db505d15068fe">xlog_drop_lob_locator</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <span class="keyword">const</span> <span class="keywordtype">char</span> *locator)</div><div class="line"><a name="l05251"></a><span class="lineno"> 5251</span>&#160;{</div><div class="line"><a name="l05252"></a><span class="lineno"> 5252</span>&#160;  <span class="keywordtype">int</span> tran_index;</div><div class="line"><a name="l05253"></a><span class="lineno"> 5253</span>&#160;  <a class="code" href="structlog__tdes.html">LOG_TDES</a> *tdes;</div><div class="line"><a name="l05254"></a><span class="lineno"> 5254</span>&#160;  <a class="code" href="structlob__locator__entry.html">LOB_LOCATOR_ENTRY</a> *entry, find;</div><div class="line"><a name="l05255"></a><span class="lineno"> 5255</span>&#160;</div><div class="line"><a name="l05256"></a><span class="lineno"> 5256</span>&#160;  <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (log_is_valid_locator (locator));</div><div class="line"><a name="l05257"></a><span class="lineno"> 5257</span>&#160;</div><div class="line"><a name="l05258"></a><span class="lineno"> 5258</span>&#160;  tran_index = <a class="code" href="perf__monitor_8h.html#a55d27b01d605ba6ee2929ddfe8588320">LOG_FIND_THREAD_TRAN_INDEX</a> (thread_p);</div><div class="line"><a name="l05259"></a><span class="lineno"> 5259</span>&#160;  tdes = <a class="code" href="log__impl_8h.html#a08fee41cfcf592e8afdbc4988ffbc8e4">LOG_FIND_TDES</a> (tran_index);</div><div class="line"><a name="l05260"></a><span class="lineno"> 5260</span>&#160;  <span class="keywordflow">if</span> (tdes == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l05261"></a><span class="lineno"> 5261</span>&#160;    {</div><div class="line"><a name="l05262"></a><span class="lineno"> 5262</span>&#160;      <a class="code" href="error__manager_8c.html#afdaf87ce30f2f557802a185ab85b6599">er_set</a> (<a class="code" href="error__manager_8h.html#a5d0d456c474e11fc70779873a30a7432a3314630dd19f90a68274cf737092c9f2">ER_FATAL_ERROR_SEVERITY</a>, <a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <a class="code" href="error__code_8h.html#a4b8e41e78be77c579a2c58f5248fefe2">ER_LOG_UNKNOWN_TRANINDEX</a>, 1, tran_index);</div><div class="line"><a name="l05263"></a><span class="lineno"> 5263</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="error__code_8h.html#a4b8e41e78be77c579a2c58f5248fefe2">ER_LOG_UNKNOWN_TRANINDEX</a>;</div><div class="line"><a name="l05264"></a><span class="lineno"> 5264</span>&#160;    }</div><div class="line"><a name="l05265"></a><span class="lineno"> 5265</span>&#160;</div><div class="line"><a name="l05266"></a><span class="lineno"> 5266</span>&#160;  find.key = (<span class="keywordtype">char</span> *) <a class="code" href="log__manager_8c.html#a857d88396b8d4d3ee5880e3005eeb90d">LOCATOR_KEY</a> (locator);</div><div class="line"><a name="l05267"></a><span class="lineno"> 5267</span>&#160;  find.key_hash = (<a class="code" href="mprec_8c.html#a61569f2965b7a369eb10b6d75d410d11">int</a>) <a class="code" href="memory__hash_8c.html#ac22328249a11f6113491897b4cf4a08d">mht_5strhash</a> (find.key, INT_MAX);</div><div class="line"><a name="l05268"></a><span class="lineno"> 5268</span>&#160;  <span class="comment">/* Remove entry that matches &#39;find&#39; entry from the red-black tree. see base/rb_tree.h for more information */</span></div><div class="line"><a name="l05269"></a><span class="lineno"> 5269</span>&#160;  entry = <a class="code" href="src_2base_2rb__tree_8h.html#af0ae89dc9239fbe8c056eeed595cedac">RB_FIND</a> (lob_rb_root, &amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a034edbe7866ca98df7b9e54e1b5e3de2">lob_locator_root</a>, &amp;find);</div><div class="line"><a name="l05270"></a><span class="lineno"> 5270</span>&#160;  <span class="keywordflow">if</span> (entry != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l05271"></a><span class="lineno"> 5271</span>&#160;    {</div><div class="line"><a name="l05272"></a><span class="lineno"> 5272</span>&#160;      entry = <a class="code" href="src_2base_2rb__tree_8h.html#ad97eb44d2c39debda8cfbbbbcb354cce">RB_REMOVE</a> (lob_rb_root, &amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a034edbe7866ca98df7b9e54e1b5e3de2">lob_locator_root</a>, entry);</div><div class="line"><a name="l05273"></a><span class="lineno"> 5273</span>&#160;      <span class="keywordflow">if</span> (entry != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l05274"></a><span class="lineno"> 5274</span>&#160;    {</div><div class="line"><a name="l05275"></a><span class="lineno"> 5275</span>&#160;      log_free_lob_locator (entry);</div><div class="line"><a name="l05276"></a><span class="lineno"> 5276</span>&#160;    }</div><div class="line"><a name="l05277"></a><span class="lineno"> 5277</span>&#160;    }</div><div class="line"><a name="l05278"></a><span class="lineno"> 5278</span>&#160;</div><div class="line"><a name="l05279"></a><span class="lineno"> 5279</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>;</div><div class="line"><a name="l05280"></a><span class="lineno"> 5280</span>&#160;}</div><div class="line"><a name="l05281"></a><span class="lineno"> 5281</span>&#160;</div><div class="line"><a name="l05282"></a><span class="lineno"> 5282</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l05283"></a><span class="lineno"> 5283</span>&#160;<span class="comment"> * log_free_lob_locator -</span></div><div class="line"><a name="l05284"></a><span class="lineno"> 5284</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l05285"></a><span class="lineno"> 5285</span>&#160;<span class="comment"> * return: void</span></div><div class="line"><a name="l05286"></a><span class="lineno"> 5286</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l05287"></a><span class="lineno"> 5287</span>&#160;<span class="comment"> *   entry(in):</span></div><div class="line"><a name="l05288"></a><span class="lineno"> 5288</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l05289"></a><span class="lineno"> 5289</span>&#160;<span class="comment"> * NOTE:</span></div><div class="line"><a name="l05290"></a><span class="lineno"> 5290</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l05291"></a><span class="lineno"> 5291</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div><div class="line"><a name="l05292"></a><span class="lineno"> 5292</span>&#160;log_free_lob_locator (<a class="code" href="structlob__locator__entry.html">LOB_LOCATOR_ENTRY</a> * entry)</div><div class="line"><a name="l05293"></a><span class="lineno"> 5293</span>&#160;{</div><div class="line"><a name="l05294"></a><span class="lineno"> 5294</span>&#160;  <span class="keywordflow">while</span> (entry-&gt;top != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l05295"></a><span class="lineno"> 5295</span>&#160;    {</div><div class="line"><a name="l05296"></a><span class="lineno"> 5296</span>&#160;      <a class="code" href="structlob__savepoint__entry.html">LOB_SAVEPOINT_ENTRY</a> *savept;</div><div class="line"><a name="l05297"></a><span class="lineno"> 5297</span>&#160;</div><div class="line"><a name="l05298"></a><span class="lineno"> 5298</span>&#160;      savept = entry-&gt;top;</div><div class="line"><a name="l05299"></a><span class="lineno"> 5299</span>&#160;      entry-&gt;top = savept-&gt;<a class="code" href="structlob__savepoint__entry.html#a3d018fd9135834945409660addac0520">prev</a>;</div><div class="line"><a name="l05300"></a><span class="lineno"> 5300</span>&#160;      <a class="code" href="memory__alloc_8h.html#a794b5a73adc277837a0c4d12da4af5af">free_and_init</a> (savept);</div><div class="line"><a name="l05301"></a><span class="lineno"> 5301</span>&#160;    }</div><div class="line"><a name="l05302"></a><span class="lineno"> 5302</span>&#160;</div><div class="line"><a name="l05303"></a><span class="lineno"> 5303</span>&#160;  <a class="code" href="memory__alloc_8h.html#a794b5a73adc277837a0c4d12da4af5af">free_and_init</a> (entry);</div><div class="line"><a name="l05304"></a><span class="lineno"> 5304</span>&#160;}</div><div class="line"><a name="l05305"></a><span class="lineno"> 5305</span>&#160;</div><div class="line"><a name="l05306"></a><span class="lineno"> 5306</span>&#160;<span class="preprocessor">#if 0</span></div><div class="line"><a name="l05307"></a><span class="lineno"> 5307</span>&#160;<span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *</div><div class="line"><a name="l05308"></a><span class="lineno"> 5308</span>&#160;lob_state_to_string (<a class="code" href="log__impl_8h.html#a860ddfff66bc38ab51576892904b975c">LOB_LOCATOR_STATE</a> state)</div><div class="line"><a name="l05309"></a><span class="lineno"> 5309</span>&#160;{</div><div class="line"><a name="l05310"></a><span class="lineno"> 5310</span>&#160;  <span class="keywordflow">switch</span> (state)</div><div class="line"><a name="l05311"></a><span class="lineno"> 5311</span>&#160;    {</div><div class="line"><a name="l05312"></a><span class="lineno"> 5312</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#a40a91713414be68a8000f379f883ad06a284ad932872157db9e2055b6ec003e36">LOB_TRANSIENT_CREATED</a>:</div><div class="line"><a name="l05313"></a><span class="lineno"> 5313</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;LOB_TRANSIENT_CREATED&quot;</span>;</div><div class="line"><a name="l05314"></a><span class="lineno"> 5314</span>&#160;</div><div class="line"><a name="l05315"></a><span class="lineno"> 5315</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#a40a91713414be68a8000f379f883ad06aca23e3e0be0d810de2059773fdb641bb">LOB_TRANSIENT_DELETED</a>:</div><div class="line"><a name="l05316"></a><span class="lineno"> 5316</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;LOB_TRANSIENT_DELETED&quot;</span>;</div><div class="line"><a name="l05317"></a><span class="lineno"> 5317</span>&#160;</div><div class="line"><a name="l05318"></a><span class="lineno"> 5318</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#a40a91713414be68a8000f379f883ad06ae75408b47fb2d17f8a7337b033acd927">LOB_PERMANENT_CREATED</a>:</div><div class="line"><a name="l05319"></a><span class="lineno"> 5319</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;LOB_PERMANENT_CREATED&quot;</span>;</div><div class="line"><a name="l05320"></a><span class="lineno"> 5320</span>&#160;</div><div class="line"><a name="l05321"></a><span class="lineno"> 5321</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#a40a91713414be68a8000f379f883ad06a56092aa8f2fff2e94d2925351bf404c1">LOB_PERMANENT_DELETED</a>:</div><div class="line"><a name="l05322"></a><span class="lineno"> 5322</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;LOB_PERMANENT_DELETED&quot;</span>;</div><div class="line"><a name="l05323"></a><span class="lineno"> 5323</span>&#160;</div><div class="line"><a name="l05324"></a><span class="lineno"> 5324</span>&#160;    <span class="keywordflow">default</span>:</div><div class="line"><a name="l05325"></a><span class="lineno"> 5325</span>&#160;      <span class="keywordflow">return</span> <span class="stringliteral">&quot;LOB_UNKNOWN&quot;</span>;</div><div class="line"><a name="l05326"></a><span class="lineno"> 5326</span>&#160;    }</div><div class="line"><a name="l05327"></a><span class="lineno"> 5327</span>&#160;}</div><div class="line"><a name="l05328"></a><span class="lineno"> 5328</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l05329"></a><span class="lineno"> 5329</span>&#160;</div><div class="line"><a name="l05330"></a><span class="lineno"> 5330</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l05331"></a><span class="lineno"> 5331</span>&#160;<span class="comment"> * log_clear_lob_locator_list -</span></div><div class="line"><a name="l05332"></a><span class="lineno"> 5332</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l05333"></a><span class="lineno"> 5333</span>&#160;<span class="comment"> * return: void</span></div><div class="line"><a name="l05334"></a><span class="lineno"> 5334</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l05335"></a><span class="lineno"> 5335</span>&#160;<span class="comment"> *   thread_p(in):</span></div><div class="line"><a name="l05336"></a><span class="lineno"> 5336</span>&#160;<span class="comment"> *   tdes(in):</span></div><div class="line"><a name="l05337"></a><span class="lineno"> 5337</span>&#160;<span class="comment"> *   at_commit(in):</span></div><div class="line"><a name="l05338"></a><span class="lineno"> 5338</span>&#160;<span class="comment"> *   savept_lsa(in): savepoint lsa to rollback</span></div><div class="line"><a name="l05339"></a><span class="lineno"> 5339</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l05340"></a><span class="lineno"> 5340</span>&#160;<span class="comment"> * NOTE:</span></div><div class="line"><a name="l05341"></a><span class="lineno"> 5341</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l05342"></a><span class="lineno"> 5342</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l05343"></a><span class="lineno"><a class="line" href="log__manager_8c.html#ab66f5229e5ed16479f13659587baef54"> 5343</a></span>&#160;<a class="code" href="log__manager_8c.html#ab66f5229e5ed16479f13659587baef54">log_clear_lob_locator_list</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="structlog__tdes.html">LOG_TDES</a> * tdes, <span class="keywordtype">bool</span> at_commit, <a class="code" href="structlog__lsa.html">LOG_LSA</a> * savept_lsa)</div><div class="line"><a name="l05344"></a><span class="lineno"> 5344</span>&#160;{</div><div class="line"><a name="l05345"></a><span class="lineno"> 5345</span>&#160;  <a class="code" href="structlob__locator__entry.html">LOB_LOCATOR_ENTRY</a> *entry, *next;</div><div class="line"><a name="l05346"></a><span class="lineno"> 5346</span>&#160;  <span class="keywordtype">bool</span> need_to_delete;</div><div class="line"><a name="l05347"></a><span class="lineno"> 5347</span>&#160;</div><div class="line"><a name="l05348"></a><span class="lineno"> 5348</span>&#160;  <span class="keywordflow">if</span> (tdes == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l05349"></a><span class="lineno"> 5349</span>&#160;    {</div><div class="line"><a name="l05350"></a><span class="lineno"> 5350</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l05351"></a><span class="lineno"> 5351</span>&#160;    }</div><div class="line"><a name="l05352"></a><span class="lineno"> 5352</span>&#160;<span class="preprocessor">#if 0</span></div><div class="line"><a name="l05353"></a><span class="lineno"> 5353</span>&#160;  <a class="code" href="error__manager_8h.html#a075eb8873354909bbe8edafa0f18f58c">er_log_debug</a> (<a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <span class="stringliteral">&quot;log_clear_lob_locator_list&quot;</span>);</div><div class="line"><a name="l05354"></a><span class="lineno"> 5354</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l05355"></a><span class="lineno"> 5355</span>&#160;</div><div class="line"><a name="l05356"></a><span class="lineno"> 5356</span>&#160;  <span class="keywordflow">for</span> (entry = <a class="code" href="src_2base_2rb__tree_8h.html#a0827c86d4c8c63495f665141d857f380">RB_MIN</a> (lob_rb_root, &amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a034edbe7866ca98df7b9e54e1b5e3de2">lob_locator_root</a>); entry != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>; entry = next)</div><div class="line"><a name="l05357"></a><span class="lineno"> 5357</span>&#160;    {</div><div class="line"><a name="l05358"></a><span class="lineno"> 5358</span>&#160;<span class="preprocessor">#if 0</span></div><div class="line"><a name="l05359"></a><span class="lineno"> 5359</span>&#160;      <a class="code" href="error__manager_8h.html#a075eb8873354909bbe8edafa0f18f58c">er_log_debug</a> (<a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <span class="stringliteral">&quot;   locator=%s, state=%s\n, savept_lsa=(%d,%d)&quot;</span>, entry-&gt;key,</div><div class="line"><a name="l05360"></a><span class="lineno"> 5360</span>&#160;            lob_state_to_string (entry-&gt;top-&gt;state), entry-&gt;top-&gt;savept_lsa.pageid,</div><div class="line"><a name="l05361"></a><span class="lineno"> 5361</span>&#160;            entry-&gt;top-&gt;savept_lsa.offset);</div><div class="line"><a name="l05362"></a><span class="lineno"> 5362</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l05363"></a><span class="lineno"> 5363</span>&#160;      <span class="comment">/* setup next link before destroy */</span></div><div class="line"><a name="l05364"></a><span class="lineno"> 5364</span>&#160;      next = <a class="code" href="src_2base_2rb__tree_8h.html#a2852fb3d5ccc9f1d3a245096fee9eb0b">RB_NEXT</a> (lob_rb_root, &amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a034edbe7866ca98df7b9e54e1b5e3de2">lob_locator_root</a>, entry);</div><div class="line"><a name="l05365"></a><span class="lineno"> 5365</span>&#160;</div><div class="line"><a name="l05366"></a><span class="lineno"> 5366</span>&#160;      need_to_delete = <span class="keyword">false</span>;</div><div class="line"><a name="l05367"></a><span class="lineno"> 5367</span>&#160;</div><div class="line"><a name="l05368"></a><span class="lineno"> 5368</span>&#160;      <span class="keywordflow">if</span> (at_commit)</div><div class="line"><a name="l05369"></a><span class="lineno"> 5369</span>&#160;    {</div><div class="line"><a name="l05370"></a><span class="lineno"> 5370</span>&#160;      <span class="keywordflow">if</span> (entry-&gt;top-&gt;state != <a class="code" href="log__impl_8h.html#a40a91713414be68a8000f379f883ad06ae75408b47fb2d17f8a7337b033acd927">LOB_PERMANENT_CREATED</a>)</div><div class="line"><a name="l05371"></a><span class="lineno"> 5371</span>&#160;        {</div><div class="line"><a name="l05372"></a><span class="lineno"> 5372</span>&#160;          need_to_delete = <span class="keyword">true</span>;</div><div class="line"><a name="l05373"></a><span class="lineno"> 5373</span>&#160;        }</div><div class="line"><a name="l05374"></a><span class="lineno"> 5374</span>&#160;    }</div><div class="line"><a name="l05375"></a><span class="lineno"> 5375</span>&#160;      <span class="keywordflow">else</span>          <span class="comment">/* rollback */</span></div><div class="line"><a name="l05376"></a><span class="lineno"> 5376</span>&#160;    {</div><div class="line"><a name="l05377"></a><span class="lineno"> 5377</span>&#160;      <span class="comment">/* at partial rollback, pop the previous states in the savepoint list util it meets the rollback savepoint */</span></div><div class="line"><a name="l05378"></a><span class="lineno"> 5378</span>&#160;      <span class="keywordflow">if</span> (savept_lsa != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l05379"></a><span class="lineno"> 5379</span>&#160;        {</div><div class="line"><a name="l05380"></a><span class="lineno"> 5380</span>&#160;          <a class="code" href="structlob__savepoint__entry.html">LOB_SAVEPOINT_ENTRY</a> *savept, *tmp;</div><div class="line"><a name="l05381"></a><span class="lineno"> 5381</span>&#160;</div><div class="line"><a name="l05382"></a><span class="lineno"> 5382</span>&#160;          <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (entry-&gt;top != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l05383"></a><span class="lineno"> 5383</span>&#160;          savept = entry-&gt;top-&gt;prev;</div><div class="line"><a name="l05384"></a><span class="lineno"> 5384</span>&#160;</div><div class="line"><a name="l05385"></a><span class="lineno"> 5385</span>&#160;          <span class="keywordflow">while</span> (savept != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l05386"></a><span class="lineno"> 5386</span>&#160;        {</div><div class="line"><a name="l05387"></a><span class="lineno"> 5387</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="storage__common_8h.html#a478797f01d6a6ad24c0203c09a639db2">LSA_LT</a> (&amp;entry-&gt;top-&gt;savept_lsa, savept_lsa))</div><div class="line"><a name="l05388"></a><span class="lineno"> 5388</span>&#160;            {</div><div class="line"><a name="l05389"></a><span class="lineno"> 5389</span>&#160;              <span class="keywordflow">break</span>;</div><div class="line"><a name="l05390"></a><span class="lineno"> 5390</span>&#160;            }</div><div class="line"><a name="l05391"></a><span class="lineno"> 5391</span>&#160;</div><div class="line"><a name="l05392"></a><span class="lineno"> 5392</span>&#160;          <span class="comment">/* rollback file renaming */</span></div><div class="line"><a name="l05393"></a><span class="lineno"> 5393</span>&#160;          <span class="keywordflow">if</span> (strcmp (entry-&gt;top-&gt;locator, savept-&gt;<a class="code" href="structlob__savepoint__entry.html#af8cc29daa202c0ddba6cbec4cf30882a">locator</a>) != 0)</div><div class="line"><a name="l05394"></a><span class="lineno"> 5394</span>&#160;            {</div><div class="line"><a name="l05395"></a><span class="lineno"> 5395</span>&#160;              <span class="keywordtype">char</span> meta_name[<a class="code" href="dbtype__def_8h.html#aca2202a80bb85043948f7c7a714aa070">DB_MAX_SCHEMA_LENGTH</a>];</div><div class="line"><a name="l05396"></a><span class="lineno"> 5396</span>&#160;</div><div class="line"><a name="l05397"></a><span class="lineno"> 5397</span>&#160;              <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (log_is_valid_locator (savept-&gt;<a class="code" href="structlob__savepoint__entry.html#af8cc29daa202c0ddba6cbec4cf30882a">locator</a>));</div><div class="line"><a name="l05398"></a><span class="lineno"> 5398</span>&#160;              <a class="code" href="log__manager_8c.html#a0d4074e0032a75ccf74ad2fdc9264083">PUT_LOCATOR_META</a> (meta_name, savept-&gt;<a class="code" href="structlob__savepoint__entry.html#af8cc29daa202c0ddba6cbec4cf30882a">locator</a>);</div><div class="line"><a name="l05399"></a><span class="lineno"> 5399</span>&#160;              <span class="comment">/* ignore return value */</span></div><div class="line"><a name="l05400"></a><span class="lineno"> 5400</span>&#160;              (void) <a class="code" href="es_8c.html#ad23d253074d43cbcf384cc0d3d1b77be">es_rename_file</a> (entry-&gt;top-&gt;locator, meta_name, savept-&gt;<a class="code" href="structlob__savepoint__entry.html#af8cc29daa202c0ddba6cbec4cf30882a">locator</a>);</div><div class="line"><a name="l05401"></a><span class="lineno"> 5401</span>&#160;            }</div><div class="line"><a name="l05402"></a><span class="lineno"> 5402</span>&#160;          tmp = entry-&gt;top;</div><div class="line"><a name="l05403"></a><span class="lineno"> 5403</span>&#160;          entry-&gt;top = savept;</div><div class="line"><a name="l05404"></a><span class="lineno"> 5404</span>&#160;          savept = savept-&gt;<a class="code" href="structlob__savepoint__entry.html#a3d018fd9135834945409660addac0520">prev</a>;</div><div class="line"><a name="l05405"></a><span class="lineno"> 5405</span>&#160;          <a class="code" href="memory__alloc_8h.html#a794b5a73adc277837a0c4d12da4af5af">free_and_init</a> (tmp);</div><div class="line"><a name="l05406"></a><span class="lineno"> 5406</span>&#160;        }</div><div class="line"><a name="l05407"></a><span class="lineno"> 5407</span>&#160;        }</div><div class="line"><a name="l05408"></a><span class="lineno"> 5408</span>&#160;</div><div class="line"><a name="l05409"></a><span class="lineno"> 5409</span>&#160;      <span class="comment">/* delete the locator to be created */</span></div><div class="line"><a name="l05410"></a><span class="lineno"> 5410</span>&#160;      <span class="keywordflow">if</span> ((savept_lsa == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || <a class="code" href="storage__common_8h.html#aa90a06bd1f1a9925ac8ef0f856d1d872">LSA_GE</a> (&amp;entry-&gt;top-&gt;savept_lsa, savept_lsa))</div><div class="line"><a name="l05411"></a><span class="lineno"> 5411</span>&#160;          &amp;&amp; entry-&gt;top-&gt;state != <a class="code" href="log__impl_8h.html#a40a91713414be68a8000f379f883ad06aca23e3e0be0d810de2059773fdb641bb">LOB_TRANSIENT_DELETED</a>)</div><div class="line"><a name="l05412"></a><span class="lineno"> 5412</span>&#160;        {</div><div class="line"><a name="l05413"></a><span class="lineno"> 5413</span>&#160;          need_to_delete = <span class="keyword">true</span>;</div><div class="line"><a name="l05414"></a><span class="lineno"> 5414</span>&#160;        }</div><div class="line"><a name="l05415"></a><span class="lineno"> 5415</span>&#160;    }</div><div class="line"><a name="l05416"></a><span class="lineno"> 5416</span>&#160;</div><div class="line"><a name="l05417"></a><span class="lineno"> 5417</span>&#160;      <span class="comment">/* remove from the locator tree */</span></div><div class="line"><a name="l05418"></a><span class="lineno"> 5418</span>&#160;      <span class="keywordflow">if</span> (need_to_delete)</div><div class="line"><a name="l05419"></a><span class="lineno"> 5419</span>&#160;    {</div><div class="line"><a name="l05420"></a><span class="lineno"> 5420</span>&#160;<span class="preprocessor">#if defined (SERVER_MODE)</span></div><div class="line"><a name="l05421"></a><span class="lineno"> 5421</span>&#160;      <span class="keywordflow">if</span> (at_commit &amp;&amp; entry-&gt;top-&gt;state == <a class="code" href="log__impl_8h.html#a40a91713414be68a8000f379f883ad06a56092aa8f2fff2e94d2925351bf404c1">LOB_PERMANENT_DELETED</a>)</div><div class="line"><a name="l05422"></a><span class="lineno"> 5422</span>&#160;        {</div><div class="line"><a name="l05423"></a><span class="lineno"> 5423</span>&#160;          vacuum_notify_es_deleted (thread_p, entry-&gt;top-&gt;locator);</div><div class="line"><a name="l05424"></a><span class="lineno"> 5424</span>&#160;        }</div><div class="line"><a name="l05425"></a><span class="lineno"> 5425</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l05426"></a><span class="lineno"> 5426</span>&#160;        {</div><div class="line"><a name="l05427"></a><span class="lineno"> 5427</span>&#160;          <span class="comment">/* The file is created and rolled-back and it is not visible to anyone. Delete it directly without</span></div><div class="line"><a name="l05428"></a><span class="lineno"> 5428</span>&#160;<span class="comment">           * notifying vacuum. */</span></div><div class="line"><a name="l05429"></a><span class="lineno"> 5429</span>&#160;          (void) <a class="code" href="es_8c.html#a85daafaae7e65285fdc167f61d47fb41">es_delete_file</a> (entry-&gt;top-&gt;locator);</div><div class="line"><a name="l05430"></a><span class="lineno"> 5430</span>&#160;        }</div><div class="line"><a name="l05431"></a><span class="lineno"> 5431</span>&#160;<span class="preprocessor">#else </span><span class="comment">/* !SERVER_MODE */</span><span class="preprocessor"></span></div><div class="line"><a name="l05432"></a><span class="lineno"> 5432</span>&#160;      <span class="comment">/* SA_MODE */</span></div><div class="line"><a name="l05433"></a><span class="lineno"> 5433</span>&#160;      (void) <a class="code" href="es_8c.html#a85daafaae7e65285fdc167f61d47fb41">es_delete_file</a> (entry-&gt;top-&gt;locator);</div><div class="line"><a name="l05434"></a><span class="lineno"> 5434</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* !SERVER_MODE */</span><span class="preprocessor"></span></div><div class="line"><a name="l05435"></a><span class="lineno"> 5435</span>&#160;      <a class="code" href="src_2base_2rb__tree_8h.html#ad97eb44d2c39debda8cfbbbbcb354cce">RB_REMOVE</a> (lob_rb_root, &amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a034edbe7866ca98df7b9e54e1b5e3de2">lob_locator_root</a>, entry);</div><div class="line"><a name="l05436"></a><span class="lineno"> 5436</span>&#160;      log_free_lob_locator (entry);</div><div class="line"><a name="l05437"></a><span class="lineno"> 5437</span>&#160;    }</div><div class="line"><a name="l05438"></a><span class="lineno"> 5438</span>&#160;    }</div><div class="line"><a name="l05439"></a><span class="lineno"> 5439</span>&#160;</div><div class="line"><a name="l05440"></a><span class="lineno"> 5440</span>&#160;  <span class="comment">/* at the end of transaction, free the locator list */</span></div><div class="line"><a name="l05441"></a><span class="lineno"> 5441</span>&#160;  <span class="keywordflow">if</span> (savept_lsa == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l05442"></a><span class="lineno"> 5442</span>&#160;    {</div><div class="line"><a name="l05443"></a><span class="lineno"> 5443</span>&#160;      <span class="keywordflow">for</span> (entry = <a class="code" href="src_2base_2rb__tree_8h.html#a0827c86d4c8c63495f665141d857f380">RB_MIN</a> (lob_rb_root, &amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a034edbe7866ca98df7b9e54e1b5e3de2">lob_locator_root</a>); entry != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>; entry = next)</div><div class="line"><a name="l05444"></a><span class="lineno"> 5444</span>&#160;    {</div><div class="line"><a name="l05445"></a><span class="lineno"> 5445</span>&#160;      next = <a class="code" href="src_2base_2rb__tree_8h.html#a2852fb3d5ccc9f1d3a245096fee9eb0b">RB_NEXT</a> (lob_rb_root, &amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a034edbe7866ca98df7b9e54e1b5e3de2">lob_locator_root</a>, entry);</div><div class="line"><a name="l05446"></a><span class="lineno"> 5446</span>&#160;      <a class="code" href="src_2base_2rb__tree_8h.html#ad97eb44d2c39debda8cfbbbbcb354cce">RB_REMOVE</a> (lob_rb_root, &amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a034edbe7866ca98df7b9e54e1b5e3de2">lob_locator_root</a>, entry);</div><div class="line"><a name="l05447"></a><span class="lineno"> 5447</span>&#160;      log_free_lob_locator (entry);</div><div class="line"><a name="l05448"></a><span class="lineno"> 5448</span>&#160;    }</div><div class="line"><a name="l05449"></a><span class="lineno"> 5449</span>&#160;      <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (<a class="code" href="src_2base_2rb__tree_8h.html#a0d85aa035345c2d3f890bf6bc602c068">RB_EMPTY</a> (&amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a034edbe7866ca98df7b9e54e1b5e3de2">lob_locator_root</a>));</div><div class="line"><a name="l05450"></a><span class="lineno"> 5450</span>&#160;    }</div><div class="line"><a name="l05451"></a><span class="lineno"> 5451</span>&#160;}</div><div class="line"><a name="l05452"></a><span class="lineno"> 5452</span>&#160;</div><div class="line"><a name="l05453"></a><span class="lineno"> 5453</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l05454"></a><span class="lineno"> 5454</span>&#160;<span class="comment"> * lob_locator_cmp - compare function used lob rb tree</span></div><div class="line"><a name="l05455"></a><span class="lineno"> 5455</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l05456"></a><span class="lineno"> 5456</span>&#160;<span class="comment"> * return: &lt; 0, 0, &gt; 0</span></div><div class="line"><a name="l05457"></a><span class="lineno"> 5457</span>&#160;<span class="comment"> * e1(in): entry 1</span></div><div class="line"><a name="l05458"></a><span class="lineno"> 5458</span>&#160;<span class="comment"> * e2(in): entry 2</span></div><div class="line"><a name="l05459"></a><span class="lineno"> 5459</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l05460"></a><span class="lineno"> 5460</span>&#160;<span class="comment"> * NOTE:</span></div><div class="line"><a name="l05461"></a><span class="lineno"> 5461</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l05462"></a><span class="lineno"> 5462</span>&#160;<span class="comment"> * Ordering relation of lob locator entry is defined as (key_hash, key).</span></div><div class="line"><a name="l05463"></a><span class="lineno"> 5463</span>&#160;<span class="comment"> * Because it is very UNLIKELY in normal case that two different locators have same hash value, this compare function </span></div><div class="line"><a name="l05464"></a><span class="lineno"> 5464</span>&#160;<span class="comment"> * is very efficient.</span></div><div class="line"><a name="l05465"></a><span class="lineno"> 5465</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l05466"></a><span class="lineno"> 5466</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l05467"></a><span class="lineno"> 5467</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span></div><div class="line"><a name="l05468"></a><span class="lineno"> 5468</span>&#160;lob_locator_cmp (<span class="keyword">const</span> <a class="code" href="structlob__locator__entry.html">LOB_LOCATOR_ENTRY</a> * e1, <span class="keyword">const</span> <a class="code" href="structlob__locator__entry.html">LOB_LOCATOR_ENTRY</a> * e2)</div><div class="line"><a name="l05469"></a><span class="lineno"> 5469</span>&#160;{</div><div class="line"><a name="l05470"></a><span class="lineno"> 5470</span>&#160;  <span class="keywordflow">if</span> (e1-&gt;key_hash != e2-&gt;key_hash)</div><div class="line"><a name="l05471"></a><span class="lineno"> 5471</span>&#160;    {</div><div class="line"><a name="l05472"></a><span class="lineno"> 5472</span>&#160;      <span class="keywordflow">return</span> e1-&gt;key_hash - e2-&gt;key_hash;</div><div class="line"><a name="l05473"></a><span class="lineno"> 5473</span>&#160;    }</div><div class="line"><a name="l05474"></a><span class="lineno"> 5474</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l05475"></a><span class="lineno"> 5475</span>&#160;    {</div><div class="line"><a name="l05476"></a><span class="lineno"> 5476</span>&#160;      <span class="keywordflow">return</span> strcmp (e1-&gt;key, e2-&gt;key);</div><div class="line"><a name="l05477"></a><span class="lineno"> 5477</span>&#160;    }</div><div class="line"><a name="l05478"></a><span class="lineno"> 5478</span>&#160;}</div><div class="line"><a name="l05479"></a><span class="lineno"> 5479</span>&#160;</div><div class="line"><a name="l05480"></a><span class="lineno"> 5480</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l05481"></a><span class="lineno"> 5481</span>&#160;<span class="comment"> * Below macro generates lob rb tree functions (see base/rb_tree.h)</span></div><div class="line"><a name="l05482"></a><span class="lineno"> 5482</span>&#160;<span class="comment"> * Note: semi-colon is intentionally added to be more beautiful</span></div><div class="line"><a name="l05483"></a><span class="lineno"> 5483</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l05484"></a><span class="lineno"> 5484</span>&#160;<a class="code" href="log__manager_8c.html#addd42d55d5a83c58800380301cda3d0e">RB_GENERATE_STATIC</a> (lob_rb_root, <a class="code" href="structlob__locator__entry.html">lob_locator_entry</a>, head, lob_locator_cmp);</div><div class="line"><a name="l05485"></a><span class="lineno"> 5485</span>&#160;</div><div class="line"><a name="l05486"></a><span class="lineno"> 5486</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l05487"></a><span class="lineno"> 5487</span>&#160;<span class="comment"> * log_commit_local - Perform the local commit operations of a transaction</span></div><div class="line"><a name="l05488"></a><span class="lineno"> 5488</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l05489"></a><span class="lineno"> 5489</span>&#160;<span class="comment"> * return: state of commit operation</span></div><div class="line"><a name="l05490"></a><span class="lineno"> 5490</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l05491"></a><span class="lineno"> 5491</span>&#160;<span class="comment"> *   tdes(in/out): State structure of transaction of the log record</span></div><div class="line"><a name="l05492"></a><span class="lineno"> 5492</span>&#160;<span class="comment"> *   retain_lock(in): false = release locks (default)</span></div><div class="line"><a name="l05493"></a><span class="lineno"> 5493</span>&#160;<span class="comment"> *                    true  = retain locks</span></div><div class="line"><a name="l05494"></a><span class="lineno"> 5494</span>&#160;<span class="comment"> *   is_local_tran(in): Is a local transaction?</span></div><div class="line"><a name="l05495"></a><span class="lineno"> 5495</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l05496"></a><span class="lineno"> 5496</span>&#160;<span class="comment"> * NOTE:  Commit the current transaction locally. If there are postpone actions, the transaction is declared </span></div><div class="line"><a name="l05497"></a><span class="lineno"> 5497</span>&#160;<span class="comment"> *        committed_with_postpone_actions by logging a log record indicating this state. Then, the postpone actions </span></div><div class="line"><a name="l05498"></a><span class="lineno"> 5498</span>&#160;<span class="comment"> *        are executed. When the transaction is declared as fully committed, the locks acquired by the transaction </span></div><div class="line"><a name="l05499"></a><span class="lineno"> 5499</span>&#160;<span class="comment"> *        are released. A committed transaction is not subject to deadlock when postpone operations are executed.</span></div><div class="line"><a name="l05500"></a><span class="lineno"> 5500</span>&#160;<span class="comment"> *    The function returns the state of the transaction(i.e. whether it is completely committed or not).</span></div><div class="line"><a name="l05501"></a><span class="lineno"> 5501</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l05502"></a><span class="lineno"> 5502</span>&#160;<a class="code" href="log__comm_8h.html#a3c0be9b9f104459ab90ee18af95c4b3e">TRAN_STATE</a></div><div class="line"><a name="l05503"></a><span class="lineno"><a class="line" href="log__manager_8h.html#ac8cc1b1140e661523c729c0e9e8f6523"> 5503</a></span>&#160;<a class="code" href="log__manager_8c.html#ac8cc1b1140e661523c729c0e9e8f6523">log_commit_local</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="structlog__tdes.html">LOG_TDES</a> * tdes, <span class="keywordtype">bool</span> retain_lock, <span class="keywordtype">bool</span> is_local_tran)</div><div class="line"><a name="l05504"></a><span class="lineno"> 5504</span>&#160;{</div><div class="line"><a name="l05505"></a><span class="lineno"> 5505</span>&#160;  <a class="code" href="query__manager_8c.html#aef469e9b70e98d1fb4e113d9757bab26">qmgr_clear_trans_wakeup</a> (thread_p, tdes-&gt;<a class="code" href="structlog__tdes.html#ae9437cf94e11e2307172ef5fc7b32aa9">tran_index</a>, <span class="keyword">false</span>, <span class="keyword">false</span>);</div><div class="line"><a name="l05506"></a><span class="lineno"> 5506</span>&#160;</div><div class="line"><a name="l05507"></a><span class="lineno"> 5507</span>&#160;  <span class="comment">/* log_clear_lob_locator_list and logtb_complete_mvcc operations must be done before entering unactive state because</span></div><div class="line"><a name="l05508"></a><span class="lineno"> 5508</span>&#160;<span class="comment">   * they do some logging. We must NOT log (or do other regular changes to the database) after the transaction enters</span></div><div class="line"><a name="l05509"></a><span class="lineno"> 5509</span>&#160;<span class="comment">   * the unactive state because of the following scenario: 1. enter TRAN_UNACTIVE_WILL_COMMIT state 2. a checkpoint</span></div><div class="line"><a name="l05510"></a><span class="lineno"> 5510</span>&#160;<span class="comment">   * occurs and finishes. All active transactions are saved in log including their state. Our transaction will be saved </span></div><div class="line"><a name="l05511"></a><span class="lineno"> 5511</span>&#160;<span class="comment">   * with TRAN_UNACTIVE_WILL_COMMIT state. 3. a crash occurs before our logging. Here, for example in case of unique</span></div><div class="line"><a name="l05512"></a><span class="lineno"> 5512</span>&#160;<span class="comment">   * statistics, we will lost logging of unique statistics. 4. A recovery will occur. Because our transaction was saved </span></div><div class="line"><a name="l05513"></a><span class="lineno"> 5513</span>&#160;<span class="comment">   * at checkpoint with TRAN_UNACTIVE_WILL_COMMIT state, it will be committed. Because we didn&#39;t logged the changes</span></div><div class="line"><a name="l05514"></a><span class="lineno"> 5514</span>&#160;<span class="comment">   * made by the transaction we will not reflect the changes. They will be definitely lost. */</span></div><div class="line"><a name="l05515"></a><span class="lineno"> 5515</span>&#160;  <a class="code" href="log__manager_8c.html#ab66f5229e5ed16479f13659587baef54">log_clear_lob_locator_list</a> (thread_p, tdes, <span class="keyword">true</span>, <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l05516"></a><span class="lineno"> 5516</span>&#160;</div><div class="line"><a name="l05517"></a><span class="lineno"> 5517</span>&#160;  <span class="comment">/* clear mvccid before releasing the locks. This operation must be done before do_postpone because it stores unique</span></div><div class="line"><a name="l05518"></a><span class="lineno"> 5518</span>&#160;<span class="comment">   * statistics for all B-trees and if an error occurs those operations and all operations of current transaction must </span></div><div class="line"><a name="l05519"></a><span class="lineno"> 5519</span>&#160;<span class="comment">   * be rolled back. */</span></div><div class="line"><a name="l05520"></a><span class="lineno"> 5520</span>&#160;  <a class="code" href="log__impl_8h.html#abced029cdab388279dc4b134179929c3">logtb_complete_mvcc</a> (thread_p, tdes, <span class="keyword">true</span>);</div><div class="line"><a name="l05521"></a><span class="lineno"> 5521</span>&#160;</div><div class="line"><a name="l05522"></a><span class="lineno"> 5522</span>&#160;  tdes-&gt;<a class="code" href="structlog__tdes.html#ad924146690490b840ef5c3f65c3a5a6c">state</a> = <a class="code" href="log__comm_8h.html#a3c0be9b9f104459ab90ee18af95c4b3ea10373ab725a87c9ac3126b85a1400846">TRAN_UNACTIVE_WILL_COMMIT</a>;</div><div class="line"><a name="l05523"></a><span class="lineno"> 5523</span>&#160;  <span class="comment">/* undo_nxlsa is no longer required here and must be reset, in case checkpoint takes a snapshot of this transaction</span></div><div class="line"><a name="l05524"></a><span class="lineno"> 5524</span>&#160;<span class="comment">   * during TRAN_UNACTIVE_WILL_COMMIT phase.</span></div><div class="line"><a name="l05525"></a><span class="lineno"> 5525</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l05526"></a><span class="lineno"> 5526</span>&#160;  <a class="code" href="storage__common_8h.html#a6a4baec606189dd320678e8f412ca957">LSA_SET_NULL</a> (&amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a4e3335b7f0e4ca7f858416446ae8f782">undo_nxlsa</a>);</div><div class="line"><a name="l05527"></a><span class="lineno"> 5527</span>&#160;</div><div class="line"><a name="l05528"></a><span class="lineno"> 5528</span>&#160;  <span class="comment">/* destroy all transaction&#39;s remaining temporary files */</span></div><div class="line"><a name="l05529"></a><span class="lineno"> 5529</span>&#160;  <a class="code" href="file__manager_8c.html#a266493da17b6d1e9ec9c2494c86164a0">file_tempcache_drop_tran_temp_files</a> (thread_p);</div><div class="line"><a name="l05530"></a><span class="lineno"> 5530</span>&#160;</div><div class="line"><a name="l05531"></a><span class="lineno"> 5531</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="storage__common_8h.html#a26dd766712df5b5c4fcd158f571a75e4">LSA_ISNULL</a> (&amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a5b128a08476a5b499cf82e3163e6d62b">tail_lsa</a>))</div><div class="line"><a name="l05532"></a><span class="lineno"> 5532</span>&#160;    {</div><div class="line"><a name="l05533"></a><span class="lineno"> 5533</span>&#160;      <span class="comment">/* </span></div><div class="line"><a name="l05534"></a><span class="lineno"> 5534</span>&#160;<span class="comment">       * Transaction updated data.</span></div><div class="line"><a name="l05535"></a><span class="lineno"> 5535</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l05536"></a><span class="lineno"> 5536</span>&#160;</div><div class="line"><a name="l05537"></a><span class="lineno"> 5537</span>&#160;      log_tran_do_postpone (thread_p, tdes);</div><div class="line"><a name="l05538"></a><span class="lineno"> 5538</span>&#160;</div><div class="line"><a name="l05539"></a><span class="lineno"> 5539</span>&#160;      <span class="comment">/* The files created by this transaction are not new files any longer. Close any query cursors at this moment</span></div><div class="line"><a name="l05540"></a><span class="lineno"> 5540</span>&#160;<span class="comment">       * too. */</span></div><div class="line"><a name="l05541"></a><span class="lineno"> 5541</span>&#160;      <span class="keywordflow">if</span> (tdes-&gt;<a class="code" href="structlog__tdes.html#a01ee2bddd37deb419f9418bf2f20678c">first_save_entry</a> != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l05542"></a><span class="lineno"> 5542</span>&#160;    {</div><div class="line"><a name="l05543"></a><span class="lineno"> 5543</span>&#160;      <a class="code" href="slotted__page_8c.html#ac4e01996e09e34fc3db406713fdd4aa6">spage_free_saved_spaces</a> (thread_p, tdes-&gt;<a class="code" href="structlog__tdes.html#a01ee2bddd37deb419f9418bf2f20678c">first_save_entry</a>);</div><div class="line"><a name="l05544"></a><span class="lineno"> 5544</span>&#160;      tdes-&gt;<a class="code" href="structlog__tdes.html#a01ee2bddd37deb419f9418bf2f20678c">first_save_entry</a> = <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l05545"></a><span class="lineno"> 5545</span>&#160;    }</div><div class="line"><a name="l05546"></a><span class="lineno"> 5546</span>&#160;</div><div class="line"><a name="l05547"></a><span class="lineno"> 5547</span>&#160;      log_cleanup_modified_class_list (thread_p, tdes, <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <span class="keyword">true</span>, <span class="keyword">false</span>);</div><div class="line"><a name="l05548"></a><span class="lineno"> 5548</span>&#160;</div><div class="line"><a name="l05549"></a><span class="lineno"> 5549</span>&#160;      <span class="keywordflow">if</span> (is_local_tran)</div><div class="line"><a name="l05550"></a><span class="lineno"> 5550</span>&#160;    {</div><div class="line"><a name="l05551"></a><span class="lineno"> 5551</span>&#160;      <a class="code" href="structlog__lsa.html">LOG_LSA</a> commit_lsa;</div><div class="line"><a name="l05552"></a><span class="lineno"> 5552</span>&#160;</div><div class="line"><a name="l05553"></a><span class="lineno"> 5553</span>&#160;      <span class="comment">/* To write unlock log before releasing locks for transactional consistencies. When a transaction(T2) which</span></div><div class="line"><a name="l05554"></a><span class="lineno"> 5554</span>&#160;<span class="comment">       * is resumed by this committing transaction(T1) commits and a crash happens before T1 completes, transaction </span></div><div class="line"><a name="l05555"></a><span class="lineno"> 5555</span>&#160;<span class="comment">       * consistencies will be broken because T1 will be aborted during restart recovery and T2 was already</span></div><div class="line"><a name="l05556"></a><span class="lineno"> 5556</span>&#160;<span class="comment">       * committed. */</span></div><div class="line"><a name="l05557"></a><span class="lineno"> 5557</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="log__impl_8h.html#a2d9876809ffa8473b6b47c5edcff6ca2">LOG_CHECK_LOG_APPLIER</a> (thread_p) &amp;&amp; !<a class="code" href="vacuum_8h.html#ab0e1deb8da1aa663aa073b0ce78606a2">VACUUM_IS_THREAD_VACUUM</a> (thread_p)</div><div class="line"><a name="l05558"></a><span class="lineno"> 5558</span>&#160;          &amp;&amp; <a class="code" href="log__comm_8c.html#ae3b5771bd95aa37a187f3a6e0cb2b32d">log_does_allow_replication</a> () == <span class="keyword">true</span>)</div><div class="line"><a name="l05559"></a><span class="lineno"> 5559</span>&#160;        {</div><div class="line"><a name="l05560"></a><span class="lineno"> 5560</span>&#160;          <span class="comment">/* for the replication agent guarantee the order of transaction */</span></div><div class="line"><a name="l05561"></a><span class="lineno"> 5561</span>&#160;          log_append_repl_info_and_commit_log (thread_p, tdes, &amp;commit_lsa);</div><div class="line"><a name="l05562"></a><span class="lineno"> 5562</span>&#160;        }</div><div class="line"><a name="l05563"></a><span class="lineno"> 5563</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l05564"></a><span class="lineno"> 5564</span>&#160;        {</div><div class="line"><a name="l05565"></a><span class="lineno"> 5565</span>&#160;          log_append_commit_log (thread_p, tdes, &amp;commit_lsa);</div><div class="line"><a name="l05566"></a><span class="lineno"> 5566</span>&#160;        }</div><div class="line"><a name="l05567"></a><span class="lineno"> 5567</span>&#160;</div><div class="line"><a name="l05568"></a><span class="lineno"> 5568</span>&#160;      <span class="keywordflow">if</span> (retain_lock != <span class="keyword">true</span>)</div><div class="line"><a name="l05569"></a><span class="lineno"> 5569</span>&#160;        {</div><div class="line"><a name="l05570"></a><span class="lineno"> 5570</span>&#160;          <a class="code" href="lock__manager_8c.html#a7a4552847269854167212acb2d02de60">lock_unlock_all</a> (thread_p);</div><div class="line"><a name="l05571"></a><span class="lineno"> 5571</span>&#160;        }</div><div class="line"><a name="l05572"></a><span class="lineno"> 5572</span>&#160;</div><div class="line"><a name="l05573"></a><span class="lineno"> 5573</span>&#160;      <span class="comment">/* Flush commit log and change the transaction state. */</span></div><div class="line"><a name="l05574"></a><span class="lineno"> 5574</span>&#160;      log_change_tran_as_completed (thread_p, tdes, <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a1903de7cf7fa88081eb8010a667e1839">LOG_COMMIT</a>, &amp;commit_lsa);</div><div class="line"><a name="l05575"></a><span class="lineno"> 5575</span>&#160;    }</div><div class="line"><a name="l05576"></a><span class="lineno"> 5576</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l05577"></a><span class="lineno"> 5577</span>&#160;    {</div><div class="line"><a name="l05578"></a><span class="lineno"> 5578</span>&#160;      <span class="comment">/* Postpone appending replication and commit log and releasing locks to log_complete_for_2pc. */</span></div><div class="line"><a name="l05579"></a><span class="lineno"> 5579</span>&#160;    }</div><div class="line"><a name="l05580"></a><span class="lineno"> 5580</span>&#160;    }</div><div class="line"><a name="l05581"></a><span class="lineno"> 5581</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l05582"></a><span class="lineno"> 5582</span>&#160;    {</div><div class="line"><a name="l05583"></a><span class="lineno"> 5583</span>&#160;      <span class="comment">/* </span></div><div class="line"><a name="l05584"></a><span class="lineno"> 5584</span>&#160;<span class="comment">       * Transaction did not update anything or we are not logging</span></div><div class="line"><a name="l05585"></a><span class="lineno"> 5585</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l05586"></a><span class="lineno"> 5586</span>&#160;</div><div class="line"><a name="l05587"></a><span class="lineno"> 5587</span>&#160;      <span class="comment">/* </span></div><div class="line"><a name="l05588"></a><span class="lineno"> 5588</span>&#160;<span class="comment">       * We are not logging, and changes were done</span></div><div class="line"><a name="l05589"></a><span class="lineno"> 5589</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l05590"></a><span class="lineno"> 5590</span>&#160;      <span class="keywordflow">if</span> (tdes-&gt;<a class="code" href="structlog__tdes.html#a01ee2bddd37deb419f9418bf2f20678c">first_save_entry</a> != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l05591"></a><span class="lineno"> 5591</span>&#160;    {</div><div class="line"><a name="l05592"></a><span class="lineno"> 5592</span>&#160;      <a class="code" href="slotted__page_8c.html#ac4e01996e09e34fc3db406713fdd4aa6">spage_free_saved_spaces</a> (thread_p, tdes-&gt;<a class="code" href="structlog__tdes.html#a01ee2bddd37deb419f9418bf2f20678c">first_save_entry</a>);</div><div class="line"><a name="l05593"></a><span class="lineno"> 5593</span>&#160;      tdes-&gt;<a class="code" href="structlog__tdes.html#a01ee2bddd37deb419f9418bf2f20678c">first_save_entry</a> = <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l05594"></a><span class="lineno"> 5594</span>&#160;    }</div><div class="line"><a name="l05595"></a><span class="lineno"> 5595</span>&#160;</div><div class="line"><a name="l05596"></a><span class="lineno"> 5596</span>&#160;      <span class="keywordflow">if</span> (retain_lock != <span class="keyword">true</span>)</div><div class="line"><a name="l05597"></a><span class="lineno"> 5597</span>&#160;    {</div><div class="line"><a name="l05598"></a><span class="lineno"> 5598</span>&#160;      <a class="code" href="lock__manager_8c.html#a7a4552847269854167212acb2d02de60">lock_unlock_all</a> (thread_p);</div><div class="line"><a name="l05599"></a><span class="lineno"> 5599</span>&#160;    }</div><div class="line"><a name="l05600"></a><span class="lineno"> 5600</span>&#160;</div><div class="line"><a name="l05601"></a><span class="lineno"> 5601</span>&#160;      tdes-&gt;<a class="code" href="structlog__tdes.html#ad924146690490b840ef5c3f65c3a5a6c">state</a> = <a class="code" href="log__comm_8h.html#a3c0be9b9f104459ab90ee18af95c4b3ea6ddb25e9eb5bdd0477b4da46f8edcaba">TRAN_UNACTIVE_COMMITTED</a>;</div><div class="line"><a name="l05602"></a><span class="lineno"> 5602</span>&#160;    }</div><div class="line"><a name="l05603"></a><span class="lineno"> 5603</span>&#160;</div><div class="line"><a name="l05604"></a><span class="lineno"> 5604</span>&#160;  <span class="keywordflow">return</span> tdes-&gt;<a class="code" href="structlog__tdes.html#ad924146690490b840ef5c3f65c3a5a6c">state</a>;</div><div class="line"><a name="l05605"></a><span class="lineno"> 5605</span>&#160;}</div><div class="line"><a name="l05606"></a><span class="lineno"> 5606</span>&#160;</div><div class="line"><a name="l05607"></a><span class="lineno"> 5607</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l05608"></a><span class="lineno"> 5608</span>&#160;<span class="comment"> * log_abort_local - Perform the local abort operations of a transaction</span></div><div class="line"><a name="l05609"></a><span class="lineno"> 5609</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l05610"></a><span class="lineno"> 5610</span>&#160;<span class="comment"> * return: state of abort operation</span></div><div class="line"><a name="l05611"></a><span class="lineno"> 5611</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l05612"></a><span class="lineno"> 5612</span>&#160;<span class="comment"> *   tdes(in/out): State structure of transaction of the log record</span></div><div class="line"><a name="l05613"></a><span class="lineno"> 5613</span>&#160;<span class="comment"> *   is_local_tran(in): Is a local transaction? (It is not used at this point)</span></div><div class="line"><a name="l05614"></a><span class="lineno"> 5614</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l05615"></a><span class="lineno"> 5615</span>&#160;<span class="comment"> * NOTE: Abort the current transaction locally.</span></div><div class="line"><a name="l05616"></a><span class="lineno"> 5616</span>&#160;<span class="comment"> *   When the transaction is declared as fully aborted, the locks acquired by the transaction are released and </span></div><div class="line"><a name="l05617"></a><span class="lineno"> 5617</span>&#160;<span class="comment"> *   query cursors are closed.</span></div><div class="line"><a name="l05618"></a><span class="lineno"> 5618</span>&#160;<span class="comment"> *       This function is used for both local and coordinator transactions.</span></div><div class="line"><a name="l05619"></a><span class="lineno"> 5619</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l05620"></a><span class="lineno"> 5620</span>&#160;<a class="code" href="log__comm_8h.html#a3c0be9b9f104459ab90ee18af95c4b3e">TRAN_STATE</a></div><div class="line"><a name="l05621"></a><span class="lineno"><a class="line" href="log__manager_8h.html#a16ef3597e53279503520c6a8167ff821"> 5621</a></span>&#160;<a class="code" href="log__manager_8c.html#a16ef3597e53279503520c6a8167ff821">log_abort_local</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="structlog__tdes.html">LOG_TDES</a> * tdes, <span class="keywordtype">bool</span> is_local_tran)</div><div class="line"><a name="l05622"></a><span class="lineno"> 5622</span>&#160;{</div><div class="line"><a name="l05623"></a><span class="lineno"> 5623</span>&#160;  <a class="code" href="query__manager_8c.html#aef469e9b70e98d1fb4e113d9757bab26">qmgr_clear_trans_wakeup</a> (thread_p, tdes-&gt;<a class="code" href="structlog__tdes.html#ae9437cf94e11e2307172ef5fc7b32aa9">tran_index</a>, <span class="keyword">false</span>, <span class="keyword">true</span>);</div><div class="line"><a name="l05624"></a><span class="lineno"> 5624</span>&#160;</div><div class="line"><a name="l05625"></a><span class="lineno"> 5625</span>&#160;  tdes-&gt;<a class="code" href="structlog__tdes.html#ad924146690490b840ef5c3f65c3a5a6c">state</a> = <a class="code" href="log__comm_8h.html#a3c0be9b9f104459ab90ee18af95c4b3eac19d6ad89f93ec75c1e1904db0e5c0ad">TRAN_UNACTIVE_ABORTED</a>;</div><div class="line"><a name="l05626"></a><span class="lineno"> 5626</span>&#160;</div><div class="line"><a name="l05627"></a><span class="lineno"> 5627</span>&#160;  <span class="comment">/* destroy transaction&#39;s temporary files */</span></div><div class="line"><a name="l05628"></a><span class="lineno"> 5628</span>&#160;  <a class="code" href="file__manager_8c.html#a266493da17b6d1e9ec9c2494c86164a0">file_tempcache_drop_tran_temp_files</a> (thread_p);</div><div class="line"><a name="l05629"></a><span class="lineno"> 5629</span>&#160;</div><div class="line"><a name="l05630"></a><span class="lineno"> 5630</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="storage__common_8h.html#a26dd766712df5b5c4fcd158f571a75e4">LSA_ISNULL</a> (&amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a5b128a08476a5b499cf82e3163e6d62b">tail_lsa</a>))</div><div class="line"><a name="l05631"></a><span class="lineno"> 5631</span>&#160;    {</div><div class="line"><a name="l05632"></a><span class="lineno"> 5632</span>&#160;      <span class="comment">/* </span></div><div class="line"><a name="l05633"></a><span class="lineno"> 5633</span>&#160;<span class="comment">       * Transaction updated data.</span></div><div class="line"><a name="l05634"></a><span class="lineno"> 5634</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l05635"></a><span class="lineno"> 5635</span>&#160;</div><div class="line"><a name="l05636"></a><span class="lineno"> 5636</span>&#160;      log_rollback (thread_p, tdes, <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l05637"></a><span class="lineno"> 5637</span>&#160;</div><div class="line"><a name="l05638"></a><span class="lineno"> 5638</span>&#160;      log_cleanup_modified_class_list (thread_p, tdes, <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <span class="keyword">true</span>, <span class="keyword">true</span>);</div><div class="line"><a name="l05639"></a><span class="lineno"> 5639</span>&#160;</div><div class="line"><a name="l05640"></a><span class="lineno"> 5640</span>&#160;      <span class="keywordflow">if</span> (tdes-&gt;<a class="code" href="structlog__tdes.html#a01ee2bddd37deb419f9418bf2f20678c">first_save_entry</a> != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l05641"></a><span class="lineno"> 5641</span>&#160;    {</div><div class="line"><a name="l05642"></a><span class="lineno"> 5642</span>&#160;      <a class="code" href="slotted__page_8c.html#ac4e01996e09e34fc3db406713fdd4aa6">spage_free_saved_spaces</a> (thread_p, tdes-&gt;<a class="code" href="structlog__tdes.html#a01ee2bddd37deb419f9418bf2f20678c">first_save_entry</a>);</div><div class="line"><a name="l05643"></a><span class="lineno"> 5643</span>&#160;      tdes-&gt;<a class="code" href="structlog__tdes.html#a01ee2bddd37deb419f9418bf2f20678c">first_save_entry</a> = <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l05644"></a><span class="lineno"> 5644</span>&#160;    }</div><div class="line"><a name="l05645"></a><span class="lineno"> 5645</span>&#160;</div><div class="line"><a name="l05646"></a><span class="lineno"> 5646</span>&#160;      <span class="comment">/* clear mvccid before releasing the locks */</span></div><div class="line"><a name="l05647"></a><span class="lineno"> 5647</span>&#160;      <a class="code" href="log__impl_8h.html#abced029cdab388279dc4b134179929c3">logtb_complete_mvcc</a> (thread_p, tdes, <span class="keyword">false</span>);</div><div class="line"><a name="l05648"></a><span class="lineno"> 5648</span>&#160;</div><div class="line"><a name="l05649"></a><span class="lineno"> 5649</span>&#160;      <span class="comment">/* It is safe to release locks here, since we already completed abort. */</span></div><div class="line"><a name="l05650"></a><span class="lineno"> 5650</span>&#160;      <a class="code" href="lock__manager_8c.html#a7a4552847269854167212acb2d02de60">lock_unlock_all</a> (thread_p);</div><div class="line"><a name="l05651"></a><span class="lineno"> 5651</span>&#160;    }</div><div class="line"><a name="l05652"></a><span class="lineno"> 5652</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l05653"></a><span class="lineno"> 5653</span>&#160;    {</div><div class="line"><a name="l05654"></a><span class="lineno"> 5654</span>&#160;      <span class="comment">/* </span></div><div class="line"><a name="l05655"></a><span class="lineno"> 5655</span>&#160;<span class="comment">       * Transaction did not update anything or we are not logging</span></div><div class="line"><a name="l05656"></a><span class="lineno"> 5656</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l05657"></a><span class="lineno"> 5657</span>&#160;</div><div class="line"><a name="l05658"></a><span class="lineno"> 5658</span>&#160;      <span class="keywordflow">if</span> (tdes-&gt;<a class="code" href="structlog__tdes.html#a01ee2bddd37deb419f9418bf2f20678c">first_save_entry</a> != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l05659"></a><span class="lineno"> 5659</span>&#160;    {</div><div class="line"><a name="l05660"></a><span class="lineno"> 5660</span>&#160;      <a class="code" href="slotted__page_8c.html#ac4e01996e09e34fc3db406713fdd4aa6">spage_free_saved_spaces</a> (thread_p, tdes-&gt;<a class="code" href="structlog__tdes.html#a01ee2bddd37deb419f9418bf2f20678c">first_save_entry</a>);</div><div class="line"><a name="l05661"></a><span class="lineno"> 5661</span>&#160;      tdes-&gt;<a class="code" href="structlog__tdes.html#a01ee2bddd37deb419f9418bf2f20678c">first_save_entry</a> = <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l05662"></a><span class="lineno"> 5662</span>&#160;    }</div><div class="line"><a name="l05663"></a><span class="lineno"> 5663</span>&#160;</div><div class="line"><a name="l05664"></a><span class="lineno"> 5664</span>&#160;      <span class="comment">/* clear mvccid before releasing the locks */</span></div><div class="line"><a name="l05665"></a><span class="lineno"> 5665</span>&#160;      <a class="code" href="log__impl_8h.html#abced029cdab388279dc4b134179929c3">logtb_complete_mvcc</a> (thread_p, tdes, <span class="keyword">false</span>);</div><div class="line"><a name="l05666"></a><span class="lineno"> 5666</span>&#160;</div><div class="line"><a name="l05667"></a><span class="lineno"> 5667</span>&#160;      <a class="code" href="lock__manager_8c.html#a7a4552847269854167212acb2d02de60">lock_unlock_all</a> (thread_p);</div><div class="line"><a name="l05668"></a><span class="lineno"> 5668</span>&#160;</div><div class="line"><a name="l05669"></a><span class="lineno"> 5669</span>&#160;      <span class="comment">/* There is no need to create a new transaction identifier */</span></div><div class="line"><a name="l05670"></a><span class="lineno"> 5670</span>&#160;    }</div><div class="line"><a name="l05671"></a><span class="lineno"> 5671</span>&#160;</div><div class="line"><a name="l05672"></a><span class="lineno"> 5672</span>&#160;  <a class="code" href="log__manager_8c.html#ab66f5229e5ed16479f13659587baef54">log_clear_lob_locator_list</a> (thread_p, tdes, <span class="keyword">false</span>, <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l05673"></a><span class="lineno"> 5673</span>&#160;</div><div class="line"><a name="l05674"></a><span class="lineno"> 5674</span>&#160;  <span class="keywordflow">return</span> tdes-&gt;<a class="code" href="structlog__tdes.html#ad924146690490b840ef5c3f65c3a5a6c">state</a>;</div><div class="line"><a name="l05675"></a><span class="lineno"> 5675</span>&#160;}</div><div class="line"><a name="l05676"></a><span class="lineno"> 5676</span>&#160;</div><div class="line"><a name="l05677"></a><span class="lineno"> 5677</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l05678"></a><span class="lineno"> 5678</span>&#160;<span class="comment"> * log_commit - COMMIT A TRANSACTION</span></div><div class="line"><a name="l05679"></a><span class="lineno"> 5679</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l05680"></a><span class="lineno"> 5680</span>&#160;<span class="comment"> * return:  state of commit operation</span></div><div class="line"><a name="l05681"></a><span class="lineno"> 5681</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l05682"></a><span class="lineno"> 5682</span>&#160;<span class="comment"> *   tran_index(in): tran_index</span></div><div class="line"><a name="l05683"></a><span class="lineno"> 5683</span>&#160;<span class="comment"> *   retain_lock(in): false = release locks (default)</span></div><div class="line"><a name="l05684"></a><span class="lineno"> 5684</span>&#160;<span class="comment"> *                      true  = retain locks</span></div><div class="line"><a name="l05685"></a><span class="lineno"> 5685</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l05686"></a><span class="lineno"> 5686</span>&#160;<span class="comment"> * NOTE: Commit the current transaction.  The function returns the</span></div><div class="line"><a name="l05687"></a><span class="lineno"> 5687</span>&#160;<span class="comment"> *              state of the transaction (i.e., notify if the transaction</span></div><div class="line"><a name="l05688"></a><span class="lineno"> 5688</span>&#160;<span class="comment"> *              is completely commited or not). If the transaction was</span></div><div class="line"><a name="l05689"></a><span class="lineno"> 5689</span>&#160;<span class="comment"> *              coordinating a global transaction then the Two Phase Commit</span></div><div class="line"><a name="l05690"></a><span class="lineno"> 5690</span>&#160;<span class="comment"> *              protocol is followed by this function. Otherwise, only the</span></div><div class="line"><a name="l05691"></a><span class="lineno"> 5691</span>&#160;<span class="comment"> *              local commit actions are performed.</span></div><div class="line"><a name="l05692"></a><span class="lineno"> 5692</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l05693"></a><span class="lineno"> 5693</span>&#160;<a class="code" href="log__comm_8h.html#a3c0be9b9f104459ab90ee18af95c4b3e">TRAN_STATE</a></div><div class="line"><a name="l05694"></a><span class="lineno"><a class="line" href="log__manager_8h.html#a390852f8765cd90576d47d02ef0d10b6"> 5694</a></span>&#160;<a class="code" href="log__manager_8c.html#a390852f8765cd90576d47d02ef0d10b6">log_commit</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <span class="keywordtype">int</span> tran_index, <span class="keywordtype">bool</span> retain_lock)</div><div class="line"><a name="l05695"></a><span class="lineno"> 5695</span>&#160;{</div><div class="line"><a name="l05696"></a><span class="lineno"> 5696</span>&#160;  <a class="code" href="log__comm_8h.html#a3c0be9b9f104459ab90ee18af95c4b3e">TRAN_STATE</a> state;     <span class="comment">/* State of committed transaction */</span></div><div class="line"><a name="l05697"></a><span class="lineno"> 5697</span>&#160;  <a class="code" href="structlog__tdes.html">LOG_TDES</a> *tdes;       <span class="comment">/* Transaction descriptor */</span></div><div class="line"><a name="l05698"></a><span class="lineno"> 5698</span>&#160;  <span class="keywordtype">bool</span> decision;</div><div class="line"><a name="l05699"></a><span class="lineno"> 5699</span>&#160;  <a class="code" href="log__impl_8h.html#a98c98195fe088cf7345b3c4d7d3149fb">LOG_2PC_EXECUTE</a> execute_2pc_type;</div><div class="line"><a name="l05700"></a><span class="lineno"> 5700</span>&#160;  <span class="keywordtype">int</span> error_code = <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>;</div><div class="line"><a name="l05701"></a><span class="lineno"> 5701</span>&#160;</div><div class="line"><a name="l05702"></a><span class="lineno"> 5702</span>&#160;  <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (!<a class="code" href="vacuum_8h.html#ab0e1deb8da1aa663aa073b0ce78606a2">VACUUM_IS_THREAD_VACUUM</a> (thread_p));</div><div class="line"><a name="l05703"></a><span class="lineno"> 5703</span>&#160;</div><div class="line"><a name="l05704"></a><span class="lineno"> 5704</span>&#160;  <span class="keywordflow">if</span> (tran_index == <a class="code" href="storage__common_8h.html#ab6db6dc2e50e5821d2b8cdbfdeee71ef">NULL_TRAN_INDEX</a>)</div><div class="line"><a name="l05705"></a><span class="lineno"> 5705</span>&#160;    {</div><div class="line"><a name="l05706"></a><span class="lineno"> 5706</span>&#160;      tran_index = <a class="code" href="perf__monitor_8h.html#a55d27b01d605ba6ee2929ddfe8588320">LOG_FIND_THREAD_TRAN_INDEX</a> (thread_p);</div><div class="line"><a name="l05707"></a><span class="lineno"> 5707</span>&#160;    }</div><div class="line"><a name="l05708"></a><span class="lineno"> 5708</span>&#160;</div><div class="line"><a name="l05709"></a><span class="lineno"> 5709</span>&#160;  tdes = <a class="code" href="log__impl_8h.html#a08fee41cfcf592e8afdbc4988ffbc8e4">LOG_FIND_TDES</a> (tran_index);</div><div class="line"><a name="l05710"></a><span class="lineno"> 5710</span>&#160;  <span class="keywordflow">if</span> (tdes == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l05711"></a><span class="lineno"> 5711</span>&#160;    {</div><div class="line"><a name="l05712"></a><span class="lineno"> 5712</span>&#160;      <a class="code" href="error__manager_8c.html#afdaf87ce30f2f557802a185ab85b6599">er_set</a> (<a class="code" href="error__manager_8h.html#a5d0d456c474e11fc70779873a30a7432a3314630dd19f90a68274cf737092c9f2">ER_FATAL_ERROR_SEVERITY</a>, <a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <a class="code" href="error__code_8h.html#a4b8e41e78be77c579a2c58f5248fefe2">ER_LOG_UNKNOWN_TRANINDEX</a>, 1, tran_index);</div><div class="line"><a name="l05713"></a><span class="lineno"> 5713</span>&#160;      error_code = <a class="code" href="error__code_8h.html#a4b8e41e78be77c579a2c58f5248fefe2">ER_LOG_UNKNOWN_TRANINDEX</a>;</div><div class="line"><a name="l05714"></a><span class="lineno"> 5714</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="log__comm_8h.html#a3c0be9b9f104459ab90ee18af95c4b3eaaed7a3b3de7b11b4ac81fedf6471e10c">TRAN_UNACTIVE_UNKNOWN</a>;</div><div class="line"><a name="l05715"></a><span class="lineno"> 5715</span>&#160;    }</div><div class="line"><a name="l05716"></a><span class="lineno"> 5716</span>&#160;</div><div class="line"><a name="l05717"></a><span class="lineno"> 5717</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="log__impl_8h.html#aa81dc352329c9f96467c795c1547be74">LOG_ISTRAN_ACTIVE</a> (tdes) &amp;&amp; !<a class="code" href="log__impl_8h.html#abc226e48b6f8147e3e0fe83c98eb69fb">LOG_ISTRAN_2PC_PREPARE</a> (tdes) &amp;&amp; <a class="code" href="log__impl_8h.html#a8f08025b469332f89fee8ce83dc2d3ff">LOG_ISRESTARTED</a> ())</div><div class="line"><a name="l05718"></a><span class="lineno"> 5718</span>&#160;    {</div><div class="line"><a name="l05719"></a><span class="lineno"> 5719</span>&#160;      <span class="comment">/* May be a system error since transaction is not active.. cannot be committed */</span></div><div class="line"><a name="l05720"></a><span class="lineno"> 5720</span>&#160;<span class="preprocessor">#if defined(CUBRID_DEBUG)</span></div><div class="line"><a name="l05721"></a><span class="lineno"> 5721</span>&#160;      <a class="code" href="error__manager_8h.html#a075eb8873354909bbe8edafa0f18f58c">er_log_debug</a> (<a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>,</div><div class="line"><a name="l05722"></a><span class="lineno"> 5722</span>&#160;            <span class="stringliteral">&quot;log_commit: Transaction %d (index = %d) is&quot;</span></div><div class="line"><a name="l05723"></a><span class="lineno"> 5723</span>&#160;            <span class="stringliteral">&quot; not active and cannot be committed. Its state is %s\n&quot;</span>, tdes-&gt;<a class="code" href="structlog__tdes.html#a3baeff284ed2167bcef74c5ef34d4f3b">trid</a>, tdes-&gt;<a class="code" href="structlog__tdes.html#ae9437cf94e11e2307172ef5fc7b32aa9">tran_index</a>,</div><div class="line"><a name="l05724"></a><span class="lineno"> 5724</span>&#160;            <a class="code" href="log__comm_8c.html#a7d21e9c2307baa1c134e93315dfe1d91">log_state_string</a> (tdes-&gt;<a class="code" href="structlog__tdes.html#ad924146690490b840ef5c3f65c3a5a6c">state</a>));</div><div class="line"><a name="l05725"></a><span class="lineno"> 5725</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* CUBRID_DEBUG */</span><span class="preprocessor"></span></div><div class="line"><a name="l05726"></a><span class="lineno"> 5726</span>&#160;      <span class="keywordflow">return</span> tdes-&gt;<a class="code" href="structlog__tdes.html#ad924146690490b840ef5c3f65c3a5a6c">state</a>;</div><div class="line"><a name="l05727"></a><span class="lineno"> 5727</span>&#160;    }</div><div class="line"><a name="l05728"></a><span class="lineno"> 5728</span>&#160;</div><div class="line"><a name="l05729"></a><span class="lineno"> 5729</span>&#160;  <span class="keywordflow">if</span> (tdes-&gt;<a class="code" href="structlog__tdes.html#a97c1d42917ab4d08ffe3194fc7233018">topops</a>.<a class="code" href="structlog__topops__stack.html#a5e509dcc15d89abc0c6ba486af6dba4d">last</a> &gt;= 0)</div><div class="line"><a name="l05730"></a><span class="lineno"> 5730</span>&#160;    {</div><div class="line"><a name="l05731"></a><span class="lineno"> 5731</span>&#160;      <span class="comment">/* This is likely a system error since the transaction is being committed when there are system permanent</span></div><div class="line"><a name="l05732"></a><span class="lineno"> 5732</span>&#160;<span class="comment">       * operations attached to it. Commit those operations too */</span></div><div class="line"><a name="l05733"></a><span class="lineno"> 5733</span>&#160;      <a class="code" href="error__manager_8c.html#afdaf87ce30f2f557802a185ab85b6599">er_set</a> (<a class="code" href="error__manager_8h.html#a5d0d456c474e11fc70779873a30a7432ab550b3cd73fa19e9a2430d5b4552a2b1">ER_WARNING_SEVERITY</a>, <a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <a class="code" href="error__code_8h.html#a1029f54d1ce04fb5a6a02ab458663ec6">ER_LOG_HAS_TOPOPS_DURING_COMMIT_ABORT</a>, 2, tdes-&gt;<a class="code" href="structlog__tdes.html#a3baeff284ed2167bcef74c5ef34d4f3b">trid</a>,</div><div class="line"><a name="l05734"></a><span class="lineno"> 5734</span>&#160;          tdes-&gt;<a class="code" href="structlog__tdes.html#ae9437cf94e11e2307172ef5fc7b32aa9">tran_index</a>);</div><div class="line"><a name="l05735"></a><span class="lineno"> 5735</span>&#160;      <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (<span class="keyword">false</span>);</div><div class="line"><a name="l05736"></a><span class="lineno"> 5736</span>&#160;      <span class="keywordflow">while</span> (tdes-&gt;<a class="code" href="structlog__tdes.html#a97c1d42917ab4d08ffe3194fc7233018">topops</a>.<a class="code" href="structlog__topops__stack.html#a5e509dcc15d89abc0c6ba486af6dba4d">last</a> &gt;= 0)</div><div class="line"><a name="l05737"></a><span class="lineno"> 5737</span>&#160;    {</div><div class="line"><a name="l05738"></a><span class="lineno"> 5738</span>&#160;      <a class="code" href="log__manager_8c.html#a5e97a30aa978dafbca4f7180c5d3909f">log_sysop_attach_to_outer</a> (thread_p);</div><div class="line"><a name="l05739"></a><span class="lineno"> 5739</span>&#160;    }</div><div class="line"><a name="l05740"></a><span class="lineno"> 5740</span>&#160;    }</div><div class="line"><a name="l05741"></a><span class="lineno"> 5741</span>&#160;</div><div class="line"><a name="l05742"></a><span class="lineno"> 5742</span>&#160;  <span class="keywordflow">if</span> (tdes-&gt;<a class="code" href="structlog__tdes.html#a3f287d08461d1ab5a7499ed4f07d1423">tran_unique_stats</a> != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l05743"></a><span class="lineno"> 5743</span>&#160;    {</div><div class="line"><a name="l05744"></a><span class="lineno"> 5744</span>&#160;<span class="preprocessor">#if defined(CUBRID_DEBUG)</span></div><div class="line"><a name="l05745"></a><span class="lineno"> 5745</span>&#160;      <a class="code" href="error__manager_8h.html#a075eb8873354909bbe8edafa0f18f58c">er_log_debug</a> (<a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>,</div><div class="line"><a name="l05746"></a><span class="lineno"> 5746</span>&#160;            <span class="stringliteral">&quot;log_commit: Warning, unique statistical information kept in transaction entry is not freed.&quot;</span>);</div><div class="line"><a name="l05747"></a><span class="lineno"> 5747</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* CUBRID_DEBUG */</span><span class="preprocessor"></span></div><div class="line"><a name="l05748"></a><span class="lineno"> 5748</span>&#160;      <a class="code" href="memory__alloc_8h.html#a794b5a73adc277837a0c4d12da4af5af">free_and_init</a> (tdes-&gt;<a class="code" href="structlog__tdes.html#a3f287d08461d1ab5a7499ed4f07d1423">tran_unique_stats</a>);</div><div class="line"><a name="l05749"></a><span class="lineno"> 5749</span>&#160;      tdes-&gt;<a class="code" href="structlog__tdes.html#a58eaa41917555c02b46a13556f72b254">num_unique_btrees</a> = 0;</div><div class="line"><a name="l05750"></a><span class="lineno"> 5750</span>&#160;      tdes-&gt;<a class="code" href="structlog__tdes.html#a0c486814dae3bd754b76014a91051f32">max_unique_btrees</a> = 0;</div><div class="line"><a name="l05751"></a><span class="lineno"> 5751</span>&#160;    }</div><div class="line"><a name="l05752"></a><span class="lineno"> 5752</span>&#160;</div><div class="line"><a name="l05753"></a><span class="lineno"> 5753</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="log__2pc_8c.html#a566c7760f8c68cf6cccc5f80045984e7">log_clear_and_is_tran_distributed</a> (tdes))</div><div class="line"><a name="l05754"></a><span class="lineno"> 5754</span>&#160;    {</div><div class="line"><a name="l05755"></a><span class="lineno"> 5755</span>&#160;      <span class="comment">/* This is the coordinator of a distributed transaction If we are in prepare to commit mode. I cannot be the</span></div><div class="line"><a name="l05756"></a><span class="lineno"> 5756</span>&#160;<span class="comment">       * root coordinator, so the decision has been taken at this moment by the root coordinator */</span></div><div class="line"><a name="l05757"></a><span class="lineno"> 5757</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="log__impl_8h.html#abc226e48b6f8147e3e0fe83c98eb69fb">LOG_ISTRAN_2PC_PREPARE</a> (tdes))</div><div class="line"><a name="l05758"></a><span class="lineno"> 5758</span>&#160;    {</div><div class="line"><a name="l05759"></a><span class="lineno"> 5759</span>&#160;      execute_2pc_type = <a class="code" href="log__impl_8h.html#a73baa6645b24b8b7c11e7ec7f4f53e8ca47291680922a0611854ee67af1ba9938">LOG_2PC_EXECUTE_COMMIT_DECISION</a>;</div><div class="line"><a name="l05760"></a><span class="lineno"> 5760</span>&#160;    }</div><div class="line"><a name="l05761"></a><span class="lineno"> 5761</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l05762"></a><span class="lineno"> 5762</span>&#160;    {</div><div class="line"><a name="l05763"></a><span class="lineno"> 5763</span>&#160;      execute_2pc_type = <a class="code" href="log__impl_8h.html#a73baa6645b24b8b7c11e7ec7f4f53e8caf17ce35fc60e09af740a57c5eb5a338c">LOG_2PC_EXECUTE_FULL</a>;</div><div class="line"><a name="l05764"></a><span class="lineno"> 5764</span>&#160;    }</div><div class="line"><a name="l05765"></a><span class="lineno"> 5765</span>&#160;</div><div class="line"><a name="l05766"></a><span class="lineno"> 5766</span>&#160;      state = <a class="code" href="log__2pc_8c.html#ab47b2cdecdd3831c4f54258773eef82a">log_2pc_commit</a> (thread_p, tdes, execute_2pc_type, &amp;decision);</div><div class="line"><a name="l05767"></a><span class="lineno"> 5767</span>&#160;    }</div><div class="line"><a name="l05768"></a><span class="lineno"> 5768</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l05769"></a><span class="lineno"> 5769</span>&#160;    {</div><div class="line"><a name="l05770"></a><span class="lineno"> 5770</span>&#160;      <span class="comment">/* </span></div><div class="line"><a name="l05771"></a><span class="lineno"> 5771</span>&#160;<span class="comment">       * This is a local transaction or is a participant of a distributed transaction</span></div><div class="line"><a name="l05772"></a><span class="lineno"> 5772</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l05773"></a><span class="lineno"> 5773</span>&#160;      state = <a class="code" href="log__manager_8c.html#ac8cc1b1140e661523c729c0e9e8f6523">log_commit_local</a> (thread_p, tdes, retain_lock, <span class="keyword">true</span>);</div><div class="line"><a name="l05774"></a><span class="lineno"> 5774</span>&#160;      state = <a class="code" href="log__manager_8c.html#a205cb9f31defd227b8340f7f4bd24a09">log_complete</a> (thread_p, tdes, <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a1903de7cf7fa88081eb8010a667e1839">LOG_COMMIT</a>, <a class="code" href="log__impl_8h.html#ab0c98093893d496bd3c00c6825c3941bacf3113fe0ba179d76a1bbae698248c79">LOG_NEED_NEWTRID</a>, <a class="code" href="log__impl_8h.html#af65c435e9509efe8e005c094e49a0b2fa0ccf60db52a36e795a53906683f34b26">LOG_ALREADY_WROTE_EOT_LOG</a>);</div><div class="line"><a name="l05775"></a><span class="lineno"> 5775</span>&#160;    }</div><div class="line"><a name="l05776"></a><span class="lineno"> 5776</span>&#160;</div><div class="line"><a name="l05777"></a><span class="lineno"> 5777</span>&#160;  <span class="keywordflow">if</span> (log_No_logging)</div><div class="line"><a name="l05778"></a><span class="lineno"> 5778</span>&#160;    {</div><div class="line"><a name="l05779"></a><span class="lineno"> 5779</span>&#160;      <a class="code" href="log__impl_8h.html#a5561d6b89dce60cfa780062fae1bb473">LOG_CS_ENTER</a> (thread_p);</div><div class="line"><a name="l05780"></a><span class="lineno"> 5780</span>&#160;      <span class="comment">/* We are not logging */</span></div><div class="line"><a name="l05781"></a><span class="lineno"> 5781</span>&#160;      <a class="code" href="log__impl_8h.html#ab5c84aff4d15372a2d150897ad6d2b80">logpb_flush_pages_direct</a> (thread_p);</div><div class="line"><a name="l05782"></a><span class="lineno"> 5782</span>&#160;      (void) <a class="code" href="page__buffer_8c.html#a05c13a976dabead4ff4483f000c03d71">pgbuf_flush_all_unfixed</a> (thread_p, <a class="code" href="storage__common_8h.html#a5859fbd2f7cd3c37c37e672f812388ff">NULL_VOLID</a>);</div><div class="line"><a name="l05783"></a><span class="lineno"> 5783</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="log__impl_8h.html#ac738f2699dc478c4bb643fdb176f26de">LOG_HAS_LOGGING_BEEN_IGNORED</a> ())</div><div class="line"><a name="l05784"></a><span class="lineno"> 5784</span>&#160;    {</div><div class="line"><a name="l05785"></a><span class="lineno"> 5785</span>&#160;      <span class="comment">/* </span></div><div class="line"><a name="l05786"></a><span class="lineno"> 5786</span>&#160;<span class="comment">       * Indicate that logging has not been ignored for next transaction</span></div><div class="line"><a name="l05787"></a><span class="lineno"> 5787</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l05788"></a><span class="lineno"> 5788</span>&#160;      <a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>.<a class="code" href="structlog__header.html#a8e11d6d1907cbdd412a9c3cb7d79e6f4">has_logging_been_skipped</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l05789"></a><span class="lineno"> 5789</span>&#160;      <a class="code" href="log__impl_8h.html#a48a9214aa55783d4ae5648457f686c6c">logpb_flush_header</a> (thread_p);</div><div class="line"><a name="l05790"></a><span class="lineno"> 5790</span>&#160;    }</div><div class="line"><a name="l05791"></a><span class="lineno"> 5791</span>&#160;      <a class="code" href="log__impl_8h.html#a6a5f95ded1a2f38ed00c8e9c039a9f2e">LOG_CS_EXIT</a> (thread_p);</div><div class="line"><a name="l05792"></a><span class="lineno"> 5792</span>&#160;    }</div><div class="line"><a name="l05793"></a><span class="lineno"> 5793</span>&#160;</div><div class="line"><a name="l05794"></a><span class="lineno"> 5794</span>&#160;  <a class="code" href="perf__monitor_8h.html#af4850f6b1c604051a0aa7704883eeb07">perfmon_inc_stat</a> (thread_p, <a class="code" href="perf__monitor_8h.html#a165b76d14ae9e30731ed3ca4cf856903afea83068933c6e6230b2300f3a5f19ab">PSTAT_TRAN_NUM_COMMITS</a>);</div><div class="line"><a name="l05795"></a><span class="lineno"> 5795</span>&#160;</div><div class="line"><a name="l05796"></a><span class="lineno"> 5796</span>&#160;  <span class="keywordflow">return</span> state;</div><div class="line"><a name="l05797"></a><span class="lineno"> 5797</span>&#160;}</div><div class="line"><a name="l05798"></a><span class="lineno"> 5798</span>&#160;</div><div class="line"><a name="l05799"></a><span class="lineno"> 5799</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l05800"></a><span class="lineno"> 5800</span>&#160;<span class="comment"> * log_abort - ABORT A TRANSACTION</span></div><div class="line"><a name="l05801"></a><span class="lineno"> 5801</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l05802"></a><span class="lineno"> 5802</span>&#160;<span class="comment"> * return: TRAN_STATE</span></div><div class="line"><a name="l05803"></a><span class="lineno"> 5803</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l05804"></a><span class="lineno"> 5804</span>&#160;<span class="comment"> *   tran_index(in): tran_index</span></div><div class="line"><a name="l05805"></a><span class="lineno"> 5805</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l05806"></a><span class="lineno"> 5806</span>&#160;<span class="comment"> * NOTE: Abort the current transaction. If the transaction is the</span></div><div class="line"><a name="l05807"></a><span class="lineno"> 5807</span>&#160;<span class="comment"> *              coordinator of a global transaction, the participants are also</span></div><div class="line"><a name="l05808"></a><span class="lineno"> 5808</span>&#160;<span class="comment"> *              informed about the abort, and if necessary their</span></div><div class="line"><a name="l05809"></a><span class="lineno"> 5809</span>&#160;<span class="comment"> *              acknowledgements are collected before finishing the</span></div><div class="line"><a name="l05810"></a><span class="lineno"> 5810</span>&#160;<span class="comment"> *              transaction.</span></div><div class="line"><a name="l05811"></a><span class="lineno"> 5811</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l05812"></a><span class="lineno"> 5812</span>&#160;<a class="code" href="log__comm_8h.html#a3c0be9b9f104459ab90ee18af95c4b3e">TRAN_STATE</a></div><div class="line"><a name="l05813"></a><span class="lineno"><a class="line" href="log__manager_8h.html#a6ae789049ef769d2489e14fd6bec41f8"> 5813</a></span>&#160;<a class="code" href="log__manager_8c.html#a6ae789049ef769d2489e14fd6bec41f8">log_abort</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <span class="keywordtype">int</span> tran_index)</div><div class="line"><a name="l05814"></a><span class="lineno"> 5814</span>&#160;{</div><div class="line"><a name="l05815"></a><span class="lineno"> 5815</span>&#160;  <a class="code" href="log__comm_8h.html#a3c0be9b9f104459ab90ee18af95c4b3e">TRAN_STATE</a> state;     <span class="comment">/* State of aborted transaction */</span></div><div class="line"><a name="l05816"></a><span class="lineno"> 5816</span>&#160;  <a class="code" href="structlog__tdes.html">LOG_TDES</a> *tdes;       <span class="comment">/* Transaction descriptor */</span></div><div class="line"><a name="l05817"></a><span class="lineno"> 5817</span>&#160;  <span class="keywordtype">bool</span> decision;</div><div class="line"><a name="l05818"></a><span class="lineno"> 5818</span>&#160;  <span class="keywordtype">int</span> error_code = <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>;</div><div class="line"><a name="l05819"></a><span class="lineno"> 5819</span>&#160;</div><div class="line"><a name="l05820"></a><span class="lineno"> 5820</span>&#160;  <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (!<a class="code" href="vacuum_8h.html#ab0e1deb8da1aa663aa073b0ce78606a2">VACUUM_IS_THREAD_VACUUM</a> (thread_p));</div><div class="line"><a name="l05821"></a><span class="lineno"> 5821</span>&#160;</div><div class="line"><a name="l05822"></a><span class="lineno"> 5822</span>&#160;  <span class="keywordflow">if</span> (tran_index == <a class="code" href="storage__common_8h.html#ab6db6dc2e50e5821d2b8cdbfdeee71ef">NULL_TRAN_INDEX</a>)</div><div class="line"><a name="l05823"></a><span class="lineno"> 5823</span>&#160;    {</div><div class="line"><a name="l05824"></a><span class="lineno"> 5824</span>&#160;      tran_index = <a class="code" href="perf__monitor_8h.html#a55d27b01d605ba6ee2929ddfe8588320">LOG_FIND_THREAD_TRAN_INDEX</a> (thread_p);</div><div class="line"><a name="l05825"></a><span class="lineno"> 5825</span>&#160;    }</div><div class="line"><a name="l05826"></a><span class="lineno"> 5826</span>&#160;</div><div class="line"><a name="l05827"></a><span class="lineno"> 5827</span>&#160;  tdes = <a class="code" href="log__impl_8h.html#a08fee41cfcf592e8afdbc4988ffbc8e4">LOG_FIND_TDES</a> (tran_index);</div><div class="line"><a name="l05828"></a><span class="lineno"> 5828</span>&#160;  <span class="keywordflow">if</span> (tdes == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l05829"></a><span class="lineno"> 5829</span>&#160;    {</div><div class="line"><a name="l05830"></a><span class="lineno"> 5830</span>&#160;      <a class="code" href="error__manager_8c.html#afdaf87ce30f2f557802a185ab85b6599">er_set</a> (<a class="code" href="error__manager_8h.html#a5d0d456c474e11fc70779873a30a7432a3314630dd19f90a68274cf737092c9f2">ER_FATAL_ERROR_SEVERITY</a>, <a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <a class="code" href="error__code_8h.html#a4b8e41e78be77c579a2c58f5248fefe2">ER_LOG_UNKNOWN_TRANINDEX</a>, 1, tran_index);</div><div class="line"><a name="l05831"></a><span class="lineno"> 5831</span>&#160;      error_code = <a class="code" href="error__code_8h.html#a4b8e41e78be77c579a2c58f5248fefe2">ER_LOG_UNKNOWN_TRANINDEX</a>;</div><div class="line"><a name="l05832"></a><span class="lineno"> 5832</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="log__comm_8h.html#a3c0be9b9f104459ab90ee18af95c4b3eaaed7a3b3de7b11b4ac81fedf6471e10c">TRAN_UNACTIVE_UNKNOWN</a>;</div><div class="line"><a name="l05833"></a><span class="lineno"> 5833</span>&#160;    }</div><div class="line"><a name="l05834"></a><span class="lineno"> 5834</span>&#160;</div><div class="line"><a name="l05835"></a><span class="lineno"> 5835</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="log__impl_8h.html#ac738f2699dc478c4bb643fdb176f26de">LOG_HAS_LOGGING_BEEN_IGNORED</a> ())</div><div class="line"><a name="l05836"></a><span class="lineno"> 5836</span>&#160;    {</div><div class="line"><a name="l05837"></a><span class="lineno"> 5837</span>&#160;      <a class="code" href="error__manager_8c.html#afdaf87ce30f2f557802a185ab85b6599">er_set</a> (<a class="code" href="error__manager_8h.html#a5d0d456c474e11fc70779873a30a7432a3314630dd19f90a68274cf737092c9f2">ER_FATAL_ERROR_SEVERITY</a>, <a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <a class="code" href="error__code_8h.html#ade4920aba636e2047c0111dfaa9d67e0">ER_LOG_CORRUPTED_DB_DUE_NOLOGGING</a>, 0);</div><div class="line"><a name="l05838"></a><span class="lineno"> 5838</span>&#160;      error_code = <a class="code" href="error__code_8h.html#ade4920aba636e2047c0111dfaa9d67e0">ER_LOG_CORRUPTED_DB_DUE_NOLOGGING</a>;</div><div class="line"><a name="l05839"></a><span class="lineno"> 5839</span>&#160;      <span class="keywordflow">return</span> tdes-&gt;<a class="code" href="structlog__tdes.html#ad924146690490b840ef5c3f65c3a5a6c">state</a>;</div><div class="line"><a name="l05840"></a><span class="lineno"> 5840</span>&#160;    }</div><div class="line"><a name="l05841"></a><span class="lineno"> 5841</span>&#160;</div><div class="line"><a name="l05842"></a><span class="lineno"> 5842</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="log__impl_8h.html#aa81dc352329c9f96467c795c1547be74">LOG_ISTRAN_ACTIVE</a> (tdes) &amp;&amp; !<a class="code" href="log__impl_8h.html#abc226e48b6f8147e3e0fe83c98eb69fb">LOG_ISTRAN_2PC_PREPARE</a> (tdes))</div><div class="line"><a name="l05843"></a><span class="lineno"> 5843</span>&#160;    {</div><div class="line"><a name="l05844"></a><span class="lineno"> 5844</span>&#160;      <span class="comment">/* </span></div><div class="line"><a name="l05845"></a><span class="lineno"> 5845</span>&#160;<span class="comment">       * May be a system error: Transaction is not in an active state nor</span></div><div class="line"><a name="l05846"></a><span class="lineno"> 5846</span>&#160;<span class="comment">       * prepare to commit state</span></div><div class="line"><a name="l05847"></a><span class="lineno"> 5847</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l05848"></a><span class="lineno"> 5848</span>&#160;      <span class="keywordflow">return</span> tdes-&gt;<a class="code" href="structlog__tdes.html#ad924146690490b840ef5c3f65c3a5a6c">state</a>;</div><div class="line"><a name="l05849"></a><span class="lineno"> 5849</span>&#160;    }</div><div class="line"><a name="l05850"></a><span class="lineno"> 5850</span>&#160;</div><div class="line"><a name="l05851"></a><span class="lineno"> 5851</span>&#160;  <span class="keywordflow">if</span> (tdes-&gt;<a class="code" href="structlog__tdes.html#a97c1d42917ab4d08ffe3194fc7233018">topops</a>.<a class="code" href="structlog__topops__stack.html#a5e509dcc15d89abc0c6ba486af6dba4d">last</a> &gt;= 0)</div><div class="line"><a name="l05852"></a><span class="lineno"> 5852</span>&#160;    {</div><div class="line"><a name="l05853"></a><span class="lineno"> 5853</span>&#160;      <span class="comment">/* </span></div><div class="line"><a name="l05854"></a><span class="lineno"> 5854</span>&#160;<span class="comment">       * This is likely a system error since the transaction is being aborted</span></div><div class="line"><a name="l05855"></a><span class="lineno"> 5855</span>&#160;<span class="comment">       * when there are system permananet operations attached to it. Abort those</span></div><div class="line"><a name="l05856"></a><span class="lineno"> 5856</span>&#160;<span class="comment">       * operations too.</span></div><div class="line"><a name="l05857"></a><span class="lineno"> 5857</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l05858"></a><span class="lineno"> 5858</span>&#160;      <a class="code" href="error__manager_8c.html#afdaf87ce30f2f557802a185ab85b6599">er_set</a> (<a class="code" href="error__manager_8h.html#a5d0d456c474e11fc70779873a30a7432ab550b3cd73fa19e9a2430d5b4552a2b1">ER_WARNING_SEVERITY</a>, <a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <a class="code" href="error__code_8h.html#a1029f54d1ce04fb5a6a02ab458663ec6">ER_LOG_HAS_TOPOPS_DURING_COMMIT_ABORT</a>, 2, tdes-&gt;<a class="code" href="structlog__tdes.html#a3baeff284ed2167bcef74c5ef34d4f3b">trid</a>,</div><div class="line"><a name="l05859"></a><span class="lineno"> 5859</span>&#160;          tdes-&gt;<a class="code" href="structlog__tdes.html#ae9437cf94e11e2307172ef5fc7b32aa9">tran_index</a>);</div><div class="line"><a name="l05860"></a><span class="lineno"> 5860</span>&#160;      <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (<span class="keyword">false</span>);</div><div class="line"><a name="l05861"></a><span class="lineno"> 5861</span>&#160;      <span class="keywordflow">while</span> (tdes-&gt;<a class="code" href="structlog__tdes.html#a97c1d42917ab4d08ffe3194fc7233018">topops</a>.<a class="code" href="structlog__topops__stack.html#a5e509dcc15d89abc0c6ba486af6dba4d">last</a> &gt;= 0)</div><div class="line"><a name="l05862"></a><span class="lineno"> 5862</span>&#160;    {</div><div class="line"><a name="l05863"></a><span class="lineno"> 5863</span>&#160;      <a class="code" href="log__manager_8c.html#a5e97a30aa978dafbca4f7180c5d3909f">log_sysop_attach_to_outer</a> (thread_p);</div><div class="line"><a name="l05864"></a><span class="lineno"> 5864</span>&#160;    }</div><div class="line"><a name="l05865"></a><span class="lineno"> 5865</span>&#160;    }</div><div class="line"><a name="l05866"></a><span class="lineno"> 5866</span>&#160;</div><div class="line"><a name="l05867"></a><span class="lineno"> 5867</span>&#160;  <span class="keywordflow">if</span> (tdes-&gt;<a class="code" href="structlog__tdes.html#a3f287d08461d1ab5a7499ed4f07d1423">tran_unique_stats</a> != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l05868"></a><span class="lineno"> 5868</span>&#160;    {</div><div class="line"><a name="l05869"></a><span class="lineno"> 5869</span>&#160;<span class="preprocessor">#if defined(CUBRID_DEBUG)</span></div><div class="line"><a name="l05870"></a><span class="lineno"> 5870</span>&#160;      <a class="code" href="error__manager_8h.html#a075eb8873354909bbe8edafa0f18f58c">er_log_debug</a> (<a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>,</div><div class="line"><a name="l05871"></a><span class="lineno"> 5871</span>&#160;            <span class="stringliteral">&quot;log_abort: Warning, unique statistical information kept in transaction entry is not freed.&quot;</span>);</div><div class="line"><a name="l05872"></a><span class="lineno"> 5872</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* CUBRID_DEBUG */</span><span class="preprocessor"></span></div><div class="line"><a name="l05873"></a><span class="lineno"> 5873</span>&#160;      <a class="code" href="memory__alloc_8h.html#a794b5a73adc277837a0c4d12da4af5af">free_and_init</a> (tdes-&gt;<a class="code" href="structlog__tdes.html#a3f287d08461d1ab5a7499ed4f07d1423">tran_unique_stats</a>);</div><div class="line"><a name="l05874"></a><span class="lineno"> 5874</span>&#160;      tdes-&gt;<a class="code" href="structlog__tdes.html#a58eaa41917555c02b46a13556f72b254">num_unique_btrees</a> = 0;</div><div class="line"><a name="l05875"></a><span class="lineno"> 5875</span>&#160;      tdes-&gt;<a class="code" href="structlog__tdes.html#a0c486814dae3bd754b76014a91051f32">max_unique_btrees</a> = 0;</div><div class="line"><a name="l05876"></a><span class="lineno"> 5876</span>&#160;    }</div><div class="line"><a name="l05877"></a><span class="lineno"> 5877</span>&#160;</div><div class="line"><a name="l05878"></a><span class="lineno"> 5878</span>&#160;  <span class="comment">/* </span></div><div class="line"><a name="l05879"></a><span class="lineno"> 5879</span>&#160;<span class="comment">   * If we are in prepare to commit mode. I cannot be the root coodinator,</span></div><div class="line"><a name="l05880"></a><span class="lineno"> 5880</span>&#160;<span class="comment">   * so the decision has already been taken at this moment by the root</span></div><div class="line"><a name="l05881"></a><span class="lineno"> 5881</span>&#160;<span class="comment">   * coordinator. If a distributed transaction is not in 2PC, the decision</span></div><div class="line"><a name="l05882"></a><span class="lineno"> 5882</span>&#160;<span class="comment">   * has been taken without using the 2PC.</span></div><div class="line"><a name="l05883"></a><span class="lineno"> 5883</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l05884"></a><span class="lineno"> 5884</span>&#160;</div><div class="line"><a name="l05885"></a><span class="lineno"> 5885</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="log__2pc_8c.html#a566c7760f8c68cf6cccc5f80045984e7">log_clear_and_is_tran_distributed</a> (tdes))</div><div class="line"><a name="l05886"></a><span class="lineno"> 5886</span>&#160;    {</div><div class="line"><a name="l05887"></a><span class="lineno"> 5887</span>&#160;      <span class="comment">/* This is the coordinator of a distributed transaction */</span></div><div class="line"><a name="l05888"></a><span class="lineno"> 5888</span>&#160;      state = <a class="code" href="log__2pc_8c.html#ab47b2cdecdd3831c4f54258773eef82a">log_2pc_commit</a> (thread_p, tdes, <a class="code" href="log__impl_8h.html#a73baa6645b24b8b7c11e7ec7f4f53e8ca14a79f362dece4ce17360938edb94090">LOG_2PC_EXECUTE_ABORT_DECISION</a>, &amp;decision);</div><div class="line"><a name="l05889"></a><span class="lineno"> 5889</span>&#160;    }</div><div class="line"><a name="l05890"></a><span class="lineno"> 5890</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l05891"></a><span class="lineno"> 5891</span>&#160;    {</div><div class="line"><a name="l05892"></a><span class="lineno"> 5892</span>&#160;      <span class="comment">/* </span></div><div class="line"><a name="l05893"></a><span class="lineno"> 5893</span>&#160;<span class="comment">       * This is a local transaction or is a participant of a distributed transaction.</span></div><div class="line"><a name="l05894"></a><span class="lineno"> 5894</span>&#160;<span class="comment">       * Perform the server rollback first.</span></div><div class="line"><a name="l05895"></a><span class="lineno"> 5895</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l05896"></a><span class="lineno"> 5896</span>&#160;      state = <a class="code" href="log__manager_8c.html#a16ef3597e53279503520c6a8167ff821">log_abort_local</a> (thread_p, tdes, <span class="keyword">true</span>);</div><div class="line"><a name="l05897"></a><span class="lineno"> 5897</span>&#160;      state = <a class="code" href="log__manager_8c.html#a205cb9f31defd227b8340f7f4bd24a09">log_complete</a> (thread_p, tdes, <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a66f7a15b57486fb9081e733c142d35ea">LOG_ABORT</a>, <a class="code" href="log__impl_8h.html#ab0c98093893d496bd3c00c6825c3941bacf3113fe0ba179d76a1bbae698248c79">LOG_NEED_NEWTRID</a>, <a class="code" href="log__impl_8h.html#af65c435e9509efe8e005c094e49a0b2fa64ac1d15aa4fce7a8d40eeb22a4b95cd">LOG_NEED_TO_WRITE_EOT_LOG</a>);</div><div class="line"><a name="l05898"></a><span class="lineno"> 5898</span>&#160;    }</div><div class="line"><a name="l05899"></a><span class="lineno"> 5899</span>&#160;</div><div class="line"><a name="l05900"></a><span class="lineno"> 5900</span>&#160;  <a class="code" href="perf__monitor_8h.html#af4850f6b1c604051a0aa7704883eeb07">perfmon_inc_stat</a> (thread_p, <a class="code" href="perf__monitor_8h.html#a165b76d14ae9e30731ed3ca4cf856903a4e18bb2055926d898d835f85870c7bed">PSTAT_TRAN_NUM_ROLLBACKS</a>);</div><div class="line"><a name="l05901"></a><span class="lineno"> 5901</span>&#160;</div><div class="line"><a name="l05902"></a><span class="lineno"> 5902</span>&#160;  <span class="keywordflow">return</span> state;</div><div class="line"><a name="l05903"></a><span class="lineno"> 5903</span>&#160;}</div><div class="line"><a name="l05904"></a><span class="lineno"> 5904</span>&#160;</div><div class="line"><a name="l05905"></a><span class="lineno"> 5905</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l05906"></a><span class="lineno"> 5906</span>&#160;<span class="comment"> * log_abort_partial - ABORT ACTIONS OF A TRANSACTION TO A SAVEPOINT</span></div><div class="line"><a name="l05907"></a><span class="lineno"> 5907</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l05908"></a><span class="lineno"> 5908</span>&#160;<span class="comment"> * return: state of partial aborted operation.</span></div><div class="line"><a name="l05909"></a><span class="lineno"> 5909</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l05910"></a><span class="lineno"> 5910</span>&#160;<span class="comment"> *   savepoint_name(in):  Name of the savepoint</span></div><div class="line"><a name="l05911"></a><span class="lineno"> 5911</span>&#160;<span class="comment"> *   savept_lsa(in):</span></div><div class="line"><a name="l05912"></a><span class="lineno"> 5912</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l05913"></a><span class="lineno"> 5913</span>&#160;<span class="comment"> * NOTE: All the effects done by the current transaction after the</span></div><div class="line"><a name="l05914"></a><span class="lineno"> 5914</span>&#160;<span class="comment"> *              given savepoint are undone and all effects of the transaction</span></div><div class="line"><a name="l05915"></a><span class="lineno"> 5915</span>&#160;<span class="comment"> *              preceding the given savepoint remain. After the partial abort</span></div><div class="line"><a name="l05916"></a><span class="lineno"> 5916</span>&#160;<span class="comment"> *              the transaction can continue its normal execution as if</span></div><div class="line"><a name="l05917"></a><span class="lineno"> 5917</span>&#160;<span class="comment"> *              the statements that were undone were never executed.</span></div><div class="line"><a name="l05918"></a><span class="lineno"> 5918</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l05919"></a><span class="lineno"> 5919</span>&#160;<a class="code" href="log__comm_8h.html#a3c0be9b9f104459ab90ee18af95c4b3e">TRAN_STATE</a></div><div class="line"><a name="l05920"></a><span class="lineno"><a class="line" href="log__manager_8h.html#a337f8a4c9ef75b8f01e4f5293d2f3381"> 5920</a></span>&#160;<a class="code" href="log__manager_8c.html#a337f8a4c9ef75b8f01e4f5293d2f3381">log_abort_partial</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <span class="keyword">const</span> <span class="keywordtype">char</span> *savepoint_name, <a class="code" href="structlog__lsa.html">LOG_LSA</a> * savept_lsa)</div><div class="line"><a name="l05921"></a><span class="lineno"> 5921</span>&#160;{</div><div class="line"><a name="l05922"></a><span class="lineno"> 5922</span>&#160;  <a class="code" href="structlog__tdes.html">LOG_TDES</a> *tdes;       <span class="comment">/* Transaction descriptor */</span></div><div class="line"><a name="l05923"></a><span class="lineno"> 5923</span>&#160;  <span class="keywordtype">int</span> tran_index;</div><div class="line"><a name="l05924"></a><span class="lineno"> 5924</span>&#160;</div><div class="line"><a name="l05925"></a><span class="lineno"> 5925</span>&#160;  <span class="comment">/* Find current transaction descriptor */</span></div><div class="line"><a name="l05926"></a><span class="lineno"> 5926</span>&#160;  tran_index = <a class="code" href="perf__monitor_8h.html#a55d27b01d605ba6ee2929ddfe8588320">LOG_FIND_THREAD_TRAN_INDEX</a> (thread_p);</div><div class="line"><a name="l05927"></a><span class="lineno"> 5927</span>&#160;  tdes = <a class="code" href="log__impl_8h.html#a08fee41cfcf592e8afdbc4988ffbc8e4">LOG_FIND_TDES</a> (tran_index);</div><div class="line"><a name="l05928"></a><span class="lineno"> 5928</span>&#160;  <span class="keywordflow">if</span> (tdes == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l05929"></a><span class="lineno"> 5929</span>&#160;    {</div><div class="line"><a name="l05930"></a><span class="lineno"> 5930</span>&#160;      <a class="code" href="error__manager_8c.html#afdaf87ce30f2f557802a185ab85b6599">er_set</a> (<a class="code" href="error__manager_8h.html#a5d0d456c474e11fc70779873a30a7432a3314630dd19f90a68274cf737092c9f2">ER_FATAL_ERROR_SEVERITY</a>, <a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <a class="code" href="error__code_8h.html#a4b8e41e78be77c579a2c58f5248fefe2">ER_LOG_UNKNOWN_TRANINDEX</a>, 1, tran_index);</div><div class="line"><a name="l05931"></a><span class="lineno"> 5931</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="log__comm_8h.html#a3c0be9b9f104459ab90ee18af95c4b3eaaed7a3b3de7b11b4ac81fedf6471e10c">TRAN_UNACTIVE_UNKNOWN</a>;</div><div class="line"><a name="l05932"></a><span class="lineno"> 5932</span>&#160;    }</div><div class="line"><a name="l05933"></a><span class="lineno"> 5933</span>&#160;</div><div class="line"><a name="l05934"></a><span class="lineno"> 5934</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="log__impl_8h.html#ac738f2699dc478c4bb643fdb176f26de">LOG_HAS_LOGGING_BEEN_IGNORED</a> ())</div><div class="line"><a name="l05935"></a><span class="lineno"> 5935</span>&#160;    {</div><div class="line"><a name="l05936"></a><span class="lineno"> 5936</span>&#160;      <a class="code" href="error__manager_8c.html#afdaf87ce30f2f557802a185ab85b6599">er_set</a> (<a class="code" href="error__manager_8h.html#a5d0d456c474e11fc70779873a30a7432a3314630dd19f90a68274cf737092c9f2">ER_FATAL_ERROR_SEVERITY</a>, <a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <a class="code" href="error__code_8h.html#ade4920aba636e2047c0111dfaa9d67e0">ER_LOG_CORRUPTED_DB_DUE_NOLOGGING</a>, 0);</div><div class="line"><a name="l05937"></a><span class="lineno"> 5937</span>&#160;      <span class="keywordflow">return</span> tdes-&gt;<a class="code" href="structlog__tdes.html#ad924146690490b840ef5c3f65c3a5a6c">state</a>;</div><div class="line"><a name="l05938"></a><span class="lineno"> 5938</span>&#160;    }</div><div class="line"><a name="l05939"></a><span class="lineno"> 5939</span>&#160;</div><div class="line"><a name="l05940"></a><span class="lineno"> 5940</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="log__impl_8h.html#aa81dc352329c9f96467c795c1547be74">LOG_ISTRAN_ACTIVE</a> (tdes))</div><div class="line"><a name="l05941"></a><span class="lineno"> 5941</span>&#160;    {</div><div class="line"><a name="l05942"></a><span class="lineno"> 5942</span>&#160;      <span class="comment">/* </span></div><div class="line"><a name="l05943"></a><span class="lineno"> 5943</span>&#160;<span class="comment">       * May be a system error: Transaction is not in an active state</span></div><div class="line"><a name="l05944"></a><span class="lineno"> 5944</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l05945"></a><span class="lineno"> 5945</span>&#160;      <span class="keywordflow">return</span> tdes-&gt;<a class="code" href="structlog__tdes.html#ad924146690490b840ef5c3f65c3a5a6c">state</a>;</div><div class="line"><a name="l05946"></a><span class="lineno"> 5946</span>&#160;    }</div><div class="line"><a name="l05947"></a><span class="lineno"> 5947</span>&#160;</div><div class="line"><a name="l05948"></a><span class="lineno"> 5948</span>&#160;  <span class="keywordflow">if</span> (savepoint_name == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || log_get_savepoint_lsa (thread_p, savepoint_name, tdes, savept_lsa) == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l05949"></a><span class="lineno"> 5949</span>&#160;    {</div><div class="line"><a name="l05950"></a><span class="lineno"> 5950</span>&#160;      <a class="code" href="error__manager_8c.html#afdaf87ce30f2f557802a185ab85b6599">er_set</a> (<a class="code" href="error__manager_8h.html#a5d0d456c474e11fc70779873a30a7432a07ad8f9fda27124d297c94b7d3ea44e8">ER_ERROR_SEVERITY</a>, <a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <a class="code" href="error__code_8h.html#a320868638688e5fee6412ef68fa1f3eb">ER_LOG_UNKNOWN_SAVEPOINT</a>, 1, savepoint_name);</div><div class="line"><a name="l05951"></a><span class="lineno"> 5951</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="log__comm_8h.html#a3c0be9b9f104459ab90ee18af95c4b3eaaed7a3b3de7b11b4ac81fedf6471e10c">TRAN_UNACTIVE_UNKNOWN</a>;</div><div class="line"><a name="l05952"></a><span class="lineno"> 5952</span>&#160;    }</div><div class="line"><a name="l05953"></a><span class="lineno"> 5953</span>&#160;</div><div class="line"><a name="l05954"></a><span class="lineno"> 5954</span>&#160;  <span class="keywordflow">if</span> (tdes-&gt;<a class="code" href="structlog__tdes.html#a97c1d42917ab4d08ffe3194fc7233018">topops</a>.<a class="code" href="structlog__topops__stack.html#a5e509dcc15d89abc0c6ba486af6dba4d">last</a> &gt;= 0)</div><div class="line"><a name="l05955"></a><span class="lineno"> 5955</span>&#160;    {</div><div class="line"><a name="l05956"></a><span class="lineno"> 5956</span>&#160;      <span class="comment">/* </span></div><div class="line"><a name="l05957"></a><span class="lineno"> 5957</span>&#160;<span class="comment">       * This is likely a system error since the transaction is being partially</span></div><div class="line"><a name="l05958"></a><span class="lineno"> 5958</span>&#160;<span class="comment">       * aborted when there are nested top system permanent operations</span></div><div class="line"><a name="l05959"></a><span class="lineno"> 5959</span>&#160;<span class="comment">       * attached to it. Abort those operations too.</span></div><div class="line"><a name="l05960"></a><span class="lineno"> 5960</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l05961"></a><span class="lineno"> 5961</span>&#160;      <a class="code" href="error__manager_8c.html#afdaf87ce30f2f557802a185ab85b6599">er_set</a> (<a class="code" href="error__manager_8h.html#a5d0d456c474e11fc70779873a30a7432ab550b3cd73fa19e9a2430d5b4552a2b1">ER_WARNING_SEVERITY</a>, <a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <a class="code" href="error__code_8h.html#a1029f54d1ce04fb5a6a02ab458663ec6">ER_LOG_HAS_TOPOPS_DURING_COMMIT_ABORT</a>, 2, tdes-&gt;<a class="code" href="structlog__tdes.html#a3baeff284ed2167bcef74c5ef34d4f3b">trid</a>,</div><div class="line"><a name="l05962"></a><span class="lineno"> 5962</span>&#160;          tdes-&gt;<a class="code" href="structlog__tdes.html#ae9437cf94e11e2307172ef5fc7b32aa9">tran_index</a>);</div><div class="line"><a name="l05963"></a><span class="lineno"> 5963</span>&#160;      <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (<span class="keyword">false</span>);</div><div class="line"><a name="l05964"></a><span class="lineno"> 5964</span>&#160;      <span class="keywordflow">while</span> (tdes-&gt;<a class="code" href="structlog__tdes.html#a97c1d42917ab4d08ffe3194fc7233018">topops</a>.<a class="code" href="structlog__topops__stack.html#a5e509dcc15d89abc0c6ba486af6dba4d">last</a> &gt;= 0)</div><div class="line"><a name="l05965"></a><span class="lineno"> 5965</span>&#160;    {</div><div class="line"><a name="l05966"></a><span class="lineno"> 5966</span>&#160;      <a class="code" href="log__manager_8c.html#a5e97a30aa978dafbca4f7180c5d3909f">log_sysop_attach_to_outer</a> (thread_p);</div><div class="line"><a name="l05967"></a><span class="lineno"> 5967</span>&#160;    }</div><div class="line"><a name="l05968"></a><span class="lineno"> 5968</span>&#160;    }</div><div class="line"><a name="l05969"></a><span class="lineno"> 5969</span>&#160;</div><div class="line"><a name="l05970"></a><span class="lineno"> 5970</span>&#160;  <a class="code" href="log__manager_8c.html#acbc3a63215e8924ed23841fb2321cd78">log_sysop_start</a> (thread_p);</div><div class="line"><a name="l05971"></a><span class="lineno"> 5971</span>&#160;</div><div class="line"><a name="l05972"></a><span class="lineno"> 5972</span>&#160;  <a class="code" href="storage__common_8h.html#a4c9bc15296fe6728cf0351726cc6ad09">LSA_COPY</a> (&amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a97c1d42917ab4d08ffe3194fc7233018">topops</a>.<a class="code" href="structlog__topops__stack.html#aeeae85de5bdc4f49b8ba730b25ab092b">stack</a>[tdes-&gt;<a class="code" href="structlog__tdes.html#a97c1d42917ab4d08ffe3194fc7233018">topops</a>.<a class="code" href="structlog__topops__stack.html#a5e509dcc15d89abc0c6ba486af6dba4d">last</a>].<a class="code" href="structlog__topops__addresses.html#afe759effcd137f8d3ecfdb7e89814e7c">lastparent_lsa</a>, savept_lsa);</div><div class="line"><a name="l05973"></a><span class="lineno"> 5973</span>&#160;</div><div class="line"><a name="l05974"></a><span class="lineno"> 5974</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="storage__common_8h.html#a26dd766712df5b5c4fcd158f571a75e4">LSA_ISNULL</a> (&amp;tdes-&gt;<a class="code" href="structlog__tdes.html#aef11834afdfbe3e8bd7f530ec269b327">posp_nxlsa</a>))</div><div class="line"><a name="l05975"></a><span class="lineno"> 5975</span>&#160;    {</div><div class="line"><a name="l05976"></a><span class="lineno"> 5976</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="storage__common_8h.html#a478797f01d6a6ad24c0203c09a639db2">LSA_LT</a> (savept_lsa, &amp;tdes-&gt;<a class="code" href="structlog__tdes.html#aef11834afdfbe3e8bd7f530ec269b327">posp_nxlsa</a>))</div><div class="line"><a name="l05977"></a><span class="lineno"> 5977</span>&#160;    {</div><div class="line"><a name="l05978"></a><span class="lineno"> 5978</span>&#160;      <a class="code" href="storage__common_8h.html#a4c9bc15296fe6728cf0351726cc6ad09">LSA_COPY</a> (&amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a97c1d42917ab4d08ffe3194fc7233018">topops</a>.<a class="code" href="structlog__topops__stack.html#aeeae85de5bdc4f49b8ba730b25ab092b">stack</a>[tdes-&gt;<a class="code" href="structlog__tdes.html#a97c1d42917ab4d08ffe3194fc7233018">topops</a>.<a class="code" href="structlog__topops__stack.html#a5e509dcc15d89abc0c6ba486af6dba4d">last</a>].<a class="code" href="structlog__topops__addresses.html#a94da18d9054fe91a3b114b4262301737">posp_lsa</a>, &amp;tdes-&gt;<a class="code" href="structlog__tdes.html#aef11834afdfbe3e8bd7f530ec269b327">posp_nxlsa</a>);</div><div class="line"><a name="l05979"></a><span class="lineno"> 5979</span>&#160;      <a class="code" href="storage__common_8h.html#a6a4baec606189dd320678e8f412ca957">LSA_SET_NULL</a> (&amp;tdes-&gt;<a class="code" href="structlog__tdes.html#aef11834afdfbe3e8bd7f530ec269b327">posp_nxlsa</a>);</div><div class="line"><a name="l05980"></a><span class="lineno"> 5980</span>&#160;    }</div><div class="line"><a name="l05981"></a><span class="lineno"> 5981</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l05982"></a><span class="lineno"> 5982</span>&#160;    {</div><div class="line"><a name="l05983"></a><span class="lineno"> 5983</span>&#160;      <a class="code" href="storage__common_8h.html#a4c9bc15296fe6728cf0351726cc6ad09">LSA_COPY</a> (&amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a97c1d42917ab4d08ffe3194fc7233018">topops</a>.<a class="code" href="structlog__topops__stack.html#aeeae85de5bdc4f49b8ba730b25ab092b">stack</a>[tdes-&gt;<a class="code" href="structlog__tdes.html#a97c1d42917ab4d08ffe3194fc7233018">topops</a>.<a class="code" href="structlog__topops__stack.html#a5e509dcc15d89abc0c6ba486af6dba4d">last</a>].<a class="code" href="structlog__topops__addresses.html#a94da18d9054fe91a3b114b4262301737">posp_lsa</a>, savept_lsa);</div><div class="line"><a name="l05984"></a><span class="lineno"> 5984</span>&#160;    }</div><div class="line"><a name="l05985"></a><span class="lineno"> 5985</span>&#160;    }</div><div class="line"><a name="l05986"></a><span class="lineno"> 5986</span>&#160;</div><div class="line"><a name="l05987"></a><span class="lineno"> 5987</span>&#160;  <a class="code" href="log__manager_8c.html#a8ba8a8666ca892dac7b456367d153965">log_sysop_abort</a> (thread_p);</div><div class="line"><a name="l05988"></a><span class="lineno"> 5988</span>&#160;</div><div class="line"><a name="l05989"></a><span class="lineno"> 5989</span>&#160;  log_cleanup_modified_class_list (thread_p, tdes, savept_lsa, <span class="keyword">false</span>, <span class="keyword">true</span>);</div><div class="line"><a name="l05990"></a><span class="lineno"> 5990</span>&#160;</div><div class="line"><a name="l05991"></a><span class="lineno"> 5991</span>&#160;  <a class="code" href="log__manager_8c.html#ab66f5229e5ed16479f13659587baef54">log_clear_lob_locator_list</a> (thread_p, tdes, <span class="keyword">false</span>, savept_lsa);</div><div class="line"><a name="l05992"></a><span class="lineno"> 5992</span>&#160;</div><div class="line"><a name="l05993"></a><span class="lineno"> 5993</span>&#160;  <span class="comment">/* </span></div><div class="line"><a name="l05994"></a><span class="lineno"> 5994</span>&#160;<span class="comment">   * The following is done so that if we go over several savepoints, they</span></div><div class="line"><a name="l05995"></a><span class="lineno"> 5995</span>&#160;<span class="comment">   * get undefined and cannot get call by the user any longer.</span></div><div class="line"><a name="l05996"></a><span class="lineno"> 5996</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l05997"></a><span class="lineno"> 5997</span>&#160;  <a class="code" href="storage__common_8h.html#a4c9bc15296fe6728cf0351726cc6ad09">LSA_COPY</a> (&amp;tdes-&gt;<a class="code" href="structlog__tdes.html#ac2dac7e98c4049c6787fccd7faf3d92a">savept_lsa</a>, savept_lsa);</div><div class="line"><a name="l05998"></a><span class="lineno"> 5998</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="log__comm_8h.html#a3c0be9b9f104459ab90ee18af95c4b3eac19d6ad89f93ec75c1e1904db0e5c0ad">TRAN_UNACTIVE_ABORTED</a>;</div><div class="line"><a name="l05999"></a><span class="lineno"> 5999</span>&#160;}</div><div class="line"><a name="l06000"></a><span class="lineno"> 6000</span>&#160;</div><div class="line"><a name="l06001"></a><span class="lineno"> 6001</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l06002"></a><span class="lineno"> 6002</span>&#160;<span class="comment"> * log_complete - Complete in commit/abort mode the transaction whenever</span></div><div class="line"><a name="l06003"></a><span class="lineno"> 6003</span>&#160;<span class="comment"> *                      is possible otherwise trasfer it to another tran index</span></div><div class="line"><a name="l06004"></a><span class="lineno"> 6004</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l06005"></a><span class="lineno"> 6005</span>&#160;<span class="comment"> * return: state of transaction</span></div><div class="line"><a name="l06006"></a><span class="lineno"> 6006</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l06007"></a><span class="lineno"> 6007</span>&#160;<span class="comment"> *   tdes(in/out): State structure of transaction of the log record</span></div><div class="line"><a name="l06008"></a><span class="lineno"> 6008</span>&#160;<span class="comment"> *   iscommitted(in): Is transaction been finished as committed ?</span></div><div class="line"><a name="l06009"></a><span class="lineno"> 6009</span>&#160;<span class="comment"> *   get_newtrid(in):</span></div><div class="line"><a name="l06010"></a><span class="lineno"> 6010</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l06011"></a><span class="lineno"> 6011</span>&#160;<span class="comment"> * NOTE: This function does not consider 2PC. </span></div><div class="line"><a name="l06012"></a><span class="lineno"> 6012</span>&#160;<span class="comment"> *       Find the existing function as log_complete_for_2pc</span></div><div class="line"><a name="l06013"></a><span class="lineno"> 6013</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l06014"></a><span class="lineno"> 6014</span>&#160;<a class="code" href="log__comm_8h.html#a3c0be9b9f104459ab90ee18af95c4b3e">TRAN_STATE</a></div><div class="line"><a name="l06015"></a><span class="lineno"><a class="line" href="log__manager_8h.html#a205cb9f31defd227b8340f7f4bd24a09"> 6015</a></span>&#160;<a class="code" href="log__manager_8c.html#a205cb9f31defd227b8340f7f4bd24a09">log_complete</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="structlog__tdes.html">LOG_TDES</a> * tdes, <a class="code" href="log__impl_8h.html#ab85dbe80b115a32bf7a430c32ddc5b8b">LOG_RECTYPE</a> iscommitted, <a class="code" href="log__impl_8h.html#a9ccf9110ba2ff23abcdad35e144269b8">LOG_GETNEWTRID</a> get_newtrid,</div><div class="line"><a name="l06016"></a><span class="lineno"> 6016</span>&#160;          <a class="code" href="log__impl_8h.html#aad53b9bfa046f25c2c4bd187223ecf85">LOG_WRITE_EOT_LOG</a> wrote_eot_log)</div><div class="line"><a name="l06017"></a><span class="lineno"> 6017</span>&#160;{</div><div class="line"><a name="l06018"></a><span class="lineno"> 6018</span>&#160;  <a class="code" href="log__comm_8h.html#a3c0be9b9f104459ab90ee18af95c4b3e">TRAN_STATE</a> state;     <span class="comment">/* State of transaction */</span></div><div class="line"><a name="l06019"></a><span class="lineno"> 6019</span>&#160;</div><div class="line"><a name="l06020"></a><span class="lineno"> 6020</span>&#160;  <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (iscommitted == <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a1903de7cf7fa88081eb8010a667e1839">LOG_COMMIT</a> || iscommitted == <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a66f7a15b57486fb9081e733c142d35ea">LOG_ABORT</a>);</div><div class="line"><a name="l06021"></a><span class="lineno"> 6021</span>&#160;  <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (!<a class="code" href="vacuum_8h.html#ab0e1deb8da1aa663aa073b0ce78606a2">VACUUM_IS_THREAD_VACUUM</a> (thread_p));</div><div class="line"><a name="l06022"></a><span class="lineno"> 6022</span>&#160;</div><div class="line"><a name="l06023"></a><span class="lineno"> 6023</span>&#160;  state = tdes-&gt;<a class="code" href="structlog__tdes.html#ad924146690490b840ef5c3f65c3a5a6c">state</a>;</div><div class="line"><a name="l06024"></a><span class="lineno"> 6024</span>&#160;</div><div class="line"><a name="l06025"></a><span class="lineno"> 6025</span>&#160;  <span class="comment">/* </span></div><div class="line"><a name="l06026"></a><span class="lineno"> 6026</span>&#160;<span class="comment">   * DECLARE THE TRANSACTION AS COMPLETED</span></div><div class="line"><a name="l06027"></a><span class="lineno"> 6027</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l06028"></a><span class="lineno"> 6028</span>&#160;</div><div class="line"><a name="l06029"></a><span class="lineno"> 6029</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="storage__common_8h.html#a26dd766712df5b5c4fcd158f571a75e4">LSA_ISNULL</a> (&amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a5b128a08476a5b499cf82e3163e6d62b">tail_lsa</a>))</div><div class="line"><a name="l06030"></a><span class="lineno"> 6030</span>&#160;    {</div><div class="line"><a name="l06031"></a><span class="lineno"> 6031</span>&#160;      <span class="comment">/* Transaction did not update any data, thus we do not need to log a commit/abort log record. */</span></div><div class="line"><a name="l06032"></a><span class="lineno"> 6032</span>&#160;      <span class="keywordflow">if</span> (iscommitted == <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a1903de7cf7fa88081eb8010a667e1839">LOG_COMMIT</a>)</div><div class="line"><a name="l06033"></a><span class="lineno"> 6033</span>&#160;    {</div><div class="line"><a name="l06034"></a><span class="lineno"> 6034</span>&#160;      state = <a class="code" href="log__comm_8h.html#a3c0be9b9f104459ab90ee18af95c4b3ea6ddb25e9eb5bdd0477b4da46f8edcaba">TRAN_UNACTIVE_COMMITTED</a>;</div><div class="line"><a name="l06035"></a><span class="lineno"> 6035</span>&#160;    }</div><div class="line"><a name="l06036"></a><span class="lineno"> 6036</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l06037"></a><span class="lineno"> 6037</span>&#160;    {</div><div class="line"><a name="l06038"></a><span class="lineno"> 6038</span>&#160;      state = <a class="code" href="log__comm_8h.html#a3c0be9b9f104459ab90ee18af95c4b3eac19d6ad89f93ec75c1e1904db0e5c0ad">TRAN_UNACTIVE_ABORTED</a>;</div><div class="line"><a name="l06039"></a><span class="lineno"> 6039</span>&#160;    }</div><div class="line"><a name="l06040"></a><span class="lineno"> 6040</span>&#160;</div><div class="line"><a name="l06041"></a><span class="lineno"> 6041</span>&#160;      <a class="code" href="log__impl_8h.html#a6c5edebbae75e1a92360baf780ce8377">logtb_clear_tdes</a> (thread_p, tdes);</div><div class="line"><a name="l06042"></a><span class="lineno"> 6042</span>&#160;    }</div><div class="line"><a name="l06043"></a><span class="lineno"> 6043</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l06044"></a><span class="lineno"> 6044</span>&#160;    {</div><div class="line"><a name="l06045"></a><span class="lineno"> 6045</span>&#160;      <span class="comment">/* </span></div><div class="line"><a name="l06046"></a><span class="lineno"> 6046</span>&#160;<span class="comment">       * Transaction updated data </span></div><div class="line"><a name="l06047"></a><span class="lineno"> 6047</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l06048"></a><span class="lineno"> 6048</span>&#160;      <span class="keywordflow">if</span> (wrote_eot_log == <a class="code" href="log__impl_8h.html#af65c435e9509efe8e005c094e49a0b2fa64ac1d15aa4fce7a8d40eeb22a4b95cd">LOG_NEED_TO_WRITE_EOT_LOG</a>)</div><div class="line"><a name="l06049"></a><span class="lineno"> 6049</span>&#160;    {</div><div class="line"><a name="l06050"></a><span class="lineno"> 6050</span>&#160;      <span class="keywordflow">if</span> (iscommitted == <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a1903de7cf7fa88081eb8010a667e1839">LOG_COMMIT</a>)</div><div class="line"><a name="l06051"></a><span class="lineno"> 6051</span>&#160;        {</div><div class="line"><a name="l06052"></a><span class="lineno"> 6052</span>&#160;          <a class="code" href="structlog__lsa.html">LOG_LSA</a> commit_lsa;</div><div class="line"><a name="l06053"></a><span class="lineno"> 6053</span>&#160;</div><div class="line"><a name="l06054"></a><span class="lineno"> 6054</span>&#160;          log_append_commit_log (thread_p, tdes, &amp;commit_lsa);</div><div class="line"><a name="l06055"></a><span class="lineno"> 6055</span>&#160;          log_change_tran_as_completed (thread_p, tdes, <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a1903de7cf7fa88081eb8010a667e1839">LOG_COMMIT</a>, &amp;commit_lsa);</div><div class="line"><a name="l06056"></a><span class="lineno"> 6056</span>&#160;        }</div><div class="line"><a name="l06057"></a><span class="lineno"> 6057</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l06058"></a><span class="lineno"> 6058</span>&#160;        {</div><div class="line"><a name="l06059"></a><span class="lineno"> 6059</span>&#160;          <a class="code" href="structlog__lsa.html">LOG_LSA</a> abort_lsa;</div><div class="line"><a name="l06060"></a><span class="lineno"> 6060</span>&#160;</div><div class="line"><a name="l06061"></a><span class="lineno"> 6061</span>&#160;          log_append_abort_log (thread_p, tdes, &amp;abort_lsa);</div><div class="line"><a name="l06062"></a><span class="lineno"> 6062</span>&#160;          log_change_tran_as_completed (thread_p, tdes, <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a66f7a15b57486fb9081e733c142d35ea">LOG_ABORT</a>, &amp;abort_lsa);</div><div class="line"><a name="l06063"></a><span class="lineno"> 6063</span>&#160;        }</div><div class="line"><a name="l06064"></a><span class="lineno"> 6064</span>&#160;</div><div class="line"><a name="l06065"></a><span class="lineno"> 6065</span>&#160;      state = tdes-&gt;<a class="code" href="structlog__tdes.html#ad924146690490b840ef5c3f65c3a5a6c">state</a>;</div><div class="line"><a name="l06066"></a><span class="lineno"> 6066</span>&#160;    }</div><div class="line"><a name="l06067"></a><span class="lineno"> 6067</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l06068"></a><span class="lineno"> 6068</span>&#160;    {</div><div class="line"><a name="l06069"></a><span class="lineno"> 6069</span>&#160;      <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (iscommitted == <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a1903de7cf7fa88081eb8010a667e1839">LOG_COMMIT</a> &amp;&amp; state == <a class="code" href="log__comm_8h.html#a3c0be9b9f104459ab90ee18af95c4b3ea6ddb25e9eb5bdd0477b4da46f8edcaba">TRAN_UNACTIVE_COMMITTED</a>);</div><div class="line"><a name="l06070"></a><span class="lineno"> 6070</span>&#160;    }</div><div class="line"><a name="l06071"></a><span class="lineno"> 6071</span>&#160;</div><div class="line"><a name="l06072"></a><span class="lineno"> 6072</span>&#160;      <span class="comment">/* Unblock global oldest active update. */</span></div><div class="line"><a name="l06073"></a><span class="lineno"> 6073</span>&#160;      <span class="keywordflow">if</span> (tdes-&gt;<a class="code" href="structlog__tdes.html#a81f8323632791e9ca56aa0b1ba838609">block_global_oldest_active_until_commit</a>)</div><div class="line"><a name="l06074"></a><span class="lineno"> 6074</span>&#160;    {</div><div class="line"><a name="l06075"></a><span class="lineno"> 6075</span>&#160;      ATOMIC_INC_32 (&amp;<a class="code" href="log__manager_8c.html#a3ecc2751989b36deb454d7a32e1ee5b8">vacuum_Global_oldest_active_blockers_counter</a>, -1);</div><div class="line"><a name="l06076"></a><span class="lineno"> 6076</span>&#160;      tdes-&gt;<a class="code" href="structlog__tdes.html#a81f8323632791e9ca56aa0b1ba838609">block_global_oldest_active_until_commit</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l06077"></a><span class="lineno"> 6077</span>&#160;      <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (<a class="code" href="log__manager_8c.html#a3ecc2751989b36deb454d7a32e1ee5b8">vacuum_Global_oldest_active_blockers_counter</a> &gt;= 0);</div><div class="line"><a name="l06078"></a><span class="lineno"> 6078</span>&#160;    }</div><div class="line"><a name="l06079"></a><span class="lineno"> 6079</span>&#160;</div><div class="line"><a name="l06080"></a><span class="lineno"> 6080</span>&#160;<span class="preprocessor">#if defined (HAVE_ATOMIC_BUILTINS)</span></div><div class="line"><a name="l06081"></a><span class="lineno"> 6081</span>&#160;      <span class="keywordflow">if</span> (iscommitted == <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a1903de7cf7fa88081eb8010a667e1839">LOG_COMMIT</a>)</div><div class="line"><a name="l06082"></a><span class="lineno"> 6082</span>&#160;    {</div><div class="line"><a name="l06083"></a><span class="lineno"> 6083</span>&#160;      <span class="keywordtype">int</span> tran_index = <a class="code" href="perf__monitor_8h.html#a55d27b01d605ba6ee2929ddfe8588320">LOG_FIND_THREAD_TRAN_INDEX</a> (thread_p);</div><div class="line"><a name="l06084"></a><span class="lineno"> 6084</span>&#160;      <span class="keyword">volatile</span> <a class="code" href="storage__common_8h.html#a6cdffe739d5149557924b03acf945d1c">MVCCID</a> *p_transaction_lowest_active_mvccid = <a class="code" href="log__impl_8h.html#afcfc70a06711e89b04a4cbd09ecba5d1">LOG_FIND_TRAN_LOWEST_ACTIVE_MVCCID</a> (tran_index);</div><div class="line"><a name="l06085"></a><span class="lineno"> 6085</span>&#160;</div><div class="line"><a name="l06086"></a><span class="lineno"> 6086</span>&#160;      <span class="keywordflow">if</span> (*p_transaction_lowest_active_mvccid != <a class="code" href="storage__common_8h.html#afd0bb266f6811f0eef1f13a2d4a2d175">MVCCID_NULL</a>)</div><div class="line"><a name="l06087"></a><span class="lineno"> 6087</span>&#160;        {</div><div class="line"><a name="l06088"></a><span class="lineno"> 6088</span>&#160;          <span class="comment">/* set transaction lowest active MVCCID to null to allow VACUUM advancing */</span></div><div class="line"><a name="l06089"></a><span class="lineno"> 6089</span>&#160;          ATOMIC_TAS_64 (p_transaction_lowest_active_mvccid, <a class="code" href="storage__common_8h.html#afd0bb266f6811f0eef1f13a2d4a2d175">MVCCID_NULL</a>);</div><div class="line"><a name="l06090"></a><span class="lineno"> 6090</span>&#160;        }</div><div class="line"><a name="l06091"></a><span class="lineno"> 6091</span>&#160;    }</div><div class="line"><a name="l06092"></a><span class="lineno"> 6092</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l06093"></a><span class="lineno"> 6093</span>&#160;</div><div class="line"><a name="l06094"></a><span class="lineno"> 6094</span>&#160;      <span class="keywordflow">if</span> (get_newtrid == <a class="code" href="log__impl_8h.html#ab0c98093893d496bd3c00c6825c3941bacf3113fe0ba179d76a1bbae698248c79">LOG_NEED_NEWTRID</a>)</div><div class="line"><a name="l06095"></a><span class="lineno"> 6095</span>&#160;    {</div><div class="line"><a name="l06096"></a><span class="lineno"> 6096</span>&#160;      (void) <a class="code" href="log__impl_8h.html#a0e075f8cf3a95dd3685eaaa9890335dc">logtb_get_new_tran_id</a> (thread_p, tdes);</div><div class="line"><a name="l06097"></a><span class="lineno"> 6097</span>&#160;    }</div><div class="line"><a name="l06098"></a><span class="lineno"> 6098</span>&#160;</div><div class="line"><a name="l06099"></a><span class="lineno"> 6099</span>&#160;      <span class="comment">/* Finish the append operation and flush the log */</span></div><div class="line"><a name="l06100"></a><span class="lineno"> 6100</span>&#160;    }</div><div class="line"><a name="l06101"></a><span class="lineno"> 6101</span>&#160;</div><div class="line"><a name="l06102"></a><span class="lineno"> 6102</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="log__manager_8c.html#aff0ddf74133f090a894a4b4b68b7acb6">LOG_ISCHECKPOINT_TIME</a> ())</div><div class="line"><a name="l06103"></a><span class="lineno"> 6103</span>&#160;    {</div><div class="line"><a name="l06104"></a><span class="lineno"> 6104</span>&#160;<span class="preprocessor">#if defined(SERVER_MODE)</span></div><div class="line"><a name="l06105"></a><span class="lineno"> 6105</span>&#160;      <a class="code" href="log__manager_8h.html#a6160ad5bb57554497e3183a7d61b3598">log_wakeup_checkpoint_daemon</a> ();</div><div class="line"><a name="l06106"></a><span class="lineno"> 6106</span>&#160;<span class="preprocessor">#else </span><span class="comment">/* SERVER_MODE */</span><span class="preprocessor"></span></div><div class="line"><a name="l06107"></a><span class="lineno"> 6107</span>&#160;      (void) <a class="code" href="log__impl_8h.html#a3afa13fd96a09f0686e865e34d4ba415">logpb_checkpoint</a> (thread_p);</div><div class="line"><a name="l06108"></a><span class="lineno"> 6108</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* SERVER_MODE */</span><span class="preprocessor"></span></div><div class="line"><a name="l06109"></a><span class="lineno"> 6109</span>&#160;    }</div><div class="line"><a name="l06110"></a><span class="lineno"> 6110</span>&#160;</div><div class="line"><a name="l06111"></a><span class="lineno"> 6111</span>&#160;  <span class="keywordflow">return</span> state;</div><div class="line"><a name="l06112"></a><span class="lineno"> 6112</span>&#160;}</div><div class="line"><a name="l06113"></a><span class="lineno"> 6113</span>&#160;</div><div class="line"><a name="l06114"></a><span class="lineno"> 6114</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l06115"></a><span class="lineno"> 6115</span>&#160;<span class="comment"> * log_complete_for_2pc - Complete in commit/abort mode the transaction whenever</span></div><div class="line"><a name="l06116"></a><span class="lineno"> 6116</span>&#160;<span class="comment"> *                      is possible otherwise trasfer it to another tran index</span></div><div class="line"><a name="l06117"></a><span class="lineno"> 6117</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l06118"></a><span class="lineno"> 6118</span>&#160;<span class="comment"> * return: state of transaction</span></div><div class="line"><a name="l06119"></a><span class="lineno"> 6119</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l06120"></a><span class="lineno"> 6120</span>&#160;<span class="comment"> *   tdes(in/out): State structure of transaction of the log record</span></div><div class="line"><a name="l06121"></a><span class="lineno"> 6121</span>&#160;<span class="comment"> *   iscommitted(in): Is transaction been finished as committed ?</span></div><div class="line"><a name="l06122"></a><span class="lineno"> 6122</span>&#160;<span class="comment"> *   get_newtrid(in):</span></div><div class="line"><a name="l06123"></a><span class="lineno"> 6123</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l06124"></a><span class="lineno"> 6124</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l06125"></a><span class="lineno"> 6125</span>&#160;<a class="code" href="log__comm_8h.html#a3c0be9b9f104459ab90ee18af95c4b3e">TRAN_STATE</a></div><div class="line"><a name="l06126"></a><span class="lineno"><a class="line" href="log__manager_8h.html#a6e6203b82cc1468c2d16162ec6796aff"> 6126</a></span>&#160;<a class="code" href="log__manager_8c.html#a6e6203b82cc1468c2d16162ec6796aff">log_complete_for_2pc</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="structlog__tdes.html">LOG_TDES</a> * tdes, <a class="code" href="log__impl_8h.html#ab85dbe80b115a32bf7a430c32ddc5b8b">LOG_RECTYPE</a> iscommitted, <a class="code" href="log__impl_8h.html#a9ccf9110ba2ff23abcdad35e144269b8">LOG_GETNEWTRID</a> get_newtrid)</div><div class="line"><a name="l06127"></a><span class="lineno"> 6127</span>&#160;{</div><div class="line"><a name="l06128"></a><span class="lineno"> 6128</span>&#160;  <a class="code" href="log__comm_8h.html#a3c0be9b9f104459ab90ee18af95c4b3e">TRAN_STATE</a> state;     <span class="comment">/* State of transaction */</span></div><div class="line"><a name="l06129"></a><span class="lineno"> 6129</span>&#160;  <span class="keywordtype">int</span> new_tran_index;</div><div class="line"><a name="l06130"></a><span class="lineno"> 6130</span>&#160;  <a class="code" href="structlog__tdes.html">LOG_TDES</a> *new_tdes;       <span class="comment">/* New transaction descriptor when the transaction is transfered since the 2PC cannot</span></div><div class="line"><a name="l06131"></a><span class="lineno"> 6131</span>&#160;<span class="comment">                 * be fully completed at this moment */</span></div><div class="line"><a name="l06132"></a><span class="lineno"> 6132</span>&#160;  <span class="keywordtype">int</span> return_2pc_loose_tranindex;   <span class="comment">/* Whether or not to return the current index */</span></div><div class="line"><a name="l06133"></a><span class="lineno"> 6133</span>&#160;  <span class="keywordtype">bool</span> all_acks = <span class="keyword">true</span>;</div><div class="line"><a name="l06134"></a><span class="lineno"> 6134</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div><div class="line"><a name="l06135"></a><span class="lineno"> 6135</span>&#160;  <a class="code" href="structlog__prior__node.html">LOG_PRIOR_NODE</a> *<a class="code" href="external_2include_2queue_8h.html#a465e28dbd1a1c60ff504d3ea275613ed">node</a>;</div><div class="line"><a name="l06136"></a><span class="lineno"> 6136</span>&#160;  <a class="code" href="structlog__lsa.html">LOG_LSA</a> start_lsa;</div><div class="line"><a name="l06137"></a><span class="lineno"> 6137</span>&#160;  <span class="keywordtype">int</span> wait_msecs;</div><div class="line"><a name="l06138"></a><span class="lineno"> 6138</span>&#160;</div><div class="line"><a name="l06139"></a><span class="lineno"> 6139</span>&#160;  <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (iscommitted == <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a1903de7cf7fa88081eb8010a667e1839">LOG_COMMIT</a> || iscommitted == <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a66f7a15b57486fb9081e733c142d35ea">LOG_ABORT</a>);</div><div class="line"><a name="l06140"></a><span class="lineno"> 6140</span>&#160;</div><div class="line"><a name="l06141"></a><span class="lineno"> 6141</span>&#160;  state = tdes-&gt;<a class="code" href="structlog__tdes.html#ad924146690490b840ef5c3f65c3a5a6c">state</a>;</div><div class="line"><a name="l06142"></a><span class="lineno"> 6142</span>&#160;</div><div class="line"><a name="l06143"></a><span class="lineno"> 6143</span>&#160;  <span class="keywordflow">if</span> (tdes-&gt;<a class="code" href="structlog__tdes.html#a13da289398281e91e89ab374b3c17936">coord</a> != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> &amp;&amp; tdes-&gt;<a class="code" href="structlog__tdes.html#a13da289398281e91e89ab374b3c17936">coord</a>-&gt;<a class="code" href="structlog__2pc__coordinator.html#a8a6d9a179baa8194a02bd804e2c8c0cd">ack_received</a> != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l06144"></a><span class="lineno"> 6144</span>&#160;    {</div><div class="line"><a name="l06145"></a><span class="lineno"> 6145</span>&#160;      <span class="comment">/* </span></div><div class="line"><a name="l06146"></a><span class="lineno"> 6146</span>&#160;<span class="comment">       * Make sure that all acknowledgments from participants have been received</span></div><div class="line"><a name="l06147"></a><span class="lineno"> 6147</span>&#160;<span class="comment">       * before declaring the transaction as finished.</span></div><div class="line"><a name="l06148"></a><span class="lineno"> 6148</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l06149"></a><span class="lineno"> 6149</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; tdes-&gt;<a class="code" href="structlog__tdes.html#a13da289398281e91e89ab374b3c17936">coord</a>-&gt;<a class="code" href="structlog__2pc__coordinator.html#aef73165750bf09cf443c6b363ab02965">num_particps</a>; <a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l06150"></a><span class="lineno"> 6150</span>&#160;    {</div><div class="line"><a name="l06151"></a><span class="lineno"> 6151</span>&#160;      <span class="keywordflow">if</span> (tdes-&gt;<a class="code" href="structlog__tdes.html#a13da289398281e91e89ab374b3c17936">coord</a>-&gt;<a class="code" href="structlog__2pc__coordinator.html#a8a6d9a179baa8194a02bd804e2c8c0cd">ack_received</a>[<a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>] == <span class="keyword">false</span>)</div><div class="line"><a name="l06152"></a><span class="lineno"> 6152</span>&#160;        {</div><div class="line"><a name="l06153"></a><span class="lineno"> 6153</span>&#160;          all_acks = <span class="keyword">false</span>;</div><div class="line"><a name="l06154"></a><span class="lineno"> 6154</span>&#160;          <span class="comment">/* </span></div><div class="line"><a name="l06155"></a><span class="lineno"> 6155</span>&#160;<span class="comment">           * There are missing acknowledgments. The transaction cannot be</span></div><div class="line"><a name="l06156"></a><span class="lineno"> 6156</span>&#160;<span class="comment">           * completed at this moment. If we are not in the restart recovery</span></div><div class="line"><a name="l06157"></a><span class="lineno"> 6157</span>&#160;<span class="comment">           * process, the transaction is transfered to another transaction</span></div><div class="line"><a name="l06158"></a><span class="lineno"> 6158</span>&#160;<span class="comment">           * index which is declared as a distributed loose end and a new</span></div><div class="line"><a name="l06159"></a><span class="lineno"> 6159</span>&#160;<span class="comment">           * transaction is assigned to the client transaction index. The</span></div><div class="line"><a name="l06160"></a><span class="lineno"> 6160</span>&#160;<span class="comment">           * transaction will be declared as fully completed once all</span></div><div class="line"><a name="l06161"></a><span class="lineno"> 6161</span>&#160;<span class="comment">           * acknowledgment are received.</span></div><div class="line"><a name="l06162"></a><span class="lineno"> 6162</span>&#160;<span class="comment">           */</span></div><div class="line"><a name="l06163"></a><span class="lineno"> 6163</span>&#160;          <span class="keywordflow">if</span> (iscommitted != <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a66f7a15b57486fb9081e733c142d35ea">LOG_ABORT</a>)</div><div class="line"><a name="l06164"></a><span class="lineno"> 6164</span>&#160;        {</div><div class="line"><a name="l06165"></a><span class="lineno"> 6165</span>&#160;          <span class="comment">/* Committed */</span></div><div class="line"><a name="l06166"></a><span class="lineno"> 6166</span>&#160;          <span class="keywordflow">if</span> (tdes-&gt;<a class="code" href="structlog__tdes.html#ad924146690490b840ef5c3f65c3a5a6c">state</a> != <a class="code" href="log__comm_8h.html#a3c0be9b9f104459ab90ee18af95c4b3ea476b9d64087d43ced76a1534a089fbcd">TRAN_UNACTIVE_COMMITTED_INFORMING_PARTICIPANTS</a>)</div><div class="line"><a name="l06167"></a><span class="lineno"> 6167</span>&#160;            {</div><div class="line"><a name="l06168"></a><span class="lineno"> 6168</span>&#160;              <a class="code" href="structnodeptr.html">node</a> =</div><div class="line"><a name="l06169"></a><span class="lineno"> 6169</span>&#160;            <a class="code" href="log__impl_8h.html#a2b616997f446dcb588a6addcc65cf5b7">prior_lsa_alloc_and_copy_data</a> (thread_p, <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a1ea8bf762d53de919a4eec322ebe9a1d">LOG_2PC_COMMIT_INFORM_PARTICPS</a>, <a class="code" href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2ba6ea83d694355ec2c529960461a086f26">RV_NOT_DEFINED</a>, <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,</div><div class="line"><a name="l06170"></a><span class="lineno"> 6170</span>&#160;                               0, <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l06171"></a><span class="lineno"> 6171</span>&#160;              <span class="keywordflow">if</span> (<a class="code" href="structnodeptr.html">node</a> == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l06172"></a><span class="lineno"> 6172</span>&#160;            {</div><div class="line"><a name="l06173"></a><span class="lineno"> 6173</span>&#160;              <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (<span class="keyword">false</span>);</div><div class="line"><a name="l06174"></a><span class="lineno"> 6174</span>&#160;              <span class="keywordflow">return</span> state;</div><div class="line"><a name="l06175"></a><span class="lineno"> 6175</span>&#160;            }</div><div class="line"><a name="l06176"></a><span class="lineno"> 6176</span>&#160;</div><div class="line"><a name="l06177"></a><span class="lineno"> 6177</span>&#160;              tdes-&gt;<a class="code" href="structlog__tdes.html#ad924146690490b840ef5c3f65c3a5a6c">state</a> = <a class="code" href="log__comm_8h.html#a3c0be9b9f104459ab90ee18af95c4b3ea476b9d64087d43ced76a1534a089fbcd">TRAN_UNACTIVE_COMMITTED_INFORMING_PARTICIPANTS</a>;</div><div class="line"><a name="l06178"></a><span class="lineno"> 6178</span>&#160;              state = tdes-&gt;<a class="code" href="structlog__tdes.html#ad924146690490b840ef5c3f65c3a5a6c">state</a>;</div><div class="line"><a name="l06179"></a><span class="lineno"> 6179</span>&#160;</div><div class="line"><a name="l06180"></a><span class="lineno"> 6180</span>&#160;              start_lsa = <a class="code" href="log__impl_8h.html#a8a3ce7b7aa59fe26c04eca3577e434e8">prior_lsa_next_record</a> (thread_p, <a class="code" href="structnodeptr.html">node</a>, tdes);</div><div class="line"><a name="l06181"></a><span class="lineno"> 6181</span>&#160;</div><div class="line"><a name="l06182"></a><span class="lineno"> 6182</span>&#160;              <a class="code" href="log__impl_8h.html#aa91abaf89af63e703737ac5c00d7cd7d">logpb_flush_pages</a> (thread_p, &amp;start_lsa);</div><div class="line"><a name="l06183"></a><span class="lineno"> 6183</span>&#160;            }</div><div class="line"><a name="l06184"></a><span class="lineno"> 6184</span>&#160;        }</div><div class="line"><a name="l06185"></a><span class="lineno"> 6185</span>&#160;          <span class="keywordflow">else</span></div><div class="line"><a name="l06186"></a><span class="lineno"> 6186</span>&#160;        {</div><div class="line"><a name="l06187"></a><span class="lineno"> 6187</span>&#160;          <span class="comment">/* aborted */</span></div><div class="line"><a name="l06188"></a><span class="lineno"> 6188</span>&#160;          <span class="keywordflow">if</span> (tdes-&gt;<a class="code" href="structlog__tdes.html#ad924146690490b840ef5c3f65c3a5a6c">state</a> != <a class="code" href="log__comm_8h.html#a3c0be9b9f104459ab90ee18af95c4b3ea0eb30d00abe6035a862198e833cc4f76">TRAN_UNACTIVE_ABORTED_INFORMING_PARTICIPANTS</a>)</div><div class="line"><a name="l06189"></a><span class="lineno"> 6189</span>&#160;            {</div><div class="line"><a name="l06190"></a><span class="lineno"> 6190</span>&#160;              <a class="code" href="structnodeptr.html">node</a> =</div><div class="line"><a name="l06191"></a><span class="lineno"> 6191</span>&#160;            <a class="code" href="log__impl_8h.html#a2b616997f446dcb588a6addcc65cf5b7">prior_lsa_alloc_and_copy_data</a> (thread_p, <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a017e6014fefb381f8583c7ccd87c4133">LOG_2PC_ABORT_INFORM_PARTICPS</a>, <a class="code" href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2ba6ea83d694355ec2c529960461a086f26">RV_NOT_DEFINED</a>, <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0,</div><div class="line"><a name="l06192"></a><span class="lineno"> 6192</span>&#160;                               <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, 0, <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l06193"></a><span class="lineno"> 6193</span>&#160;              <span class="keywordflow">if</span> (<a class="code" href="structnodeptr.html">node</a> == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l06194"></a><span class="lineno"> 6194</span>&#160;            {</div><div class="line"><a name="l06195"></a><span class="lineno"> 6195</span>&#160;              <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (<span class="keyword">false</span>);</div><div class="line"><a name="l06196"></a><span class="lineno"> 6196</span>&#160;              <span class="keywordflow">return</span> state;</div><div class="line"><a name="l06197"></a><span class="lineno"> 6197</span>&#160;            }</div><div class="line"><a name="l06198"></a><span class="lineno"> 6198</span>&#160;</div><div class="line"><a name="l06199"></a><span class="lineno"> 6199</span>&#160;              tdes-&gt;<a class="code" href="structlog__tdes.html#ad924146690490b840ef5c3f65c3a5a6c">state</a> = <a class="code" href="log__comm_8h.html#a3c0be9b9f104459ab90ee18af95c4b3ea0eb30d00abe6035a862198e833cc4f76">TRAN_UNACTIVE_ABORTED_INFORMING_PARTICIPANTS</a>;</div><div class="line"><a name="l06200"></a><span class="lineno"> 6200</span>&#160;              state = tdes-&gt;<a class="code" href="structlog__tdes.html#ad924146690490b840ef5c3f65c3a5a6c">state</a>;</div><div class="line"><a name="l06201"></a><span class="lineno"> 6201</span>&#160;</div><div class="line"><a name="l06202"></a><span class="lineno"> 6202</span>&#160;              start_lsa = <a class="code" href="log__impl_8h.html#a8a3ce7b7aa59fe26c04eca3577e434e8">prior_lsa_next_record</a> (thread_p, <a class="code" href="structnodeptr.html">node</a>, tdes);</div><div class="line"><a name="l06203"></a><span class="lineno"> 6203</span>&#160;</div><div class="line"><a name="l06204"></a><span class="lineno"> 6204</span>&#160;              <a class="code" href="log__impl_8h.html#aa91abaf89af63e703737ac5c00d7cd7d">logpb_flush_pages</a> (thread_p, &amp;start_lsa);</div><div class="line"><a name="l06205"></a><span class="lineno"> 6205</span>&#160;            }</div><div class="line"><a name="l06206"></a><span class="lineno"> 6206</span>&#160;        }</div><div class="line"><a name="l06207"></a><span class="lineno"> 6207</span>&#160;          <span class="comment">/* </span></div><div class="line"><a name="l06208"></a><span class="lineno"> 6208</span>&#160;<span class="comment">           * If this is not a loose end transaction and the system is not</span></div><div class="line"><a name="l06209"></a><span class="lineno"> 6209</span>&#160;<span class="comment">           * in restart recovery, transfer the transaction to another</span></div><div class="line"><a name="l06210"></a><span class="lineno"> 6210</span>&#160;<span class="comment">           * transaction index</span></div><div class="line"><a name="l06211"></a><span class="lineno"> 6211</span>&#160;<span class="comment">           */</span></div><div class="line"><a name="l06212"></a><span class="lineno"> 6212</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="log__impl_8h.html#a8f08025b469332f89fee8ce83dc2d3ff">LOG_ISRESTARTED</a> () &amp;&amp; tdes-&gt;<a class="code" href="structlog__tdes.html#a21b2b5a56efdbf3078c64649dc6a548c">isloose_end</a> == <span class="keyword">false</span>)</div><div class="line"><a name="l06213"></a><span class="lineno"> 6213</span>&#160;        {</div><div class="line"><a name="l06214"></a><span class="lineno"> 6214</span>&#160;          wait_msecs = <a class="code" href="system__parameter_8c.html#aae71e771e08cd2d0452c346650a8da98">prm_get_integer_value</a> (<a class="code" href="system__parameter_8h.html#a23aaf6bca406b9b428f43ad1b6b2b3e0afcaa557b00069f4903d605c4d0435e39">PRM_ID_LK_TIMEOUT_SECS</a>);</div><div class="line"><a name="l06215"></a><span class="lineno"> 6215</span>&#160;</div><div class="line"><a name="l06216"></a><span class="lineno"> 6216</span>&#160;          <span class="keywordflow">if</span> (wait_msecs &gt; 0)</div><div class="line"><a name="l06217"></a><span class="lineno"> 6217</span>&#160;            {</div><div class="line"><a name="l06218"></a><span class="lineno"> 6218</span>&#160;              wait_msecs = wait_msecs * 1000;</div><div class="line"><a name="l06219"></a><span class="lineno"> 6219</span>&#160;            }</div><div class="line"><a name="l06220"></a><span class="lineno"> 6220</span>&#160;          new_tran_index =</div><div class="line"><a name="l06221"></a><span class="lineno"> 6221</span>&#160;            <a class="code" href="log__impl_8h.html#a2009f11bd300ce6fb8b2901332593f28">logtb_assign_tran_index</a> (thread_p, <a class="code" href="storage__common_8h.html#a65e269153dcbaf685a77e98b007b6a19">NULL_TRANID</a>, <a class="code" href="log__comm_8h.html#a3c0be9b9f104459ab90ee18af95c4b3ea4e0d5b2bf0b5b43452dfaf5618a149aa">TRAN_RECOVERY</a>, <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, wait_msecs,</div><div class="line"><a name="l06222"></a><span class="lineno"> 6222</span>&#160;                         <a class="code" href="cas__cci_8h.html#a0d4ade6def04e94015e9bf647f0a2d73a0d30deada26a110df6d7f81dbddb7470">TRAN_SERIALIZABLE</a>);</div><div class="line"><a name="l06223"></a><span class="lineno"> 6223</span>&#160;          new_tdes = <a class="code" href="log__impl_8h.html#a08fee41cfcf592e8afdbc4988ffbc8e4">LOG_FIND_TDES</a> (new_tran_index);</div><div class="line"><a name="l06224"></a><span class="lineno"> 6224</span>&#160;          <span class="keywordflow">if</span> (new_tran_index == <a class="code" href="storage__common_8h.html#ab6db6dc2e50e5821d2b8cdbfdeee71ef">NULL_TRAN_INDEX</a> || new_tdes == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l06225"></a><span class="lineno"> 6225</span>&#160;            {</div><div class="line"><a name="l06226"></a><span class="lineno"> 6226</span>&#160;              <a class="code" href="log__impl_8h.html#a8e111eafc27b6e1383fbd0ee812b1167">logpb_fatal_error</a> (thread_p, <span class="keyword">true</span>, <a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <span class="stringliteral">&quot;log_fully_completed&quot;</span>);</div><div class="line"><a name="l06227"></a><span class="lineno"> 6227</span>&#160;              <span class="keywordflow">return</span> state;</div><div class="line"><a name="l06228"></a><span class="lineno"> 6228</span>&#160;            }</div><div class="line"><a name="l06229"></a><span class="lineno"> 6229</span>&#160;</div><div class="line"><a name="l06230"></a><span class="lineno"> 6230</span>&#160;          <span class="comment">/* </span></div><div class="line"><a name="l06231"></a><span class="lineno"> 6231</span>&#160;<span class="comment">           * Copy of tdes structures, and then reset memory allocated fields</span></div><div class="line"><a name="l06232"></a><span class="lineno"> 6232</span>&#160;<span class="comment">           * for only one the new or the old one.</span></div><div class="line"><a name="l06233"></a><span class="lineno"> 6233</span>&#160;<span class="comment">           */</span></div><div class="line"><a name="l06234"></a><span class="lineno"> 6234</span>&#160;</div><div class="line"><a name="l06235"></a><span class="lineno"> 6235</span>&#160;          *new_tdes = *tdes;</div><div class="line"><a name="l06236"></a><span class="lineno"> 6236</span>&#160;          new_tdes-&gt;<a class="code" href="structlog__tdes.html#ae9437cf94e11e2307172ef5fc7b32aa9">tran_index</a> = new_tran_index;</div><div class="line"><a name="l06237"></a><span class="lineno"> 6237</span>&#160;          new_tdes-&gt;<a class="code" href="structlog__tdes.html#a21b2b5a56efdbf3078c64649dc6a548c">isloose_end</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l06238"></a><span class="lineno"> 6238</span>&#160;          <span class="comment">/* new_tdes does not inherit topops fields */</span></div><div class="line"><a name="l06239"></a><span class="lineno"> 6239</span>&#160;          new_tdes-&gt;<a class="code" href="structlog__tdes.html#a97c1d42917ab4d08ffe3194fc7233018">topops</a>.<a class="code" href="structlog__topops__stack.html#aeeae85de5bdc4f49b8ba730b25ab092b">stack</a> = <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l06240"></a><span class="lineno"> 6240</span>&#160;          new_tdes-&gt;<a class="code" href="structlog__tdes.html#a97c1d42917ab4d08ffe3194fc7233018">topops</a>.<a class="code" href="structlog__topops__stack.html#a5e509dcc15d89abc0c6ba486af6dba4d">last</a> = -1;</div><div class="line"><a name="l06241"></a><span class="lineno"> 6241</span>&#160;          new_tdes-&gt;<a class="code" href="structlog__tdes.html#a97c1d42917ab4d08ffe3194fc7233018">topops</a>.<a class="code" href="structlog__topops__stack.html#a332cd1918ade0476cdb34f2b478b6944">max</a> = 0;</div><div class="line"><a name="l06242"></a><span class="lineno"> 6242</span>&#160;</div><div class="line"><a name="l06243"></a><span class="lineno"> 6243</span>&#160;          <span class="comment">/* The old one keep the coordinator/participant information */</span></div><div class="line"><a name="l06244"></a><span class="lineno"> 6244</span>&#160;          tdes-&gt;<a class="code" href="structlog__tdes.html#a13da289398281e91e89ab374b3c17936">coord</a> = <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l06245"></a><span class="lineno"> 6245</span>&#160;</div><div class="line"><a name="l06246"></a><span class="lineno"> 6246</span>&#160;          <a class="code" href="log__impl_8h.html#a7c06e439fe569ee687eaa368cbb7e4f7">TR_TABLE_CS_ENTER</a> (thread_p);</div><div class="line"><a name="l06247"></a><span class="lineno"> 6247</span>&#160;          <a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a4cf383467135a4aa88ffe54e788b4706">trantable</a>.<a class="code" href="structtrantable.html#a59bdef55722fd22f2e4717a8e0e9cb37">num_coord_loose_end_indices</a>++;</div><div class="line"><a name="l06248"></a><span class="lineno"> 6248</span>&#160;          <a class="code" href="log__impl_8h.html#a6814fb771a56f2ae611ec2d9bcbdf0fd">TR_TABLE_CS_EXIT</a> (thread_p);</div><div class="line"><a name="l06249"></a><span class="lineno"> 6249</span>&#160;          <span class="comment">/* </span></div><div class="line"><a name="l06250"></a><span class="lineno"> 6250</span>&#160;<span class="comment">           * Start a new transaction for our original transaction index.</span></div><div class="line"><a name="l06251"></a><span class="lineno"> 6251</span>&#160;<span class="comment">           * Set the coordinator stuff to NULL, in our original index since</span></div><div class="line"><a name="l06252"></a><span class="lineno"> 6252</span>&#160;<span class="comment">           * it has been transfer to another index. That is, distributed</span></div><div class="line"><a name="l06253"></a><span class="lineno"> 6253</span>&#160;<span class="comment">           * information should be freed using the new transaction index.</span></div><div class="line"><a name="l06254"></a><span class="lineno"> 6254</span>&#160;<span class="comment">           */</span></div><div class="line"><a name="l06255"></a><span class="lineno"> 6255</span>&#160;</div><div class="line"><a name="l06256"></a><span class="lineno"> 6256</span>&#160;          <span class="comment">/* </span></div><div class="line"><a name="l06257"></a><span class="lineno"> 6257</span>&#160;<span class="comment">           * Go back to the old index</span></div><div class="line"><a name="l06258"></a><span class="lineno"> 6258</span>&#160;<span class="comment">           */</span></div><div class="line"><a name="l06259"></a><span class="lineno"> 6259</span>&#160;</div><div class="line"><a name="l06260"></a><span class="lineno"> 6260</span>&#160;          <a class="code" href="log__impl_8h.html#a84f37ef4ed6965224995a001ad15ba7e">LOG_SET_CURRENT_TRAN_INDEX</a> (thread_p, tdes-&gt;<a class="code" href="structlog__tdes.html#ae9437cf94e11e2307172ef5fc7b32aa9">tran_index</a>);</div><div class="line"><a name="l06261"></a><span class="lineno"> 6261</span>&#160;</div><div class="line"><a name="l06262"></a><span class="lineno"> 6262</span>&#160;          (void) <a class="code" href="log__impl_8h.html#a0e075f8cf3a95dd3685eaaa9890335dc">logtb_get_new_tran_id</a> (thread_p, tdes);</div><div class="line"><a name="l06263"></a><span class="lineno"> 6263</span>&#160;        }</div><div class="line"><a name="l06264"></a><span class="lineno"> 6264</span>&#160;</div><div class="line"><a name="l06265"></a><span class="lineno"> 6265</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="log__manager_8c.html#aff0ddf74133f090a894a4b4b68b7acb6">LOG_ISCHECKPOINT_TIME</a> ())</div><div class="line"><a name="l06266"></a><span class="lineno"> 6266</span>&#160;        {</div><div class="line"><a name="l06267"></a><span class="lineno"> 6267</span>&#160;<span class="preprocessor">#if defined(SERVER_MODE)</span></div><div class="line"><a name="l06268"></a><span class="lineno"> 6268</span>&#160;          <a class="code" href="log__manager_8h.html#a6160ad5bb57554497e3183a7d61b3598">log_wakeup_checkpoint_daemon</a> ();</div><div class="line"><a name="l06269"></a><span class="lineno"> 6269</span>&#160;<span class="preprocessor">#else </span><span class="comment">/* SERVER_MODE */</span><span class="preprocessor"></span></div><div class="line"><a name="l06270"></a><span class="lineno"> 6270</span>&#160;          (void) <a class="code" href="log__impl_8h.html#a3afa13fd96a09f0686e865e34d4ba415">logpb_checkpoint</a> (thread_p);</div><div class="line"><a name="l06271"></a><span class="lineno"> 6271</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* SERVER_MODE */</span><span class="preprocessor"></span></div><div class="line"><a name="l06272"></a><span class="lineno"> 6272</span>&#160;        }</div><div class="line"><a name="l06273"></a><span class="lineno"> 6273</span>&#160;</div><div class="line"><a name="l06274"></a><span class="lineno"> 6274</span>&#160;          <span class="keywordflow">return</span> state;</div><div class="line"><a name="l06275"></a><span class="lineno"> 6275</span>&#160;        }</div><div class="line"><a name="l06276"></a><span class="lineno"> 6276</span>&#160;    }</div><div class="line"><a name="l06277"></a><span class="lineno"> 6277</span>&#160;</div><div class="line"><a name="l06278"></a><span class="lineno"> 6278</span>&#160;      <span class="comment">/* </span></div><div class="line"><a name="l06279"></a><span class="lineno"> 6279</span>&#160;<span class="comment">       * All acknowledgments of participants have been received, declare the</span></div><div class="line"><a name="l06280"></a><span class="lineno"> 6280</span>&#160;<span class="comment">       * the transaction as completed</span></div><div class="line"><a name="l06281"></a><span class="lineno"> 6281</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l06282"></a><span class="lineno"> 6282</span>&#160;    }</div><div class="line"><a name="l06283"></a><span class="lineno"> 6283</span>&#160;</div><div class="line"><a name="l06284"></a><span class="lineno"> 6284</span>&#160;  <span class="comment">/* </span></div><div class="line"><a name="l06285"></a><span class="lineno"> 6285</span>&#160;<span class="comment">   * DECLARE THE TRANSACTION AS COMPLETED</span></div><div class="line"><a name="l06286"></a><span class="lineno"> 6286</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l06287"></a><span class="lineno"> 6287</span>&#160;</div><div class="line"><a name="l06288"></a><span class="lineno"> 6288</span>&#160;  <span class="comment">/* </span></div><div class="line"><a name="l06289"></a><span class="lineno"> 6289</span>&#160;<span class="comment">   * Check if this index needs to be returned after finishing the transaction</span></div><div class="line"><a name="l06290"></a><span class="lineno"> 6290</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l06291"></a><span class="lineno"> 6291</span>&#160;</div><div class="line"><a name="l06292"></a><span class="lineno"> 6292</span>&#160;  <span class="keywordflow">if</span> (tdes-&gt;<a class="code" href="structlog__tdes.html#a21b2b5a56efdbf3078c64649dc6a548c">isloose_end</a> == <span class="keyword">true</span> &amp;&amp; all_acks == <span class="keyword">true</span>)</div><div class="line"><a name="l06293"></a><span class="lineno"> 6293</span>&#160;    {</div><div class="line"><a name="l06294"></a><span class="lineno"> 6294</span>&#160;      return_2pc_loose_tranindex = <span class="keyword">true</span>;</div><div class="line"><a name="l06295"></a><span class="lineno"> 6295</span>&#160;    }</div><div class="line"><a name="l06296"></a><span class="lineno"> 6296</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l06297"></a><span class="lineno"> 6297</span>&#160;    {</div><div class="line"><a name="l06298"></a><span class="lineno"> 6298</span>&#160;      return_2pc_loose_tranindex = <span class="keyword">false</span>;</div><div class="line"><a name="l06299"></a><span class="lineno"> 6299</span>&#160;    }</div><div class="line"><a name="l06300"></a><span class="lineno"> 6300</span>&#160;</div><div class="line"><a name="l06301"></a><span class="lineno"> 6301</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="storage__common_8h.html#a26dd766712df5b5c4fcd158f571a75e4">LSA_ISNULL</a> (&amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a5b128a08476a5b499cf82e3163e6d62b">tail_lsa</a>))</div><div class="line"><a name="l06302"></a><span class="lineno"> 6302</span>&#160;    {</div><div class="line"><a name="l06303"></a><span class="lineno"> 6303</span>&#160;      <span class="comment">/* </span></div><div class="line"><a name="l06304"></a><span class="lineno"> 6304</span>&#160;<span class="comment">       * Transaction did not update any data, thus we do not need to log a</span></div><div class="line"><a name="l06305"></a><span class="lineno"> 6305</span>&#160;<span class="comment">       * commit/abort log record</span></div><div class="line"><a name="l06306"></a><span class="lineno"> 6306</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l06307"></a><span class="lineno"> 6307</span>&#160;      <span class="keywordflow">if</span> (iscommitted != <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a66f7a15b57486fb9081e733c142d35ea">LOG_ABORT</a>)</div><div class="line"><a name="l06308"></a><span class="lineno"> 6308</span>&#160;    {</div><div class="line"><a name="l06309"></a><span class="lineno"> 6309</span>&#160;      state = <a class="code" href="log__comm_8h.html#a3c0be9b9f104459ab90ee18af95c4b3ea6ddb25e9eb5bdd0477b4da46f8edcaba">TRAN_UNACTIVE_COMMITTED</a>;</div><div class="line"><a name="l06310"></a><span class="lineno"> 6310</span>&#160;    }</div><div class="line"><a name="l06311"></a><span class="lineno"> 6311</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l06312"></a><span class="lineno"> 6312</span>&#160;    {</div><div class="line"><a name="l06313"></a><span class="lineno"> 6313</span>&#160;      state = <a class="code" href="log__comm_8h.html#a3c0be9b9f104459ab90ee18af95c4b3eac19d6ad89f93ec75c1e1904db0e5c0ad">TRAN_UNACTIVE_ABORTED</a>;</div><div class="line"><a name="l06314"></a><span class="lineno"> 6314</span>&#160;    }</div><div class="line"><a name="l06315"></a><span class="lineno"> 6315</span>&#160;<span class="preprocessor">#if !defined(NDEBUG)</span></div><div class="line"><a name="l06316"></a><span class="lineno"> 6316</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="system__parameter_8c.html#a678756564699cbc93bd758cf6f99a042">prm_get_bool_value</a> (<a class="code" href="system__parameter_8h.html#a23aaf6bca406b9b428f43ad1b6b2b3e0a941dffd866597ae3fa646a852919fef4">PRM_ID_LOG_TRACE_DEBUG</a>))</div><div class="line"><a name="l06317"></a><span class="lineno"> 6317</span>&#160;    {</div><div class="line"><a name="l06318"></a><span class="lineno"> 6318</span>&#160;      <span class="keywordtype">char</span> time_val[<a class="code" href="porting_8h.html#a7b4ba06a388856deeb25508d04470eaa">CTIME_MAX</a>];</div><div class="line"><a name="l06319"></a><span class="lineno"> 6319</span>&#160;      time_t xxtime = <a class="code" href="namespacebrokerstatus__to__csv.html#ae075d9642cd7485bc938b7d65b2e6991">time</a> (<a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l06320"></a><span class="lineno"> 6320</span>&#160;</div><div class="line"><a name="l06321"></a><span class="lineno"> 6321</span>&#160;      (void) ctime_r (&amp;xxtime, time_val);</div><div class="line"><a name="l06322"></a><span class="lineno"> 6322</span>&#160;      fprintf (stdout,</div><div class="line"><a name="l06323"></a><span class="lineno"> 6323</span>&#160;           <a class="code" href="message__catalog_8c.html#af9597674b8d4504be6fd55145b5af6f0">msgcat_message</a> (<a class="code" href="message__catalog_8h.html#a9b41bc5c782e79c0112014e50461e364">MSGCAT_CATALOG_CUBRID</a>, <a class="code" href="message__catalog_8h.html#aa04e075e72cdb43d5397319b05e9184f">MSGCAT_SET_LOG</a>,</div><div class="line"><a name="l06324"></a><span class="lineno"> 6324</span>&#160;                   ((iscommitted != <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a66f7a15b57486fb9081e733c142d35ea">LOG_ABORT</a>) ? <a class="code" href="log__impl_8h.html#a0d3a513ea8174d22b361c70c7df970bc">MSGCAT_LOG_FINISH_COMMIT</a> : <a class="code" href="log__impl_8h.html#af7b3d3d0155756e96ceaaf24df4b1bb6">MSGCAT_LOG_FINISH_ABORT</a>)),</div><div class="line"><a name="l06325"></a><span class="lineno"> 6325</span>&#160;           tdes-&gt;<a class="code" href="structlog__tdes.html#ae9437cf94e11e2307172ef5fc7b32aa9">tran_index</a>, tdes-&gt;<a class="code" href="structlog__tdes.html#a3baeff284ed2167bcef74c5ef34d4f3b">trid</a>, <a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>.<a class="code" href="structlog__header.html#a982b3e55dedc3dabc54a1a7fcddc144e">append_lsa</a>.<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a>, <a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>.<a class="code" href="structlog__header.html#a982b3e55dedc3dabc54a1a7fcddc144e">append_lsa</a>.<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a>, time_val);</div><div class="line"><a name="l06326"></a><span class="lineno"> 6326</span>&#160;      fflush (stdout);</div><div class="line"><a name="l06327"></a><span class="lineno"> 6327</span>&#160;    }</div><div class="line"><a name="l06328"></a><span class="lineno"> 6328</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* !NDEBUG */</span><span class="preprocessor"></span></div><div class="line"><a name="l06329"></a><span class="lineno"> 6329</span>&#160;      <a class="code" href="log__impl_8h.html#a6c5edebbae75e1a92360baf780ce8377">logtb_clear_tdes</a> (thread_p, tdes);</div><div class="line"><a name="l06330"></a><span class="lineno"> 6330</span>&#160;    }</div><div class="line"><a name="l06331"></a><span class="lineno"> 6331</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l06332"></a><span class="lineno"> 6332</span>&#160;    {</div><div class="line"><a name="l06333"></a><span class="lineno"> 6333</span>&#160;      <span class="comment">/* </span></div><div class="line"><a name="l06334"></a><span class="lineno"> 6334</span>&#160;<span class="comment">       * Transaction updated data or this is a coordinator</span></div><div class="line"><a name="l06335"></a><span class="lineno"> 6335</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l06336"></a><span class="lineno"> 6336</span>&#160;      <span class="keywordflow">if</span> (iscommitted == <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a1903de7cf7fa88081eb8010a667e1839">LOG_COMMIT</a>)</div><div class="line"><a name="l06337"></a><span class="lineno"> 6337</span>&#160;    {</div><div class="line"><a name="l06338"></a><span class="lineno"> 6338</span>&#160;      <a class="code" href="structlog__lsa.html">LOG_LSA</a> commit_lsa;</div><div class="line"><a name="l06339"></a><span class="lineno"> 6339</span>&#160;</div><div class="line"><a name="l06340"></a><span class="lineno"> 6340</span>&#160;      <span class="comment">/* To write unlock log before releasing locks for transactional consistencies. When a transaction(T2) which</span></div><div class="line"><a name="l06341"></a><span class="lineno"> 6341</span>&#160;<span class="comment">       * is resumed by this committing transaction(T1) commits and a crash happens before T1 completes, transaction </span></div><div class="line"><a name="l06342"></a><span class="lineno"> 6342</span>&#160;<span class="comment">       * * consistencies will be broken because T1 will be aborted during restart recovery and T2 was already</span></div><div class="line"><a name="l06343"></a><span class="lineno"> 6343</span>&#160;<span class="comment">       * committed. */</span></div><div class="line"><a name="l06344"></a><span class="lineno"> 6344</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="log__impl_8h.html#a2d9876809ffa8473b6b47c5edcff6ca2">LOG_CHECK_LOG_APPLIER</a> (thread_p) &amp;&amp; !<a class="code" href="vacuum_8h.html#ab0e1deb8da1aa663aa073b0ce78606a2">VACUUM_IS_THREAD_VACUUM</a> (thread_p)</div><div class="line"><a name="l06345"></a><span class="lineno"> 6345</span>&#160;          &amp;&amp; <a class="code" href="log__comm_8c.html#ae3b5771bd95aa37a187f3a6e0cb2b32d">log_does_allow_replication</a> () == <span class="keyword">true</span>)</div><div class="line"><a name="l06346"></a><span class="lineno"> 6346</span>&#160;        {</div><div class="line"><a name="l06347"></a><span class="lineno"> 6347</span>&#160;          log_append_repl_info_and_commit_log (thread_p, tdes, &amp;commit_lsa);</div><div class="line"><a name="l06348"></a><span class="lineno"> 6348</span>&#160;        }</div><div class="line"><a name="l06349"></a><span class="lineno"> 6349</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l06350"></a><span class="lineno"> 6350</span>&#160;        {</div><div class="line"><a name="l06351"></a><span class="lineno"> 6351</span>&#160;          log_append_commit_log (thread_p, tdes, &amp;commit_lsa);</div><div class="line"><a name="l06352"></a><span class="lineno"> 6352</span>&#160;        }</div><div class="line"><a name="l06353"></a><span class="lineno"> 6353</span>&#160;</div><div class="line"><a name="l06354"></a><span class="lineno"> 6354</span>&#160;      log_change_tran_as_completed (thread_p, tdes, <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a1903de7cf7fa88081eb8010a667e1839">LOG_COMMIT</a>, &amp;commit_lsa);</div><div class="line"><a name="l06355"></a><span class="lineno"> 6355</span>&#160;    }</div><div class="line"><a name="l06356"></a><span class="lineno"> 6356</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l06357"></a><span class="lineno"> 6357</span>&#160;    {</div><div class="line"><a name="l06358"></a><span class="lineno"> 6358</span>&#160;      <a class="code" href="structlog__lsa.html">LOG_LSA</a> abort_lsa;</div><div class="line"><a name="l06359"></a><span class="lineno"> 6359</span>&#160;</div><div class="line"><a name="l06360"></a><span class="lineno"> 6360</span>&#160;      log_append_abort_log (thread_p, tdes, &amp;abort_lsa);</div><div class="line"><a name="l06361"></a><span class="lineno"> 6361</span>&#160;      log_change_tran_as_completed (thread_p, tdes, <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a66f7a15b57486fb9081e733c142d35ea">LOG_ABORT</a>, &amp;abort_lsa);</div><div class="line"><a name="l06362"></a><span class="lineno"> 6362</span>&#160;    }</div><div class="line"><a name="l06363"></a><span class="lineno"> 6363</span>&#160;</div><div class="line"><a name="l06364"></a><span class="lineno"> 6364</span>&#160;      state = tdes-&gt;<a class="code" href="structlog__tdes.html#ad924146690490b840ef5c3f65c3a5a6c">state</a>;</div><div class="line"><a name="l06365"></a><span class="lineno"> 6365</span>&#160;</div><div class="line"><a name="l06366"></a><span class="lineno"> 6366</span>&#160;      <span class="comment">/* now releases locks */</span></div><div class="line"><a name="l06367"></a><span class="lineno"> 6367</span>&#160;      <a class="code" href="lock__manager_8c.html#a7a4552847269854167212acb2d02de60">lock_unlock_all</a> (thread_p);</div><div class="line"><a name="l06368"></a><span class="lineno"> 6368</span>&#160;</div><div class="line"><a name="l06369"></a><span class="lineno"> 6369</span>&#160;      <span class="comment">/* Unblock global oldest active update. */</span></div><div class="line"><a name="l06370"></a><span class="lineno"> 6370</span>&#160;      <span class="keywordflow">if</span> (tdes-&gt;<a class="code" href="structlog__tdes.html#a81f8323632791e9ca56aa0b1ba838609">block_global_oldest_active_until_commit</a>)</div><div class="line"><a name="l06371"></a><span class="lineno"> 6371</span>&#160;    {</div><div class="line"><a name="l06372"></a><span class="lineno"> 6372</span>&#160;      ATOMIC_INC_32 (&amp;<a class="code" href="log__manager_8c.html#a3ecc2751989b36deb454d7a32e1ee5b8">vacuum_Global_oldest_active_blockers_counter</a>, -1);</div><div class="line"><a name="l06373"></a><span class="lineno"> 6373</span>&#160;      tdes-&gt;<a class="code" href="structlog__tdes.html#a81f8323632791e9ca56aa0b1ba838609">block_global_oldest_active_until_commit</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l06374"></a><span class="lineno"> 6374</span>&#160;      <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (<a class="code" href="log__manager_8c.html#a3ecc2751989b36deb454d7a32e1ee5b8">vacuum_Global_oldest_active_blockers_counter</a> &gt;= 0);</div><div class="line"><a name="l06375"></a><span class="lineno"> 6375</span>&#160;    }</div><div class="line"><a name="l06376"></a><span class="lineno"> 6376</span>&#160;</div><div class="line"><a name="l06377"></a><span class="lineno"> 6377</span>&#160;<span class="preprocessor">#if defined(HAVE_ATOMIC_BUILTINS)</span></div><div class="line"><a name="l06378"></a><span class="lineno"> 6378</span>&#160;      <span class="keywordflow">if</span> (iscommitted == <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a1903de7cf7fa88081eb8010a667e1839">LOG_COMMIT</a>)</div><div class="line"><a name="l06379"></a><span class="lineno"> 6379</span>&#160;    {</div><div class="line"><a name="l06380"></a><span class="lineno"> 6380</span>&#160;      <span class="keywordtype">int</span> tran_index = <a class="code" href="perf__monitor_8h.html#a55d27b01d605ba6ee2929ddfe8588320">LOG_FIND_THREAD_TRAN_INDEX</a> (thread_p);</div><div class="line"><a name="l06381"></a><span class="lineno"> 6381</span>&#160;      <span class="keyword">volatile</span> <a class="code" href="storage__common_8h.html#a6cdffe739d5149557924b03acf945d1c">MVCCID</a> *p_transaction_lowest_active_mvccid = <a class="code" href="log__impl_8h.html#afcfc70a06711e89b04a4cbd09ecba5d1">LOG_FIND_TRAN_LOWEST_ACTIVE_MVCCID</a> (tran_index);</div><div class="line"><a name="l06382"></a><span class="lineno"> 6382</span>&#160;</div><div class="line"><a name="l06383"></a><span class="lineno"> 6383</span>&#160;      <span class="keywordflow">if</span> (*p_transaction_lowest_active_mvccid != <a class="code" href="storage__common_8h.html#afd0bb266f6811f0eef1f13a2d4a2d175">MVCCID_NULL</a>)</div><div class="line"><a name="l06384"></a><span class="lineno"> 6384</span>&#160;        {</div><div class="line"><a name="l06385"></a><span class="lineno"> 6385</span>&#160;          <span class="comment">/* set transaction lowest active MVCCID to null to allow VACUUM advancing */</span></div><div class="line"><a name="l06386"></a><span class="lineno"> 6386</span>&#160;          ATOMIC_TAS_64 (p_transaction_lowest_active_mvccid, <a class="code" href="storage__common_8h.html#afd0bb266f6811f0eef1f13a2d4a2d175">MVCCID_NULL</a>);</div><div class="line"><a name="l06387"></a><span class="lineno"> 6387</span>&#160;        }</div><div class="line"><a name="l06388"></a><span class="lineno"> 6388</span>&#160;    }</div><div class="line"><a name="l06389"></a><span class="lineno"> 6389</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l06390"></a><span class="lineno"> 6390</span>&#160;</div><div class="line"><a name="l06391"></a><span class="lineno"> 6391</span>&#160;      <span class="comment">/* If recovery restart operation, or, if this is a coordinator loose end transaction return this index and</span></div><div class="line"><a name="l06392"></a><span class="lineno"> 6392</span>&#160;<span class="comment">       * decrement coordinator loose end transactions counter. */</span></div><div class="line"><a name="l06393"></a><span class="lineno"> 6393</span>&#160;      <span class="keywordflow">if</span> (return_2pc_loose_tranindex == <span class="keyword">false</span>)</div><div class="line"><a name="l06394"></a><span class="lineno"> 6394</span>&#160;    {</div><div class="line"><a name="l06395"></a><span class="lineno"> 6395</span>&#160;      <span class="keywordflow">if</span> (get_newtrid == <a class="code" href="log__impl_8h.html#ab0c98093893d496bd3c00c6825c3941bacf3113fe0ba179d76a1bbae698248c79">LOG_NEED_NEWTRID</a>)</div><div class="line"><a name="l06396"></a><span class="lineno"> 6396</span>&#160;        {</div><div class="line"><a name="l06397"></a><span class="lineno"> 6397</span>&#160;          (void) <a class="code" href="log__impl_8h.html#a0e075f8cf3a95dd3685eaaa9890335dc">logtb_get_new_tran_id</a> (thread_p, tdes);</div><div class="line"><a name="l06398"></a><span class="lineno"> 6398</span>&#160;        }</div><div class="line"><a name="l06399"></a><span class="lineno"> 6399</span>&#160;    }</div><div class="line"><a name="l06400"></a><span class="lineno"> 6400</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l06401"></a><span class="lineno"> 6401</span>&#160;    {</div><div class="line"><a name="l06402"></a><span class="lineno"> 6402</span>&#160;      <span class="comment">/* Free the index */</span></div><div class="line"><a name="l06403"></a><span class="lineno"> 6403</span>&#160;      <span class="keywordflow">if</span> (tdes-&gt;<a class="code" href="structlog__tdes.html#a21b2b5a56efdbf3078c64649dc6a548c">isloose_end</a> == <span class="keyword">true</span>)</div><div class="line"><a name="l06404"></a><span class="lineno"> 6404</span>&#160;        {</div><div class="line"><a name="l06405"></a><span class="lineno"> 6405</span>&#160;          <a class="code" href="log__impl_8h.html#a7c06e439fe569ee687eaa368cbb7e4f7">TR_TABLE_CS_ENTER</a> (thread_p);</div><div class="line"><a name="l06406"></a><span class="lineno"> 6406</span>&#160;          <a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a4cf383467135a4aa88ffe54e788b4706">trantable</a>.<a class="code" href="structtrantable.html#a59bdef55722fd22f2e4717a8e0e9cb37">num_coord_loose_end_indices</a>--;</div><div class="line"><a name="l06407"></a><span class="lineno"> 6407</span>&#160;          <a class="code" href="log__impl_8h.html#a6814fb771a56f2ae611ec2d9bcbdf0fd">TR_TABLE_CS_EXIT</a> (thread_p);</div><div class="line"><a name="l06408"></a><span class="lineno"> 6408</span>&#160;        }</div><div class="line"><a name="l06409"></a><span class="lineno"> 6409</span>&#160;      <a class="code" href="log__impl_8h.html#ab6259b55420e741a2b4e5b9d05778f85">logtb_free_tran_index</a> (thread_p, tdes-&gt;<a class="code" href="structlog__tdes.html#ae9437cf94e11e2307172ef5fc7b32aa9">tran_index</a>);</div><div class="line"><a name="l06410"></a><span class="lineno"> 6410</span>&#160;    }</div><div class="line"><a name="l06411"></a><span class="lineno"> 6411</span>&#160;</div><div class="line"><a name="l06412"></a><span class="lineno"> 6412</span>&#160;      <span class="comment">/* Finish the append operation and flush the log */</span></div><div class="line"><a name="l06413"></a><span class="lineno"> 6413</span>&#160;    }</div><div class="line"><a name="l06414"></a><span class="lineno"> 6414</span>&#160;</div><div class="line"><a name="l06415"></a><span class="lineno"> 6415</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="log__manager_8c.html#aff0ddf74133f090a894a4b4b68b7acb6">LOG_ISCHECKPOINT_TIME</a> ())</div><div class="line"><a name="l06416"></a><span class="lineno"> 6416</span>&#160;    {</div><div class="line"><a name="l06417"></a><span class="lineno"> 6417</span>&#160;<span class="preprocessor">#if defined(SERVER_MODE)</span></div><div class="line"><a name="l06418"></a><span class="lineno"> 6418</span>&#160;      <a class="code" href="log__manager_8h.html#a6160ad5bb57554497e3183a7d61b3598">log_wakeup_checkpoint_daemon</a> ();</div><div class="line"><a name="l06419"></a><span class="lineno"> 6419</span>&#160;<span class="preprocessor">#else </span><span class="comment">/* SERVER_MODE */</span><span class="preprocessor"></span></div><div class="line"><a name="l06420"></a><span class="lineno"> 6420</span>&#160;      (void) <a class="code" href="log__impl_8h.html#a3afa13fd96a09f0686e865e34d4ba415">logpb_checkpoint</a> (thread_p);</div><div class="line"><a name="l06421"></a><span class="lineno"> 6421</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* SERVER_MODE */</span><span class="preprocessor"></span></div><div class="line"><a name="l06422"></a><span class="lineno"> 6422</span>&#160;    }</div><div class="line"><a name="l06423"></a><span class="lineno"> 6423</span>&#160;</div><div class="line"><a name="l06424"></a><span class="lineno"> 6424</span>&#160;  <span class="keywordflow">return</span> state;</div><div class="line"><a name="l06425"></a><span class="lineno"> 6425</span>&#160;}</div><div class="line"><a name="l06426"></a><span class="lineno"> 6426</span>&#160;</div><div class="line"><a name="l06427"></a><span class="lineno"> 6427</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l06428"></a><span class="lineno"> 6428</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l06429"></a><span class="lineno"> 6429</span>&#160;<span class="comment"> *              FUNCTIONS RELATED TO DUMPING THE LOG AND ITS DATA</span></div><div class="line"><a name="l06430"></a><span class="lineno"> 6430</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l06431"></a><span class="lineno"> 6431</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l06432"></a><span class="lineno"> 6432</span>&#160;</div><div class="line"><a name="l06433"></a><span class="lineno"> 6433</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l06434"></a><span class="lineno"> 6434</span>&#160;<span class="comment"> * log_ascii_dump - PRINT DATA IN ASCII FORMAT</span></div><div class="line"><a name="l06435"></a><span class="lineno"> 6435</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l06436"></a><span class="lineno"> 6436</span>&#160;<span class="comment"> * return: nothing</span></div><div class="line"><a name="l06437"></a><span class="lineno"> 6437</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l06438"></a><span class="lineno"> 6438</span>&#160;<span class="comment"> *   length(in): Length of Recovery Data</span></div><div class="line"><a name="l06439"></a><span class="lineno"> 6439</span>&#160;<span class="comment"> *   data(in): The data being logged</span></div><div class="line"><a name="l06440"></a><span class="lineno"> 6440</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l06441"></a><span class="lineno"> 6441</span>&#160;<span class="comment"> * NOTE: Dump recovery information in ascii format.</span></div><div class="line"><a name="l06442"></a><span class="lineno"> 6442</span>&#160;<span class="comment"> *              It is used when a dump function is not provided.</span></div><div class="line"><a name="l06443"></a><span class="lineno"> 6443</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l06444"></a><span class="lineno"> 6444</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div><div class="line"><a name="l06445"></a><span class="lineno"> 6445</span>&#160;log_ascii_dump (FILE * out_fp, <span class="keywordtype">int</span> length, <span class="keywordtype">void</span> *<a class="code" href="namespacestatdump__to__csv.html#aedcb70fde9c0b07a0732db70deeec616">data</a>)</div><div class="line"><a name="l06446"></a><span class="lineno"> 6446</span>&#160;{</div><div class="line"><a name="l06447"></a><span class="lineno"> 6447</span>&#160;  <span class="keywordtype">char</span> *<a class="code" href="expat_8h.html#aaf0497a3bd20a0066017546af6bf80be">ptr</a>;            <span class="comment">/* Pointer to data */</span></div><div class="line"><a name="l06448"></a><span class="lineno"> 6448</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div><div class="line"><a name="l06449"></a><span class="lineno"> 6449</span>&#160;</div><div class="line"><a name="l06450"></a><span class="lineno"> 6450</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, <a class="code" href="expat_8h.html#aaf0497a3bd20a0066017546af6bf80be">ptr</a> = (<span class="keywordtype">char</span> *) <a class="code" href="namespacestatdump__to__csv.html#aedcb70fde9c0b07a0732db70deeec616">data</a>; <a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; length; <a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l06451"></a><span class="lineno"> 6451</span>&#160;    {</div><div class="line"><a name="l06452"></a><span class="lineno"> 6452</span>&#160;      (void) fputc (*<a class="code" href="expat_8h.html#aaf0497a3bd20a0066017546af6bf80be">ptr</a>++, out_fp);</div><div class="line"><a name="l06453"></a><span class="lineno"> 6453</span>&#160;    }</div><div class="line"><a name="l06454"></a><span class="lineno"> 6454</span>&#160;}</div><div class="line"><a name="l06455"></a><span class="lineno"> 6455</span>&#160;</div><div class="line"><a name="l06456"></a><span class="lineno"> 6456</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l06457"></a><span class="lineno"> 6457</span>&#160;<span class="comment"> * log_hexa_dump () - Point recovery data as hexadecimals.</span></div><div class="line"><a name="l06458"></a><span class="lineno"> 6458</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l06459"></a><span class="lineno"> 6459</span>&#160;<span class="comment"> * return      : Void.</span></div><div class="line"><a name="l06460"></a><span class="lineno"> 6460</span>&#160;<span class="comment"> * out_fp (in) : Print output.</span></div><div class="line"><a name="l06461"></a><span class="lineno"> 6461</span>&#160;<span class="comment"> * length (in) : Recovery data length.</span></div><div class="line"><a name="l06462"></a><span class="lineno"> 6462</span>&#160;<span class="comment"> * data (in)   : Recovery data.</span></div><div class="line"><a name="l06463"></a><span class="lineno"> 6463</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l06464"></a><span class="lineno"> 6464</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l06465"></a><span class="lineno"> 6465</span>&#160;log_hexa_dump (FILE * out_fp, <span class="keywordtype">int</span> length, <span class="keywordtype">void</span> *<a class="code" href="namespacestatdump__to__csv.html#aedcb70fde9c0b07a0732db70deeec616">data</a>)</div><div class="line"><a name="l06466"></a><span class="lineno"> 6466</span>&#160;{</div><div class="line"><a name="l06467"></a><span class="lineno"> 6467</span>&#160;  <span class="keywordtype">char</span> *<a class="code" href="expat_8h.html#aaf0497a3bd20a0066017546af6bf80be">ptr</a>;            <span class="comment">/* Pointer to data */</span></div><div class="line"><a name="l06468"></a><span class="lineno"> 6468</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div><div class="line"><a name="l06469"></a><span class="lineno"> 6469</span>&#160;</div><div class="line"><a name="l06470"></a><span class="lineno"> 6470</span>&#160;  fprintf (out_fp, <span class="stringliteral">&quot;  00000: &quot;</span>);</div><div class="line"><a name="l06471"></a><span class="lineno"> 6471</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0, <a class="code" href="expat_8h.html#aaf0497a3bd20a0066017546af6bf80be">ptr</a> = (<span class="keywordtype">char</span> *) <a class="code" href="namespacestatdump__to__csv.html#aedcb70fde9c0b07a0732db70deeec616">data</a>; <a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; length; <a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l06472"></a><span class="lineno"> 6472</span>&#160;    {</div><div class="line"><a name="l06473"></a><span class="lineno"> 6473</span>&#160;      fprintf (out_fp, <span class="stringliteral">&quot;%02X &quot;</span>, (<span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>) (*<a class="code" href="expat_8h.html#aaf0497a3bd20a0066017546af6bf80be">ptr</a>++));</div><div class="line"><a name="l06474"></a><span class="lineno"> 6474</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> % 16 == 15 &amp;&amp; <a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> != length)</div><div class="line"><a name="l06475"></a><span class="lineno"> 6475</span>&#160;    {</div><div class="line"><a name="l06476"></a><span class="lineno"> 6476</span>&#160;      fprintf (out_fp, <span class="stringliteral">&quot;\n  %05d: &quot;</span>, <a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> + 1);</div><div class="line"><a name="l06477"></a><span class="lineno"> 6477</span>&#160;    }</div><div class="line"><a name="l06478"></a><span class="lineno"> 6478</span>&#160;    }</div><div class="line"><a name="l06479"></a><span class="lineno"> 6479</span>&#160;  fprintf (out_fp, <span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l06480"></a><span class="lineno"> 6480</span>&#160;}</div><div class="line"><a name="l06481"></a><span class="lineno"> 6481</span>&#160;</div><div class="line"><a name="l06482"></a><span class="lineno"> 6482</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div><div class="line"><a name="l06483"></a><span class="lineno"> 6483</span>&#160;log_repl_data_dump (FILE * out_fp, <span class="keywordtype">int</span> length, <span class="keywordtype">void</span> *<a class="code" href="namespacestatdump__to__csv.html#aedcb70fde9c0b07a0732db70deeec616">data</a>)</div><div class="line"><a name="l06484"></a><span class="lineno"> 6484</span>&#160;{</div><div class="line"><a name="l06485"></a><span class="lineno"> 6485</span>&#160;  <span class="keywordtype">char</span> *<a class="code" href="expat_8h.html#aaf0497a3bd20a0066017546af6bf80be">ptr</a> = (<span class="keywordtype">char</span> *) <a class="code" href="namespacestatdump__to__csv.html#aedcb70fde9c0b07a0732db70deeec616">data</a>;</div><div class="line"><a name="l06486"></a><span class="lineno"> 6486</span>&#160;  <span class="keywordtype">char</span> *class_name;</div><div class="line"><a name="l06487"></a><span class="lineno"> 6487</span>&#160;  <a class="code" href="structdb__value.html">DB_VALUE</a> value;</div><div class="line"><a name="l06488"></a><span class="lineno"> 6488</span>&#160;</div><div class="line"><a name="l06489"></a><span class="lineno"> 6489</span>&#160;  <a class="code" href="expat_8h.html#aaf0497a3bd20a0066017546af6bf80be">ptr</a> = <a class="code" href="object__representation_8h.html#ae4f63e3132c23d8c0b35bb1a59ca21e5">or_unpack_string_nocopy</a> (<a class="code" href="expat_8h.html#aaf0497a3bd20a0066017546af6bf80be">ptr</a>, &amp;class_name);</div><div class="line"><a name="l06490"></a><span class="lineno"> 6490</span>&#160;  <a class="code" href="expat_8h.html#aaf0497a3bd20a0066017546af6bf80be">ptr</a> = <a class="code" href="object__representation_8h.html#a8e0944f13c6ffe078d6aeb50c91171d1">or_unpack_mem_value</a> (<a class="code" href="expat_8h.html#aaf0497a3bd20a0066017546af6bf80be">ptr</a>, &amp;value);</div><div class="line"><a name="l06491"></a><span class="lineno"> 6491</span>&#160;</div><div class="line"><a name="l06492"></a><span class="lineno"> 6492</span>&#160;  <a class="code" href="classstring__buffer.html">string_buffer</a> sb;</div><div class="line"><a name="l06493"></a><span class="lineno"> 6493</span>&#160;  <a class="code" href="classdb__value__printer.html">db_value_printer</a> printer (sb);</div><div class="line"><a name="l06494"></a><span class="lineno"> 6494</span>&#160;</div><div class="line"><a name="l06495"></a><span class="lineno"> 6495</span>&#160;  printer.describe_value (&amp;value);</div><div class="line"><a name="l06496"></a><span class="lineno"> 6496</span>&#160;  fprintf (out_fp, <span class="stringliteral">&quot;C[%s] K[%s]\n&quot;</span>, class_name, sb.<a class="code" href="classstring__buffer.html#a98ea31d493efa108286d8e3907b29454">get_buffer</a> ());</div><div class="line"><a name="l06497"></a><span class="lineno"> 6497</span>&#160;  <a class="code" href="object__primitive_8c.html#a7c633c9f87690aa563bdeaf44f340307">pr_clear_value</a> (&amp;value);</div><div class="line"><a name="l06498"></a><span class="lineno"> 6498</span>&#160;}</div><div class="line"><a name="l06499"></a><span class="lineno"> 6499</span>&#160;</div><div class="line"><a name="l06500"></a><span class="lineno"> 6500</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div><div class="line"><a name="l06501"></a><span class="lineno"> 6501</span>&#160;log_repl_schema_dump (FILE * out_fp, <span class="keywordtype">int</span> length, <span class="keywordtype">void</span> *<a class="code" href="namespacestatdump__to__csv.html#aedcb70fde9c0b07a0732db70deeec616">data</a>)</div><div class="line"><a name="l06502"></a><span class="lineno"> 6502</span>&#160;{</div><div class="line"><a name="l06503"></a><span class="lineno"> 6503</span>&#160;  <span class="keywordtype">char</span> *<a class="code" href="expat_8h.html#aaf0497a3bd20a0066017546af6bf80be">ptr</a>;</div><div class="line"><a name="l06504"></a><span class="lineno"> 6504</span>&#160;  <span class="keywordtype">int</span> statement_type;</div><div class="line"><a name="l06505"></a><span class="lineno"> 6505</span>&#160;  <span class="keywordtype">char</span> *class_name;</div><div class="line"><a name="l06506"></a><span class="lineno"> 6506</span>&#160;  <span class="keywordtype">char</span> *sql;</div><div class="line"><a name="l06507"></a><span class="lineno"> 6507</span>&#160;</div><div class="line"><a name="l06508"></a><span class="lineno"> 6508</span>&#160;  <a class="code" href="expat_8h.html#aaf0497a3bd20a0066017546af6bf80be">ptr</a> = (<span class="keywordtype">char</span> *) <a class="code" href="namespacestatdump__to__csv.html#aedcb70fde9c0b07a0732db70deeec616">data</a>;</div><div class="line"><a name="l06509"></a><span class="lineno"> 6509</span>&#160;  <a class="code" href="expat_8h.html#aaf0497a3bd20a0066017546af6bf80be">ptr</a> = <a class="code" href="object__representation_8h.html#a098782fa7cb5f64510f83998d6ad67fa">or_unpack_int</a> (<a class="code" href="expat_8h.html#aaf0497a3bd20a0066017546af6bf80be">ptr</a>, &amp;statement_type);</div><div class="line"><a name="l06510"></a><span class="lineno"> 6510</span>&#160;  <a class="code" href="expat_8h.html#aaf0497a3bd20a0066017546af6bf80be">ptr</a> = <a class="code" href="object__representation_8h.html#ae4f63e3132c23d8c0b35bb1a59ca21e5">or_unpack_string_nocopy</a> (<a class="code" href="expat_8h.html#aaf0497a3bd20a0066017546af6bf80be">ptr</a>, &amp;class_name);</div><div class="line"><a name="l06511"></a><span class="lineno"> 6511</span>&#160;  <a class="code" href="expat_8h.html#aaf0497a3bd20a0066017546af6bf80be">ptr</a> = <a class="code" href="object__representation_8h.html#ae4f63e3132c23d8c0b35bb1a59ca21e5">or_unpack_string_nocopy</a> (<a class="code" href="expat_8h.html#aaf0497a3bd20a0066017546af6bf80be">ptr</a>, &amp;sql);</div><div class="line"><a name="l06512"></a><span class="lineno"> 6512</span>&#160;</div><div class="line"><a name="l06513"></a><span class="lineno"> 6513</span>&#160;  fprintf (out_fp, <span class="stringliteral">&quot;C[%s] S[%s]\n&quot;</span>, class_name, sql);</div><div class="line"><a name="l06514"></a><span class="lineno"> 6514</span>&#160;}</div><div class="line"><a name="l06515"></a><span class="lineno"> 6515</span>&#160;</div><div class="line"><a name="l06516"></a><span class="lineno"> 6516</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l06517"></a><span class="lineno"> 6517</span>&#160;<span class="comment"> * log_dump_data - DUMP DATA STORED IN LOG</span></div><div class="line"><a name="l06518"></a><span class="lineno"> 6518</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l06519"></a><span class="lineno"> 6519</span>&#160;<span class="comment"> * return: nothing</span></div><div class="line"><a name="l06520"></a><span class="lineno"> 6520</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l06521"></a><span class="lineno"> 6521</span>&#160;<span class="comment"> *   length(in): Length of the data</span></div><div class="line"><a name="l06522"></a><span class="lineno"> 6522</span>&#160;<span class="comment"> *   log_lsa(in/out):Log address identifier containing the log record</span></div><div class="line"><a name="l06523"></a><span class="lineno"> 6523</span>&#160;<span class="comment"> *   log_pgptr(in/out):  Pointer to page where data starts (Set as a side</span></div><div class="line"><a name="l06524"></a><span class="lineno"> 6524</span>&#160;<span class="comment"> *              effect to the page where data ends)</span></div><div class="line"><a name="l06525"></a><span class="lineno"> 6525</span>&#160;<span class="comment"> *   dumpfun(in): Function to invoke to dump the data</span></div><div class="line"><a name="l06526"></a><span class="lineno"> 6526</span>&#160;<span class="comment"> *   log_dump_ptr(in):</span></div><div class="line"><a name="l06527"></a><span class="lineno"> 6527</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l06528"></a><span class="lineno"> 6528</span>&#160;<span class="comment"> * NOTE:Dump the data stored at given log location.</span></div><div class="line"><a name="l06529"></a><span class="lineno"> 6529</span>&#160;<span class="comment"> *              This function is used for debugging purposes.</span></div><div class="line"><a name="l06530"></a><span class="lineno"> 6530</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l06531"></a><span class="lineno"> 6531</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div><div class="line"><a name="l06532"></a><span class="lineno"> 6532</span>&#160;log_dump_data (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, FILE * out_fp, <span class="keywordtype">int</span> length, <a class="code" href="structlog__lsa.html">LOG_LSA</a> * <a class="code" href="structlog__lsa.html">log_lsa</a>, <a class="code" href="structlog__page.html">LOG_PAGE</a> * log_page_p,</div><div class="line"><a name="l06533"></a><span class="lineno"> 6533</span>&#160;           <span class="keywordtype">void</span> (*dumpfun) (FILE *, <span class="keywordtype">int</span>, <span class="keywordtype">void</span> *), <a class="code" href="structlog__zip.html">LOG_ZIP</a> * log_dump_ptr)</div><div class="line"><a name="l06534"></a><span class="lineno"> 6534</span>&#160;{</div><div class="line"><a name="l06535"></a><span class="lineno"> 6535</span>&#160;  <span class="keywordtype">char</span> *<a class="code" href="expat_8h.html#aaf0497a3bd20a0066017546af6bf80be">ptr</a>;            <span class="comment">/* Pointer to data to be printed */</span></div><div class="line"><a name="l06536"></a><span class="lineno"> 6536</span>&#160;  <span class="keywordtype">bool</span> is_zipped = <span class="keyword">false</span>;</div><div class="line"><a name="l06537"></a><span class="lineno"> 6537</span>&#160;  <span class="keywordtype">bool</span> is_unzipped = <span class="keyword">false</span>;</div><div class="line"><a name="l06538"></a><span class="lineno"> 6538</span>&#160;  <span class="comment">/* Call the dumper function */</span></div><div class="line"><a name="l06539"></a><span class="lineno"> 6539</span>&#160;</div><div class="line"><a name="l06540"></a><span class="lineno"> 6540</span>&#160;  <span class="comment">/* </span></div><div class="line"><a name="l06541"></a><span class="lineno"> 6541</span>&#160;<span class="comment">   * If data is contained in only one buffer, pass pointer directly.</span></div><div class="line"><a name="l06542"></a><span class="lineno"> 6542</span>&#160;<span class="comment">   * Otherwise, allocate a contiguous area, copy the data and pass this</span></div><div class="line"><a name="l06543"></a><span class="lineno"> 6543</span>&#160;<span class="comment">   * area. At the end deallocate the area</span></div><div class="line"><a name="l06544"></a><span class="lineno"> 6544</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l06545"></a><span class="lineno"> 6545</span>&#160;</div><div class="line"><a name="l06546"></a><span class="lineno"> 6546</span>&#160;  <span class="keywordflow">if</span> (dumpfun == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l06547"></a><span class="lineno"> 6547</span>&#160;    {</div><div class="line"><a name="l06548"></a><span class="lineno"> 6548</span>&#160;      <span class="comment">/* Set default to log_hexa_dump */</span></div><div class="line"><a name="l06549"></a><span class="lineno"> 6549</span>&#160;      dumpfun = log_hexa_dump;</div><div class="line"><a name="l06550"></a><span class="lineno"> 6550</span>&#160;    }</div><div class="line"><a name="l06551"></a><span class="lineno"> 6551</span>&#160;</div><div class="line"><a name="l06552"></a><span class="lineno"> 6552</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="log__compress_8h.html#acc57c2f6ae6f861d965ca95a4085cdf1">ZIP_CHECK</a> (length))</div><div class="line"><a name="l06553"></a><span class="lineno"> 6553</span>&#160;    {</div><div class="line"><a name="l06554"></a><span class="lineno"> 6554</span>&#160;      length = (<a class="code" href="mprec_8c.html#a61569f2965b7a369eb10b6d75d410d11">int</a>) <a class="code" href="log__compress_8h.html#ac32e36fd25b171236ebb38a5be94d00c">GET_ZIP_LEN</a> (length);</div><div class="line"><a name="l06555"></a><span class="lineno"> 6555</span>&#160;      is_zipped = <span class="keyword">true</span>;</div><div class="line"><a name="l06556"></a><span class="lineno"> 6556</span>&#160;    }</div><div class="line"><a name="l06557"></a><span class="lineno"> 6557</span>&#160;</div><div class="line"><a name="l06558"></a><span class="lineno"> 6558</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="structlog__lsa.html">log_lsa</a>-&gt;<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a> + length &lt; (<span class="keywordtype">int</span>) <a class="code" href="log__impl_8h.html#a7790a20af76ed5282450723f2e09c4e2">LOGAREA_SIZE</a>)</div><div class="line"><a name="l06559"></a><span class="lineno"> 6559</span>&#160;    {</div><div class="line"><a name="l06560"></a><span class="lineno"> 6560</span>&#160;      <span class="comment">/* Data is contained in one buffer */</span></div><div class="line"><a name="l06561"></a><span class="lineno"> 6561</span>&#160;</div><div class="line"><a name="l06562"></a><span class="lineno"> 6562</span>&#160;      <a class="code" href="expat_8h.html#aaf0497a3bd20a0066017546af6bf80be">ptr</a> = (<span class="keywordtype">char</span> *) log_page_p-&gt;<a class="code" href="structlog__page.html#a9b51b4623cdb8d1686f6f8fb64bc9ee2">area</a> + <a class="code" href="structlog__lsa.html">log_lsa</a>-&gt;<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a>;</div><div class="line"><a name="l06563"></a><span class="lineno"> 6563</span>&#160;</div><div class="line"><a name="l06564"></a><span class="lineno"> 6564</span>&#160;      <a class="code" href="cubrid__data__seek__test_8php.html#a7bf795f554c1ff05baccf023cc804198">if</a> (length != 0 &amp;&amp; is_zipped)</div><div class="line"><a name="l06565"></a><span class="lineno"> 6565</span>&#160;    {</div><div class="line"><a name="l06566"></a><span class="lineno"> 6566</span>&#160;      is_unzipped = <a class="code" href="log__compress_8c.html#a239701bd8e957bb4f8f9db1bfcf370a1">log_unzip</a> (log_dump_ptr, length, <a class="code" href="expat_8h.html#aaf0497a3bd20a0066017546af6bf80be">ptr</a>);</div><div class="line"><a name="l06567"></a><span class="lineno"> 6567</span>&#160;    }</div><div class="line"><a name="l06568"></a><span class="lineno"> 6568</span>&#160;</div><div class="line"><a name="l06569"></a><span class="lineno"> 6569</span>&#160;      <span class="keywordflow">if</span> (is_zipped &amp;&amp; is_unzipped)</div><div class="line"><a name="l06570"></a><span class="lineno"> 6570</span>&#160;    {</div><div class="line"><a name="l06571"></a><span class="lineno"> 6571</span>&#160;      (*dumpfun) (out_fp, (<a class="code" href="mprec_8c.html#a61569f2965b7a369eb10b6d75d410d11">int</a>) log_dump_ptr-&gt;<a class="code" href="structlog__zip.html#a3e723c649a96cb0c0af4516d40fc4aed">data_length</a>, log_dump_ptr-&gt;<a class="code" href="structlog__zip.html#ac57b9be7fa6f4be036cf9e6db8565195">log_data</a>);</div><div class="line"><a name="l06572"></a><span class="lineno"> 6572</span>&#160;      <a class="code" href="structlog__lsa.html">log_lsa</a>-&gt;<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a> += length;</div><div class="line"><a name="l06573"></a><span class="lineno"> 6573</span>&#160;    }</div><div class="line"><a name="l06574"></a><span class="lineno"> 6574</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l06575"></a><span class="lineno"> 6575</span>&#160;    {</div><div class="line"><a name="l06576"></a><span class="lineno"> 6576</span>&#160;      (*dumpfun) (out_fp, length, <a class="code" href="expat_8h.html#aaf0497a3bd20a0066017546af6bf80be">ptr</a>);</div><div class="line"><a name="l06577"></a><span class="lineno"> 6577</span>&#160;      <a class="code" href="structlog__lsa.html">log_lsa</a>-&gt;<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a> += length;</div><div class="line"><a name="l06578"></a><span class="lineno"> 6578</span>&#160;    }</div><div class="line"><a name="l06579"></a><span class="lineno"> 6579</span>&#160;    }</div><div class="line"><a name="l06580"></a><span class="lineno"> 6580</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l06581"></a><span class="lineno"> 6581</span>&#160;    {</div><div class="line"><a name="l06582"></a><span class="lineno"> 6582</span>&#160;      <span class="comment">/* Need to copy the data into a contiguous area */</span></div><div class="line"><a name="l06583"></a><span class="lineno"> 6583</span>&#160;      <a class="code" href="expat_8h.html#aaf0497a3bd20a0066017546af6bf80be">ptr</a> = (<span class="keywordtype">char</span> *) <a class="code" href="leak__detector_8h.html#a99aa8fd9f4831e1b0fa9e1cdcde3e249">malloc</a> (length);</div><div class="line"><a name="l06584"></a><span class="lineno"> 6584</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="expat_8h.html#aaf0497a3bd20a0066017546af6bf80be">ptr</a> == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l06585"></a><span class="lineno"> 6585</span>&#160;    {</div><div class="line"><a name="l06586"></a><span class="lineno"> 6586</span>&#160;      <a class="code" href="error__manager_8c.html#afdaf87ce30f2f557802a185ab85b6599">er_set</a> (<a class="code" href="error__manager_8h.html#a5d0d456c474e11fc70779873a30a7432a07ad8f9fda27124d297c94b7d3ea44e8">ER_ERROR_SEVERITY</a>, <a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <a class="code" href="error__code_8h.html#a1f7116a1f1981bc7ef25fc6078518692">ER_OUT_OF_VIRTUAL_MEMORY</a>, 1, (<span class="keywordtype">size_t</span>) length);</div><div class="line"><a name="l06587"></a><span class="lineno"> 6587</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l06588"></a><span class="lineno"> 6588</span>&#160;    }</div><div class="line"><a name="l06589"></a><span class="lineno"> 6589</span>&#160;      <span class="comment">/* Copy the data */</span></div><div class="line"><a name="l06590"></a><span class="lineno"> 6590</span>&#160;      <a class="code" href="log__impl_8h.html#a390f2d36dcfc756ef528e21b94f7525c">logpb_copy_from_log</a> (thread_p, <a class="code" href="expat_8h.html#aaf0497a3bd20a0066017546af6bf80be">ptr</a>, length, <a class="code" href="structlog__lsa.html">log_lsa</a>, log_page_p);</div><div class="line"><a name="l06591"></a><span class="lineno"> 6591</span>&#160;</div><div class="line"><a name="l06592"></a><span class="lineno"> 6592</span>&#160;      <span class="keywordflow">if</span> (is_zipped)</div><div class="line"><a name="l06593"></a><span class="lineno"> 6593</span>&#160;    {</div><div class="line"><a name="l06594"></a><span class="lineno"> 6594</span>&#160;      is_unzipped = <a class="code" href="log__compress_8c.html#a239701bd8e957bb4f8f9db1bfcf370a1">log_unzip</a> (log_dump_ptr, length, <a class="code" href="expat_8h.html#aaf0497a3bd20a0066017546af6bf80be">ptr</a>);</div><div class="line"><a name="l06595"></a><span class="lineno"> 6595</span>&#160;    }</div><div class="line"><a name="l06596"></a><span class="lineno"> 6596</span>&#160;</div><div class="line"><a name="l06597"></a><span class="lineno"> 6597</span>&#160;      <span class="keywordflow">if</span> (is_zipped &amp;&amp; is_unzipped)</div><div class="line"><a name="l06598"></a><span class="lineno"> 6598</span>&#160;    {</div><div class="line"><a name="l06599"></a><span class="lineno"> 6599</span>&#160;      (*dumpfun) (out_fp, (<a class="code" href="mprec_8c.html#a61569f2965b7a369eb10b6d75d410d11">int</a>) log_dump_ptr-&gt;<a class="code" href="structlog__zip.html#a3e723c649a96cb0c0af4516d40fc4aed">data_length</a>, log_dump_ptr-&gt;<a class="code" href="structlog__zip.html#ac57b9be7fa6f4be036cf9e6db8565195">log_data</a>);</div><div class="line"><a name="l06600"></a><span class="lineno"> 6600</span>&#160;    }</div><div class="line"><a name="l06601"></a><span class="lineno"> 6601</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l06602"></a><span class="lineno"> 6602</span>&#160;    {</div><div class="line"><a name="l06603"></a><span class="lineno"> 6603</span>&#160;      (*dumpfun) (out_fp, length, <a class="code" href="expat_8h.html#aaf0497a3bd20a0066017546af6bf80be">ptr</a>);</div><div class="line"><a name="l06604"></a><span class="lineno"> 6604</span>&#160;    }</div><div class="line"><a name="l06605"></a><span class="lineno"> 6605</span>&#160;      <a class="code" href="memory__alloc_8h.html#a794b5a73adc277837a0c4d12da4af5af">free_and_init</a> (<a class="code" href="expat_8h.html#aaf0497a3bd20a0066017546af6bf80be">ptr</a>);</div><div class="line"><a name="l06606"></a><span class="lineno"> 6606</span>&#160;    }</div><div class="line"><a name="l06607"></a><span class="lineno"> 6607</span>&#160;  <a class="code" href="log__impl_8h.html#abad882a19ae7b3bc3ccf42a8cdcdb689">LOG_READ_ALIGN</a> (thread_p, <a class="code" href="structlog__lsa.html">log_lsa</a>, log_page_p);</div><div class="line"><a name="l06608"></a><span class="lineno"> 6608</span>&#160;</div><div class="line"><a name="l06609"></a><span class="lineno"> 6609</span>&#160;}</div><div class="line"><a name="l06610"></a><span class="lineno"> 6610</span>&#160;</div><div class="line"><a name="l06611"></a><span class="lineno"> 6611</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div><div class="line"><a name="l06612"></a><span class="lineno"> 6612</span>&#160;log_dump_header (FILE * out_fp, <a class="code" href="structlog__header.html">LOG_HEADER</a> * log_header_p)</div><div class="line"><a name="l06613"></a><span class="lineno"> 6613</span>&#160;{</div><div class="line"><a name="l06614"></a><span class="lineno"> 6614</span>&#160;  time_t tmp_time;</div><div class="line"><a name="l06615"></a><span class="lineno"> 6615</span>&#160;  <span class="keywordtype">char</span> time_val[<a class="code" href="porting_8h.html#a7b4ba06a388856deeb25508d04470eaa">CTIME_MAX</a>];</div><div class="line"><a name="l06616"></a><span class="lineno"> 6616</span>&#160;</div><div class="line"><a name="l06617"></a><span class="lineno"> 6617</span>&#160;  fprintf (out_fp, <span class="stringliteral">&quot;\n ** DUMP LOG HEADER **\n&quot;</span>);</div><div class="line"><a name="l06618"></a><span class="lineno"> 6618</span>&#160;</div><div class="line"><a name="l06619"></a><span class="lineno"> 6619</span>&#160;  tmp_time = (time_t) log_header_p-&gt;<a class="code" href="structlog__header.html#ab7c3c46056f412b19f447caf2ce7b861">db_creation</a>;</div><div class="line"><a name="l06620"></a><span class="lineno"> 6620</span>&#160;  (<span class="keywordtype">void</span>) ctime_r (&amp;tmp_time, time_val);</div><div class="line"><a name="l06621"></a><span class="lineno"> 6621</span>&#160;  fprintf (out_fp,</div><div class="line"><a name="l06622"></a><span class="lineno"> 6622</span>&#160;       <span class="stringliteral">&quot;HDR: Magic Symbol = %s at disk location = %lld\n     Creation_time = %s&quot;</span></div><div class="line"><a name="l06623"></a><span class="lineno"> 6623</span>&#160;       <span class="stringliteral">&quot;     Release = %s, Compatibility_disk_version = %g,\n&quot;</span></div><div class="line"><a name="l06624"></a><span class="lineno"> 6624</span>&#160;       <span class="stringliteral">&quot;     Db_pagesize = %d, log_pagesize= %d, Shutdown = %d,\n&quot;</span></div><div class="line"><a name="l06625"></a><span class="lineno"> 6625</span>&#160;       <span class="stringliteral">&quot;     Next_trid = %d, Next_mvcc_id = %llu, Num_avg_trans = %d, Num_avg_locks = %d,\n&quot;</span></div><div class="line"><a name="l06626"></a><span class="lineno"> 6626</span>&#160;       <span class="stringliteral">&quot;     Num_active_log_pages = %d, First_active_log_page = %lld,\n&quot;</span></div><div class="line"><a name="l06627"></a><span class="lineno"> 6627</span>&#160;       <span class="stringliteral">&quot;     Current_append = %lld|%d, Checkpoint = %lld|%d,\n&quot;</span>, log_header_p-&gt;<a class="code" href="structlog__header.html#a9e2e5afd8f320c1cdf841a58939cf9b2">magic</a>,</div><div class="line"><a name="l06628"></a><span class="lineno"> 6628</span>&#160;       (<span class="keywordtype">long</span> <span class="keywordtype">long</span>) <a class="code" href="atldb__cubrid_8h.html#a1d99dd3a57d51d7fa3d98f80297633e1">offsetof</a> (<a class="code" href="structlog__page.html">LOG_PAGE</a>, <a class="code" href="structarea.html">area</a>), time_val, log_header_p-&gt;<a class="code" href="structlog__header.html#a69b0ace883f579f1f029b57b86901cda">db_release</a>, log_header_p-&gt;<a class="code" href="structlog__header.html#ac84fc8c39ca403a029683a4ceeef9bd6">db_compatibility</a>,</div><div class="line"><a name="l06629"></a><span class="lineno"> 6629</span>&#160;       log_header_p-&gt;<a class="code" href="structlog__header.html#a6e36b30ec4db6a60e287d0a48fa5c907">db_iopagesize</a>, log_header_p-&gt;<a class="code" href="structlog__header.html#a31fef6acfb938132c62b4623cd1ad953">db_logpagesize</a>, log_header_p-&gt;<a class="code" href="structlog__header.html#a7d775819dc76af47b2615f39dc1c9019">is_shutdown</a>,</div><div class="line"><a name="l06630"></a><span class="lineno"> 6630</span>&#160;       log_header_p-&gt;<a class="code" href="structlog__header.html#aa1540adc8fb89ea40a4cf0d18344afd9">next_trid</a>, (<span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span>) log_header_p-&gt;<a class="code" href="structlog__header.html#a06104560f68d0a20da58e4327a57755a">mvcc_next_id</a>, log_header_p-&gt;<a class="code" href="structlog__header.html#acc35ee047773a1cca16705e989ba3456">avg_ntrans</a>,</div><div class="line"><a name="l06631"></a><span class="lineno"> 6631</span>&#160;       log_header_p-&gt;<a class="code" href="structlog__header.html#a74993a3a849045719cb0661356702c8d">avg_nlocks</a>, log_header_p-&gt;<a class="code" href="structlog__header.html#abf6f8b71041f36e854e9edaa910525be">npages</a>, (<span class="keywordtype">long</span> <span class="keywordtype">long</span>) log_header_p-&gt;<a class="code" href="structlog__header.html#aa32d860a02d9a2da846a3b9dfc17ce97">fpageid</a>,</div><div class="line"><a name="l06632"></a><span class="lineno"> 6632</span>&#160;       <a class="code" href="storage__common_8h.html#a392873d6ffa4a8a6b2eb5f4b4fbbc97c">LSA_AS_ARGS</a> (&amp;log_header_p-&gt;<a class="code" href="structlog__header.html#a982b3e55dedc3dabc54a1a7fcddc144e">append_lsa</a>), <a class="code" href="storage__common_8h.html#a392873d6ffa4a8a6b2eb5f4b4fbbc97c">LSA_AS_ARGS</a> (&amp;log_header_p-&gt;<a class="code" href="structlog__header.html#abd3c92d1eb868dd630bdbfa3561ecf9e">chkpt_lsa</a>));</div><div class="line"><a name="l06633"></a><span class="lineno"> 6633</span>&#160;</div><div class="line"><a name="l06634"></a><span class="lineno"> 6634</span>&#160;  fprintf (out_fp,</div><div class="line"><a name="l06635"></a><span class="lineno"> 6635</span>&#160;       <span class="stringliteral">&quot;     Next_archive_pageid = %lld at active_phy_pageid = %d,\n&quot;</span></div><div class="line"><a name="l06636"></a><span class="lineno"> 6636</span>&#160;       <span class="stringliteral">&quot;     Next_archive_num = %d, Last_archiv_num_for_syscrashes = %d,\n&quot;</span></div><div class="line"><a name="l06637"></a><span class="lineno"> 6637</span>&#160;       <span class="stringliteral">&quot;     Last_deleted_arv_num = %d, has_logging_been_skipped = %d,\n&quot;</span></div><div class="line"><a name="l06638"></a><span class="lineno"> 6638</span>&#160;       <span class="stringliteral">&quot;     bkup_lsa: level0 = %lld|%d, level1 = %lld|%d, level2 = %lld|%d,\n     Log_prefix = %s\n&quot;</span>,</div><div class="line"><a name="l06639"></a><span class="lineno"> 6639</span>&#160;       (<span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span>) log_header_p-&gt;<a class="code" href="structlog__header.html#af5f33cf0ecf8a996d4646d2327f6540c">nxarv_pageid</a>, log_header_p-&gt;<a class="code" href="structlog__header.html#a80c946bc9948fd5bf1011dba3e0481a8">nxarv_phy_pageid</a>, log_header_p-&gt;<a class="code" href="structlog__header.html#afd7807a9da370474be5f75cb3aafcffd">nxarv_num</a>,</div><div class="line"><a name="l06640"></a><span class="lineno"> 6640</span>&#160;       log_header_p-&gt;<a class="code" href="structlog__header.html#a56cefc057e0589c8e9454e3a36751c61">last_arv_num_for_syscrashes</a>, log_header_p-&gt;<a class="code" href="structlog__header.html#aff6ddf3e8b9f68931ffd114fb90899a5">last_deleted_arv_num</a>,</div><div class="line"><a name="l06641"></a><span class="lineno"> 6641</span>&#160;       log_header_p-&gt;<a class="code" href="structlog__header.html#a8e11d6d1907cbdd412a9c3cb7d79e6f4">has_logging_been_skipped</a>, <a class="code" href="storage__common_8h.html#a392873d6ffa4a8a6b2eb5f4b4fbbc97c">LSA_AS_ARGS</a> (&amp;log_header_p-&gt;<a class="code" href="structlog__header.html#ae3e99551830990937f08938f0f9aec11">bkup_level0_lsa</a>),</div><div class="line"><a name="l06642"></a><span class="lineno"> 6642</span>&#160;       <a class="code" href="storage__common_8h.html#a392873d6ffa4a8a6b2eb5f4b4fbbc97c">LSA_AS_ARGS</a> (&amp;log_header_p-&gt;<a class="code" href="structlog__header.html#a4e13bc146dbc2b5c9ee65f2a0313a8e1">bkup_level1_lsa</a>), <a class="code" href="storage__common_8h.html#a392873d6ffa4a8a6b2eb5f4b4fbbc97c">LSA_AS_ARGS</a> (&amp;log_header_p-&gt;<a class="code" href="structlog__header.html#a58201c7b54ca550699752804f305eee0">bkup_level2_lsa</a>),</div><div class="line"><a name="l06643"></a><span class="lineno"> 6643</span>&#160;       log_header_p-&gt;<a class="code" href="structlog__header.html#a115c418fc5dd536dd0d8073897815513">prefix_name</a>);</div><div class="line"><a name="l06644"></a><span class="lineno"> 6644</span>&#160;}</div><div class="line"><a name="l06645"></a><span class="lineno"> 6645</span>&#160;</div><div class="line"><a name="l06646"></a><span class="lineno"> 6646</span>&#160;<span class="keyword">static</span> <a class="code" href="structlog__page.html">LOG_PAGE</a> *</div><div class="line"><a name="l06647"></a><span class="lineno"> 6647</span>&#160;log_dump_record_undoredo (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, FILE * out_fp, <a class="code" href="structlog__lsa.html">LOG_LSA</a> * <a class="code" href="structlog__lsa.html">log_lsa</a>, <a class="code" href="structlog__page.html">LOG_PAGE</a> * log_page_p,</div><div class="line"><a name="l06648"></a><span class="lineno"> 6648</span>&#160;              <a class="code" href="structlog__zip.html">LOG_ZIP</a> * log_zip_p)</div><div class="line"><a name="l06649"></a><span class="lineno"> 6649</span>&#160;{</div><div class="line"><a name="l06650"></a><span class="lineno"> 6650</span>&#160;  <a class="code" href="structlog__rec__undoredo.html">LOG_REC_UNDOREDO</a> *undoredo;</div><div class="line"><a name="l06651"></a><span class="lineno"> 6651</span>&#160;  <span class="keywordtype">int</span> undo_length;</div><div class="line"><a name="l06652"></a><span class="lineno"> 6652</span>&#160;  <span class="keywordtype">int</span> redo_length;</div><div class="line"><a name="l06653"></a><span class="lineno"> 6653</span>&#160;  <a class="code" href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2b">LOG_RCVINDEX</a> rcvindex;</div><div class="line"><a name="l06654"></a><span class="lineno"> 6654</span>&#160;</div><div class="line"><a name="l06655"></a><span class="lineno"> 6655</span>&#160;  <span class="comment">/* Read the DATA HEADER */</span></div><div class="line"><a name="l06656"></a><span class="lineno"> 6656</span>&#160;  <a class="code" href="log__impl_8h.html#a108c8143796ad50c65f64d4a483e9453">LOG_READ_ADVANCE_WHEN_DOESNT_FIT</a> (thread_p, <span class="keyword">sizeof</span> (*undoredo), <a class="code" href="structlog__lsa.html">log_lsa</a>, log_page_p);</div><div class="line"><a name="l06657"></a><span class="lineno"> 6657</span>&#160;  undoredo = (<a class="code" href="structlog__rec__undoredo.html">LOG_REC_UNDOREDO</a> *) ((<span class="keywordtype">char</span> *) log_page_p-&gt;<a class="code" href="structlog__page.html#a9b51b4623cdb8d1686f6f8fb64bc9ee2">area</a> + <a class="code" href="structlog__lsa.html">log_lsa</a>-&gt;<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a>);</div><div class="line"><a name="l06658"></a><span class="lineno"> 6658</span>&#160;  fprintf (out_fp, <span class="stringliteral">&quot;, Recv_index = %s, \n&quot;</span>, <a class="code" href="recovery_8c.html#a9489c3632ab4b52fc008b589ce45cbdc">rv_rcvindex_string</a> (undoredo-&gt;<a class="code" href="structlog__rec__undoredo.html#a3d088b72f92c7881d303916b3a1d7632">data</a>.<a class="code" href="structlog__data.html#ab1a17fceea659d32f5187b81a7b80412">rcvindex</a>));</div><div class="line"><a name="l06659"></a><span class="lineno"> 6659</span>&#160;  fprintf (out_fp,</div><div class="line"><a name="l06660"></a><span class="lineno"> 6660</span>&#160;       <span class="stringliteral">&quot;     Volid = %d Pageid = %d Offset = %d,\n     Undo(Before) length = %d, Redo(After) length = %d,\n&quot;</span>,</div><div class="line"><a name="l06661"></a><span class="lineno"> 6661</span>&#160;       undoredo-&gt;<a class="code" href="structlog__rec__undoredo.html#a3d088b72f92c7881d303916b3a1d7632">data</a>.<a class="code" href="structlog__data.html#ad5635159b85ee07322bf30e39a5dee76">volid</a>, undoredo-&gt;<a class="code" href="structlog__rec__undoredo.html#a3d088b72f92c7881d303916b3a1d7632">data</a>.<a class="code" href="structlog__data.html#a8410b9d70cc70d2bc6fb6df88ea48bb4">pageid</a>, undoredo-&gt;<a class="code" href="structlog__rec__undoredo.html#a3d088b72f92c7881d303916b3a1d7632">data</a>.<a class="code" href="structlog__data.html#afd25836b0952561036b01b5a50c310b2">offset</a>, (<span class="keywordtype">int</span>) <a class="code" href="log__compress_8h.html#ac32e36fd25b171236ebb38a5be94d00c">GET_ZIP_LEN</a> (undoredo-&gt;<a class="code" href="structlog__rec__undoredo.html#ae7cba71fbe8b2e543bfdb4fe792e1489">ulength</a>),</div><div class="line"><a name="l06662"></a><span class="lineno"> 6662</span>&#160;       (<span class="keywordtype">int</span>) <a class="code" href="log__compress_8h.html#ac32e36fd25b171236ebb38a5be94d00c">GET_ZIP_LEN</a> (undoredo-&gt;<a class="code" href="structlog__rec__undoredo.html#a3aa626d1fe1436d8f7a258688fafaf9f">rlength</a>));</div><div class="line"><a name="l06663"></a><span class="lineno"> 6663</span>&#160;</div><div class="line"><a name="l06664"></a><span class="lineno"> 6664</span>&#160;  undo_length = undoredo-&gt;<a class="code" href="structlog__rec__undoredo.html#ae7cba71fbe8b2e543bfdb4fe792e1489">ulength</a>;</div><div class="line"><a name="l06665"></a><span class="lineno"> 6665</span>&#160;  redo_length = undoredo-&gt;<a class="code" href="structlog__rec__undoredo.html#a3aa626d1fe1436d8f7a258688fafaf9f">rlength</a>;</div><div class="line"><a name="l06666"></a><span class="lineno"> 6666</span>&#160;  rcvindex = undoredo-&gt;<a class="code" href="structlog__rec__undoredo.html#a3d088b72f92c7881d303916b3a1d7632">data</a>.<a class="code" href="structlog__data.html#ab1a17fceea659d32f5187b81a7b80412">rcvindex</a>;</div><div class="line"><a name="l06667"></a><span class="lineno"> 6667</span>&#160;</div><div class="line"><a name="l06668"></a><span class="lineno"> 6668</span>&#160;  <a class="code" href="log__impl_8h.html#afdaa9fdf7d83212b3eec2d515e807686">LOG_READ_ADD_ALIGN</a> (thread_p, <span class="keyword">sizeof</span> (*undoredo), <a class="code" href="structlog__lsa.html">log_lsa</a>, log_page_p);</div><div class="line"><a name="l06669"></a><span class="lineno"> 6669</span>&#160;  <span class="comment">/* Print UNDO(BEFORE) DATA */</span></div><div class="line"><a name="l06670"></a><span class="lineno"> 6670</span>&#160;  fprintf (out_fp, <span class="stringliteral">&quot;--&gt;&gt; Undo (Before) Data:\n&quot;</span>);</div><div class="line"><a name="l06671"></a><span class="lineno"> 6671</span>&#160;  log_dump_data (thread_p, out_fp, undo_length, <a class="code" href="structlog__lsa.html">log_lsa</a>, log_page_p, <a class="code" href="recovery_8c.html#ad2eee9d1e5914fa34d3a7868bf2549f4">RV_fun</a>[rcvindex].dump_undofun, log_zip_p);</div><div class="line"><a name="l06672"></a><span class="lineno"> 6672</span>&#160;  <span class="comment">/* Print REDO (AFTER) DATA */</span></div><div class="line"><a name="l06673"></a><span class="lineno"> 6673</span>&#160;  fprintf (out_fp, <span class="stringliteral">&quot;--&gt;&gt; Redo (After) Data:\n&quot;</span>);</div><div class="line"><a name="l06674"></a><span class="lineno"> 6674</span>&#160;  log_dump_data (thread_p, out_fp, redo_length, <a class="code" href="structlog__lsa.html">log_lsa</a>, log_page_p, <a class="code" href="recovery_8c.html#ad2eee9d1e5914fa34d3a7868bf2549f4">RV_fun</a>[rcvindex].dump_redofun, log_zip_p);</div><div class="line"><a name="l06675"></a><span class="lineno"> 6675</span>&#160;</div><div class="line"><a name="l06676"></a><span class="lineno"> 6676</span>&#160;  <span class="keywordflow">return</span> log_page_p;</div><div class="line"><a name="l06677"></a><span class="lineno"> 6677</span>&#160;}</div><div class="line"><a name="l06678"></a><span class="lineno"> 6678</span>&#160;</div><div class="line"><a name="l06679"></a><span class="lineno"> 6679</span>&#160;<span class="keyword">static</span> <a class="code" href="structlog__page.html">LOG_PAGE</a> *</div><div class="line"><a name="l06680"></a><span class="lineno"> 6680</span>&#160;log_dump_record_undo (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, FILE * out_fp, <a class="code" href="structlog__lsa.html">LOG_LSA</a> * <a class="code" href="structlog__lsa.html">log_lsa</a>, <a class="code" href="structlog__page.html">LOG_PAGE</a> * log_page_p,</div><div class="line"><a name="l06681"></a><span class="lineno"> 6681</span>&#160;              <a class="code" href="structlog__zip.html">LOG_ZIP</a> * log_zip_p)</div><div class="line"><a name="l06682"></a><span class="lineno"> 6682</span>&#160;{</div><div class="line"><a name="l06683"></a><span class="lineno"> 6683</span>&#160;  <a class="code" href="structlog__rec__undo.html">LOG_REC_UNDO</a> *undo;</div><div class="line"><a name="l06684"></a><span class="lineno"> 6684</span>&#160;  <span class="keywordtype">int</span> undo_length;</div><div class="line"><a name="l06685"></a><span class="lineno"> 6685</span>&#160;  <a class="code" href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2b">LOG_RCVINDEX</a> rcvindex;</div><div class="line"><a name="l06686"></a><span class="lineno"> 6686</span>&#160;</div><div class="line"><a name="l06687"></a><span class="lineno"> 6687</span>&#160;  <span class="comment">/* Read the DATA HEADER */</span></div><div class="line"><a name="l06688"></a><span class="lineno"> 6688</span>&#160;  <a class="code" href="log__impl_8h.html#a108c8143796ad50c65f64d4a483e9453">LOG_READ_ADVANCE_WHEN_DOESNT_FIT</a> (thread_p, <span class="keyword">sizeof</span> (*undo), <a class="code" href="structlog__lsa.html">log_lsa</a>, log_page_p);</div><div class="line"><a name="l06689"></a><span class="lineno"> 6689</span>&#160;  undo = (<a class="code" href="structlog__rec__undo.html">LOG_REC_UNDO</a> *) ((<span class="keywordtype">char</span> *) log_page_p-&gt;<a class="code" href="structlog__page.html#a9b51b4623cdb8d1686f6f8fb64bc9ee2">area</a> + <a class="code" href="structlog__lsa.html">log_lsa</a>-&gt;<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a>);</div><div class="line"><a name="l06690"></a><span class="lineno"> 6690</span>&#160;</div><div class="line"><a name="l06691"></a><span class="lineno"> 6691</span>&#160;  fprintf (out_fp, <span class="stringliteral">&quot;, Recv_index = %s,\n&quot;</span>, <a class="code" href="recovery_8c.html#a9489c3632ab4b52fc008b589ce45cbdc">rv_rcvindex_string</a> (undo-&gt;<a class="code" href="structlog__rec__undo.html#a08b364e1c642e56ea610a5e51beb7d2b">data</a>.<a class="code" href="structlog__data.html#ab1a17fceea659d32f5187b81a7b80412">rcvindex</a>));</div><div class="line"><a name="l06692"></a><span class="lineno"> 6692</span>&#160;  fprintf (out_fp, <span class="stringliteral">&quot;     Volid = %d Pageid = %d Offset = %d,\n     Undo (Before) length = %d,\n&quot;</span>, undo-&gt;<a class="code" href="structlog__rec__undo.html#a08b364e1c642e56ea610a5e51beb7d2b">data</a>.<a class="code" href="structlog__data.html#ad5635159b85ee07322bf30e39a5dee76">volid</a>,</div><div class="line"><a name="l06693"></a><span class="lineno"> 6693</span>&#160;       undo-&gt;<a class="code" href="structlog__rec__undo.html#a08b364e1c642e56ea610a5e51beb7d2b">data</a>.<a class="code" href="structlog__data.html#a8410b9d70cc70d2bc6fb6df88ea48bb4">pageid</a>, undo-&gt;<a class="code" href="structlog__rec__undo.html#a08b364e1c642e56ea610a5e51beb7d2b">data</a>.<a class="code" href="structlog__data.html#afd25836b0952561036b01b5a50c310b2">offset</a>, (<span class="keywordtype">int</span>) <a class="code" href="log__compress_8h.html#ac32e36fd25b171236ebb38a5be94d00c">GET_ZIP_LEN</a> (undo-&gt;<a class="code" href="structlog__rec__undo.html#a50bcc130d05619893dbb63c284c3e874">length</a>));</div><div class="line"><a name="l06694"></a><span class="lineno"> 6694</span>&#160;</div><div class="line"><a name="l06695"></a><span class="lineno"> 6695</span>&#160;  undo_length = undo-&gt;<a class="code" href="structlog__rec__undo.html#a50bcc130d05619893dbb63c284c3e874">length</a>;</div><div class="line"><a name="l06696"></a><span class="lineno"> 6696</span>&#160;  rcvindex = undo-&gt;<a class="code" href="structlog__rec__undo.html#a08b364e1c642e56ea610a5e51beb7d2b">data</a>.<a class="code" href="structlog__data.html#ab1a17fceea659d32f5187b81a7b80412">rcvindex</a>;</div><div class="line"><a name="l06697"></a><span class="lineno"> 6697</span>&#160;  <a class="code" href="log__impl_8h.html#afdaa9fdf7d83212b3eec2d515e807686">LOG_READ_ADD_ALIGN</a> (thread_p, <span class="keyword">sizeof</span> (*undo), <a class="code" href="structlog__lsa.html">log_lsa</a>, log_page_p);</div><div class="line"><a name="l06698"></a><span class="lineno"> 6698</span>&#160;</div><div class="line"><a name="l06699"></a><span class="lineno"> 6699</span>&#160;  <span class="comment">/* Print UNDO(BEFORE) DATA */</span></div><div class="line"><a name="l06700"></a><span class="lineno"> 6700</span>&#160;  fprintf (out_fp, <span class="stringliteral">&quot;--&gt;&gt; Undo (Before) Data:\n&quot;</span>);</div><div class="line"><a name="l06701"></a><span class="lineno"> 6701</span>&#160;  log_dump_data (thread_p, out_fp, undo_length, <a class="code" href="structlog__lsa.html">log_lsa</a>, log_page_p, <a class="code" href="recovery_8c.html#ad2eee9d1e5914fa34d3a7868bf2549f4">RV_fun</a>[rcvindex].dump_undofun, log_zip_p);</div><div class="line"><a name="l06702"></a><span class="lineno"> 6702</span>&#160;</div><div class="line"><a name="l06703"></a><span class="lineno"> 6703</span>&#160;  <span class="keywordflow">return</span> log_page_p;</div><div class="line"><a name="l06704"></a><span class="lineno"> 6704</span>&#160;}</div><div class="line"><a name="l06705"></a><span class="lineno"> 6705</span>&#160;</div><div class="line"><a name="l06706"></a><span class="lineno"> 6706</span>&#160;<span class="keyword">static</span> <a class="code" href="structlog__page.html">LOG_PAGE</a> *</div><div class="line"><a name="l06707"></a><span class="lineno"> 6707</span>&#160;log_dump_record_redo (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, FILE * out_fp, <a class="code" href="structlog__lsa.html">LOG_LSA</a> * <a class="code" href="structlog__lsa.html">log_lsa</a>, <a class="code" href="structlog__page.html">LOG_PAGE</a> * log_page_p,</div><div class="line"><a name="l06708"></a><span class="lineno"> 6708</span>&#160;              <a class="code" href="structlog__zip.html">LOG_ZIP</a> * log_zip_p)</div><div class="line"><a name="l06709"></a><span class="lineno"> 6709</span>&#160;{</div><div class="line"><a name="l06710"></a><span class="lineno"> 6710</span>&#160;  <a class="code" href="structlog__rec__redo.html">LOG_REC_REDO</a> *redo;</div><div class="line"><a name="l06711"></a><span class="lineno"> 6711</span>&#160;  <span class="keywordtype">int</span> redo_length;</div><div class="line"><a name="l06712"></a><span class="lineno"> 6712</span>&#160;  <a class="code" href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2b">LOG_RCVINDEX</a> rcvindex;</div><div class="line"><a name="l06713"></a><span class="lineno"> 6713</span>&#160;</div><div class="line"><a name="l06714"></a><span class="lineno"> 6714</span>&#160;  <span class="comment">/* Read the DATA HEADER */</span></div><div class="line"><a name="l06715"></a><span class="lineno"> 6715</span>&#160;  <a class="code" href="log__impl_8h.html#a108c8143796ad50c65f64d4a483e9453">LOG_READ_ADVANCE_WHEN_DOESNT_FIT</a> (thread_p, <span class="keyword">sizeof</span> (*redo), <a class="code" href="structlog__lsa.html">log_lsa</a>, log_page_p);</div><div class="line"><a name="l06716"></a><span class="lineno"> 6716</span>&#160;  redo = (<a class="code" href="structlog__rec__redo.html">LOG_REC_REDO</a> *) ((<span class="keywordtype">char</span> *) log_page_p-&gt;<a class="code" href="structlog__page.html#a9b51b4623cdb8d1686f6f8fb64bc9ee2">area</a> + <a class="code" href="structlog__lsa.html">log_lsa</a>-&gt;<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a>);</div><div class="line"><a name="l06717"></a><span class="lineno"> 6717</span>&#160;</div><div class="line"><a name="l06718"></a><span class="lineno"> 6718</span>&#160;  fprintf (out_fp, <span class="stringliteral">&quot;, Recv_index = %s,\n&quot;</span>, <a class="code" href="recovery_8c.html#a9489c3632ab4b52fc008b589ce45cbdc">rv_rcvindex_string</a> (redo-&gt;<a class="code" href="structlog__rec__redo.html#a96ea9b5f13d7c0934ec9b5cd95ae274d">data</a>.<a class="code" href="structlog__data.html#ab1a17fceea659d32f5187b81a7b80412">rcvindex</a>));</div><div class="line"><a name="l06719"></a><span class="lineno"> 6719</span>&#160;  fprintf (out_fp, <span class="stringliteral">&quot;     Volid = %d Pageid = %d Offset = %d,\n     Redo (After) length = %d,\n&quot;</span>, redo-&gt;<a class="code" href="structlog__rec__redo.html#a96ea9b5f13d7c0934ec9b5cd95ae274d">data</a>.<a class="code" href="structlog__data.html#ad5635159b85ee07322bf30e39a5dee76">volid</a>,</div><div class="line"><a name="l06720"></a><span class="lineno"> 6720</span>&#160;       redo-&gt;<a class="code" href="structlog__rec__redo.html#a96ea9b5f13d7c0934ec9b5cd95ae274d">data</a>.<a class="code" href="structlog__data.html#a8410b9d70cc70d2bc6fb6df88ea48bb4">pageid</a>, redo-&gt;<a class="code" href="structlog__rec__redo.html#a96ea9b5f13d7c0934ec9b5cd95ae274d">data</a>.<a class="code" href="structlog__data.html#afd25836b0952561036b01b5a50c310b2">offset</a>, (<span class="keywordtype">int</span>) <a class="code" href="log__compress_8h.html#ac32e36fd25b171236ebb38a5be94d00c">GET_ZIP_LEN</a> (redo-&gt;<a class="code" href="structlog__rec__redo.html#a0a55afc612491df6d6b3b4be22d1c703">length</a>));</div><div class="line"><a name="l06721"></a><span class="lineno"> 6721</span>&#160;</div><div class="line"><a name="l06722"></a><span class="lineno"> 6722</span>&#160;  redo_length = redo-&gt;<a class="code" href="structlog__rec__redo.html#a0a55afc612491df6d6b3b4be22d1c703">length</a>;</div><div class="line"><a name="l06723"></a><span class="lineno"> 6723</span>&#160;  rcvindex = redo-&gt;<a class="code" href="structlog__rec__redo.html#a96ea9b5f13d7c0934ec9b5cd95ae274d">data</a>.<a class="code" href="structlog__data.html#ab1a17fceea659d32f5187b81a7b80412">rcvindex</a>;</div><div class="line"><a name="l06724"></a><span class="lineno"> 6724</span>&#160;  <a class="code" href="log__impl_8h.html#afdaa9fdf7d83212b3eec2d515e807686">LOG_READ_ADD_ALIGN</a> (thread_p, <span class="keyword">sizeof</span> (*redo), <a class="code" href="structlog__lsa.html">log_lsa</a>, log_page_p);</div><div class="line"><a name="l06725"></a><span class="lineno"> 6725</span>&#160;</div><div class="line"><a name="l06726"></a><span class="lineno"> 6726</span>&#160;  <span class="comment">/* Print REDO(AFTER) DATA */</span></div><div class="line"><a name="l06727"></a><span class="lineno"> 6727</span>&#160;  fprintf (out_fp, <span class="stringliteral">&quot;--&gt;&gt; Redo (After) Data:\n&quot;</span>);</div><div class="line"><a name="l06728"></a><span class="lineno"> 6728</span>&#160;  log_dump_data (thread_p, out_fp, redo_length, <a class="code" href="structlog__lsa.html">log_lsa</a>, log_page_p, <a class="code" href="recovery_8c.html#ad2eee9d1e5914fa34d3a7868bf2549f4">RV_fun</a>[rcvindex].dump_redofun, log_zip_p);</div><div class="line"><a name="l06729"></a><span class="lineno"> 6729</span>&#160;</div><div class="line"><a name="l06730"></a><span class="lineno"> 6730</span>&#160;  <span class="keywordflow">return</span> log_page_p;</div><div class="line"><a name="l06731"></a><span class="lineno"> 6731</span>&#160;}</div><div class="line"><a name="l06732"></a><span class="lineno"> 6732</span>&#160;</div><div class="line"><a name="l06733"></a><span class="lineno"> 6733</span>&#160;<span class="keyword">static</span> <a class="code" href="structlog__page.html">LOG_PAGE</a> *</div><div class="line"><a name="l06734"></a><span class="lineno"> 6734</span>&#160;log_dump_record_mvcc_undoredo (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, FILE * out_fp, <a class="code" href="structlog__lsa.html">LOG_LSA</a> * <a class="code" href="structlog__lsa.html">log_lsa</a>, <a class="code" href="structlog__page.html">LOG_PAGE</a> * log_page_p,</div><div class="line"><a name="l06735"></a><span class="lineno"> 6735</span>&#160;                   <a class="code" href="structlog__zip.html">LOG_ZIP</a> * log_zip_p)</div><div class="line"><a name="l06736"></a><span class="lineno"> 6736</span>&#160;{</div><div class="line"><a name="l06737"></a><span class="lineno"> 6737</span>&#160;  <a class="code" href="structlog__rec__mvcc__undoredo.html">LOG_REC_MVCC_UNDOREDO</a> *mvcc_undoredo;</div><div class="line"><a name="l06738"></a><span class="lineno"> 6738</span>&#160;  <span class="keywordtype">int</span> undo_length;</div><div class="line"><a name="l06739"></a><span class="lineno"> 6739</span>&#160;  <span class="keywordtype">int</span> redo_length;</div><div class="line"><a name="l06740"></a><span class="lineno"> 6740</span>&#160;  <a class="code" href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2b">LOG_RCVINDEX</a> rcvindex;</div><div class="line"><a name="l06741"></a><span class="lineno"> 6741</span>&#160;</div><div class="line"><a name="l06742"></a><span class="lineno"> 6742</span>&#160;  <span class="comment">/* Read the DATA HEADER */</span></div><div class="line"><a name="l06743"></a><span class="lineno"> 6743</span>&#160;  <a class="code" href="log__impl_8h.html#a108c8143796ad50c65f64d4a483e9453">LOG_READ_ADVANCE_WHEN_DOESNT_FIT</a> (thread_p, <span class="keyword">sizeof</span> (*mvcc_undoredo), <a class="code" href="structlog__lsa.html">log_lsa</a>, log_page_p);</div><div class="line"><a name="l06744"></a><span class="lineno"> 6744</span>&#160;  mvcc_undoredo = (<a class="code" href="structlog__rec__mvcc__undoredo.html">LOG_REC_MVCC_UNDOREDO</a> *) ((<span class="keywordtype">char</span> *) log_page_p-&gt;<a class="code" href="structlog__page.html#a9b51b4623cdb8d1686f6f8fb64bc9ee2">area</a> + <a class="code" href="structlog__lsa.html">log_lsa</a>-&gt;<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a>);</div><div class="line"><a name="l06745"></a><span class="lineno"> 6745</span>&#160;  fprintf (out_fp, <span class="stringliteral">&quot;, Recv_index = %s, \n&quot;</span>, <a class="code" href="recovery_8c.html#a9489c3632ab4b52fc008b589ce45cbdc">rv_rcvindex_string</a> (mvcc_undoredo-&gt;<a class="code" href="structlog__rec__mvcc__undoredo.html#a2183ac89e08754f146da20b81dc18a24">undoredo</a>.<a class="code" href="structlog__rec__undoredo.html#a3d088b72f92c7881d303916b3a1d7632">data</a>.<a class="code" href="structlog__data.html#ab1a17fceea659d32f5187b81a7b80412">rcvindex</a>));</div><div class="line"><a name="l06746"></a><span class="lineno"> 6746</span>&#160;  fprintf (out_fp,</div><div class="line"><a name="l06747"></a><span class="lineno"> 6747</span>&#160;       <span class="stringliteral">&quot;     Volid = %d Pageid = %d Offset = %d,\n     Undo(Before) length = %d, Redo(After) length = %d,\n&quot;</span>,</div><div class="line"><a name="l06748"></a><span class="lineno"> 6748</span>&#160;       mvcc_undoredo-&gt;<a class="code" href="structlog__rec__mvcc__undoredo.html#a2183ac89e08754f146da20b81dc18a24">undoredo</a>.<a class="code" href="structlog__rec__undoredo.html#a3d088b72f92c7881d303916b3a1d7632">data</a>.<a class="code" href="structlog__data.html#ad5635159b85ee07322bf30e39a5dee76">volid</a>, mvcc_undoredo-&gt;<a class="code" href="structlog__rec__mvcc__undoredo.html#a2183ac89e08754f146da20b81dc18a24">undoredo</a>.<a class="code" href="structlog__rec__undoredo.html#a3d088b72f92c7881d303916b3a1d7632">data</a>.<a class="code" href="structlog__data.html#a8410b9d70cc70d2bc6fb6df88ea48bb4">pageid</a>, mvcc_undoredo-&gt;<a class="code" href="structlog__rec__mvcc__undoredo.html#a2183ac89e08754f146da20b81dc18a24">undoredo</a>.<a class="code" href="structlog__rec__undoredo.html#a3d088b72f92c7881d303916b3a1d7632">data</a>.<a class="code" href="structlog__data.html#afd25836b0952561036b01b5a50c310b2">offset</a>,</div><div class="line"><a name="l06749"></a><span class="lineno"> 6749</span>&#160;       (<span class="keywordtype">int</span>) <a class="code" href="log__compress_8h.html#ac32e36fd25b171236ebb38a5be94d00c">GET_ZIP_LEN</a> (mvcc_undoredo-&gt;<a class="code" href="structlog__rec__mvcc__undoredo.html#a2183ac89e08754f146da20b81dc18a24">undoredo</a>.<a class="code" href="structlog__rec__undoredo.html#ae7cba71fbe8b2e543bfdb4fe792e1489">ulength</a>), (<span class="keywordtype">int</span>) <a class="code" href="log__compress_8h.html#ac32e36fd25b171236ebb38a5be94d00c">GET_ZIP_LEN</a> (mvcc_undoredo-&gt;<a class="code" href="structlog__rec__mvcc__undoredo.html#a2183ac89e08754f146da20b81dc18a24">undoredo</a>.<a class="code" href="structlog__rec__undoredo.html#a3aa626d1fe1436d8f7a258688fafaf9f">rlength</a>));</div><div class="line"><a name="l06750"></a><span class="lineno"> 6750</span>&#160;  fprintf (out_fp, <span class="stringliteral">&quot;     MVCCID = %llu, \n     Prev_mvcc_op_log_lsa = %lld|%d, \n     VFID = (%d, %d)&quot;</span>,</div><div class="line"><a name="l06751"></a><span class="lineno"> 6751</span>&#160;       (<span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span>) mvcc_undoredo-&gt;<a class="code" href="structlog__rec__mvcc__undoredo.html#adf64ef5b403ea259100fa835d9b75c12">mvccid</a>,</div><div class="line"><a name="l06752"></a><span class="lineno"> 6752</span>&#160;       (<span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span>) mvcc_undoredo-&gt;<a class="code" href="structlog__rec__mvcc__undoredo.html#ac07321188e6dd5041d4398462ee0c1cf">vacuum_info</a>.<a class="code" href="structlog__vacuum__info.html#a1fc0aeb2562118f210e453ffff9d75da">prev_mvcc_op_log_lsa</a>.<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a>,</div><div class="line"><a name="l06753"></a><span class="lineno"> 6753</span>&#160;       (<span class="keywordtype">int</span>) mvcc_undoredo-&gt;<a class="code" href="structlog__rec__mvcc__undoredo.html#ac07321188e6dd5041d4398462ee0c1cf">vacuum_info</a>.<a class="code" href="structlog__vacuum__info.html#a1fc0aeb2562118f210e453ffff9d75da">prev_mvcc_op_log_lsa</a>.<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a>, mvcc_undoredo-&gt;<a class="code" href="structlog__rec__mvcc__undoredo.html#ac07321188e6dd5041d4398462ee0c1cf">vacuum_info</a>.<a class="code" href="structlog__vacuum__info.html#aeb919b86c45ee91e08f67f3c13bb9465">vfid</a>.<a class="code" href="structvfid.html#a09b59011789a52a37f2061aa7bf93477">volid</a>,</div><div class="line"><a name="l06754"></a><span class="lineno"> 6754</span>&#160;       mvcc_undoredo-&gt;<a class="code" href="structlog__rec__mvcc__undoredo.html#ac07321188e6dd5041d4398462ee0c1cf">vacuum_info</a>.<a class="code" href="structlog__vacuum__info.html#aeb919b86c45ee91e08f67f3c13bb9465">vfid</a>.<a class="code" href="structvfid.html#a5ffe7d18a4d504c67610dfd928774ad6">fileid</a>);</div><div class="line"><a name="l06755"></a><span class="lineno"> 6755</span>&#160;</div><div class="line"><a name="l06756"></a><span class="lineno"> 6756</span>&#160;  undo_length = mvcc_undoredo-&gt;<a class="code" href="structlog__rec__mvcc__undoredo.html#a2183ac89e08754f146da20b81dc18a24">undoredo</a>.<a class="code" href="structlog__rec__undoredo.html#ae7cba71fbe8b2e543bfdb4fe792e1489">ulength</a>;</div><div class="line"><a name="l06757"></a><span class="lineno"> 6757</span>&#160;  redo_length = mvcc_undoredo-&gt;<a class="code" href="structlog__rec__mvcc__undoredo.html#a2183ac89e08754f146da20b81dc18a24">undoredo</a>.<a class="code" href="structlog__rec__undoredo.html#a3aa626d1fe1436d8f7a258688fafaf9f">rlength</a>;</div><div class="line"><a name="l06758"></a><span class="lineno"> 6758</span>&#160;  rcvindex = mvcc_undoredo-&gt;<a class="code" href="structlog__rec__mvcc__undoredo.html#a2183ac89e08754f146da20b81dc18a24">undoredo</a>.<a class="code" href="structlog__rec__undoredo.html#a3d088b72f92c7881d303916b3a1d7632">data</a>.<a class="code" href="structlog__data.html#ab1a17fceea659d32f5187b81a7b80412">rcvindex</a>;</div><div class="line"><a name="l06759"></a><span class="lineno"> 6759</span>&#160;</div><div class="line"><a name="l06760"></a><span class="lineno"> 6760</span>&#160;  <a class="code" href="log__impl_8h.html#afdaa9fdf7d83212b3eec2d515e807686">LOG_READ_ADD_ALIGN</a> (thread_p, <span class="keyword">sizeof</span> (*mvcc_undoredo), <a class="code" href="structlog__lsa.html">log_lsa</a>, log_page_p);</div><div class="line"><a name="l06761"></a><span class="lineno"> 6761</span>&#160;  <span class="comment">/* Print UNDO(BEFORE) DATA */</span></div><div class="line"><a name="l06762"></a><span class="lineno"> 6762</span>&#160;  fprintf (out_fp, <span class="stringliteral">&quot;--&gt;&gt; Undo (Before) Data:\n&quot;</span>);</div><div class="line"><a name="l06763"></a><span class="lineno"> 6763</span>&#160;  log_dump_data (thread_p, out_fp, undo_length, <a class="code" href="structlog__lsa.html">log_lsa</a>, log_page_p, <a class="code" href="recovery_8c.html#ad2eee9d1e5914fa34d3a7868bf2549f4">RV_fun</a>[rcvindex].dump_undofun, log_zip_p);</div><div class="line"><a name="l06764"></a><span class="lineno"> 6764</span>&#160;  <span class="comment">/* Print REDO (AFTER) DATA */</span></div><div class="line"><a name="l06765"></a><span class="lineno"> 6765</span>&#160;  fprintf (out_fp, <span class="stringliteral">&quot;--&gt;&gt; Redo (After) Data:\n&quot;</span>);</div><div class="line"><a name="l06766"></a><span class="lineno"> 6766</span>&#160;  log_dump_data (thread_p, out_fp, redo_length, <a class="code" href="structlog__lsa.html">log_lsa</a>, log_page_p, <a class="code" href="recovery_8c.html#ad2eee9d1e5914fa34d3a7868bf2549f4">RV_fun</a>[rcvindex].dump_redofun, log_zip_p);</div><div class="line"><a name="l06767"></a><span class="lineno"> 6767</span>&#160;</div><div class="line"><a name="l06768"></a><span class="lineno"> 6768</span>&#160;  <span class="keywordflow">return</span> log_page_p;</div><div class="line"><a name="l06769"></a><span class="lineno"> 6769</span>&#160;}</div><div class="line"><a name="l06770"></a><span class="lineno"> 6770</span>&#160;</div><div class="line"><a name="l06771"></a><span class="lineno"> 6771</span>&#160;<span class="keyword">static</span> <a class="code" href="structlog__page.html">LOG_PAGE</a> *</div><div class="line"><a name="l06772"></a><span class="lineno"> 6772</span>&#160;log_dump_record_mvcc_undo (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, FILE * out_fp, <a class="code" href="structlog__lsa.html">LOG_LSA</a> * <a class="code" href="structlog__lsa.html">log_lsa</a>, <a class="code" href="structlog__page.html">LOG_PAGE</a> * log_page_p,</div><div class="line"><a name="l06773"></a><span class="lineno"> 6773</span>&#160;               <a class="code" href="structlog__zip.html">LOG_ZIP</a> * log_zip_p)</div><div class="line"><a name="l06774"></a><span class="lineno"> 6774</span>&#160;{</div><div class="line"><a name="l06775"></a><span class="lineno"> 6775</span>&#160;  <a class="code" href="structlog__rec__mvcc__undo.html">LOG_REC_MVCC_UNDO</a> *mvcc_undo;</div><div class="line"><a name="l06776"></a><span class="lineno"> 6776</span>&#160;  <span class="keywordtype">int</span> undo_length;</div><div class="line"><a name="l06777"></a><span class="lineno"> 6777</span>&#160;  <a class="code" href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2b">LOG_RCVINDEX</a> rcvindex;</div><div class="line"><a name="l06778"></a><span class="lineno"> 6778</span>&#160;</div><div class="line"><a name="l06779"></a><span class="lineno"> 6779</span>&#160;  <span class="comment">/* Read the DATA HEADER */</span></div><div class="line"><a name="l06780"></a><span class="lineno"> 6780</span>&#160;  <a class="code" href="log__impl_8h.html#a108c8143796ad50c65f64d4a483e9453">LOG_READ_ADVANCE_WHEN_DOESNT_FIT</a> (thread_p, <span class="keyword">sizeof</span> (*mvcc_undo), <a class="code" href="structlog__lsa.html">log_lsa</a>, log_page_p);</div><div class="line"><a name="l06781"></a><span class="lineno"> 6781</span>&#160;  mvcc_undo = (<a class="code" href="structlog__rec__mvcc__undo.html">LOG_REC_MVCC_UNDO</a> *) ((<span class="keywordtype">char</span> *) log_page_p-&gt;<a class="code" href="structlog__page.html#a9b51b4623cdb8d1686f6f8fb64bc9ee2">area</a> + <a class="code" href="structlog__lsa.html">log_lsa</a>-&gt;<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a>);</div><div class="line"><a name="l06782"></a><span class="lineno"> 6782</span>&#160;</div><div class="line"><a name="l06783"></a><span class="lineno"> 6783</span>&#160;  fprintf (out_fp, <span class="stringliteral">&quot;, Recv_index = %s,\n&quot;</span>, <a class="code" href="recovery_8c.html#a9489c3632ab4b52fc008b589ce45cbdc">rv_rcvindex_string</a> (mvcc_undo-&gt;<a class="code" href="structlog__rec__mvcc__undo.html#a7f17cde1def984989174d8aca50307b6">undo</a>.<a class="code" href="structlog__rec__undo.html#a08b364e1c642e56ea610a5e51beb7d2b">data</a>.<a class="code" href="structlog__data.html#ab1a17fceea659d32f5187b81a7b80412">rcvindex</a>));</div><div class="line"><a name="l06784"></a><span class="lineno"> 6784</span>&#160;  fprintf (out_fp, <span class="stringliteral">&quot;     Volid = %d Pageid = %d Offset = %d,\n     Undo (Before) length = %d,\n&quot;</span>,</div><div class="line"><a name="l06785"></a><span class="lineno"> 6785</span>&#160;       mvcc_undo-&gt;<a class="code" href="structlog__rec__mvcc__undo.html#a7f17cde1def984989174d8aca50307b6">undo</a>.<a class="code" href="structlog__rec__undo.html#a08b364e1c642e56ea610a5e51beb7d2b">data</a>.<a class="code" href="structlog__data.html#ad5635159b85ee07322bf30e39a5dee76">volid</a>, mvcc_undo-&gt;<a class="code" href="structlog__rec__mvcc__undo.html#a7f17cde1def984989174d8aca50307b6">undo</a>.<a class="code" href="structlog__rec__undo.html#a08b364e1c642e56ea610a5e51beb7d2b">data</a>.<a class="code" href="structlog__data.html#a8410b9d70cc70d2bc6fb6df88ea48bb4">pageid</a>, mvcc_undo-&gt;<a class="code" href="structlog__rec__mvcc__undo.html#a7f17cde1def984989174d8aca50307b6">undo</a>.<a class="code" href="structlog__rec__undo.html#a08b364e1c642e56ea610a5e51beb7d2b">data</a>.<a class="code" href="structlog__data.html#afd25836b0952561036b01b5a50c310b2">offset</a>,</div><div class="line"><a name="l06786"></a><span class="lineno"> 6786</span>&#160;       (<span class="keywordtype">int</span>) <a class="code" href="log__compress_8h.html#ac32e36fd25b171236ebb38a5be94d00c">GET_ZIP_LEN</a> (mvcc_undo-&gt;<a class="code" href="structlog__rec__mvcc__undo.html#a7f17cde1def984989174d8aca50307b6">undo</a>.<a class="code" href="structlog__rec__undo.html#a50bcc130d05619893dbb63c284c3e874">length</a>));</div><div class="line"><a name="l06787"></a><span class="lineno"> 6787</span>&#160;  fprintf (out_fp, <span class="stringliteral">&quot;     MVCCID = %llu, \n     Prev_mvcc_op_log_lsa = %lld|%d, \n     VFID = (%d, %d)&quot;</span>,</div><div class="line"><a name="l06788"></a><span class="lineno"> 6788</span>&#160;       (<span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span>) mvcc_undo-&gt;<a class="code" href="structlog__rec__mvcc__undo.html#ae7c1bf9c8eb5a86167f621ac40445f96">mvccid</a>, (<span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span>) mvcc_undo-&gt;<a class="code" href="structlog__rec__mvcc__undo.html#afb6e7f17fc0d9cbb25f0d94e0bba4efd">vacuum_info</a>.<a class="code" href="structlog__vacuum__info.html#a1fc0aeb2562118f210e453ffff9d75da">prev_mvcc_op_log_lsa</a>.<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a>,</div><div class="line"><a name="l06789"></a><span class="lineno"> 6789</span>&#160;       (<span class="keywordtype">int</span>) mvcc_undo-&gt;<a class="code" href="structlog__rec__mvcc__undo.html#afb6e7f17fc0d9cbb25f0d94e0bba4efd">vacuum_info</a>.<a class="code" href="structlog__vacuum__info.html#a1fc0aeb2562118f210e453ffff9d75da">prev_mvcc_op_log_lsa</a>.<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a>, mvcc_undo-&gt;<a class="code" href="structlog__rec__mvcc__undo.html#afb6e7f17fc0d9cbb25f0d94e0bba4efd">vacuum_info</a>.<a class="code" href="structlog__vacuum__info.html#aeb919b86c45ee91e08f67f3c13bb9465">vfid</a>.<a class="code" href="structvfid.html#a09b59011789a52a37f2061aa7bf93477">volid</a>,</div><div class="line"><a name="l06790"></a><span class="lineno"> 6790</span>&#160;       mvcc_undo-&gt;<a class="code" href="structlog__rec__mvcc__undo.html#afb6e7f17fc0d9cbb25f0d94e0bba4efd">vacuum_info</a>.<a class="code" href="structlog__vacuum__info.html#aeb919b86c45ee91e08f67f3c13bb9465">vfid</a>.<a class="code" href="structvfid.html#a5ffe7d18a4d504c67610dfd928774ad6">fileid</a>);</div><div class="line"><a name="l06791"></a><span class="lineno"> 6791</span>&#160;</div><div class="line"><a name="l06792"></a><span class="lineno"> 6792</span>&#160;  undo_length = mvcc_undo-&gt;<a class="code" href="structlog__rec__mvcc__undo.html#a7f17cde1def984989174d8aca50307b6">undo</a>.<a class="code" href="structlog__rec__undo.html#a50bcc130d05619893dbb63c284c3e874">length</a>;</div><div class="line"><a name="l06793"></a><span class="lineno"> 6793</span>&#160;  rcvindex = mvcc_undo-&gt;<a class="code" href="structlog__rec__mvcc__undo.html#a7f17cde1def984989174d8aca50307b6">undo</a>.<a class="code" href="structlog__rec__undo.html#a08b364e1c642e56ea610a5e51beb7d2b">data</a>.<a class="code" href="structlog__data.html#ab1a17fceea659d32f5187b81a7b80412">rcvindex</a>;</div><div class="line"><a name="l06794"></a><span class="lineno"> 6794</span>&#160;  <a class="code" href="log__impl_8h.html#afdaa9fdf7d83212b3eec2d515e807686">LOG_READ_ADD_ALIGN</a> (thread_p, <span class="keyword">sizeof</span> (*mvcc_undo), <a class="code" href="structlog__lsa.html">log_lsa</a>, log_page_p);</div><div class="line"><a name="l06795"></a><span class="lineno"> 6795</span>&#160;</div><div class="line"><a name="l06796"></a><span class="lineno"> 6796</span>&#160;  <span class="comment">/* Print UNDO(BEFORE) DATA */</span></div><div class="line"><a name="l06797"></a><span class="lineno"> 6797</span>&#160;  fprintf (out_fp, <span class="stringliteral">&quot;--&gt;&gt; Undo (Before) Data:\n&quot;</span>);</div><div class="line"><a name="l06798"></a><span class="lineno"> 6798</span>&#160;  log_dump_data (thread_p, out_fp, undo_length, <a class="code" href="structlog__lsa.html">log_lsa</a>, log_page_p, <a class="code" href="recovery_8c.html#ad2eee9d1e5914fa34d3a7868bf2549f4">RV_fun</a>[rcvindex].dump_undofun, log_zip_p);</div><div class="line"><a name="l06799"></a><span class="lineno"> 6799</span>&#160;</div><div class="line"><a name="l06800"></a><span class="lineno"> 6800</span>&#160;  <span class="keywordflow">return</span> log_page_p;</div><div class="line"><a name="l06801"></a><span class="lineno"> 6801</span>&#160;}</div><div class="line"><a name="l06802"></a><span class="lineno"> 6802</span>&#160;</div><div class="line"><a name="l06803"></a><span class="lineno"> 6803</span>&#160;<span class="keyword">static</span> <a class="code" href="structlog__page.html">LOG_PAGE</a> *</div><div class="line"><a name="l06804"></a><span class="lineno"> 6804</span>&#160;log_dump_record_mvcc_redo (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, FILE * out_fp, <a class="code" href="structlog__lsa.html">LOG_LSA</a> * <a class="code" href="structlog__lsa.html">log_lsa</a>, <a class="code" href="structlog__page.html">LOG_PAGE</a> * log_page_p,</div><div class="line"><a name="l06805"></a><span class="lineno"> 6805</span>&#160;               <a class="code" href="structlog__zip.html">LOG_ZIP</a> * log_zip_p)</div><div class="line"><a name="l06806"></a><span class="lineno"> 6806</span>&#160;{</div><div class="line"><a name="l06807"></a><span class="lineno"> 6807</span>&#160;  <a class="code" href="structlog__rec__mvcc__redo.html">LOG_REC_MVCC_REDO</a> *mvcc_redo;</div><div class="line"><a name="l06808"></a><span class="lineno"> 6808</span>&#160;  <span class="keywordtype">int</span> redo_length;</div><div class="line"><a name="l06809"></a><span class="lineno"> 6809</span>&#160;  <a class="code" href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2b">LOG_RCVINDEX</a> rcvindex;</div><div class="line"><a name="l06810"></a><span class="lineno"> 6810</span>&#160;</div><div class="line"><a name="l06811"></a><span class="lineno"> 6811</span>&#160;  <span class="comment">/* Read the DATA HEADER */</span></div><div class="line"><a name="l06812"></a><span class="lineno"> 6812</span>&#160;  <a class="code" href="log__impl_8h.html#a108c8143796ad50c65f64d4a483e9453">LOG_READ_ADVANCE_WHEN_DOESNT_FIT</a> (thread_p, <span class="keyword">sizeof</span> (*mvcc_redo), <a class="code" href="structlog__lsa.html">log_lsa</a>, log_page_p);</div><div class="line"><a name="l06813"></a><span class="lineno"> 6813</span>&#160;  mvcc_redo = (<a class="code" href="structlog__rec__mvcc__redo.html">LOG_REC_MVCC_REDO</a> *) ((<span class="keywordtype">char</span> *) log_page_p-&gt;<a class="code" href="structlog__page.html#a9b51b4623cdb8d1686f6f8fb64bc9ee2">area</a> + <a class="code" href="structlog__lsa.html">log_lsa</a>-&gt;<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a>);</div><div class="line"><a name="l06814"></a><span class="lineno"> 6814</span>&#160;</div><div class="line"><a name="l06815"></a><span class="lineno"> 6815</span>&#160;  fprintf (out_fp, <span class="stringliteral">&quot;, Recv_index = %s,\n&quot;</span>, <a class="code" href="recovery_8c.html#a9489c3632ab4b52fc008b589ce45cbdc">rv_rcvindex_string</a> (mvcc_redo-&gt;<a class="code" href="structlog__rec__mvcc__redo.html#ad04bef79ce810fc1e84eca618217baa5">redo</a>.<a class="code" href="structlog__rec__redo.html#a96ea9b5f13d7c0934ec9b5cd95ae274d">data</a>.<a class="code" href="structlog__data.html#ab1a17fceea659d32f5187b81a7b80412">rcvindex</a>));</div><div class="line"><a name="l06816"></a><span class="lineno"> 6816</span>&#160;  fprintf (out_fp, <span class="stringliteral">&quot;     Volid = %d Pageid = %d Offset = %d,\n     Redo (After) length = %d,\n&quot;</span>,</div><div class="line"><a name="l06817"></a><span class="lineno"> 6817</span>&#160;       mvcc_redo-&gt;<a class="code" href="structlog__rec__mvcc__redo.html#ad04bef79ce810fc1e84eca618217baa5">redo</a>.<a class="code" href="structlog__rec__redo.html#a96ea9b5f13d7c0934ec9b5cd95ae274d">data</a>.<a class="code" href="structlog__data.html#ad5635159b85ee07322bf30e39a5dee76">volid</a>, mvcc_redo-&gt;<a class="code" href="structlog__rec__mvcc__redo.html#ad04bef79ce810fc1e84eca618217baa5">redo</a>.<a class="code" href="structlog__rec__redo.html#a96ea9b5f13d7c0934ec9b5cd95ae274d">data</a>.<a class="code" href="structlog__data.html#a8410b9d70cc70d2bc6fb6df88ea48bb4">pageid</a>, mvcc_redo-&gt;<a class="code" href="structlog__rec__mvcc__redo.html#ad04bef79ce810fc1e84eca618217baa5">redo</a>.<a class="code" href="structlog__rec__redo.html#a96ea9b5f13d7c0934ec9b5cd95ae274d">data</a>.<a class="code" href="structlog__data.html#afd25836b0952561036b01b5a50c310b2">offset</a>,</div><div class="line"><a name="l06818"></a><span class="lineno"> 6818</span>&#160;       (<span class="keywordtype">int</span>) <a class="code" href="log__compress_8h.html#ac32e36fd25b171236ebb38a5be94d00c">GET_ZIP_LEN</a> (mvcc_redo-&gt;<a class="code" href="structlog__rec__mvcc__redo.html#ad04bef79ce810fc1e84eca618217baa5">redo</a>.<a class="code" href="structlog__rec__redo.html#a0a55afc612491df6d6b3b4be22d1c703">length</a>));</div><div class="line"><a name="l06819"></a><span class="lineno"> 6819</span>&#160;  fprintf (out_fp, <span class="stringliteral">&quot;     MVCCID = %llu, \n&quot;</span>, (<span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span>) mvcc_redo-&gt;<a class="code" href="structlog__rec__mvcc__redo.html#ac35ee3f43631b9679ca7e47fc6eae558">mvccid</a>);</div><div class="line"><a name="l06820"></a><span class="lineno"> 6820</span>&#160;</div><div class="line"><a name="l06821"></a><span class="lineno"> 6821</span>&#160;  redo_length = mvcc_redo-&gt;<a class="code" href="structlog__rec__mvcc__redo.html#ad04bef79ce810fc1e84eca618217baa5">redo</a>.<a class="code" href="structlog__rec__redo.html#a0a55afc612491df6d6b3b4be22d1c703">length</a>;</div><div class="line"><a name="l06822"></a><span class="lineno"> 6822</span>&#160;  rcvindex = mvcc_redo-&gt;<a class="code" href="structlog__rec__mvcc__redo.html#ad04bef79ce810fc1e84eca618217baa5">redo</a>.<a class="code" href="structlog__rec__redo.html#a96ea9b5f13d7c0934ec9b5cd95ae274d">data</a>.<a class="code" href="structlog__data.html#ab1a17fceea659d32f5187b81a7b80412">rcvindex</a>;</div><div class="line"><a name="l06823"></a><span class="lineno"> 6823</span>&#160;  <a class="code" href="log__impl_8h.html#afdaa9fdf7d83212b3eec2d515e807686">LOG_READ_ADD_ALIGN</a> (thread_p, <span class="keyword">sizeof</span> (*mvcc_redo), <a class="code" href="structlog__lsa.html">log_lsa</a>, log_page_p);</div><div class="line"><a name="l06824"></a><span class="lineno"> 6824</span>&#160;</div><div class="line"><a name="l06825"></a><span class="lineno"> 6825</span>&#160;  <span class="comment">/* Print REDO(AFTER) DATA */</span></div><div class="line"><a name="l06826"></a><span class="lineno"> 6826</span>&#160;  fprintf (out_fp, <span class="stringliteral">&quot;--&gt;&gt; Redo (After) Data:\n&quot;</span>);</div><div class="line"><a name="l06827"></a><span class="lineno"> 6827</span>&#160;  log_dump_data (thread_p, out_fp, redo_length, <a class="code" href="structlog__lsa.html">log_lsa</a>, log_page_p, <a class="code" href="recovery_8c.html#ad2eee9d1e5914fa34d3a7868bf2549f4">RV_fun</a>[rcvindex].dump_redofun, log_zip_p);</div><div class="line"><a name="l06828"></a><span class="lineno"> 6828</span>&#160;</div><div class="line"><a name="l06829"></a><span class="lineno"> 6829</span>&#160;  <span class="keywordflow">return</span> log_page_p;</div><div class="line"><a name="l06830"></a><span class="lineno"> 6830</span>&#160;}</div><div class="line"><a name="l06831"></a><span class="lineno"> 6831</span>&#160;</div><div class="line"><a name="l06832"></a><span class="lineno"> 6832</span>&#160;<span class="keyword">static</span> <a class="code" href="structlog__page.html">LOG_PAGE</a> *</div><div class="line"><a name="l06833"></a><span class="lineno"> 6833</span>&#160;log_dump_record_postpone (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, FILE * out_fp, <a class="code" href="structlog__lsa.html">LOG_LSA</a> * <a class="code" href="structlog__lsa.html">log_lsa</a>, <a class="code" href="structlog__page.html">LOG_PAGE</a> * log_page_p)</div><div class="line"><a name="l06834"></a><span class="lineno"> 6834</span>&#160;{</div><div class="line"><a name="l06835"></a><span class="lineno"> 6835</span>&#160;  <a class="code" href="structlog__rec__run__postpone.html">LOG_REC_RUN_POSTPONE</a> *run_posp;</div><div class="line"><a name="l06836"></a><span class="lineno"> 6836</span>&#160;  <span class="keywordtype">int</span> redo_length;</div><div class="line"><a name="l06837"></a><span class="lineno"> 6837</span>&#160;  <a class="code" href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2b">LOG_RCVINDEX</a> rcvindex;</div><div class="line"><a name="l06838"></a><span class="lineno"> 6838</span>&#160;</div><div class="line"><a name="l06839"></a><span class="lineno"> 6839</span>&#160;  <span class="comment">/* Read the DATA HEADER */</span></div><div class="line"><a name="l06840"></a><span class="lineno"> 6840</span>&#160;  <a class="code" href="log__impl_8h.html#a108c8143796ad50c65f64d4a483e9453">LOG_READ_ADVANCE_WHEN_DOESNT_FIT</a> (thread_p, <span class="keyword">sizeof</span> (*run_posp), <a class="code" href="structlog__lsa.html">log_lsa</a>, log_page_p);</div><div class="line"><a name="l06841"></a><span class="lineno"> 6841</span>&#160;  run_posp = (<a class="code" href="structlog__rec__run__postpone.html">LOG_REC_RUN_POSTPONE</a> *) ((<span class="keywordtype">char</span> *) log_page_p-&gt;<a class="code" href="structlog__page.html#a9b51b4623cdb8d1686f6f8fb64bc9ee2">area</a> + <a class="code" href="structlog__lsa.html">log_lsa</a>-&gt;<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a>);</div><div class="line"><a name="l06842"></a><span class="lineno"> 6842</span>&#160;  fprintf (out_fp, <span class="stringliteral">&quot;, Recv_index = %s,\n&quot;</span>, <a class="code" href="recovery_8c.html#a9489c3632ab4b52fc008b589ce45cbdc">rv_rcvindex_string</a> (run_posp-&gt;<a class="code" href="structlog__rec__run__postpone.html#a239cb60ac50b699715ef2dc143ba25e5">data</a>.<a class="code" href="structlog__data.html#ab1a17fceea659d32f5187b81a7b80412">rcvindex</a>));</div><div class="line"><a name="l06843"></a><span class="lineno"> 6843</span>&#160;  fprintf (out_fp,</div><div class="line"><a name="l06844"></a><span class="lineno"> 6844</span>&#160;       <span class="stringliteral">&quot;     Volid = %d Pageid = %d Offset = %d,\n     Run postpone (Redo/After) length = %d, corresponding&quot;</span></div><div class="line"><a name="l06845"></a><span class="lineno"> 6845</span>&#160;       <span class="stringliteral">&quot; to\n         Postpone record with LSA = %lld|%d\n&quot;</span>, run_posp-&gt;<a class="code" href="structlog__rec__run__postpone.html#a239cb60ac50b699715ef2dc143ba25e5">data</a>.<a class="code" href="structlog__data.html#ad5635159b85ee07322bf30e39a5dee76">volid</a>, run_posp-&gt;<a class="code" href="structlog__rec__run__postpone.html#a239cb60ac50b699715ef2dc143ba25e5">data</a>.<a class="code" href="structlog__data.html#a8410b9d70cc70d2bc6fb6df88ea48bb4">pageid</a>,</div><div class="line"><a name="l06846"></a><span class="lineno"> 6846</span>&#160;       run_posp-&gt;<a class="code" href="structlog__rec__run__postpone.html#a239cb60ac50b699715ef2dc143ba25e5">data</a>.<a class="code" href="structlog__data.html#afd25836b0952561036b01b5a50c310b2">offset</a>, run_posp-&gt;<a class="code" href="structlog__rec__run__postpone.html#af54dfa4bc67af1f75ddbda8c6f070e74">length</a>, <a class="code" href="storage__common_8h.html#a392873d6ffa4a8a6b2eb5f4b4fbbc97c">LSA_AS_ARGS</a> (&amp;run_posp-&gt;<a class="code" href="structlog__rec__run__postpone.html#adee9338343c1891a51bb05e32dc6d120">ref_lsa</a>));</div><div class="line"><a name="l06847"></a><span class="lineno"> 6847</span>&#160;</div><div class="line"><a name="l06848"></a><span class="lineno"> 6848</span>&#160;  redo_length = run_posp-&gt;<a class="code" href="structlog__rec__run__postpone.html#af54dfa4bc67af1f75ddbda8c6f070e74">length</a>;</div><div class="line"><a name="l06849"></a><span class="lineno"> 6849</span>&#160;  rcvindex = run_posp-&gt;<a class="code" href="structlog__rec__run__postpone.html#a239cb60ac50b699715ef2dc143ba25e5">data</a>.<a class="code" href="structlog__data.html#ab1a17fceea659d32f5187b81a7b80412">rcvindex</a>;</div><div class="line"><a name="l06850"></a><span class="lineno"> 6850</span>&#160;  <a class="code" href="log__impl_8h.html#afdaa9fdf7d83212b3eec2d515e807686">LOG_READ_ADD_ALIGN</a> (thread_p, <span class="keyword">sizeof</span> (*run_posp), <a class="code" href="structlog__lsa.html">log_lsa</a>, log_page_p);</div><div class="line"><a name="l06851"></a><span class="lineno"> 6851</span>&#160;</div><div class="line"><a name="l06852"></a><span class="lineno"> 6852</span>&#160;  <span class="comment">/* Print RUN POSTPONE (REDO/AFTER) DATA */</span></div><div class="line"><a name="l06853"></a><span class="lineno"> 6853</span>&#160;  fprintf (out_fp, <span class="stringliteral">&quot;--&gt;&gt; Run Postpone (Redo/After) Data:\n&quot;</span>);</div><div class="line"><a name="l06854"></a><span class="lineno"> 6854</span>&#160;  log_dump_data (thread_p, out_fp, redo_length, <a class="code" href="structlog__lsa.html">log_lsa</a>, log_page_p, <a class="code" href="recovery_8c.html#ad2eee9d1e5914fa34d3a7868bf2549f4">RV_fun</a>[rcvindex].dump_redofun, <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l06855"></a><span class="lineno"> 6855</span>&#160;</div><div class="line"><a name="l06856"></a><span class="lineno"> 6856</span>&#160;  <span class="keywordflow">return</span> log_page_p;</div><div class="line"><a name="l06857"></a><span class="lineno"> 6857</span>&#160;}</div><div class="line"><a name="l06858"></a><span class="lineno"> 6858</span>&#160;</div><div class="line"><a name="l06859"></a><span class="lineno"> 6859</span>&#160;<span class="keyword">static</span> <a class="code" href="structlog__page.html">LOG_PAGE</a> *</div><div class="line"><a name="l06860"></a><span class="lineno"> 6860</span>&#160;log_dump_record_dbout_redo (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, FILE * out_fp, <a class="code" href="structlog__lsa.html">LOG_LSA</a> * <a class="code" href="structlog__lsa.html">log_lsa</a>, <a class="code" href="structlog__page.html">LOG_PAGE</a> * log_page_p)</div><div class="line"><a name="l06861"></a><span class="lineno"> 6861</span>&#160;{</div><div class="line"><a name="l06862"></a><span class="lineno"> 6862</span>&#160;  <a class="code" href="structlog__rec__dbout__redo.html">LOG_REC_DBOUT_REDO</a> *dbout_redo;</div><div class="line"><a name="l06863"></a><span class="lineno"> 6863</span>&#160;  <span class="keywordtype">int</span> redo_length;</div><div class="line"><a name="l06864"></a><span class="lineno"> 6864</span>&#160;  <a class="code" href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2b">LOG_RCVINDEX</a> rcvindex;</div><div class="line"><a name="l06865"></a><span class="lineno"> 6865</span>&#160;</div><div class="line"><a name="l06866"></a><span class="lineno"> 6866</span>&#160;  <span class="comment">/* Read the data header */</span></div><div class="line"><a name="l06867"></a><span class="lineno"> 6867</span>&#160;  <a class="code" href="log__impl_8h.html#a108c8143796ad50c65f64d4a483e9453">LOG_READ_ADVANCE_WHEN_DOESNT_FIT</a> (thread_p, <span class="keyword">sizeof</span> (*dbout_redo), <a class="code" href="structlog__lsa.html">log_lsa</a>, log_page_p);</div><div class="line"><a name="l06868"></a><span class="lineno"> 6868</span>&#160;  dbout_redo = ((<a class="code" href="structlog__rec__dbout__redo.html">LOG_REC_DBOUT_REDO</a> *) ((<span class="keywordtype">char</span> *) log_page_p-&gt;<a class="code" href="structlog__page.html#a9b51b4623cdb8d1686f6f8fb64bc9ee2">area</a> + <a class="code" href="structlog__lsa.html">log_lsa</a>-&gt;<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a>));</div><div class="line"><a name="l06869"></a><span class="lineno"> 6869</span>&#160;</div><div class="line"><a name="l06870"></a><span class="lineno"> 6870</span>&#160;  redo_length = dbout_redo-&gt;<a class="code" href="structlog__rec__dbout__redo.html#aece481275dfdf407eea3e15acc97c0f9">length</a>;</div><div class="line"><a name="l06871"></a><span class="lineno"> 6871</span>&#160;  rcvindex = dbout_redo-&gt;<a class="code" href="structlog__rec__dbout__redo.html#a0d09baf4c8445cdbfe9ebd3e17271b3f">rcvindex</a>;</div><div class="line"><a name="l06872"></a><span class="lineno"> 6872</span>&#160;</div><div class="line"><a name="l06873"></a><span class="lineno"> 6873</span>&#160;  fprintf (out_fp, <span class="stringliteral">&quot;, Recv_index = %s, Length = %d,\n&quot;</span>, <a class="code" href="recovery_8c.html#a9489c3632ab4b52fc008b589ce45cbdc">rv_rcvindex_string</a> (rcvindex), redo_length);</div><div class="line"><a name="l06874"></a><span class="lineno"> 6874</span>&#160;</div><div class="line"><a name="l06875"></a><span class="lineno"> 6875</span>&#160;  <a class="code" href="log__impl_8h.html#afdaa9fdf7d83212b3eec2d515e807686">LOG_READ_ADD_ALIGN</a> (thread_p, <span class="keyword">sizeof</span> (*dbout_redo), <a class="code" href="structlog__lsa.html">log_lsa</a>, log_page_p);</div><div class="line"><a name="l06876"></a><span class="lineno"> 6876</span>&#160;</div><div class="line"><a name="l06877"></a><span class="lineno"> 6877</span>&#160;  <span class="comment">/* Print Database External DATA */</span></div><div class="line"><a name="l06878"></a><span class="lineno"> 6878</span>&#160;  fprintf (out_fp, <span class="stringliteral">&quot;--&gt;&gt; Database external Data:\n&quot;</span>);</div><div class="line"><a name="l06879"></a><span class="lineno"> 6879</span>&#160;  log_dump_data (thread_p, out_fp, redo_length, <a class="code" href="structlog__lsa.html">log_lsa</a>, log_page_p, <a class="code" href="recovery_8c.html#ad2eee9d1e5914fa34d3a7868bf2549f4">RV_fun</a>[rcvindex].dump_redofun, <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l06880"></a><span class="lineno"> 6880</span>&#160;</div><div class="line"><a name="l06881"></a><span class="lineno"> 6881</span>&#160;  <span class="keywordflow">return</span> log_page_p;</div><div class="line"><a name="l06882"></a><span class="lineno"> 6882</span>&#160;}</div><div class="line"><a name="l06883"></a><span class="lineno"> 6883</span>&#160;</div><div class="line"><a name="l06884"></a><span class="lineno"> 6884</span>&#160;<span class="keyword">static</span> <a class="code" href="structlog__page.html">LOG_PAGE</a> *</div><div class="line"><a name="l06885"></a><span class="lineno"> 6885</span>&#160;log_dump_record_compensate (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, FILE * out_fp, <a class="code" href="structlog__lsa.html">LOG_LSA</a> * <a class="code" href="structlog__lsa.html">log_lsa</a>, <a class="code" href="structlog__page.html">LOG_PAGE</a> * log_page_p)</div><div class="line"><a name="l06886"></a><span class="lineno"> 6886</span>&#160;{</div><div class="line"><a name="l06887"></a><span class="lineno"> 6887</span>&#160;  <a class="code" href="structlog__rec__compensate.html">LOG_REC_COMPENSATE</a> *compensate;</div><div class="line"><a name="l06888"></a><span class="lineno"> 6888</span>&#160;  <span class="keywordtype">int</span> length_compensate;</div><div class="line"><a name="l06889"></a><span class="lineno"> 6889</span>&#160;  <a class="code" href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2b">LOG_RCVINDEX</a> rcvindex;</div><div class="line"><a name="l06890"></a><span class="lineno"> 6890</span>&#160;</div><div class="line"><a name="l06891"></a><span class="lineno"> 6891</span>&#160;  <span class="comment">/* Read the DATA HEADER */</span></div><div class="line"><a name="l06892"></a><span class="lineno"> 6892</span>&#160;  <a class="code" href="log__impl_8h.html#a108c8143796ad50c65f64d4a483e9453">LOG_READ_ADVANCE_WHEN_DOESNT_FIT</a> (thread_p, <span class="keyword">sizeof</span> (*compensate), <a class="code" href="structlog__lsa.html">log_lsa</a>, log_page_p);</div><div class="line"><a name="l06893"></a><span class="lineno"> 6893</span>&#160;  compensate = (<a class="code" href="structlog__rec__compensate.html">LOG_REC_COMPENSATE</a> *) ((<span class="keywordtype">char</span> *) log_page_p-&gt;<a class="code" href="structlog__page.html#a9b51b4623cdb8d1686f6f8fb64bc9ee2">area</a> + <a class="code" href="structlog__lsa.html">log_lsa</a>-&gt;<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a>);</div><div class="line"><a name="l06894"></a><span class="lineno"> 6894</span>&#160;</div><div class="line"><a name="l06895"></a><span class="lineno"> 6895</span>&#160;  fprintf (out_fp, <span class="stringliteral">&quot;, Recv_index = %s,\n&quot;</span>, <a class="code" href="recovery_8c.html#a9489c3632ab4b52fc008b589ce45cbdc">rv_rcvindex_string</a> (compensate-&gt;<a class="code" href="structlog__rec__compensate.html#a1cf8b84dd2777a88d87f1401c1799a2b">data</a>.<a class="code" href="structlog__data.html#ab1a17fceea659d32f5187b81a7b80412">rcvindex</a>));</div><div class="line"><a name="l06896"></a><span class="lineno"> 6896</span>&#160;  fprintf (out_fp, <span class="stringliteral">&quot;     Volid = %d Pageid = %d Offset = %d,\n     Compensate length = %d, Next_to_UNDO = %lld|%d\n&quot;</span>,</div><div class="line"><a name="l06897"></a><span class="lineno"> 6897</span>&#160;       compensate-&gt;<a class="code" href="structlog__rec__compensate.html#a1cf8b84dd2777a88d87f1401c1799a2b">data</a>.<a class="code" href="structlog__data.html#ad5635159b85ee07322bf30e39a5dee76">volid</a>, compensate-&gt;<a class="code" href="structlog__rec__compensate.html#a1cf8b84dd2777a88d87f1401c1799a2b">data</a>.<a class="code" href="structlog__data.html#a8410b9d70cc70d2bc6fb6df88ea48bb4">pageid</a>, compensate-&gt;<a class="code" href="structlog__rec__compensate.html#a1cf8b84dd2777a88d87f1401c1799a2b">data</a>.<a class="code" href="structlog__data.html#afd25836b0952561036b01b5a50c310b2">offset</a>, compensate-&gt;<a class="code" href="structlog__rec__compensate.html#aa7dd1825a2cbaacc90ad2c40a8d5f97f">length</a>,</div><div class="line"><a name="l06898"></a><span class="lineno"> 6898</span>&#160;       <a class="code" href="storage__common_8h.html#a392873d6ffa4a8a6b2eb5f4b4fbbc97c">LSA_AS_ARGS</a> (&amp;compensate-&gt;<a class="code" href="structlog__rec__compensate.html#a7222173e854c1f68568c5ce564325a7a">undo_nxlsa</a>));</div><div class="line"><a name="l06899"></a><span class="lineno"> 6899</span>&#160;</div><div class="line"><a name="l06900"></a><span class="lineno"> 6900</span>&#160;  length_compensate = compensate-&gt;<a class="code" href="structlog__rec__compensate.html#aa7dd1825a2cbaacc90ad2c40a8d5f97f">length</a>;</div><div class="line"><a name="l06901"></a><span class="lineno"> 6901</span>&#160;  rcvindex = compensate-&gt;<a class="code" href="structlog__rec__compensate.html#a1cf8b84dd2777a88d87f1401c1799a2b">data</a>.<a class="code" href="structlog__data.html#ab1a17fceea659d32f5187b81a7b80412">rcvindex</a>;</div><div class="line"><a name="l06902"></a><span class="lineno"> 6902</span>&#160;  <a class="code" href="log__impl_8h.html#afdaa9fdf7d83212b3eec2d515e807686">LOG_READ_ADD_ALIGN</a> (thread_p, <span class="keyword">sizeof</span> (*compensate), <a class="code" href="structlog__lsa.html">log_lsa</a>, log_page_p);</div><div class="line"><a name="l06903"></a><span class="lineno"> 6903</span>&#160;</div><div class="line"><a name="l06904"></a><span class="lineno"> 6904</span>&#160;  <span class="comment">/* Print COMPENSATE DATA */</span></div><div class="line"><a name="l06905"></a><span class="lineno"> 6905</span>&#160;  fprintf (out_fp, <span class="stringliteral">&quot;--&gt;&gt; Compensate Data:\n&quot;</span>);</div><div class="line"><a name="l06906"></a><span class="lineno"> 6906</span>&#160;  log_dump_data (thread_p, out_fp, length_compensate, <a class="code" href="structlog__lsa.html">log_lsa</a>, log_page_p, <a class="code" href="recovery_8c.html#ad2eee9d1e5914fa34d3a7868bf2549f4">RV_fun</a>[rcvindex].dump_undofun, <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l06907"></a><span class="lineno"> 6907</span>&#160;</div><div class="line"><a name="l06908"></a><span class="lineno"> 6908</span>&#160;  <span class="keywordflow">return</span> log_page_p;</div><div class="line"><a name="l06909"></a><span class="lineno"> 6909</span>&#160;}</div><div class="line"><a name="l06910"></a><span class="lineno"> 6910</span>&#160;</div><div class="line"><a name="l06911"></a><span class="lineno"> 6911</span>&#160;<span class="keyword">static</span> <a class="code" href="structlog__page.html">LOG_PAGE</a> *</div><div class="line"><a name="l06912"></a><span class="lineno"> 6912</span>&#160;log_dump_record_commit_postpone (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, FILE * out_fp, <a class="code" href="structlog__lsa.html">LOG_LSA</a> * <a class="code" href="structlog__lsa.html">log_lsa</a>, <a class="code" href="structlog__page.html">LOG_PAGE</a> * log_page_p)</div><div class="line"><a name="l06913"></a><span class="lineno"> 6913</span>&#160;{</div><div class="line"><a name="l06914"></a><span class="lineno"> 6914</span>&#160;  <a class="code" href="structlog__rec__start__postpone.html">LOG_REC_START_POSTPONE</a> *start_posp;</div><div class="line"><a name="l06915"></a><span class="lineno"> 6915</span>&#160;</div><div class="line"><a name="l06916"></a><span class="lineno"> 6916</span>&#160;  <span class="comment">/* Read the DATA HEADER */</span></div><div class="line"><a name="l06917"></a><span class="lineno"> 6917</span>&#160;  <a class="code" href="log__impl_8h.html#a108c8143796ad50c65f64d4a483e9453">LOG_READ_ADVANCE_WHEN_DOESNT_FIT</a> (thread_p, <span class="keyword">sizeof</span> (*start_posp), <a class="code" href="structlog__lsa.html">log_lsa</a>, log_page_p);</div><div class="line"><a name="l06918"></a><span class="lineno"> 6918</span>&#160;  start_posp = (<a class="code" href="structlog__rec__start__postpone.html">LOG_REC_START_POSTPONE</a> *) ((<span class="keywordtype">char</span> *) log_page_p-&gt;<a class="code" href="structlog__page.html#a9b51b4623cdb8d1686f6f8fb64bc9ee2">area</a> + <a class="code" href="structlog__lsa.html">log_lsa</a>-&gt;<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a>);</div><div class="line"><a name="l06919"></a><span class="lineno"> 6919</span>&#160;  fprintf (out_fp, <span class="stringliteral">&quot;, First postpone record at before or after Page = %lld and offset = %d\n&quot;</span>,</div><div class="line"><a name="l06920"></a><span class="lineno"> 6920</span>&#160;       <a class="code" href="storage__common_8h.html#a392873d6ffa4a8a6b2eb5f4b4fbbc97c">LSA_AS_ARGS</a> (&amp;start_posp-&gt;<a class="code" href="structlog__rec__start__postpone.html#a4743d8c14a75a36ff44fa8e41e659283">posp_lsa</a>));</div><div class="line"><a name="l06921"></a><span class="lineno"> 6921</span>&#160;</div><div class="line"><a name="l06922"></a><span class="lineno"> 6922</span>&#160;  <span class="keywordflow">return</span> log_page_p;</div><div class="line"><a name="l06923"></a><span class="lineno"> 6923</span>&#160;}</div><div class="line"><a name="l06924"></a><span class="lineno"> 6924</span>&#160;</div><div class="line"><a name="l06925"></a><span class="lineno"> 6925</span>&#160;<span class="keyword">static</span> <a class="code" href="structlog__page.html">LOG_PAGE</a> *</div><div class="line"><a name="l06926"></a><span class="lineno"> 6926</span>&#160;log_dump_record_transaction_finish (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, FILE * out_fp, <a class="code" href="structlog__lsa.html">LOG_LSA</a> * <a class="code" href="structlog__lsa.html">log_lsa</a>, <a class="code" href="structlog__page.html">LOG_PAGE</a> * log_page_p)</div><div class="line"><a name="l06927"></a><span class="lineno"> 6927</span>&#160;{</div><div class="line"><a name="l06928"></a><span class="lineno"> 6928</span>&#160;  <a class="code" href="structlog__rec__donetime.html">LOG_REC_DONETIME</a> *donetime;</div><div class="line"><a name="l06929"></a><span class="lineno"> 6929</span>&#160;  time_t tmp_time;</div><div class="line"><a name="l06930"></a><span class="lineno"> 6930</span>&#160;  <span class="keywordtype">char</span> time_val[<a class="code" href="porting_8h.html#a7b4ba06a388856deeb25508d04470eaa">CTIME_MAX</a>];</div><div class="line"><a name="l06931"></a><span class="lineno"> 6931</span>&#160;</div><div class="line"><a name="l06932"></a><span class="lineno"> 6932</span>&#160;  <span class="comment">/* Read the DATA HEADER */</span></div><div class="line"><a name="l06933"></a><span class="lineno"> 6933</span>&#160;  <a class="code" href="log__impl_8h.html#a108c8143796ad50c65f64d4a483e9453">LOG_READ_ADVANCE_WHEN_DOESNT_FIT</a> (thread_p, <span class="keyword">sizeof</span> (*donetime), <a class="code" href="structlog__lsa.html">log_lsa</a>, log_page_p);</div><div class="line"><a name="l06934"></a><span class="lineno"> 6934</span>&#160;  donetime = (<a class="code" href="structlog__rec__donetime.html">LOG_REC_DONETIME</a> *) ((<span class="keywordtype">char</span> *) log_page_p-&gt;<a class="code" href="structlog__page.html#a9b51b4623cdb8d1686f6f8fb64bc9ee2">area</a> + <a class="code" href="structlog__lsa.html">log_lsa</a>-&gt;<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a>);</div><div class="line"><a name="l06935"></a><span class="lineno"> 6935</span>&#160;  tmp_time = (time_t) donetime-&gt;<a class="code" href="structlog__rec__donetime.html#ab2f504036b88c922a0a3f1db4524d70b">at_time</a>;</div><div class="line"><a name="l06936"></a><span class="lineno"> 6936</span>&#160;  (<span class="keywordtype">void</span>) ctime_r (&amp;tmp_time, time_val);</div><div class="line"><a name="l06937"></a><span class="lineno"> 6937</span>&#160;  fprintf (out_fp, <span class="stringliteral">&quot;,\n     Transaction finish time at = %s\n&quot;</span>, time_val);</div><div class="line"><a name="l06938"></a><span class="lineno"> 6938</span>&#160;</div><div class="line"><a name="l06939"></a><span class="lineno"> 6939</span>&#160;  <span class="keywordflow">return</span> log_page_p;</div><div class="line"><a name="l06940"></a><span class="lineno"> 6940</span>&#160;}</div><div class="line"><a name="l06941"></a><span class="lineno"> 6941</span>&#160;</div><div class="line"><a name="l06942"></a><span class="lineno"> 6942</span>&#160;<span class="keyword">static</span> <a class="code" href="structlog__page.html">LOG_PAGE</a> *</div><div class="line"><a name="l06943"></a><span class="lineno"> 6943</span>&#160;log_dump_record_replication (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, FILE * out_fp, <a class="code" href="structlog__lsa.html">LOG_LSA</a> * <a class="code" href="structlog__lsa.html">log_lsa</a>, <a class="code" href="structlog__page.html">LOG_PAGE</a> * log_page_p)</div><div class="line"><a name="l06944"></a><span class="lineno"> 6944</span>&#160;{</div><div class="line"><a name="l06945"></a><span class="lineno"> 6945</span>&#160;  <a class="code" href="structlog__rec__replication.html">LOG_REC_REPLICATION</a> *repl_log;</div><div class="line"><a name="l06946"></a><span class="lineno"> 6946</span>&#160;  <span class="keywordtype">int</span> length;</div><div class="line"><a name="l06947"></a><span class="lineno"> 6947</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="atldb__cubrid_8h.html#ad939da76b5d12fca40de18001582d63a">type</a>;</div><div class="line"><a name="l06948"></a><span class="lineno"> 6948</span>&#160;  void (*dump_function) (FILE *, <a class="code" href="mprec_8c.html#a61569f2965b7a369eb10b6d75d410d11">int</a>, <span class="keywordtype">void</span> *);</div><div class="line"><a name="l06949"></a><span class="lineno"> 6949</span>&#160;</div><div class="line"><a name="l06950"></a><span class="lineno"> 6950</span>&#160;  <a class="code" href="log__impl_8h.html#a108c8143796ad50c65f64d4a483e9453">LOG_READ_ADVANCE_WHEN_DOESNT_FIT</a> (thread_p, <span class="keyword">sizeof</span> (*repl_log), <a class="code" href="structlog__lsa.html">log_lsa</a>, log_page_p);</div><div class="line"><a name="l06951"></a><span class="lineno"> 6951</span>&#160;  repl_log = (<a class="code" href="structlog__rec__replication.html">LOG_REC_REPLICATION</a> *) ((<span class="keywordtype">char</span> *) log_page_p-&gt;<a class="code" href="structlog__page.html#a9b51b4623cdb8d1686f6f8fb64bc9ee2">area</a> + <a class="code" href="structlog__lsa.html">log_lsa</a>-&gt;<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a>);</div><div class="line"><a name="l06952"></a><span class="lineno"> 6952</span>&#160;  fprintf (out_fp, <span class="stringliteral">&quot;, Target log lsa = %lld|%d\n&quot;</span>, <a class="code" href="storage__common_8h.html#a392873d6ffa4a8a6b2eb5f4b4fbbc97c">LSA_AS_ARGS</a> (&amp;repl_log-&gt;<a class="code" href="structlog__rec__replication.html#a8d945514d95904e726b652d4c7e034d8">lsa</a>));</div><div class="line"><a name="l06953"></a><span class="lineno"> 6953</span>&#160;  length = repl_log-&gt;<a class="code" href="structlog__rec__replication.html#abe7a28ec1533b0903038b517c3a7d1d1">length</a>;</div><div class="line"><a name="l06954"></a><span class="lineno"> 6954</span>&#160;</div><div class="line"><a name="l06955"></a><span class="lineno"> 6955</span>&#160;  <a class="code" href="log__impl_8h.html#afdaa9fdf7d83212b3eec2d515e807686">LOG_READ_ADD_ALIGN</a> (thread_p, <span class="keyword">sizeof</span> (*repl_log), <a class="code" href="structlog__lsa.html">log_lsa</a>, log_page_p);</div><div class="line"><a name="l06956"></a><span class="lineno"> 6956</span>&#160;</div><div class="line"><a name="l06957"></a><span class="lineno"> 6957</span>&#160;  <span class="keywordflow">switch</span> (repl_log-&gt;<a class="code" href="structlog__rec__replication.html#ae914ee167eab6535e3072163d40ff2c3">rcvindex</a>)</div><div class="line"><a name="l06958"></a><span class="lineno"> 6958</span>&#160;    {</div><div class="line"><a name="l06959"></a><span class="lineno"> 6959</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2ba9ebbe138eea08c3a9b8a08f70039fa5c">RVREPL_DATA_INSERT</a>:</div><div class="line"><a name="l06960"></a><span class="lineno"> 6960</span>&#160;      <a class="code" href="atldb__cubrid_8h.html#ad939da76b5d12fca40de18001582d63a">type</a> = <span class="stringliteral">&quot;RVREPL_DATA_INSERT&quot;</span>;</div><div class="line"><a name="l06961"></a><span class="lineno"> 6961</span>&#160;      dump_function = log_repl_data_dump;</div><div class="line"><a name="l06962"></a><span class="lineno"> 6962</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l06963"></a><span class="lineno"> 6963</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2ba1091dedb4bd49edbff1021e98dcb7562">RVREPL_DATA_UPDATE_START</a>:</div><div class="line"><a name="l06964"></a><span class="lineno"> 6964</span>&#160;      <a class="code" href="atldb__cubrid_8h.html#ad939da76b5d12fca40de18001582d63a">type</a> = <span class="stringliteral">&quot;RVREPL_DATA_UPDATE_START&quot;</span>;</div><div class="line"><a name="l06965"></a><span class="lineno"> 6965</span>&#160;      dump_function = log_repl_data_dump;</div><div class="line"><a name="l06966"></a><span class="lineno"> 6966</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l06967"></a><span class="lineno"> 6967</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2ba7278715d46550803f5e85a7e5ea42984">RVREPL_DATA_UPDATE</a>:</div><div class="line"><a name="l06968"></a><span class="lineno"> 6968</span>&#160;      <a class="code" href="atldb__cubrid_8h.html#ad939da76b5d12fca40de18001582d63a">type</a> = <span class="stringliteral">&quot;RVREPL_DATA_UPDATE&quot;</span>;</div><div class="line"><a name="l06969"></a><span class="lineno"> 6969</span>&#160;      dump_function = log_repl_data_dump;</div><div class="line"><a name="l06970"></a><span class="lineno"> 6970</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l06971"></a><span class="lineno"> 6971</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2ba50c9179078858190e4f031e62c45314d">RVREPL_DATA_UPDATE_END</a>:</div><div class="line"><a name="l06972"></a><span class="lineno"> 6972</span>&#160;      <a class="code" href="atldb__cubrid_8h.html#ad939da76b5d12fca40de18001582d63a">type</a> = <span class="stringliteral">&quot;RVREPL_DATA_UPDATE_END&quot;</span>;</div><div class="line"><a name="l06973"></a><span class="lineno"> 6973</span>&#160;      dump_function = log_repl_data_dump;</div><div class="line"><a name="l06974"></a><span class="lineno"> 6974</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l06975"></a><span class="lineno"> 6975</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2ba2d4bae310e581efb860f5b180b730527">RVREPL_DATA_DELETE</a>:</div><div class="line"><a name="l06976"></a><span class="lineno"> 6976</span>&#160;      <a class="code" href="atldb__cubrid_8h.html#ad939da76b5d12fca40de18001582d63a">type</a> = <span class="stringliteral">&quot;RVREPL_DATA_DELETE&quot;</span>;</div><div class="line"><a name="l06977"></a><span class="lineno"> 6977</span>&#160;      dump_function = log_repl_data_dump;</div><div class="line"><a name="l06978"></a><span class="lineno"> 6978</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l06979"></a><span class="lineno"> 6979</span>&#160;    <span class="keywordflow">default</span>:</div><div class="line"><a name="l06980"></a><span class="lineno"> 6980</span>&#160;      <a class="code" href="atldb__cubrid_8h.html#ad939da76b5d12fca40de18001582d63a">type</a> = <span class="stringliteral">&quot;RVREPL_SCHEMA&quot;</span>;</div><div class="line"><a name="l06981"></a><span class="lineno"> 6981</span>&#160;      dump_function = log_repl_schema_dump;</div><div class="line"><a name="l06982"></a><span class="lineno"> 6982</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l06983"></a><span class="lineno"> 6983</span>&#160;    }</div><div class="line"><a name="l06984"></a><span class="lineno"> 6984</span>&#160;  fprintf (out_fp, <span class="stringliteral">&quot;T[%s] &quot;</span>, <a class="code" href="atldb__cubrid_8h.html#ad939da76b5d12fca40de18001582d63a">type</a>);</div><div class="line"><a name="l06985"></a><span class="lineno"> 6985</span>&#160;</div><div class="line"><a name="l06986"></a><span class="lineno"> 6986</span>&#160;  log_dump_data (thread_p, out_fp, length, <a class="code" href="structlog__lsa.html">log_lsa</a>, log_page_p, dump_function, <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l06987"></a><span class="lineno"> 6987</span>&#160;  <span class="keywordflow">return</span> log_page_p;</div><div class="line"><a name="l06988"></a><span class="lineno"> 6988</span>&#160;}</div><div class="line"><a name="l06989"></a><span class="lineno"> 6989</span>&#160;</div><div class="line"><a name="l06990"></a><span class="lineno"> 6990</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l06991"></a><span class="lineno"> 6991</span>&#160;<span class="comment"> * log_dump_record_sysop_start_postpone () - dump system op start postpone log record</span></div><div class="line"><a name="l06992"></a><span class="lineno"> 6992</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l06993"></a><span class="lineno"> 6993</span>&#160;<span class="comment"> * return              : log page</span></div><div class="line"><a name="l06994"></a><span class="lineno"> 6994</span>&#160;<span class="comment"> * thread_p (in)       : thread entry</span></div><div class="line"><a name="l06995"></a><span class="lineno"> 6995</span>&#160;<span class="comment"> * out_fp (in/out)     : dump output</span></div><div class="line"><a name="l06996"></a><span class="lineno"> 6996</span>&#160;<span class="comment"> * log_lsa (in/out)    : log lsa</span></div><div class="line"><a name="l06997"></a><span class="lineno"> 6997</span>&#160;<span class="comment"> * log_page_p (in/out) : log page</span></div><div class="line"><a name="l06998"></a><span class="lineno"> 6998</span>&#160;<span class="comment"> * log_zip_p (in/out)  : log unzip</span></div><div class="line"><a name="l06999"></a><span class="lineno"> 6999</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l07000"></a><span class="lineno"> 7000</span>&#160;<span class="keyword">static</span> <a class="code" href="structlog__page.html">LOG_PAGE</a> *</div><div class="line"><a name="l07001"></a><span class="lineno"> 7001</span>&#160;log_dump_record_sysop_start_postpone (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, FILE * out_fp, <a class="code" href="structlog__lsa.html">LOG_LSA</a> * <a class="code" href="structlog__lsa.html">log_lsa</a>, <a class="code" href="structlog__page.html">LOG_PAGE</a> * log_page_p,</div><div class="line"><a name="l07002"></a><span class="lineno"> 7002</span>&#160;                      <a class="code" href="structlog__zip.html">LOG_ZIP</a> * log_zip_p)</div><div class="line"><a name="l07003"></a><span class="lineno"> 7003</span>&#160;{</div><div class="line"><a name="l07004"></a><span class="lineno"> 7004</span>&#160;  <a class="code" href="structlog__rec__sysop__start__postpone.html">LOG_REC_SYSOP_START_POSTPONE</a> sysop_start_postpone;</div><div class="line"><a name="l07005"></a><span class="lineno"> 7005</span>&#160;</div><div class="line"><a name="l07006"></a><span class="lineno"> 7006</span>&#160;  <span class="comment">/* Read the DATA HEADER */</span></div><div class="line"><a name="l07007"></a><span class="lineno"> 7007</span>&#160;  <a class="code" href="log__impl_8h.html#a108c8143796ad50c65f64d4a483e9453">LOG_READ_ADVANCE_WHEN_DOESNT_FIT</a> (thread_p, <span class="keyword">sizeof</span> (sysop_start_postpone), <a class="code" href="structlog__lsa.html">log_lsa</a>, log_page_p);</div><div class="line"><a name="l07008"></a><span class="lineno"> 7008</span>&#160;  sysop_start_postpone = *((<a class="code" href="structlog__rec__sysop__start__postpone.html">LOG_REC_SYSOP_START_POSTPONE</a> *) ((<span class="keywordtype">char</span> *) log_page_p-&gt;<a class="code" href="structlog__page.html#a9b51b4623cdb8d1686f6f8fb64bc9ee2">area</a> + <a class="code" href="structlog__lsa.html">log_lsa</a>-&gt;<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a>));</div><div class="line"><a name="l07009"></a><span class="lineno"> 7009</span>&#160;</div><div class="line"><a name="l07010"></a><span class="lineno"> 7010</span>&#160;  (void) log_dump_record_sysop_end_internal (thread_p, &amp;sysop_start_postpone.<a class="code" href="structlog__rec__sysop__start__postpone.html#a75ba94263889a5daa036f05cb3a453dc">sysop_end</a>, <a class="code" href="structlog__lsa.html">log_lsa</a>, log_page_p, log_zip_p,</div><div class="line"><a name="l07011"></a><span class="lineno"> 7011</span>&#160;                         out_fp);</div><div class="line"><a name="l07012"></a><span class="lineno"> 7012</span>&#160;  fprintf (out_fp, <span class="stringliteral">&quot;     postpone_lsa = %lld|%d \n&quot;</span>, <a class="code" href="storage__common_8h.html#a392873d6ffa4a8a6b2eb5f4b4fbbc97c">LSA_AS_ARGS</a> (&amp;sysop_start_postpone.<a class="code" href="structlog__rec__sysop__start__postpone.html#a7a4784f826dbfb985de3cdeafce2a202">posp_lsa</a>));</div><div class="line"><a name="l07013"></a><span class="lineno"> 7013</span>&#160;</div><div class="line"><a name="l07014"></a><span class="lineno"> 7014</span>&#160;  <span class="keywordflow">return</span> log_page_p;</div><div class="line"><a name="l07015"></a><span class="lineno"> 7015</span>&#160;}</div><div class="line"><a name="l07016"></a><span class="lineno"> 7016</span>&#160;</div><div class="line"><a name="l07017"></a><span class="lineno"> 7017</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l07018"></a><span class="lineno"> 7018</span>&#160;<span class="comment"> * log_dump_record_sysop_end_internal () - dump sysop end log record types</span></div><div class="line"><a name="l07019"></a><span class="lineno"> 7019</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l07020"></a><span class="lineno"> 7020</span>&#160;<span class="comment"> * return              : log page</span></div><div class="line"><a name="l07021"></a><span class="lineno"> 7021</span>&#160;<span class="comment"> * thread_p (in)       : thread entry</span></div><div class="line"><a name="l07022"></a><span class="lineno"> 7022</span>&#160;<span class="comment"> * sysop_end (in)      : system op end log record</span></div><div class="line"><a name="l07023"></a><span class="lineno"> 7023</span>&#160;<span class="comment"> * log_lsa (in/out)    : LSA of undo data (logical undo only)</span></div><div class="line"><a name="l07024"></a><span class="lineno"> 7024</span>&#160;<span class="comment"> * log_page_p (in/out) : page of undo data (logical undo only)</span></div><div class="line"><a name="l07025"></a><span class="lineno"> 7025</span>&#160;<span class="comment"> * log_zip_p (in/out)  : log unzip</span></div><div class="line"><a name="l07026"></a><span class="lineno"> 7026</span>&#160;<span class="comment"> * out_fp (in/out)     : dump output</span></div><div class="line"><a name="l07027"></a><span class="lineno"> 7027</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l07028"></a><span class="lineno"> 7028</span>&#160;<span class="keyword">static</span> <a class="code" href="structlog__page.html">LOG_PAGE</a> *</div><div class="line"><a name="l07029"></a><span class="lineno"> 7029</span>&#160;log_dump_record_sysop_end_internal (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="structlog__rec__sysop__end.html">LOG_REC_SYSOP_END</a> * sysop_end, <a class="code" href="structlog__lsa.html">LOG_LSA</a> * <a class="code" href="structlog__lsa.html">log_lsa</a>,</div><div class="line"><a name="l07030"></a><span class="lineno"> 7030</span>&#160;                    <a class="code" href="structlog__page.html">LOG_PAGE</a> * log_page_p, <a class="code" href="structlog__zip.html">LOG_ZIP</a> * log_zip_p, FILE * out_fp)</div><div class="line"><a name="l07031"></a><span class="lineno"> 7031</span>&#160;{</div><div class="line"><a name="l07032"></a><span class="lineno"> 7032</span>&#160;  <span class="keywordtype">int</span> undo_length;</div><div class="line"><a name="l07033"></a><span class="lineno"> 7033</span>&#160;  <a class="code" href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2b">LOG_RCVINDEX</a> rcvindex;</div><div class="line"><a name="l07034"></a><span class="lineno"> 7034</span>&#160;</div><div class="line"><a name="l07035"></a><span class="lineno"> 7035</span>&#160;  fprintf (out_fp, <span class="stringliteral">&quot;,\n     Prev parent LSA = %lld|%d, Prev_topresult_lsa = %lld|%d, %s \n&quot;</span>,</div><div class="line"><a name="l07036"></a><span class="lineno"> 7036</span>&#160;       <a class="code" href="storage__common_8h.html#a392873d6ffa4a8a6b2eb5f4b4fbbc97c">LSA_AS_ARGS</a> (&amp;sysop_end-&gt;<a class="code" href="structlog__rec__sysop__end.html#ac228866b1723dfd1165550c037fdc3aa">lastparent_lsa</a>), <a class="code" href="storage__common_8h.html#a392873d6ffa4a8a6b2eb5f4b4fbbc97c">LSA_AS_ARGS</a> (&amp;sysop_end-&gt;<a class="code" href="structlog__rec__sysop__end.html#aee18ec7d007cfa72f33ca61fcb93e7b3">prv_topresult_lsa</a>),</div><div class="line"><a name="l07037"></a><span class="lineno"> 7037</span>&#160;       <a class="code" href="log__manager_8c.html#aaa9c09a7c8de8d4a759762633f07c8a1">log_sysop_end_type_string</a> (sysop_end-&gt;<a class="code" href="structlog__rec__sysop__end.html#a3ea9d3ebfe5a0ed547670f1409fb385f">type</a>));</div><div class="line"><a name="l07038"></a><span class="lineno"> 7038</span>&#160;  <span class="keywordflow">switch</span> (sysop_end-&gt;<a class="code" href="structlog__rec__sysop__end.html#a3ea9d3ebfe5a0ed547670f1409fb385f">type</a>)</div><div class="line"><a name="l07039"></a><span class="lineno"> 7039</span>&#160;    {</div><div class="line"><a name="l07040"></a><span class="lineno"> 7040</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#a24797b2fe67e0ec8631d7a92fbef25c9a9530c67a9b21ab7a54d7c906f900a247">LOG_SYSOP_END_ABORT</a>:</div><div class="line"><a name="l07041"></a><span class="lineno"> 7041</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#a24797b2fe67e0ec8631d7a92fbef25c9a9e1c6cb1f049797b7b3f9230308663a3">LOG_SYSOP_END_COMMIT</a>:</div><div class="line"><a name="l07042"></a><span class="lineno"> 7042</span>&#160;      <span class="comment">/* nothing else to print */</span></div><div class="line"><a name="l07043"></a><span class="lineno"> 7043</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l07044"></a><span class="lineno"> 7044</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#a24797b2fe67e0ec8631d7a92fbef25c9a69f84e9574e7f583c88733bdea3a415f">LOG_SYSOP_END_LOGICAL_COMPENSATE</a>:</div><div class="line"><a name="l07045"></a><span class="lineno"> 7045</span>&#160;      fprintf (out_fp, <span class="stringliteral">&quot;     compansate_lsa = %lld|%d \n&quot;</span>, <a class="code" href="storage__common_8h.html#a392873d6ffa4a8a6b2eb5f4b4fbbc97c">LSA_AS_ARGS</a> (&amp;sysop_end-&gt;<a class="code" href="structlog__rec__sysop__end.html#ab094b81b70e8d75dbb0d38f29cc18f62">compensate_lsa</a>));</div><div class="line"><a name="l07046"></a><span class="lineno"> 7046</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l07047"></a><span class="lineno"> 7047</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#a24797b2fe67e0ec8631d7a92fbef25c9ada41432cf121d5aafecae01984edd8e7">LOG_SYSOP_END_LOGICAL_RUN_POSTPONE</a>:</div><div class="line"><a name="l07048"></a><span class="lineno"> 7048</span>&#160;      fprintf (out_fp, <span class="stringliteral">&quot;     run_postpone_lsa = %lld|%d, postpone = %s \n&quot;</span>,</div><div class="line"><a name="l07049"></a><span class="lineno"> 7049</span>&#160;           <a class="code" href="storage__common_8h.html#a392873d6ffa4a8a6b2eb5f4b4fbbc97c">LSA_AS_ARGS</a> (&amp;sysop_end-&gt;<a class="code" href="structlog__rec__sysop__end.html#a972f4330fb7cee921ad0dd2dbd6677ae">run_postpone</a>.postpone_lsa),</div><div class="line"><a name="l07050"></a><span class="lineno"> 7050</span>&#160;           sysop_end-&gt;<a class="code" href="structlog__rec__sysop__end.html#a972f4330fb7cee921ad0dd2dbd6677ae">run_postpone</a>.is_sysop_postpone ? <span class="stringliteral">&quot;sysop&quot;</span> : <span class="stringliteral">&quot;transaction&quot;</span>);</div><div class="line"><a name="l07051"></a><span class="lineno"> 7051</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l07052"></a><span class="lineno"> 7052</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#a24797b2fe67e0ec8631d7a92fbef25c9ac4566a4bae57d0a42fa6e37cc65e5329">LOG_SYSOP_END_LOGICAL_UNDO</a>:</div><div class="line"><a name="l07053"></a><span class="lineno"> 7053</span>&#160;      <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (<a class="code" href="structlog__lsa.html">log_lsa</a> != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> &amp;&amp; log_page_p != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> &amp;&amp; log_zip_p != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l07054"></a><span class="lineno"> 7054</span>&#160;</div><div class="line"><a name="l07055"></a><span class="lineno"> 7055</span>&#160;      fprintf (out_fp, <span class="stringliteral">&quot;, Recv_index = %s,\n&quot;</span>, <a class="code" href="recovery_8c.html#a9489c3632ab4b52fc008b589ce45cbdc">rv_rcvindex_string</a> (sysop_end-&gt;<a class="code" href="structlog__rec__sysop__end.html#a34c029c46715b2edc97a8f2c5ce9d309">undo</a>.<a class="code" href="structlog__rec__undo.html#a08b364e1c642e56ea610a5e51beb7d2b">data</a>.<a class="code" href="structlog__data.html#ab1a17fceea659d32f5187b81a7b80412">rcvindex</a>));</div><div class="line"><a name="l07056"></a><span class="lineno"> 7056</span>&#160;      fprintf (out_fp, <span class="stringliteral">&quot;     Volid = %d Pageid = %d Offset = %d,\n     Undo (Before) length = %d,\n&quot;</span>,</div><div class="line"><a name="l07057"></a><span class="lineno"> 7057</span>&#160;           sysop_end-&gt;<a class="code" href="structlog__rec__sysop__end.html#a34c029c46715b2edc97a8f2c5ce9d309">undo</a>.<a class="code" href="structlog__rec__undo.html#a08b364e1c642e56ea610a5e51beb7d2b">data</a>.<a class="code" href="structlog__data.html#ad5635159b85ee07322bf30e39a5dee76">volid</a>, sysop_end-&gt;<a class="code" href="structlog__rec__sysop__end.html#a34c029c46715b2edc97a8f2c5ce9d309">undo</a>.<a class="code" href="structlog__rec__undo.html#a08b364e1c642e56ea610a5e51beb7d2b">data</a>.<a class="code" href="structlog__data.html#a8410b9d70cc70d2bc6fb6df88ea48bb4">pageid</a>, sysop_end-&gt;<a class="code" href="structlog__rec__sysop__end.html#a34c029c46715b2edc97a8f2c5ce9d309">undo</a>.<a class="code" href="structlog__rec__undo.html#a08b364e1c642e56ea610a5e51beb7d2b">data</a>.<a class="code" href="structlog__data.html#afd25836b0952561036b01b5a50c310b2">offset</a>,</div><div class="line"><a name="l07058"></a><span class="lineno"> 7058</span>&#160;           (<span class="keywordtype">int</span>) <a class="code" href="log__compress_8h.html#ac32e36fd25b171236ebb38a5be94d00c">GET_ZIP_LEN</a> (sysop_end-&gt;<a class="code" href="structlog__rec__sysop__end.html#a34c029c46715b2edc97a8f2c5ce9d309">undo</a>.<a class="code" href="structlog__rec__undo.html#a50bcc130d05619893dbb63c284c3e874">length</a>));</div><div class="line"><a name="l07059"></a><span class="lineno"> 7059</span>&#160;</div><div class="line"><a name="l07060"></a><span class="lineno"> 7060</span>&#160;      undo_length = sysop_end-&gt;<a class="code" href="structlog__rec__sysop__end.html#a34c029c46715b2edc97a8f2c5ce9d309">undo</a>.<a class="code" href="structlog__rec__undo.html#a50bcc130d05619893dbb63c284c3e874">length</a>;</div><div class="line"><a name="l07061"></a><span class="lineno"> 7061</span>&#160;      rcvindex = sysop_end-&gt;<a class="code" href="structlog__rec__sysop__end.html#a34c029c46715b2edc97a8f2c5ce9d309">undo</a>.<a class="code" href="structlog__rec__undo.html#a08b364e1c642e56ea610a5e51beb7d2b">data</a>.<a class="code" href="structlog__data.html#ab1a17fceea659d32f5187b81a7b80412">rcvindex</a>;</div><div class="line"><a name="l07062"></a><span class="lineno"> 7062</span>&#160;      <a class="code" href="log__impl_8h.html#afdaa9fdf7d83212b3eec2d515e807686">LOG_READ_ADD_ALIGN</a> (thread_p, <span class="keyword">sizeof</span> (*sysop_end), <a class="code" href="structlog__lsa.html">log_lsa</a>, log_page_p);</div><div class="line"><a name="l07063"></a><span class="lineno"> 7063</span>&#160;      log_dump_data (thread_p, out_fp, undo_length, <a class="code" href="structlog__lsa.html">log_lsa</a>, log_page_p, <a class="code" href="recovery_8c.html#ad2eee9d1e5914fa34d3a7868bf2549f4">RV_fun</a>[rcvindex].dump_undofun, log_zip_p);</div><div class="line"><a name="l07064"></a><span class="lineno"> 7064</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l07065"></a><span class="lineno"> 7065</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#a24797b2fe67e0ec8631d7a92fbef25c9a571011a0354832edf02d40490f512716">LOG_SYSOP_END_LOGICAL_MVCC_UNDO</a>:</div><div class="line"><a name="l07066"></a><span class="lineno"> 7066</span>&#160;      <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (<a class="code" href="structlog__lsa.html">log_lsa</a> != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> &amp;&amp; log_page_p != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> &amp;&amp; log_zip_p != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l07067"></a><span class="lineno"> 7067</span>&#160;</div><div class="line"><a name="l07068"></a><span class="lineno"> 7068</span>&#160;      fprintf (out_fp, <span class="stringliteral">&quot;, Recv_index = %s,\n&quot;</span>, <a class="code" href="recovery_8c.html#a9489c3632ab4b52fc008b589ce45cbdc">rv_rcvindex_string</a> (sysop_end-&gt;<a class="code" href="structlog__rec__sysop__end.html#a013e84a84232dee701d8083c07a172c9">mvcc_undo</a>.<a class="code" href="structlog__rec__mvcc__undo.html#a7f17cde1def984989174d8aca50307b6">undo</a>.<a class="code" href="structlog__rec__undo.html#a08b364e1c642e56ea610a5e51beb7d2b">data</a>.<a class="code" href="structlog__data.html#ab1a17fceea659d32f5187b81a7b80412">rcvindex</a>));</div><div class="line"><a name="l07069"></a><span class="lineno"> 7069</span>&#160;      fprintf (out_fp, <span class="stringliteral">&quot;     Volid = %d Pageid = %d Offset = %d,\n     Undo (Before) length = %d,\n&quot;</span>,</div><div class="line"><a name="l07070"></a><span class="lineno"> 7070</span>&#160;           sysop_end-&gt;<a class="code" href="structlog__rec__sysop__end.html#a013e84a84232dee701d8083c07a172c9">mvcc_undo</a>.<a class="code" href="structlog__rec__mvcc__undo.html#a7f17cde1def984989174d8aca50307b6">undo</a>.<a class="code" href="structlog__rec__undo.html#a08b364e1c642e56ea610a5e51beb7d2b">data</a>.<a class="code" href="structlog__data.html#ad5635159b85ee07322bf30e39a5dee76">volid</a>, sysop_end-&gt;<a class="code" href="structlog__rec__sysop__end.html#a013e84a84232dee701d8083c07a172c9">mvcc_undo</a>.<a class="code" href="structlog__rec__mvcc__undo.html#a7f17cde1def984989174d8aca50307b6">undo</a>.<a class="code" href="structlog__rec__undo.html#a08b364e1c642e56ea610a5e51beb7d2b">data</a>.<a class="code" href="structlog__data.html#a8410b9d70cc70d2bc6fb6df88ea48bb4">pageid</a>,</div><div class="line"><a name="l07071"></a><span class="lineno"> 7071</span>&#160;           sysop_end-&gt;<a class="code" href="structlog__rec__sysop__end.html#a013e84a84232dee701d8083c07a172c9">mvcc_undo</a>.<a class="code" href="structlog__rec__mvcc__undo.html#a7f17cde1def984989174d8aca50307b6">undo</a>.<a class="code" href="structlog__rec__undo.html#a08b364e1c642e56ea610a5e51beb7d2b">data</a>.<a class="code" href="structlog__data.html#afd25836b0952561036b01b5a50c310b2">offset</a>, (<span class="keywordtype">int</span>) <a class="code" href="log__compress_8h.html#ac32e36fd25b171236ebb38a5be94d00c">GET_ZIP_LEN</a> (sysop_end-&gt;<a class="code" href="structlog__rec__sysop__end.html#a013e84a84232dee701d8083c07a172c9">mvcc_undo</a>.<a class="code" href="structlog__rec__mvcc__undo.html#a7f17cde1def984989174d8aca50307b6">undo</a>.<a class="code" href="structlog__rec__undo.html#a50bcc130d05619893dbb63c284c3e874">length</a>));</div><div class="line"><a name="l07072"></a><span class="lineno"> 7072</span>&#160;      fprintf (out_fp, <span class="stringliteral">&quot;     MVCCID = %llu, \n     Prev_mvcc_op_log_lsa = %lld|%d, \n     VFID = (%d, %d)&quot;</span>,</div><div class="line"><a name="l07073"></a><span class="lineno"> 7073</span>&#160;           (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span>) sysop_end-&gt;<a class="code" href="structlog__rec__sysop__end.html#a013e84a84232dee701d8083c07a172c9">mvcc_undo</a>.<a class="code" href="structlog__rec__mvcc__undo.html#ae7c1bf9c8eb5a86167f621ac40445f96">mvccid</a>,</div><div class="line"><a name="l07074"></a><span class="lineno"> 7074</span>&#160;           <a class="code" href="storage__common_8h.html#a392873d6ffa4a8a6b2eb5f4b4fbbc97c">LSA_AS_ARGS</a> (&amp;sysop_end-&gt;<a class="code" href="structlog__rec__sysop__end.html#a013e84a84232dee701d8083c07a172c9">mvcc_undo</a>.<a class="code" href="structlog__rec__mvcc__undo.html#afb6e7f17fc0d9cbb25f0d94e0bba4efd">vacuum_info</a>.<a class="code" href="structlog__vacuum__info.html#a1fc0aeb2562118f210e453ffff9d75da">prev_mvcc_op_log_lsa</a>),</div><div class="line"><a name="l07075"></a><span class="lineno"> 7075</span>&#160;           <a class="code" href="dbtype__def_8h.html#a363125e989d56ec5b9f89f39a743c018">VFID_AS_ARGS</a> (&amp;sysop_end-&gt;<a class="code" href="structlog__rec__sysop__end.html#a013e84a84232dee701d8083c07a172c9">mvcc_undo</a>.<a class="code" href="structlog__rec__mvcc__undo.html#afb6e7f17fc0d9cbb25f0d94e0bba4efd">vacuum_info</a>.<a class="code" href="structlog__vacuum__info.html#aeb919b86c45ee91e08f67f3c13bb9465">vfid</a>));</div><div class="line"><a name="l07076"></a><span class="lineno"> 7076</span>&#160;</div><div class="line"><a name="l07077"></a><span class="lineno"> 7077</span>&#160;      undo_length = sysop_end-&gt;<a class="code" href="structlog__rec__sysop__end.html#a013e84a84232dee701d8083c07a172c9">mvcc_undo</a>.<a class="code" href="structlog__rec__mvcc__undo.html#a7f17cde1def984989174d8aca50307b6">undo</a>.<a class="code" href="structlog__rec__undo.html#a50bcc130d05619893dbb63c284c3e874">length</a>;</div><div class="line"><a name="l07078"></a><span class="lineno"> 7078</span>&#160;      rcvindex = sysop_end-&gt;<a class="code" href="structlog__rec__sysop__end.html#a013e84a84232dee701d8083c07a172c9">mvcc_undo</a>.<a class="code" href="structlog__rec__mvcc__undo.html#a7f17cde1def984989174d8aca50307b6">undo</a>.<a class="code" href="structlog__rec__undo.html#a08b364e1c642e56ea610a5e51beb7d2b">data</a>.<a class="code" href="structlog__data.html#ab1a17fceea659d32f5187b81a7b80412">rcvindex</a>;</div><div class="line"><a name="l07079"></a><span class="lineno"> 7079</span>&#160;      <a class="code" href="log__impl_8h.html#afdaa9fdf7d83212b3eec2d515e807686">LOG_READ_ADD_ALIGN</a> (thread_p, <span class="keyword">sizeof</span> (*sysop_end), <a class="code" href="structlog__lsa.html">log_lsa</a>, log_page_p);</div><div class="line"><a name="l07080"></a><span class="lineno"> 7080</span>&#160;      log_dump_data (thread_p, out_fp, undo_length, <a class="code" href="structlog__lsa.html">log_lsa</a>, log_page_p, <a class="code" href="recovery_8c.html#ad2eee9d1e5914fa34d3a7868bf2549f4">RV_fun</a>[rcvindex].dump_undofun, log_zip_p);</div><div class="line"><a name="l07081"></a><span class="lineno"> 7081</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l07082"></a><span class="lineno"> 7082</span>&#160;    <span class="keywordflow">default</span>:</div><div class="line"><a name="l07083"></a><span class="lineno"> 7083</span>&#160;      <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (<span class="keyword">false</span>);</div><div class="line"><a name="l07084"></a><span class="lineno"> 7084</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l07085"></a><span class="lineno"> 7085</span>&#160;    }</div><div class="line"><a name="l07086"></a><span class="lineno"> 7086</span>&#160;  <span class="keywordflow">return</span> log_page_p;</div><div class="line"><a name="l07087"></a><span class="lineno"> 7087</span>&#160;}</div><div class="line"><a name="l07088"></a><span class="lineno"> 7088</span>&#160;</div><div class="line"><a name="l07089"></a><span class="lineno"> 7089</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l07090"></a><span class="lineno"> 7090</span>&#160;<span class="comment"> * log_dump_record_sysop_end () - Dump sysop end log record types. Side-effect: log_lsa and log_page_p will be</span></div><div class="line"><a name="l07091"></a><span class="lineno"> 7091</span>&#160;<span class="comment"> *                positioned after the log record.</span></div><div class="line"><a name="l07092"></a><span class="lineno"> 7092</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l07093"></a><span class="lineno"> 7093</span>&#160;<span class="comment"> * return          : NULL if something bad happens, pointer to log page otherwise.</span></div><div class="line"><a name="l07094"></a><span class="lineno"> 7094</span>&#160;<span class="comment"> * thread_p (in)       : Thread entry.</span></div><div class="line"><a name="l07095"></a><span class="lineno"> 7095</span>&#160;<span class="comment"> * log_lsa (in/out)    : in - LSA of log record, out - LSA after log record.</span></div><div class="line"><a name="l07096"></a><span class="lineno"> 7096</span>&#160;<span class="comment"> * log_page_p (in/out) : in - page of log record, out - page after log record.</span></div><div class="line"><a name="l07097"></a><span class="lineno"> 7097</span>&#160;<span class="comment"> * log_zip_p (in)      : Unzip context.</span></div><div class="line"><a name="l07098"></a><span class="lineno"> 7098</span>&#160;<span class="comment"> * out_fp (in/out)     : Dump output.</span></div><div class="line"><a name="l07099"></a><span class="lineno"> 7099</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l07100"></a><span class="lineno"> 7100</span>&#160;<span class="keyword">static</span> <a class="code" href="structlog__page.html">LOG_PAGE</a> *</div><div class="line"><a name="l07101"></a><span class="lineno"> 7101</span>&#160;log_dump_record_sysop_end (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="structlog__lsa.html">LOG_LSA</a> * <a class="code" href="structlog__lsa.html">log_lsa</a>, <a class="code" href="structlog__page.html">LOG_PAGE</a> * log_page_p, <a class="code" href="structlog__zip.html">LOG_ZIP</a> * log_zip_p,</div><div class="line"><a name="l07102"></a><span class="lineno"> 7102</span>&#160;               FILE * out_fp)</div><div class="line"><a name="l07103"></a><span class="lineno"> 7103</span>&#160;{</div><div class="line"><a name="l07104"></a><span class="lineno"> 7104</span>&#160;  <a class="code" href="structlog__rec__sysop__end.html">LOG_REC_SYSOP_END</a> *sysop_end;</div><div class="line"><a name="l07105"></a><span class="lineno"> 7105</span>&#160;</div><div class="line"><a name="l07106"></a><span class="lineno"> 7106</span>&#160;  <a class="code" href="log__impl_8h.html#a108c8143796ad50c65f64d4a483e9453">LOG_READ_ADVANCE_WHEN_DOESNT_FIT</a> (thread_p, <span class="keyword">sizeof</span> (*sysop_end), <a class="code" href="structlog__lsa.html">log_lsa</a>, log_page_p);</div><div class="line"><a name="l07107"></a><span class="lineno"> 7107</span>&#160;  sysop_end = (<a class="code" href="structlog__rec__sysop__end.html">LOG_REC_SYSOP_END</a> *) ((<span class="keywordtype">char</span> *) log_page_p-&gt;<a class="code" href="structlog__page.html#a9b51b4623cdb8d1686f6f8fb64bc9ee2">area</a> + <a class="code" href="structlog__lsa.html">log_lsa</a>-&gt;<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a>);</div><div class="line"><a name="l07108"></a><span class="lineno"> 7108</span>&#160;</div><div class="line"><a name="l07109"></a><span class="lineno"> 7109</span>&#160;  log_dump_record_sysop_end_internal (thread_p, sysop_end, <a class="code" href="structlog__lsa.html">log_lsa</a>, log_page_p, log_zip_p, out_fp);</div><div class="line"><a name="l07110"></a><span class="lineno"> 7110</span>&#160;</div><div class="line"><a name="l07111"></a><span class="lineno"> 7111</span>&#160;  <span class="keywordflow">return</span> log_page_p;</div><div class="line"><a name="l07112"></a><span class="lineno"> 7112</span>&#160;}</div><div class="line"><a name="l07113"></a><span class="lineno"> 7113</span>&#160;</div><div class="line"><a name="l07114"></a><span class="lineno"> 7114</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l07115"></a><span class="lineno"> 7115</span>&#160;<span class="comment"> * log_dump_checkpoint_topops - DUMP CHECKPOINT OF TOP SYSTEM OPERATIONS</span></div><div class="line"><a name="l07116"></a><span class="lineno"> 7116</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l07117"></a><span class="lineno"> 7117</span>&#160;<span class="comment"> * return: nothing</span></div><div class="line"><a name="l07118"></a><span class="lineno"> 7118</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l07119"></a><span class="lineno"> 7119</span>&#160;<span class="comment"> *   length(in): Length to dump in bytes</span></div><div class="line"><a name="l07120"></a><span class="lineno"> 7120</span>&#160;<span class="comment"> *   data(in): The data being logged</span></div><div class="line"><a name="l07121"></a><span class="lineno"> 7121</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l07122"></a><span class="lineno"> 7122</span>&#160;<span class="comment"> * NOTE: Dump the checkpoint top system operation structure.</span></div><div class="line"><a name="l07123"></a><span class="lineno"> 7123</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l07124"></a><span class="lineno"> 7124</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div><div class="line"><a name="l07125"></a><span class="lineno"> 7125</span>&#160;log_dump_checkpoint_topops (FILE * out_fp, <span class="keywordtype">int</span> length, <span class="keywordtype">void</span> *<a class="code" href="namespacestatdump__to__csv.html#aedcb70fde9c0b07a0732db70deeec616">data</a>)</div><div class="line"><a name="l07126"></a><span class="lineno"> 7126</span>&#160;{</div><div class="line"><a name="l07127"></a><span class="lineno"> 7127</span>&#160;  <span class="keywordtype">int</span> ntops, <a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div><div class="line"><a name="l07128"></a><span class="lineno"> 7128</span>&#160;  <a class="code" href="structlog__info__chkpt__sysop.html">LOG_INFO_CHKPT_SYSOP</a> *chkpt_topops;   <span class="comment">/* Checkpoint top system operations that are in commit postpone </span></div><div class="line"><a name="l07129"></a><span class="lineno"> 7129</span>&#160;<span class="comment">                     * mode */</span></div><div class="line"><a name="l07130"></a><span class="lineno"> 7130</span>&#160;  <a class="code" href="structlog__info__chkpt__sysop.html">LOG_INFO_CHKPT_SYSOP</a> *chkpt_topone;   <span class="comment">/* One top system ope */</span></div><div class="line"><a name="l07131"></a><span class="lineno"> 7131</span>&#160;</div><div class="line"><a name="l07132"></a><span class="lineno"> 7132</span>&#160;  chkpt_topops = (<a class="code" href="structlog__info__chkpt__sysop.html">LOG_INFO_CHKPT_SYSOP</a> *) <a class="code" href="namespacestatdump__to__csv.html#aedcb70fde9c0b07a0732db70deeec616">data</a>;</div><div class="line"><a name="l07133"></a><span class="lineno"> 7133</span>&#160;  ntops = length / <span class="keyword">sizeof</span> (*chkpt_topops);</div><div class="line"><a name="l07134"></a><span class="lineno"> 7134</span>&#160;</div><div class="line"><a name="l07135"></a><span class="lineno"> 7135</span>&#160;  <span class="comment">/* Start dumping each checkpoint top system operation */</span></div><div class="line"><a name="l07136"></a><span class="lineno"> 7136</span>&#160;</div><div class="line"><a name="l07137"></a><span class="lineno"> 7137</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; ntops; <a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l07138"></a><span class="lineno"> 7138</span>&#160;    {</div><div class="line"><a name="l07139"></a><span class="lineno"> 7139</span>&#160;      chkpt_topone = &amp;chkpt_topops[<a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div><div class="line"><a name="l07140"></a><span class="lineno"> 7140</span>&#160;      fprintf (out_fp, <span class="stringliteral">&quot;     Trid = %d \n&quot;</span>, chkpt_topone-&gt;<a class="code" href="structlog__info__chkpt__sysop.html#a34b9b7d8b5668b83c0301e95f012d067">trid</a>);</div><div class="line"><a name="l07141"></a><span class="lineno"> 7141</span>&#160;      fprintf (out_fp, <span class="stringliteral">&quot;     Sysop start postpone LSA = %lld|%d \n&quot;</span>,</div><div class="line"><a name="l07142"></a><span class="lineno"> 7142</span>&#160;           <a class="code" href="storage__common_8h.html#a392873d6ffa4a8a6b2eb5f4b4fbbc97c">LSA_AS_ARGS</a> (&amp;chkpt_topone-&gt;<a class="code" href="structlog__info__chkpt__sysop.html#ae79cc5b9e69174cee57f076c829424fc">sysop_start_postpone_lsa</a>));</div><div class="line"><a name="l07143"></a><span class="lineno"> 7143</span>&#160;    }</div><div class="line"><a name="l07144"></a><span class="lineno"> 7144</span>&#160;  (void) fprintf (out_fp, <span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l07145"></a><span class="lineno"> 7145</span>&#160;}</div><div class="line"><a name="l07146"></a><span class="lineno"> 7146</span>&#160;</div><div class="line"><a name="l07147"></a><span class="lineno"> 7147</span>&#160;<span class="keyword">static</span> <a class="code" href="structlog__page.html">LOG_PAGE</a> *</div><div class="line"><a name="l07148"></a><span class="lineno"> 7148</span>&#160;log_dump_record_checkpoint (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, FILE * out_fp, <a class="code" href="structlog__lsa.html">LOG_LSA</a> * <a class="code" href="structlog__lsa.html">log_lsa</a>, <a class="code" href="structlog__page.html">LOG_PAGE</a> * log_page_p)</div><div class="line"><a name="l07149"></a><span class="lineno"> 7149</span>&#160;{</div><div class="line"><a name="l07150"></a><span class="lineno"> 7150</span>&#160;  <a class="code" href="structlog__rec__chkpt.html">LOG_REC_CHKPT</a> *chkpt;     <span class="comment">/* check point log record */</span></div><div class="line"><a name="l07151"></a><span class="lineno"> 7151</span>&#160;  <span class="keywordtype">int</span> length_active_tran;</div><div class="line"><a name="l07152"></a><span class="lineno"> 7152</span>&#160;  <span class="keywordtype">int</span> length_topope;</div><div class="line"><a name="l07153"></a><span class="lineno"> 7153</span>&#160;</div><div class="line"><a name="l07154"></a><span class="lineno"> 7154</span>&#160;  <span class="comment">/* Read the DATA HEADER */</span></div><div class="line"><a name="l07155"></a><span class="lineno"> 7155</span>&#160;  <a class="code" href="log__impl_8h.html#a108c8143796ad50c65f64d4a483e9453">LOG_READ_ADVANCE_WHEN_DOESNT_FIT</a> (thread_p, <span class="keyword">sizeof</span> (*chkpt), <a class="code" href="structlog__lsa.html">log_lsa</a>, log_page_p);</div><div class="line"><a name="l07156"></a><span class="lineno"> 7156</span>&#160;</div><div class="line"><a name="l07157"></a><span class="lineno"> 7157</span>&#160;  chkpt = (<a class="code" href="structlog__rec__chkpt.html">LOG_REC_CHKPT</a> *) ((<span class="keywordtype">char</span> *) log_page_p-&gt;<a class="code" href="structlog__page.html#a9b51b4623cdb8d1686f6f8fb64bc9ee2">area</a> + <a class="code" href="structlog__lsa.html">log_lsa</a>-&gt;<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a>);</div><div class="line"><a name="l07158"></a><span class="lineno"> 7158</span>&#160;  fprintf (out_fp, <span class="stringliteral">&quot;, Num_trans = %d,\n&quot;</span>, chkpt-&gt;<a class="code" href="structlog__rec__chkpt.html#a7ffc41738640c267a1c3c58d16ac5e9d">ntrans</a>);</div><div class="line"><a name="l07159"></a><span class="lineno"> 7159</span>&#160;  fprintf (out_fp, <span class="stringliteral">&quot;     Redo_LSA = %lld|%d\n&quot;</span>, <a class="code" href="storage__common_8h.html#a392873d6ffa4a8a6b2eb5f4b4fbbc97c">LSA_AS_ARGS</a> (&amp;chkpt-&gt;<a class="code" href="structlog__rec__chkpt.html#aa5f6f5deedab3ff3f702c2c81f8bbc54">redo_lsa</a>));</div><div class="line"><a name="l07160"></a><span class="lineno"> 7160</span>&#160;</div><div class="line"><a name="l07161"></a><span class="lineno"> 7161</span>&#160;  length_active_tran = <span class="keyword">sizeof</span> (<a class="code" href="log__impl_8h.html#ae4d9be9c39c53c4e9448995435767e99">LOG_INFO_CHKPT_TRANS</a>) * chkpt-&gt;<a class="code" href="structlog__rec__chkpt.html#a7ffc41738640c267a1c3c58d16ac5e9d">ntrans</a>;</div><div class="line"><a name="l07162"></a><span class="lineno"> 7162</span>&#160;  length_topope = (sizeof (<a class="code" href="structlog__info__chkpt__sysop.html">LOG_INFO_CHKPT_SYSOP</a>) * chkpt-&gt;<a class="code" href="structlog__rec__chkpt.html#af3d8e20ddd54a1e43d1b57d120a27bf8">ntops</a>);</div><div class="line"><a name="l07163"></a><span class="lineno"> 7163</span>&#160;  <a class="code" href="log__impl_8h.html#afdaa9fdf7d83212b3eec2d515e807686">LOG_READ_ADD_ALIGN</a> (thread_p, <span class="keyword">sizeof</span> (*chkpt), <a class="code" href="structlog__lsa.html">log_lsa</a>, log_page_p);</div><div class="line"><a name="l07164"></a><span class="lineno"> 7164</span>&#160;  log_dump_data (thread_p, out_fp, length_active_tran, <a class="code" href="structlog__lsa.html">log_lsa</a>, log_page_p, <a class="code" href="log__impl_8h.html#a2a627b149f4e82c3afe669897cf2b5a5">logpb_dump_checkpoint_trans</a>, <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l07165"></a><span class="lineno"> 7165</span>&#160;  <span class="keywordflow">if</span> (length_topope &gt; 0)</div><div class="line"><a name="l07166"></a><span class="lineno"> 7166</span>&#160;    {</div><div class="line"><a name="l07167"></a><span class="lineno"> 7167</span>&#160;      log_dump_data (thread_p, out_fp, length_active_tran, <a class="code" href="structlog__lsa.html">log_lsa</a>, log_page_p, log_dump_checkpoint_topops, <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l07168"></a><span class="lineno"> 7168</span>&#160;    }</div><div class="line"><a name="l07169"></a><span class="lineno"> 7169</span>&#160;</div><div class="line"><a name="l07170"></a><span class="lineno"> 7170</span>&#160;  <span class="keywordflow">return</span> log_page_p;</div><div class="line"><a name="l07171"></a><span class="lineno"> 7171</span>&#160;}</div><div class="line"><a name="l07172"></a><span class="lineno"> 7172</span>&#160;</div><div class="line"><a name="l07173"></a><span class="lineno"> 7173</span>&#160;<span class="keyword">static</span> <a class="code" href="structlog__page.html">LOG_PAGE</a> *</div><div class="line"><a name="l07174"></a><span class="lineno"> 7174</span>&#160;log_dump_record_save_point (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, FILE * out_fp, <a class="code" href="structlog__lsa.html">LOG_LSA</a> * <a class="code" href="structlog__lsa.html">log_lsa</a>, <a class="code" href="structlog__page.html">LOG_PAGE</a> * log_page_p)</div><div class="line"><a name="l07175"></a><span class="lineno"> 7175</span>&#160;{</div><div class="line"><a name="l07176"></a><span class="lineno"> 7176</span>&#160;  <a class="code" href="structlog__rec__savept.html">LOG_REC_SAVEPT</a> *savept;</div><div class="line"><a name="l07177"></a><span class="lineno"> 7177</span>&#160;  <span class="keywordtype">int</span> length_save_point;</div><div class="line"><a name="l07178"></a><span class="lineno"> 7178</span>&#160;</div><div class="line"><a name="l07179"></a><span class="lineno"> 7179</span>&#160;  <span class="comment">/* Read the DATA HEADER */</span></div><div class="line"><a name="l07180"></a><span class="lineno"> 7180</span>&#160;  <a class="code" href="log__impl_8h.html#a108c8143796ad50c65f64d4a483e9453">LOG_READ_ADVANCE_WHEN_DOESNT_FIT</a> (thread_p, <span class="keyword">sizeof</span> (*savept), <a class="code" href="structlog__lsa.html">log_lsa</a>, log_page_p);</div><div class="line"><a name="l07181"></a><span class="lineno"> 7181</span>&#160;  savept = (<a class="code" href="structlog__rec__savept.html">LOG_REC_SAVEPT</a> *) ((<span class="keywordtype">char</span> *) log_page_p-&gt;<a class="code" href="structlog__page.html#a9b51b4623cdb8d1686f6f8fb64bc9ee2">area</a> + <a class="code" href="structlog__lsa.html">log_lsa</a>-&gt;<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a>);</div><div class="line"><a name="l07182"></a><span class="lineno"> 7182</span>&#160;</div><div class="line"><a name="l07183"></a><span class="lineno"> 7183</span>&#160;  fprintf (out_fp, <span class="stringliteral">&quot;, Prev_savept_Lsa = %lld|%d, length = %d,\n&quot;</span>, <a class="code" href="storage__common_8h.html#a392873d6ffa4a8a6b2eb5f4b4fbbc97c">LSA_AS_ARGS</a> (&amp;savept-&gt;<a class="code" href="structlog__rec__savept.html#aa2bda94b58670443b2a14129a78a06fb">prv_savept</a>), savept-&gt;<a class="code" href="structlog__rec__savept.html#af4be23754ed4d5067cff4a7e2bc4f726">length</a>);</div><div class="line"><a name="l07184"></a><span class="lineno"> 7184</span>&#160;</div><div class="line"><a name="l07185"></a><span class="lineno"> 7185</span>&#160;  length_save_point = savept-&gt;<a class="code" href="structlog__rec__savept.html#af4be23754ed4d5067cff4a7e2bc4f726">length</a>;</div><div class="line"><a name="l07186"></a><span class="lineno"> 7186</span>&#160;  <a class="code" href="log__impl_8h.html#afdaa9fdf7d83212b3eec2d515e807686">LOG_READ_ADD_ALIGN</a> (thread_p, <span class="keyword">sizeof</span> (*savept), <a class="code" href="structlog__lsa.html">log_lsa</a>, log_page_p);</div><div class="line"><a name="l07187"></a><span class="lineno"> 7187</span>&#160;</div><div class="line"><a name="l07188"></a><span class="lineno"> 7188</span>&#160;  <span class="comment">/* Print savept name */</span></div><div class="line"><a name="l07189"></a><span class="lineno"> 7189</span>&#160;  fprintf (out_fp, <span class="stringliteral">&quot;     Savept Name =&quot;</span>);</div><div class="line"><a name="l07190"></a><span class="lineno"> 7190</span>&#160;  log_dump_data (thread_p, out_fp, length_save_point, <a class="code" href="structlog__lsa.html">log_lsa</a>, log_page_p, log_hexa_dump, <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l07191"></a><span class="lineno"> 7191</span>&#160;</div><div class="line"><a name="l07192"></a><span class="lineno"> 7192</span>&#160;  <span class="keywordflow">return</span> log_page_p;</div><div class="line"><a name="l07193"></a><span class="lineno"> 7193</span>&#160;}</div><div class="line"><a name="l07194"></a><span class="lineno"> 7194</span>&#160;</div><div class="line"><a name="l07195"></a><span class="lineno"> 7195</span>&#160;<span class="keyword">static</span> <a class="code" href="structlog__page.html">LOG_PAGE</a> *</div><div class="line"><a name="l07196"></a><span class="lineno"> 7196</span>&#160;log_dump_record_2pc_prepare_commit (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, FILE * out_fp, <a class="code" href="structlog__lsa.html">LOG_LSA</a> * <a class="code" href="structlog__lsa.html">log_lsa</a>, <a class="code" href="structlog__page.html">LOG_PAGE</a> * log_page_p)</div><div class="line"><a name="l07197"></a><span class="lineno"> 7197</span>&#160;{</div><div class="line"><a name="l07198"></a><span class="lineno"> 7198</span>&#160;  <a class="code" href="structlog__rec__2pc__prepcommit.html">LOG_REC_2PC_PREPCOMMIT</a> *prepared;</div><div class="line"><a name="l07199"></a><span class="lineno"> 7199</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nobj_locks;</div><div class="line"><a name="l07200"></a><span class="lineno"> 7200</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="atldb__cubrid_8h.html#ae1f6914bd1202350b5825827bef9bba5">size</a>;</div><div class="line"><a name="l07201"></a><span class="lineno"> 7201</span>&#160;</div><div class="line"><a name="l07202"></a><span class="lineno"> 7202</span>&#160;  <span class="comment">/* Get the DATA HEADER */</span></div><div class="line"><a name="l07203"></a><span class="lineno"> 7203</span>&#160;  <a class="code" href="log__impl_8h.html#a108c8143796ad50c65f64d4a483e9453">LOG_READ_ADVANCE_WHEN_DOESNT_FIT</a> (thread_p, <span class="keyword">sizeof</span> (*prepared), <a class="code" href="structlog__lsa.html">log_lsa</a>, log_page_p);</div><div class="line"><a name="l07204"></a><span class="lineno"> 7204</span>&#160;  prepared = (<a class="code" href="structlog__rec__2pc__prepcommit.html">LOG_REC_2PC_PREPCOMMIT</a> *) ((<span class="keywordtype">char</span> *) log_page_p-&gt;<a class="code" href="structlog__page.html#a9b51b4623cdb8d1686f6f8fb64bc9ee2">area</a> + <a class="code" href="structlog__lsa.html">log_lsa</a>-&gt;<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a>);</div><div class="line"><a name="l07205"></a><span class="lineno"> 7205</span>&#160;</div><div class="line"><a name="l07206"></a><span class="lineno"> 7206</span>&#160;  fprintf (out_fp, <span class="stringliteral">&quot;, Client_name = %s, Gtrid = %d, Num objlocks = %u\n&quot;</span>, prepared-&gt;<a class="code" href="structlog__rec__2pc__prepcommit.html#acc5535d8ddf82b6e57b4e2c877f5df3b">user_name</a>, prepared-&gt;<a class="code" href="structlog__rec__2pc__prepcommit.html#a928285756947bb78b88ba7d399713430">gtrid</a>,</div><div class="line"><a name="l07207"></a><span class="lineno"> 7207</span>&#160;       prepared-&gt;<a class="code" href="structlog__rec__2pc__prepcommit.html#a2fb6434c8a904488679bec8d1c5fd161">num_object_locks</a>);</div><div class="line"><a name="l07208"></a><span class="lineno"> 7208</span>&#160;</div><div class="line"><a name="l07209"></a><span class="lineno"> 7209</span>&#160;  nobj_locks = prepared-&gt;<a class="code" href="structlog__rec__2pc__prepcommit.html#a2fb6434c8a904488679bec8d1c5fd161">num_object_locks</a>;</div><div class="line"><a name="l07210"></a><span class="lineno"> 7210</span>&#160;</div><div class="line"><a name="l07211"></a><span class="lineno"> 7211</span>&#160;  <a class="code" href="log__impl_8h.html#afdaa9fdf7d83212b3eec2d515e807686">LOG_READ_ADD_ALIGN</a> (thread_p, <span class="keyword">sizeof</span> (*prepared), <a class="code" href="structlog__lsa.html">log_lsa</a>, log_page_p);</div><div class="line"><a name="l07212"></a><span class="lineno"> 7212</span>&#160;</div><div class="line"><a name="l07213"></a><span class="lineno"> 7213</span>&#160;  <span class="comment">/* Dump global transaction user information */</span></div><div class="line"><a name="l07214"></a><span class="lineno"> 7214</span>&#160;  <span class="keywordflow">if</span> (prepared-&gt;<a class="code" href="structlog__rec__2pc__prepcommit.html#aebbcaf39734bdbba0c37af1292a7cb9e">gtrinfo_length</a> &gt; 0)</div><div class="line"><a name="l07215"></a><span class="lineno"> 7215</span>&#160;    {</div><div class="line"><a name="l07216"></a><span class="lineno"> 7216</span>&#160;      log_dump_data (thread_p, out_fp, prepared-&gt;<a class="code" href="structlog__rec__2pc__prepcommit.html#aebbcaf39734bdbba0c37af1292a7cb9e">gtrinfo_length</a>, <a class="code" href="structlog__lsa.html">log_lsa</a>, log_page_p, <a class="code" href="log__2pc_8c.html#a2854dc00bf3ef6c931e74ef18a87f999">log_2pc_dump_gtrinfo</a>, <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l07217"></a><span class="lineno"> 7217</span>&#160;    }</div><div class="line"><a name="l07218"></a><span class="lineno"> 7218</span>&#160;</div><div class="line"><a name="l07219"></a><span class="lineno"> 7219</span>&#160;  <span class="comment">/* Dump object locks */</span></div><div class="line"><a name="l07220"></a><span class="lineno"> 7220</span>&#160;  <span class="keywordflow">if</span> (nobj_locks &gt; 0)</div><div class="line"><a name="l07221"></a><span class="lineno"> 7221</span>&#160;    {</div><div class="line"><a name="l07222"></a><span class="lineno"> 7222</span>&#160;      <a class="code" href="atldb__cubrid_8h.html#ae1f6914bd1202350b5825827bef9bba5">size</a> = nobj_locks * <span class="keyword">sizeof</span> (<a class="code" href="lock__manager_8h.html#ab0bca202e031bb24d8cfdfd10fef32a8">LK_ACQOBJ_LOCK</a>);</div><div class="line"><a name="l07223"></a><span class="lineno"> 7223</span>&#160;      log_dump_data (thread_p, out_fp, <a class="code" href="atldb__cubrid_8h.html#ae1f6914bd1202350b5825827bef9bba5">size</a>, <a class="code" href="structlog__lsa.html">log_lsa</a>, log_page_p, <a class="code" href="log__2pc_8c.html#a5ca4289c73c7a20f910ab4b689620520">log_2pc_dump_acqobj_locks</a>, <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l07224"></a><span class="lineno"> 7224</span>&#160;    }</div><div class="line"><a name="l07225"></a><span class="lineno"> 7225</span>&#160;</div><div class="line"><a name="l07226"></a><span class="lineno"> 7226</span>&#160;  <span class="keywordflow">return</span> log_page_p;</div><div class="line"><a name="l07227"></a><span class="lineno"> 7227</span>&#160;}</div><div class="line"><a name="l07228"></a><span class="lineno"> 7228</span>&#160;</div><div class="line"><a name="l07229"></a><span class="lineno"> 7229</span>&#160;<span class="keyword">static</span> <a class="code" href="structlog__page.html">LOG_PAGE</a> *</div><div class="line"><a name="l07230"></a><span class="lineno"> 7230</span>&#160;log_dump_record_2pc_start (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, FILE * out_fp, <a class="code" href="structlog__lsa.html">LOG_LSA</a> * <a class="code" href="structlog__lsa.html">log_lsa</a>, <a class="code" href="structlog__page.html">LOG_PAGE</a> * log_page_p)</div><div class="line"><a name="l07231"></a><span class="lineno"> 7231</span>&#160;{</div><div class="line"><a name="l07232"></a><span class="lineno"> 7232</span>&#160;  <a class="code" href="structlog__rec__2pc__start.html">LOG_REC_2PC_START</a> *start_2pc; <span class="comment">/* Start log record of 2PC protocol */</span></div><div class="line"><a name="l07233"></a><span class="lineno"> 7233</span>&#160;</div><div class="line"><a name="l07234"></a><span class="lineno"> 7234</span>&#160;  <span class="comment">/* Get the DATA HEADER */</span></div><div class="line"><a name="l07235"></a><span class="lineno"> 7235</span>&#160;  <a class="code" href="log__impl_8h.html#a108c8143796ad50c65f64d4a483e9453">LOG_READ_ADVANCE_WHEN_DOESNT_FIT</a> (thread_p, <span class="keyword">sizeof</span> (*start_2pc), <a class="code" href="structlog__lsa.html">log_lsa</a>, log_page_p);</div><div class="line"><a name="l07236"></a><span class="lineno"> 7236</span>&#160;  start_2pc = (<a class="code" href="structlog__rec__2pc__start.html">LOG_REC_2PC_START</a> *) ((<span class="keywordtype">char</span> *) log_page_p-&gt;<a class="code" href="structlog__page.html#a9b51b4623cdb8d1686f6f8fb64bc9ee2">area</a> + <a class="code" href="structlog__lsa.html">log_lsa</a>-&gt;<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a>);</div><div class="line"><a name="l07237"></a><span class="lineno"> 7237</span>&#160;</div><div class="line"><a name="l07238"></a><span class="lineno"> 7238</span>&#160;  <span class="comment">/* Initilize the coordinator information */</span></div><div class="line"><a name="l07239"></a><span class="lineno"> 7239</span>&#160;  fprintf (out_fp, <span class="stringliteral">&quot;  Client_name = %s, Gtrid = %d,  Num_participants = %d&quot;</span>, start_2pc-&gt;<a class="code" href="structlog__rec__2pc__start.html#a3c155bc7cfea4d61a03ac96a09ec9e40">user_name</a>, start_2pc-&gt;<a class="code" href="structlog__rec__2pc__start.html#ae1eddc500ab6f74e454396b6b8b3c580">gtrid</a>,</div><div class="line"><a name="l07240"></a><span class="lineno"> 7240</span>&#160;       start_2pc-&gt;<a class="code" href="structlog__rec__2pc__start.html#a7652d396bdd0451db1db52822a55abc9">num_particps</a>);</div><div class="line"><a name="l07241"></a><span class="lineno"> 7241</span>&#160;</div><div class="line"><a name="l07242"></a><span class="lineno"> 7242</span>&#160;  <a class="code" href="log__impl_8h.html#afdaa9fdf7d83212b3eec2d515e807686">LOG_READ_ADD_ALIGN</a> (thread_p, <span class="keyword">sizeof</span> (*start_2pc), <a class="code" href="structlog__lsa.html">log_lsa</a>, log_page_p);</div><div class="line"><a name="l07243"></a><span class="lineno"> 7243</span>&#160;  <span class="comment">/* Read in the participants info. block from the log */</span></div><div class="line"><a name="l07244"></a><span class="lineno"> 7244</span>&#160;  log_dump_data (thread_p, out_fp, (start_2pc-&gt;<a class="code" href="structlog__rec__2pc__start.html#a8ca8c9f4109c567382d51e681606ab24">particp_id_length</a> * start_2pc-&gt;<a class="code" href="structlog__rec__2pc__start.html#a7652d396bdd0451db1db52822a55abc9">num_particps</a>), <a class="code" href="structlog__lsa.html">log_lsa</a>, log_page_p,</div><div class="line"><a name="l07245"></a><span class="lineno"> 7245</span>&#160;         <a class="code" href="log__2pc_8c.html#a43497b937744325d2a9da2ac9e7718fa">log_2pc_dump_participants</a>, <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l07246"></a><span class="lineno"> 7246</span>&#160;</div><div class="line"><a name="l07247"></a><span class="lineno"> 7247</span>&#160;  <span class="keywordflow">return</span> log_page_p;</div><div class="line"><a name="l07248"></a><span class="lineno"> 7248</span>&#160;}</div><div class="line"><a name="l07249"></a><span class="lineno"> 7249</span>&#160;</div><div class="line"><a name="l07250"></a><span class="lineno"> 7250</span>&#160;<span class="keyword">static</span> <a class="code" href="structlog__page.html">LOG_PAGE</a> *</div><div class="line"><a name="l07251"></a><span class="lineno"> 7251</span>&#160;log_dump_record_2pc_acknowledgement (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, FILE * out_fp, <a class="code" href="structlog__lsa.html">LOG_LSA</a> * <a class="code" href="structlog__lsa.html">log_lsa</a>, <a class="code" href="structlog__page.html">LOG_PAGE</a> * log_page_p)</div><div class="line"><a name="l07252"></a><span class="lineno"> 7252</span>&#160;{</div><div class="line"><a name="l07253"></a><span class="lineno"> 7253</span>&#160;  <a class="code" href="structlog__rec__2pc__particp__ack.html">LOG_REC_2PC_PARTICP_ACK</a> *received_ack;    <span class="comment">/* ack log record of 2pc protocol */</span></div><div class="line"><a name="l07254"></a><span class="lineno"> 7254</span>&#160;</div><div class="line"><a name="l07255"></a><span class="lineno"> 7255</span>&#160;  <span class="comment">/* Get the DATA HEADER */</span></div><div class="line"><a name="l07256"></a><span class="lineno"> 7256</span>&#160;  <a class="code" href="log__impl_8h.html#a108c8143796ad50c65f64d4a483e9453">LOG_READ_ADVANCE_WHEN_DOESNT_FIT</a> (thread_p, <span class="keyword">sizeof</span> (*received_ack), <a class="code" href="structlog__lsa.html">log_lsa</a>, log_page_p);</div><div class="line"><a name="l07257"></a><span class="lineno"> 7257</span>&#160;  received_ack = ((<a class="code" href="structlog__rec__2pc__particp__ack.html">LOG_REC_2PC_PARTICP_ACK</a> *) ((<span class="keywordtype">char</span> *) log_page_p-&gt;<a class="code" href="structlog__page.html#a9b51b4623cdb8d1686f6f8fb64bc9ee2">area</a> + <a class="code" href="structlog__lsa.html">log_lsa</a>-&gt;<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a>));</div><div class="line"><a name="l07258"></a><span class="lineno"> 7258</span>&#160;  fprintf (out_fp, <span class="stringliteral">&quot;  Participant index = %d\n&quot;</span>, received_ack-&gt;<a class="code" href="structlog__rec__2pc__particp__ack.html#ad3ac1fafb79f0ce5ab5551517bb78785">particp_index</a>);</div><div class="line"><a name="l07259"></a><span class="lineno"> 7259</span>&#160;</div><div class="line"><a name="l07260"></a><span class="lineno"> 7260</span>&#160;  <span class="keywordflow">return</span> log_page_p;</div><div class="line"><a name="l07261"></a><span class="lineno"> 7261</span>&#160;}</div><div class="line"><a name="l07262"></a><span class="lineno"> 7262</span>&#160;</div><div class="line"><a name="l07263"></a><span class="lineno"> 7263</span>&#160;<span class="keyword">static</span> <a class="code" href="structlog__page.html">LOG_PAGE</a> *</div><div class="line"><a name="l07264"></a><span class="lineno"> 7264</span>&#160;log_dump_record_ha_server_state (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, FILE * out_fp, <a class="code" href="structlog__lsa.html">LOG_LSA</a> * <a class="code" href="structlog__lsa.html">log_lsa</a>, <a class="code" href="structlog__page.html">LOG_PAGE</a> * log_page_p)</div><div class="line"><a name="l07265"></a><span class="lineno"> 7265</span>&#160;{</div><div class="line"><a name="l07266"></a><span class="lineno"> 7266</span>&#160;  <a class="code" href="structlog__rec__ha__server__state.html">LOG_REC_HA_SERVER_STATE</a> *<a class="code" href="boot_8h.html#aced830d72ca3bc3b775113c1d75a2368">ha_server_state</a>;</div><div class="line"><a name="l07267"></a><span class="lineno"> 7267</span>&#160;</div><div class="line"><a name="l07268"></a><span class="lineno"> 7268</span>&#160;  <span class="comment">/* Get the DATA HEADER */</span></div><div class="line"><a name="l07269"></a><span class="lineno"> 7269</span>&#160;  <a class="code" href="log__impl_8h.html#a108c8143796ad50c65f64d4a483e9453">LOG_READ_ADVANCE_WHEN_DOESNT_FIT</a> (thread_p, <span class="keyword">sizeof</span> (*<a class="code" href="boot_8h.html#aced830d72ca3bc3b775113c1d75a2368">ha_server_state</a>), <a class="code" href="structlog__lsa.html">log_lsa</a>, log_page_p);</div><div class="line"><a name="l07270"></a><span class="lineno"> 7270</span>&#160;  <a class="code" href="boot_8h.html#aced830d72ca3bc3b775113c1d75a2368">ha_server_state</a> = ((<a class="code" href="structlog__rec__ha__server__state.html">LOG_REC_HA_SERVER_STATE</a> *) ((<span class="keywordtype">char</span> *) log_page_p-&gt;<a class="code" href="structlog__page.html#a9b51b4623cdb8d1686f6f8fb64bc9ee2">area</a> + <a class="code" href="structlog__lsa.html">log_lsa</a>-&gt;<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a>));</div><div class="line"><a name="l07271"></a><span class="lineno"> 7271</span>&#160;  fprintf (out_fp, <span class="stringliteral">&quot;  HA server state = %d\n&quot;</span>, <a class="code" href="boot_8h.html#aced830d72ca3bc3b775113c1d75a2368">ha_server_state</a>-&gt;state);</div><div class="line"><a name="l07272"></a><span class="lineno"> 7272</span>&#160;</div><div class="line"><a name="l07273"></a><span class="lineno"> 7273</span>&#160;  <span class="keywordflow">return</span> log_page_p;</div><div class="line"><a name="l07274"></a><span class="lineno"> 7274</span>&#160;}</div><div class="line"><a name="l07275"></a><span class="lineno"> 7275</span>&#160;</div><div class="line"><a name="l07276"></a><span class="lineno"> 7276</span>&#160;<span class="keyword">static</span> <a class="code" href="structlog__page.html">LOG_PAGE</a> *</div><div class="line"><a name="l07277"></a><span class="lineno"> 7277</span>&#160;log_dump_record (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, FILE * out_fp, <a class="code" href="log__impl_8h.html#ab85dbe80b115a32bf7a430c32ddc5b8b">LOG_RECTYPE</a> record_type, <a class="code" href="structlog__lsa.html">LOG_LSA</a> * <a class="code" href="structlog__lsa.html">log_lsa</a>,</div><div class="line"><a name="l07278"></a><span class="lineno"> 7278</span>&#160;         <a class="code" href="structlog__page.html">LOG_PAGE</a> * log_page_p, <a class="code" href="structlog__zip.html">LOG_ZIP</a> * log_zip_p)</div><div class="line"><a name="l07279"></a><span class="lineno"> 7279</span>&#160;{</div><div class="line"><a name="l07280"></a><span class="lineno"> 7280</span>&#160;  <span class="keywordflow">switch</span> (record_type)</div><div class="line"><a name="l07281"></a><span class="lineno"> 7281</span>&#160;    {</div><div class="line"><a name="l07282"></a><span class="lineno"> 7282</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7aa0d885a58816898b0877635fc7f15716">LOG_UNDOREDO_DATA</a>:</div><div class="line"><a name="l07283"></a><span class="lineno"> 7283</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a1e8c5c5dbe12e8cc2388691db7011740">LOG_DIFF_UNDOREDO_DATA</a>:</div><div class="line"><a name="l07284"></a><span class="lineno"> 7284</span>&#160;      log_page_p = log_dump_record_undoredo (thread_p, out_fp, <a class="code" href="structlog__lsa.html">log_lsa</a>, log_page_p, log_zip_p);</div><div class="line"><a name="l07285"></a><span class="lineno"> 7285</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l07286"></a><span class="lineno"> 7286</span>&#160;</div><div class="line"><a name="l07287"></a><span class="lineno"> 7287</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a661c01f08dbb476251ceae0d99bb5412">LOG_UNDO_DATA</a>:</div><div class="line"><a name="l07288"></a><span class="lineno"> 7288</span>&#160;      log_page_p = log_dump_record_undo (thread_p, out_fp, <a class="code" href="structlog__lsa.html">log_lsa</a>, log_page_p, log_zip_p);</div><div class="line"><a name="l07289"></a><span class="lineno"> 7289</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l07290"></a><span class="lineno"> 7290</span>&#160;</div><div class="line"><a name="l07291"></a><span class="lineno"> 7291</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7ac17426d82957cd6c312341d4f5badd87">LOG_REDO_DATA</a>:</div><div class="line"><a name="l07292"></a><span class="lineno"> 7292</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7acf273d42fe8e9c360fb16c8c0f96c480">LOG_POSTPONE</a>:</div><div class="line"><a name="l07293"></a><span class="lineno"> 7293</span>&#160;      log_page_p = log_dump_record_redo (thread_p, out_fp, <a class="code" href="structlog__lsa.html">log_lsa</a>, log_page_p, log_zip_p);</div><div class="line"><a name="l07294"></a><span class="lineno"> 7294</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l07295"></a><span class="lineno"> 7295</span>&#160;</div><div class="line"><a name="l07296"></a><span class="lineno"> 7296</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7ab4e00d9048c5782ee68b646ff785f6de">LOG_MVCC_UNDOREDO_DATA</a>:</div><div class="line"><a name="l07297"></a><span class="lineno"> 7297</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7ae03e50858368a0a9e96e4cb7ce991354">LOG_MVCC_DIFF_UNDOREDO_DATA</a>:</div><div class="line"><a name="l07298"></a><span class="lineno"> 7298</span>&#160;      log_page_p = log_dump_record_mvcc_undoredo (thread_p, out_fp, <a class="code" href="structlog__lsa.html">log_lsa</a>, log_page_p, log_zip_p);</div><div class="line"><a name="l07299"></a><span class="lineno"> 7299</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l07300"></a><span class="lineno"> 7300</span>&#160;</div><div class="line"><a name="l07301"></a><span class="lineno"> 7301</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a5eb32eedc7671f3f89c1b10c3d0229c1">LOG_MVCC_UNDO_DATA</a>:</div><div class="line"><a name="l07302"></a><span class="lineno"> 7302</span>&#160;      log_page_p = log_dump_record_mvcc_undo (thread_p, out_fp, <a class="code" href="structlog__lsa.html">log_lsa</a>, log_page_p, log_zip_p);</div><div class="line"><a name="l07303"></a><span class="lineno"> 7303</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l07304"></a><span class="lineno"> 7304</span>&#160;</div><div class="line"><a name="l07305"></a><span class="lineno"> 7305</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a4252bfab0a4f9fbbcd7bd68ba32dea1d">LOG_MVCC_REDO_DATA</a>:</div><div class="line"><a name="l07306"></a><span class="lineno"> 7306</span>&#160;      log_page_p = log_dump_record_mvcc_redo (thread_p, out_fp, <a class="code" href="structlog__lsa.html">log_lsa</a>, log_page_p, log_zip_p);</div><div class="line"><a name="l07307"></a><span class="lineno"> 7307</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l07308"></a><span class="lineno"> 7308</span>&#160;</div><div class="line"><a name="l07309"></a><span class="lineno"> 7309</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a59ac89fe85edd8011e84db21095290a7">LOG_RUN_POSTPONE</a>:</div><div class="line"><a name="l07310"></a><span class="lineno"> 7310</span>&#160;      log_page_p = log_dump_record_postpone (thread_p, out_fp, <a class="code" href="structlog__lsa.html">log_lsa</a>, log_page_p);</div><div class="line"><a name="l07311"></a><span class="lineno"> 7311</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l07312"></a><span class="lineno"> 7312</span>&#160;</div><div class="line"><a name="l07313"></a><span class="lineno"> 7313</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a7557d9dfb53f14fd3b6eef04a165476b">LOG_DBEXTERN_REDO_DATA</a>:</div><div class="line"><a name="l07314"></a><span class="lineno"> 7314</span>&#160;      log_page_p = log_dump_record_dbout_redo (thread_p, out_fp, <a class="code" href="structlog__lsa.html">log_lsa</a>, log_page_p);</div><div class="line"><a name="l07315"></a><span class="lineno"> 7315</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l07316"></a><span class="lineno"> 7316</span>&#160;</div><div class="line"><a name="l07317"></a><span class="lineno"> 7317</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a92e0794a329897d52f3345d13359914e">LOG_COMPENSATE</a>:</div><div class="line"><a name="l07318"></a><span class="lineno"> 7318</span>&#160;      log_page_p = log_dump_record_compensate (thread_p, out_fp, <a class="code" href="structlog__lsa.html">log_lsa</a>, log_page_p);</div><div class="line"><a name="l07319"></a><span class="lineno"> 7319</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l07320"></a><span class="lineno"> 7320</span>&#160;</div><div class="line"><a name="l07321"></a><span class="lineno"> 7321</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a6b03dd6d350881f805f7b3adeedcf10f">LOG_COMMIT_WITH_POSTPONE</a>:</div><div class="line"><a name="l07322"></a><span class="lineno"> 7322</span>&#160;      log_page_p = log_dump_record_commit_postpone (thread_p, out_fp, <a class="code" href="structlog__lsa.html">log_lsa</a>, log_page_p);</div><div class="line"><a name="l07323"></a><span class="lineno"> 7323</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l07324"></a><span class="lineno"> 7324</span>&#160;</div><div class="line"><a name="l07325"></a><span class="lineno"> 7325</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a40516d04f27c98062921adb5282b4933">LOG_WILL_COMMIT</a>:</div><div class="line"><a name="l07326"></a><span class="lineno"> 7326</span>&#160;      fprintf (out_fp, <span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l07327"></a><span class="lineno"> 7327</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l07328"></a><span class="lineno"> 7328</span>&#160;</div><div class="line"><a name="l07329"></a><span class="lineno"> 7329</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a1903de7cf7fa88081eb8010a667e1839">LOG_COMMIT</a>:</div><div class="line"><a name="l07330"></a><span class="lineno"> 7330</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a66f7a15b57486fb9081e733c142d35ea">LOG_ABORT</a>:</div><div class="line"><a name="l07331"></a><span class="lineno"> 7331</span>&#160;      log_page_p = log_dump_record_transaction_finish (thread_p, out_fp, <a class="code" href="structlog__lsa.html">log_lsa</a>, log_page_p);</div><div class="line"><a name="l07332"></a><span class="lineno"> 7332</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l07333"></a><span class="lineno"> 7333</span>&#160;</div><div class="line"><a name="l07334"></a><span class="lineno"> 7334</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a97003f753507d5a7a65a0bf078a078f4">LOG_REPLICATION_DATA</a>:</div><div class="line"><a name="l07335"></a><span class="lineno"> 7335</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7ac9476ec323cd3909823f79ecc3938afd">LOG_REPLICATION_STATEMENT</a>:</div><div class="line"><a name="l07336"></a><span class="lineno"> 7336</span>&#160;      log_page_p = log_dump_record_replication (thread_p, out_fp, <a class="code" href="structlog__lsa.html">log_lsa</a>, log_page_p);</div><div class="line"><a name="l07337"></a><span class="lineno"> 7337</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l07338"></a><span class="lineno"> 7338</span>&#160;</div><div class="line"><a name="l07339"></a><span class="lineno"> 7339</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a198b93b13d51133e5e5d4b8e7c62f54e">LOG_SYSOP_START_POSTPONE</a>:</div><div class="line"><a name="l07340"></a><span class="lineno"> 7340</span>&#160;      log_page_p = log_dump_record_sysop_start_postpone (thread_p, out_fp, <a class="code" href="structlog__lsa.html">log_lsa</a>, log_page_p, log_zip_p);</div><div class="line"><a name="l07341"></a><span class="lineno"> 7341</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l07342"></a><span class="lineno"> 7342</span>&#160;</div><div class="line"><a name="l07343"></a><span class="lineno"> 7343</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a29a7c510ffdadeb0e4c5304e6825a5ec">LOG_SYSOP_END</a>:</div><div class="line"><a name="l07344"></a><span class="lineno"> 7344</span>&#160;      log_page_p = log_dump_record_sysop_end (thread_p, <a class="code" href="structlog__lsa.html">log_lsa</a>, log_page_p, log_zip_p, out_fp);</div><div class="line"><a name="l07345"></a><span class="lineno"> 7345</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l07346"></a><span class="lineno"> 7346</span>&#160;</div><div class="line"><a name="l07347"></a><span class="lineno"> 7347</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a76c06d374c551ca295e0594b74c9ff19">LOG_END_CHKPT</a>:</div><div class="line"><a name="l07348"></a><span class="lineno"> 7348</span>&#160;      log_page_p = log_dump_record_checkpoint (thread_p, out_fp, <a class="code" href="structlog__lsa.html">log_lsa</a>, log_page_p);</div><div class="line"><a name="l07349"></a><span class="lineno"> 7349</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l07350"></a><span class="lineno"> 7350</span>&#160;</div><div class="line"><a name="l07351"></a><span class="lineno"> 7351</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7ae96755081dc4d3599f98356864dfd7e0">LOG_SAVEPOINT</a>:</div><div class="line"><a name="l07352"></a><span class="lineno"> 7352</span>&#160;      log_page_p = log_dump_record_save_point (thread_p, out_fp, <a class="code" href="structlog__lsa.html">log_lsa</a>, log_page_p);</div><div class="line"><a name="l07353"></a><span class="lineno"> 7353</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l07354"></a><span class="lineno"> 7354</span>&#160;</div><div class="line"><a name="l07355"></a><span class="lineno"> 7355</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7aa83e8becd5b186f65485f6e819e416ea">LOG_2PC_PREPARE</a>:</div><div class="line"><a name="l07356"></a><span class="lineno"> 7356</span>&#160;      log_page_p = log_dump_record_2pc_prepare_commit (thread_p, out_fp, <a class="code" href="structlog__lsa.html">log_lsa</a>, log_page_p);</div><div class="line"><a name="l07357"></a><span class="lineno"> 7357</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l07358"></a><span class="lineno"> 7358</span>&#160;</div><div class="line"><a name="l07359"></a><span class="lineno"> 7359</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a69f87b42501f2ccfe66922ab196102d7">LOG_2PC_START</a>:</div><div class="line"><a name="l07360"></a><span class="lineno"> 7360</span>&#160;      log_page_p = log_dump_record_2pc_start (thread_p, out_fp, <a class="code" href="structlog__lsa.html">log_lsa</a>, log_page_p);</div><div class="line"><a name="l07361"></a><span class="lineno"> 7361</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l07362"></a><span class="lineno"> 7362</span>&#160;</div><div class="line"><a name="l07363"></a><span class="lineno"> 7363</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a4ab5b053c95a07cab41de19454b7663c">LOG_2PC_RECV_ACK</a>:</div><div class="line"><a name="l07364"></a><span class="lineno"> 7364</span>&#160;      log_page_p = log_dump_record_2pc_acknowledgement (thread_p, out_fp, <a class="code" href="structlog__lsa.html">log_lsa</a>, log_page_p);</div><div class="line"><a name="l07365"></a><span class="lineno"> 7365</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l07366"></a><span class="lineno"> 7366</span>&#160;</div><div class="line"><a name="l07367"></a><span class="lineno"> 7367</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a942105cb887dd1030b0c6151087d24ac">LOG_DUMMY_HA_SERVER_STATE</a>:</div><div class="line"><a name="l07368"></a><span class="lineno"> 7368</span>&#160;      log_page_p = log_dump_record_ha_server_state (thread_p, out_fp, <a class="code" href="structlog__lsa.html">log_lsa</a>, log_page_p);</div><div class="line"><a name="l07369"></a><span class="lineno"> 7369</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l07370"></a><span class="lineno"> 7370</span>&#160;</div><div class="line"><a name="l07371"></a><span class="lineno"> 7371</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a9e2aba85fbc168e57ae1744fa9da8a88">LOG_START_CHKPT</a>:</div><div class="line"><a name="l07372"></a><span class="lineno"> 7372</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a15a1ebeb5fd50ffb5ae73b0cb26f9e7e">LOG_2PC_COMMIT_DECISION</a>:</div><div class="line"><a name="l07373"></a><span class="lineno"> 7373</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a869d94e68bfc3354ad6bd211130cf13b">LOG_2PC_ABORT_DECISION</a>:</div><div class="line"><a name="l07374"></a><span class="lineno"> 7374</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a1ea8bf762d53de919a4eec322ebe9a1d">LOG_2PC_COMMIT_INFORM_PARTICPS</a>:</div><div class="line"><a name="l07375"></a><span class="lineno"> 7375</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a017e6014fefb381f8583c7ccd87c4133">LOG_2PC_ABORT_INFORM_PARTICPS</a>:</div><div class="line"><a name="l07376"></a><span class="lineno"> 7376</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a3839799b1d15f4333e439c136a3a21ca">LOG_SYSOP_ATOMIC_START</a>:</div><div class="line"><a name="l07377"></a><span class="lineno"> 7377</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7ab9a91cb4efa2ad495c98d7dc7fef8ee1">LOG_DUMMY_HEAD_POSTPONE</a>:</div><div class="line"><a name="l07378"></a><span class="lineno"> 7378</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a1ec512ba54217805936aa5afb03b3d98">LOG_DUMMY_CRASH_RECOVERY</a>:</div><div class="line"><a name="l07379"></a><span class="lineno"> 7379</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a3d03de268419fc962e6ca48de324a644">LOG_DUMMY_OVF_RECORD</a>:</div><div class="line"><a name="l07380"></a><span class="lineno"> 7380</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7aec133d8bc86aabdcf6dcda157999bd21">LOG_DUMMY_GENERIC</a>:</div><div class="line"><a name="l07381"></a><span class="lineno"> 7381</span>&#160;      fprintf (out_fp, <span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l07382"></a><span class="lineno"> 7382</span>&#160;      <span class="comment">/* That is all for this kind of log record */</span></div><div class="line"><a name="l07383"></a><span class="lineno"> 7383</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l07384"></a><span class="lineno"> 7384</span>&#160;</div><div class="line"><a name="l07385"></a><span class="lineno"> 7385</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a034d486f56b110bc31fba3b6db5dd980">LOG_END_OF_LOG</a>:</div><div class="line"><a name="l07386"></a><span class="lineno"> 7386</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="log__impl_8h.html#aa2a6e20070602d985015f39d448f8125">logpb_is_page_in_archive</a> (<a class="code" href="structlog__lsa.html">log_lsa</a>-&gt;<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a>))</div><div class="line"><a name="l07387"></a><span class="lineno"> 7387</span>&#160;    {</div><div class="line"><a name="l07388"></a><span class="lineno"> 7388</span>&#160;      fprintf (out_fp, <span class="stringliteral">&quot;\n... xxx END OF LOG xxx ...\n&quot;</span>);</div><div class="line"><a name="l07389"></a><span class="lineno"> 7389</span>&#160;    }</div><div class="line"><a name="l07390"></a><span class="lineno"> 7390</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l07391"></a><span class="lineno"> 7391</span>&#160;</div><div class="line"><a name="l07392"></a><span class="lineno"> 7392</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a8fc57c015374d8ecf822c5ea0f39faa0">LOG_SMALLER_LOGREC_TYPE</a>:</div><div class="line"><a name="l07393"></a><span class="lineno"> 7393</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a25bfb5a0ac528c508558bd8be6704739">LOG_LARGER_LOGREC_TYPE</a>:</div><div class="line"><a name="l07394"></a><span class="lineno"> 7394</span>&#160;    <span class="keywordflow">default</span>:</div><div class="line"><a name="l07395"></a><span class="lineno"> 7395</span>&#160;      fprintf (out_fp, <span class="stringliteral">&quot;log_dump: Unknown record type = %d (%s).\n&quot;</span>, record_type, <a class="code" href="log__manager_8c.html#a6e093782f446a5806cc9631a97eba1c3">log_to_string</a> (record_type));</div><div class="line"><a name="l07396"></a><span class="lineno"> 7396</span>&#160;      <a class="code" href="storage__common_8h.html#a6a4baec606189dd320678e8f412ca957">LSA_SET_NULL</a> (<a class="code" href="structlog__lsa.html">log_lsa</a>);</div><div class="line"><a name="l07397"></a><span class="lineno"> 7397</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l07398"></a><span class="lineno"> 7398</span>&#160;    }</div><div class="line"><a name="l07399"></a><span class="lineno"> 7399</span>&#160;</div><div class="line"><a name="l07400"></a><span class="lineno"> 7400</span>&#160;  <span class="keywordflow">return</span> log_page_p;</div><div class="line"><a name="l07401"></a><span class="lineno"> 7401</span>&#160;}</div><div class="line"><a name="l07402"></a><span class="lineno"> 7402</span>&#160;</div><div class="line"><a name="l07403"></a><span class="lineno"> 7403</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l07404"></a><span class="lineno"> 7404</span>&#160;<span class="comment"> * xlog_dump - DUMP THE LOG</span></div><div class="line"><a name="l07405"></a><span class="lineno"> 7405</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l07406"></a><span class="lineno"> 7406</span>&#160;<span class="comment"> * return: nothing</span></div><div class="line"><a name="l07407"></a><span class="lineno"> 7407</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l07408"></a><span class="lineno"> 7408</span>&#160;<span class="comment"> *   isforward(in): Dump the log forward ?</span></div><div class="line"><a name="l07409"></a><span class="lineno"> 7409</span>&#160;<span class="comment"> *   start_logpageid(in): Start dumping the log at this location</span></div><div class="line"><a name="l07410"></a><span class="lineno"> 7410</span>&#160;<span class="comment"> *   dump_npages(in): Number of pages to dump</span></div><div class="line"><a name="l07411"></a><span class="lineno"> 7411</span>&#160;<span class="comment"> *   desired_tranid(in): Dump entries of only this transaction. If NULL_TRANID,</span></div><div class="line"><a name="l07412"></a><span class="lineno"> 7412</span>&#160;<span class="comment"> *                     dump all.</span></div><div class="line"><a name="l07413"></a><span class="lineno"> 7413</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l07414"></a><span class="lineno"> 7414</span>&#160;<span class="comment"> * NOTE: Dump a set of log records stored in &quot;dump_npages&quot; starting at</span></div><div class="line"><a name="l07415"></a><span class="lineno"> 7415</span>&#160;<span class="comment"> *              page &quot;start_logpageid&quot; forward (or backward) according to the</span></div><div class="line"><a name="l07416"></a><span class="lineno"> 7416</span>&#160;<span class="comment"> *              value of &quot;isforward&quot;. When the value of start_logpageid is</span></div><div class="line"><a name="l07417"></a><span class="lineno"> 7417</span>&#160;<span class="comment"> *              negative, we start either at the beginning or at end of the</span></div><div class="line"><a name="l07418"></a><span class="lineno"> 7418</span>&#160;<span class="comment"> *              log according to the direction of the dump. If the value of</span></div><div class="line"><a name="l07419"></a><span class="lineno"> 7419</span>&#160;<span class="comment"> *              dump_npages is a negative value, dump as many pages as</span></div><div class="line"><a name="l07420"></a><span class="lineno"> 7420</span>&#160;<span class="comment"> *              possible.</span></div><div class="line"><a name="l07421"></a><span class="lineno"> 7421</span>&#160;<span class="comment"> *              This function is used for debugging purposes.</span></div><div class="line"><a name="l07422"></a><span class="lineno"> 7422</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l07423"></a><span class="lineno"> 7423</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l07424"></a><span class="lineno"><a class="line" href="log__manager_8h.html#af70d0e6ef6233c296087a8a4c7b26843"> 7424</a></span>&#160;<a class="code" href="log__manager_8c.html#af70d0e6ef6233c296087a8a4c7b26843">xlog_dump</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, FILE * out_fp, <span class="keywordtype">int</span> isforward, <a class="code" href="storage__common_8h.html#a26871e1bd203b43825e17ebfd14d072d">LOG_PAGEID</a> start_logpageid, <a class="code" href="storage__common_8h.html#a261e4bc7334f8eabe6e1f0a3d7f7dcb4">DKNPAGES</a> dump_npages,</div><div class="line"><a name="l07425"></a><span class="lineno"> 7425</span>&#160;       <a class="code" href="storage__common_8h.html#a129ad3bf94287c74f68d634d7e1f0228">TRANID</a> desired_tranid)</div><div class="line"><a name="l07426"></a><span class="lineno"> 7426</span>&#160;{</div><div class="line"><a name="l07427"></a><span class="lineno"> 7427</span>&#160;  <a class="code" href="structlog__lsa.html">LOG_LSA</a> lsa;          <span class="comment">/* LSA of log record to dump */</span></div><div class="line"><a name="l07428"></a><span class="lineno"> 7428</span>&#160;  <span class="keywordtype">char</span> log_pgbuf[<a class="code" href="storage__common_8h.html#a0a3c7db68a92df0d34666257bb0f17dd">IO_MAX_PAGE_SIZE</a> + <a class="code" href="memory__alloc_8h.html#a81d7e4971ffc775a379eeb4c65fa30f8">MAX_ALIGNMENT</a>], *aligned_log_pgbuf;</div><div class="line"><a name="l07429"></a><span class="lineno"> 7429</span>&#160;  <a class="code" href="structlog__page.html">LOG_PAGE</a> *log_pgptr = <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;   <span class="comment">/* Log page pointer where LSA is located */</span></div><div class="line"><a name="l07430"></a><span class="lineno"> 7430</span>&#160;  <a class="code" href="structlog__lsa.html">LOG_LSA</a> <a class="code" href="structlog__lsa.html">log_lsa</a>;</div><div class="line"><a name="l07431"></a><span class="lineno"> 7431</span>&#160;  <a class="code" href="log__impl_8h.html#ab85dbe80b115a32bf7a430c32ddc5b8b">LOG_RECTYPE</a> <a class="code" href="atldb__cubrid_8h.html#ad939da76b5d12fca40de18001582d63a">type</a>;     <span class="comment">/* Log record type */</span></div><div class="line"><a name="l07432"></a><span class="lineno"> 7432</span>&#160;  <a class="code" href="structlog__rec__header.html">LOG_RECORD_HEADER</a> *log_rec;   <span class="comment">/* Pointer to log record */</span></div><div class="line"><a name="l07433"></a><span class="lineno"> 7433</span>&#160;</div><div class="line"><a name="l07434"></a><span class="lineno"> 7434</span>&#160;  <a class="code" href="structlog__zip.html">LOG_ZIP</a> *log_dump_ptr = <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l07435"></a><span class="lineno"> 7435</span>&#160;</div><div class="line"><a name="l07436"></a><span class="lineno"> 7436</span>&#160;  aligned_log_pgbuf = <a class="code" href="memory__alloc_8h.html#a79781c0dbfdd9510d275cba54f1f384f">PTR_ALIGN</a> (log_pgbuf, <a class="code" href="memory__alloc_8h.html#a81d7e4971ffc775a379eeb4c65fa30f8">MAX_ALIGNMENT</a>);</div><div class="line"><a name="l07437"></a><span class="lineno"> 7437</span>&#160;</div><div class="line"><a name="l07438"></a><span class="lineno"> 7438</span>&#160;  <span class="keywordflow">if</span> (out_fp == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l07439"></a><span class="lineno"> 7439</span>&#160;    {</div><div class="line"><a name="l07440"></a><span class="lineno"> 7440</span>&#160;      out_fp = stdout;</div><div class="line"><a name="l07441"></a><span class="lineno"> 7441</span>&#160;    }</div><div class="line"><a name="l07442"></a><span class="lineno"> 7442</span>&#160;</div><div class="line"><a name="l07443"></a><span class="lineno"> 7443</span>&#160;  fprintf (out_fp, <span class="stringliteral">&quot;**************** DUMP LOGGING INFORMATION ************\n&quot;</span>);</div><div class="line"><a name="l07444"></a><span class="lineno"> 7444</span>&#160;  <span class="comment">/* Dump the transaction table and the log buffers */</span></div><div class="line"><a name="l07445"></a><span class="lineno"> 7445</span>&#160;</div><div class="line"><a name="l07446"></a><span class="lineno"> 7446</span>&#160;  <span class="comment">/* Flush any dirty log page */</span></div><div class="line"><a name="l07447"></a><span class="lineno"> 7447</span>&#160;  <a class="code" href="log__impl_8h.html#a5561d6b89dce60cfa780062fae1bb473">LOG_CS_ENTER</a> (thread_p);</div><div class="line"><a name="l07448"></a><span class="lineno"> 7448</span>&#160;</div><div class="line"><a name="l07449"></a><span class="lineno"> 7449</span>&#160;  <a class="code" href="log__impl_8h.html#a850b8bbb60976a9cbd23dab38dcf1767">xlogtb_dump_trantable</a> (thread_p, out_fp);</div><div class="line"><a name="l07450"></a><span class="lineno"> 7450</span>&#160;  <a class="code" href="log__impl_8h.html#ab5c84aff4d15372a2d150897ad6d2b80">logpb_flush_pages_direct</a> (thread_p);</div><div class="line"><a name="l07451"></a><span class="lineno"> 7451</span>&#160;  <a class="code" href="log__impl_8h.html#a48a9214aa55783d4ae5648457f686c6c">logpb_flush_header</a> (thread_p);</div><div class="line"><a name="l07452"></a><span class="lineno"> 7452</span>&#160;</div><div class="line"><a name="l07453"></a><span class="lineno"> 7453</span>&#160;  <span class="comment">/* Now start dumping the log */</span></div><div class="line"><a name="l07454"></a><span class="lineno"> 7454</span>&#160;  log_dump_header (out_fp, &amp;<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>);</div><div class="line"><a name="l07455"></a><span class="lineno"> 7455</span>&#160;</div><div class="line"><a name="l07456"></a><span class="lineno"> 7456</span>&#160;  lsa.<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a> = start_logpageid;</div><div class="line"><a name="l07457"></a><span class="lineno"> 7457</span>&#160;  lsa.<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a> = <a class="code" href="storage__common_8h.html#a5b0ca3ea530f289fa3f19921e5b0faf3">NULL_OFFSET</a>;</div><div class="line"><a name="l07458"></a><span class="lineno"> 7458</span>&#160;</div><div class="line"><a name="l07459"></a><span class="lineno"> 7459</span>&#160;  <span class="keywordflow">if</span> (isforward != <span class="keyword">false</span>)</div><div class="line"><a name="l07460"></a><span class="lineno"> 7460</span>&#160;    {</div><div class="line"><a name="l07461"></a><span class="lineno"> 7461</span>&#160;      <span class="comment">/* Forward */</span></div><div class="line"><a name="l07462"></a><span class="lineno"> 7462</span>&#160;      <span class="keywordflow">if</span> (lsa.<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a> &lt; 0)</div><div class="line"><a name="l07463"></a><span class="lineno"> 7463</span>&#160;    {</div><div class="line"><a name="l07464"></a><span class="lineno"> 7464</span>&#160;      lsa.<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a> = 0;</div><div class="line"><a name="l07465"></a><span class="lineno"> 7465</span>&#160;    }</div><div class="line"><a name="l07466"></a><span class="lineno"> 7466</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (lsa.<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a> &gt; <a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>.<a class="code" href="structlog__header.html#a982b3e55dedc3dabc54a1a7fcddc144e">append_lsa</a>.<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a> &amp;&amp; <a class="code" href="log__impl_8h.html#a8f08025b469332f89fee8ce83dc2d3ff">LOG_ISRESTARTED</a> ())</div><div class="line"><a name="l07467"></a><span class="lineno"> 7467</span>&#160;    {</div><div class="line"><a name="l07468"></a><span class="lineno"> 7468</span>&#160;      lsa.<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a> = <a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>.<a class="code" href="structlog__header.html#a982b3e55dedc3dabc54a1a7fcddc144e">append_lsa</a>.<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a>;</div><div class="line"><a name="l07469"></a><span class="lineno"> 7469</span>&#160;    }</div><div class="line"><a name="l07470"></a><span class="lineno"> 7470</span>&#160;    }</div><div class="line"><a name="l07471"></a><span class="lineno"> 7471</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l07472"></a><span class="lineno"> 7472</span>&#160;    {</div><div class="line"><a name="l07473"></a><span class="lineno"> 7473</span>&#160;      <span class="comment">/* Backward */</span></div><div class="line"><a name="l07474"></a><span class="lineno"> 7474</span>&#160;      <span class="keywordflow">if</span> (lsa.<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a> &lt; 0 || lsa.<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a> &gt; <a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>.<a class="code" href="structlog__header.html#a982b3e55dedc3dabc54a1a7fcddc144e">append_lsa</a>.<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a>)</div><div class="line"><a name="l07475"></a><span class="lineno"> 7475</span>&#160;    {</div><div class="line"><a name="l07476"></a><span class="lineno"> 7476</span>&#160;      log_find_end_log (thread_p, &amp;lsa);</div><div class="line"><a name="l07477"></a><span class="lineno"> 7477</span>&#160;    }</div><div class="line"><a name="l07478"></a><span class="lineno"> 7478</span>&#160;    }</div><div class="line"><a name="l07479"></a><span class="lineno"> 7479</span>&#160;</div><div class="line"><a name="l07480"></a><span class="lineno"> 7480</span>&#160;  <span class="keywordflow">if</span> (dump_npages &gt; <a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>.<a class="code" href="structlog__header.html#abf6f8b71041f36e854e9edaa910525be">npages</a> || dump_npages &lt; 0)</div><div class="line"><a name="l07481"></a><span class="lineno"> 7481</span>&#160;    {</div><div class="line"><a name="l07482"></a><span class="lineno"> 7482</span>&#160;      dump_npages = <a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>.<a class="code" href="structlog__header.html#abf6f8b71041f36e854e9edaa910525be">npages</a>;</div><div class="line"><a name="l07483"></a><span class="lineno"> 7483</span>&#160;    }</div><div class="line"><a name="l07484"></a><span class="lineno"> 7484</span>&#160;</div><div class="line"><a name="l07485"></a><span class="lineno"> 7485</span>&#160;  fprintf (out_fp,</div><div class="line"><a name="l07486"></a><span class="lineno"> 7486</span>&#160;       <span class="stringliteral">&quot;\n START DUMPING LOG_RECORDS: %s, start_logpageid = %lld,\n&quot;</span></div><div class="line"><a name="l07487"></a><span class="lineno"> 7487</span>&#160;       <span class="stringliteral">&quot; Num_pages_to_dump = %d, desired_tranid = %d\n&quot;</span>, (isforward ? <span class="stringliteral">&quot;Forward&quot;</span> : <span class="stringliteral">&quot;Backaward&quot;</span>),</div><div class="line"><a name="l07488"></a><span class="lineno"> 7488</span>&#160;       (<span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span>) start_logpageid, dump_npages, desired_tranid);</div><div class="line"><a name="l07489"></a><span class="lineno"> 7489</span>&#160;</div><div class="line"><a name="l07490"></a><span class="lineno"> 7490</span>&#160;  <a class="code" href="log__impl_8h.html#a6a5f95ded1a2f38ed00c8e9c039a9f2e">LOG_CS_EXIT</a> (thread_p);</div><div class="line"><a name="l07491"></a><span class="lineno"> 7491</span>&#160;</div><div class="line"><a name="l07492"></a><span class="lineno"> 7492</span>&#160;  log_pgptr = (<a class="code" href="structlog__page.html">LOG_PAGE</a> *) aligned_log_pgbuf;</div><div class="line"><a name="l07493"></a><span class="lineno"> 7493</span>&#160;</div><div class="line"><a name="l07494"></a><span class="lineno"> 7494</span>&#160;  <span class="keywordflow">if</span> (log_dump_ptr == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l07495"></a><span class="lineno"> 7495</span>&#160;    {</div><div class="line"><a name="l07496"></a><span class="lineno"> 7496</span>&#160;      log_dump_ptr = <a class="code" href="log__compress_8c.html#a57a48bb541f858a2602ae9f731f5200e">log_zip_alloc</a> (<a class="code" href="storage__common_8h.html#a097b8646f24ea98e209e18c53d74522a">IO_PAGESIZE</a>, <span class="keyword">false</span>);</div><div class="line"><a name="l07497"></a><span class="lineno"> 7497</span>&#160;      <span class="keywordflow">if</span> (log_dump_ptr == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l07498"></a><span class="lineno"> 7498</span>&#160;    {</div><div class="line"><a name="l07499"></a><span class="lineno"> 7499</span>&#160;      fprintf (out_fp, <span class="stringliteral">&quot; Error memory alloc... Quit\n&quot;</span>);</div><div class="line"><a name="l07500"></a><span class="lineno"> 7500</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l07501"></a><span class="lineno"> 7501</span>&#160;    }</div><div class="line"><a name="l07502"></a><span class="lineno"> 7502</span>&#160;    }</div><div class="line"><a name="l07503"></a><span class="lineno"> 7503</span>&#160;</div><div class="line"><a name="l07504"></a><span class="lineno"> 7504</span>&#160;  <span class="comment">/* Start dumping all log records following the given direction */</span></div><div class="line"><a name="l07505"></a><span class="lineno"> 7505</span>&#160;  <span class="keywordflow">while</span> (!<a class="code" href="storage__common_8h.html#a26dd766712df5b5c4fcd158f571a75e4">LSA_ISNULL</a> (&amp;lsa) &amp;&amp; dump_npages-- &gt; 0)</div><div class="line"><a name="l07506"></a><span class="lineno"> 7506</span>&#160;    {</div><div class="line"><a name="l07507"></a><span class="lineno"> 7507</span>&#160;      <span class="keywordflow">if</span> ((<a class="code" href="log__impl_8h.html#ac67cba94ac6c10da3ae0ab474155ea1a">logpb_fetch_page</a> (thread_p, &amp;lsa, <a class="code" href="log__impl_8h.html#ab33fe5f69028f102e9910294e97ccd6ba1a83d875d6d32208d2b7bed2283c959b">LOG_CS_SAFE_READER</a>, log_pgptr)) != <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>)</div><div class="line"><a name="l07508"></a><span class="lineno"> 7508</span>&#160;    {</div><div class="line"><a name="l07509"></a><span class="lineno"> 7509</span>&#160;      fprintf (out_fp, <span class="stringliteral">&quot; Error reading page %lld... Quit\n&quot;</span>, (<span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span>) lsa.<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a>);</div><div class="line"><a name="l07510"></a><span class="lineno"> 7510</span>&#160;      <span class="keywordflow">if</span> (log_dump_ptr != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l07511"></a><span class="lineno"> 7511</span>&#160;        {</div><div class="line"><a name="l07512"></a><span class="lineno"> 7512</span>&#160;          <a class="code" href="log__compress_8c.html#a87b9003990e598725fe9ed434ce007c9">log_zip_free</a> (log_dump_ptr);</div><div class="line"><a name="l07513"></a><span class="lineno"> 7513</span>&#160;        }</div><div class="line"><a name="l07514"></a><span class="lineno"> 7514</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l07515"></a><span class="lineno"> 7515</span>&#160;    }</div><div class="line"><a name="l07516"></a><span class="lineno"> 7516</span>&#160;      <span class="comment">/* </span></div><div class="line"><a name="l07517"></a><span class="lineno"> 7517</span>&#160;<span class="comment">       * If offset is missing, it is because we archive an incomplete</span></div><div class="line"><a name="l07518"></a><span class="lineno"> 7518</span>&#160;<span class="comment">       * log record or we start dumping the log not from its first page. We</span></div><div class="line"><a name="l07519"></a><span class="lineno"> 7519</span>&#160;<span class="comment">       * have to find the offset by searching for the next log_record in the page</span></div><div class="line"><a name="l07520"></a><span class="lineno"> 7520</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l07521"></a><span class="lineno"> 7521</span>&#160;      <span class="keywordflow">if</span> (lsa.<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a> == <a class="code" href="storage__common_8h.html#a5b0ca3ea530f289fa3f19921e5b0faf3">NULL_OFFSET</a> &amp;&amp; (lsa.<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a> = log_pgptr-&gt;<a class="code" href="structlog__page.html#a52640d2c65b2d7b95a330a670646e8f9">hdr</a>.<a class="code" href="structlog__hdrpage.html#a581cc8236b70bf22034b8006e44570d5">offset</a>) == <a class="code" href="storage__common_8h.html#a5b0ca3ea530f289fa3f19921e5b0faf3">NULL_OFFSET</a>)</div><div class="line"><a name="l07522"></a><span class="lineno"> 7522</span>&#160;    {</div><div class="line"><a name="l07523"></a><span class="lineno"> 7523</span>&#160;      <span class="comment">/* Nothing in this page.. */</span></div><div class="line"><a name="l07524"></a><span class="lineno"> 7524</span>&#160;      <span class="keywordflow">if</span> (lsa.<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a> &gt;= <a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>.<a class="code" href="structlog__header.html#a982b3e55dedc3dabc54a1a7fcddc144e">append_lsa</a>.<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a> || lsa.<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a> &lt;= 0)</div><div class="line"><a name="l07525"></a><span class="lineno"> 7525</span>&#160;        {</div><div class="line"><a name="l07526"></a><span class="lineno"> 7526</span>&#160;          <a class="code" href="storage__common_8h.html#a6a4baec606189dd320678e8f412ca957">LSA_SET_NULL</a> (&amp;lsa);</div><div class="line"><a name="l07527"></a><span class="lineno"> 7527</span>&#160;        }</div><div class="line"><a name="l07528"></a><span class="lineno"> 7528</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l07529"></a><span class="lineno"> 7529</span>&#160;        {</div><div class="line"><a name="l07530"></a><span class="lineno"> 7530</span>&#160;          <span class="comment">/* We need to dump one more page */</span></div><div class="line"><a name="l07531"></a><span class="lineno"> 7531</span>&#160;          lsa.<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a>--;</div><div class="line"><a name="l07532"></a><span class="lineno"> 7532</span>&#160;          dump_npages++;</div><div class="line"><a name="l07533"></a><span class="lineno"> 7533</span>&#160;        }</div><div class="line"><a name="l07534"></a><span class="lineno"> 7534</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l07535"></a><span class="lineno"> 7535</span>&#160;    }</div><div class="line"><a name="l07536"></a><span class="lineno"> 7536</span>&#160;</div><div class="line"><a name="l07537"></a><span class="lineno"> 7537</span>&#160;      <span class="comment">/* Dump all the log records stored in current log page */</span></div><div class="line"><a name="l07538"></a><span class="lineno"> 7538</span>&#160;      <a class="code" href="structlog__lsa.html">log_lsa</a>.<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a> = lsa.<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a>;</div><div class="line"><a name="l07539"></a><span class="lineno"> 7539</span>&#160;</div><div class="line"><a name="l07540"></a><span class="lineno"> 7540</span>&#160;      <span class="keywordflow">while</span> (lsa.<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a> == <a class="code" href="structlog__lsa.html">log_lsa</a>.<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a>)</div><div class="line"><a name="l07541"></a><span class="lineno"> 7541</span>&#160;    {</div><div class="line"><a name="l07542"></a><span class="lineno"> 7542</span>&#160;      <a class="code" href="structlog__lsa.html">log_lsa</a>.<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a> = lsa.<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a>;</div><div class="line"><a name="l07543"></a><span class="lineno"> 7543</span>&#160;      log_rec = <a class="code" href="log__impl_8h.html#ae37437431a8ea417a8e768ed5fa8f5f6">LOG_GET_LOG_RECORD_HEADER</a> (log_pgptr, &amp;<a class="code" href="structlog__lsa.html">log_lsa</a>);</div><div class="line"><a name="l07544"></a><span class="lineno"> 7544</span>&#160;      <a class="code" href="atldb__cubrid_8h.html#ad939da76b5d12fca40de18001582d63a">type</a> = log_rec-&gt;<a class="code" href="structlog__rec__header.html#aa9be1266bf7fdca13a0a789dc5ae11bb">type</a>;</div><div class="line"><a name="l07545"></a><span class="lineno"> 7545</span>&#160;</div><div class="line"><a name="l07546"></a><span class="lineno"> 7546</span>&#160;      {</div><div class="line"><a name="l07547"></a><span class="lineno"> 7547</span>&#160;        <span class="comment">/* </span></div><div class="line"><a name="l07548"></a><span class="lineno"> 7548</span>&#160;<span class="comment">         * The following is just for debugging next address calculations</span></div><div class="line"><a name="l07549"></a><span class="lineno"> 7549</span>&#160;<span class="comment">         */</span></div><div class="line"><a name="l07550"></a><span class="lineno"> 7550</span>&#160;        <a class="code" href="structlog__lsa.html">LOG_LSA</a> next_lsa;</div><div class="line"><a name="l07551"></a><span class="lineno"> 7551</span>&#160;</div><div class="line"><a name="l07552"></a><span class="lineno"> 7552</span>&#160;        <a class="code" href="storage__common_8h.html#a4c9bc15296fe6728cf0351726cc6ad09">LSA_COPY</a> (&amp;next_lsa, &amp;lsa);</div><div class="line"><a name="l07553"></a><span class="lineno"> 7553</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="log__impl_8h.html#aef9749d0e1fb73442a24537f0ac750e6">log_startof_nxrec</a> (thread_p, &amp;next_lsa, <span class="keyword">false</span>) == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="line"><a name="l07554"></a><span class="lineno"> 7554</span>&#160;        || (!<a class="code" href="storage__common_8h.html#aa8d8ea0049b43e3faf4c471641af5f98">LSA_EQ</a> (&amp;next_lsa, &amp;log_rec-&gt;<a class="code" href="structlog__rec__header.html#ab88354b51f9cabaaace23420eec7ac7e">forw_lsa</a>) &amp;&amp; !<a class="code" href="storage__common_8h.html#a26dd766712df5b5c4fcd158f571a75e4">LSA_ISNULL</a> (&amp;log_rec-&gt;<a class="code" href="structlog__rec__header.html#ab88354b51f9cabaaace23420eec7ac7e">forw_lsa</a>)))</div><div class="line"><a name="l07555"></a><span class="lineno"> 7555</span>&#160;          {</div><div class="line"><a name="l07556"></a><span class="lineno"> 7556</span>&#160;        fprintf (out_fp, <span class="stringliteral">&quot;\n\n&gt;&gt;&gt;&gt;&gt;****\n&quot;</span>);</div><div class="line"><a name="l07557"></a><span class="lineno"> 7557</span>&#160;        fprintf (out_fp, <span class="stringliteral">&quot;Guess next address = %lld|%d for LSA = %lld|%d\n&quot;</span>,</div><div class="line"><a name="l07558"></a><span class="lineno"> 7558</span>&#160;             <a class="code" href="storage__common_8h.html#a392873d6ffa4a8a6b2eb5f4b4fbbc97c">LSA_AS_ARGS</a> (&amp;next_lsa), <a class="code" href="storage__common_8h.html#a392873d6ffa4a8a6b2eb5f4b4fbbc97c">LSA_AS_ARGS</a> (&amp;lsa));</div><div class="line"><a name="l07559"></a><span class="lineno"> 7559</span>&#160;        fprintf (out_fp, <span class="stringliteral">&quot;&lt;&lt;&lt;&lt;&lt;****\n&quot;</span>);</div><div class="line"><a name="l07560"></a><span class="lineno"> 7560</span>&#160;          }</div><div class="line"><a name="l07561"></a><span class="lineno"> 7561</span>&#160;      }</div><div class="line"><a name="l07562"></a><span class="lineno"> 7562</span>&#160;</div><div class="line"><a name="l07563"></a><span class="lineno"> 7563</span>&#160;      <span class="comment">/* Find the next log record to dump .. after current one is dumped */</span></div><div class="line"><a name="l07564"></a><span class="lineno"> 7564</span>&#160;      <span class="keywordflow">if</span> (isforward != <span class="keyword">false</span>)</div><div class="line"><a name="l07565"></a><span class="lineno"> 7565</span>&#160;        {</div><div class="line"><a name="l07566"></a><span class="lineno"> 7566</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="storage__common_8h.html#a26dd766712df5b5c4fcd158f571a75e4">LSA_ISNULL</a> (&amp;log_rec-&gt;<a class="code" href="structlog__rec__header.html#ab88354b51f9cabaaace23420eec7ac7e">forw_lsa</a>) &amp;&amp; <a class="code" href="atldb__cubrid_8h.html#ad939da76b5d12fca40de18001582d63a">type</a> != <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a034d486f56b110bc31fba3b6db5dd980">LOG_END_OF_LOG</a>)</div><div class="line"><a name="l07567"></a><span class="lineno"> 7567</span>&#160;        {</div><div class="line"><a name="l07568"></a><span class="lineno"> 7568</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="log__impl_8h.html#aef9749d0e1fb73442a24537f0ac750e6">log_startof_nxrec</a> (thread_p, &amp;lsa, <span class="keyword">false</span>) == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l07569"></a><span class="lineno"> 7569</span>&#160;            {</div><div class="line"><a name="l07570"></a><span class="lineno"> 7570</span>&#160;              fprintf (out_fp, <span class="stringliteral">&quot;\n****\n&quot;</span>);</div><div class="line"><a name="l07571"></a><span class="lineno"> 7571</span>&#160;              fprintf (out_fp, <span class="stringliteral">&quot;log_dump: Problems finding next record. BYE\n&quot;</span>);</div><div class="line"><a name="l07572"></a><span class="lineno"> 7572</span>&#160;              fprintf (out_fp, <span class="stringliteral">&quot;\n****\n&quot;</span>);</div><div class="line"><a name="l07573"></a><span class="lineno"> 7573</span>&#160;              <span class="keywordflow">break</span>;</div><div class="line"><a name="l07574"></a><span class="lineno"> 7574</span>&#160;            }</div><div class="line"><a name="l07575"></a><span class="lineno"> 7575</span>&#160;        }</div><div class="line"><a name="l07576"></a><span class="lineno"> 7576</span>&#160;          <span class="keywordflow">else</span></div><div class="line"><a name="l07577"></a><span class="lineno"> 7577</span>&#160;        {</div><div class="line"><a name="l07578"></a><span class="lineno"> 7578</span>&#160;          <a class="code" href="storage__common_8h.html#a4c9bc15296fe6728cf0351726cc6ad09">LSA_COPY</a> (&amp;lsa, &amp;log_rec-&gt;<a class="code" href="structlog__rec__header.html#ab88354b51f9cabaaace23420eec7ac7e">forw_lsa</a>);</div><div class="line"><a name="l07579"></a><span class="lineno"> 7579</span>&#160;        }</div><div class="line"><a name="l07580"></a><span class="lineno"> 7580</span>&#160;          <span class="comment">/* </span></div><div class="line"><a name="l07581"></a><span class="lineno"> 7581</span>&#160;<span class="comment">           * If the next page is NULL_PAGEID and the current page is an archive</span></div><div class="line"><a name="l07582"></a><span class="lineno"> 7582</span>&#160;<span class="comment">           * page, this is not the end, this situation happens when an incomplete</span></div><div class="line"><a name="l07583"></a><span class="lineno"> 7583</span>&#160;<span class="comment">           * log record was archived.</span></div><div class="line"><a name="l07584"></a><span class="lineno"> 7584</span>&#160;<span class="comment">           * Note that we have to set lsa.pageid here since the log_lsa.pageid value</span></div><div class="line"><a name="l07585"></a><span class="lineno"> 7585</span>&#160;<span class="comment">           * can be changed (e.g., the log record is stored in an archive page</span></div><div class="line"><a name="l07586"></a><span class="lineno"> 7586</span>&#160;<span class="comment">           * and in an active page. Later, we try to modify it whenever is</span></div><div class="line"><a name="l07587"></a><span class="lineno"> 7587</span>&#160;<span class="comment">           * possible.</span></div><div class="line"><a name="l07588"></a><span class="lineno"> 7588</span>&#160;<span class="comment">           */</span></div><div class="line"><a name="l07589"></a><span class="lineno"> 7589</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="storage__common_8h.html#a26dd766712df5b5c4fcd158f571a75e4">LSA_ISNULL</a> (&amp;lsa) &amp;&amp; <a class="code" href="log__impl_8h.html#aa2a6e20070602d985015f39d448f8125">logpb_is_page_in_archive</a> (<a class="code" href="structlog__lsa.html">log_lsa</a>.<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a>))</div><div class="line"><a name="l07590"></a><span class="lineno"> 7590</span>&#160;        {</div><div class="line"><a name="l07591"></a><span class="lineno"> 7591</span>&#160;          lsa.<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a> = <a class="code" href="structlog__lsa.html">log_lsa</a>.<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a> + 1;</div><div class="line"><a name="l07592"></a><span class="lineno"> 7592</span>&#160;        }</div><div class="line"><a name="l07593"></a><span class="lineno"> 7593</span>&#160;        }</div><div class="line"><a name="l07594"></a><span class="lineno"> 7594</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l07595"></a><span class="lineno"> 7595</span>&#160;        {</div><div class="line"><a name="l07596"></a><span class="lineno"> 7596</span>&#160;          <a class="code" href="storage__common_8h.html#a4c9bc15296fe6728cf0351726cc6ad09">LSA_COPY</a> (&amp;lsa, &amp;log_rec-&gt;<a class="code" href="structlog__rec__header.html#af86b0fae64edb2a53b87dc354baf543c">back_lsa</a>);</div><div class="line"><a name="l07597"></a><span class="lineno"> 7597</span>&#160;        }</div><div class="line"><a name="l07598"></a><span class="lineno"> 7598</span>&#160;</div><div class="line"><a name="l07599"></a><span class="lineno"> 7599</span>&#160;      <span class="keywordflow">if</span> (desired_tranid != <a class="code" href="storage__common_8h.html#a65e269153dcbaf685a77e98b007b6a19">NULL_TRANID</a> &amp;&amp; desired_tranid != log_rec-&gt;<a class="code" href="structlog__rec__header.html#a210194ed9baf246456495d89fb411725">trid</a> &amp;&amp; log_rec-&gt;<a class="code" href="structlog__rec__header.html#aa9be1266bf7fdca13a0a789dc5ae11bb">type</a> != <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a034d486f56b110bc31fba3b6db5dd980">LOG_END_OF_LOG</a>)</div><div class="line"><a name="l07600"></a><span class="lineno"> 7600</span>&#160;        {</div><div class="line"><a name="l07601"></a><span class="lineno"> 7601</span>&#160;          <span class="comment">/* Don&#39;t dump this log record... */</span></div><div class="line"><a name="l07602"></a><span class="lineno"> 7602</span>&#160;          <span class="keywordflow">continue</span>;</div><div class="line"><a name="l07603"></a><span class="lineno"> 7603</span>&#160;        }</div><div class="line"><a name="l07604"></a><span class="lineno"> 7604</span>&#160;</div><div class="line"><a name="l07605"></a><span class="lineno"> 7605</span>&#160;      fprintf (out_fp,</div><div class="line"><a name="l07606"></a><span class="lineno"> 7606</span>&#160;           <span class="stringliteral">&quot;\nLSA = %3lld|%3d, Forw log = %3lld|%3d, Backw log = %3lld|%3d,\n&quot;</span></div><div class="line"><a name="l07607"></a><span class="lineno"> 7607</span>&#160;           <span class="stringliteral">&quot;     Trid = %3d, Prev tran logrec = %3lld|%3d\n     Type = %s&quot;</span>, (<span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span>) <a class="code" href="structlog__lsa.html">log_lsa</a>.<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a>,</div><div class="line"><a name="l07608"></a><span class="lineno"> 7608</span>&#160;           (<span class="keywordtype">int</span>) <a class="code" href="structlog__lsa.html">log_lsa</a>.<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a>, (<span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span>) log_rec-&gt;<a class="code" href="structlog__rec__header.html#ab88354b51f9cabaaace23420eec7ac7e">forw_lsa</a>.<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a>, (<span class="keywordtype">int</span>) log_rec-&gt;<a class="code" href="structlog__rec__header.html#ab88354b51f9cabaaace23420eec7ac7e">forw_lsa</a>.<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a>,</div><div class="line"><a name="l07609"></a><span class="lineno"> 7609</span>&#160;           (<span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span>) log_rec-&gt;<a class="code" href="structlog__rec__header.html#af86b0fae64edb2a53b87dc354baf543c">back_lsa</a>.<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a>, (<span class="keywordtype">int</span>) log_rec-&gt;<a class="code" href="structlog__rec__header.html#af86b0fae64edb2a53b87dc354baf543c">back_lsa</a>.<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a>, log_rec-&gt;<a class="code" href="structlog__rec__header.html#a210194ed9baf246456495d89fb411725">trid</a>,</div><div class="line"><a name="l07610"></a><span class="lineno"> 7610</span>&#160;           (<span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span>) log_rec-&gt;<a class="code" href="structlog__rec__header.html#a40f61f4c609c77826f4d5dd3482f3a38">prev_tranlsa</a>.<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a>, (<span class="keywordtype">int</span>) log_rec-&gt;<a class="code" href="structlog__rec__header.html#a40f61f4c609c77826f4d5dd3482f3a38">prev_tranlsa</a>.<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a>,</div><div class="line"><a name="l07611"></a><span class="lineno"> 7611</span>&#160;           <a class="code" href="log__manager_8c.html#a6e093782f446a5806cc9631a97eba1c3">log_to_string</a> (<a class="code" href="atldb__cubrid_8h.html#ad939da76b5d12fca40de18001582d63a">type</a>));</div><div class="line"><a name="l07612"></a><span class="lineno"> 7612</span>&#160;</div><div class="line"><a name="l07613"></a><span class="lineno"> 7613</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="storage__common_8h.html#a26dd766712df5b5c4fcd158f571a75e4">LSA_ISNULL</a> (&amp;log_rec-&gt;<a class="code" href="structlog__rec__header.html#ab88354b51f9cabaaace23420eec7ac7e">forw_lsa</a>) &amp;&amp; <a class="code" href="atldb__cubrid_8h.html#ad939da76b5d12fca40de18001582d63a">type</a> != <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a034d486f56b110bc31fba3b6db5dd980">LOG_END_OF_LOG</a>)</div><div class="line"><a name="l07614"></a><span class="lineno"> 7614</span>&#160;        {</div><div class="line"><a name="l07615"></a><span class="lineno"> 7615</span>&#160;          <span class="comment">/* Incomplete log record... quit */</span></div><div class="line"><a name="l07616"></a><span class="lineno"> 7616</span>&#160;          fprintf (out_fp, <span class="stringliteral">&quot;\n****\n&quot;</span>);</div><div class="line"><a name="l07617"></a><span class="lineno"> 7617</span>&#160;          fprintf (out_fp, <span class="stringliteral">&quot;log_dump: Incomplete log_record.. Quit\n&quot;</span>);</div><div class="line"><a name="l07618"></a><span class="lineno"> 7618</span>&#160;          fprintf (out_fp, <span class="stringliteral">&quot;\n****\n&quot;</span>);</div><div class="line"><a name="l07619"></a><span class="lineno"> 7619</span>&#160;          <span class="keywordflow">continue</span>;</div><div class="line"><a name="l07620"></a><span class="lineno"> 7620</span>&#160;        }</div><div class="line"><a name="l07621"></a><span class="lineno"> 7621</span>&#160;</div><div class="line"><a name="l07622"></a><span class="lineno"> 7622</span>&#160;      <span class="comment">/* Advance the pointer to dump the type of log record */</span></div><div class="line"><a name="l07623"></a><span class="lineno"> 7623</span>&#160;</div><div class="line"><a name="l07624"></a><span class="lineno"> 7624</span>&#160;      <a class="code" href="log__impl_8h.html#afdaa9fdf7d83212b3eec2d515e807686">LOG_READ_ADD_ALIGN</a> (thread_p, <span class="keyword">sizeof</span> (*log_rec), &amp;<a class="code" href="structlog__lsa.html">log_lsa</a>, log_pgptr);</div><div class="line"><a name="l07625"></a><span class="lineno"> 7625</span>&#160;      log_pgptr = log_dump_record (thread_p, out_fp, <a class="code" href="atldb__cubrid_8h.html#ad939da76b5d12fca40de18001582d63a">type</a>, &amp;<a class="code" href="structlog__lsa.html">log_lsa</a>, log_pgptr, log_dump_ptr);</div><div class="line"><a name="l07626"></a><span class="lineno"> 7626</span>&#160;      fflush (out_fp);</div><div class="line"><a name="l07627"></a><span class="lineno"> 7627</span>&#160;      <span class="comment">/* </span></div><div class="line"><a name="l07628"></a><span class="lineno"> 7628</span>&#160;<span class="comment">       * We can fix the lsa.pageid in the case of log_records without forward</span></div><div class="line"><a name="l07629"></a><span class="lineno"> 7629</span>&#160;<span class="comment">       * address at this moment.</span></div><div class="line"><a name="l07630"></a><span class="lineno"> 7630</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l07631"></a><span class="lineno"> 7631</span>&#160;      <span class="keywordflow">if</span> (lsa.<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a> == <a class="code" href="storage__common_8h.html#a5b0ca3ea530f289fa3f19921e5b0faf3">NULL_OFFSET</a> &amp;&amp; lsa.<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a> != <a class="code" href="storage__common_8h.html#a7ed60eef43941f46fadae895f63ee033">NULL_PAGEID</a> &amp;&amp; lsa.<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a> &lt; <a class="code" href="structlog__lsa.html">log_lsa</a>.<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a>)</div><div class="line"><a name="l07632"></a><span class="lineno"> 7632</span>&#160;        {</div><div class="line"><a name="l07633"></a><span class="lineno"> 7633</span>&#160;          lsa.<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a> = <a class="code" href="structlog__lsa.html">log_lsa</a>.<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a>;</div><div class="line"><a name="l07634"></a><span class="lineno"> 7634</span>&#160;        }</div><div class="line"><a name="l07635"></a><span class="lineno"> 7635</span>&#160;    }</div><div class="line"><a name="l07636"></a><span class="lineno"> 7636</span>&#160;    }</div><div class="line"><a name="l07637"></a><span class="lineno"> 7637</span>&#160;</div><div class="line"><a name="l07638"></a><span class="lineno"> 7638</span>&#160;  <span class="keywordflow">if</span> (log_dump_ptr)</div><div class="line"><a name="l07639"></a><span class="lineno"> 7639</span>&#160;    {</div><div class="line"><a name="l07640"></a><span class="lineno"> 7640</span>&#160;      <a class="code" href="log__compress_8c.html#a87b9003990e598725fe9ed434ce007c9">log_zip_free</a> (log_dump_ptr);</div><div class="line"><a name="l07641"></a><span class="lineno"> 7641</span>&#160;    }</div><div class="line"><a name="l07642"></a><span class="lineno"> 7642</span>&#160;</div><div class="line"><a name="l07643"></a><span class="lineno"> 7643</span>&#160;  fprintf (out_fp, <span class="stringliteral">&quot;\n FINISH DUMPING LOG_RECORDS \n&quot;</span>);</div><div class="line"><a name="l07644"></a><span class="lineno"> 7644</span>&#160;  fprintf (out_fp, <span class="stringliteral">&quot;******************************************************\n&quot;</span>);</div><div class="line"><a name="l07645"></a><span class="lineno"> 7645</span>&#160;  fflush (out_fp);</div><div class="line"><a name="l07646"></a><span class="lineno"> 7646</span>&#160;</div><div class="line"><a name="l07647"></a><span class="lineno"> 7647</span>&#160;  <span class="keywordflow">return</span>;</div><div class="line"><a name="l07648"></a><span class="lineno"> 7648</span>&#160;}</div><div class="line"><a name="l07649"></a><span class="lineno"> 7649</span>&#160;</div><div class="line"><a name="l07650"></a><span class="lineno"> 7650</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l07651"></a><span class="lineno"> 7651</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l07652"></a><span class="lineno"> 7652</span>&#160;<span class="comment"> *                     RECOVERY DURING NORMAL PROCESSING</span></div><div class="line"><a name="l07653"></a><span class="lineno"> 7653</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l07654"></a><span class="lineno"> 7654</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l07655"></a><span class="lineno"> 7655</span>&#160;</div><div class="line"><a name="l07656"></a><span class="lineno"> 7656</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l07657"></a><span class="lineno"> 7657</span>&#160;<span class="comment"> * log_rollback_record - EXECUTE AN UNDO DURING NORMAL PROCESSING</span></div><div class="line"><a name="l07658"></a><span class="lineno"> 7658</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l07659"></a><span class="lineno"> 7659</span>&#160;<span class="comment"> * return: nothing</span></div><div class="line"><a name="l07660"></a><span class="lineno"> 7660</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l07661"></a><span class="lineno"> 7661</span>&#160;<span class="comment"> *   log_lsa(in/out):Log address identifier containing the log record</span></div><div class="line"><a name="l07662"></a><span class="lineno"> 7662</span>&#160;<span class="comment"> *   log_pgptr(in/out): Pointer to page where data starts (Set as a side</span></div><div class="line"><a name="l07663"></a><span class="lineno"> 7663</span>&#160;<span class="comment"> *              effect to the page where data ends)</span></div><div class="line"><a name="l07664"></a><span class="lineno"> 7664</span>&#160;<span class="comment"> *   rcvindex(in): Index to recovery functions</span></div><div class="line"><a name="l07665"></a><span class="lineno"> 7665</span>&#160;<span class="comment"> *   rcv_vpid(in): Address of page to recover</span></div><div class="line"><a name="l07666"></a><span class="lineno"> 7666</span>&#160;<span class="comment"> *   rcv(in/out): Recovery structure for recovery function</span></div><div class="line"><a name="l07667"></a><span class="lineno"> 7667</span>&#160;<span class="comment"> *   tdes(in/out): State structure of transaction undoing data</span></div><div class="line"><a name="l07668"></a><span class="lineno"> 7668</span>&#160;<span class="comment"> *   log_unzip_ptr(in):</span></div><div class="line"><a name="l07669"></a><span class="lineno"> 7669</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l07670"></a><span class="lineno"> 7670</span>&#160;<span class="comment"> * NOTE: Execute an undo log record during normal rollbacks (i.e.,</span></div><div class="line"><a name="l07671"></a><span class="lineno"> 7671</span>&#160;<span class="comment"> *              other than restart recovery). A compensating log record for</span></div><div class="line"><a name="l07672"></a><span class="lineno"> 7672</span>&#160;<span class="comment"> *              operation page level logging is written by the current</span></div><div class="line"><a name="l07673"></a><span class="lineno"> 7673</span>&#160;<span class="comment"> *              function. For logical level logging, the undo function is</span></div><div class="line"><a name="l07674"></a><span class="lineno"> 7674</span>&#160;<span class="comment"> *              responsible to log a redo record, which is converted into a</span></div><div class="line"><a name="l07675"></a><span class="lineno"> 7675</span>&#160;<span class="comment"> *              compensating record by the log manager.</span></div><div class="line"><a name="l07676"></a><span class="lineno"> 7676</span>&#160;<span class="comment"> *              This function now attempts to repeat an rv function if it</span></div><div class="line"><a name="l07677"></a><span class="lineno"> 7677</span>&#160;<span class="comment"> *              fails in certain ways (e.g. due to deadlock).  This is to</span></div><div class="line"><a name="l07678"></a><span class="lineno"> 7678</span>&#160;<span class="comment"> *              maintain data integrity as much as possible.  The old way was</span></div><div class="line"><a name="l07679"></a><span class="lineno"> 7679</span>&#160;<span class="comment"> *              to simply ignore a failure and continue with the next record,</span></div><div class="line"><a name="l07680"></a><span class="lineno"> 7680</span>&#160;<span class="comment"> *              Obviously, skipping a record during recover could leave the</span></div><div class="line"><a name="l07681"></a><span class="lineno"> 7681</span>&#160;<span class="comment"> *              database inconsistent. All rv functions should return a</span></div><div class="line"><a name="l07682"></a><span class="lineno"> 7682</span>&#160;<span class="comment"> *              int and be coded to be called again if the work wasn&#39;t</span></div><div class="line"><a name="l07683"></a><span class="lineno"> 7683</span>&#160;<span class="comment"> *              undone the first time.</span></div><div class="line"><a name="l07684"></a><span class="lineno"> 7684</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l07685"></a><span class="lineno"> 7685</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div><div class="line"><a name="l07686"></a><span class="lineno"> 7686</span>&#160;log_rollback_record (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="structlog__lsa.html">LOG_LSA</a> * <a class="code" href="structlog__lsa.html">log_lsa</a>, <a class="code" href="structlog__page.html">LOG_PAGE</a> * log_page_p, <a class="code" href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2b">LOG_RCVINDEX</a> rcvindex,</div><div class="line"><a name="l07687"></a><span class="lineno"> 7687</span>&#160;             <a class="code" href="structvpid.html">VPID</a> * rcv_vpid, <a class="code" href="structlog__rcv.html">LOG_RCV</a> * rcv, <a class="code" href="structlog__tdes.html">LOG_TDES</a> * tdes, <a class="code" href="structlog__zip.html">LOG_ZIP</a> * log_unzip_ptr)</div><div class="line"><a name="l07688"></a><span class="lineno"> 7688</span>&#160;{</div><div class="line"><a name="l07689"></a><span class="lineno"> 7689</span>&#160;  <span class="keywordtype">char</span> *<a class="code" href="structarea.html">area</a> = <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l07690"></a><span class="lineno"> 7690</span>&#160;  <a class="code" href="log__comm_8h.html#a3c0be9b9f104459ab90ee18af95c4b3e">TRAN_STATE</a> save_state;    <span class="comment">/* The current state of the transaction. Must be returned to this state */</span></div><div class="line"><a name="l07691"></a><span class="lineno"> 7691</span>&#160;  <span class="keywordtype">int</span> rv_err;</div><div class="line"><a name="l07692"></a><span class="lineno"> 7692</span>&#160;  <span class="keywordtype">bool</span> is_zipped = <span class="keyword">false</span>;</div><div class="line"><a name="l07693"></a><span class="lineno"> 7693</span>&#160;</div><div class="line"><a name="l07694"></a><span class="lineno"> 7694</span>&#160;  <span class="comment">/* </span></div><div class="line"><a name="l07695"></a><span class="lineno"> 7695</span>&#160;<span class="comment">   * Fetch the page for physical log records. If the page does not exist</span></div><div class="line"><a name="l07696"></a><span class="lineno"> 7696</span>&#160;<span class="comment">   * anymore or there are problems fetching the page, continue anyhow, so that</span></div><div class="line"><a name="l07697"></a><span class="lineno"> 7697</span>&#160;<span class="comment">   * compensating records are logged.</span></div><div class="line"><a name="l07698"></a><span class="lineno"> 7698</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l07699"></a><span class="lineno"> 7699</span>&#160;</div><div class="line"><a name="l07700"></a><span class="lineno"> 7700</span>&#160;<span class="preprocessor">#if defined(CUBRID_DEBUG)</span></div><div class="line"><a name="l07701"></a><span class="lineno"> 7701</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="recovery_8c.html#ad2eee9d1e5914fa34d3a7868bf2549f4">RV_fun</a>[rcvindex].undofun == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l07702"></a><span class="lineno"> 7702</span>&#160;    {</div><div class="line"><a name="l07703"></a><span class="lineno"> 7703</span>&#160;      <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (<span class="keyword">false</span>);</div><div class="line"><a name="l07704"></a><span class="lineno"> 7704</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l07705"></a><span class="lineno"> 7705</span>&#160;    }</div><div class="line"><a name="l07706"></a><span class="lineno"> 7706</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* CUBRID_DEBUG */</span><span class="preprocessor"></span></div><div class="line"><a name="l07707"></a><span class="lineno"> 7707</span>&#160;</div><div class="line"><a name="l07708"></a><span class="lineno"> 7708</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="recovery_8h.html#a6d691036d814022c71635238f2e411cb">RCV_IS_LOGICAL_LOG</a> (rcv_vpid, rcvindex))</div><div class="line"><a name="l07709"></a><span class="lineno"> 7709</span>&#160;    {</div><div class="line"><a name="l07710"></a><span class="lineno"> 7710</span>&#160;      rcv-&gt;<a class="code" href="structlog__rcv.html#a04db9f252907cff6ca339534e8c4f642">pgptr</a> = <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l07711"></a><span class="lineno"> 7711</span>&#160;    }</div><div class="line"><a name="l07712"></a><span class="lineno"> 7712</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l07713"></a><span class="lineno"> 7713</span>&#160;    {</div><div class="line"><a name="l07714"></a><span class="lineno"> 7714</span>&#160;      rcv-&gt;<a class="code" href="structlog__rcv.html#a04db9f252907cff6ca339534e8c4f642">pgptr</a> = <a class="code" href="page__buffer_8h.html#aa93d50649e448bef4b4bd8dc2c6428f7">pgbuf_fix</a> (thread_p, rcv_vpid, <a class="code" href="page__buffer_8h.html#aead1e6e920c3a36e36e755709754b381aa61503371245884e97d94da1460491c4">OLD_PAGE</a>, <a class="code" href="page__buffer_8h.html#a4c8498d851d45af7bd1aa005f03c71adabbd389e885455638c44f6bea1524ae65">PGBUF_LATCH_WRITE</a>, <a class="code" href="page__buffer_8h.html#aafea7625b165348a0cf4715f54301603a4bffd61081f056fbc5a197836b0d82d2">PGBUF_UNCONDITIONAL_LATCH</a>);</div><div class="line"><a name="l07715"></a><span class="lineno"> 7715</span>&#160;      <span class="keywordflow">if</span> (rcv-&gt;<a class="code" href="structlog__rcv.html#a04db9f252907cff6ca339534e8c4f642">pgptr</a> == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l07716"></a><span class="lineno"> 7716</span>&#160;    {</div><div class="line"><a name="l07717"></a><span class="lineno"> 7717</span>&#160;      <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (<span class="keyword">false</span>);</div><div class="line"><a name="l07718"></a><span class="lineno"> 7718</span>&#160;    }</div><div class="line"><a name="l07719"></a><span class="lineno"> 7719</span>&#160;    }</div><div class="line"><a name="l07720"></a><span class="lineno"> 7720</span>&#160;</div><div class="line"><a name="l07721"></a><span class="lineno"> 7721</span>&#160;  <span class="comment">/* GET BEFORE DATA */</span></div><div class="line"><a name="l07722"></a><span class="lineno"> 7722</span>&#160;</div><div class="line"><a name="l07723"></a><span class="lineno"> 7723</span>&#160;  <span class="comment">/* </span></div><div class="line"><a name="l07724"></a><span class="lineno"> 7724</span>&#160;<span class="comment">   * If data is contained in only one buffer, pass pointer directly.</span></div><div class="line"><a name="l07725"></a><span class="lineno"> 7725</span>&#160;<span class="comment">   * Otherwise, allocate a contiguous area, copy the data and pass this area.</span></div><div class="line"><a name="l07726"></a><span class="lineno"> 7726</span>&#160;<span class="comment">   * At the end deallocate the area.</span></div><div class="line"><a name="l07727"></a><span class="lineno"> 7727</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l07728"></a><span class="lineno"> 7728</span>&#160;</div><div class="line"><a name="l07729"></a><span class="lineno"> 7729</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="log__compress_8h.html#acc57c2f6ae6f861d965ca95a4085cdf1">ZIP_CHECK</a> (rcv-&gt;<a class="code" href="structlog__rcv.html#aa86dfb9bbc9edce109df26aacf699915">length</a>))</div><div class="line"><a name="l07730"></a><span class="lineno"> 7730</span>&#160;    {               <span class="comment">/* check compress data */</span></div><div class="line"><a name="l07731"></a><span class="lineno"> 7731</span>&#160;      rcv-&gt;<a class="code" href="structlog__rcv.html#aa86dfb9bbc9edce109df26aacf699915">length</a> = (<a class="code" href="mprec_8c.html#a61569f2965b7a369eb10b6d75d410d11">int</a>) <a class="code" href="log__compress_8h.html#ac32e36fd25b171236ebb38a5be94d00c">GET_ZIP_LEN</a> (rcv-&gt;<a class="code" href="structlog__rcv.html#aa86dfb9bbc9edce109df26aacf699915">length</a>);    <span class="comment">/* MSB set 0 */</span></div><div class="line"><a name="l07732"></a><span class="lineno"> 7732</span>&#160;      is_zipped = <span class="keyword">true</span>;</div><div class="line"><a name="l07733"></a><span class="lineno"> 7733</span>&#160;    }</div><div class="line"><a name="l07734"></a><span class="lineno"> 7734</span>&#160;</div><div class="line"><a name="l07735"></a><span class="lineno"> 7735</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="structlog__lsa.html">log_lsa</a>-&gt;<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a> + rcv-&gt;<a class="code" href="structlog__rcv.html#aa86dfb9bbc9edce109df26aacf699915">length</a> &lt; (<span class="keywordtype">int</span>) <a class="code" href="log__impl_8h.html#a7790a20af76ed5282450723f2e09c4e2">LOGAREA_SIZE</a>)</div><div class="line"><a name="l07736"></a><span class="lineno"> 7736</span>&#160;    {</div><div class="line"><a name="l07737"></a><span class="lineno"> 7737</span>&#160;      rcv-&gt;<a class="code" href="structlog__rcv.html#afc672de81dd88914d00281fada1acc13">data</a> = (<span class="keywordtype">char</span> *) log_page_p-&gt;<a class="code" href="structlog__page.html#a9b51b4623cdb8d1686f6f8fb64bc9ee2">area</a> + <a class="code" href="structlog__lsa.html">log_lsa</a>-&gt;<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a>;</div><div class="line"><a name="l07738"></a><span class="lineno"> 7738</span>&#160;      <a class="code" href="structlog__lsa.html">log_lsa</a>-&gt;<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a> += rcv-&gt;<a class="code" href="structlog__rcv.html#aa86dfb9bbc9edce109df26aacf699915">length</a>;</div><div class="line"><a name="l07739"></a><span class="lineno"> 7739</span>&#160;    }</div><div class="line"><a name="l07740"></a><span class="lineno"> 7740</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l07741"></a><span class="lineno"> 7741</span>&#160;    {</div><div class="line"><a name="l07742"></a><span class="lineno"> 7742</span>&#160;      <span class="comment">/* Need to copy the data into a contiguous area */</span></div><div class="line"><a name="l07743"></a><span class="lineno"> 7743</span>&#160;      <a class="code" href="structarea.html">area</a> = (<span class="keywordtype">char</span> *) <a class="code" href="leak__detector_8h.html#a99aa8fd9f4831e1b0fa9e1cdcde3e249">malloc</a> (rcv-&gt;<a class="code" href="structlog__rcv.html#aa86dfb9bbc9edce109df26aacf699915">length</a>);</div><div class="line"><a name="l07744"></a><span class="lineno"> 7744</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="structarea.html">area</a> == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l07745"></a><span class="lineno"> 7745</span>&#160;    {</div><div class="line"><a name="l07746"></a><span class="lineno"> 7746</span>&#160;      <a class="code" href="log__impl_8h.html#a8e111eafc27b6e1383fbd0ee812b1167">logpb_fatal_error</a> (thread_p, <span class="keyword">true</span>, <a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <span class="stringliteral">&quot;log_rollback_record&quot;</span>);</div><div class="line"><a name="l07747"></a><span class="lineno"> 7747</span>&#160;      <span class="keywordflow">if</span> (rcv-&gt;<a class="code" href="structlog__rcv.html#a04db9f252907cff6ca339534e8c4f642">pgptr</a> != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l07748"></a><span class="lineno"> 7748</span>&#160;        {</div><div class="line"><a name="l07749"></a><span class="lineno"> 7749</span>&#160;          <a class="code" href="page__buffer_8h.html#a3bfa0f717b33e17651fff6daf57637ce">pgbuf_unfix</a> (thread_p, rcv-&gt;<a class="code" href="structlog__rcv.html#a04db9f252907cff6ca339534e8c4f642">pgptr</a>);</div><div class="line"><a name="l07750"></a><span class="lineno"> 7750</span>&#160;        }</div><div class="line"><a name="l07751"></a><span class="lineno"> 7751</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l07752"></a><span class="lineno"> 7752</span>&#160;    }</div><div class="line"><a name="l07753"></a><span class="lineno"> 7753</span>&#160;      <span class="comment">/* Copy the data */</span></div><div class="line"><a name="l07754"></a><span class="lineno"> 7754</span>&#160;      <a class="code" href="log__impl_8h.html#a390f2d36dcfc756ef528e21b94f7525c">logpb_copy_from_log</a> (thread_p, <a class="code" href="structarea.html">area</a>, rcv-&gt;<a class="code" href="structlog__rcv.html#aa86dfb9bbc9edce109df26aacf699915">length</a>, <a class="code" href="structlog__lsa.html">log_lsa</a>, log_page_p);</div><div class="line"><a name="l07755"></a><span class="lineno"> 7755</span>&#160;      rcv-&gt;<a class="code" href="structlog__rcv.html#afc672de81dd88914d00281fada1acc13">data</a> = <a class="code" href="structarea.html">area</a>;</div><div class="line"><a name="l07756"></a><span class="lineno"> 7756</span>&#160;    }</div><div class="line"><a name="l07757"></a><span class="lineno"> 7757</span>&#160;</div><div class="line"><a name="l07758"></a><span class="lineno"> 7758</span>&#160;  <span class="keywordflow">if</span> (is_zipped)</div><div class="line"><a name="l07759"></a><span class="lineno"> 7759</span>&#160;    {</div><div class="line"><a name="l07760"></a><span class="lineno"> 7760</span>&#160;      <span class="comment">/* Data UnZip */</span></div><div class="line"><a name="l07761"></a><span class="lineno"> 7761</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="log__compress_8c.html#a239701bd8e957bb4f8f9db1bfcf370a1">log_unzip</a> (log_unzip_ptr, rcv-&gt;<a class="code" href="structlog__rcv.html#aa86dfb9bbc9edce109df26aacf699915">length</a>, (<span class="keywordtype">char</span> *) rcv-&gt;<a class="code" href="structlog__rcv.html#afc672de81dd88914d00281fada1acc13">data</a>))</div><div class="line"><a name="l07762"></a><span class="lineno"> 7762</span>&#160;    {</div><div class="line"><a name="l07763"></a><span class="lineno"> 7763</span>&#160;      rcv-&gt;<a class="code" href="structlog__rcv.html#aa86dfb9bbc9edce109df26aacf699915">length</a> = (<a class="code" href="mprec_8c.html#a61569f2965b7a369eb10b6d75d410d11">int</a>) log_unzip_ptr-&gt;<a class="code" href="structlog__zip.html#a3e723c649a96cb0c0af4516d40fc4aed">data_length</a>;</div><div class="line"><a name="l07764"></a><span class="lineno"> 7764</span>&#160;      rcv-&gt;<a class="code" href="structlog__rcv.html#afc672de81dd88914d00281fada1acc13">data</a> = (<span class="keywordtype">char</span> *) log_unzip_ptr-&gt;<a class="code" href="structlog__zip.html#ac57b9be7fa6f4be036cf9e6db8565195">log_data</a>;</div><div class="line"><a name="l07765"></a><span class="lineno"> 7765</span>&#160;    }</div><div class="line"><a name="l07766"></a><span class="lineno"> 7766</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l07767"></a><span class="lineno"> 7767</span>&#160;    {</div><div class="line"><a name="l07768"></a><span class="lineno"> 7768</span>&#160;      <a class="code" href="log__impl_8h.html#a8e111eafc27b6e1383fbd0ee812b1167">logpb_fatal_error</a> (thread_p, <span class="keyword">true</span>, <a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <span class="stringliteral">&quot;log_rollback_record&quot;</span>);</div><div class="line"><a name="l07769"></a><span class="lineno"> 7769</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="structarea.html">area</a> != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l07770"></a><span class="lineno"> 7770</span>&#160;        {</div><div class="line"><a name="l07771"></a><span class="lineno"> 7771</span>&#160;          <a class="code" href="memory__alloc_8h.html#a794b5a73adc277837a0c4d12da4af5af">free_and_init</a> (<a class="code" href="structarea.html">area</a>);</div><div class="line"><a name="l07772"></a><span class="lineno"> 7772</span>&#160;        }</div><div class="line"><a name="l07773"></a><span class="lineno"> 7773</span>&#160;      <span class="keywordflow">if</span> (rcv-&gt;<a class="code" href="structlog__rcv.html#a04db9f252907cff6ca339534e8c4f642">pgptr</a> != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l07774"></a><span class="lineno"> 7774</span>&#160;        {</div><div class="line"><a name="l07775"></a><span class="lineno"> 7775</span>&#160;          <a class="code" href="page__buffer_8h.html#a3bfa0f717b33e17651fff6daf57637ce">pgbuf_unfix</a> (thread_p, rcv-&gt;<a class="code" href="structlog__rcv.html#a04db9f252907cff6ca339534e8c4f642">pgptr</a>);</div><div class="line"><a name="l07776"></a><span class="lineno"> 7776</span>&#160;        }</div><div class="line"><a name="l07777"></a><span class="lineno"> 7777</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l07778"></a><span class="lineno"> 7778</span>&#160;    }</div><div class="line"><a name="l07779"></a><span class="lineno"> 7779</span>&#160;    }</div><div class="line"><a name="l07780"></a><span class="lineno"> 7780</span>&#160;</div><div class="line"><a name="l07781"></a><span class="lineno"> 7781</span>&#160;  <span class="comment">/* Now call the UNDO recovery function */</span></div><div class="line"><a name="l07782"></a><span class="lineno"> 7782</span>&#160;  <span class="keywordflow">if</span> (rcv-&gt;<a class="code" href="structlog__rcv.html#a04db9f252907cff6ca339534e8c4f642">pgptr</a> != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || <a class="code" href="recovery_8h.html#a6d691036d814022c71635238f2e411cb">RCV_IS_LOGICAL_LOG</a> (rcv_vpid, rcvindex))</div><div class="line"><a name="l07783"></a><span class="lineno"> 7783</span>&#160;    {</div><div class="line"><a name="l07784"></a><span class="lineno"> 7784</span>&#160;      <span class="comment">/* </span></div><div class="line"><a name="l07785"></a><span class="lineno"> 7785</span>&#160;<span class="comment">       * Write a compensating log record for operation page level logging.</span></div><div class="line"><a name="l07786"></a><span class="lineno"> 7786</span>&#160;<span class="comment">       * For logical level logging, the recovery undo function must log an</span></div><div class="line"><a name="l07787"></a><span class="lineno"> 7787</span>&#160;<span class="comment">       * redo/CLR log to describe the undo. This in turn will be translated</span></div><div class="line"><a name="l07788"></a><span class="lineno"> 7788</span>&#160;<span class="comment">       * to a compensating record.</span></div><div class="line"><a name="l07789"></a><span class="lineno"> 7789</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l07790"></a><span class="lineno"> 7790</span>&#160;      <span class="keywordflow">if</span> (rcvindex == <a class="code" href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2ba44bda7714c3d5eeb33154a5bbd45b86e">RVBT_MVCC_INCREMENTS_UPD</a>)</div><div class="line"><a name="l07791"></a><span class="lineno"> 7791</span>&#160;    {</div><div class="line"><a name="l07792"></a><span class="lineno"> 7792</span>&#160;      <span class="comment">/* this is a special case. we need to undo changes to transaction local stats. this only has an impact on</span></div><div class="line"><a name="l07793"></a><span class="lineno"> 7793</span>&#160;<span class="comment">       * this transaction during runtime, and recovery has no interest, so we don&#39;t have to add a compensate log</span></div><div class="line"><a name="l07794"></a><span class="lineno"> 7794</span>&#160;<span class="comment">       * record. */</span></div><div class="line"><a name="l07795"></a><span class="lineno"> 7795</span>&#160;      rv_err = (*<a class="code" href="recovery_8c.html#ad2eee9d1e5914fa34d3a7868bf2549f4">RV_fun</a>[rcvindex].<a class="code" href="structrvfun.html#af48854e9fe4be091abcca9982252bde7">undofun</a>) (thread_p, rcv);</div><div class="line"><a name="l07796"></a><span class="lineno"> 7796</span>&#160;      <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (rv_err == <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>);</div><div class="line"><a name="l07797"></a><span class="lineno"> 7797</span>&#160;    }</div><div class="line"><a name="l07798"></a><span class="lineno"> 7798</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (rcvindex == <a class="code" href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2baba87dd0eef27f1deff3c187b554068f2">RVBT_MVCC_NOTIFY_VACUUM</a> || rcvindex == <a class="code" href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2baca88567f8ffeb5458461f87ec8a3b6b5">RVES_NOTIFY_VACUUM</a>)</div><div class="line"><a name="l07799"></a><span class="lineno"> 7799</span>&#160;    {</div><div class="line"><a name="l07800"></a><span class="lineno"> 7800</span>&#160;      <span class="comment">/* do nothing */</span></div><div class="line"><a name="l07801"></a><span class="lineno"> 7801</span>&#160;    }</div><div class="line"><a name="l07802"></a><span class="lineno"> 7802</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (rcvindex == <a class="code" href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2ba74979a9555a5d5f1ae0e879ccf00e184">RVBT_LOG_GLOBAL_UNIQUE_STATS_COMMIT</a>)</div><div class="line"><a name="l07803"></a><span class="lineno"> 7803</span>&#160;    {</div><div class="line"><a name="l07804"></a><span class="lineno"> 7804</span>&#160;      <span class="comment">/* impossible. we cannot rollback anymore. */</span></div><div class="line"><a name="l07805"></a><span class="lineno"> 7805</span>&#160;      <a class="code" href="error__manager_8h.html#a34b88b0e828e26dd5cf930a0b1dd57a7">assert_release</a> (<span class="keyword">false</span>);</div><div class="line"><a name="l07806"></a><span class="lineno"> 7806</span>&#160;      rv_err = <a class="code" href="error__code_8h.html#a51778caf175b7d6bfe9e8977d9a0032e">ER_FAILED</a>;</div><div class="line"><a name="l07807"></a><span class="lineno"> 7807</span>&#160;    }</div><div class="line"><a name="l07808"></a><span class="lineno"> 7808</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="recovery_8h.html#a9447936a4f3c944165a741c6c7d25200">RCV_IS_LOGICAL_COMPENSATE_MANUAL</a> (rcvindex))</div><div class="line"><a name="l07809"></a><span class="lineno"> 7809</span>&#160;    {</div><div class="line"><a name="l07810"></a><span class="lineno"> 7810</span>&#160;      <span class="comment">/* B-tree logical logs will add a regular compensate in the modified pages. They do not require a logical</span></div><div class="line"><a name="l07811"></a><span class="lineno"> 7811</span>&#160;<span class="comment">       * compensation since the &quot;undone&quot; page can be accessed and logged. Only no-page logical operations require</span></div><div class="line"><a name="l07812"></a><span class="lineno"> 7812</span>&#160;<span class="comment">       * logical compensation. */</span></div><div class="line"><a name="l07813"></a><span class="lineno"> 7813</span>&#160;      <span class="comment">/* Invoke Undo recovery function */</span></div><div class="line"><a name="l07814"></a><span class="lineno"> 7814</span>&#160;      <a class="code" href="storage__common_8h.html#a4c9bc15296fe6728cf0351726cc6ad09">LSA_COPY</a> (&amp;rcv-&gt;<a class="code" href="structlog__rcv.html#a8400bbfec907d992bc47a641dbd2eeb2">reference_lsa</a>, &amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a4e3335b7f0e4ca7f858416446ae8f782">undo_nxlsa</a>);</div><div class="line"><a name="l07815"></a><span class="lineno"> 7815</span>&#160;      rv_err = log_undo_rec_restartable (thread_p, rcvindex, rcv);</div><div class="line"><a name="l07816"></a><span class="lineno"> 7816</span>&#160;      <span class="keywordflow">if</span> (rv_err != <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>)</div><div class="line"><a name="l07817"></a><span class="lineno"> 7817</span>&#160;        {</div><div class="line"><a name="l07818"></a><span class="lineno"> 7818</span>&#160;          <a class="code" href="error__manager_8h.html#a075eb8873354909bbe8edafa0f18f58c">er_log_debug</a> (<a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>,</div><div class="line"><a name="l07819"></a><span class="lineno"> 7819</span>&#160;                <span class="stringliteral">&quot;log_rollback_record: SYSTEM ERROR... Transaction %d, &quot;</span></div><div class="line"><a name="l07820"></a><span class="lineno"> 7820</span>&#160;                <span class="stringliteral">&quot;Log record %lld|%d, rcvindex = %s, was not undone due to error (%d)\n&quot;</span>,</div><div class="line"><a name="l07821"></a><span class="lineno"> 7821</span>&#160;                tdes-&gt;<a class="code" href="structlog__tdes.html#ae9437cf94e11e2307172ef5fc7b32aa9">tran_index</a>, (<span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span>) <a class="code" href="structlog__lsa.html">log_lsa</a>-&gt;<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a>, <a class="code" href="structlog__lsa.html">log_lsa</a>-&gt;<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a>,</div><div class="line"><a name="l07822"></a><span class="lineno"> 7822</span>&#160;                <a class="code" href="recovery_8c.html#a9489c3632ab4b52fc008b589ce45cbdc">rv_rcvindex_string</a> (rcvindex), rv_err);</div><div class="line"><a name="l07823"></a><span class="lineno"> 7823</span>&#160;          <a class="code" href="error__manager_8c.html#afdaf87ce30f2f557802a185ab85b6599">er_set</a> (<a class="code" href="error__manager_8h.html#a5d0d456c474e11fc70779873a30a7432a07ad8f9fda27124d297c94b7d3ea44e8">ER_ERROR_SEVERITY</a>, <a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <a class="code" href="error__code_8h.html#afb34238455b940cb2bacb3ddd899bb03">ER_LOG_MAYNEED_MEDIA_RECOVERY</a>, 1,</div><div class="line"><a name="l07824"></a><span class="lineno"> 7824</span>&#160;              <a class="code" href="file__io_8c.html#a251cdd92358703f9c482c5d84f8d7dc0">fileio_get_volume_label</a> (rcv_vpid-&gt;<a class="code" href="structvpid.html#a54e222d402e758d24ae0df524a9e677d">volid</a>, <a class="code" href="regcomp_8c.html#aa25dac8b80db8b8f03732eeb9ca23934">PEEK</a>));</div><div class="line"><a name="l07825"></a><span class="lineno"> 7825</span>&#160;          <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (<span class="keyword">false</span>);</div><div class="line"><a name="l07826"></a><span class="lineno"> 7826</span>&#160;        }</div><div class="line"><a name="l07827"></a><span class="lineno"> 7827</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="recovery_8h.html#af3c089b92ed018ab83b9aec566a04d88">RCV_IS_BTREE_LOGICAL_LOG</a> (rcvindex) &amp;&amp; <a class="code" href="system__parameter_8c.html#a678756564699cbc93bd758cf6f99a042">prm_get_bool_value</a> (<a class="code" href="system__parameter_8h.html#a23aaf6bca406b9b428f43ad1b6b2b3e0ad056c84e225c203537202fa2001c1c09">PRM_ID_LOG_BTREE_OPS</a>))</div><div class="line"><a name="l07828"></a><span class="lineno"> 7828</span>&#160;        {</div><div class="line"><a name="l07829"></a><span class="lineno"> 7829</span>&#160;          <a class="code" href="error__manager_8c.html#a4b0a47356bddaa48a4c83984b5ac9fbe">_er_log_debug</a> (<a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>,</div><div class="line"><a name="l07830"></a><span class="lineno"> 7830</span>&#160;                 <span class="stringliteral">&quot;BTREE_ROLLBACK: Successfully executed undo/compensate for log entry before &quot;</span></div><div class="line"><a name="l07831"></a><span class="lineno"> 7831</span>&#160;                 <span class="stringliteral">&quot;lsa=%lld|%d, undo_nxlsa=%lld|%d. Transaction=%d, rcvindex=%d.\n&quot;</span>,</div><div class="line"><a name="l07832"></a><span class="lineno"> 7832</span>&#160;                 (<span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span>) <a class="code" href="structlog__lsa.html">log_lsa</a>-&gt;<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a>, (<span class="keywordtype">int</span>) <a class="code" href="structlog__lsa.html">log_lsa</a>-&gt;<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a>,</div><div class="line"><a name="l07833"></a><span class="lineno"> 7833</span>&#160;                 (<span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span>) tdes-&gt;<a class="code" href="structlog__tdes.html#a4e3335b7f0e4ca7f858416446ae8f782">undo_nxlsa</a>.<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a>, (<span class="keywordtype">int</span>) tdes-&gt;<a class="code" href="structlog__tdes.html#a4e3335b7f0e4ca7f858416446ae8f782">undo_nxlsa</a>.<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a>, tdes-&gt;<a class="code" href="structlog__tdes.html#ae9437cf94e11e2307172ef5fc7b32aa9">tran_index</a>,</div><div class="line"><a name="l07834"></a><span class="lineno"> 7834</span>&#160;                 rcvindex);</div><div class="line"><a name="l07835"></a><span class="lineno"> 7835</span>&#160;        }</div><div class="line"><a name="l07836"></a><span class="lineno"> 7836</span>&#160;    }</div><div class="line"><a name="l07837"></a><span class="lineno"> 7837</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code" href="recovery_8h.html#a6d691036d814022c71635238f2e411cb">RCV_IS_LOGICAL_LOG</a> (rcv_vpid, rcvindex))</div><div class="line"><a name="l07838"></a><span class="lineno"> 7838</span>&#160;    {</div><div class="line"><a name="l07839"></a><span class="lineno"> 7839</span>&#160;      <a class="code" href="log__manager_8c.html#a1b9d7ef3a0e157511a172c7dc6439ca5">log_append_compensate</a> (thread_p, rcvindex, rcv_vpid, rcv-&gt;<a class="code" href="structlog__rcv.html#a4acc4ed244fcaa09adea314ee4f7b861">offset</a>, rcv-&gt;<a class="code" href="structlog__rcv.html#a04db9f252907cff6ca339534e8c4f642">pgptr</a>, rcv-&gt;<a class="code" href="structlog__rcv.html#aa86dfb9bbc9edce109df26aacf699915">length</a>, rcv-&gt;<a class="code" href="structlog__rcv.html#afc672de81dd88914d00281fada1acc13">data</a>, tdes);</div><div class="line"><a name="l07840"></a><span class="lineno"> 7840</span>&#160;      <span class="comment">/* Invoke Undo recovery function */</span></div><div class="line"><a name="l07841"></a><span class="lineno"> 7841</span>&#160;      rv_err = log_undo_rec_restartable (thread_p, rcvindex, rcv);</div><div class="line"><a name="l07842"></a><span class="lineno"> 7842</span>&#160;      <span class="keywordflow">if</span> (rv_err != <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>)</div><div class="line"><a name="l07843"></a><span class="lineno"> 7843</span>&#160;        {</div><div class="line"><a name="l07844"></a><span class="lineno"> 7844</span>&#160;          <a class="code" href="error__manager_8h.html#a075eb8873354909bbe8edafa0f18f58c">er_log_debug</a> (<a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>,</div><div class="line"><a name="l07845"></a><span class="lineno"> 7845</span>&#160;                <span class="stringliteral">&quot;log_rollback_record: SYSTEM ERROR... Transaction %d, &quot;</span></div><div class="line"><a name="l07846"></a><span class="lineno"> 7846</span>&#160;                <span class="stringliteral">&quot;Log record %lld|%d, rcvindex = %s, was not undone due to error (%d)\n&quot;</span>,</div><div class="line"><a name="l07847"></a><span class="lineno"> 7847</span>&#160;                tdes-&gt;<a class="code" href="structlog__tdes.html#ae9437cf94e11e2307172ef5fc7b32aa9">tran_index</a>, (<span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span>) <a class="code" href="structlog__lsa.html">log_lsa</a>-&gt;<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a>, <a class="code" href="structlog__lsa.html">log_lsa</a>-&gt;<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a>,</div><div class="line"><a name="l07848"></a><span class="lineno"> 7848</span>&#160;                <a class="code" href="recovery_8c.html#a9489c3632ab4b52fc008b589ce45cbdc">rv_rcvindex_string</a> (rcvindex), rv_err);</div><div class="line"><a name="l07849"></a><span class="lineno"> 7849</span>&#160;          <a class="code" href="error__manager_8c.html#afdaf87ce30f2f557802a185ab85b6599">er_set</a> (<a class="code" href="error__manager_8h.html#a5d0d456c474e11fc70779873a30a7432a07ad8f9fda27124d297c94b7d3ea44e8">ER_ERROR_SEVERITY</a>, <a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <a class="code" href="error__code_8h.html#afb34238455b940cb2bacb3ddd899bb03">ER_LOG_MAYNEED_MEDIA_RECOVERY</a>, 1,</div><div class="line"><a name="l07850"></a><span class="lineno"> 7850</span>&#160;              <a class="code" href="file__io_8c.html#a251cdd92358703f9c482c5d84f8d7dc0">fileio_get_volume_label</a> (rcv_vpid-&gt;<a class="code" href="structvpid.html#a54e222d402e758d24ae0df524a9e677d">volid</a>, <a class="code" href="regcomp_8c.html#aa25dac8b80db8b8f03732eeb9ca23934">PEEK</a>));</div><div class="line"><a name="l07851"></a><span class="lineno"> 7851</span>&#160;          <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (<span class="keyword">false</span>);</div><div class="line"><a name="l07852"></a><span class="lineno"> 7852</span>&#160;        }</div><div class="line"><a name="l07853"></a><span class="lineno"> 7853</span>&#160;    }</div><div class="line"><a name="l07854"></a><span class="lineno"> 7854</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l07855"></a><span class="lineno"> 7855</span>&#160;    {</div><div class="line"><a name="l07856"></a><span class="lineno"> 7856</span>&#160;      <span class="comment">/* Logical logging? This is a logical undo. For now, we also use a logical compensation, meaning that we</span></div><div class="line"><a name="l07857"></a><span class="lineno"> 7857</span>&#160;<span class="comment">       * open a system operation that is committed &amp; compensate at the same time.</span></div><div class="line"><a name="l07858"></a><span class="lineno"> 7858</span>&#160;<span class="comment">       * However, there might be cases when compensation is not necessarily logical. If the compensation can be</span></div><div class="line"><a name="l07859"></a><span class="lineno"> 7859</span>&#160;<span class="comment">       * made in a single log record and can be attached to a page, the system operation becomes useless. Take the</span></div><div class="line"><a name="l07860"></a><span class="lineno"> 7860</span>&#160;<span class="comment">       * example of some b-tree cases for compensations. There might be other cases too.</span></div><div class="line"><a name="l07861"></a><span class="lineno"> 7861</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l07862"></a><span class="lineno"> 7862</span>&#160;      save_state = tdes-&gt;<a class="code" href="structlog__tdes.html#ad924146690490b840ef5c3f65c3a5a6c">state</a>;</div><div class="line"><a name="l07863"></a><span class="lineno"> 7863</span>&#160;</div><div class="line"><a name="l07864"></a><span class="lineno"> 7864</span>&#160;      <a class="code" href="storage__common_8h.html#a4c9bc15296fe6728cf0351726cc6ad09">LSA_COPY</a> (&amp;rcv-&gt;<a class="code" href="structlog__rcv.html#a8400bbfec907d992bc47a641dbd2eeb2">reference_lsa</a>, &amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a4e3335b7f0e4ca7f858416446ae8f782">undo_nxlsa</a>);</div><div class="line"><a name="l07865"></a><span class="lineno"> 7865</span>&#160;</div><div class="line"><a name="l07866"></a><span class="lineno"> 7866</span>&#160;      <a class="code" href="log__manager_8c.html#acbc3a63215e8924ed23841fb2321cd78">log_sysop_start</a> (thread_p);</div><div class="line"><a name="l07867"></a><span class="lineno"> 7867</span>&#160;</div><div class="line"><a name="l07868"></a><span class="lineno"> 7868</span>&#160;<span class="preprocessor">#if defined(CUBRID_DEBUG)</span></div><div class="line"><a name="l07869"></a><span class="lineno"> 7869</span>&#160;      {</div><div class="line"><a name="l07870"></a><span class="lineno"> 7870</span>&#160;        <a class="code" href="structlog__lsa.html">LOG_LSA</a> check_tail_lsa;</div><div class="line"><a name="l07871"></a><span class="lineno"> 7871</span>&#160;</div><div class="line"><a name="l07872"></a><span class="lineno"> 7872</span>&#160;        <a class="code" href="storage__common_8h.html#a4c9bc15296fe6728cf0351726cc6ad09">LSA_COPY</a> (&amp;check_tail_lsa, &amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a5b128a08476a5b499cf82e3163e6d62b">tail_lsa</a>);</div><div class="line"><a name="l07873"></a><span class="lineno"> 7873</span>&#160;        <span class="comment">/* </span></div><div class="line"><a name="l07874"></a><span class="lineno"> 7874</span>&#160;<span class="comment">         * Note that tail_lsa is changed by the following function</span></div><div class="line"><a name="l07875"></a><span class="lineno"> 7875</span>&#160;<span class="comment">         */</span></div><div class="line"><a name="l07876"></a><span class="lineno"> 7876</span>&#160;        <span class="comment">/* Invoke Undo recovery function */</span></div><div class="line"><a name="l07877"></a><span class="lineno"> 7877</span>&#160;        rv_err = log_undo_rec_restartable (rcvindex, rcv);</div><div class="line"><a name="l07878"></a><span class="lineno"> 7878</span>&#160;</div><div class="line"><a name="l07879"></a><span class="lineno"> 7879</span>&#160;        <span class="comment">/* Make sure that a CLR was logged */</span></div><div class="line"><a name="l07880"></a><span class="lineno"> 7880</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="storage__common_8h.html#aa8d8ea0049b43e3faf4c471641af5f98">LSA_EQ</a> (&amp;check_tail_lsa, &amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a5b128a08476a5b499cf82e3163e6d62b">tail_lsa</a>))</div><div class="line"><a name="l07881"></a><span class="lineno"> 7881</span>&#160;          {</div><div class="line"><a name="l07882"></a><span class="lineno"> 7882</span>&#160;        <a class="code" href="error__manager_8c.html#afdaf87ce30f2f557802a185ab85b6599">er_set</a> (<a class="code" href="error__manager_8h.html#a5d0d456c474e11fc70779873a30a7432a07ad8f9fda27124d297c94b7d3ea44e8">ER_ERROR_SEVERITY</a>, <a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <a class="code" href="error__code_8h.html#ab640f510b37216f99230b20f1994131b">ER_LOG_MISSING_COMPENSATING_RECORD</a>, 1,</div><div class="line"><a name="l07883"></a><span class="lineno"> 7883</span>&#160;            <a class="code" href="recovery_8c.html#a9489c3632ab4b52fc008b589ce45cbdc">rv_rcvindex_string</a> (rcvindex));</div><div class="line"><a name="l07884"></a><span class="lineno"> 7884</span>&#160;          }</div><div class="line"><a name="l07885"></a><span class="lineno"> 7885</span>&#160;      }</div><div class="line"><a name="l07886"></a><span class="lineno"> 7886</span>&#160;<span class="preprocessor">#else </span><span class="comment">/* CUBRID_DEBUG */</span><span class="preprocessor"></span></div><div class="line"><a name="l07887"></a><span class="lineno"> 7887</span>&#160;      <span class="comment">/* Invoke Undo recovery function */</span></div><div class="line"><a name="l07888"></a><span class="lineno"> 7888</span>&#160;      <span class="comment">/* TODO: Is undo restartable needed? */</span></div><div class="line"><a name="l07889"></a><span class="lineno"> 7889</span>&#160;      rv_err = log_undo_rec_restartable (thread_p, rcvindex, rcv);</div><div class="line"><a name="l07890"></a><span class="lineno"> 7890</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* CUBRID_DEBUG */</span><span class="preprocessor"></span></div><div class="line"><a name="l07891"></a><span class="lineno"> 7891</span>&#160;</div><div class="line"><a name="l07892"></a><span class="lineno"> 7892</span>&#160;      <span class="keywordflow">if</span> (rv_err != <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>)</div><div class="line"><a name="l07893"></a><span class="lineno"> 7893</span>&#160;        {</div><div class="line"><a name="l07894"></a><span class="lineno"> 7894</span>&#160;          <a class="code" href="error__manager_8h.html#a075eb8873354909bbe8edafa0f18f58c">er_log_debug</a> (<a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>,</div><div class="line"><a name="l07895"></a><span class="lineno"> 7895</span>&#160;                <span class="stringliteral">&quot;log_rollback_record: SYSTEM ERROR... Transaction %d, &quot;</span></div><div class="line"><a name="l07896"></a><span class="lineno"> 7896</span>&#160;                <span class="stringliteral">&quot;Log record %lld|%d, rcvindex = %s, was not undone due to error (%d)\n&quot;</span>,</div><div class="line"><a name="l07897"></a><span class="lineno"> 7897</span>&#160;                tdes-&gt;<a class="code" href="structlog__tdes.html#ae9437cf94e11e2307172ef5fc7b32aa9">tran_index</a>, (<span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span>) <a class="code" href="structlog__lsa.html">log_lsa</a>-&gt;<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a>, <a class="code" href="structlog__lsa.html">log_lsa</a>-&gt;<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a>,</div><div class="line"><a name="l07898"></a><span class="lineno"> 7898</span>&#160;                <a class="code" href="recovery_8c.html#a9489c3632ab4b52fc008b589ce45cbdc">rv_rcvindex_string</a> (rcvindex), rv_err);</div><div class="line"><a name="l07899"></a><span class="lineno"> 7899</span>&#160;          <a class="code" href="error__manager_8c.html#afdaf87ce30f2f557802a185ab85b6599">er_set</a> (<a class="code" href="error__manager_8h.html#a5d0d456c474e11fc70779873a30a7432a07ad8f9fda27124d297c94b7d3ea44e8">ER_ERROR_SEVERITY</a>, <a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <a class="code" href="error__code_8h.html#afb34238455b940cb2bacb3ddd899bb03">ER_LOG_MAYNEED_MEDIA_RECOVERY</a>, 1,</div><div class="line"><a name="l07900"></a><span class="lineno"> 7900</span>&#160;              <a class="code" href="file__io_8c.html#a251cdd92358703f9c482c5d84f8d7dc0">fileio_get_volume_label</a> (rcv_vpid-&gt;<a class="code" href="structvpid.html#a54e222d402e758d24ae0df524a9e677d">volid</a>, <a class="code" href="regcomp_8c.html#aa25dac8b80db8b8f03732eeb9ca23934">PEEK</a>));</div><div class="line"><a name="l07901"></a><span class="lineno"> 7901</span>&#160;          <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (<span class="keyword">false</span>);</div><div class="line"><a name="l07902"></a><span class="lineno"> 7902</span>&#160;        }</div><div class="line"><a name="l07903"></a><span class="lineno"> 7903</span>&#160;</div><div class="line"><a name="l07904"></a><span class="lineno"> 7904</span>&#160;      <a class="code" href="log__manager_8c.html#afd1a2421cd94bcd23d1eae834e6a1d28">log_sysop_end_logical_compensate</a> (thread_p, &amp;rcv-&gt;<a class="code" href="structlog__rcv.html#a8400bbfec907d992bc47a641dbd2eeb2">reference_lsa</a>);</div><div class="line"><a name="l07905"></a><span class="lineno"> 7905</span>&#160;      tdes-&gt;<a class="code" href="structlog__tdes.html#ad924146690490b840ef5c3f65c3a5a6c">state</a> = save_state;</div><div class="line"><a name="l07906"></a><span class="lineno"> 7906</span>&#160;    }</div><div class="line"><a name="l07907"></a><span class="lineno"> 7907</span>&#160;    }</div><div class="line"><a name="l07908"></a><span class="lineno"> 7908</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l07909"></a><span class="lineno"> 7909</span>&#160;    {</div><div class="line"><a name="l07910"></a><span class="lineno"> 7910</span>&#160;      <span class="comment">/* </span></div><div class="line"><a name="l07911"></a><span class="lineno"> 7911</span>&#160;<span class="comment">       * Unable to fetch page of volume... May need media recovery on such</span></div><div class="line"><a name="l07912"></a><span class="lineno"> 7912</span>&#160;<span class="comment">       * page... write a CLR anyhow</span></div><div class="line"><a name="l07913"></a><span class="lineno"> 7913</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l07914"></a><span class="lineno"> 7914</span>&#160;      <a class="code" href="log__manager_8c.html#a1b9d7ef3a0e157511a172c7dc6439ca5">log_append_compensate</a> (thread_p, rcvindex, rcv_vpid, rcv-&gt;<a class="code" href="structlog__rcv.html#a4acc4ed244fcaa09adea314ee4f7b861">offset</a>, <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, rcv-&gt;<a class="code" href="structlog__rcv.html#aa86dfb9bbc9edce109df26aacf699915">length</a>, rcv-&gt;<a class="code" href="structlog__rcv.html#afc672de81dd88914d00281fada1acc13">data</a>, tdes);</div><div class="line"><a name="l07915"></a><span class="lineno"> 7915</span>&#160;      <a class="code" href="error__manager_8c.html#afdaf87ce30f2f557802a185ab85b6599">er_set</a> (<a class="code" href="error__manager_8h.html#a5d0d456c474e11fc70779873a30a7432a07ad8f9fda27124d297c94b7d3ea44e8">ER_ERROR_SEVERITY</a>, <a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <a class="code" href="error__code_8h.html#afb34238455b940cb2bacb3ddd899bb03">ER_LOG_MAYNEED_MEDIA_RECOVERY</a>, 1,</div><div class="line"><a name="l07916"></a><span class="lineno"> 7916</span>&#160;          <a class="code" href="file__io_8c.html#a251cdd92358703f9c482c5d84f8d7dc0">fileio_get_volume_label</a> (rcv_vpid-&gt;<a class="code" href="structvpid.html#a54e222d402e758d24ae0df524a9e677d">volid</a>, <a class="code" href="regcomp_8c.html#aa25dac8b80db8b8f03732eeb9ca23934">PEEK</a>));</div><div class="line"><a name="l07917"></a><span class="lineno"> 7917</span>&#160;      <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (<span class="keyword">false</span>);</div><div class="line"><a name="l07918"></a><span class="lineno"> 7918</span>&#160;    }</div><div class="line"><a name="l07919"></a><span class="lineno"> 7919</span>&#160;</div><div class="line"><a name="l07920"></a><span class="lineno"> 7920</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="structarea.html">area</a> != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l07921"></a><span class="lineno"> 7921</span>&#160;    {</div><div class="line"><a name="l07922"></a><span class="lineno"> 7922</span>&#160;      <a class="code" href="memory__alloc_8h.html#a794b5a73adc277837a0c4d12da4af5af">free_and_init</a> (<a class="code" href="structarea.html">area</a>);</div><div class="line"><a name="l07923"></a><span class="lineno"> 7923</span>&#160;    }</div><div class="line"><a name="l07924"></a><span class="lineno"> 7924</span>&#160;</div><div class="line"><a name="l07925"></a><span class="lineno"> 7925</span>&#160;  <span class="keywordflow">if</span> (rcv-&gt;<a class="code" href="structlog__rcv.html#a04db9f252907cff6ca339534e8c4f642">pgptr</a> != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l07926"></a><span class="lineno"> 7926</span>&#160;    {</div><div class="line"><a name="l07927"></a><span class="lineno"> 7927</span>&#160;      <a class="code" href="page__buffer_8h.html#a3bfa0f717b33e17651fff6daf57637ce">pgbuf_unfix</a> (thread_p, rcv-&gt;<a class="code" href="structlog__rcv.html#a04db9f252907cff6ca339534e8c4f642">pgptr</a>);</div><div class="line"><a name="l07928"></a><span class="lineno"> 7928</span>&#160;    }</div><div class="line"><a name="l07929"></a><span class="lineno"> 7929</span>&#160;}</div><div class="line"><a name="l07930"></a><span class="lineno"> 7930</span>&#160;</div><div class="line"><a name="l07931"></a><span class="lineno"> 7931</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l07932"></a><span class="lineno"> 7932</span>&#160;<span class="comment"> * log_undo_rec_restartable - Rollback a single undo record w/ restart</span></div><div class="line"><a name="l07933"></a><span class="lineno"> 7933</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l07934"></a><span class="lineno"> 7934</span>&#160;<span class="comment"> * return: nothing</span></div><div class="line"><a name="l07935"></a><span class="lineno"> 7935</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l07936"></a><span class="lineno"> 7936</span>&#160;<span class="comment"> *   rcvindex(in): Index to recovery functions</span></div><div class="line"><a name="l07937"></a><span class="lineno"> 7937</span>&#160;<span class="comment"> *   rcv(in/out): Recovery structure for recovery function</span></div><div class="line"><a name="l07938"></a><span class="lineno"> 7938</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l07939"></a><span class="lineno"> 7939</span>&#160;<span class="comment"> * NOTE: Perform the undo of a singe log record. Even though it would</span></div><div class="line"><a name="l07940"></a><span class="lineno"> 7940</span>&#160;<span class="comment"> *              indicate a serious problem in the design, check for deadlock</span></div><div class="line"><a name="l07941"></a><span class="lineno"> 7941</span>&#160;<span class="comment"> *              and timeout to make sure this log record was truly undone.</span></div><div class="line"><a name="l07942"></a><span class="lineno"> 7942</span>&#160;<span class="comment"> *              Continue to retry the log undo if possible.</span></div><div class="line"><a name="l07943"></a><span class="lineno"> 7943</span>&#160;<span class="comment"> *      CAVEAT: This attempt to retry in the case of failure assumes that the</span></div><div class="line"><a name="l07944"></a><span class="lineno"> 7944</span>&#160;<span class="comment"> *              rcvindex undo function we invoke has no partial side-effects</span></div><div class="line"><a name="l07945"></a><span class="lineno"> 7945</span>&#160;<span class="comment"> *              for the case where it fails. Otherwise restarting it would not</span></div><div class="line"><a name="l07946"></a><span class="lineno"> 7946</span>&#160;<span class="comment"> *              be a very smart thing to do.</span></div><div class="line"><a name="l07947"></a><span class="lineno"> 7947</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l07948"></a><span class="lineno"> 7948</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span></div><div class="line"><a name="l07949"></a><span class="lineno"> 7949</span>&#160;log_undo_rec_restartable (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2b">LOG_RCVINDEX</a> rcvindex, <a class="code" href="structlog__rcv.html">LOG_RCV</a> * rcv)</div><div class="line"><a name="l07950"></a><span class="lineno"> 7950</span>&#160;{</div><div class="line"><a name="l07951"></a><span class="lineno"> 7951</span>&#160;  <span class="keywordtype">int</span> num_retries = 0;      <span class="comment">/* Avoid infinite loop */</span></div><div class="line"><a name="l07952"></a><span class="lineno"> 7952</span>&#160;  <span class="keywordtype">int</span> error_code = <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>;</div><div class="line"><a name="l07953"></a><span class="lineno"> 7953</span>&#160;</div><div class="line"><a name="l07954"></a><span class="lineno"> 7954</span>&#160;  <span class="keywordflow">do</span></div><div class="line"><a name="l07955"></a><span class="lineno"> 7955</span>&#160;    {</div><div class="line"><a name="l07956"></a><span class="lineno"> 7956</span>&#160;      <span class="keywordflow">if</span> (error_code != <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>)</div><div class="line"><a name="l07957"></a><span class="lineno"> 7957</span>&#160;    {</div><div class="line"><a name="l07958"></a><span class="lineno"> 7958</span>&#160;<span class="preprocessor">#if defined(CUBRID_DEBUG)</span></div><div class="line"><a name="l07959"></a><span class="lineno"> 7959</span>&#160;      <a class="code" href="error__manager_8h.html#a075eb8873354909bbe8edafa0f18f58c">er_log_debug</a> (<a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>,</div><div class="line"><a name="l07960"></a><span class="lineno"> 7960</span>&#160;            <span class="stringliteral">&quot;WARNING: RETRY DURING UNDO WAS NEEDED ... TranIndex: %d, Cnt = %d, Err = %d, Rcvindex = %s\n&quot;</span>,</div><div class="line"><a name="l07961"></a><span class="lineno"> 7961</span>&#160;            <a class="code" href="perf__monitor_8h.html#a55d27b01d605ba6ee2929ddfe8588320">LOG_FIND_THREAD_TRAN_INDEX</a> (thread_p), num_retries, error_code, <a class="code" href="recovery_8c.html#a9489c3632ab4b52fc008b589ce45cbdc">rv_rcvindex_string</a> (rcvindex));</div><div class="line"><a name="l07962"></a><span class="lineno"> 7962</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* CUBRID_DEBUG */</span><span class="preprocessor"></span></div><div class="line"><a name="l07963"></a><span class="lineno"> 7963</span>&#160;    }</div><div class="line"><a name="l07964"></a><span class="lineno"> 7964</span>&#160;      error_code = (*<a class="code" href="recovery_8c.html#ad2eee9d1e5914fa34d3a7868bf2549f4">RV_fun</a>[rcvindex].<a class="code" href="structrvfun.html#af48854e9fe4be091abcca9982252bde7">undofun</a>) (thread_p, rcv);</div><div class="line"><a name="l07965"></a><span class="lineno"> 7965</span>&#160;    }</div><div class="line"><a name="l07966"></a><span class="lineno"> 7966</span>&#160;  <span class="keywordflow">while</span> (++num_retries &lt;= LOG_REC_UNDO_MAX_ATTEMPTS</div><div class="line"><a name="l07967"></a><span class="lineno"> 7967</span>&#160;     &amp;&amp; (error_code == <a class="code" href="error__code_8h.html#a2f6caf428982f062d3baad1927f74676">ER_LK_PAGE_TIMEOUT</a> || error_code == <a class="code" href="error__code_8h.html#ad5735127cf22213983902c7ab2eecfce">ER_LK_UNILATERALLY_ABORTED</a>));</div><div class="line"><a name="l07968"></a><span class="lineno"> 7968</span>&#160;</div><div class="line"><a name="l07969"></a><span class="lineno"> 7969</span>&#160;  <span class="keywordflow">return</span> error_code;</div><div class="line"><a name="l07970"></a><span class="lineno"> 7970</span>&#160;}</div><div class="line"><a name="l07971"></a><span class="lineno"> 7971</span>&#160;</div><div class="line"><a name="l07972"></a><span class="lineno"> 7972</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l07973"></a><span class="lineno"> 7973</span>&#160;<span class="comment"> * log_dump_record_header_to_string - dump log record header to string</span></div><div class="line"><a name="l07974"></a><span class="lineno"> 7974</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l07975"></a><span class="lineno"> 7975</span>&#160;<span class="comment"> * return: nothing</span></div><div class="line"><a name="l07976"></a><span class="lineno"> 7976</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l07977"></a><span class="lineno"> 7977</span>&#160;<span class="comment"> *   log(in): log record header pointer</span></div><div class="line"><a name="l07978"></a><span class="lineno"> 7978</span>&#160;<span class="comment"> *   buf(out): char buffer pointer</span></div><div class="line"><a name="l07979"></a><span class="lineno"> 7979</span>&#160;<span class="comment"> *   len(in): max size of the buffer</span></div><div class="line"><a name="l07980"></a><span class="lineno"> 7980</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l07981"></a><span class="lineno"> 7981</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l07982"></a><span class="lineno"> 7982</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div><div class="line"><a name="l07983"></a><span class="lineno"> 7983</span>&#160;log_dump_record_header_to_string (<a class="code" href="structlog__rec__header.html">LOG_RECORD_HEADER</a> * log, <span class="keywordtype">char</span> *buf, <span class="keywordtype">size_t</span> <a class="code" href="expat_8h.html#afed088663f8704004425cdae2120b9b3">len</a>)</div><div class="line"><a name="l07984"></a><span class="lineno"> 7984</span>&#160;{</div><div class="line"><a name="l07985"></a><span class="lineno"> 7985</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *fmt = <span class="stringliteral">&quot;TYPE[%d], TRID[%d], PREV[%lld,%d], BACK[%lld,%d], FORW[%lld,%d]&quot;</span>;</div><div class="line"><a name="l07986"></a><span class="lineno"> 7986</span>&#160;</div><div class="line"><a name="l07987"></a><span class="lineno"> 7987</span>&#160;  snprintf (buf, <a class="code" href="expat_8h.html#afed088663f8704004425cdae2120b9b3">len</a>, fmt, log-&gt;<a class="code" href="structlog__rec__header.html#aa9be1266bf7fdca13a0a789dc5ae11bb">type</a>, log-&gt;<a class="code" href="structlog__rec__header.html#a210194ed9baf246456495d89fb411725">trid</a>, (<span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span>) log-&gt;<a class="code" href="structlog__rec__header.html#a40f61f4c609c77826f4d5dd3482f3a38">prev_tranlsa</a>.<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a>, log-&gt;<a class="code" href="structlog__rec__header.html#a40f61f4c609c77826f4d5dd3482f3a38">prev_tranlsa</a>.<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a>,</div><div class="line"><a name="l07988"></a><span class="lineno"> 7988</span>&#160;        (<span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span>) log-&gt;<a class="code" href="structlog__rec__header.html#af86b0fae64edb2a53b87dc354baf543c">back_lsa</a>.<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a>, log-&gt;<a class="code" href="structlog__rec__header.html#af86b0fae64edb2a53b87dc354baf543c">back_lsa</a>.<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a>, (<span class="keywordtype">long</span> <span class="keywordtype">long</span> <span class="keywordtype">int</span>) log-&gt;<a class="code" href="structlog__rec__header.html#ab88354b51f9cabaaace23420eec7ac7e">forw_lsa</a>.<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a>,</div><div class="line"><a name="l07989"></a><span class="lineno"> 7989</span>&#160;        log-&gt;<a class="code" href="structlog__rec__header.html#ab88354b51f9cabaaace23420eec7ac7e">forw_lsa</a>.<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a>);</div><div class="line"><a name="l07990"></a><span class="lineno"> 7990</span>&#160;}</div><div class="line"><a name="l07991"></a><span class="lineno"> 7991</span>&#160;</div><div class="line"><a name="l07992"></a><span class="lineno"> 7992</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l07993"></a><span class="lineno"> 7993</span>&#160;<span class="comment"> * log_rollback - Rollback a transaction</span></div><div class="line"><a name="l07994"></a><span class="lineno"> 7994</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l07995"></a><span class="lineno"> 7995</span>&#160;<span class="comment"> * return: nothing</span></div><div class="line"><a name="l07996"></a><span class="lineno"> 7996</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l07997"></a><span class="lineno"> 7997</span>&#160;<span class="comment"> *   tdes(in): Transaction descriptor</span></div><div class="line"><a name="l07998"></a><span class="lineno"> 7998</span>&#160;<span class="comment"> *   upto_lsa_ptr(in): Rollback up to this log sequence address</span></div><div class="line"><a name="l07999"></a><span class="lineno"> 7999</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l08000"></a><span class="lineno"> 8000</span>&#160;<span class="comment"> * NOTE:Rollback the transaction associated with the given tdes</span></div><div class="line"><a name="l08001"></a><span class="lineno"> 8001</span>&#160;<span class="comment"> *              structure upto the given lsa. If LSA is NULL, the transaction</span></div><div class="line"><a name="l08002"></a><span class="lineno"> 8002</span>&#160;<span class="comment"> *              is completely rolled back. This function is used for aborts</span></div><div class="line"><a name="l08003"></a><span class="lineno"> 8003</span>&#160;<span class="comment"> *              related no to database crashes.</span></div><div class="line"><a name="l08004"></a><span class="lineno"> 8004</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l08005"></a><span class="lineno"> 8005</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div><div class="line"><a name="l08006"></a><span class="lineno"> 8006</span>&#160;log_rollback (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="structlog__tdes.html">LOG_TDES</a> * tdes, <span class="keyword">const</span> <a class="code" href="structlog__lsa.html">LOG_LSA</a> * upto_lsa_ptr)</div><div class="line"><a name="l08007"></a><span class="lineno"> 8007</span>&#160;{</div><div class="line"><a name="l08008"></a><span class="lineno"> 8008</span>&#160;  <a class="code" href="structlog__lsa.html">LOG_LSA</a> prev_tranlsa;     <span class="comment">/* Previous LSA */</span></div><div class="line"><a name="l08009"></a><span class="lineno"> 8009</span>&#160;  <a class="code" href="structlog__lsa.html">LOG_LSA</a> upto_lsa;     <span class="comment">/* copy of upto_lsa_ptr contents */</span></div><div class="line"><a name="l08010"></a><span class="lineno"> 8010</span>&#160;  <span class="keywordtype">char</span> log_pgbuf[<a class="code" href="storage__common_8h.html#a0a3c7db68a92df0d34666257bb0f17dd">IO_MAX_PAGE_SIZE</a> + <a class="code" href="memory__alloc_8h.html#a81d7e4971ffc775a379eeb4c65fa30f8">MAX_ALIGNMENT</a>], *aligned_log_pgbuf;</div><div class="line"><a name="l08011"></a><span class="lineno"> 8011</span>&#160;  <a class="code" href="structlog__page.html">LOG_PAGE</a> *log_pgptr = <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;   <span class="comment">/* Log page pointer of LSA log record */</span></div><div class="line"><a name="l08012"></a><span class="lineno"> 8012</span>&#160;  <a class="code" href="structlog__lsa.html">LOG_LSA</a> <a class="code" href="structlog__lsa.html">log_lsa</a>;</div><div class="line"><a name="l08013"></a><span class="lineno"> 8013</span>&#160;  <a class="code" href="structlog__rec__header.html">LOG_RECORD_HEADER</a> *log_rec = <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;    <span class="comment">/* The log record */</span></div><div class="line"><a name="l08014"></a><span class="lineno"> 8014</span>&#160;  <a class="code" href="structlog__rec__undoredo.html">LOG_REC_UNDOREDO</a> *undoredo = <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;    <span class="comment">/* An undoredo log record */</span></div><div class="line"><a name="l08015"></a><span class="lineno"> 8015</span>&#160;  <a class="code" href="structlog__rec__mvcc__undoredo.html">LOG_REC_MVCC_UNDOREDO</a> *mvcc_undoredo = <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;  <span class="comment">/* A MVCC undoredo log rec */</span></div><div class="line"><a name="l08016"></a><span class="lineno"> 8016</span>&#160;  <a class="code" href="structlog__rec__undo.html">LOG_REC_UNDO</a> *undo = <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;    <span class="comment">/* An undo log record */</span></div><div class="line"><a name="l08017"></a><span class="lineno"> 8017</span>&#160;  <a class="code" href="structlog__rec__mvcc__undo.html">LOG_REC_MVCC_UNDO</a> *mvcc_undo = <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;  <span class="comment">/* An undo log record */</span></div><div class="line"><a name="l08018"></a><span class="lineno"> 8018</span>&#160;  <a class="code" href="structlog__rec__compensate.html">LOG_REC_COMPENSATE</a> *compensate = <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;    <span class="comment">/* A compensating log record */</span></div><div class="line"><a name="l08019"></a><span class="lineno"> 8019</span>&#160;  <a class="code" href="structlog__rec__sysop__end.html">LOG_REC_SYSOP_END</a> *sysop_end = <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;  <span class="comment">/* Partial result from top system operation */</span></div><div class="line"><a name="l08020"></a><span class="lineno"> 8020</span>&#160;  <a class="code" href="structlog__rcv.html">LOG_RCV</a> rcv;          <span class="comment">/* Recovery structure */</span></div><div class="line"><a name="l08021"></a><span class="lineno"> 8021</span>&#160;  <a class="code" href="structvpid.html">VPID</a> rcv_vpid;        <span class="comment">/* VPID of data to recover */</span></div><div class="line"><a name="l08022"></a><span class="lineno"> 8022</span>&#160;  <a class="code" href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2b">LOG_RCVINDEX</a> rcvindex;    <span class="comment">/* Recovery index */</span></div><div class="line"><a name="l08023"></a><span class="lineno"> 8023</span>&#160;  <span class="keywordtype">bool</span> isdone;</div><div class="line"><a name="l08024"></a><span class="lineno"> 8024</span>&#160;  <span class="keywordtype">int</span> old_wait_msecs = 0;   <span class="comment">/* Old transaction lock wait */</span></div><div class="line"><a name="l08025"></a><span class="lineno"> 8025</span>&#160;  <a class="code" href="structlog__zip.html">LOG_ZIP</a> *log_unzip_ptr = <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l08026"></a><span class="lineno"> 8026</span>&#160;  <span class="keywordtype">int</span> data_header_size = 0;</div><div class="line"><a name="l08027"></a><span class="lineno"> 8027</span>&#160;  <span class="keywordtype">bool</span> is_mvcc_op = <span class="keyword">false</span>;</div><div class="line"><a name="l08028"></a><span class="lineno"> 8028</span>&#160;</div><div class="line"><a name="l08029"></a><span class="lineno"> 8029</span>&#160;  aligned_log_pgbuf = <a class="code" href="memory__alloc_8h.html#a79781c0dbfdd9510d275cba54f1f384f">PTR_ALIGN</a> (log_pgbuf, <a class="code" href="memory__alloc_8h.html#a81d7e4971ffc775a379eeb4c65fa30f8">MAX_ALIGNMENT</a>);</div><div class="line"><a name="l08030"></a><span class="lineno"> 8030</span>&#160;</div><div class="line"><a name="l08031"></a><span class="lineno"> 8031</span>&#160;  <span class="comment">/* </span></div><div class="line"><a name="l08032"></a><span class="lineno"> 8032</span>&#160;<span class="comment">   * Execute every single undo log record upto the given upto_lsa_ptr since it</span></div><div class="line"><a name="l08033"></a><span class="lineno"> 8033</span>&#160;<span class="comment">   * is not a system crash</span></div><div class="line"><a name="l08034"></a><span class="lineno"> 8034</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l08035"></a><span class="lineno"> 8035</span>&#160;</div><div class="line"><a name="l08036"></a><span class="lineno"> 8036</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="storage__common_8h.html#a26dd766712df5b5c4fcd158f571a75e4">LSA_ISNULL</a> (&amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a5b128a08476a5b499cf82e3163e6d62b">tail_lsa</a>))</div><div class="line"><a name="l08037"></a><span class="lineno"> 8037</span>&#160;    {</div><div class="line"><a name="l08038"></a><span class="lineno"> 8038</span>&#160;      <span class="comment">/* Nothing to undo */</span></div><div class="line"><a name="l08039"></a><span class="lineno"> 8039</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l08040"></a><span class="lineno"> 8040</span>&#160;    }</div><div class="line"><a name="l08041"></a><span class="lineno"> 8041</span>&#160;</div><div class="line"><a name="l08042"></a><span class="lineno"> 8042</span>&#160;  <span class="comment">/* </span></div><div class="line"><a name="l08043"></a><span class="lineno"> 8043</span>&#160;<span class="comment">   * I should not timeout on a page that I need to undo, otherwise, I may</span></div><div class="line"><a name="l08044"></a><span class="lineno"> 8044</span>&#160;<span class="comment">   * end up with database corruption problems. That is, no timeouts during</span></div><div class="line"><a name="l08045"></a><span class="lineno"> 8045</span>&#160;<span class="comment">   * rollback.</span></div><div class="line"><a name="l08046"></a><span class="lineno"> 8046</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l08047"></a><span class="lineno"> 8047</span>&#160;  old_wait_msecs = <a class="code" href="xserver__interface_8h.html#a109d4fa7bce7704b128b212a69062908">xlogtb_reset_wait_msecs</a> (thread_p, <a class="code" href="log__comm_8h.html#a53ab06461fc97ae6864aa9485fa990f6">TRAN_LOCK_INFINITE_WAIT</a>);</div><div class="line"><a name="l08048"></a><span class="lineno"> 8048</span>&#160;</div><div class="line"><a name="l08049"></a><span class="lineno"> 8049</span>&#160;  <a class="code" href="storage__common_8h.html#a4c9bc15296fe6728cf0351726cc6ad09">LSA_COPY</a> (&amp;prev_tranlsa, &amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a4e3335b7f0e4ca7f858416446ae8f782">undo_nxlsa</a>);</div><div class="line"><a name="l08050"></a><span class="lineno"> 8050</span>&#160;  <span class="comment">/* </span></div><div class="line"><a name="l08051"></a><span class="lineno"> 8051</span>&#160;<span class="comment">   * In some cases what upto_lsa_ptr points to is volatile, e.g.</span></div><div class="line"><a name="l08052"></a><span class="lineno"> 8052</span>&#160;<span class="comment">   * when it is from the topops stack (which can be reallocated by</span></div><div class="line"><a name="l08053"></a><span class="lineno"> 8053</span>&#160;<span class="comment">   * operations during this rollback).</span></div><div class="line"><a name="l08054"></a><span class="lineno"> 8054</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l08055"></a><span class="lineno"> 8055</span>&#160;  <span class="keywordflow">if</span> (upto_lsa_ptr != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l08056"></a><span class="lineno"> 8056</span>&#160;    {</div><div class="line"><a name="l08057"></a><span class="lineno"> 8057</span>&#160;      <a class="code" href="storage__common_8h.html#a4c9bc15296fe6728cf0351726cc6ad09">LSA_COPY</a> (&amp;upto_lsa, upto_lsa_ptr);</div><div class="line"><a name="l08058"></a><span class="lineno"> 8058</span>&#160;    }</div><div class="line"><a name="l08059"></a><span class="lineno"> 8059</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l08060"></a><span class="lineno"> 8060</span>&#160;    {</div><div class="line"><a name="l08061"></a><span class="lineno"> 8061</span>&#160;      <a class="code" href="storage__common_8h.html#a6a4baec606189dd320678e8f412ca957">LSA_SET_NULL</a> (&amp;upto_lsa);</div><div class="line"><a name="l08062"></a><span class="lineno"> 8062</span>&#160;    }</div><div class="line"><a name="l08063"></a><span class="lineno"> 8063</span>&#160;</div><div class="line"><a name="l08064"></a><span class="lineno"> 8064</span>&#160;  log_pgptr = (<a class="code" href="structlog__page.html">LOG_PAGE</a> *) aligned_log_pgbuf;</div><div class="line"><a name="l08065"></a><span class="lineno"> 8065</span>&#160;</div><div class="line"><a name="l08066"></a><span class="lineno"> 8066</span>&#160;  isdone = <span class="keyword">false</span>;</div><div class="line"><a name="l08067"></a><span class="lineno"> 8067</span>&#160;</div><div class="line"><a name="l08068"></a><span class="lineno"> 8068</span>&#160;  log_unzip_ptr = <a class="code" href="log__compress_8c.html#a57a48bb541f858a2602ae9f731f5200e">log_zip_alloc</a> (<a class="code" href="storage__common_8h.html#a097b8646f24ea98e209e18c53d74522a">IO_PAGESIZE</a>, <span class="keyword">false</span>);</div><div class="line"><a name="l08069"></a><span class="lineno"> 8069</span>&#160;</div><div class="line"><a name="l08070"></a><span class="lineno"> 8070</span>&#160;  <span class="keywordflow">if</span> (log_unzip_ptr == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l08071"></a><span class="lineno"> 8071</span>&#160;    {</div><div class="line"><a name="l08072"></a><span class="lineno"> 8072</span>&#160;      <a class="code" href="log__impl_8h.html#a8e111eafc27b6e1383fbd0ee812b1167">logpb_fatal_error</a> (thread_p, <span class="keyword">true</span>, <a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <span class="stringliteral">&quot;log_rollback&quot;</span>);</div><div class="line"><a name="l08073"></a><span class="lineno"> 8073</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l08074"></a><span class="lineno"> 8074</span>&#160;    }</div><div class="line"><a name="l08075"></a><span class="lineno"> 8075</span>&#160;</div><div class="line"><a name="l08076"></a><span class="lineno"> 8076</span>&#160;  <span class="keywordflow">while</span> (!<a class="code" href="storage__common_8h.html#a26dd766712df5b5c4fcd158f571a75e4">LSA_ISNULL</a> (&amp;prev_tranlsa) &amp;&amp; !isdone)</div><div class="line"><a name="l08077"></a><span class="lineno"> 8077</span>&#160;    {</div><div class="line"><a name="l08078"></a><span class="lineno"> 8078</span>&#160;      <span class="comment">/* Fetch the page where the LSA record to undo is located */</span></div><div class="line"><a name="l08079"></a><span class="lineno"> 8079</span>&#160;      <a class="code" href="storage__common_8h.html#a4c9bc15296fe6728cf0351726cc6ad09">LSA_COPY</a> (&amp;<a class="code" href="structlog__lsa.html">log_lsa</a>, &amp;prev_tranlsa);</div><div class="line"><a name="l08080"></a><span class="lineno"> 8080</span>&#160;      <a class="code" href="structlog__lsa.html">log_lsa</a>.<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a> = <a class="code" href="storage__common_8h.html#a1a7b7663aee8b9e8b1df6b1fbd5a88b9">LOG_PAGESIZE</a>;</div><div class="line"><a name="l08081"></a><span class="lineno"> 8081</span>&#160;</div><div class="line"><a name="l08082"></a><span class="lineno"> 8082</span>&#160;      <span class="keywordflow">if</span> ((<a class="code" href="log__impl_8h.html#ac67cba94ac6c10da3ae0ab474155ea1a">logpb_fetch_page</a> (thread_p, &amp;<a class="code" href="structlog__lsa.html">log_lsa</a>, <a class="code" href="log__impl_8h.html#ab33fe5f69028f102e9910294e97ccd6babc4379db94a7ff5ff8491988a7c28bc1">LOG_CS_FORCE_USE</a>, log_pgptr)) != <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>)</div><div class="line"><a name="l08083"></a><span class="lineno"> 8083</span>&#160;    {</div><div class="line"><a name="l08084"></a><span class="lineno"> 8084</span>&#160;      (void) <a class="code" href="xserver__interface_8h.html#a109d4fa7bce7704b128b212a69062908">xlogtb_reset_wait_msecs</a> (thread_p, old_wait_msecs);</div><div class="line"><a name="l08085"></a><span class="lineno"> 8085</span>&#160;      <a class="code" href="log__impl_8h.html#a8e111eafc27b6e1383fbd0ee812b1167">logpb_fatal_error</a> (thread_p, <span class="keyword">true</span>, <a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <span class="stringliteral">&quot;log_rollback&quot;</span>);</div><div class="line"><a name="l08086"></a><span class="lineno"> 8086</span>&#160;      <span class="keywordflow">if</span> (log_unzip_ptr != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l08087"></a><span class="lineno"> 8087</span>&#160;        {</div><div class="line"><a name="l08088"></a><span class="lineno"> 8088</span>&#160;          <a class="code" href="log__compress_8c.html#a87b9003990e598725fe9ed434ce007c9">log_zip_free</a> (log_unzip_ptr);</div><div class="line"><a name="l08089"></a><span class="lineno"> 8089</span>&#160;        }</div><div class="line"><a name="l08090"></a><span class="lineno"> 8090</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l08091"></a><span class="lineno"> 8091</span>&#160;    }</div><div class="line"><a name="l08092"></a><span class="lineno"> 8092</span>&#160;</div><div class="line"><a name="l08093"></a><span class="lineno"> 8093</span>&#160;      <span class="keywordflow">while</span> (prev_tranlsa.<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a> == <a class="code" href="structlog__lsa.html">log_lsa</a>.<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a>)</div><div class="line"><a name="l08094"></a><span class="lineno"> 8094</span>&#160;    {</div><div class="line"><a name="l08095"></a><span class="lineno"> 8095</span>&#160;      <span class="comment">/* Break at upto_lsa for partial rollbacks */</span></div><div class="line"><a name="l08096"></a><span class="lineno"> 8096</span>&#160;      <span class="keywordflow">if</span> (upto_lsa_ptr != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> &amp;&amp; <a class="code" href="storage__common_8h.html#a7f9d98414f81d41e639e744027e15947">LSA_LE</a> (&amp;prev_tranlsa, &amp;upto_lsa))</div><div class="line"><a name="l08097"></a><span class="lineno"> 8097</span>&#160;        {</div><div class="line"><a name="l08098"></a><span class="lineno"> 8098</span>&#160;          <span class="comment">/* Finish at this point */</span></div><div class="line"><a name="l08099"></a><span class="lineno"> 8099</span>&#160;          isdone = <span class="keyword">true</span>;</div><div class="line"><a name="l08100"></a><span class="lineno"> 8100</span>&#160;          <span class="keywordflow">break</span>;</div><div class="line"><a name="l08101"></a><span class="lineno"> 8101</span>&#160;        }</div><div class="line"><a name="l08102"></a><span class="lineno"> 8102</span>&#160;</div><div class="line"><a name="l08103"></a><span class="lineno"> 8103</span>&#160;      <span class="comment">/* Find the log record to undo */</span></div><div class="line"><a name="l08104"></a><span class="lineno"> 8104</span>&#160;      <a class="code" href="structlog__lsa.html">log_lsa</a>.<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a> = prev_tranlsa.<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a>;</div><div class="line"><a name="l08105"></a><span class="lineno"> 8105</span>&#160;      log_rec = <a class="code" href="log__impl_8h.html#ae37437431a8ea417a8e768ed5fa8f5f6">LOG_GET_LOG_RECORD_HEADER</a> (log_pgptr, &amp;<a class="code" href="structlog__lsa.html">log_lsa</a>);</div><div class="line"><a name="l08106"></a><span class="lineno"> 8106</span>&#160;</div><div class="line"><a name="l08107"></a><span class="lineno"> 8107</span>&#160;      <span class="comment">/* </span></div><div class="line"><a name="l08108"></a><span class="lineno"> 8108</span>&#160;<span class="comment">       * Next record to undo.. that is previous record in the chain.</span></div><div class="line"><a name="l08109"></a><span class="lineno"> 8109</span>&#160;<span class="comment">       * We need to save it in this variable since the undo_nxlsa pointer</span></div><div class="line"><a name="l08110"></a><span class="lineno"> 8110</span>&#160;<span class="comment">       * may be set when we log something related to rollback (e.g., case</span></div><div class="line"><a name="l08111"></a><span class="lineno"> 8111</span>&#160;<span class="comment">       * of logical operation). Reset the undo_nxlsa back once the</span></div><div class="line"><a name="l08112"></a><span class="lineno"> 8112</span>&#160;<span class="comment">       * rollback_rec is done.</span></div><div class="line"><a name="l08113"></a><span class="lineno"> 8113</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l08114"></a><span class="lineno"> 8114</span>&#160;</div><div class="line"><a name="l08115"></a><span class="lineno"> 8115</span>&#160;      <a class="code" href="storage__common_8h.html#a4c9bc15296fe6728cf0351726cc6ad09">LSA_COPY</a> (&amp;prev_tranlsa, &amp;log_rec-&gt;<a class="code" href="structlog__rec__header.html#a40f61f4c609c77826f4d5dd3482f3a38">prev_tranlsa</a>);</div><div class="line"><a name="l08116"></a><span class="lineno"> 8116</span>&#160;      <a class="code" href="storage__common_8h.html#a4c9bc15296fe6728cf0351726cc6ad09">LSA_COPY</a> (&amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a4e3335b7f0e4ca7f858416446ae8f782">undo_nxlsa</a>, &amp;prev_tranlsa);</div><div class="line"><a name="l08117"></a><span class="lineno"> 8117</span>&#160;</div><div class="line"><a name="l08118"></a><span class="lineno"> 8118</span>&#160;      <span class="keywordflow">switch</span> (log_rec-&gt;<a class="code" href="structlog__rec__header.html#aa9be1266bf7fdca13a0a789dc5ae11bb">type</a>)</div><div class="line"><a name="l08119"></a><span class="lineno"> 8119</span>&#160;        {</div><div class="line"><a name="l08120"></a><span class="lineno"> 8120</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7ab4e00d9048c5782ee68b646ff785f6de">LOG_MVCC_UNDOREDO_DATA</a>:</div><div class="line"><a name="l08121"></a><span class="lineno"> 8121</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7ae03e50858368a0a9e96e4cb7ce991354">LOG_MVCC_DIFF_UNDOREDO_DATA</a>:</div><div class="line"><a name="l08122"></a><span class="lineno"> 8122</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7aa0d885a58816898b0877635fc7f15716">LOG_UNDOREDO_DATA</a>:</div><div class="line"><a name="l08123"></a><span class="lineno"> 8123</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a1e8c5c5dbe12e8cc2388691db7011740">LOG_DIFF_UNDOREDO_DATA</a>:</div><div class="line"><a name="l08124"></a><span class="lineno"> 8124</span>&#160;</div><div class="line"><a name="l08125"></a><span class="lineno"> 8125</span>&#160;          <span class="comment">/* Does this record belong to a MVCC op? */</span></div><div class="line"><a name="l08126"></a><span class="lineno"> 8126</span>&#160;          <span class="keywordflow">if</span> (log_rec-&gt;<a class="code" href="structlog__rec__header.html#aa9be1266bf7fdca13a0a789dc5ae11bb">type</a> == <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7ab4e00d9048c5782ee68b646ff785f6de">LOG_MVCC_UNDOREDO_DATA</a> || log_rec-&gt;<a class="code" href="structlog__rec__header.html#aa9be1266bf7fdca13a0a789dc5ae11bb">type</a> == <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7ae03e50858368a0a9e96e4cb7ce991354">LOG_MVCC_DIFF_UNDOREDO_DATA</a>)</div><div class="line"><a name="l08127"></a><span class="lineno"> 8127</span>&#160;        {</div><div class="line"><a name="l08128"></a><span class="lineno"> 8128</span>&#160;          is_mvcc_op = <span class="keyword">true</span>;</div><div class="line"><a name="l08129"></a><span class="lineno"> 8129</span>&#160;        }</div><div class="line"><a name="l08130"></a><span class="lineno"> 8130</span>&#160;          <span class="keywordflow">else</span></div><div class="line"><a name="l08131"></a><span class="lineno"> 8131</span>&#160;        {</div><div class="line"><a name="l08132"></a><span class="lineno"> 8132</span>&#160;          is_mvcc_op = <span class="keyword">false</span>;</div><div class="line"><a name="l08133"></a><span class="lineno"> 8133</span>&#160;        }</div><div class="line"><a name="l08134"></a><span class="lineno"> 8134</span>&#160;</div><div class="line"><a name="l08135"></a><span class="lineno"> 8135</span>&#160;          <span class="comment">/* Read the DATA HEADER */</span></div><div class="line"><a name="l08136"></a><span class="lineno"> 8136</span>&#160;          <a class="code" href="log__impl_8h.html#afdaa9fdf7d83212b3eec2d515e807686">LOG_READ_ADD_ALIGN</a> (thread_p, <span class="keyword">sizeof</span> (*log_rec), &amp;<a class="code" href="structlog__lsa.html">log_lsa</a>, log_pgptr);</div><div class="line"><a name="l08137"></a><span class="lineno"> 8137</span>&#160;          <span class="keywordflow">if</span> (is_mvcc_op)</div><div class="line"><a name="l08138"></a><span class="lineno"> 8138</span>&#160;        {</div><div class="line"><a name="l08139"></a><span class="lineno"> 8139</span>&#160;          <span class="comment">/* Data header is MVCC undoredo */</span></div><div class="line"><a name="l08140"></a><span class="lineno"> 8140</span>&#160;          data_header_size = <span class="keyword">sizeof</span> (*mvcc_undoredo);</div><div class="line"><a name="l08141"></a><span class="lineno"> 8141</span>&#160;          <a class="code" href="log__impl_8h.html#a108c8143796ad50c65f64d4a483e9453">LOG_READ_ADVANCE_WHEN_DOESNT_FIT</a> (thread_p, data_header_size, &amp;<a class="code" href="structlog__lsa.html">log_lsa</a>, log_pgptr);</div><div class="line"><a name="l08142"></a><span class="lineno"> 8142</span>&#160;          mvcc_undoredo = (<a class="code" href="structlog__rec__mvcc__undoredo.html">LOG_REC_MVCC_UNDOREDO</a> *) ((<span class="keywordtype">char</span> *) log_pgptr-&gt;<a class="code" href="structlog__page.html#a9b51b4623cdb8d1686f6f8fb64bc9ee2">area</a> + <a class="code" href="structlog__lsa.html">log_lsa</a>.<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a>);</div><div class="line"><a name="l08143"></a><span class="lineno"> 8143</span>&#160;</div><div class="line"><a name="l08144"></a><span class="lineno"> 8144</span>&#160;          <span class="comment">/* Get undoredo info */</span></div><div class="line"><a name="l08145"></a><span class="lineno"> 8145</span>&#160;          undoredo = &amp;mvcc_undoredo-&gt;<a class="code" href="structlog__rec__mvcc__undoredo.html#a2183ac89e08754f146da20b81dc18a24">undoredo</a>;</div><div class="line"><a name="l08146"></a><span class="lineno"> 8146</span>&#160;</div><div class="line"><a name="l08147"></a><span class="lineno"> 8147</span>&#160;          <span class="comment">/* Save transaction MVCCID for recovery */</span></div><div class="line"><a name="l08148"></a><span class="lineno"> 8148</span>&#160;          rcv.<a class="code" href="structlog__rcv.html#a0ea812ae4a6bb0266f74937ed1f1632f">mvcc_id</a> = mvcc_undoredo-&gt;<a class="code" href="structlog__rec__mvcc__undoredo.html#adf64ef5b403ea259100fa835d9b75c12">mvccid</a>;</div><div class="line"><a name="l08149"></a><span class="lineno"> 8149</span>&#160;        }</div><div class="line"><a name="l08150"></a><span class="lineno"> 8150</span>&#160;          <span class="keywordflow">else</span></div><div class="line"><a name="l08151"></a><span class="lineno"> 8151</span>&#160;        {</div><div class="line"><a name="l08152"></a><span class="lineno"> 8152</span>&#160;          data_header_size = <span class="keyword">sizeof</span> (*undoredo);</div><div class="line"><a name="l08153"></a><span class="lineno"> 8153</span>&#160;          <a class="code" href="log__impl_8h.html#a108c8143796ad50c65f64d4a483e9453">LOG_READ_ADVANCE_WHEN_DOESNT_FIT</a> (thread_p, data_header_size, &amp;<a class="code" href="structlog__lsa.html">log_lsa</a>, log_pgptr);</div><div class="line"><a name="l08154"></a><span class="lineno"> 8154</span>&#160;          undoredo = (<a class="code" href="structlog__rec__undoredo.html">LOG_REC_UNDOREDO</a> *) ((<span class="keywordtype">char</span> *) log_pgptr-&gt;<a class="code" href="structlog__page.html#a9b51b4623cdb8d1686f6f8fb64bc9ee2">area</a> + <a class="code" href="structlog__lsa.html">log_lsa</a>.<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a>);</div><div class="line"><a name="l08155"></a><span class="lineno"> 8155</span>&#160;</div><div class="line"><a name="l08156"></a><span class="lineno"> 8156</span>&#160;          rcv.<a class="code" href="structlog__rcv.html#a0ea812ae4a6bb0266f74937ed1f1632f">mvcc_id</a> = <a class="code" href="storage__common_8h.html#afd0bb266f6811f0eef1f13a2d4a2d175">MVCCID_NULL</a>;</div><div class="line"><a name="l08157"></a><span class="lineno"> 8157</span>&#160;        }</div><div class="line"><a name="l08158"></a><span class="lineno"> 8158</span>&#160;</div><div class="line"><a name="l08159"></a><span class="lineno"> 8159</span>&#160;          rcvindex = undoredo-&gt;<a class="code" href="structlog__rec__undoredo.html#a3d088b72f92c7881d303916b3a1d7632">data</a>.<a class="code" href="structlog__data.html#ab1a17fceea659d32f5187b81a7b80412">rcvindex</a>;</div><div class="line"><a name="l08160"></a><span class="lineno"> 8160</span>&#160;          rcv.<a class="code" href="structlog__rcv.html#aa86dfb9bbc9edce109df26aacf699915">length</a> = undoredo-&gt;<a class="code" href="structlog__rec__undoredo.html#ae7cba71fbe8b2e543bfdb4fe792e1489">ulength</a>;</div><div class="line"><a name="l08161"></a><span class="lineno"> 8161</span>&#160;          rcv.<a class="code" href="structlog__rcv.html#a4acc4ed244fcaa09adea314ee4f7b861">offset</a> = undoredo-&gt;<a class="code" href="structlog__rec__undoredo.html#a3d088b72f92c7881d303916b3a1d7632">data</a>.<a class="code" href="structlog__data.html#afd25836b0952561036b01b5a50c310b2">offset</a>;</div><div class="line"><a name="l08162"></a><span class="lineno"> 8162</span>&#160;          rcv_vpid.<a class="code" href="structvpid.html#a54e222d402e758d24ae0df524a9e677d">volid</a> = undoredo-&gt;<a class="code" href="structlog__rec__undoredo.html#a3d088b72f92c7881d303916b3a1d7632">data</a>.<a class="code" href="structlog__data.html#ad5635159b85ee07322bf30e39a5dee76">volid</a>;</div><div class="line"><a name="l08163"></a><span class="lineno"> 8163</span>&#160;          rcv_vpid.<a class="code" href="structvpid.html#a5863283d85ba76aaec01bf80c89a9d36">pageid</a> = undoredo-&gt;<a class="code" href="structlog__rec__undoredo.html#a3d088b72f92c7881d303916b3a1d7632">data</a>.<a class="code" href="structlog__data.html#a8410b9d70cc70d2bc6fb6df88ea48bb4">pageid</a>;</div><div class="line"><a name="l08164"></a><span class="lineno"> 8164</span>&#160;</div><div class="line"><a name="l08165"></a><span class="lineno"> 8165</span>&#160;          <a class="code" href="log__impl_8h.html#afdaa9fdf7d83212b3eec2d515e807686">LOG_READ_ADD_ALIGN</a> (thread_p, data_header_size, &amp;<a class="code" href="structlog__lsa.html">log_lsa</a>, log_pgptr);</div><div class="line"><a name="l08166"></a><span class="lineno"> 8166</span>&#160;</div><div class="line"><a name="l08167"></a><span class="lineno"> 8167</span>&#160;          log_rollback_record (thread_p, &amp;<a class="code" href="structlog__lsa.html">log_lsa</a>, log_pgptr, rcvindex, &amp;rcv_vpid, &amp;rcv, tdes, log_unzip_ptr);</div><div class="line"><a name="l08168"></a><span class="lineno"> 8168</span>&#160;          <span class="keywordflow">break</span>;</div><div class="line"><a name="l08169"></a><span class="lineno"> 8169</span>&#160;</div><div class="line"><a name="l08170"></a><span class="lineno"> 8170</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a5eb32eedc7671f3f89c1b10c3d0229c1">LOG_MVCC_UNDO_DATA</a>:</div><div class="line"><a name="l08171"></a><span class="lineno"> 8171</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a661c01f08dbb476251ceae0d99bb5412">LOG_UNDO_DATA</a>:</div><div class="line"><a name="l08172"></a><span class="lineno"> 8172</span>&#160;          <span class="comment">/* Does record belong to a MVCC op? */</span></div><div class="line"><a name="l08173"></a><span class="lineno"> 8173</span>&#160;          is_mvcc_op = (log_rec-&gt;<a class="code" href="structlog__rec__header.html#aa9be1266bf7fdca13a0a789dc5ae11bb">type</a> == <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a5eb32eedc7671f3f89c1b10c3d0229c1">LOG_MVCC_UNDO_DATA</a>);</div><div class="line"><a name="l08174"></a><span class="lineno"> 8174</span>&#160;</div><div class="line"><a name="l08175"></a><span class="lineno"> 8175</span>&#160;          <span class="comment">/* Read the DATA HEADER */</span></div><div class="line"><a name="l08176"></a><span class="lineno"> 8176</span>&#160;          <a class="code" href="log__impl_8h.html#afdaa9fdf7d83212b3eec2d515e807686">LOG_READ_ADD_ALIGN</a> (thread_p, <span class="keyword">sizeof</span> (*log_rec), &amp;<a class="code" href="structlog__lsa.html">log_lsa</a>, log_pgptr);</div><div class="line"><a name="l08177"></a><span class="lineno"> 8177</span>&#160;          <span class="keywordflow">if</span> (is_mvcc_op)</div><div class="line"><a name="l08178"></a><span class="lineno"> 8178</span>&#160;        {</div><div class="line"><a name="l08179"></a><span class="lineno"> 8179</span>&#160;          <span class="comment">/* Data header is MVCC undo */</span></div><div class="line"><a name="l08180"></a><span class="lineno"> 8180</span>&#160;          data_header_size = <span class="keyword">sizeof</span> (*mvcc_undo);</div><div class="line"><a name="l08181"></a><span class="lineno"> 8181</span>&#160;          <a class="code" href="log__impl_8h.html#a108c8143796ad50c65f64d4a483e9453">LOG_READ_ADVANCE_WHEN_DOESNT_FIT</a> (thread_p, data_header_size, &amp;<a class="code" href="structlog__lsa.html">log_lsa</a>, log_pgptr);</div><div class="line"><a name="l08182"></a><span class="lineno"> 8182</span>&#160;          mvcc_undo = (<a class="code" href="structlog__rec__mvcc__undo.html">LOG_REC_MVCC_UNDO</a> *) ((<span class="keywordtype">char</span> *) log_pgptr-&gt;<a class="code" href="structlog__page.html#a9b51b4623cdb8d1686f6f8fb64bc9ee2">area</a> + <a class="code" href="structlog__lsa.html">log_lsa</a>.<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a>);</div><div class="line"><a name="l08183"></a><span class="lineno"> 8183</span>&#160;          <span class="comment">/* Get undo info */</span></div><div class="line"><a name="l08184"></a><span class="lineno"> 8184</span>&#160;          undo = &amp;mvcc_undo-&gt;<a class="code" href="structlog__rec__mvcc__undo.html#a7f17cde1def984989174d8aca50307b6">undo</a>;</div><div class="line"><a name="l08185"></a><span class="lineno"> 8185</span>&#160;</div><div class="line"><a name="l08186"></a><span class="lineno"> 8186</span>&#160;          <span class="comment">/* Save transaction MVCCID for recovery */</span></div><div class="line"><a name="l08187"></a><span class="lineno"> 8187</span>&#160;          rcv.<a class="code" href="structlog__rcv.html#a0ea812ae4a6bb0266f74937ed1f1632f">mvcc_id</a> = mvcc_undo-&gt;<a class="code" href="structlog__rec__mvcc__undo.html#ae7c1bf9c8eb5a86167f621ac40445f96">mvccid</a>;</div><div class="line"><a name="l08188"></a><span class="lineno"> 8188</span>&#160;        }</div><div class="line"><a name="l08189"></a><span class="lineno"> 8189</span>&#160;          <span class="keywordflow">else</span></div><div class="line"><a name="l08190"></a><span class="lineno"> 8190</span>&#160;        {</div><div class="line"><a name="l08191"></a><span class="lineno"> 8191</span>&#160;          data_header_size = <span class="keyword">sizeof</span> (*undo);</div><div class="line"><a name="l08192"></a><span class="lineno"> 8192</span>&#160;          <a class="code" href="log__impl_8h.html#a108c8143796ad50c65f64d4a483e9453">LOG_READ_ADVANCE_WHEN_DOESNT_FIT</a> (thread_p, data_header_size, &amp;<a class="code" href="structlog__lsa.html">log_lsa</a>, log_pgptr);</div><div class="line"><a name="l08193"></a><span class="lineno"> 8193</span>&#160;          undo = (<a class="code" href="structlog__rec__undo.html">LOG_REC_UNDO</a> *) ((<span class="keywordtype">char</span> *) log_pgptr-&gt;<a class="code" href="structlog__page.html#a9b51b4623cdb8d1686f6f8fb64bc9ee2">area</a> + <a class="code" href="structlog__lsa.html">log_lsa</a>.<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a>);</div><div class="line"><a name="l08194"></a><span class="lineno"> 8194</span>&#160;</div><div class="line"><a name="l08195"></a><span class="lineno"> 8195</span>&#160;          rcv.<a class="code" href="structlog__rcv.html#a0ea812ae4a6bb0266f74937ed1f1632f">mvcc_id</a> = <a class="code" href="storage__common_8h.html#afd0bb266f6811f0eef1f13a2d4a2d175">MVCCID_NULL</a>;</div><div class="line"><a name="l08196"></a><span class="lineno"> 8196</span>&#160;        }</div><div class="line"><a name="l08197"></a><span class="lineno"> 8197</span>&#160;          rcvindex = undo-&gt;<a class="code" href="structlog__rec__undo.html#a08b364e1c642e56ea610a5e51beb7d2b">data</a>.<a class="code" href="structlog__data.html#ab1a17fceea659d32f5187b81a7b80412">rcvindex</a>;</div><div class="line"><a name="l08198"></a><span class="lineno"> 8198</span>&#160;          rcv.<a class="code" href="structlog__rcv.html#a4acc4ed244fcaa09adea314ee4f7b861">offset</a> = undo-&gt;<a class="code" href="structlog__rec__undo.html#a08b364e1c642e56ea610a5e51beb7d2b">data</a>.<a class="code" href="structlog__data.html#afd25836b0952561036b01b5a50c310b2">offset</a>;</div><div class="line"><a name="l08199"></a><span class="lineno"> 8199</span>&#160;          rcv_vpid.<a class="code" href="structvpid.html#a54e222d402e758d24ae0df524a9e677d">volid</a> = undo-&gt;<a class="code" href="structlog__rec__undo.html#a08b364e1c642e56ea610a5e51beb7d2b">data</a>.<a class="code" href="structlog__data.html#ad5635159b85ee07322bf30e39a5dee76">volid</a>;</div><div class="line"><a name="l08200"></a><span class="lineno"> 8200</span>&#160;          rcv_vpid.<a class="code" href="structvpid.html#a5863283d85ba76aaec01bf80c89a9d36">pageid</a> = undo-&gt;<a class="code" href="structlog__rec__undo.html#a08b364e1c642e56ea610a5e51beb7d2b">data</a>.<a class="code" href="structlog__data.html#a8410b9d70cc70d2bc6fb6df88ea48bb4">pageid</a>;</div><div class="line"><a name="l08201"></a><span class="lineno"> 8201</span>&#160;          rcv.<a class="code" href="structlog__rcv.html#aa86dfb9bbc9edce109df26aacf699915">length</a> = undo-&gt;<a class="code" href="structlog__rec__undo.html#a50bcc130d05619893dbb63c284c3e874">length</a>;</div><div class="line"><a name="l08202"></a><span class="lineno"> 8202</span>&#160;</div><div class="line"><a name="l08203"></a><span class="lineno"> 8203</span>&#160;          <a class="code" href="log__impl_8h.html#afdaa9fdf7d83212b3eec2d515e807686">LOG_READ_ADD_ALIGN</a> (thread_p, data_header_size, &amp;<a class="code" href="structlog__lsa.html">log_lsa</a>, log_pgptr);</div><div class="line"><a name="l08204"></a><span class="lineno"> 8204</span>&#160;</div><div class="line"><a name="l08205"></a><span class="lineno"> 8205</span>&#160;          log_rollback_record (thread_p, &amp;<a class="code" href="structlog__lsa.html">log_lsa</a>, log_pgptr, rcvindex, &amp;rcv_vpid, &amp;rcv, tdes, log_unzip_ptr);</div><div class="line"><a name="l08206"></a><span class="lineno"> 8206</span>&#160;          <span class="keywordflow">break</span>;</div><div class="line"><a name="l08207"></a><span class="lineno"> 8207</span>&#160;</div><div class="line"><a name="l08208"></a><span class="lineno"> 8208</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a92e0794a329897d52f3345d13359914e">LOG_COMPENSATE</a>:</div><div class="line"><a name="l08209"></a><span class="lineno"> 8209</span>&#160;          <span class="comment">/* </span></div><div class="line"><a name="l08210"></a><span class="lineno"> 8210</span>&#160;<span class="comment">           * We found a partial rollback, use the CLR to find the next record</span></div><div class="line"><a name="l08211"></a><span class="lineno"> 8211</span>&#160;<span class="comment">           * to undo</span></div><div class="line"><a name="l08212"></a><span class="lineno"> 8212</span>&#160;<span class="comment">           */</span></div><div class="line"><a name="l08213"></a><span class="lineno"> 8213</span>&#160;</div><div class="line"><a name="l08214"></a><span class="lineno"> 8214</span>&#160;          <span class="comment">/* Read the DATA HEADER */</span></div><div class="line"><a name="l08215"></a><span class="lineno"> 8215</span>&#160;          <a class="code" href="log__impl_8h.html#afdaa9fdf7d83212b3eec2d515e807686">LOG_READ_ADD_ALIGN</a> (thread_p, <span class="keyword">sizeof</span> (*log_rec), &amp;<a class="code" href="structlog__lsa.html">log_lsa</a>, log_pgptr);</div><div class="line"><a name="l08216"></a><span class="lineno"> 8216</span>&#160;          <a class="code" href="log__impl_8h.html#a108c8143796ad50c65f64d4a483e9453">LOG_READ_ADVANCE_WHEN_DOESNT_FIT</a> (thread_p, <span class="keyword">sizeof</span> (*compensate), &amp;<a class="code" href="structlog__lsa.html">log_lsa</a>, log_pgptr);</div><div class="line"><a name="l08217"></a><span class="lineno"> 8217</span>&#160;          compensate = (<a class="code" href="structlog__rec__compensate.html">LOG_REC_COMPENSATE</a> *) ((<span class="keywordtype">char</span> *) log_pgptr-&gt;<a class="code" href="structlog__page.html#a9b51b4623cdb8d1686f6f8fb64bc9ee2">area</a> + <a class="code" href="structlog__lsa.html">log_lsa</a>.<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a>);</div><div class="line"><a name="l08218"></a><span class="lineno"> 8218</span>&#160;          <a class="code" href="storage__common_8h.html#a4c9bc15296fe6728cf0351726cc6ad09">LSA_COPY</a> (&amp;prev_tranlsa, &amp;compensate-&gt;<a class="code" href="structlog__rec__compensate.html#a7222173e854c1f68568c5ce564325a7a">undo_nxlsa</a>);</div><div class="line"><a name="l08219"></a><span class="lineno"> 8219</span>&#160;          <span class="keywordflow">break</span>;</div><div class="line"><a name="l08220"></a><span class="lineno"> 8220</span>&#160;</div><div class="line"><a name="l08221"></a><span class="lineno"> 8221</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a29a7c510ffdadeb0e4c5304e6825a5ec">LOG_SYSOP_END</a>:</div><div class="line"><a name="l08222"></a><span class="lineno"> 8222</span>&#160;          <span class="comment">/* </span></div><div class="line"><a name="l08223"></a><span class="lineno"> 8223</span>&#160;<span class="comment">           * We found a system top operation that should be skipped from rollback.</span></div><div class="line"><a name="l08224"></a><span class="lineno"> 8224</span>&#160;<span class="comment">           */</span></div><div class="line"><a name="l08225"></a><span class="lineno"> 8225</span>&#160;</div><div class="line"><a name="l08226"></a><span class="lineno"> 8226</span>&#160;          <span class="comment">/* Read the DATA HEADER */</span></div><div class="line"><a name="l08227"></a><span class="lineno"> 8227</span>&#160;          <a class="code" href="log__impl_8h.html#afdaa9fdf7d83212b3eec2d515e807686">LOG_READ_ADD_ALIGN</a> (thread_p, <span class="keyword">sizeof</span> (*log_rec), &amp;<a class="code" href="structlog__lsa.html">log_lsa</a>, log_pgptr);</div><div class="line"><a name="l08228"></a><span class="lineno"> 8228</span>&#160;          <a class="code" href="log__impl_8h.html#a108c8143796ad50c65f64d4a483e9453">LOG_READ_ADVANCE_WHEN_DOESNT_FIT</a> (thread_p, <span class="keyword">sizeof</span> (*sysop_end), &amp;<a class="code" href="structlog__lsa.html">log_lsa</a>, log_pgptr);</div><div class="line"><a name="l08229"></a><span class="lineno"> 8229</span>&#160;          sysop_end = ((<a class="code" href="structlog__rec__sysop__end.html">LOG_REC_SYSOP_END</a> *) ((<span class="keywordtype">char</span> *) log_pgptr-&gt;<a class="code" href="structlog__page.html#a9b51b4623cdb8d1686f6f8fb64bc9ee2">area</a> + <a class="code" href="structlog__lsa.html">log_lsa</a>.<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a>));</div><div class="line"><a name="l08230"></a><span class="lineno"> 8230</span>&#160;</div><div class="line"><a name="l08231"></a><span class="lineno"> 8231</span>&#160;          <span class="keywordflow">if</span> (sysop_end-&gt;<a class="code" href="structlog__rec__sysop__end.html#a3ea9d3ebfe5a0ed547670f1409fb385f">type</a> == <a class="code" href="log__impl_8h.html#a24797b2fe67e0ec8631d7a92fbef25c9ac4566a4bae57d0a42fa6e37cc65e5329">LOG_SYSOP_END_LOGICAL_UNDO</a>)</div><div class="line"><a name="l08232"></a><span class="lineno"> 8232</span>&#160;        {</div><div class="line"><a name="l08233"></a><span class="lineno"> 8233</span>&#160;          rcvindex = sysop_end-&gt;<a class="code" href="structlog__rec__sysop__end.html#a34c029c46715b2edc97a8f2c5ce9d309">undo</a>.<a class="code" href="structlog__rec__undo.html#a08b364e1c642e56ea610a5e51beb7d2b">data</a>.<a class="code" href="structlog__data.html#ab1a17fceea659d32f5187b81a7b80412">rcvindex</a>;</div><div class="line"><a name="l08234"></a><span class="lineno"> 8234</span>&#160;          rcv.<a class="code" href="structlog__rcv.html#a4acc4ed244fcaa09adea314ee4f7b861">offset</a> = sysop_end-&gt;<a class="code" href="structlog__rec__sysop__end.html#a34c029c46715b2edc97a8f2c5ce9d309">undo</a>.<a class="code" href="structlog__rec__undo.html#a08b364e1c642e56ea610a5e51beb7d2b">data</a>.<a class="code" href="structlog__data.html#afd25836b0952561036b01b5a50c310b2">offset</a>;</div><div class="line"><a name="l08235"></a><span class="lineno"> 8235</span>&#160;          rcv_vpid.<a class="code" href="structvpid.html#a54e222d402e758d24ae0df524a9e677d">volid</a> = sysop_end-&gt;<a class="code" href="structlog__rec__sysop__end.html#a34c029c46715b2edc97a8f2c5ce9d309">undo</a>.<a class="code" href="structlog__rec__undo.html#a08b364e1c642e56ea610a5e51beb7d2b">data</a>.<a class="code" href="structlog__data.html#ad5635159b85ee07322bf30e39a5dee76">volid</a>;</div><div class="line"><a name="l08236"></a><span class="lineno"> 8236</span>&#160;          rcv_vpid.<a class="code" href="structvpid.html#a5863283d85ba76aaec01bf80c89a9d36">pageid</a> = sysop_end-&gt;<a class="code" href="structlog__rec__sysop__end.html#a34c029c46715b2edc97a8f2c5ce9d309">undo</a>.<a class="code" href="structlog__rec__undo.html#a08b364e1c642e56ea610a5e51beb7d2b">data</a>.<a class="code" href="structlog__data.html#a8410b9d70cc70d2bc6fb6df88ea48bb4">pageid</a>;</div><div class="line"><a name="l08237"></a><span class="lineno"> 8237</span>&#160;          rcv.<a class="code" href="structlog__rcv.html#aa86dfb9bbc9edce109df26aacf699915">length</a> = sysop_end-&gt;<a class="code" href="structlog__rec__sysop__end.html#a34c029c46715b2edc97a8f2c5ce9d309">undo</a>.<a class="code" href="structlog__rec__undo.html#a50bcc130d05619893dbb63c284c3e874">length</a>;</div><div class="line"><a name="l08238"></a><span class="lineno"> 8238</span>&#160;          rcv.<a class="code" href="structlog__rcv.html#a0ea812ae4a6bb0266f74937ed1f1632f">mvcc_id</a> = <a class="code" href="storage__common_8h.html#afd0bb266f6811f0eef1f13a2d4a2d175">MVCCID_NULL</a>;</div><div class="line"><a name="l08239"></a><span class="lineno"> 8239</span>&#160;</div><div class="line"><a name="l08240"></a><span class="lineno"> 8240</span>&#160;          <span class="comment">/* will jump to parent LSA. save it now before advancing to undo data */</span></div><div class="line"><a name="l08241"></a><span class="lineno"> 8241</span>&#160;          <a class="code" href="storage__common_8h.html#a4c9bc15296fe6728cf0351726cc6ad09">LSA_COPY</a> (&amp;prev_tranlsa, &amp;sysop_end-&gt;<a class="code" href="structlog__rec__sysop__end.html#ac228866b1723dfd1165550c037fdc3aa">lastparent_lsa</a>);</div><div class="line"><a name="l08242"></a><span class="lineno"> 8242</span>&#160;          <a class="code" href="storage__common_8h.html#a4c9bc15296fe6728cf0351726cc6ad09">LSA_COPY</a> (&amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a4e3335b7f0e4ca7f858416446ae8f782">undo_nxlsa</a>, &amp;sysop_end-&gt;<a class="code" href="structlog__rec__sysop__end.html#ac228866b1723dfd1165550c037fdc3aa">lastparent_lsa</a>);</div><div class="line"><a name="l08243"></a><span class="lineno"> 8243</span>&#160;</div><div class="line"><a name="l08244"></a><span class="lineno"> 8244</span>&#160;          <a class="code" href="log__impl_8h.html#afdaa9fdf7d83212b3eec2d515e807686">LOG_READ_ADD_ALIGN</a> (thread_p, <span class="keyword">sizeof</span> (*sysop_end), &amp;<a class="code" href="structlog__lsa.html">log_lsa</a>, log_pgptr);</div><div class="line"><a name="l08245"></a><span class="lineno"> 8245</span>&#160;          log_rollback_record (thread_p, &amp;<a class="code" href="structlog__lsa.html">log_lsa</a>, log_pgptr, rcvindex, &amp;rcv_vpid, &amp;rcv, tdes, log_unzip_ptr);</div><div class="line"><a name="l08246"></a><span class="lineno"> 8246</span>&#160;        }</div><div class="line"><a name="l08247"></a><span class="lineno"> 8247</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sysop_end-&gt;<a class="code" href="structlog__rec__sysop__end.html#a3ea9d3ebfe5a0ed547670f1409fb385f">type</a> == <a class="code" href="log__impl_8h.html#a24797b2fe67e0ec8631d7a92fbef25c9a571011a0354832edf02d40490f512716">LOG_SYSOP_END_LOGICAL_MVCC_UNDO</a>)</div><div class="line"><a name="l08248"></a><span class="lineno"> 8248</span>&#160;        {</div><div class="line"><a name="l08249"></a><span class="lineno"> 8249</span>&#160;          rcvindex = sysop_end-&gt;<a class="code" href="structlog__rec__sysop__end.html#a013e84a84232dee701d8083c07a172c9">mvcc_undo</a>.<a class="code" href="structlog__rec__mvcc__undo.html#a7f17cde1def984989174d8aca50307b6">undo</a>.<a class="code" href="structlog__rec__undo.html#a08b364e1c642e56ea610a5e51beb7d2b">data</a>.<a class="code" href="structlog__data.html#ab1a17fceea659d32f5187b81a7b80412">rcvindex</a>;</div><div class="line"><a name="l08250"></a><span class="lineno"> 8250</span>&#160;          rcv.<a class="code" href="structlog__rcv.html#a4acc4ed244fcaa09adea314ee4f7b861">offset</a> = sysop_end-&gt;<a class="code" href="structlog__rec__sysop__end.html#a013e84a84232dee701d8083c07a172c9">mvcc_undo</a>.<a class="code" href="structlog__rec__mvcc__undo.html#a7f17cde1def984989174d8aca50307b6">undo</a>.<a class="code" href="structlog__rec__undo.html#a08b364e1c642e56ea610a5e51beb7d2b">data</a>.<a class="code" href="structlog__data.html#afd25836b0952561036b01b5a50c310b2">offset</a>;</div><div class="line"><a name="l08251"></a><span class="lineno"> 8251</span>&#160;          rcv_vpid.<a class="code" href="structvpid.html#a54e222d402e758d24ae0df524a9e677d">volid</a> = sysop_end-&gt;<a class="code" href="structlog__rec__sysop__end.html#a013e84a84232dee701d8083c07a172c9">mvcc_undo</a>.<a class="code" href="structlog__rec__mvcc__undo.html#a7f17cde1def984989174d8aca50307b6">undo</a>.<a class="code" href="structlog__rec__undo.html#a08b364e1c642e56ea610a5e51beb7d2b">data</a>.<a class="code" href="structlog__data.html#ad5635159b85ee07322bf30e39a5dee76">volid</a>;</div><div class="line"><a name="l08252"></a><span class="lineno"> 8252</span>&#160;          rcv_vpid.<a class="code" href="structvpid.html#a5863283d85ba76aaec01bf80c89a9d36">pageid</a> = sysop_end-&gt;<a class="code" href="structlog__rec__sysop__end.html#a013e84a84232dee701d8083c07a172c9">mvcc_undo</a>.<a class="code" href="structlog__rec__mvcc__undo.html#a7f17cde1def984989174d8aca50307b6">undo</a>.<a class="code" href="structlog__rec__undo.html#a08b364e1c642e56ea610a5e51beb7d2b">data</a>.<a class="code" href="structlog__data.html#a8410b9d70cc70d2bc6fb6df88ea48bb4">pageid</a>;</div><div class="line"><a name="l08253"></a><span class="lineno"> 8253</span>&#160;          rcv.<a class="code" href="structlog__rcv.html#aa86dfb9bbc9edce109df26aacf699915">length</a> = sysop_end-&gt;<a class="code" href="structlog__rec__sysop__end.html#a013e84a84232dee701d8083c07a172c9">mvcc_undo</a>.<a class="code" href="structlog__rec__mvcc__undo.html#a7f17cde1def984989174d8aca50307b6">undo</a>.<a class="code" href="structlog__rec__undo.html#a50bcc130d05619893dbb63c284c3e874">length</a>;</div><div class="line"><a name="l08254"></a><span class="lineno"> 8254</span>&#160;          rcv.<a class="code" href="structlog__rcv.html#a0ea812ae4a6bb0266f74937ed1f1632f">mvcc_id</a> = sysop_end-&gt;<a class="code" href="structlog__rec__sysop__end.html#a013e84a84232dee701d8083c07a172c9">mvcc_undo</a>.<a class="code" href="structlog__rec__mvcc__undo.html#ae7c1bf9c8eb5a86167f621ac40445f96">mvccid</a>;</div><div class="line"><a name="l08255"></a><span class="lineno"> 8255</span>&#160;</div><div class="line"><a name="l08256"></a><span class="lineno"> 8256</span>&#160;          <span class="comment">/* will jump to parent LSA. save it now before advancing to undo data */</span></div><div class="line"><a name="l08257"></a><span class="lineno"> 8257</span>&#160;          <a class="code" href="storage__common_8h.html#a4c9bc15296fe6728cf0351726cc6ad09">LSA_COPY</a> (&amp;prev_tranlsa, &amp;sysop_end-&gt;<a class="code" href="structlog__rec__sysop__end.html#ac228866b1723dfd1165550c037fdc3aa">lastparent_lsa</a>);</div><div class="line"><a name="l08258"></a><span class="lineno"> 8258</span>&#160;          <a class="code" href="storage__common_8h.html#a4c9bc15296fe6728cf0351726cc6ad09">LSA_COPY</a> (&amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a4e3335b7f0e4ca7f858416446ae8f782">undo_nxlsa</a>, &amp;sysop_end-&gt;<a class="code" href="structlog__rec__sysop__end.html#ac228866b1723dfd1165550c037fdc3aa">lastparent_lsa</a>);</div><div class="line"><a name="l08259"></a><span class="lineno"> 8259</span>&#160;</div><div class="line"><a name="l08260"></a><span class="lineno"> 8260</span>&#160;          <a class="code" href="log__impl_8h.html#afdaa9fdf7d83212b3eec2d515e807686">LOG_READ_ADD_ALIGN</a> (thread_p, <span class="keyword">sizeof</span> (*sysop_end), &amp;<a class="code" href="structlog__lsa.html">log_lsa</a>, log_pgptr);</div><div class="line"><a name="l08261"></a><span class="lineno"> 8261</span>&#160;          log_rollback_record (thread_p, &amp;<a class="code" href="structlog__lsa.html">log_lsa</a>, log_pgptr, rcvindex, &amp;rcv_vpid, &amp;rcv, tdes, log_unzip_ptr);</div><div class="line"><a name="l08262"></a><span class="lineno"> 8262</span>&#160;        }</div><div class="line"><a name="l08263"></a><span class="lineno"> 8263</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sysop_end-&gt;<a class="code" href="structlog__rec__sysop__end.html#a3ea9d3ebfe5a0ed547670f1409fb385f">type</a> == <a class="code" href="log__impl_8h.html#a24797b2fe67e0ec8631d7a92fbef25c9a69f84e9574e7f583c88733bdea3a415f">LOG_SYSOP_END_LOGICAL_COMPENSATE</a>)</div><div class="line"><a name="l08264"></a><span class="lineno"> 8264</span>&#160;        {</div><div class="line"><a name="l08265"></a><span class="lineno"> 8265</span>&#160;          <span class="comment">/* compensate */</span></div><div class="line"><a name="l08266"></a><span class="lineno"> 8266</span>&#160;          <a class="code" href="storage__common_8h.html#a4c9bc15296fe6728cf0351726cc6ad09">LSA_COPY</a> (&amp;prev_tranlsa, &amp;sysop_end-&gt;<a class="code" href="structlog__rec__sysop__end.html#ab094b81b70e8d75dbb0d38f29cc18f62">compensate_lsa</a>);</div><div class="line"><a name="l08267"></a><span class="lineno"> 8267</span>&#160;        }</div><div class="line"><a name="l08268"></a><span class="lineno"> 8268</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sysop_end-&gt;<a class="code" href="structlog__rec__sysop__end.html#a3ea9d3ebfe5a0ed547670f1409fb385f">type</a> == <a class="code" href="log__impl_8h.html#a24797b2fe67e0ec8631d7a92fbef25c9ada41432cf121d5aafecae01984edd8e7">LOG_SYSOP_END_LOGICAL_RUN_POSTPONE</a>)</div><div class="line"><a name="l08269"></a><span class="lineno"> 8269</span>&#160;        {</div><div class="line"><a name="l08270"></a><span class="lineno"> 8270</span>&#160;          <span class="comment">/* this must be partial rollback during recovery of another logical run postpone */</span></div><div class="line"><a name="l08271"></a><span class="lineno"> 8271</span>&#160;          <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (!<a class="code" href="log__impl_8h.html#a8f08025b469332f89fee8ce83dc2d3ff">LOG_ISRESTARTED</a> ());</div><div class="line"><a name="l08272"></a><span class="lineno"> 8272</span>&#160;          <span class="comment">/* we have to stop */</span></div><div class="line"><a name="l08273"></a><span class="lineno"> 8273</span>&#160;          <a class="code" href="storage__common_8h.html#a6a4baec606189dd320678e8f412ca957">LSA_SET_NULL</a> (&amp;prev_tranlsa);</div><div class="line"><a name="l08274"></a><span class="lineno"> 8274</span>&#160;        }</div><div class="line"><a name="l08275"></a><span class="lineno"> 8275</span>&#160;          <span class="keywordflow">else</span></div><div class="line"><a name="l08276"></a><span class="lineno"> 8276</span>&#160;        {</div><div class="line"><a name="l08277"></a><span class="lineno"> 8277</span>&#160;          <span class="comment">/* jump to last parent */</span></div><div class="line"><a name="l08278"></a><span class="lineno"> 8278</span>&#160;          <a class="code" href="storage__common_8h.html#a4c9bc15296fe6728cf0351726cc6ad09">LSA_COPY</a> (&amp;prev_tranlsa, &amp;sysop_end-&gt;<a class="code" href="structlog__rec__sysop__end.html#ac228866b1723dfd1165550c037fdc3aa">lastparent_lsa</a>);</div><div class="line"><a name="l08279"></a><span class="lineno"> 8279</span>&#160;        }</div><div class="line"><a name="l08280"></a><span class="lineno"> 8280</span>&#160;          <span class="keywordflow">break</span>;</div><div class="line"><a name="l08281"></a><span class="lineno"> 8281</span>&#160;</div><div class="line"><a name="l08282"></a><span class="lineno"> 8282</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7ac17426d82957cd6c312341d4f5badd87">LOG_REDO_DATA</a>:</div><div class="line"><a name="l08283"></a><span class="lineno"> 8283</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a4252bfab0a4f9fbbcd7bd68ba32dea1d">LOG_MVCC_REDO_DATA</a>:</div><div class="line"><a name="l08284"></a><span class="lineno"> 8284</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a7557d9dfb53f14fd3b6eef04a165476b">LOG_DBEXTERN_REDO_DATA</a>:</div><div class="line"><a name="l08285"></a><span class="lineno"> 8285</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7ab9a91cb4efa2ad495c98d7dc7fef8ee1">LOG_DUMMY_HEAD_POSTPONE</a>:</div><div class="line"><a name="l08286"></a><span class="lineno"> 8286</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7acf273d42fe8e9c360fb16c8c0f96c480">LOG_POSTPONE</a>:</div><div class="line"><a name="l08287"></a><span class="lineno"> 8287</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a9e2aba85fbc168e57ae1744fa9da8a88">LOG_START_CHKPT</a>:</div><div class="line"><a name="l08288"></a><span class="lineno"> 8288</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a76c06d374c551ca295e0594b74c9ff19">LOG_END_CHKPT</a>:</div><div class="line"><a name="l08289"></a><span class="lineno"> 8289</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7ae96755081dc4d3599f98356864dfd7e0">LOG_SAVEPOINT</a>:</div><div class="line"><a name="l08290"></a><span class="lineno"> 8290</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7aa83e8becd5b186f65485f6e819e416ea">LOG_2PC_PREPARE</a>:</div><div class="line"><a name="l08291"></a><span class="lineno"> 8291</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a69f87b42501f2ccfe66922ab196102d7">LOG_2PC_START</a>:</div><div class="line"><a name="l08292"></a><span class="lineno"> 8292</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a869d94e68bfc3354ad6bd211130cf13b">LOG_2PC_ABORT_DECISION</a>:</div><div class="line"><a name="l08293"></a><span class="lineno"> 8293</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a017e6014fefb381f8583c7ccd87c4133">LOG_2PC_ABORT_INFORM_PARTICPS</a>:</div><div class="line"><a name="l08294"></a><span class="lineno"> 8294</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a97003f753507d5a7a65a0bf078a078f4">LOG_REPLICATION_DATA</a>:</div><div class="line"><a name="l08295"></a><span class="lineno"> 8295</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7ac9476ec323cd3909823f79ecc3938afd">LOG_REPLICATION_STATEMENT</a>:</div><div class="line"><a name="l08296"></a><span class="lineno"> 8296</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a3839799b1d15f4333e439c136a3a21ca">LOG_SYSOP_ATOMIC_START</a>:</div><div class="line"><a name="l08297"></a><span class="lineno"> 8297</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a942105cb887dd1030b0c6151087d24ac">LOG_DUMMY_HA_SERVER_STATE</a>:</div><div class="line"><a name="l08298"></a><span class="lineno"> 8298</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a3d03de268419fc962e6ca48de324a644">LOG_DUMMY_OVF_RECORD</a>:</div><div class="line"><a name="l08299"></a><span class="lineno"> 8299</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7aec133d8bc86aabdcf6dcda157999bd21">LOG_DUMMY_GENERIC</a>:</div><div class="line"><a name="l08300"></a><span class="lineno"> 8300</span>&#160;          <span class="keywordflow">break</span>;</div><div class="line"><a name="l08301"></a><span class="lineno"> 8301</span>&#160;</div><div class="line"><a name="l08302"></a><span class="lineno"> 8302</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a59ac89fe85edd8011e84db21095290a7">LOG_RUN_POSTPONE</a>:</div><div class="line"><a name="l08303"></a><span class="lineno"> 8303</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a6b03dd6d350881f805f7b3adeedcf10f">LOG_COMMIT_WITH_POSTPONE</a>:</div><div class="line"><a name="l08304"></a><span class="lineno"> 8304</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a198b93b13d51133e5e5d4b8e7c62f54e">LOG_SYSOP_START_POSTPONE</a>:</div><div class="line"><a name="l08305"></a><span class="lineno"> 8305</span>&#160;          <span class="comment">/* Undo of run postpone system operation. End here. */</span></div><div class="line"><a name="l08306"></a><span class="lineno"> 8306</span>&#160;          <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (!<a class="code" href="log__impl_8h.html#a8f08025b469332f89fee8ce83dc2d3ff">LOG_ISRESTARTED</a> ());</div><div class="line"><a name="l08307"></a><span class="lineno"> 8307</span>&#160;          <a class="code" href="storage__common_8h.html#a6a4baec606189dd320678e8f412ca957">LSA_SET_NULL</a> (&amp;prev_tranlsa);</div><div class="line"><a name="l08308"></a><span class="lineno"> 8308</span>&#160;          <span class="keywordflow">break</span>;</div><div class="line"><a name="l08309"></a><span class="lineno"> 8309</span>&#160;</div><div class="line"><a name="l08310"></a><span class="lineno"> 8310</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a40516d04f27c98062921adb5282b4933">LOG_WILL_COMMIT</a>:</div><div class="line"><a name="l08311"></a><span class="lineno"> 8311</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a1903de7cf7fa88081eb8010a667e1839">LOG_COMMIT</a>:</div><div class="line"><a name="l08312"></a><span class="lineno"> 8312</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a66f7a15b57486fb9081e733c142d35ea">LOG_ABORT</a>:</div><div class="line"><a name="l08313"></a><span class="lineno"> 8313</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a15a1ebeb5fd50ffb5ae73b0cb26f9e7e">LOG_2PC_COMMIT_DECISION</a>:</div><div class="line"><a name="l08314"></a><span class="lineno"> 8314</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a1ea8bf762d53de919a4eec322ebe9a1d">LOG_2PC_COMMIT_INFORM_PARTICPS</a>:</div><div class="line"><a name="l08315"></a><span class="lineno"> 8315</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a4ab5b053c95a07cab41de19454b7663c">LOG_2PC_RECV_ACK</a>:</div><div class="line"><a name="l08316"></a><span class="lineno"> 8316</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a1ec512ba54217805936aa5afb03b3d98">LOG_DUMMY_CRASH_RECOVERY</a>:</div><div class="line"><a name="l08317"></a><span class="lineno"> 8317</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a034d486f56b110bc31fba3b6db5dd980">LOG_END_OF_LOG</a>:</div><div class="line"><a name="l08318"></a><span class="lineno"> 8318</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a8fc57c015374d8ecf822c5ea0f39faa0">LOG_SMALLER_LOGREC_TYPE</a>:</div><div class="line"><a name="l08319"></a><span class="lineno"> 8319</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a25bfb5a0ac528c508558bd8be6704739">LOG_LARGER_LOGREC_TYPE</a>:</div><div class="line"><a name="l08320"></a><span class="lineno"> 8320</span>&#160;        <span class="keywordflow">default</span>:</div><div class="line"><a name="l08321"></a><span class="lineno"> 8321</span>&#160;          {</div><div class="line"><a name="l08322"></a><span class="lineno"> 8322</span>&#160;        <span class="keywordtype">char</span> msg[<a class="code" href="get__shard__id_8c.html#aae3371f3a2ed27aefae9c4e26982fc99">LINE_MAX</a>];</div><div class="line"><a name="l08323"></a><span class="lineno"> 8323</span>&#160;</div><div class="line"><a name="l08324"></a><span class="lineno"> 8324</span>&#160;        <a class="code" href="error__manager_8c.html#afdaf87ce30f2f557802a185ab85b6599">er_set</a> (<a class="code" href="error__manager_8h.html#a5d0d456c474e11fc70779873a30a7432a3314630dd19f90a68274cf737092c9f2">ER_FATAL_ERROR_SEVERITY</a>, <a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <a class="code" href="error__code_8h.html#a486c1c6b307c5a60224c189358e70915">ER_LOG_PAGE_CORRUPTED</a>, 1, <a class="code" href="structlog__lsa.html">log_lsa</a>.<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a>);</div><div class="line"><a name="l08325"></a><span class="lineno"> 8325</span>&#160;        log_dump_record_header_to_string (log_rec, msg, <a class="code" href="get__shard__id_8c.html#aae3371f3a2ed27aefae9c4e26982fc99">LINE_MAX</a>);</div><div class="line"><a name="l08326"></a><span class="lineno"> 8326</span>&#160;        <a class="code" href="log__impl_8h.html#a8e111eafc27b6e1383fbd0ee812b1167">logpb_fatal_error</a> (thread_p, <span class="keyword">true</span>, <a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, msg);</div><div class="line"><a name="l08327"></a><span class="lineno"> 8327</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l08328"></a><span class="lineno"> 8328</span>&#160;          }</div><div class="line"><a name="l08329"></a><span class="lineno"> 8329</span>&#160;        }           <span class="comment">/* switch */</span></div><div class="line"><a name="l08330"></a><span class="lineno"> 8330</span>&#160;</div><div class="line"><a name="l08331"></a><span class="lineno"> 8331</span>&#160;      <span class="comment">/* Just in case, it was changed or the previous address has changed */</span></div><div class="line"><a name="l08332"></a><span class="lineno"> 8332</span>&#160;      <a class="code" href="storage__common_8h.html#a4c9bc15296fe6728cf0351726cc6ad09">LSA_COPY</a> (&amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a4e3335b7f0e4ca7f858416446ae8f782">undo_nxlsa</a>, &amp;prev_tranlsa);</div><div class="line"><a name="l08333"></a><span class="lineno"> 8333</span>&#160;    }           <span class="comment">/* while */</span></div><div class="line"><a name="l08334"></a><span class="lineno"> 8334</span>&#160;</div><div class="line"><a name="l08335"></a><span class="lineno"> 8335</span>&#160;    }               <span class="comment">/* while */</span></div><div class="line"><a name="l08336"></a><span class="lineno"> 8336</span>&#160;</div><div class="line"><a name="l08337"></a><span class="lineno"> 8337</span>&#160;  <span class="comment">/* Remember the undo next lsa for partial rollbacks */</span></div><div class="line"><a name="l08338"></a><span class="lineno"> 8338</span>&#160;  <a class="code" href="storage__common_8h.html#a4c9bc15296fe6728cf0351726cc6ad09">LSA_COPY</a> (&amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a4e3335b7f0e4ca7f858416446ae8f782">undo_nxlsa</a>, &amp;prev_tranlsa);</div><div class="line"><a name="l08339"></a><span class="lineno"> 8339</span>&#160;  (void) <a class="code" href="xserver__interface_8h.html#a109d4fa7bce7704b128b212a69062908">xlogtb_reset_wait_msecs</a> (thread_p, old_wait_msecs);</div><div class="line"><a name="l08340"></a><span class="lineno"> 8340</span>&#160;</div><div class="line"><a name="l08341"></a><span class="lineno"> 8341</span>&#160;  <span class="keywordflow">if</span> (log_unzip_ptr != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l08342"></a><span class="lineno"> 8342</span>&#160;    {</div><div class="line"><a name="l08343"></a><span class="lineno"> 8343</span>&#160;      <a class="code" href="log__compress_8c.html#a87b9003990e598725fe9ed434ce007c9">log_zip_free</a> (log_unzip_ptr);</div><div class="line"><a name="l08344"></a><span class="lineno"> 8344</span>&#160;    }</div><div class="line"><a name="l08345"></a><span class="lineno"> 8345</span>&#160;</div><div class="line"><a name="l08346"></a><span class="lineno"> 8346</span>&#160;  <span class="keywordflow">return</span>;</div><div class="line"><a name="l08347"></a><span class="lineno"> 8347</span>&#160;</div><div class="line"><a name="l08348"></a><span class="lineno"> 8348</span>&#160;}</div><div class="line"><a name="l08349"></a><span class="lineno"> 8349</span>&#160;</div><div class="line"><a name="l08350"></a><span class="lineno"> 8350</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l08351"></a><span class="lineno"> 8351</span>&#160;<span class="comment"> * log_get_next_nested_top - Get top system action list</span></div><div class="line"><a name="l08352"></a><span class="lineno"> 8352</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l08353"></a><span class="lineno"> 8353</span>&#160;<span class="comment"> * return: top system action count</span></div><div class="line"><a name="l08354"></a><span class="lineno"> 8354</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l08355"></a><span class="lineno"> 8355</span>&#160;<span class="comment"> *   tdes(in): Transaction descriptor</span></div><div class="line"><a name="l08356"></a><span class="lineno"> 8356</span>&#160;<span class="comment"> *   start_postpone_lsa(in): Where to start looking for postpone records</span></div><div class="line"><a name="l08357"></a><span class="lineno"> 8357</span>&#160;<span class="comment"> *   out_nxtop_range_stack(in/out): Set as a side effect to topop range stack.</span></div><div class="line"><a name="l08358"></a><span class="lineno"> 8358</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l08359"></a><span class="lineno"> 8359</span>&#160;<span class="comment"> * NOTE: Find a nested top system operation which start after</span></div><div class="line"><a name="l08360"></a><span class="lineno"> 8360</span>&#160;<span class="comment"> *              start_postpone_lsa and before tdes-&gt;tail_lsa.</span></div><div class="line"><a name="l08361"></a><span class="lineno"> 8361</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l08362"></a><span class="lineno"> 8362</span>&#160;<span class="keywordtype">int</span></div><div class="line"><a name="l08363"></a><span class="lineno"><a class="line" href="log__manager_8h.html#aac95e62fd0455db6b8c123bc559a8acd"> 8363</a></span>&#160;<a class="code" href="log__manager_8c.html#aac95e62fd0455db6b8c123bc559a8acd">log_get_next_nested_top</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="structlog__tdes.html">LOG_TDES</a> * tdes, <a class="code" href="structlog__lsa.html">LOG_LSA</a> * start_postpone_lsa,</div><div class="line"><a name="l08364"></a><span class="lineno"> 8364</span>&#160;             <a class="code" href="structlog__topop__range.html">LOG_TOPOP_RANGE</a> ** out_nxtop_range_stack)</div><div class="line"><a name="l08365"></a><span class="lineno"> 8365</span>&#160;{</div><div class="line"><a name="l08366"></a><span class="lineno"> 8366</span>&#160;  <a class="code" href="structlog__rec__sysop__end.html">LOG_REC_SYSOP_END</a> *top_result;</div><div class="line"><a name="l08367"></a><span class="lineno"> 8367</span>&#160;  <span class="keywordtype">char</span> log_pgbuf[<a class="code" href="storage__common_8h.html#a0a3c7db68a92df0d34666257bb0f17dd">IO_MAX_PAGE_SIZE</a> + <a class="code" href="memory__alloc_8h.html#a81d7e4971ffc775a379eeb4c65fa30f8">MAX_ALIGNMENT</a>];</div><div class="line"><a name="l08368"></a><span class="lineno"> 8368</span>&#160;  <span class="keywordtype">char</span> *aligned_log_pgbuf;</div><div class="line"><a name="l08369"></a><span class="lineno"> 8369</span>&#160;  <a class="code" href="structlog__page.html">LOG_PAGE</a> *log_pgptr = <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l08370"></a><span class="lineno"> 8370</span>&#160;  <a class="code" href="structlog__rec__header.html">LOG_RECORD_HEADER</a> *log_rec;</div><div class="line"><a name="l08371"></a><span class="lineno"> 8371</span>&#160;  <a class="code" href="structlog__lsa.html">LOG_LSA</a> tmp_log_lsa;</div><div class="line"><a name="l08372"></a><span class="lineno"> 8372</span>&#160;  <a class="code" href="structlog__lsa.html">LOG_LSA</a> top_result_lsa;</div><div class="line"><a name="l08373"></a><span class="lineno"> 8373</span>&#160;  <a class="code" href="structlog__lsa.html">LOG_LSA</a> prev_last_parent_lsa;</div><div class="line"><a name="l08374"></a><span class="lineno"> 8374</span>&#160;  <a class="code" href="structlog__topop__range.html">LOG_TOPOP_RANGE</a> *nxtop_stack;</div><div class="line"><a name="l08375"></a><span class="lineno"> 8375</span>&#160;  <a class="code" href="structlog__topop__range.html">LOG_TOPOP_RANGE</a> *prev_nxtop_stack;</div><div class="line"><a name="l08376"></a><span class="lineno"> 8376</span>&#160;  <span class="keywordtype">int</span> nxtop_count = 0;</div><div class="line"><a name="l08377"></a><span class="lineno"> 8377</span>&#160;  <span class="keywordtype">int</span> nxtop_stack_size = 0;</div><div class="line"><a name="l08378"></a><span class="lineno"> 8378</span>&#160;  <a class="code" href="storage__common_8h.html#a26871e1bd203b43825e17ebfd14d072d">LOG_PAGEID</a> last_fetch_page_id = <a class="code" href="storage__common_8h.html#a7ed60eef43941f46fadae895f63ee033">NULL_PAGEID</a>;</div><div class="line"><a name="l08379"></a><span class="lineno"> 8379</span>&#160;</div><div class="line"><a name="l08380"></a><span class="lineno"> 8380</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="storage__common_8h.html#a26dd766712df5b5c4fcd158f571a75e4">LSA_ISNULL</a> (&amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a35e52753b9c8d5e70696ae8f0479072f">tail_topresult_lsa</a>) || !<a class="code" href="storage__common_8h.html#a467739272b1ee74686bae4be2354197a">LSA_GT</a> (&amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a35e52753b9c8d5e70696ae8f0479072f">tail_topresult_lsa</a>, start_postpone_lsa))</div><div class="line"><a name="l08381"></a><span class="lineno"> 8381</span>&#160;    {</div><div class="line"><a name="l08382"></a><span class="lineno"> 8382</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l08383"></a><span class="lineno"> 8383</span>&#160;    }</div><div class="line"><a name="l08384"></a><span class="lineno"> 8384</span>&#160;</div><div class="line"><a name="l08385"></a><span class="lineno"> 8385</span>&#160;  <a class="code" href="storage__common_8h.html#a4c9bc15296fe6728cf0351726cc6ad09">LSA_COPY</a> (&amp;top_result_lsa, &amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a35e52753b9c8d5e70696ae8f0479072f">tail_topresult_lsa</a>);</div><div class="line"><a name="l08386"></a><span class="lineno"> 8386</span>&#160;  <a class="code" href="storage__common_8h.html#a6a4baec606189dd320678e8f412ca957">LSA_SET_NULL</a> (&amp;prev_last_parent_lsa);</div><div class="line"><a name="l08387"></a><span class="lineno"> 8387</span>&#160;</div><div class="line"><a name="l08388"></a><span class="lineno"> 8388</span>&#160;  aligned_log_pgbuf = <a class="code" href="memory__alloc_8h.html#a79781c0dbfdd9510d275cba54f1f384f">PTR_ALIGN</a> (log_pgbuf, <a class="code" href="memory__alloc_8h.html#a81d7e4971ffc775a379eeb4c65fa30f8">MAX_ALIGNMENT</a>);</div><div class="line"><a name="l08389"></a><span class="lineno"> 8389</span>&#160;  log_pgptr = (<a class="code" href="structlog__page.html">LOG_PAGE</a> *) aligned_log_pgbuf;</div><div class="line"><a name="l08390"></a><span class="lineno"> 8390</span>&#160;</div><div class="line"><a name="l08391"></a><span class="lineno"> 8391</span>&#160;  nxtop_stack = *out_nxtop_range_stack;</div><div class="line"><a name="l08392"></a><span class="lineno"> 8392</span>&#160;  nxtop_stack_size = <a class="code" href="log__manager_8h.html#ae5eb3ef7758cbee166b922bd5541dfae">LOG_TOPOP_STACK_INIT_SIZE</a>;</div><div class="line"><a name="l08393"></a><span class="lineno"> 8393</span>&#160;</div><div class="line"><a name="l08394"></a><span class="lineno"> 8394</span>&#160;  <span class="keywordflow">do</span></div><div class="line"><a name="l08395"></a><span class="lineno"> 8395</span>&#160;    {</div><div class="line"><a name="l08396"></a><span class="lineno"> 8396</span>&#160;      <span class="keywordflow">if</span> (nxtop_count &gt;= nxtop_stack_size)</div><div class="line"><a name="l08397"></a><span class="lineno"> 8397</span>&#160;    {</div><div class="line"><a name="l08398"></a><span class="lineno"> 8398</span>&#160;      prev_nxtop_stack = nxtop_stack;</div><div class="line"><a name="l08399"></a><span class="lineno"> 8399</span>&#160;</div><div class="line"><a name="l08400"></a><span class="lineno"> 8400</span>&#160;      nxtop_stack_size *= 2;</div><div class="line"><a name="l08401"></a><span class="lineno"> 8401</span>&#160;      nxtop_stack = (<a class="code" href="structlog__topop__range.html">LOG_TOPOP_RANGE</a> *) <a class="code" href="leak__detector_8h.html#a99aa8fd9f4831e1b0fa9e1cdcde3e249">malloc</a> (nxtop_stack_size * <span class="keyword">sizeof</span> (<a class="code" href="structlog__topop__range.html">LOG_TOPOP_RANGE</a>));</div><div class="line"><a name="l08402"></a><span class="lineno"> 8402</span>&#160;      <span class="keywordflow">if</span> (nxtop_stack == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l08403"></a><span class="lineno"> 8403</span>&#160;        {</div><div class="line"><a name="l08404"></a><span class="lineno"> 8404</span>&#160;          <span class="keywordflow">if</span> (prev_nxtop_stack != *out_nxtop_range_stack)</div><div class="line"><a name="l08405"></a><span class="lineno"> 8405</span>&#160;        {</div><div class="line"><a name="l08406"></a><span class="lineno"> 8406</span>&#160;          <a class="code" href="memory__alloc_8h.html#a794b5a73adc277837a0c4d12da4af5af">free_and_init</a> (prev_nxtop_stack);</div><div class="line"><a name="l08407"></a><span class="lineno"> 8407</span>&#160;        }</div><div class="line"><a name="l08408"></a><span class="lineno"> 8408</span>&#160;          <a class="code" href="log__impl_8h.html#a8e111eafc27b6e1383fbd0ee812b1167">logpb_fatal_error</a> (thread_p, <span class="keyword">true</span>, <a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <span class="stringliteral">&quot;log_get_next_nested_top&quot;</span>);</div><div class="line"><a name="l08409"></a><span class="lineno"> 8409</span>&#160;          <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l08410"></a><span class="lineno"> 8410</span>&#160;        }</div><div class="line"><a name="l08411"></a><span class="lineno"> 8411</span>&#160;</div><div class="line"><a name="l08412"></a><span class="lineno"> 8412</span>&#160;      memcpy (nxtop_stack, prev_nxtop_stack, (nxtop_stack_size / 2) * <span class="keyword">sizeof</span> (<a class="code" href="structlog__topop__range.html">LOG_TOPOP_RANGE</a>));</div><div class="line"><a name="l08413"></a><span class="lineno"> 8413</span>&#160;</div><div class="line"><a name="l08414"></a><span class="lineno"> 8414</span>&#160;      <span class="keywordflow">if</span> (prev_nxtop_stack != *out_nxtop_range_stack)</div><div class="line"><a name="l08415"></a><span class="lineno"> 8415</span>&#160;        {</div><div class="line"><a name="l08416"></a><span class="lineno"> 8416</span>&#160;          <a class="code" href="memory__alloc_8h.html#a794b5a73adc277837a0c4d12da4af5af">free_and_init</a> (prev_nxtop_stack);</div><div class="line"><a name="l08417"></a><span class="lineno"> 8417</span>&#160;        }</div><div class="line"><a name="l08418"></a><span class="lineno"> 8418</span>&#160;    }</div><div class="line"><a name="l08419"></a><span class="lineno"> 8419</span>&#160;</div><div class="line"><a name="l08420"></a><span class="lineno"> 8420</span>&#160;      <span class="keywordflow">if</span> (last_fetch_page_id != top_result_lsa.<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a>)</div><div class="line"><a name="l08421"></a><span class="lineno"> 8421</span>&#160;    {</div><div class="line"><a name="l08422"></a><span class="lineno"> 8422</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="log__impl_8h.html#ac67cba94ac6c10da3ae0ab474155ea1a">logpb_fetch_page</a> (thread_p, &amp;top_result_lsa, <a class="code" href="log__impl_8h.html#ab33fe5f69028f102e9910294e97ccd6babc4379db94a7ff5ff8491988a7c28bc1">LOG_CS_FORCE_USE</a>, log_pgptr) != <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>)</div><div class="line"><a name="l08423"></a><span class="lineno"> 8423</span>&#160;        {</div><div class="line"><a name="l08424"></a><span class="lineno"> 8424</span>&#160;          <span class="keywordflow">if</span> (nxtop_stack != *out_nxtop_range_stack)</div><div class="line"><a name="l08425"></a><span class="lineno"> 8425</span>&#160;        {</div><div class="line"><a name="l08426"></a><span class="lineno"> 8426</span>&#160;          <a class="code" href="memory__alloc_8h.html#a794b5a73adc277837a0c4d12da4af5af">free_and_init</a> (nxtop_stack);</div><div class="line"><a name="l08427"></a><span class="lineno"> 8427</span>&#160;        }</div><div class="line"><a name="l08428"></a><span class="lineno"> 8428</span>&#160;          <a class="code" href="log__impl_8h.html#a8e111eafc27b6e1383fbd0ee812b1167">logpb_fatal_error</a> (thread_p, <span class="keyword">true</span>, <a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <span class="stringliteral">&quot;log_get_next_nested_top&quot;</span>);</div><div class="line"><a name="l08429"></a><span class="lineno"> 8429</span>&#160;          <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l08430"></a><span class="lineno"> 8430</span>&#160;        }</div><div class="line"><a name="l08431"></a><span class="lineno"> 8431</span>&#160;    }</div><div class="line"><a name="l08432"></a><span class="lineno"> 8432</span>&#160;</div><div class="line"><a name="l08433"></a><span class="lineno"> 8433</span>&#160;      log_rec = <a class="code" href="log__impl_8h.html#ae37437431a8ea417a8e768ed5fa8f5f6">LOG_GET_LOG_RECORD_HEADER</a> (log_pgptr, &amp;top_result_lsa);</div><div class="line"><a name="l08434"></a><span class="lineno"> 8434</span>&#160;</div><div class="line"><a name="l08435"></a><span class="lineno"> 8435</span>&#160;      <span class="keywordflow">if</span> (log_rec-&gt;<a class="code" href="structlog__rec__header.html#aa9be1266bf7fdca13a0a789dc5ae11bb">type</a> == <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a29a7c510ffdadeb0e4c5304e6825a5ec">LOG_SYSOP_END</a>)</div><div class="line"><a name="l08436"></a><span class="lineno"> 8436</span>&#160;    {</div><div class="line"><a name="l08437"></a><span class="lineno"> 8437</span>&#160;      <span class="comment">/* Read the DATA HEADER */</span></div><div class="line"><a name="l08438"></a><span class="lineno"> 8438</span>&#160;      <a class="code" href="structlog__lsa.html">LOG_LSA</a> prev_tran_lsa = log_rec-&gt;<a class="code" href="structlog__rec__header.html#af86b0fae64edb2a53b87dc354baf543c">back_lsa</a>;</div><div class="line"><a name="l08439"></a><span class="lineno"> 8439</span>&#160;</div><div class="line"><a name="l08440"></a><span class="lineno"> 8440</span>&#160;      <a class="code" href="storage__common_8h.html#a4c9bc15296fe6728cf0351726cc6ad09">LSA_COPY</a> (&amp;tmp_log_lsa, &amp;top_result_lsa);</div><div class="line"><a name="l08441"></a><span class="lineno"> 8441</span>&#160;      <a class="code" href="log__impl_8h.html#afdaa9fdf7d83212b3eec2d515e807686">LOG_READ_ADD_ALIGN</a> (thread_p, <span class="keyword">sizeof</span> (<a class="code" href="structlog__rec__header.html">LOG_RECORD_HEADER</a>), &amp;tmp_log_lsa, log_pgptr);</div><div class="line"><a name="l08442"></a><span class="lineno"> 8442</span>&#160;      <a class="code" href="log__impl_8h.html#a108c8143796ad50c65f64d4a483e9453">LOG_READ_ADVANCE_WHEN_DOESNT_FIT</a> (thread_p, <span class="keyword">sizeof</span> (<a class="code" href="structlog__rec__sysop__end.html">LOG_REC_SYSOP_END</a>), &amp;tmp_log_lsa, log_pgptr);</div><div class="line"><a name="l08443"></a><span class="lineno"> 8443</span>&#160;      top_result = (<a class="code" href="structlog__rec__sysop__end.html">LOG_REC_SYSOP_END</a> *) ((<span class="keywordtype">char</span> *) log_pgptr-&gt;<a class="code" href="structlog__page.html#a9b51b4623cdb8d1686f6f8fb64bc9ee2">area</a> + tmp_log_lsa.<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a>);</div><div class="line"><a name="l08444"></a><span class="lineno"> 8444</span>&#160;      last_fetch_page_id = tmp_log_lsa.<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a>;</div><div class="line"><a name="l08445"></a><span class="lineno"> 8445</span>&#160;</div><div class="line"><a name="l08446"></a><span class="lineno"> 8446</span>&#160;      <span class="comment">/* </span></div><div class="line"><a name="l08447"></a><span class="lineno"> 8447</span>&#160;<span class="comment">       * There may be some nested top system operations that are committed</span></div><div class="line"><a name="l08448"></a><span class="lineno"> 8448</span>&#160;<span class="comment">       * and aborted in the desired region</span></div><div class="line"><a name="l08449"></a><span class="lineno"> 8449</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l08450"></a><span class="lineno"> 8450</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="storage__common_8h.html#a26dd766712df5b5c4fcd158f571a75e4">LSA_ISNULL</a> (&amp;prev_last_parent_lsa) || <a class="code" href="storage__common_8h.html#a7f9d98414f81d41e639e744027e15947">LSA_LE</a> (&amp;top_result_lsa, &amp;prev_last_parent_lsa))</div><div class="line"><a name="l08451"></a><span class="lineno"> 8451</span>&#160;        {</div><div class="line"><a name="l08452"></a><span class="lineno"> 8452</span>&#160;          <a class="code" href="storage__common_8h.html#a4c9bc15296fe6728cf0351726cc6ad09">LSA_COPY</a> (&amp;(nxtop_stack[nxtop_count].start_lsa), &amp;top_result-&gt;<a class="code" href="structlog__rec__sysop__end.html#ac228866b1723dfd1165550c037fdc3aa">lastparent_lsa</a>);</div><div class="line"><a name="l08453"></a><span class="lineno"> 8453</span>&#160;          <span class="keywordflow">if</span> (top_result-&gt;<a class="code" href="structlog__rec__sysop__end.html#a3ea9d3ebfe5a0ed547670f1409fb385f">type</a> == <a class="code" href="log__impl_8h.html#a24797b2fe67e0ec8631d7a92fbef25c9ada41432cf121d5aafecae01984edd8e7">LOG_SYSOP_END_LOGICAL_RUN_POSTPONE</a>)</div><div class="line"><a name="l08454"></a><span class="lineno"> 8454</span>&#160;        {</div><div class="line"><a name="l08455"></a><span class="lineno"> 8455</span>&#160;          <span class="comment">/* we need to process this log record. end range at previous log record. */</span></div><div class="line"><a name="l08456"></a><span class="lineno"> 8456</span>&#160;          <a class="code" href="storage__common_8h.html#a4c9bc15296fe6728cf0351726cc6ad09">LSA_COPY</a> (&amp;(nxtop_stack[nxtop_count].end_lsa), &amp;prev_tran_lsa);</div><div class="line"><a name="l08457"></a><span class="lineno"> 8457</span>&#160;        }</div><div class="line"><a name="l08458"></a><span class="lineno"> 8458</span>&#160;          <span class="keywordflow">else</span></div><div class="line"><a name="l08459"></a><span class="lineno"> 8459</span>&#160;        {</div><div class="line"><a name="l08460"></a><span class="lineno"> 8460</span>&#160;          <span class="comment">/* end range at system op end log record */</span></div><div class="line"><a name="l08461"></a><span class="lineno"> 8461</span>&#160;          <a class="code" href="storage__common_8h.html#a4c9bc15296fe6728cf0351726cc6ad09">LSA_COPY</a> (&amp;(nxtop_stack[nxtop_count].end_lsa), &amp;top_result_lsa);</div><div class="line"><a name="l08462"></a><span class="lineno"> 8462</span>&#160;        }</div><div class="line"><a name="l08463"></a><span class="lineno"> 8463</span>&#160;</div><div class="line"><a name="l08464"></a><span class="lineno"> 8464</span>&#160;          nxtop_count++;</div><div class="line"><a name="l08465"></a><span class="lineno"> 8465</span>&#160;</div><div class="line"><a name="l08466"></a><span class="lineno"> 8466</span>&#160;          <a class="code" href="storage__common_8h.html#a4c9bc15296fe6728cf0351726cc6ad09">LSA_COPY</a> (&amp;prev_last_parent_lsa, &amp;top_result-&gt;<a class="code" href="structlog__rec__sysop__end.html#ac228866b1723dfd1165550c037fdc3aa">lastparent_lsa</a>);</div><div class="line"><a name="l08467"></a><span class="lineno"> 8467</span>&#160;        }</div><div class="line"><a name="l08468"></a><span class="lineno"> 8468</span>&#160;</div><div class="line"><a name="l08469"></a><span class="lineno"> 8469</span>&#160;      <a class="code" href="storage__common_8h.html#a4c9bc15296fe6728cf0351726cc6ad09">LSA_COPY</a> (&amp;top_result_lsa, &amp;top_result-&gt;<a class="code" href="structlog__rec__sysop__end.html#aee18ec7d007cfa72f33ca61fcb93e7b3">prv_topresult_lsa</a>);</div><div class="line"><a name="l08470"></a><span class="lineno"> 8470</span>&#160;    }</div><div class="line"><a name="l08471"></a><span class="lineno"> 8471</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l08472"></a><span class="lineno"> 8472</span>&#160;    {</div><div class="line"><a name="l08473"></a><span class="lineno"> 8473</span>&#160;      <span class="keywordflow">if</span> (nxtop_stack != *out_nxtop_range_stack)</div><div class="line"><a name="l08474"></a><span class="lineno"> 8474</span>&#160;        {</div><div class="line"><a name="l08475"></a><span class="lineno"> 8475</span>&#160;          <a class="code" href="memory__alloc_8h.html#a794b5a73adc277837a0c4d12da4af5af">free_and_init</a> (nxtop_stack);</div><div class="line"><a name="l08476"></a><span class="lineno"> 8476</span>&#160;        }</div><div class="line"><a name="l08477"></a><span class="lineno"> 8477</span>&#160;      <a class="code" href="log__impl_8h.html#a8e111eafc27b6e1383fbd0ee812b1167">logpb_fatal_error</a> (thread_p, <span class="keyword">true</span>, <a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <span class="stringliteral">&quot;log_get_next_nested_top&quot;</span>);</div><div class="line"><a name="l08478"></a><span class="lineno"> 8478</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l08479"></a><span class="lineno"> 8479</span>&#160;    }</div><div class="line"><a name="l08480"></a><span class="lineno"> 8480</span>&#160;    }</div><div class="line"><a name="l08481"></a><span class="lineno"> 8481</span>&#160;  <span class="keywordflow">while</span> (top_result_lsa.<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a> != <a class="code" href="storage__common_8h.html#a7ed60eef43941f46fadae895f63ee033">NULL_PAGEID</a> &amp;&amp; <a class="code" href="storage__common_8h.html#a467739272b1ee74686bae4be2354197a">LSA_GT</a> (&amp;top_result_lsa, start_postpone_lsa));</div><div class="line"><a name="l08482"></a><span class="lineno"> 8482</span>&#160;</div><div class="line"><a name="l08483"></a><span class="lineno"> 8483</span>&#160;  *out_nxtop_range_stack = nxtop_stack;</div><div class="line"><a name="l08484"></a><span class="lineno"> 8484</span>&#160;</div><div class="line"><a name="l08485"></a><span class="lineno"> 8485</span>&#160;  <span class="keywordflow">return</span> nxtop_count;</div><div class="line"><a name="l08486"></a><span class="lineno"> 8486</span>&#160;}</div><div class="line"><a name="l08487"></a><span class="lineno"> 8487</span>&#160;</div><div class="line"><a name="l08488"></a><span class="lineno"> 8488</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l08489"></a><span class="lineno"> 8489</span>&#160;<span class="comment"> * log_tran_do_postpone () - do postpone for transaction.</span></div><div class="line"><a name="l08490"></a><span class="lineno"> 8490</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l08491"></a><span class="lineno"> 8491</span>&#160;<span class="comment"> * return        : void</span></div><div class="line"><a name="l08492"></a><span class="lineno"> 8492</span>&#160;<span class="comment"> * thread_p (in) : thread entry</span></div><div class="line"><a name="l08493"></a><span class="lineno"> 8493</span>&#160;<span class="comment"> * tdes (in)     : transaction descriptor</span></div><div class="line"><a name="l08494"></a><span class="lineno"> 8494</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l08495"></a><span class="lineno"> 8495</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div><div class="line"><a name="l08496"></a><span class="lineno"> 8496</span>&#160;log_tran_do_postpone (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="structlog__tdes.html">LOG_TDES</a> * tdes)</div><div class="line"><a name="l08497"></a><span class="lineno"> 8497</span>&#160;{</div><div class="line"><a name="l08498"></a><span class="lineno"> 8498</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="storage__common_8h.html#a26dd766712df5b5c4fcd158f571a75e4">LSA_ISNULL</a> (&amp;tdes-&gt;<a class="code" href="structlog__tdes.html#aef11834afdfbe3e8bd7f530ec269b327">posp_nxlsa</a>))</div><div class="line"><a name="l08499"></a><span class="lineno"> 8499</span>&#160;    {</div><div class="line"><a name="l08500"></a><span class="lineno"> 8500</span>&#160;      <span class="comment">/* nothing to do */</span></div><div class="line"><a name="l08501"></a><span class="lineno"> 8501</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l08502"></a><span class="lineno"> 8502</span>&#160;    }</div><div class="line"><a name="l08503"></a><span class="lineno"> 8503</span>&#160;</div><div class="line"><a name="l08504"></a><span class="lineno"> 8504</span>&#160;  <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (tdes-&gt;<a class="code" href="structlog__tdes.html#a97c1d42917ab4d08ffe3194fc7233018">topops</a>.<a class="code" href="structlog__topops__stack.html#a5e509dcc15d89abc0c6ba486af6dba4d">last</a> &lt; 0);</div><div class="line"><a name="l08505"></a><span class="lineno"> 8505</span>&#160;</div><div class="line"><a name="l08506"></a><span class="lineno"> 8506</span>&#160;  log_append_commit_postpone (thread_p, tdes, &amp;tdes-&gt;<a class="code" href="structlog__tdes.html#aef11834afdfbe3e8bd7f530ec269b327">posp_nxlsa</a>);</div><div class="line"><a name="l08507"></a><span class="lineno"> 8507</span>&#160;  <a class="code" href="log__manager_8c.html#aac5e93bab6adf7b42b70451c7c1753b7">log_do_postpone</a> (thread_p, tdes, &amp;tdes-&gt;<a class="code" href="structlog__tdes.html#aef11834afdfbe3e8bd7f530ec269b327">posp_nxlsa</a>);</div><div class="line"><a name="l08508"></a><span class="lineno"> 8508</span>&#160;}</div><div class="line"><a name="l08509"></a><span class="lineno"> 8509</span>&#160;</div><div class="line"><a name="l08510"></a><span class="lineno"> 8510</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l08511"></a><span class="lineno"> 8511</span>&#160;<span class="comment"> * log_sysop_do_postpone () - do postpone for system operation</span></div><div class="line"><a name="l08512"></a><span class="lineno"> 8512</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l08513"></a><span class="lineno"> 8513</span>&#160;<span class="comment"> * return         : void</span></div><div class="line"><a name="l08514"></a><span class="lineno"> 8514</span>&#160;<span class="comment"> * thread_p (in)  : thread entry</span></div><div class="line"><a name="l08515"></a><span class="lineno"> 8515</span>&#160;<span class="comment"> * tdes (in)      : transaction descriptor</span></div><div class="line"><a name="l08516"></a><span class="lineno"> 8516</span>&#160;<span class="comment"> * sysop_end (in) : system end op log record</span></div><div class="line"><a name="l08517"></a><span class="lineno"> 8517</span>&#160;<span class="comment"> * data_size (in) : data size (for logical undo)</span></div><div class="line"><a name="l08518"></a><span class="lineno"> 8518</span>&#160;<span class="comment"> * data (in)      : data (for logical undo)</span></div><div class="line"><a name="l08519"></a><span class="lineno"> 8519</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l08520"></a><span class="lineno"> 8520</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div><div class="line"><a name="l08521"></a><span class="lineno"> 8521</span>&#160;log_sysop_do_postpone (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="structlog__tdes.html">LOG_TDES</a> * tdes, <a class="code" href="structlog__rec__sysop__end.html">LOG_REC_SYSOP_END</a> * sysop_end, <span class="keywordtype">int</span> data_size,</div><div class="line"><a name="l08522"></a><span class="lineno"> 8522</span>&#160;               <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="namespacestatdump__to__csv.html#aedcb70fde9c0b07a0732db70deeec616">data</a>)</div><div class="line"><a name="l08523"></a><span class="lineno"> 8523</span>&#160;{</div><div class="line"><a name="l08524"></a><span class="lineno"> 8524</span>&#160;  <a class="code" href="structlog__rec__sysop__start__postpone.html">LOG_REC_SYSOP_START_POSTPONE</a> sysop_start_postpone;</div><div class="line"><a name="l08525"></a><span class="lineno"> 8525</span>&#160;  <a class="code" href="log__comm_8h.html#a3c0be9b9f104459ab90ee18af95c4b3e">TRAN_STATE</a> save_state = tdes-&gt;<a class="code" href="structlog__tdes.html#ad924146690490b840ef5c3f65c3a5a6c">state</a>;</div><div class="line"><a name="l08526"></a><span class="lineno"> 8526</span>&#160;</div><div class="line"><a name="l08527"></a><span class="lineno"> 8527</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="storage__common_8h.html#a26dd766712df5b5c4fcd158f571a75e4">LSA_ISNULL</a> (<a class="code" href="log__manager_8c.html#a0f43301a77dc33dd0c1a66f9d1ec9aac">LOG_TDES_LAST_SYSOP_POSP_LSA</a> (tdes)))</div><div class="line"><a name="l08528"></a><span class="lineno"> 8528</span>&#160;    {</div><div class="line"><a name="l08529"></a><span class="lineno"> 8529</span>&#160;      <span class="comment">/* nothing to postpone */</span></div><div class="line"><a name="l08530"></a><span class="lineno"> 8530</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l08531"></a><span class="lineno"> 8531</span>&#160;    }</div><div class="line"><a name="l08532"></a><span class="lineno"> 8532</span>&#160;</div><div class="line"><a name="l08533"></a><span class="lineno"> 8533</span>&#160;  <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (sysop_end != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l08534"></a><span class="lineno"> 8534</span>&#160;  <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (sysop_end-&gt;<a class="code" href="structlog__rec__sysop__end.html#a3ea9d3ebfe5a0ed547670f1409fb385f">type</a> != <a class="code" href="log__impl_8h.html#a24797b2fe67e0ec8631d7a92fbef25c9a9530c67a9b21ab7a54d7c906f900a247">LOG_SYSOP_END_ABORT</a>);</div><div class="line"><a name="l08535"></a><span class="lineno"> 8535</span>&#160;  <span class="comment">/* we cannot have TRAN_UNACTIVE_TOPOPE_COMMITTED_WITH_POSTPONE inside TRAN_UNACTIVE_TOPOPE_COMMITTED_WITH_POSTPONE */</span></div><div class="line"><a name="l08536"></a><span class="lineno"> 8536</span>&#160;  <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (tdes-&gt;<a class="code" href="structlog__tdes.html#ad924146690490b840ef5c3f65c3a5a6c">state</a> != <a class="code" href="log__comm_8h.html#a3c0be9b9f104459ab90ee18af95c4b3ea04e4c5688a6020948963e1e0fffe9c15">TRAN_UNACTIVE_TOPOPE_COMMITTED_WITH_POSTPONE</a>);</div><div class="line"><a name="l08537"></a><span class="lineno"> 8537</span>&#160;</div><div class="line"><a name="l08538"></a><span class="lineno"> 8538</span>&#160;  sysop_start_postpone.<a class="code" href="structlog__rec__sysop__start__postpone.html#a75ba94263889a5daa036f05cb3a453dc">sysop_end</a> = *sysop_end;</div><div class="line"><a name="l08539"></a><span class="lineno"> 8539</span>&#160;  sysop_start_postpone.<a class="code" href="structlog__rec__sysop__start__postpone.html#a7a4784f826dbfb985de3cdeafce2a202">posp_lsa</a> = *<a class="code" href="log__manager_8c.html#a0f43301a77dc33dd0c1a66f9d1ec9aac">LOG_TDES_LAST_SYSOP_POSP_LSA</a> (tdes);</div><div class="line"><a name="l08540"></a><span class="lineno"> 8540</span>&#160;  log_append_sysop_start_postpone (thread_p, tdes, &amp;sysop_start_postpone, data_size, <a class="code" href="namespacestatdump__to__csv.html#aedcb70fde9c0b07a0732db70deeec616">data</a>);</div><div class="line"><a name="l08541"></a><span class="lineno"> 8541</span>&#160;</div><div class="line"><a name="l08542"></a><span class="lineno"> 8542</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="vacuum_8h.html#ab0e1deb8da1aa663aa073b0ce78606a2">VACUUM_IS_THREAD_VACUUM</a> (thread_p)</div><div class="line"><a name="l08543"></a><span class="lineno"> 8543</span>&#160;      &amp;&amp; <a class="code" href="vacuum_8c.html#a51dbaefecbd3e7004cc239b63a47dadd">vacuum_do_postpone_from_cache</a> (thread_p, <a class="code" href="log__manager_8c.html#a0f43301a77dc33dd0c1a66f9d1ec9aac">LOG_TDES_LAST_SYSOP_POSP_LSA</a> (tdes)))</div><div class="line"><a name="l08544"></a><span class="lineno"> 8544</span>&#160;    {</div><div class="line"><a name="l08545"></a><span class="lineno"> 8545</span>&#160;      <span class="comment">/* Do postpone was run from cached postpone entries. */</span></div><div class="line"><a name="l08546"></a><span class="lineno"> 8546</span>&#160;      tdes-&gt;<a class="code" href="structlog__tdes.html#ad924146690490b840ef5c3f65c3a5a6c">state</a> = save_state;</div><div class="line"><a name="l08547"></a><span class="lineno"> 8547</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l08548"></a><span class="lineno"> 8548</span>&#160;    }</div><div class="line"><a name="l08549"></a><span class="lineno"> 8549</span>&#160;</div><div class="line"><a name="l08550"></a><span class="lineno"> 8550</span>&#160;  <a class="code" href="log__manager_8c.html#aac5e93bab6adf7b42b70451c7c1753b7">log_do_postpone</a> (thread_p, tdes, <a class="code" href="log__manager_8c.html#a0f43301a77dc33dd0c1a66f9d1ec9aac">LOG_TDES_LAST_SYSOP_POSP_LSA</a> (tdes));</div><div class="line"><a name="l08551"></a><span class="lineno"> 8551</span>&#160;</div><div class="line"><a name="l08552"></a><span class="lineno"> 8552</span>&#160;  tdes-&gt;<a class="code" href="structlog__tdes.html#ad924146690490b840ef5c3f65c3a5a6c">state</a> = save_state;</div><div class="line"><a name="l08553"></a><span class="lineno"> 8553</span>&#160;}</div><div class="line"><a name="l08554"></a><span class="lineno"> 8554</span>&#160;</div><div class="line"><a name="l08555"></a><span class="lineno"> 8555</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l08556"></a><span class="lineno"> 8556</span>&#160;<span class="comment"> * log_do_postpone - Scan forward doing postpone operations of given transaction</span></div><div class="line"><a name="l08557"></a><span class="lineno"> 8557</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l08558"></a><span class="lineno"> 8558</span>&#160;<span class="comment"> * return: nothing</span></div><div class="line"><a name="l08559"></a><span class="lineno"> 8559</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l08560"></a><span class="lineno"> 8560</span>&#160;<span class="comment"> *   tdes(in): Transaction descriptor</span></div><div class="line"><a name="l08561"></a><span class="lineno"> 8561</span>&#160;<span class="comment"> *   start_posplsa(in): Where to start looking for postpone records</span></div><div class="line"><a name="l08562"></a><span class="lineno"> 8562</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l08563"></a><span class="lineno"> 8563</span>&#160;<span class="comment"> * NOTE: Scan the log forward doing postpone operations of given transaction. </span></div><div class="line"><a name="l08564"></a><span class="lineno"> 8564</span>&#160;<span class="comment"> *       This function is invoked after a transaction is declared committed with postpone actions.</span></div><div class="line"><a name="l08565"></a><span class="lineno"> 8565</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l08566"></a><span class="lineno"> 8566</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l08567"></a><span class="lineno"><a class="line" href="log__manager_8h.html#a84c22f7c022059f1304946e48ef83025"> 8567</a></span>&#160;<a class="code" href="log__manager_8c.html#aac5e93bab6adf7b42b70451c7c1753b7">log_do_postpone</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="structlog__tdes.html">LOG_TDES</a> * tdes, <a class="code" href="structlog__lsa.html">LOG_LSA</a> * start_postpone_lsa)</div><div class="line"><a name="l08568"></a><span class="lineno"> 8568</span>&#160;{</div><div class="line"><a name="l08569"></a><span class="lineno"> 8569</span>&#160;  <a class="code" href="structlog__lsa.html">LOG_LSA</a> end_postpone_lsa; <span class="comment">/* The last postpone record of transaction cannot be after this address */</span></div><div class="line"><a name="l08570"></a><span class="lineno"> 8570</span>&#160;  <a class="code" href="structlog__lsa.html">LOG_LSA</a> start_seek_lsa;   <span class="comment">/* start looking for postpone records at this address */</span></div><div class="line"><a name="l08571"></a><span class="lineno"> 8571</span>&#160;  <a class="code" href="structlog__lsa.html">LOG_LSA</a> *end_seek_lsa;    <span class="comment">/* Stop looking for postpone records at this address */</span></div><div class="line"><a name="l08572"></a><span class="lineno"> 8572</span>&#160;  <a class="code" href="structlog__lsa.html">LOG_LSA</a> next_start_seek_lsa;  <span class="comment">/* Next address to look for postpone records. Usually the end of a top system</span></div><div class="line"><a name="l08573"></a><span class="lineno"> 8573</span>&#160;<span class="comment">                 * operation. */</span></div><div class="line"><a name="l08574"></a><span class="lineno"> 8574</span>&#160;  <a class="code" href="structlog__lsa.html">LOG_LSA</a> <a class="code" href="structlog__lsa.html">log_lsa</a>;</div><div class="line"><a name="l08575"></a><span class="lineno"> 8575</span>&#160;  <a class="code" href="structlog__lsa.html">LOG_LSA</a> forward_lsa;</div><div class="line"><a name="l08576"></a><span class="lineno"> 8576</span>&#160;</div><div class="line"><a name="l08577"></a><span class="lineno"> 8577</span>&#160;  <span class="keywordtype">char</span> log_pgbuf[<a class="code" href="storage__common_8h.html#a0a3c7db68a92df0d34666257bb0f17dd">IO_MAX_PAGE_SIZE</a> + <a class="code" href="memory__alloc_8h.html#a81d7e4971ffc775a379eeb4c65fa30f8">MAX_ALIGNMENT</a>];</div><div class="line"><a name="l08578"></a><span class="lineno"> 8578</span>&#160;  <span class="keywordtype">char</span> *aligned_log_pgbuf;</div><div class="line"><a name="l08579"></a><span class="lineno"> 8579</span>&#160;  <a class="code" href="structlog__page.html">LOG_PAGE</a> *log_pgptr = <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l08580"></a><span class="lineno"> 8580</span>&#160;  <a class="code" href="structlog__rec__header.html">LOG_RECORD_HEADER</a> *log_rec;</div><div class="line"><a name="l08581"></a><span class="lineno"> 8581</span>&#160;  <span class="keywordtype">bool</span> isdone;</div><div class="line"><a name="l08582"></a><span class="lineno"> 8582</span>&#160;</div><div class="line"><a name="l08583"></a><span class="lineno"> 8583</span>&#160;  <a class="code" href="structlog__topop__range.html">LOG_TOPOP_RANGE</a> nxtop_array[<a class="code" href="log__manager_8h.html#ae5eb3ef7758cbee166b922bd5541dfae">LOG_TOPOP_STACK_INIT_SIZE</a>];</div><div class="line"><a name="l08584"></a><span class="lineno"> 8584</span>&#160;  <a class="code" href="structlog__topop__range.html">LOG_TOPOP_RANGE</a> *nxtop_stack = <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l08585"></a><span class="lineno"> 8585</span>&#160;  <a class="code" href="structlog__topop__range.html">LOG_TOPOP_RANGE</a> *nxtop_range = <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l08586"></a><span class="lineno"> 8586</span>&#160;  <span class="keywordtype">int</span> nxtop_count = 0;</div><div class="line"><a name="l08587"></a><span class="lineno"> 8587</span>&#160;</div><div class="line"><a name="l08588"></a><span class="lineno"> 8588</span>&#160;  <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (!<a class="code" href="storage__common_8h.html#a26dd766712df5b5c4fcd158f571a75e4">LSA_ISNULL</a> (start_postpone_lsa));</div><div class="line"><a name="l08589"></a><span class="lineno"> 8589</span>&#160;  <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (tdes-&gt;<a class="code" href="structlog__tdes.html#ad924146690490b840ef5c3f65c3a5a6c">state</a> == <a class="code" href="log__comm_8h.html#a3c0be9b9f104459ab90ee18af95c4b3ea04e4c5688a6020948963e1e0fffe9c15">TRAN_UNACTIVE_TOPOPE_COMMITTED_WITH_POSTPONE</a> || tdes-&gt;<a class="code" href="structlog__tdes.html#ad924146690490b840ef5c3f65c3a5a6c">state</a> == <a class="code" href="log__comm_8h.html#a3c0be9b9f104459ab90ee18af95c4b3ea10373ab725a87c9ac3126b85a1400846">TRAN_UNACTIVE_WILL_COMMIT</a></div><div class="line"><a name="l08590"></a><span class="lineno"> 8590</span>&#160;      || tdes-&gt;<a class="code" href="structlog__tdes.html#ad924146690490b840ef5c3f65c3a5a6c">state</a> == <a class="code" href="log__comm_8h.html#a3c0be9b9f104459ab90ee18af95c4b3eaef0e7c96ca3684ce2422a33afe8f35fc">TRAN_UNACTIVE_COMMITTED_WITH_POSTPONE</a>);</div><div class="line"><a name="l08591"></a><span class="lineno"> 8591</span>&#160;</div><div class="line"><a name="l08592"></a><span class="lineno"> 8592</span>&#160;  aligned_log_pgbuf = <a class="code" href="memory__alloc_8h.html#a79781c0dbfdd9510d275cba54f1f384f">PTR_ALIGN</a> (log_pgbuf, <a class="code" href="memory__alloc_8h.html#a81d7e4971ffc775a379eeb4c65fa30f8">MAX_ALIGNMENT</a>);</div><div class="line"><a name="l08593"></a><span class="lineno"> 8593</span>&#160;  log_pgptr = (<a class="code" href="structlog__page.html">LOG_PAGE</a> *) aligned_log_pgbuf;</div><div class="line"><a name="l08594"></a><span class="lineno"> 8594</span>&#160;</div><div class="line"><a name="l08595"></a><span class="lineno"> 8595</span>&#160;  <a class="code" href="storage__common_8h.html#a4c9bc15296fe6728cf0351726cc6ad09">LSA_COPY</a> (&amp;end_postpone_lsa, &amp;tdes-&gt;<a class="code" href="structlog__tdes.html#a5b128a08476a5b499cf82e3163e6d62b">tail_lsa</a>);</div><div class="line"><a name="l08596"></a><span class="lineno"> 8596</span>&#160;  <a class="code" href="storage__common_8h.html#a4c9bc15296fe6728cf0351726cc6ad09">LSA_COPY</a> (&amp;next_start_seek_lsa, start_postpone_lsa);</div><div class="line"><a name="l08597"></a><span class="lineno"> 8597</span>&#160;</div><div class="line"><a name="l08598"></a><span class="lineno"> 8598</span>&#160;  nxtop_stack = nxtop_array;</div><div class="line"><a name="l08599"></a><span class="lineno"> 8599</span>&#160;  nxtop_count = <a class="code" href="log__manager_8c.html#aac95e62fd0455db6b8c123bc559a8acd">log_get_next_nested_top</a> (thread_p, tdes, start_postpone_lsa, &amp;nxtop_stack);</div><div class="line"><a name="l08600"></a><span class="lineno"> 8600</span>&#160;</div><div class="line"><a name="l08601"></a><span class="lineno"> 8601</span>&#160;  <span class="keywordflow">while</span> (!<a class="code" href="storage__common_8h.html#a26dd766712df5b5c4fcd158f571a75e4">LSA_ISNULL</a> (&amp;next_start_seek_lsa))</div><div class="line"><a name="l08602"></a><span class="lineno"> 8602</span>&#160;    {</div><div class="line"><a name="l08603"></a><span class="lineno"> 8603</span>&#160;      <a class="code" href="storage__common_8h.html#a4c9bc15296fe6728cf0351726cc6ad09">LSA_COPY</a> (&amp;start_seek_lsa, &amp;next_start_seek_lsa);</div><div class="line"><a name="l08604"></a><span class="lineno"> 8604</span>&#160;</div><div class="line"><a name="l08605"></a><span class="lineno"> 8605</span>&#160;      <span class="keywordflow">if</span> (nxtop_count &gt; 0)</div><div class="line"><a name="l08606"></a><span class="lineno"> 8606</span>&#160;    {</div><div class="line"><a name="l08607"></a><span class="lineno"> 8607</span>&#160;      nxtop_count--;</div><div class="line"><a name="l08608"></a><span class="lineno"> 8608</span>&#160;      nxtop_range = &amp;(nxtop_stack[nxtop_count]);</div><div class="line"><a name="l08609"></a><span class="lineno"> 8609</span>&#160;</div><div class="line"><a name="l08610"></a><span class="lineno"> 8610</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="storage__common_8h.html#a478797f01d6a6ad24c0203c09a639db2">LSA_LT</a> (&amp;start_seek_lsa, &amp;(nxtop_range-&gt;<a class="code" href="structlog__topop__range.html#ad4fb3b4332309daa2b923b17de58498c">start_lsa</a>)))</div><div class="line"><a name="l08611"></a><span class="lineno"> 8611</span>&#160;        {</div><div class="line"><a name="l08612"></a><span class="lineno"> 8612</span>&#160;          end_seek_lsa = &amp;(nxtop_range-&gt;<a class="code" href="structlog__topop__range.html#ad4fb3b4332309daa2b923b17de58498c">start_lsa</a>);</div><div class="line"><a name="l08613"></a><span class="lineno"> 8613</span>&#160;          <a class="code" href="storage__common_8h.html#a4c9bc15296fe6728cf0351726cc6ad09">LSA_COPY</a> (&amp;next_start_seek_lsa, &amp;(nxtop_range-&gt;<a class="code" href="structlog__topop__range.html#a6b28d3117f59854fe142175bf94cb878">end_lsa</a>));</div><div class="line"><a name="l08614"></a><span class="lineno"> 8614</span>&#160;        }</div><div class="line"><a name="l08615"></a><span class="lineno"> 8615</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="storage__common_8h.html#aa8d8ea0049b43e3faf4c471641af5f98">LSA_EQ</a> (&amp;start_seek_lsa, &amp;(nxtop_range-&gt;<a class="code" href="structlog__topop__range.html#a6b28d3117f59854fe142175bf94cb878">end_lsa</a>)))</div><div class="line"><a name="l08616"></a><span class="lineno"> 8616</span>&#160;        {</div><div class="line"><a name="l08617"></a><span class="lineno"> 8617</span>&#160;          end_seek_lsa = &amp;end_postpone_lsa;</div><div class="line"><a name="l08618"></a><span class="lineno"> 8618</span>&#160;          <a class="code" href="storage__common_8h.html#a6a4baec606189dd320678e8f412ca957">LSA_SET_NULL</a> (&amp;next_start_seek_lsa);</div><div class="line"><a name="l08619"></a><span class="lineno"> 8619</span>&#160;        }</div><div class="line"><a name="l08620"></a><span class="lineno"> 8620</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l08621"></a><span class="lineno"> 8621</span>&#160;        {</div><div class="line"><a name="l08622"></a><span class="lineno"> 8622</span>&#160;          <a class="code" href="storage__common_8h.html#a4c9bc15296fe6728cf0351726cc6ad09">LSA_COPY</a> (&amp;next_start_seek_lsa, &amp;(nxtop_range-&gt;<a class="code" href="structlog__topop__range.html#a6b28d3117f59854fe142175bf94cb878">end_lsa</a>));</div><div class="line"><a name="l08623"></a><span class="lineno"> 8623</span>&#160;          <span class="keywordflow">continue</span>;</div><div class="line"><a name="l08624"></a><span class="lineno"> 8624</span>&#160;        }</div><div class="line"><a name="l08625"></a><span class="lineno"> 8625</span>&#160;    }</div><div class="line"><a name="l08626"></a><span class="lineno"> 8626</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l08627"></a><span class="lineno"> 8627</span>&#160;    {</div><div class="line"><a name="l08628"></a><span class="lineno"> 8628</span>&#160;      end_seek_lsa = &amp;end_postpone_lsa;</div><div class="line"><a name="l08629"></a><span class="lineno"> 8629</span>&#160;      <a class="code" href="storage__common_8h.html#a6a4baec606189dd320678e8f412ca957">LSA_SET_NULL</a> (&amp;next_start_seek_lsa);</div><div class="line"><a name="l08630"></a><span class="lineno"> 8630</span>&#160;    }</div><div class="line"><a name="l08631"></a><span class="lineno"> 8631</span>&#160;</div><div class="line"><a name="l08632"></a><span class="lineno"> 8632</span>&#160;      <span class="comment">/* </span></div><div class="line"><a name="l08633"></a><span class="lineno"> 8633</span>&#160;<span class="comment">       * Start doing postpone operation for this range</span></div><div class="line"><a name="l08634"></a><span class="lineno"> 8634</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l08635"></a><span class="lineno"> 8635</span>&#160;</div><div class="line"><a name="l08636"></a><span class="lineno"> 8636</span>&#160;      <a class="code" href="storage__common_8h.html#a4c9bc15296fe6728cf0351726cc6ad09">LSA_COPY</a> (&amp;forward_lsa, &amp;start_seek_lsa);</div><div class="line"><a name="l08637"></a><span class="lineno"> 8637</span>&#160;</div><div class="line"><a name="l08638"></a><span class="lineno"> 8638</span>&#160;      isdone = <span class="keyword">false</span>;</div><div class="line"><a name="l08639"></a><span class="lineno"> 8639</span>&#160;      <span class="keywordflow">while</span> (!<a class="code" href="storage__common_8h.html#a26dd766712df5b5c4fcd158f571a75e4">LSA_ISNULL</a> (&amp;forward_lsa) &amp;&amp; !isdone)</div><div class="line"><a name="l08640"></a><span class="lineno"> 8640</span>&#160;    {</div><div class="line"><a name="l08641"></a><span class="lineno"> 8641</span>&#160;      <a class="code" href="structlog__lsa.html">LOG_LSA</a> fetch_lsa;</div><div class="line"><a name="l08642"></a><span class="lineno"> 8642</span>&#160;</div><div class="line"><a name="l08643"></a><span class="lineno"> 8643</span>&#160;      <span class="comment">/* Fetch the page where the postpone LSA record is located */</span></div><div class="line"><a name="l08644"></a><span class="lineno"> 8644</span>&#160;      <a class="code" href="storage__common_8h.html#a4c9bc15296fe6728cf0351726cc6ad09">LSA_COPY</a> (&amp;<a class="code" href="structlog__lsa.html">log_lsa</a>, &amp;forward_lsa);</div><div class="line"><a name="l08645"></a><span class="lineno"> 8645</span>&#160;      fetch_lsa.<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a> = <a class="code" href="structlog__lsa.html">log_lsa</a>.<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a>;</div><div class="line"><a name="l08646"></a><span class="lineno"> 8646</span>&#160;      fetch_lsa.<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a> = <a class="code" href="storage__common_8h.html#a1a7b7663aee8b9e8b1df6b1fbd5a88b9">LOG_PAGESIZE</a>;</div><div class="line"><a name="l08647"></a><span class="lineno"> 8647</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="log__impl_8h.html#ac67cba94ac6c10da3ae0ab474155ea1a">logpb_fetch_page</a> (thread_p, &amp;fetch_lsa, <a class="code" href="log__impl_8h.html#ab33fe5f69028f102e9910294e97ccd6babc4379db94a7ff5ff8491988a7c28bc1">LOG_CS_FORCE_USE</a>, log_pgptr) != <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>)</div><div class="line"><a name="l08648"></a><span class="lineno"> 8648</span>&#160;        {</div><div class="line"><a name="l08649"></a><span class="lineno"> 8649</span>&#160;          <a class="code" href="log__impl_8h.html#a8e111eafc27b6e1383fbd0ee812b1167">logpb_fatal_error</a> (thread_p, <span class="keyword">true</span>, <a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <span class="stringliteral">&quot;log_do_postpone&quot;</span>);</div><div class="line"><a name="l08650"></a><span class="lineno"> 8650</span>&#160;          <span class="keywordflow">goto</span> <a class="code" href="expat_8h.html#a013fbe20efe68dbd323a536ffdb1e2a8">end</a>;</div><div class="line"><a name="l08651"></a><span class="lineno"> 8651</span>&#160;        }</div><div class="line"><a name="l08652"></a><span class="lineno"> 8652</span>&#160;</div><div class="line"><a name="l08653"></a><span class="lineno"> 8653</span>&#160;      <span class="keywordflow">while</span> (forward_lsa.<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a> == <a class="code" href="structlog__lsa.html">log_lsa</a>.<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a>)</div><div class="line"><a name="l08654"></a><span class="lineno"> 8654</span>&#160;        {</div><div class="line"><a name="l08655"></a><span class="lineno"> 8655</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="storage__common_8h.html#a467739272b1ee74686bae4be2354197a">LSA_GT</a> (&amp;forward_lsa, end_seek_lsa))</div><div class="line"><a name="l08656"></a><span class="lineno"> 8656</span>&#160;        {</div><div class="line"><a name="l08657"></a><span class="lineno"> 8657</span>&#160;          <span class="comment">/* Finish at this point */</span></div><div class="line"><a name="l08658"></a><span class="lineno"> 8658</span>&#160;          isdone = <span class="keyword">true</span>;</div><div class="line"><a name="l08659"></a><span class="lineno"> 8659</span>&#160;          <span class="keywordflow">break</span>;</div><div class="line"><a name="l08660"></a><span class="lineno"> 8660</span>&#160;        }</div><div class="line"><a name="l08661"></a><span class="lineno"> 8661</span>&#160;</div><div class="line"><a name="l08662"></a><span class="lineno"> 8662</span>&#160;          <span class="comment">/* </span></div><div class="line"><a name="l08663"></a><span class="lineno"> 8663</span>&#160;<span class="comment">           * If an offset is missing, it is because we archive an incomplete log record.</span></div><div class="line"><a name="l08664"></a><span class="lineno"> 8664</span>&#160;<span class="comment">           * This log_record was completed later.</span></div><div class="line"><a name="l08665"></a><span class="lineno"> 8665</span>&#160;<span class="comment">           * Thus, we have to find the offset by searching for the next log_record in the page.</span></div><div class="line"><a name="l08666"></a><span class="lineno"> 8666</span>&#160;<span class="comment">           */</span></div><div class="line"><a name="l08667"></a><span class="lineno"> 8667</span>&#160;          <span class="keywordflow">if</span> (forward_lsa.<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a> == <a class="code" href="storage__common_8h.html#a5b0ca3ea530f289fa3f19921e5b0faf3">NULL_OFFSET</a>)</div><div class="line"><a name="l08668"></a><span class="lineno"> 8668</span>&#160;        {</div><div class="line"><a name="l08669"></a><span class="lineno"> 8669</span>&#160;          forward_lsa.<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a> = log_pgptr-&gt;<a class="code" href="structlog__page.html#a52640d2c65b2d7b95a330a670646e8f9">hdr</a>.<a class="code" href="structlog__hdrpage.html#a581cc8236b70bf22034b8006e44570d5">offset</a>;</div><div class="line"><a name="l08670"></a><span class="lineno"> 8670</span>&#160;          <span class="keywordflow">if</span> (forward_lsa.<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a> == <a class="code" href="storage__common_8h.html#a5b0ca3ea530f289fa3f19921e5b0faf3">NULL_OFFSET</a>)</div><div class="line"><a name="l08671"></a><span class="lineno"> 8671</span>&#160;            {</div><div class="line"><a name="l08672"></a><span class="lineno"> 8672</span>&#160;              <span class="comment">/* Continue at next pageid */</span></div><div class="line"><a name="l08673"></a><span class="lineno"> 8673</span>&#160;              <span class="keywordflow">if</span> (<a class="code" href="log__impl_8h.html#aa2a6e20070602d985015f39d448f8125">logpb_is_page_in_archive</a> (<a class="code" href="structlog__lsa.html">log_lsa</a>.<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a>))</div><div class="line"><a name="l08674"></a><span class="lineno"> 8674</span>&#160;            {</div><div class="line"><a name="l08675"></a><span class="lineno"> 8675</span>&#160;              forward_lsa.<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a> = <a class="code" href="structlog__lsa.html">log_lsa</a>.<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a> + 1;</div><div class="line"><a name="l08676"></a><span class="lineno"> 8676</span>&#160;            }</div><div class="line"><a name="l08677"></a><span class="lineno"> 8677</span>&#160;              <span class="keywordflow">else</span></div><div class="line"><a name="l08678"></a><span class="lineno"> 8678</span>&#160;            {</div><div class="line"><a name="l08679"></a><span class="lineno"> 8679</span>&#160;              forward_lsa.<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a> = <a class="code" href="storage__common_8h.html#a7ed60eef43941f46fadae895f63ee033">NULL_PAGEID</a>;</div><div class="line"><a name="l08680"></a><span class="lineno"> 8680</span>&#160;            }</div><div class="line"><a name="l08681"></a><span class="lineno"> 8681</span>&#160;              <span class="keywordflow">continue</span>;</div><div class="line"><a name="l08682"></a><span class="lineno"> 8682</span>&#160;            }</div><div class="line"><a name="l08683"></a><span class="lineno"> 8683</span>&#160;        }</div><div class="line"><a name="l08684"></a><span class="lineno"> 8684</span>&#160;</div><div class="line"><a name="l08685"></a><span class="lineno"> 8685</span>&#160;          <span class="comment">/* Find the postpone log record to execute */</span></div><div class="line"><a name="l08686"></a><span class="lineno"> 8686</span>&#160;          <a class="code" href="structlog__lsa.html">log_lsa</a>.<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a> = forward_lsa.<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a>;</div><div class="line"><a name="l08687"></a><span class="lineno"> 8687</span>&#160;          log_rec = <a class="code" href="log__impl_8h.html#ae37437431a8ea417a8e768ed5fa8f5f6">LOG_GET_LOG_RECORD_HEADER</a> (log_pgptr, &amp;<a class="code" href="structlog__lsa.html">log_lsa</a>);</div><div class="line"><a name="l08688"></a><span class="lineno"> 8688</span>&#160;</div><div class="line"><a name="l08689"></a><span class="lineno"> 8689</span>&#160;          <span class="comment">/* Find the next log record in the log */</span></div><div class="line"><a name="l08690"></a><span class="lineno"> 8690</span>&#160;          <a class="code" href="storage__common_8h.html#a4c9bc15296fe6728cf0351726cc6ad09">LSA_COPY</a> (&amp;forward_lsa, &amp;log_rec-&gt;<a class="code" href="structlog__rec__header.html#ab88354b51f9cabaaace23420eec7ac7e">forw_lsa</a>);</div><div class="line"><a name="l08691"></a><span class="lineno"> 8691</span>&#160;</div><div class="line"><a name="l08692"></a><span class="lineno"> 8692</span>&#160;          <span class="keywordflow">if</span> (forward_lsa.<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a> == <a class="code" href="storage__common_8h.html#a7ed60eef43941f46fadae895f63ee033">NULL_PAGEID</a> &amp;&amp; <a class="code" href="log__impl_8h.html#aa2a6e20070602d985015f39d448f8125">logpb_is_page_in_archive</a> (<a class="code" href="structlog__lsa.html">log_lsa</a>.<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a>))</div><div class="line"><a name="l08693"></a><span class="lineno"> 8693</span>&#160;        {</div><div class="line"><a name="l08694"></a><span class="lineno"> 8694</span>&#160;          forward_lsa.<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a> = <a class="code" href="structlog__lsa.html">log_lsa</a>.<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a> + 1;</div><div class="line"><a name="l08695"></a><span class="lineno"> 8695</span>&#160;        }</div><div class="line"><a name="l08696"></a><span class="lineno"> 8696</span>&#160;</div><div class="line"><a name="l08697"></a><span class="lineno"> 8697</span>&#160;          <span class="keywordflow">if</span> (log_rec-&gt;<a class="code" href="structlog__rec__header.html#a210194ed9baf246456495d89fb411725">trid</a> == tdes-&gt;<a class="code" href="structlog__tdes.html#a3baeff284ed2167bcef74c5ef34d4f3b">trid</a>)</div><div class="line"><a name="l08698"></a><span class="lineno"> 8698</span>&#160;        {</div><div class="line"><a name="l08699"></a><span class="lineno"> 8699</span>&#160;          <span class="keywordflow">switch</span> (log_rec-&gt;<a class="code" href="structlog__rec__header.html#aa9be1266bf7fdca13a0a789dc5ae11bb">type</a>)</div><div class="line"><a name="l08700"></a><span class="lineno"> 8700</span>&#160;            {</div><div class="line"><a name="l08701"></a><span class="lineno"> 8701</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7aa0d885a58816898b0877635fc7f15716">LOG_UNDOREDO_DATA</a>:</div><div class="line"><a name="l08702"></a><span class="lineno"> 8702</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a1e8c5c5dbe12e8cc2388691db7011740">LOG_DIFF_UNDOREDO_DATA</a>:</div><div class="line"><a name="l08703"></a><span class="lineno"> 8703</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a661c01f08dbb476251ceae0d99bb5412">LOG_UNDO_DATA</a>:</div><div class="line"><a name="l08704"></a><span class="lineno"> 8704</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7ac17426d82957cd6c312341d4f5badd87">LOG_REDO_DATA</a>:</div><div class="line"><a name="l08705"></a><span class="lineno"> 8705</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7ab4e00d9048c5782ee68b646ff785f6de">LOG_MVCC_UNDOREDO_DATA</a>:</div><div class="line"><a name="l08706"></a><span class="lineno"> 8706</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7ae03e50858368a0a9e96e4cb7ce991354">LOG_MVCC_DIFF_UNDOREDO_DATA</a>:</div><div class="line"><a name="l08707"></a><span class="lineno"> 8707</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a5eb32eedc7671f3f89c1b10c3d0229c1">LOG_MVCC_UNDO_DATA</a>:</div><div class="line"><a name="l08708"></a><span class="lineno"> 8708</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a4252bfab0a4f9fbbcd7bd68ba32dea1d">LOG_MVCC_REDO_DATA</a>:</div><div class="line"><a name="l08709"></a><span class="lineno"> 8709</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a7557d9dfb53f14fd3b6eef04a165476b">LOG_DBEXTERN_REDO_DATA</a>:</div><div class="line"><a name="l08710"></a><span class="lineno"> 8710</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a59ac89fe85edd8011e84db21095290a7">LOG_RUN_POSTPONE</a>:</div><div class="line"><a name="l08711"></a><span class="lineno"> 8711</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a92e0794a329897d52f3345d13359914e">LOG_COMPENSATE</a>:</div><div class="line"><a name="l08712"></a><span class="lineno"> 8712</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7ae96755081dc4d3599f98356864dfd7e0">LOG_SAVEPOINT</a>:</div><div class="line"><a name="l08713"></a><span class="lineno"> 8713</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7ab9a91cb4efa2ad495c98d7dc7fef8ee1">LOG_DUMMY_HEAD_POSTPONE</a>:</div><div class="line"><a name="l08714"></a><span class="lineno"> 8714</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a97003f753507d5a7a65a0bf078a078f4">LOG_REPLICATION_DATA</a>:</div><div class="line"><a name="l08715"></a><span class="lineno"> 8715</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7ac9476ec323cd3909823f79ecc3938afd">LOG_REPLICATION_STATEMENT</a>:</div><div class="line"><a name="l08716"></a><span class="lineno"> 8716</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a3839799b1d15f4333e439c136a3a21ca">LOG_SYSOP_ATOMIC_START</a>:</div><div class="line"><a name="l08717"></a><span class="lineno"> 8717</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a942105cb887dd1030b0c6151087d24ac">LOG_DUMMY_HA_SERVER_STATE</a>:</div><div class="line"><a name="l08718"></a><span class="lineno"> 8718</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a3d03de268419fc962e6ca48de324a644">LOG_DUMMY_OVF_RECORD</a>:</div><div class="line"><a name="l08719"></a><span class="lineno"> 8719</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7aec133d8bc86aabdcf6dcda157999bd21">LOG_DUMMY_GENERIC</a>:</div><div class="line"><a name="l08720"></a><span class="lineno"> 8720</span>&#160;              <span class="keywordflow">break</span>;</div><div class="line"><a name="l08721"></a><span class="lineno"> 8721</span>&#160;</div><div class="line"><a name="l08722"></a><span class="lineno"> 8722</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7acf273d42fe8e9c360fb16c8c0f96c480">LOG_POSTPONE</a>:</div><div class="line"><a name="l08723"></a><span class="lineno"> 8723</span>&#160;              {</div><div class="line"><a name="l08724"></a><span class="lineno"> 8724</span>&#160;            <span class="keywordtype">int</span> mod_factor = 5000;  <span class="comment">/* 0.02% */</span></div><div class="line"><a name="l08725"></a><span class="lineno"> 8725</span>&#160;</div><div class="line"><a name="l08726"></a><span class="lineno"> 8726</span>&#160;            <a class="code" href="fault__injection_8h.html#a388a03eac9117728e2ff741e6dccde37">FI_TEST_ARG</a> (thread_p, <a class="code" href="fault__injection_8h.html#ad69d24ac236045dc719cbc6ea7b8bc77a565657e5d315f713ea6a2c2e6135ccd5">FI_TEST_LOG_MANAGER_RANDOM_EXIT_AT_RUN_POSTPONE</a>, &amp;mod_factor, 0);</div><div class="line"><a name="l08727"></a><span class="lineno"> 8727</span>&#160;              }</div><div class="line"><a name="l08728"></a><span class="lineno"> 8728</span>&#160;</div><div class="line"><a name="l08729"></a><span class="lineno"> 8729</span>&#160;              <span class="keywordflow">if</span> (log_run_postpone_op (thread_p, &amp;<a class="code" href="structlog__lsa.html">log_lsa</a>, log_pgptr) != <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>)</div><div class="line"><a name="l08730"></a><span class="lineno"> 8730</span>&#160;            {</div><div class="line"><a name="l08731"></a><span class="lineno"> 8731</span>&#160;              <span class="keywordflow">goto</span> <a class="code" href="expat_8h.html#a013fbe20efe68dbd323a536ffdb1e2a8">end</a>;</div><div class="line"><a name="l08732"></a><span class="lineno"> 8732</span>&#160;            }</div><div class="line"><a name="l08733"></a><span class="lineno"> 8733</span>&#160;</div><div class="line"><a name="l08734"></a><span class="lineno"> 8734</span>&#160;              <span class="comment">/* TODO: consider to add FI here */</span></div><div class="line"><a name="l08735"></a><span class="lineno"> 8735</span>&#160;              <span class="keywordflow">break</span>;</div><div class="line"><a name="l08736"></a><span class="lineno"> 8736</span>&#160;</div><div class="line"><a name="l08737"></a><span class="lineno"> 8737</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a40516d04f27c98062921adb5282b4933">LOG_WILL_COMMIT</a>:</div><div class="line"><a name="l08738"></a><span class="lineno"> 8738</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a6b03dd6d350881f805f7b3adeedcf10f">LOG_COMMIT_WITH_POSTPONE</a>:</div><div class="line"><a name="l08739"></a><span class="lineno"> 8739</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a198b93b13d51133e5e5d4b8e7c62f54e">LOG_SYSOP_START_POSTPONE</a>:</div><div class="line"><a name="l08740"></a><span class="lineno"> 8740</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7aa83e8becd5b186f65485f6e819e416ea">LOG_2PC_PREPARE</a>:</div><div class="line"><a name="l08741"></a><span class="lineno"> 8741</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a69f87b42501f2ccfe66922ab196102d7">LOG_2PC_START</a>:</div><div class="line"><a name="l08742"></a><span class="lineno"> 8742</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a15a1ebeb5fd50ffb5ae73b0cb26f9e7e">LOG_2PC_COMMIT_DECISION</a>:</div><div class="line"><a name="l08743"></a><span class="lineno"> 8743</span>&#160;              <span class="comment">/* This is it */</span></div><div class="line"><a name="l08744"></a><span class="lineno"> 8744</span>&#160;              <a class="code" href="storage__common_8h.html#a6a4baec606189dd320678e8f412ca957">LSA_SET_NULL</a> (&amp;forward_lsa);</div><div class="line"><a name="l08745"></a><span class="lineno"> 8745</span>&#160;              <span class="keywordflow">break</span>;</div><div class="line"><a name="l08746"></a><span class="lineno"> 8746</span>&#160;</div><div class="line"><a name="l08747"></a><span class="lineno"> 8747</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a29a7c510ffdadeb0e4c5304e6825a5ec">LOG_SYSOP_END</a>:</div><div class="line"><a name="l08748"></a><span class="lineno"> 8748</span>&#160;              <span class="keywordflow">if</span> (!<a class="code" href="storage__common_8h.html#aa8d8ea0049b43e3faf4c471641af5f98">LSA_EQ</a> (&amp;<a class="code" href="structlog__lsa.html">log_lsa</a>, &amp;start_seek_lsa))</div><div class="line"><a name="l08749"></a><span class="lineno"> 8749</span>&#160;            {</div><div class="line"><a name="l08750"></a><span class="lineno"> 8750</span>&#160;<span class="preprocessor">#if defined(CUBRID_DEBUG)</span></div><div class="line"><a name="l08751"></a><span class="lineno"> 8751</span>&#160;              <a class="code" href="error__manager_8h.html#a075eb8873354909bbe8edafa0f18f58c">er_log_debug</a> (<a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>,</div><div class="line"><a name="l08752"></a><span class="lineno"> 8752</span>&#160;                    <span class="stringliteral">&quot;log_do_postpone: SYSTEM ERROR.. Bad log_rectype = %d\n (%s).&quot;</span></div><div class="line"><a name="l08753"></a><span class="lineno"> 8753</span>&#160;                    <span class="stringliteral">&quot; Maybe BAD POSTPONE RANGE\n&quot;</span>, log_rec-&gt;<a class="code" href="structlog__rec__header.html#aa9be1266bf7fdca13a0a789dc5ae11bb">type</a>, <a class="code" href="log__manager_8c.html#a6e093782f446a5806cc9631a97eba1c3">log_to_string</a> (log_rec-&gt;<a class="code" href="structlog__rec__header.html#aa9be1266bf7fdca13a0a789dc5ae11bb">type</a>));</div><div class="line"><a name="l08754"></a><span class="lineno"> 8754</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* CUBRID_DEBUG */</span><span class="preprocessor"></span></div><div class="line"><a name="l08755"></a><span class="lineno"> 8755</span>&#160;              ; <span class="comment">/* Nothing */</span></div><div class="line"><a name="l08756"></a><span class="lineno"> 8756</span>&#160;            }</div><div class="line"><a name="l08757"></a><span class="lineno"> 8757</span>&#160;              <span class="keywordflow">break</span>;</div><div class="line"><a name="l08758"></a><span class="lineno"> 8758</span>&#160;</div><div class="line"><a name="l08759"></a><span class="lineno"> 8759</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a034d486f56b110bc31fba3b6db5dd980">LOG_END_OF_LOG</a>:</div><div class="line"><a name="l08760"></a><span class="lineno"> 8760</span>&#160;              <span class="keywordflow">if</span> (forward_lsa.<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a> == <a class="code" href="storage__common_8h.html#a7ed60eef43941f46fadae895f63ee033">NULL_PAGEID</a> &amp;&amp; <a class="code" href="log__impl_8h.html#aa2a6e20070602d985015f39d448f8125">logpb_is_page_in_archive</a> (<a class="code" href="structlog__lsa.html">log_lsa</a>.<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a>))</div><div class="line"><a name="l08761"></a><span class="lineno"> 8761</span>&#160;            {</div><div class="line"><a name="l08762"></a><span class="lineno"> 8762</span>&#160;              forward_lsa.<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a> = <a class="code" href="structlog__lsa.html">log_lsa</a>.<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a> + 1;</div><div class="line"><a name="l08763"></a><span class="lineno"> 8763</span>&#160;            }</div><div class="line"><a name="l08764"></a><span class="lineno"> 8764</span>&#160;              <span class="keywordflow">break</span>;</div><div class="line"><a name="l08765"></a><span class="lineno"> 8765</span>&#160;</div><div class="line"><a name="l08766"></a><span class="lineno"> 8766</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a1903de7cf7fa88081eb8010a667e1839">LOG_COMMIT</a>:</div><div class="line"><a name="l08767"></a><span class="lineno"> 8767</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a66f7a15b57486fb9081e733c142d35ea">LOG_ABORT</a>:</div><div class="line"><a name="l08768"></a><span class="lineno"> 8768</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a9e2aba85fbc168e57ae1744fa9da8a88">LOG_START_CHKPT</a>:</div><div class="line"><a name="l08769"></a><span class="lineno"> 8769</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a76c06d374c551ca295e0594b74c9ff19">LOG_END_CHKPT</a>:</div><div class="line"><a name="l08770"></a><span class="lineno"> 8770</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a869d94e68bfc3354ad6bd211130cf13b">LOG_2PC_ABORT_DECISION</a>:</div><div class="line"><a name="l08771"></a><span class="lineno"> 8771</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a017e6014fefb381f8583c7ccd87c4133">LOG_2PC_ABORT_INFORM_PARTICPS</a>:</div><div class="line"><a name="l08772"></a><span class="lineno"> 8772</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a1ea8bf762d53de919a4eec322ebe9a1d">LOG_2PC_COMMIT_INFORM_PARTICPS</a>:</div><div class="line"><a name="l08773"></a><span class="lineno"> 8773</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a4ab5b053c95a07cab41de19454b7663c">LOG_2PC_RECV_ACK</a>:</div><div class="line"><a name="l08774"></a><span class="lineno"> 8774</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a1ec512ba54217805936aa5afb03b3d98">LOG_DUMMY_CRASH_RECOVERY</a>:</div><div class="line"><a name="l08775"></a><span class="lineno"> 8775</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a8fc57c015374d8ecf822c5ea0f39faa0">LOG_SMALLER_LOGREC_TYPE</a>:</div><div class="line"><a name="l08776"></a><span class="lineno"> 8776</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a25bfb5a0ac528c508558bd8be6704739">LOG_LARGER_LOGREC_TYPE</a>:</div><div class="line"><a name="l08777"></a><span class="lineno"> 8777</span>&#160;            <span class="keywordflow">default</span>:</div><div class="line"><a name="l08778"></a><span class="lineno"> 8778</span>&#160;<span class="preprocessor">#if defined(CUBRID_DEBUG)</span></div><div class="line"><a name="l08779"></a><span class="lineno"> 8779</span>&#160;              <a class="code" href="error__manager_8h.html#a075eb8873354909bbe8edafa0f18f58c">er_log_debug</a> (<a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>,</div><div class="line"><a name="l08780"></a><span class="lineno"> 8780</span>&#160;                    <span class="stringliteral">&quot;log_do_postpone: SYSTEM ERROR..Bad log_rectype = %d (%s)... ignored\n&quot;</span>,</div><div class="line"><a name="l08781"></a><span class="lineno"> 8781</span>&#160;                    log_rec-&gt;<a class="code" href="structlog__rec__header.html#aa9be1266bf7fdca13a0a789dc5ae11bb">type</a>, <a class="code" href="log__manager_8c.html#a6e093782f446a5806cc9631a97eba1c3">log_to_string</a> (log_rec-&gt;<a class="code" href="structlog__rec__header.html#aa9be1266bf7fdca13a0a789dc5ae11bb">type</a>));</div><div class="line"><a name="l08782"></a><span class="lineno"> 8782</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* CUBRID_DEBUG */</span><span class="preprocessor"></span></div><div class="line"><a name="l08783"></a><span class="lineno"> 8783</span>&#160;              <span class="keywordflow">break</span>;</div><div class="line"><a name="l08784"></a><span class="lineno"> 8784</span>&#160;            }</div><div class="line"><a name="l08785"></a><span class="lineno"> 8785</span>&#160;        }</div><div class="line"><a name="l08786"></a><span class="lineno"> 8786</span>&#160;</div><div class="line"><a name="l08787"></a><span class="lineno"> 8787</span>&#160;          <span class="comment">/* </span></div><div class="line"><a name="l08788"></a><span class="lineno"> 8788</span>&#160;<span class="comment">           * We can fix the lsa.pageid in the case of log_records without forward address at this moment.</span></div><div class="line"><a name="l08789"></a><span class="lineno"> 8789</span>&#160;<span class="comment">           */</span></div><div class="line"><a name="l08790"></a><span class="lineno"> 8790</span>&#160;</div><div class="line"><a name="l08791"></a><span class="lineno"> 8791</span>&#160;          <span class="keywordflow">if</span> (forward_lsa.<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a> == <a class="code" href="storage__common_8h.html#a5b0ca3ea530f289fa3f19921e5b0faf3">NULL_OFFSET</a> &amp;&amp; forward_lsa.<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a> != <a class="code" href="storage__common_8h.html#a7ed60eef43941f46fadae895f63ee033">NULL_PAGEID</a></div><div class="line"><a name="l08792"></a><span class="lineno"> 8792</span>&#160;          &amp;&amp; forward_lsa.<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a> &lt; <a class="code" href="structlog__lsa.html">log_lsa</a>.<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a>)</div><div class="line"><a name="l08793"></a><span class="lineno"> 8793</span>&#160;        {</div><div class="line"><a name="l08794"></a><span class="lineno"> 8794</span>&#160;          forward_lsa.<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a> = <a class="code" href="structlog__lsa.html">log_lsa</a>.<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a>;</div><div class="line"><a name="l08795"></a><span class="lineno"> 8795</span>&#160;        }</div><div class="line"><a name="l08796"></a><span class="lineno"> 8796</span>&#160;        }</div><div class="line"><a name="l08797"></a><span class="lineno"> 8797</span>&#160;    }</div><div class="line"><a name="l08798"></a><span class="lineno"> 8798</span>&#160;    }</div><div class="line"><a name="l08799"></a><span class="lineno"> 8799</span>&#160;</div><div class="line"><a name="l08800"></a><span class="lineno"> 8800</span>&#160;<a class="code" href="expat_8h.html#a013fbe20efe68dbd323a536ffdb1e2a8">end</a>:</div><div class="line"><a name="l08801"></a><span class="lineno"> 8801</span>&#160;  <span class="keywordflow">if</span> (nxtop_stack != nxtop_array &amp;&amp; nxtop_stack != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l08802"></a><span class="lineno"> 8802</span>&#160;    {</div><div class="line"><a name="l08803"></a><span class="lineno"> 8803</span>&#160;      <a class="code" href="memory__alloc_8h.html#a794b5a73adc277837a0c4d12da4af5af">free_and_init</a> (nxtop_stack);</div><div class="line"><a name="l08804"></a><span class="lineno"> 8804</span>&#160;    }</div><div class="line"><a name="l08805"></a><span class="lineno"> 8805</span>&#160;</div><div class="line"><a name="l08806"></a><span class="lineno"> 8806</span>&#160;  <span class="keywordflow">return</span>;</div><div class="line"><a name="l08807"></a><span class="lineno"> 8807</span>&#160;}</div><div class="line"><a name="l08808"></a><span class="lineno"> 8808</span>&#160;</div><div class="line"><a name="l08809"></a><span class="lineno"> 8809</span>&#160;<span class="keyword">static</span> <span class="keywordtype">int</span></div><div class="line"><a name="l08810"></a><span class="lineno"> 8810</span>&#160;log_run_postpone_op (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="structlog__lsa.html">LOG_LSA</a> * <a class="code" href="structlog__lsa.html">log_lsa</a>, <a class="code" href="structlog__page.html">LOG_PAGE</a> * log_pgptr)</div><div class="line"><a name="l08811"></a><span class="lineno"> 8811</span>&#160;{</div><div class="line"><a name="l08812"></a><span class="lineno"> 8812</span>&#160;  <a class="code" href="structlog__lsa.html">LOG_LSA</a> ref_lsa;      <span class="comment">/* The address of a postpone record */</span></div><div class="line"><a name="l08813"></a><span class="lineno"> 8813</span>&#160;  <a class="code" href="structlog__rec__redo.html">LOG_REC_REDO</a> redo;        <span class="comment">/* A redo log record */</span></div><div class="line"><a name="l08814"></a><span class="lineno"> 8814</span>&#160;  <span class="keywordtype">char</span> *rcv_data = <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l08815"></a><span class="lineno"> 8815</span>&#160;  <span class="keywordtype">char</span> *<a class="code" href="structarea.html">area</a> = <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l08816"></a><span class="lineno"> 8816</span>&#160;</div><div class="line"><a name="l08817"></a><span class="lineno"> 8817</span>&#160;  <a class="code" href="storage__common_8h.html#a4c9bc15296fe6728cf0351726cc6ad09">LSA_COPY</a> (&amp;ref_lsa, <a class="code" href="structlog__lsa.html">log_lsa</a>);</div><div class="line"><a name="l08818"></a><span class="lineno"> 8818</span>&#160;</div><div class="line"><a name="l08819"></a><span class="lineno"> 8819</span>&#160;  <span class="comment">/* Get the DATA HEADER */</span></div><div class="line"><a name="l08820"></a><span class="lineno"> 8820</span>&#160;  <a class="code" href="log__impl_8h.html#afdaa9fdf7d83212b3eec2d515e807686">LOG_READ_ADD_ALIGN</a> (thread_p, <span class="keyword">sizeof</span> (<a class="code" href="structlog__rec__header.html">LOG_RECORD_HEADER</a>), <a class="code" href="structlog__lsa.html">log_lsa</a>, log_pgptr);</div><div class="line"><a name="l08821"></a><span class="lineno"> 8821</span>&#160;  <a class="code" href="log__impl_8h.html#a108c8143796ad50c65f64d4a483e9453">LOG_READ_ADVANCE_WHEN_DOESNT_FIT</a> (thread_p, <span class="keyword">sizeof</span> (<a class="code" href="structlog__rec__redo.html">LOG_REC_REDO</a>), <a class="code" href="structlog__lsa.html">log_lsa</a>, log_pgptr);</div><div class="line"><a name="l08822"></a><span class="lineno"> 8822</span>&#160;</div><div class="line"><a name="l08823"></a><span class="lineno"> 8823</span>&#160;  redo = *((<a class="code" href="structlog__rec__redo.html">LOG_REC_REDO</a> *) ((<span class="keywordtype">char</span> *) log_pgptr-&gt;<a class="code" href="structlog__page.html#a9b51b4623cdb8d1686f6f8fb64bc9ee2">area</a> + <a class="code" href="structlog__lsa.html">log_lsa</a>-&gt;<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a>));</div><div class="line"><a name="l08824"></a><span class="lineno"> 8824</span>&#160;</div><div class="line"><a name="l08825"></a><span class="lineno"> 8825</span>&#160;  <a class="code" href="log__impl_8h.html#afdaa9fdf7d83212b3eec2d515e807686">LOG_READ_ADD_ALIGN</a> (thread_p, <span class="keyword">sizeof</span> (<a class="code" href="structlog__rec__redo.html">LOG_REC_REDO</a>), <a class="code" href="structlog__lsa.html">log_lsa</a>, log_pgptr);</div><div class="line"><a name="l08826"></a><span class="lineno"> 8826</span>&#160;</div><div class="line"><a name="l08827"></a><span class="lineno"> 8827</span>&#160;  <span class="comment">/* GET AFTER DATA */</span></div><div class="line"><a name="l08828"></a><span class="lineno"> 8828</span>&#160;</div><div class="line"><a name="l08829"></a><span class="lineno"> 8829</span>&#160;  <span class="comment">/* If data is contained in only one buffer, pass pointer directly. Otherwise, allocate a contiguous area, copy</span></div><div class="line"><a name="l08830"></a><span class="lineno"> 8830</span>&#160;<span class="comment">   * data and pass this area. At the end deallocate the area.</span></div><div class="line"><a name="l08831"></a><span class="lineno"> 8831</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l08832"></a><span class="lineno"> 8832</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="structlog__lsa.html">log_lsa</a>-&gt;<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a> + redo.<a class="code" href="structlog__rec__redo.html#a0a55afc612491df6d6b3b4be22d1c703">length</a> &lt; (<span class="keywordtype">int</span>) <a class="code" href="log__impl_8h.html#a7790a20af76ed5282450723f2e09c4e2">LOGAREA_SIZE</a>)</div><div class="line"><a name="l08833"></a><span class="lineno"> 8833</span>&#160;    {</div><div class="line"><a name="l08834"></a><span class="lineno"> 8834</span>&#160;      rcv_data = (<span class="keywordtype">char</span> *) log_pgptr-&gt;<a class="code" href="structlog__page.html#a9b51b4623cdb8d1686f6f8fb64bc9ee2">area</a> + <a class="code" href="structlog__lsa.html">log_lsa</a>-&gt;<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a>;</div><div class="line"><a name="l08835"></a><span class="lineno"> 8835</span>&#160;    }</div><div class="line"><a name="l08836"></a><span class="lineno"> 8836</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l08837"></a><span class="lineno"> 8837</span>&#160;    {</div><div class="line"><a name="l08838"></a><span class="lineno"> 8838</span>&#160;      <span class="comment">/* Need to copy the data into a contiguous area */</span></div><div class="line"><a name="l08839"></a><span class="lineno"> 8839</span>&#160;      <a class="code" href="structarea.html">area</a> = (<span class="keywordtype">char</span> *) <a class="code" href="leak__detector_8h.html#a99aa8fd9f4831e1b0fa9e1cdcde3e249">malloc</a> (redo.<a class="code" href="structlog__rec__redo.html#a0a55afc612491df6d6b3b4be22d1c703">length</a>);</div><div class="line"><a name="l08840"></a><span class="lineno"> 8840</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="structarea.html">area</a> == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l08841"></a><span class="lineno"> 8841</span>&#160;    {</div><div class="line"><a name="l08842"></a><span class="lineno"> 8842</span>&#160;      <a class="code" href="log__impl_8h.html#a8e111eafc27b6e1383fbd0ee812b1167">logpb_fatal_error</a> (thread_p, <span class="keyword">true</span>, <a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <span class="stringliteral">&quot;log_run_postpone_op&quot;</span>);</div><div class="line"><a name="l08843"></a><span class="lineno"> 8843</span>&#160;</div><div class="line"><a name="l08844"></a><span class="lineno"> 8844</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="error__code_8h.html#a51778caf175b7d6bfe9e8977d9a0032e">ER_FAILED</a>;</div><div class="line"><a name="l08845"></a><span class="lineno"> 8845</span>&#160;    }</div><div class="line"><a name="l08846"></a><span class="lineno"> 8846</span>&#160;</div><div class="line"><a name="l08847"></a><span class="lineno"> 8847</span>&#160;      <span class="comment">/* Copy the data */</span></div><div class="line"><a name="l08848"></a><span class="lineno"> 8848</span>&#160;      <a class="code" href="log__impl_8h.html#a390f2d36dcfc756ef528e21b94f7525c">logpb_copy_from_log</a> (thread_p, <a class="code" href="structarea.html">area</a>, redo.<a class="code" href="structlog__rec__redo.html#a0a55afc612491df6d6b3b4be22d1c703">length</a>, <a class="code" href="structlog__lsa.html">log_lsa</a>, log_pgptr);</div><div class="line"><a name="l08849"></a><span class="lineno"> 8849</span>&#160;      rcv_data = <a class="code" href="structarea.html">area</a>;</div><div class="line"><a name="l08850"></a><span class="lineno"> 8850</span>&#160;    }</div><div class="line"><a name="l08851"></a><span class="lineno"> 8851</span>&#160;</div><div class="line"><a name="l08852"></a><span class="lineno"> 8852</span>&#160;  (void) <a class="code" href="log__manager_8c.html#a8d551fdad2195f69634062351625e395">log_execute_run_postpone</a> (thread_p, &amp;ref_lsa, &amp;redo, rcv_data);</div><div class="line"><a name="l08853"></a><span class="lineno"> 8853</span>&#160;</div><div class="line"><a name="l08854"></a><span class="lineno"> 8854</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="structarea.html">area</a> != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l08855"></a><span class="lineno"> 8855</span>&#160;    {</div><div class="line"><a name="l08856"></a><span class="lineno"> 8856</span>&#160;      <a class="code" href="memory__alloc_8h.html#a794b5a73adc277837a0c4d12da4af5af">free_and_init</a> (<a class="code" href="structarea.html">area</a>);</div><div class="line"><a name="l08857"></a><span class="lineno"> 8857</span>&#160;    }</div><div class="line"><a name="l08858"></a><span class="lineno"> 8858</span>&#160;</div><div class="line"><a name="l08859"></a><span class="lineno"> 8859</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>;</div><div class="line"><a name="l08860"></a><span class="lineno"> 8860</span>&#160;}</div><div class="line"><a name="l08861"></a><span class="lineno"> 8861</span>&#160;</div><div class="line"><a name="l08862"></a><span class="lineno"> 8862</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l08863"></a><span class="lineno"> 8863</span>&#160;<span class="comment"> * log_execute_run_postpone () - Execute run postpone.</span></div><div class="line"><a name="l08864"></a><span class="lineno"> 8864</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l08865"></a><span class="lineno"> 8865</span>&#160;<span class="comment"> * return         : Error code.</span></div><div class="line"><a name="l08866"></a><span class="lineno"> 8866</span>&#160;<span class="comment"> * thread_p (in)      : Thread entry.</span></div><div class="line"><a name="l08867"></a><span class="lineno"> 8867</span>&#160;<span class="comment"> * log_lsa (in)       : Postpone log LSA.</span></div><div class="line"><a name="l08868"></a><span class="lineno"> 8868</span>&#160;<span class="comment"> * redo (in)          : Redo log data.</span></div><div class="line"><a name="l08869"></a><span class="lineno"> 8869</span>&#160;<span class="comment"> * redo_rcv_data (in) : Redo recovery data.</span></div><div class="line"><a name="l08870"></a><span class="lineno"> 8870</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l08871"></a><span class="lineno"> 8871</span>&#160;<span class="keywordtype">int</span></div><div class="line"><a name="l08872"></a><span class="lineno"><a class="line" href="log__manager_8h.html#a8d551fdad2195f69634062351625e395"> 8872</a></span>&#160;<a class="code" href="log__manager_8c.html#a8d551fdad2195f69634062351625e395">log_execute_run_postpone</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="structlog__lsa.html">LOG_LSA</a> * <a class="code" href="structlog__lsa.html">log_lsa</a>, <a class="code" href="structlog__rec__redo.html">LOG_REC_REDO</a> * redo, <span class="keywordtype">char</span> *redo_rcv_data)</div><div class="line"><a name="l08873"></a><span class="lineno"> 8873</span>&#160;{</div><div class="line"><a name="l08874"></a><span class="lineno"> 8874</span>&#160;  <span class="keywordtype">int</span> error_code = <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>;</div><div class="line"><a name="l08875"></a><span class="lineno"> 8875</span>&#160;  <a class="code" href="structlog__rcv.html">LOG_RCV</a> rcv;          <span class="comment">/* Recovery structure for execution */</span></div><div class="line"><a name="l08876"></a><span class="lineno"> 8876</span>&#160;  <a class="code" href="structvpid.html">VPID</a> rcv_vpid;        <span class="comment">/* Location of data to redo */</span></div><div class="line"><a name="l08877"></a><span class="lineno"> 8877</span>&#160;  <a class="code" href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2b">LOG_RCVINDEX</a> rcvindex;    <span class="comment">/* The recovery index */</span></div><div class="line"><a name="l08878"></a><span class="lineno"> 8878</span>&#160;  <a class="code" href="structlog__data__addr.html">LOG_DATA_ADDR</a> rvaddr;</div><div class="line"><a name="l08879"></a><span class="lineno"> 8879</span>&#160;</div><div class="line"><a name="l08880"></a><span class="lineno"> 8880</span>&#160;  rcvindex = redo-&gt;<a class="code" href="structlog__rec__redo.html#a96ea9b5f13d7c0934ec9b5cd95ae274d">data</a>.<a class="code" href="structlog__data.html#ab1a17fceea659d32f5187b81a7b80412">rcvindex</a>;</div><div class="line"><a name="l08881"></a><span class="lineno"> 8881</span>&#160;  rcv_vpid.<a class="code" href="structvpid.html#a54e222d402e758d24ae0df524a9e677d">volid</a> = redo-&gt;<a class="code" href="structlog__rec__redo.html#a96ea9b5f13d7c0934ec9b5cd95ae274d">data</a>.<a class="code" href="structlog__data.html#ad5635159b85ee07322bf30e39a5dee76">volid</a>;</div><div class="line"><a name="l08882"></a><span class="lineno"> 8882</span>&#160;  rcv_vpid.<a class="code" href="structvpid.html#a5863283d85ba76aaec01bf80c89a9d36">pageid</a> = redo-&gt;<a class="code" href="structlog__rec__redo.html#a96ea9b5f13d7c0934ec9b5cd95ae274d">data</a>.<a class="code" href="structlog__data.html#a8410b9d70cc70d2bc6fb6df88ea48bb4">pageid</a>;</div><div class="line"><a name="l08883"></a><span class="lineno"> 8883</span>&#160;  rcv.<a class="code" href="structlog__rcv.html#a4acc4ed244fcaa09adea314ee4f7b861">offset</a> = redo-&gt;<a class="code" href="structlog__rec__redo.html#a96ea9b5f13d7c0934ec9b5cd95ae274d">data</a>.<a class="code" href="structlog__data.html#afd25836b0952561036b01b5a50c310b2">offset</a>;</div><div class="line"><a name="l08884"></a><span class="lineno"> 8884</span>&#160;  rcv.<a class="code" href="structlog__rcv.html#aa86dfb9bbc9edce109df26aacf699915">length</a> = redo-&gt;<a class="code" href="structlog__rec__redo.html#a0a55afc612491df6d6b3b4be22d1c703">length</a>;</div><div class="line"><a name="l08885"></a><span class="lineno"> 8885</span>&#160;  rcv.<a class="code" href="structlog__rcv.html#afc672de81dd88914d00281fada1acc13">data</a> = redo_rcv_data;</div><div class="line"><a name="l08886"></a><span class="lineno"> 8886</span>&#160;</div><div class="line"><a name="l08887"></a><span class="lineno"> 8887</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="dbtype__def_8h.html#a63597e7809fc77d3110c5b22699f2e0a">VPID_ISNULL</a> (&amp;rcv_vpid))</div><div class="line"><a name="l08888"></a><span class="lineno"> 8888</span>&#160;    {</div><div class="line"><a name="l08889"></a><span class="lineno"> 8889</span>&#160;      <span class="comment">/* logical */</span></div><div class="line"><a name="l08890"></a><span class="lineno"> 8890</span>&#160;      rcv.<a class="code" href="structlog__rcv.html#a04db9f252907cff6ca339534e8c4f642">pgptr</a> = <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l08891"></a><span class="lineno"> 8891</span>&#160;    }</div><div class="line"><a name="l08892"></a><span class="lineno"> 8892</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l08893"></a><span class="lineno"> 8893</span>&#160;    {</div><div class="line"><a name="l08894"></a><span class="lineno"> 8894</span>&#160;      error_code =</div><div class="line"><a name="l08895"></a><span class="lineno"> 8895</span>&#160;    <a class="code" href="page__buffer_8h.html#ae6319b9827ca0534c44c3e713c6fd2f3">pgbuf_fix_if_not_deallocated</a> (thread_p, &amp;rcv_vpid, <a class="code" href="page__buffer_8h.html#a4c8498d851d45af7bd1aa005f03c71adabbd389e885455638c44f6bea1524ae65">PGBUF_LATCH_WRITE</a>, <a class="code" href="page__buffer_8h.html#aafea7625b165348a0cf4715f54301603a4bffd61081f056fbc5a197836b0d82d2">PGBUF_UNCONDITIONAL_LATCH</a>, &amp;rcv.<a class="code" href="structlog__rcv.html#a04db9f252907cff6ca339534e8c4f642">pgptr</a>);</div><div class="line"><a name="l08896"></a><span class="lineno"> 8896</span>&#160;      <span class="keywordflow">if</span> (error_code != <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>)</div><div class="line"><a name="l08897"></a><span class="lineno"> 8897</span>&#160;    {</div><div class="line"><a name="l08898"></a><span class="lineno"> 8898</span>&#160;      <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (<span class="keyword">false</span>);</div><div class="line"><a name="l08899"></a><span class="lineno"> 8899</span>&#160;      <a class="code" href="error__manager_8c.html#afdaf87ce30f2f557802a185ab85b6599">er_set</a> (<a class="code" href="error__manager_8h.html#a5d0d456c474e11fc70779873a30a7432a07ad8f9fda27124d297c94b7d3ea44e8">ER_ERROR_SEVERITY</a>, <a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <a class="code" href="error__code_8h.html#afb34238455b940cb2bacb3ddd899bb03">ER_LOG_MAYNEED_MEDIA_RECOVERY</a>, 1,</div><div class="line"><a name="l08900"></a><span class="lineno"> 8900</span>&#160;          <a class="code" href="file__io_8c.html#a251cdd92358703f9c482c5d84f8d7dc0">fileio_get_volume_label</a> (rcv_vpid.<a class="code" href="structvpid.html#a54e222d402e758d24ae0df524a9e677d">volid</a>, <a class="code" href="regcomp_8c.html#aa25dac8b80db8b8f03732eeb9ca23934">PEEK</a>));</div><div class="line"><a name="l08901"></a><span class="lineno"> 8901</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="error__code_8h.html#afb34238455b940cb2bacb3ddd899bb03">ER_LOG_MAYNEED_MEDIA_RECOVERY</a>;</div><div class="line"><a name="l08902"></a><span class="lineno"> 8902</span>&#160;    }</div><div class="line"><a name="l08903"></a><span class="lineno"> 8903</span>&#160;      <span class="keywordflow">if</span> (rcv.<a class="code" href="structlog__rcv.html#a04db9f252907cff6ca339534e8c4f642">pgptr</a> == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l08904"></a><span class="lineno"> 8904</span>&#160;    {</div><div class="line"><a name="l08905"></a><span class="lineno"> 8905</span>&#160;      <span class="comment">/* deallocated */</span></div><div class="line"><a name="l08906"></a><span class="lineno"> 8906</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>;</div><div class="line"><a name="l08907"></a><span class="lineno"> 8907</span>&#160;    }</div><div class="line"><a name="l08908"></a><span class="lineno"> 8908</span>&#160;    }</div><div class="line"><a name="l08909"></a><span class="lineno"> 8909</span>&#160;</div><div class="line"><a name="l08910"></a><span class="lineno"> 8910</span>&#160;  <span class="comment">/* Now call the REDO recovery function */</span></div><div class="line"><a name="l08911"></a><span class="lineno"> 8911</span>&#160;</div><div class="line"><a name="l08912"></a><span class="lineno"> 8912</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="recovery_8h.html#abcf26d0f67b04c0e8820d2b59b2ac8f4">RCV_IS_LOGICAL_RUN_POSTPONE_MANUAL</a> (rcvindex))</div><div class="line"><a name="l08913"></a><span class="lineno"> 8913</span>&#160;    {</div><div class="line"><a name="l08914"></a><span class="lineno"> 8914</span>&#160;      <a class="code" href="storage__common_8h.html#a4c9bc15296fe6728cf0351726cc6ad09">LSA_COPY</a> (&amp;rcv.<a class="code" href="structlog__rcv.html#a8400bbfec907d992bc47a641dbd2eeb2">reference_lsa</a>, <a class="code" href="structlog__lsa.html">log_lsa</a>);</div><div class="line"><a name="l08915"></a><span class="lineno"> 8915</span>&#160;</div><div class="line"><a name="l08916"></a><span class="lineno"> 8916</span>&#160;      error_code = (*<a class="code" href="recovery_8c.html#ad2eee9d1e5914fa34d3a7868bf2549f4">RV_fun</a>[rcvindex].<a class="code" href="structrvfun.html#aca33a8111da1e70b7ed633e5028760ce">redofun</a>) (thread_p, &amp;rcv);</div><div class="line"><a name="l08917"></a><span class="lineno"> 8917</span>&#160;      <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (error_code == <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>);</div><div class="line"><a name="l08918"></a><span class="lineno"> 8918</span>&#160;    }</div><div class="line"><a name="l08919"></a><span class="lineno"> 8919</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="recovery_8h.html#a6d691036d814022c71635238f2e411cb">RCV_IS_LOGICAL_LOG</a> (&amp;rcv_vpid, rcvindex))</div><div class="line"><a name="l08920"></a><span class="lineno"> 8920</span>&#160;    {</div><div class="line"><a name="l08921"></a><span class="lineno"> 8921</span>&#160;      <span class="comment">/* Logical postpone. Use a system operation and commit with run postpone */</span></div><div class="line"><a name="l08922"></a><span class="lineno"> 8922</span>&#160;      <a class="code" href="log__manager_8c.html#acbc3a63215e8924ed23841fb2321cd78">log_sysop_start</a> (thread_p);</div><div class="line"><a name="l08923"></a><span class="lineno"> 8923</span>&#160;</div><div class="line"><a name="l08924"></a><span class="lineno"> 8924</span>&#160;      error_code = (*<a class="code" href="recovery_8c.html#ad2eee9d1e5914fa34d3a7868bf2549f4">RV_fun</a>[rcvindex].<a class="code" href="structrvfun.html#aca33a8111da1e70b7ed633e5028760ce">redofun</a>) (thread_p, &amp;rcv);</div><div class="line"><a name="l08925"></a><span class="lineno"> 8925</span>&#160;      <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (error_code == <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>);</div><div class="line"><a name="l08926"></a><span class="lineno"> 8926</span>&#160;</div><div class="line"><a name="l08927"></a><span class="lineno"> 8927</span>&#160;      <a class="code" href="log__manager_8c.html#a00976c440ea1347035bf5d8a707279e5">log_sysop_end_logical_run_postpone</a> (thread_p, <a class="code" href="structlog__lsa.html">log_lsa</a>);</div><div class="line"><a name="l08928"></a><span class="lineno"> 8928</span>&#160;    }</div><div class="line"><a name="l08929"></a><span class="lineno"> 8929</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l08930"></a><span class="lineno"> 8930</span>&#160;    {</div><div class="line"><a name="l08931"></a><span class="lineno"> 8931</span>&#160;      <span class="comment">/* Write the corresponding run postpone record for the postpone action */</span></div><div class="line"><a name="l08932"></a><span class="lineno"> 8932</span>&#160;      rvaddr.<a class="code" href="structlog__data__addr.html#ab8ee0b45ab1d94bffa3626936b282d5f">offset</a> = rcv.<a class="code" href="structlog__rcv.html#a4acc4ed244fcaa09adea314ee4f7b861">offset</a>;</div><div class="line"><a name="l08933"></a><span class="lineno"> 8933</span>&#160;      rvaddr.<a class="code" href="structlog__data__addr.html#a3c632dae3ad660a8572d9298716d9522">pgptr</a> = rcv.<a class="code" href="structlog__rcv.html#a04db9f252907cff6ca339534e8c4f642">pgptr</a>;</div><div class="line"><a name="l08934"></a><span class="lineno"> 8934</span>&#160;</div><div class="line"><a name="l08935"></a><span class="lineno"> 8935</span>&#160;      <a class="code" href="log__manager_8c.html#ab82d5be060189c3aa56e57399a458e3a">log_append_run_postpone</a> (thread_p, rcvindex, &amp;rvaddr, &amp;rcv_vpid, rcv.<a class="code" href="structlog__rcv.html#aa86dfb9bbc9edce109df26aacf699915">length</a>, rcv.<a class="code" href="structlog__rcv.html#afc672de81dd88914d00281fada1acc13">data</a>, <a class="code" href="structlog__lsa.html">log_lsa</a>);</div><div class="line"><a name="l08936"></a><span class="lineno"> 8936</span>&#160;</div><div class="line"><a name="l08937"></a><span class="lineno"> 8937</span>&#160;      error_code = (*<a class="code" href="recovery_8c.html#ad2eee9d1e5914fa34d3a7868bf2549f4">RV_fun</a>[rcvindex].<a class="code" href="structrvfun.html#aca33a8111da1e70b7ed633e5028760ce">redofun</a>) (thread_p, &amp;rcv);</div><div class="line"><a name="l08938"></a><span class="lineno"> 8938</span>&#160;      <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (error_code == <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>);</div><div class="line"><a name="l08939"></a><span class="lineno"> 8939</span>&#160;    }</div><div class="line"><a name="l08940"></a><span class="lineno"> 8940</span>&#160;</div><div class="line"><a name="l08941"></a><span class="lineno"> 8941</span>&#160;  <span class="keywordflow">if</span> (rcv.<a class="code" href="structlog__rcv.html#a04db9f252907cff6ca339534e8c4f642">pgptr</a> != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l08942"></a><span class="lineno"> 8942</span>&#160;    {</div><div class="line"><a name="l08943"></a><span class="lineno"> 8943</span>&#160;      <a class="code" href="page__buffer_8h.html#a3bfa0f717b33e17651fff6daf57637ce">pgbuf_unfix</a> (thread_p, rcv.<a class="code" href="structlog__rcv.html#a04db9f252907cff6ca339534e8c4f642">pgptr</a>);</div><div class="line"><a name="l08944"></a><span class="lineno"> 8944</span>&#160;    }</div><div class="line"><a name="l08945"></a><span class="lineno"> 8945</span>&#160;</div><div class="line"><a name="l08946"></a><span class="lineno"> 8946</span>&#160;  <span class="keywordflow">return</span> error_code;</div><div class="line"><a name="l08947"></a><span class="lineno"> 8947</span>&#160;}</div><div class="line"><a name="l08948"></a><span class="lineno"> 8948</span>&#160;</div><div class="line"><a name="l08949"></a><span class="lineno"> 8949</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l08950"></a><span class="lineno"> 8950</span>&#160;<span class="comment"> * log_find_end_log - FIND END OF LOG</span></div><div class="line"><a name="l08951"></a><span class="lineno"> 8951</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l08952"></a><span class="lineno"> 8952</span>&#160;<span class="comment"> * return: nothing</span></div><div class="line"><a name="l08953"></a><span class="lineno"> 8953</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l08954"></a><span class="lineno"> 8954</span>&#160;<span class="comment"> *   end_lsa(in/out): Address of end of log</span></div><div class="line"><a name="l08955"></a><span class="lineno"> 8955</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l08956"></a><span class="lineno"> 8956</span>&#160;<span class="comment"> * NOTE: Find the end of the log (i.e., the end of the active portion of the log).</span></div><div class="line"><a name="l08957"></a><span class="lineno"> 8957</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l08958"></a><span class="lineno"> 8958</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div><div class="line"><a name="l08959"></a><span class="lineno"> 8959</span>&#160;log_find_end_log (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="structlog__lsa.html">LOG_LSA</a> * end_lsa)</div><div class="line"><a name="l08960"></a><span class="lineno"> 8960</span>&#160;{</div><div class="line"><a name="l08961"></a><span class="lineno"> 8961</span>&#160;  <a class="code" href="storage__common_8h.html#a26871e1bd203b43825e17ebfd14d072d">LOG_PAGEID</a> pageid;        <span class="comment">/* Log page identifier */</span></div><div class="line"><a name="l08962"></a><span class="lineno"> 8962</span>&#160;  <span class="keywordtype">char</span> log_pgbuf[<a class="code" href="storage__common_8h.html#a0a3c7db68a92df0d34666257bb0f17dd">IO_MAX_PAGE_SIZE</a> + <a class="code" href="memory__alloc_8h.html#a81d7e4971ffc775a379eeb4c65fa30f8">MAX_ALIGNMENT</a>], *aligned_log_pgbuf;</div><div class="line"><a name="l08963"></a><span class="lineno"> 8963</span>&#160;  <a class="code" href="structlog__page.html">LOG_PAGE</a> *log_pgptr = <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;   <span class="comment">/* Pointer to a log page */</span></div><div class="line"><a name="l08964"></a><span class="lineno"> 8964</span>&#160;  <a class="code" href="structlog__rec__header.html">LOG_RECORD_HEADER</a> *eof = <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;    <span class="comment">/* End of log record */</span></div><div class="line"><a name="l08965"></a><span class="lineno"> 8965</span>&#160;  <a class="code" href="log__impl_8h.html#ab85dbe80b115a32bf7a430c32ddc5b8b">LOG_RECTYPE</a> <a class="code" href="atldb__cubrid_8h.html#ad939da76b5d12fca40de18001582d63a">type</a>;     <span class="comment">/* Type of a log record */</span></div><div class="line"><a name="l08966"></a><span class="lineno"> 8966</span>&#160;</div><div class="line"><a name="l08967"></a><span class="lineno"> 8967</span>&#160;  aligned_log_pgbuf = <a class="code" href="memory__alloc_8h.html#a79781c0dbfdd9510d275cba54f1f384f">PTR_ALIGN</a> (log_pgbuf, <a class="code" href="memory__alloc_8h.html#a81d7e4971ffc775a379eeb4c65fa30f8">MAX_ALIGNMENT</a>);</div><div class="line"><a name="l08968"></a><span class="lineno"> 8968</span>&#160;</div><div class="line"><a name="l08969"></a><span class="lineno"> 8969</span>&#160;  <span class="comment">/* Guess the end of the log from the header */</span></div><div class="line"><a name="l08970"></a><span class="lineno"> 8970</span>&#160;</div><div class="line"><a name="l08971"></a><span class="lineno"> 8971</span>&#160;  <a class="code" href="storage__common_8h.html#a4c9bc15296fe6728cf0351726cc6ad09">LSA_COPY</a> (end_lsa, &amp;<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>.<a class="code" href="structlog__header.html#a982b3e55dedc3dabc54a1a7fcddc144e">append_lsa</a>);</div><div class="line"><a name="l08972"></a><span class="lineno"> 8972</span>&#160;  <a class="code" href="atldb__cubrid_8h.html#ad939da76b5d12fca40de18001582d63a">type</a> = <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a25bfb5a0ac528c508558bd8be6704739">LOG_LARGER_LOGREC_TYPE</a>;</div><div class="line"><a name="l08973"></a><span class="lineno"> 8973</span>&#160;</div><div class="line"><a name="l08974"></a><span class="lineno"> 8974</span>&#160;  log_pgptr = (<a class="code" href="structlog__page.html">LOG_PAGE</a> *) aligned_log_pgbuf;</div><div class="line"><a name="l08975"></a><span class="lineno"> 8975</span>&#160;</div><div class="line"><a name="l08976"></a><span class="lineno"> 8976</span>&#160;  <span class="keywordflow">while</span> (<a class="code" href="atldb__cubrid_8h.html#ad939da76b5d12fca40de18001582d63a">type</a> != <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a034d486f56b110bc31fba3b6db5dd980">LOG_END_OF_LOG</a> &amp;&amp; !<a class="code" href="storage__common_8h.html#a26dd766712df5b5c4fcd158f571a75e4">LSA_ISNULL</a> (end_lsa))</div><div class="line"><a name="l08977"></a><span class="lineno"> 8977</span>&#160;    {</div><div class="line"><a name="l08978"></a><span class="lineno"> 8978</span>&#160;      <a class="code" href="structlog__lsa.html">LOG_LSA</a> fetch_lsa;</div><div class="line"><a name="l08979"></a><span class="lineno"> 8979</span>&#160;</div><div class="line"><a name="l08980"></a><span class="lineno"> 8980</span>&#160;      fetch_lsa.<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a> = end_lsa-&gt;<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a>;</div><div class="line"><a name="l08981"></a><span class="lineno"> 8981</span>&#160;      fetch_lsa.<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a> = <a class="code" href="storage__common_8h.html#a1a7b7663aee8b9e8b1df6b1fbd5a88b9">LOG_PAGESIZE</a>;</div><div class="line"><a name="l08982"></a><span class="lineno"> 8982</span>&#160;</div><div class="line"><a name="l08983"></a><span class="lineno"> 8983</span>&#160;      <span class="comment">/* Fetch the page */</span></div><div class="line"><a name="l08984"></a><span class="lineno"> 8984</span>&#160;      <span class="keywordflow">if</span> ((<a class="code" href="log__impl_8h.html#ac67cba94ac6c10da3ae0ab474155ea1a">logpb_fetch_page</a> (thread_p, &amp;fetch_lsa, <a class="code" href="log__impl_8h.html#ab33fe5f69028f102e9910294e97ccd6babc4379db94a7ff5ff8491988a7c28bc1">LOG_CS_FORCE_USE</a>, log_pgptr)) != <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>)</div><div class="line"><a name="l08985"></a><span class="lineno"> 8985</span>&#160;    {</div><div class="line"><a name="l08986"></a><span class="lineno"> 8986</span>&#160;      <a class="code" href="log__impl_8h.html#a8e111eafc27b6e1383fbd0ee812b1167">logpb_fatal_error</a> (thread_p, <span class="keyword">true</span>, <a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <span class="stringliteral">&quot;log_find_end_log&quot;</span>);</div><div class="line"><a name="l08987"></a><span class="lineno"> 8987</span>&#160;      <span class="keywordflow">goto</span> <a class="code" href="run-tests_8php.html#aaa193b0c1c2b93841472b26e2e281751">error</a>;</div><div class="line"><a name="l08988"></a><span class="lineno"> 8988</span>&#160;</div><div class="line"><a name="l08989"></a><span class="lineno"> 8989</span>&#160;    }</div><div class="line"><a name="l08990"></a><span class="lineno"> 8990</span>&#160;      pageid = end_lsa-&gt;<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a>;</div><div class="line"><a name="l08991"></a><span class="lineno"> 8991</span>&#160;</div><div class="line"><a name="l08992"></a><span class="lineno"> 8992</span>&#160;      <span class="keywordflow">while</span> (end_lsa-&gt;<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a> == pageid)</div><div class="line"><a name="l08993"></a><span class="lineno"> 8993</span>&#160;    {</div><div class="line"><a name="l08994"></a><span class="lineno"> 8994</span>&#160;      <span class="comment">/* </span></div><div class="line"><a name="l08995"></a><span class="lineno"> 8995</span>&#160;<span class="comment">       * If an offset is missing, it is because we archive an incomplete</span></div><div class="line"><a name="l08996"></a><span class="lineno"> 8996</span>&#160;<span class="comment">       * log record. This log_record was completed later. Thus, we have to</span></div><div class="line"><a name="l08997"></a><span class="lineno"> 8997</span>&#160;<span class="comment">       * find the offset by searching for the next log_record in the page</span></div><div class="line"><a name="l08998"></a><span class="lineno"> 8998</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l08999"></a><span class="lineno"> 8999</span>&#160;      <span class="keywordflow">if</span> (!(end_lsa-&gt;<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a> == <a class="code" href="storage__common_8h.html#a5b0ca3ea530f289fa3f19921e5b0faf3">NULL_OFFSET</a> &amp;&amp; (end_lsa-&gt;<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a> = log_pgptr-&gt;<a class="code" href="structlog__page.html#a52640d2c65b2d7b95a330a670646e8f9">hdr</a>.<a class="code" href="structlog__hdrpage.html#a581cc8236b70bf22034b8006e44570d5">offset</a>) == <a class="code" href="storage__common_8h.html#a5b0ca3ea530f289fa3f19921e5b0faf3">NULL_OFFSET</a>))</div><div class="line"><a name="l09000"></a><span class="lineno"> 9000</span>&#160;        {</div><div class="line"><a name="l09001"></a><span class="lineno"> 9001</span>&#160;          eof = <a class="code" href="log__impl_8h.html#ae37437431a8ea417a8e768ed5fa8f5f6">LOG_GET_LOG_RECORD_HEADER</a> (log_pgptr, end_lsa);</div><div class="line"><a name="l09002"></a><span class="lineno"> 9002</span>&#160;          <span class="comment">/* </span></div><div class="line"><a name="l09003"></a><span class="lineno"> 9003</span>&#160;<span class="comment">           * If the type is an EOF located at the active portion of the log,</span></div><div class="line"><a name="l09004"></a><span class="lineno"> 9004</span>&#160;<span class="comment">           * stop</span></div><div class="line"><a name="l09005"></a><span class="lineno"> 9005</span>&#160;<span class="comment">           */</span></div><div class="line"><a name="l09006"></a><span class="lineno"> 9006</span>&#160;          <span class="keywordflow">if</span> ((<a class="code" href="atldb__cubrid_8h.html#ad939da76b5d12fca40de18001582d63a">type</a> = eof-&gt;<a class="code" href="structlog__rec__header.html#aa9be1266bf7fdca13a0a789dc5ae11bb">type</a>) == <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a034d486f56b110bc31fba3b6db5dd980">LOG_END_OF_LOG</a>)</div><div class="line"><a name="l09007"></a><span class="lineno"> 9007</span>&#160;        {</div><div class="line"><a name="l09008"></a><span class="lineno"> 9008</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="log__impl_8h.html#aa2a6e20070602d985015f39d448f8125">logpb_is_page_in_archive</a> (pageid))</div><div class="line"><a name="l09009"></a><span class="lineno"> 9009</span>&#160;            {</div><div class="line"><a name="l09010"></a><span class="lineno"> 9010</span>&#160;              <a class="code" href="atldb__cubrid_8h.html#ad939da76b5d12fca40de18001582d63a">type</a> = <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a25bfb5a0ac528c508558bd8be6704739">LOG_LARGER_LOGREC_TYPE</a>;</div><div class="line"><a name="l09011"></a><span class="lineno"> 9011</span>&#160;            }</div><div class="line"><a name="l09012"></a><span class="lineno"> 9012</span>&#160;          <span class="keywordflow">else</span></div><div class="line"><a name="l09013"></a><span class="lineno"> 9013</span>&#160;            {</div><div class="line"><a name="l09014"></a><span class="lineno"> 9014</span>&#160;              <span class="keywordflow">break</span>;</div><div class="line"><a name="l09015"></a><span class="lineno"> 9015</span>&#160;            }</div><div class="line"><a name="l09016"></a><span class="lineno"> 9016</span>&#160;        }</div><div class="line"><a name="l09017"></a><span class="lineno"> 9017</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type &lt;= LOG_SMALLER_LOGREC_TYPE || type &gt;= <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a25bfb5a0ac528c508558bd8be6704739">LOG_LARGER_LOGREC_TYPE</a>)</div><div class="line"><a name="l09018"></a><span class="lineno"> 9018</span>&#160;        {</div><div class="line"><a name="l09019"></a><span class="lineno"> 9019</span>&#160;<span class="preprocessor">#if defined(CUBRID_DEBUG)</span></div><div class="line"><a name="l09020"></a><span class="lineno"> 9020</span>&#160;          <a class="code" href="error__manager_8h.html#a075eb8873354909bbe8edafa0f18f58c">er_log_debug</a> (<a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <span class="stringliteral">&quot;log_find_end_log: Unknown record type = %d (%s).\n&quot;</span>, <a class="code" href="atldb__cubrid_8h.html#ad939da76b5d12fca40de18001582d63a">type</a>,</div><div class="line"><a name="l09021"></a><span class="lineno"> 9021</span>&#160;                <a class="code" href="log__manager_8c.html#a6e093782f446a5806cc9631a97eba1c3">log_to_string</a> (<a class="code" href="atldb__cubrid_8h.html#ad939da76b5d12fca40de18001582d63a">type</a>));</div><div class="line"><a name="l09022"></a><span class="lineno"> 9022</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* CUBRID_DEBUG */</span><span class="preprocessor"></span></div><div class="line"><a name="l09023"></a><span class="lineno"> 9023</span>&#160;          <a class="code" href="storage__common_8h.html#a6a4baec606189dd320678e8f412ca957">LSA_SET_NULL</a> (end_lsa);</div><div class="line"><a name="l09024"></a><span class="lineno"> 9024</span>&#160;          <span class="keywordflow">break</span>;</div><div class="line"><a name="l09025"></a><span class="lineno"> 9025</span>&#160;        }</div><div class="line"><a name="l09026"></a><span class="lineno"> 9026</span>&#160;          <span class="keywordflow">else</span></div><div class="line"><a name="l09027"></a><span class="lineno"> 9027</span>&#160;        {</div><div class="line"><a name="l09028"></a><span class="lineno"> 9028</span>&#160;          <a class="code" href="storage__common_8h.html#a4c9bc15296fe6728cf0351726cc6ad09">LSA_COPY</a> (end_lsa, &amp;eof-&gt;<a class="code" href="structlog__rec__header.html#ab88354b51f9cabaaace23420eec7ac7e">forw_lsa</a>);</div><div class="line"><a name="l09029"></a><span class="lineno"> 9029</span>&#160;        }</div><div class="line"><a name="l09030"></a><span class="lineno"> 9030</span>&#160;        }</div><div class="line"><a name="l09031"></a><span class="lineno"> 9031</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l09032"></a><span class="lineno"> 9032</span>&#160;        {</div><div class="line"><a name="l09033"></a><span class="lineno"> 9033</span>&#160;          <a class="code" href="storage__common_8h.html#a6a4baec606189dd320678e8f412ca957">LSA_SET_NULL</a> (end_lsa);</div><div class="line"><a name="l09034"></a><span class="lineno"> 9034</span>&#160;        }</div><div class="line"><a name="l09035"></a><span class="lineno"> 9035</span>&#160;</div><div class="line"><a name="l09036"></a><span class="lineno"> 9036</span>&#160;      <span class="comment">/* </span></div><div class="line"><a name="l09037"></a><span class="lineno"> 9037</span>&#160;<span class="comment">       * If the next page is NULL_PAGEID and the current page is an archive</span></div><div class="line"><a name="l09038"></a><span class="lineno"> 9038</span>&#160;<span class="comment">       * page, this is not the end, this situation happens because of an</span></div><div class="line"><a name="l09039"></a><span class="lineno"> 9039</span>&#160;<span class="comment">       * incomplete log record was archived.</span></div><div class="line"><a name="l09040"></a><span class="lineno"> 9040</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l09041"></a><span class="lineno"> 9041</span>&#160;</div><div class="line"><a name="l09042"></a><span class="lineno"> 9042</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="storage__common_8h.html#a26dd766712df5b5c4fcd158f571a75e4">LSA_ISNULL</a> (end_lsa) &amp;&amp; <a class="code" href="log__impl_8h.html#aa2a6e20070602d985015f39d448f8125">logpb_is_page_in_archive</a> (pageid))</div><div class="line"><a name="l09043"></a><span class="lineno"> 9043</span>&#160;        {</div><div class="line"><a name="l09044"></a><span class="lineno"> 9044</span>&#160;          end_lsa-&gt;<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a> = pageid + 1;</div><div class="line"><a name="l09045"></a><span class="lineno"> 9045</span>&#160;        }</div><div class="line"><a name="l09046"></a><span class="lineno"> 9046</span>&#160;    }</div><div class="line"><a name="l09047"></a><span class="lineno"> 9047</span>&#160;</div><div class="line"><a name="l09048"></a><span class="lineno"> 9048</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="atldb__cubrid_8h.html#ad939da76b5d12fca40de18001582d63a">type</a> == <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a034d486f56b110bc31fba3b6db5dd980">LOG_END_OF_LOG</a> &amp;&amp; eof != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> &amp;&amp; !<a class="code" href="storage__common_8h.html#aa8d8ea0049b43e3faf4c471641af5f98">LSA_EQ</a> (end_lsa, &amp;<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>.<a class="code" href="structlog__header.html#a982b3e55dedc3dabc54a1a7fcddc144e">append_lsa</a>))</div><div class="line"><a name="l09049"></a><span class="lineno"> 9049</span>&#160;    {</div><div class="line"><a name="l09050"></a><span class="lineno"> 9050</span>&#160;      <span class="comment">/* </span></div><div class="line"><a name="l09051"></a><span class="lineno"> 9051</span>&#160;<span class="comment">       * Reset the log header for future reads, multiple restart crashes,</span></div><div class="line"><a name="l09052"></a><span class="lineno"> 9052</span>&#160;<span class="comment">       * and so on</span></div><div class="line"><a name="l09053"></a><span class="lineno"> 9053</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l09054"></a><span class="lineno"> 9054</span>&#160;      <a class="code" href="log__impl_8h.html#aa501d3de75690fbad474f906ff686b19">LOG_RESET_APPEND_LSA</a> (end_lsa);</div><div class="line"><a name="l09055"></a><span class="lineno"> 9055</span>&#160;      <a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>.<a class="code" href="structlog__header.html#aa1540adc8fb89ea40a4cf0d18344afd9">next_trid</a> = eof-&gt;<a class="code" href="structlog__rec__header.html#a210194ed9baf246456495d89fb411725">trid</a>;</div><div class="line"><a name="l09056"></a><span class="lineno"> 9056</span>&#160;    }</div><div class="line"><a name="l09057"></a><span class="lineno"> 9057</span>&#160;    }</div><div class="line"><a name="l09058"></a><span class="lineno"> 9058</span>&#160;</div><div class="line"><a name="l09059"></a><span class="lineno"> 9059</span>&#160;  <span class="keywordflow">return</span>;</div><div class="line"><a name="l09060"></a><span class="lineno"> 9060</span>&#160;</div><div class="line"><a name="l09061"></a><span class="lineno"> 9061</span>&#160;<a class="code" href="run-tests_8php.html#aaa193b0c1c2b93841472b26e2e281751">error</a>:</div><div class="line"><a name="l09062"></a><span class="lineno"> 9062</span>&#160;</div><div class="line"><a name="l09063"></a><span class="lineno"> 9063</span>&#160;  <a class="code" href="storage__common_8h.html#a6a4baec606189dd320678e8f412ca957">LSA_SET_NULL</a> (end_lsa);</div><div class="line"><a name="l09064"></a><span class="lineno"> 9064</span>&#160;  <span class="keywordflow">return</span>;</div><div class="line"><a name="l09065"></a><span class="lineno"> 9065</span>&#160;}</div><div class="line"><a name="l09066"></a><span class="lineno"> 9066</span>&#160;</div><div class="line"><a name="l09067"></a><span class="lineno"> 9067</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l09068"></a><span class="lineno"> 9068</span>&#160;<span class="comment"> * log_recreate - RECREATE THE LOG WITHOUT REMOVING THE DATABASE</span></div><div class="line"><a name="l09069"></a><span class="lineno"> 9069</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l09070"></a><span class="lineno"> 9070</span>&#160;<span class="comment"> * return:</span></div><div class="line"><a name="l09071"></a><span class="lineno"> 9071</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l09072"></a><span class="lineno"> 9072</span>&#160;<span class="comment"> *   db_fullname(in): Full name of the database</span></div><div class="line"><a name="l09073"></a><span class="lineno"> 9073</span>&#160;<span class="comment"> *   logpath(in): Directory where the log volumes reside</span></div><div class="line"><a name="l09074"></a><span class="lineno"> 9074</span>&#160;<span class="comment"> *   prefix_logname(in): Name of the log volumes. It is usually set the same as</span></div><div class="line"><a name="l09075"></a><span class="lineno"> 9075</span>&#160;<span class="comment"> *                      database name. For example, if the value is equal to</span></div><div class="line"><a name="l09076"></a><span class="lineno"> 9076</span>&#160;<span class="comment"> *                      &quot;db&quot;, the names of the log volumes created are as</span></div><div class="line"><a name="l09077"></a><span class="lineno"> 9077</span>&#160;<span class="comment"> *                      follow:</span></div><div class="line"><a name="l09078"></a><span class="lineno"> 9078</span>&#160;<span class="comment"> *                      Active_log      = db_logactive</span></div><div class="line"><a name="l09079"></a><span class="lineno"> 9079</span>&#160;<span class="comment"> *                      Archive_logs    = db_logarchive.0</span></div><div class="line"><a name="l09080"></a><span class="lineno"> 9080</span>&#160;<span class="comment"> *                                        db_logarchive.1</span></div><div class="line"><a name="l09081"></a><span class="lineno"> 9081</span>&#160;<span class="comment"> *                                             .</span></div><div class="line"><a name="l09082"></a><span class="lineno"> 9082</span>&#160;<span class="comment"> *                                             .</span></div><div class="line"><a name="l09083"></a><span class="lineno"> 9083</span>&#160;<span class="comment"> *                                             .</span></div><div class="line"><a name="l09084"></a><span class="lineno"> 9084</span>&#160;<span class="comment"> *                                        db_logarchive.n</span></div><div class="line"><a name="l09085"></a><span class="lineno"> 9085</span>&#160;<span class="comment"> *                      Log_information = db_loginfo</span></div><div class="line"><a name="l09086"></a><span class="lineno"> 9086</span>&#160;<span class="comment"> *                      Database Backup = db_backup</span></div><div class="line"><a name="l09087"></a><span class="lineno"> 9087</span>&#160;<span class="comment"> *   log_npages(in): Size of active log in pages</span></div><div class="line"><a name="l09088"></a><span class="lineno"> 9088</span>&#160;<span class="comment"> *   out_fp (in) :</span></div><div class="line"><a name="l09089"></a><span class="lineno"> 9089</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l09090"></a><span class="lineno"> 9090</span>&#160;<span class="comment"> * NOTE: Recreate the active log volume with the new specifications.</span></div><div class="line"><a name="l09091"></a><span class="lineno"> 9091</span>&#160;<span class="comment"> *              All recovery information in each data volume is removed.</span></div><div class="line"><a name="l09092"></a><span class="lineno"> 9092</span>&#160;<span class="comment"> *              If there are anything to recover (e.g., the database suffered</span></div><div class="line"><a name="l09093"></a><span class="lineno"> 9093</span>&#160;<span class="comment"> *              a crash), it is not done. Therefore, it is very important to</span></div><div class="line"><a name="l09094"></a><span class="lineno"> 9094</span>&#160;<span class="comment"> *              make sure that the database does not need to be recovered. You</span></div><div class="line"><a name="l09095"></a><span class="lineno"> 9095</span>&#160;<span class="comment"> *              could restart the database and then shutdown to enfore any</span></div><div class="line"><a name="l09096"></a><span class="lineno"> 9096</span>&#160;<span class="comment"> *              recovery. The database will end up as it is currently on disk.</span></div><div class="line"><a name="l09097"></a><span class="lineno"> 9097</span>&#160;<span class="comment"> *              This function can also be used to restart a database when the</span></div><div class="line"><a name="l09098"></a><span class="lineno"> 9098</span>&#160;<span class="comment"> *              log is corrupted somehow (e.g., system bug, isn&#39;t) or the log</span></div><div class="line"><a name="l09099"></a><span class="lineno"> 9099</span>&#160;<span class="comment"> *              is not available or it suffered a media crash. It can also be</span></div><div class="line"><a name="l09100"></a><span class="lineno"> 9100</span>&#160;<span class="comment"> *              used to move the log to another location. It is recommended to</span></div><div class="line"><a name="l09101"></a><span class="lineno"> 9101</span>&#160;<span class="comment"> *              backup the database before and after the operation is</span></div><div class="line"><a name="l09102"></a><span class="lineno"> 9102</span>&#160;<span class="comment"> *              executed.</span></div><div class="line"><a name="l09103"></a><span class="lineno"> 9103</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l09104"></a><span class="lineno"> 9104</span>&#160;<span class="comment"> *        This function must be run offline. That is, it should not be</span></div><div class="line"><a name="l09105"></a><span class="lineno"> 9105</span>&#160;<span class="comment"> *              run when there are multiusers in the system.</span></div><div class="line"><a name="l09106"></a><span class="lineno"> 9106</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l09107"></a><span class="lineno"> 9107</span>&#160;<span class="keywordtype">int</span></div><div class="line"><a name="l09108"></a><span class="lineno"><a class="line" href="log__manager_8h.html#ab971391e6c5e0d4bdf47fa0be88f4db4"> 9108</a></span>&#160;<a class="code" href="log__manager_8c.html#afd9452b54b685a02fedb03d949b279cb">log_recreate</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <span class="keyword">const</span> <span class="keywordtype">char</span> *db_fullname, <span class="keyword">const</span> <span class="keywordtype">char</span> *logpath, <span class="keyword">const</span> <span class="keywordtype">char</span> *prefix_logname,</div><div class="line"><a name="l09109"></a><span class="lineno"> 9109</span>&#160;          <a class="code" href="storage__common_8h.html#a261e4bc7334f8eabe6e1f0a3d7f7dcb4">DKNPAGES</a> log_npages, FILE * out_fp)</div><div class="line"><a name="l09110"></a><span class="lineno"> 9110</span>&#160;{</div><div class="line"><a name="l09111"></a><span class="lineno"> 9111</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *vlabel;</div><div class="line"><a name="l09112"></a><span class="lineno"> 9112</span>&#160;  <a class="code" href="cm__broker__admin_8c.html#a8606fb1d53339b43e7417d2f96db025f">INT64</a> db_creation;</div><div class="line"><a name="l09113"></a><span class="lineno"> 9113</span>&#160;  <a class="code" href="storage__common_8h.html#a4dd9bcee89c0dcf1d0334b737cc51e9a">DISK_VOLPURPOSE</a> vol_purpose;</div><div class="line"><a name="l09114"></a><span class="lineno"> 9114</span>&#160;  <a class="code" href="structdisk__volume__space__info.html">DISK_VOLUME_SPACE_INFO</a> space_info;</div><div class="line"><a name="l09115"></a><span class="lineno"> 9115</span>&#160;  <a class="code" href="storage__common_8h.html#a0da39ba47abe69bdc4cf837e4890d7ab">VOLID</a> volid;</div><div class="line"><a name="l09116"></a><span class="lineno"> 9116</span>&#160;  <span class="keywordtype">int</span> vdes;</div><div class="line"><a name="l09117"></a><span class="lineno"> 9117</span>&#160;  <a class="code" href="structlog__lsa.html">LOG_LSA</a> init_nontemp_lsa;</div><div class="line"><a name="l09118"></a><span class="lineno"> 9118</span>&#160;  <span class="keywordtype">int</span> ret = <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>;</div><div class="line"><a name="l09119"></a><span class="lineno"> 9119</span>&#160;</div><div class="line"><a name="l09120"></a><span class="lineno"> 9120</span>&#160;  ret = <a class="code" href="disk__manager_8c.html#a24f513433165475abd985275f2eedda2">disk_get_creation_time</a> (thread_p, <a class="code" href="log__impl_8h.html#a4012c5af4c2bbf3def3c0d6ffbd47edb">LOG_DBFIRST_VOLID</a>, &amp;db_creation);</div><div class="line"><a name="l09121"></a><span class="lineno"> 9121</span>&#160;  <span class="keywordflow">if</span> (ret != <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>)</div><div class="line"><a name="l09122"></a><span class="lineno"> 9122</span>&#160;    {</div><div class="line"><a name="l09123"></a><span class="lineno"> 9123</span>&#160;      <span class="keywordflow">return</span> ret;</div><div class="line"><a name="l09124"></a><span class="lineno"> 9124</span>&#160;    }</div><div class="line"><a name="l09125"></a><span class="lineno"> 9125</span>&#160;</div><div class="line"><a name="l09126"></a><span class="lineno"> 9126</span>&#160;  ret = log_create_internal (thread_p, db_fullname, logpath, prefix_logname, log_npages, &amp;db_creation);</div><div class="line"><a name="l09127"></a><span class="lineno"> 9127</span>&#160;  <span class="keywordflow">if</span> (ret != <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>)</div><div class="line"><a name="l09128"></a><span class="lineno"> 9128</span>&#160;    {</div><div class="line"><a name="l09129"></a><span class="lineno"> 9129</span>&#160;      <span class="keywordflow">return</span> ret;</div><div class="line"><a name="l09130"></a><span class="lineno"> 9130</span>&#160;    }</div><div class="line"><a name="l09131"></a><span class="lineno"> 9131</span>&#160;</div><div class="line"><a name="l09132"></a><span class="lineno"> 9132</span>&#160;  (void) log_initialize_internal (thread_p, db_fullname, logpath, prefix_logname, <span class="keyword">false</span>, <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <span class="keyword">true</span>);</div><div class="line"><a name="l09133"></a><span class="lineno"> 9133</span>&#160;</div><div class="line"><a name="l09134"></a><span class="lineno"> 9134</span>&#160;  <span class="comment">/* </span></div><div class="line"><a name="l09135"></a><span class="lineno"> 9135</span>&#160;<span class="comment">   * RESET RECOVERY INFORMATION ON ALL DATA VOLUMES</span></div><div class="line"><a name="l09136"></a><span class="lineno"> 9136</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l09137"></a><span class="lineno"> 9137</span>&#160;</div><div class="line"><a name="l09138"></a><span class="lineno"> 9138</span>&#160;  <a class="code" href="storage__common_8h.html#a6a4baec606189dd320678e8f412ca957">LSA_SET_NULL</a> (&amp;init_nontemp_lsa);</div><div class="line"><a name="l09139"></a><span class="lineno"> 9139</span>&#160;</div><div class="line"><a name="l09140"></a><span class="lineno"> 9140</span>&#160;  <span class="keywordflow">for</span> (volid = <a class="code" href="log__impl_8h.html#a4012c5af4c2bbf3def3c0d6ffbd47edb">LOG_DBFIRST_VOLID</a>; volid != <a class="code" href="storage__common_8h.html#a5859fbd2f7cd3c37c37e672f812388ff">NULL_VOLID</a>; volid = <a class="code" href="file__io_8c.html#a27724bf8b48796a8b30252cef51d9910">fileio_find_next_perm_volume</a> (thread_p, volid))</div><div class="line"><a name="l09141"></a><span class="lineno"> 9141</span>&#160;    {</div><div class="line"><a name="l09142"></a><span class="lineno"> 9142</span>&#160;      <span class="keywordtype">char</span> vol_fullname[<a class="code" href="get__shard__id_8c.html#ae688d728e1acdfe5988c7db45d6f0166">PATH_MAX</a>];</div><div class="line"><a name="l09143"></a><span class="lineno"> 9143</span>&#160;</div><div class="line"><a name="l09144"></a><span class="lineno"> 9144</span>&#160;      vlabel = <a class="code" href="file__io_8c.html#a251cdd92358703f9c482c5d84f8d7dc0">fileio_get_volume_label</a> (volid, <a class="code" href="regcomp_8c.html#aa25dac8b80db8b8f03732eeb9ca23934">PEEK</a>);</div><div class="line"><a name="l09145"></a><span class="lineno"> 9145</span>&#160;</div><div class="line"><a name="l09146"></a><span class="lineno"> 9146</span>&#160;      <span class="comment">/* Find the current pages of the volume and its descriptor */</span></div><div class="line"><a name="l09147"></a><span class="lineno"> 9147</span>&#160;</div><div class="line"><a name="l09148"></a><span class="lineno"> 9148</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="xserver__interface_8h.html#a8523aec0bf38f7fb896126ad26ed6665">xdisk_get_purpose_and_space_info</a> (thread_p, volid, &amp;vol_purpose, &amp;space_info) != <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>)</div><div class="line"><a name="l09149"></a><span class="lineno"> 9149</span>&#160;    {</div><div class="line"><a name="l09150"></a><span class="lineno"> 9150</span>&#160;      <span class="comment">/* we just give up? */</span></div><div class="line"><a name="l09151"></a><span class="lineno"> 9151</span>&#160;      <span class="keywordflow">continue</span>;</div><div class="line"><a name="l09152"></a><span class="lineno"> 9152</span>&#160;    }</div><div class="line"><a name="l09153"></a><span class="lineno"> 9153</span>&#160;</div><div class="line"><a name="l09154"></a><span class="lineno"> 9154</span>&#160;      vdes = <a class="code" href="file__io_8c.html#a9d683e94e5800584f0dfabf144fc758f">fileio_get_volume_descriptor</a> (volid);</div><div class="line"><a name="l09155"></a><span class="lineno"> 9155</span>&#160;</div><div class="line"><a name="l09156"></a><span class="lineno"> 9156</span>&#160;      <span class="comment">/* </span></div><div class="line"><a name="l09157"></a><span class="lineno"> 9157</span>&#160;<span class="comment">       * Flush all dirty pages and then invalidate them from page buffer pool.</span></div><div class="line"><a name="l09158"></a><span class="lineno"> 9158</span>&#160;<span class="comment">       * So that we can reset the recovery information directly using the io</span></div><div class="line"><a name="l09159"></a><span class="lineno"> 9159</span>&#160;<span class="comment">       * module</span></div><div class="line"><a name="l09160"></a><span class="lineno"> 9160</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l09161"></a><span class="lineno"> 9161</span>&#160;</div><div class="line"><a name="l09162"></a><span class="lineno"> 9162</span>&#160;      <a class="code" href="log__impl_8h.html#a5561d6b89dce60cfa780062fae1bb473">LOG_CS_ENTER</a> (thread_p);</div><div class="line"><a name="l09163"></a><span class="lineno"> 9163</span>&#160;      <a class="code" href="log__impl_8h.html#ab5c84aff4d15372a2d150897ad6d2b80">logpb_flush_pages_direct</a> (thread_p);</div><div class="line"><a name="l09164"></a><span class="lineno"> 9164</span>&#160;      <a class="code" href="log__impl_8h.html#a6a5f95ded1a2f38ed00c8e9c039a9f2e">LOG_CS_EXIT</a> (thread_p);</div><div class="line"><a name="l09165"></a><span class="lineno"> 9165</span>&#160;</div><div class="line"><a name="l09166"></a><span class="lineno"> 9166</span>&#160;      (void) <a class="code" href="page__buffer_8c.html#afaab282d5976ee6db15214305dcae248">pgbuf_flush_all</a> (thread_p, volid);</div><div class="line"><a name="l09167"></a><span class="lineno"> 9167</span>&#160;      (void) <a class="code" href="page__buffer_8h.html#a7aba065674febb0ea4b7534c1bb7773c">pgbuf_invalidate_all</a> (thread_p, volid);    <span class="comment">/* it flush and invalidate */</span></div><div class="line"><a name="l09168"></a><span class="lineno"> 9168</span>&#160;</div><div class="line"><a name="l09169"></a><span class="lineno"> 9169</span>&#160;      <span class="keywordflow">if</span> (vol_purpose != <a class="code" href="dbtype__def_8h.html#ae85379d0c7c731c668592fb40e8bc6f2a704030cd9f3edcce778f711af24c7111">DB_TEMPORARY_DATA_PURPOSE</a>)</div><div class="line"><a name="l09170"></a><span class="lineno"> 9170</span>&#160;    {</div><div class="line"><a name="l09171"></a><span class="lineno"> 9171</span>&#160;      (void) <a class="code" href="file__io_8c.html#a2698b23075fc7b789192fe12bb868af9">fileio_reset_volume</a> (thread_p, vdes, vlabel, <a class="code" href="disk__manager_8h.html#a1d6c5b1532a11cd17ca350cddf84aea6">DISK_SECTS_NPAGES</a> (space_info.<a class="code" href="structdisk__volume__space__info.html#a5d523352ce9703b23a43d172b3ce6aaf">n_total_sects</a>),</div><div class="line"><a name="l09172"></a><span class="lineno"> 9172</span>&#160;                      &amp;init_nontemp_lsa);</div><div class="line"><a name="l09173"></a><span class="lineno"> 9173</span>&#160;    }</div><div class="line"><a name="l09174"></a><span class="lineno"> 9174</span>&#160;</div><div class="line"><a name="l09175"></a><span class="lineno"> 9175</span>&#160;      (void) <a class="code" href="disk__manager_8c.html#ad06d8503a3b798b95e324fe9e6be6374">disk_set_creation</a> (thread_p, volid, vlabel, &amp;<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>.<a class="code" href="structlog__header.html#ab7c3c46056f412b19f447caf2ce7b861">db_creation</a>, &amp;<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>.<a class="code" href="structlog__header.html#abd3c92d1eb868dd630bdbfa3561ecf9e">chkpt_lsa</a>, <span class="keyword">false</span>,</div><div class="line"><a name="l09176"></a><span class="lineno"> 9176</span>&#160;                <a class="code" href="disk__manager_8h.html#a061f0551f90af344b54bc6d875cbea17aaf8a1d85c58b4a9f27a82eb8e2c280ec">DISK_DONT_FLUSH</a>);</div><div class="line"><a name="l09177"></a><span class="lineno"> 9177</span>&#160;      <a class="code" href="log__impl_8h.html#a5561d6b89dce60cfa780062fae1bb473">LOG_CS_ENTER</a> (thread_p);</div><div class="line"><a name="l09178"></a><span class="lineno"> 9178</span>&#160;      <a class="code" href="log__impl_8h.html#ab5c84aff4d15372a2d150897ad6d2b80">logpb_flush_pages_direct</a> (thread_p);</div><div class="line"><a name="l09179"></a><span class="lineno"> 9179</span>&#160;      <a class="code" href="log__impl_8h.html#a6a5f95ded1a2f38ed00c8e9c039a9f2e">LOG_CS_EXIT</a> (thread_p);</div><div class="line"><a name="l09180"></a><span class="lineno"> 9180</span>&#160;</div><div class="line"><a name="l09181"></a><span class="lineno"> 9181</span>&#160;      (void) <a class="code" href="page__buffer_8c.html#a8ed4cd7af3b754c2707daa523eeee534">pgbuf_flush_all_unfixed_and_set_lsa_as_null</a> (thread_p, volid);</div><div class="line"><a name="l09182"></a><span class="lineno"> 9182</span>&#160;</div><div class="line"><a name="l09183"></a><span class="lineno"> 9183</span>&#160;      <span class="comment">/* </span></div><div class="line"><a name="l09184"></a><span class="lineno"> 9184</span>&#160;<span class="comment">       * reset temp LSA to special temp LSA</span></div><div class="line"><a name="l09185"></a><span class="lineno"> 9185</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l09186"></a><span class="lineno"> 9186</span>&#160;      (void) <a class="code" href="log__impl_8h.html#a421fd50c31a6b7e87ada9559a39e22c5">logpb_check_and_reset_temp_lsa</a> (thread_p, volid);</div><div class="line"><a name="l09187"></a><span class="lineno"> 9187</span>&#160;</div><div class="line"><a name="l09188"></a><span class="lineno"> 9188</span>&#160;      <span class="comment">/* </span></div><div class="line"><a name="l09189"></a><span class="lineno"> 9189</span>&#160;<span class="comment">       * add volume info to vinf</span></div><div class="line"><a name="l09190"></a><span class="lineno"> 9190</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l09191"></a><span class="lineno"> 9191</span>&#160;      <a class="code" href="xserver__interface_8h.html#a8e1f6f9672d860f0cd4dd45806e8461d">xdisk_get_fullname</a> (thread_p, volid, vol_fullname);</div><div class="line"><a name="l09192"></a><span class="lineno"> 9192</span>&#160;      <a class="code" href="log__impl_8h.html#a2ecd65770a4af1c8d61a8611e0177157">logpb_add_volume</a> (<a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, volid, vol_fullname, vol_purpose);</div><div class="line"><a name="l09193"></a><span class="lineno"> 9193</span>&#160;</div><div class="line"><a name="l09194"></a><span class="lineno"> 9194</span>&#160;      <span class="keywordflow">if</span> (out_fp != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l09195"></a><span class="lineno"> 9195</span>&#160;    {</div><div class="line"><a name="l09196"></a><span class="lineno"> 9196</span>&#160;      fprintf (out_fp, <span class="stringliteral">&quot;%s... done\n&quot;</span>, vol_fullname);</div><div class="line"><a name="l09197"></a><span class="lineno"> 9197</span>&#160;      fflush (out_fp);</div><div class="line"><a name="l09198"></a><span class="lineno"> 9198</span>&#160;    }</div><div class="line"><a name="l09199"></a><span class="lineno"> 9199</span>&#160;    }</div><div class="line"><a name="l09200"></a><span class="lineno"> 9200</span>&#160;</div><div class="line"><a name="l09201"></a><span class="lineno"> 9201</span>&#160;  (void) <a class="code" href="page__buffer_8c.html#afaab282d5976ee6db15214305dcae248">pgbuf_flush_all</a> (thread_p, <a class="code" href="storage__common_8h.html#a5859fbd2f7cd3c37c37e672f812388ff">NULL_VOLID</a>);</div><div class="line"><a name="l09202"></a><span class="lineno"> 9202</span>&#160;  (void) <a class="code" href="file__io_8c.html#a55c9040a1a605ecc2aae549ddc1f4cb0">fileio_synchronize_all</a> (thread_p, <span class="keyword">false</span>);</div><div class="line"><a name="l09203"></a><span class="lineno"> 9203</span>&#160;  (void) <a class="code" href="log__manager_8c.html#a390852f8765cd90576d47d02ef0d10b6">log_commit</a> (thread_p, <a class="code" href="storage__common_8h.html#ab6db6dc2e50e5821d2b8cdbfdeee71ef">NULL_TRAN_INDEX</a>, <span class="keyword">false</span>);</div><div class="line"><a name="l09204"></a><span class="lineno"> 9204</span>&#160;</div><div class="line"><a name="l09205"></a><span class="lineno"> 9205</span>&#160;  <span class="keywordflow">return</span> ret;</div><div class="line"><a name="l09206"></a><span class="lineno"> 9206</span>&#160;}</div><div class="line"><a name="l09207"></a><span class="lineno"> 9207</span>&#160;</div><div class="line"><a name="l09208"></a><span class="lineno"> 9208</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l09209"></a><span class="lineno"> 9209</span>&#160;<span class="comment"> * log_get_io_page_size - FIND SIZE OF DATABASE PAGE</span></div><div class="line"><a name="l09210"></a><span class="lineno"> 9210</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l09211"></a><span class="lineno"> 9211</span>&#160;<span class="comment"> * return:</span></div><div class="line"><a name="l09212"></a><span class="lineno"> 9212</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l09213"></a><span class="lineno"> 9213</span>&#160;<span class="comment"> *   db_fullname(in): Full name of the database</span></div><div class="line"><a name="l09214"></a><span class="lineno"> 9214</span>&#160;<span class="comment"> *   logpath(in): Directory where the log volumes reside</span></div><div class="line"><a name="l09215"></a><span class="lineno"> 9215</span>&#160;<span class="comment"> *   prefix_logname(in): Name of the log volumes. It is usually set as database</span></div><div class="line"><a name="l09216"></a><span class="lineno"> 9216</span>&#160;<span class="comment"> *                      name. For example, if the value is equal to &quot;db&quot;, the</span></div><div class="line"><a name="l09217"></a><span class="lineno"> 9217</span>&#160;<span class="comment"> *                      names of the log volumes created are as follow:</span></div><div class="line"><a name="l09218"></a><span class="lineno"> 9218</span>&#160;<span class="comment"> *                      Active_log      = db_logactive</span></div><div class="line"><a name="l09219"></a><span class="lineno"> 9219</span>&#160;<span class="comment"> *                      Archive_logs    = db_logarchive.0</span></div><div class="line"><a name="l09220"></a><span class="lineno"> 9220</span>&#160;<span class="comment"> *                                        db_logarchive.1</span></div><div class="line"><a name="l09221"></a><span class="lineno"> 9221</span>&#160;<span class="comment"> *                                             .</span></div><div class="line"><a name="l09222"></a><span class="lineno"> 9222</span>&#160;<span class="comment"> *                                             .</span></div><div class="line"><a name="l09223"></a><span class="lineno"> 9223</span>&#160;<span class="comment"> *                                             .</span></div><div class="line"><a name="l09224"></a><span class="lineno"> 9224</span>&#160;<span class="comment"> *                                        db_logarchive.n</span></div><div class="line"><a name="l09225"></a><span class="lineno"> 9225</span>&#160;<span class="comment"> *                      Log_information = db_loginfo</span></div><div class="line"><a name="l09226"></a><span class="lineno"> 9226</span>&#160;<span class="comment"> *                      Database Backup = db_backup</span></div><div class="line"><a name="l09227"></a><span class="lineno"> 9227</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l09228"></a><span class="lineno"> 9228</span>&#160;<span class="comment"> * NOTE: Find size of database page according to the log manager.</span></div><div class="line"><a name="l09229"></a><span class="lineno"> 9229</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l09230"></a><span class="lineno"> 9230</span>&#160;<a class="code" href="storage__common_8h.html#ac3f9d7ae37c5a4cb27570f7313891bc8">PGLENGTH</a></div><div class="line"><a name="l09231"></a><span class="lineno"><a class="line" href="log__manager_8h.html#a1bfabe29d0a3621d3f9d12f3e77cd3ee"> 9231</a></span>&#160;<a class="code" href="log__manager_8c.html#a1bfabe29d0a3621d3f9d12f3e77cd3ee">log_get_io_page_size</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <span class="keyword">const</span> <span class="keywordtype">char</span> *db_fullname, <span class="keyword">const</span> <span class="keywordtype">char</span> *logpath, <span class="keyword">const</span> <span class="keywordtype">char</span> *prefix_logname)</div><div class="line"><a name="l09232"></a><span class="lineno"> 9232</span>&#160;{</div><div class="line"><a name="l09233"></a><span class="lineno"> 9233</span>&#160;  <a class="code" href="storage__common_8h.html#ac3f9d7ae37c5a4cb27570f7313891bc8">PGLENGTH</a> db_iopagesize;</div><div class="line"><a name="l09234"></a><span class="lineno"> 9234</span>&#160;  <a class="code" href="storage__common_8h.html#ac3f9d7ae37c5a4cb27570f7313891bc8">PGLENGTH</a> log_page_size;</div><div class="line"><a name="l09235"></a><span class="lineno"> 9235</span>&#160;  <a class="code" href="cm__broker__admin_8c.html#a8606fb1d53339b43e7417d2f96db025f">INT64</a> ignore_dbcreation;</div><div class="line"><a name="l09236"></a><span class="lineno"> 9236</span>&#160;  <span class="keywordtype">float</span> ignore_dbcomp;</div><div class="line"><a name="l09237"></a><span class="lineno"> 9237</span>&#160;  <span class="keywordtype">int</span> dummy;</div><div class="line"><a name="l09238"></a><span class="lineno"> 9238</span>&#160;</div><div class="line"><a name="l09239"></a><span class="lineno"> 9239</span>&#160;  <a class="code" href="log__impl_8h.html#a5561d6b89dce60cfa780062fae1bb473">LOG_CS_ENTER</a> (thread_p);</div><div class="line"><a name="l09240"></a><span class="lineno"> 9240</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="log__impl_8h.html#a50409f9f65d32d3f4657a3eef2b9e594">logpb_find_header_parameters</a> (thread_p, db_fullname, logpath, prefix_logname, &amp;db_iopagesize,</div><div class="line"><a name="l09241"></a><span class="lineno"> 9241</span>&#160;                    &amp;log_page_size, &amp;ignore_dbcreation, &amp;ignore_dbcomp, &amp;dummy) == -1)</div><div class="line"><a name="l09242"></a><span class="lineno"> 9242</span>&#160;    {</div><div class="line"><a name="l09243"></a><span class="lineno"> 9243</span>&#160;      <span class="comment">/* </span></div><div class="line"><a name="l09244"></a><span class="lineno"> 9244</span>&#160;<span class="comment">       * For case where active log could not be found, user still needs</span></div><div class="line"><a name="l09245"></a><span class="lineno"> 9245</span>&#160;<span class="comment">       * an error.</span></div><div class="line"><a name="l09246"></a><span class="lineno"> 9246</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l09247"></a><span class="lineno"> 9247</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="error__manager_8c.html#a14b629a84676fc1e0aad0c58f0c222c0">er_errid</a> () == <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>)</div><div class="line"><a name="l09248"></a><span class="lineno"> 9248</span>&#160;    {</div><div class="line"><a name="l09249"></a><span class="lineno"> 9249</span>&#160;      <a class="code" href="error__manager_8c.html#afdaf87ce30f2f557802a185ab85b6599">er_set</a> (<a class="code" href="error__manager_8h.html#a5d0d456c474e11fc70779873a30a7432a07ad8f9fda27124d297c94b7d3ea44e8">ER_ERROR_SEVERITY</a>, <a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <a class="code" href="error__code_8h.html#a2212df4c388a4b5343567efe29fc7bfa">ER_LOG_MOUNT_FAIL</a>, 1, <a class="code" href="log__global_8c.html#aef1e7912abb0cade6fe0dd266292df20">log_Name_active</a>);</div><div class="line"><a name="l09250"></a><span class="lineno"> 9250</span>&#160;    }</div><div class="line"><a name="l09251"></a><span class="lineno"> 9251</span>&#160;</div><div class="line"><a name="l09252"></a><span class="lineno"> 9252</span>&#160;      <a class="code" href="log__impl_8h.html#a6a5f95ded1a2f38ed00c8e9c039a9f2e">LOG_CS_EXIT</a> (thread_p);</div><div class="line"><a name="l09253"></a><span class="lineno"> 9253</span>&#160;      <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l09254"></a><span class="lineno"> 9254</span>&#160;    }</div><div class="line"><a name="l09255"></a><span class="lineno"> 9255</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l09256"></a><span class="lineno"> 9256</span>&#160;    {</div><div class="line"><a name="l09257"></a><span class="lineno"> 9257</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="storage__common_8h.html#a097b8646f24ea98e209e18c53d74522a">IO_PAGESIZE</a> != db_iopagesize || <a class="code" href="storage__common_8h.html#a1a7b7663aee8b9e8b1df6b1fbd5a88b9">LOG_PAGESIZE</a> != log_page_size)</div><div class="line"><a name="l09258"></a><span class="lineno"> 9258</span>&#160;    {</div><div class="line"><a name="l09259"></a><span class="lineno"> 9259</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="storage__common_8c.html#aa2fc36147d16be92850b4acfabeba733">db_set_page_size</a> (db_iopagesize, log_page_size) != <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>)</div><div class="line"><a name="l09260"></a><span class="lineno"> 9260</span>&#160;        {</div><div class="line"><a name="l09261"></a><span class="lineno"> 9261</span>&#160;          <a class="code" href="log__impl_8h.html#a6a5f95ded1a2f38ed00c8e9c039a9f2e">LOG_CS_EXIT</a> (thread_p);</div><div class="line"><a name="l09262"></a><span class="lineno"> 9262</span>&#160;          <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l09263"></a><span class="lineno"> 9263</span>&#160;        }</div><div class="line"><a name="l09264"></a><span class="lineno"> 9264</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l09265"></a><span class="lineno"> 9265</span>&#160;        {</div><div class="line"><a name="l09266"></a><span class="lineno"> 9266</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="system__parameter_8c.html#a5e5c602234655dfab40f1816b2bb3305">sysprm_reload_and_init</a> (<a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>, <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) != <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>)</div><div class="line"><a name="l09267"></a><span class="lineno"> 9267</span>&#160;        {</div><div class="line"><a name="l09268"></a><span class="lineno"> 9268</span>&#160;          <a class="code" href="log__impl_8h.html#a6a5f95ded1a2f38ed00c8e9c039a9f2e">LOG_CS_EXIT</a> (thread_p);</div><div class="line"><a name="l09269"></a><span class="lineno"> 9269</span>&#160;          <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l09270"></a><span class="lineno"> 9270</span>&#160;        }</div><div class="line"><a name="l09271"></a><span class="lineno"> 9271</span>&#160;</div><div class="line"><a name="l09272"></a><span class="lineno"> 9272</span>&#160;          <span class="comment">/* page size changed, reinit tran tables only if previously initialized */</span></div><div class="line"><a name="l09273"></a><span class="lineno"> 9273</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a4cf383467135a4aa88ffe54e788b4706">trantable</a>.<a class="code" href="structtrantable.html#a51008043f102cad94fc4832a72f1aa47">area</a> == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l09274"></a><span class="lineno"> 9274</span>&#160;        {</div><div class="line"><a name="l09275"></a><span class="lineno"> 9275</span>&#160;          <a class="code" href="log__impl_8h.html#a6a5f95ded1a2f38ed00c8e9c039a9f2e">LOG_CS_EXIT</a> (thread_p);</div><div class="line"><a name="l09276"></a><span class="lineno"> 9276</span>&#160;          <span class="keywordflow">return</span> db_iopagesize;</div><div class="line"><a name="l09277"></a><span class="lineno"> 9277</span>&#160;        }</div><div class="line"><a name="l09278"></a><span class="lineno"> 9278</span>&#160;</div><div class="line"><a name="l09279"></a><span class="lineno"> 9279</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="log__impl_8h.html#ac27166ed5a81c72375cfccc620c702da">logtb_define_trantable_log_latch</a> (thread_p, <a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a4cf383467135a4aa88ffe54e788b4706">trantable</a>.<a class="code" href="structtrantable.html#a4a29a2fef75af5ba908037e1ad1218e0">num_total_indices</a>) != <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>)</div><div class="line"><a name="l09280"></a><span class="lineno"> 9280</span>&#160;        {</div><div class="line"><a name="l09281"></a><span class="lineno"> 9281</span>&#160;          <a class="code" href="log__impl_8h.html#a6a5f95ded1a2f38ed00c8e9c039a9f2e">LOG_CS_EXIT</a> (thread_p);</div><div class="line"><a name="l09282"></a><span class="lineno"> 9282</span>&#160;          <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l09283"></a><span class="lineno"> 9283</span>&#160;        }</div><div class="line"><a name="l09284"></a><span class="lineno"> 9284</span>&#160;        }</div><div class="line"><a name="l09285"></a><span class="lineno"> 9285</span>&#160;</div><div class="line"><a name="l09286"></a><span class="lineno"> 9286</span>&#160;    }</div><div class="line"><a name="l09287"></a><span class="lineno"> 9287</span>&#160;</div><div class="line"><a name="l09288"></a><span class="lineno"> 9288</span>&#160;      <a class="code" href="log__impl_8h.html#a6a5f95ded1a2f38ed00c8e9c039a9f2e">LOG_CS_EXIT</a> (thread_p);</div><div class="line"><a name="l09289"></a><span class="lineno"> 9289</span>&#160;</div><div class="line"><a name="l09290"></a><span class="lineno"> 9290</span>&#160;      <span class="keywordflow">return</span> db_iopagesize;</div><div class="line"><a name="l09291"></a><span class="lineno"> 9291</span>&#160;    }</div><div class="line"><a name="l09292"></a><span class="lineno"> 9292</span>&#160;}</div><div class="line"><a name="l09293"></a><span class="lineno"> 9293</span>&#160;</div><div class="line"><a name="l09294"></a><span class="lineno"> 9294</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l09295"></a><span class="lineno"> 9295</span>&#160;<span class="comment"> * log_get_charset_from_header_page - get charset stored in header page</span></div><div class="line"><a name="l09296"></a><span class="lineno"> 9296</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l09297"></a><span class="lineno"> 9297</span>&#160;<span class="comment"> * return: charset id (non-negative values are valid)</span></div><div class="line"><a name="l09298"></a><span class="lineno"> 9298</span>&#160;<span class="comment"> *     -1 if header page cannot be used to determine database charset</span></div><div class="line"><a name="l09299"></a><span class="lineno"> 9299</span>&#160;<span class="comment"> *     -2 if an error occurs</span></div><div class="line"><a name="l09300"></a><span class="lineno"> 9300</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l09301"></a><span class="lineno"> 9301</span>&#160;<span class="comment"> *  See log_get_io_page_size for arguments</span></div><div class="line"><a name="l09302"></a><span class="lineno"> 9302</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l09303"></a><span class="lineno"> 9303</span>&#160;<span class="keywordtype">int</span></div><div class="line"><a name="l09304"></a><span class="lineno"><a class="line" href="log__manager_8h.html#a0cb138cb6e789ecf8abb67698e42abd2"> 9304</a></span>&#160;<a class="code" href="log__manager_8c.html#a0cb138cb6e789ecf8abb67698e42abd2">log_get_charset_from_header_page</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <span class="keyword">const</span> <span class="keywordtype">char</span> *db_fullname, <span class="keyword">const</span> <span class="keywordtype">char</span> *logpath,</div><div class="line"><a name="l09305"></a><span class="lineno"> 9305</span>&#160;                  <span class="keyword">const</span> <span class="keywordtype">char</span> *prefix_logname)</div><div class="line"><a name="l09306"></a><span class="lineno"> 9306</span>&#160;{</div><div class="line"><a name="l09307"></a><span class="lineno"> 9307</span>&#160;  <a class="code" href="storage__common_8h.html#ac3f9d7ae37c5a4cb27570f7313891bc8">PGLENGTH</a> dummy_db_iopagesize;</div><div class="line"><a name="l09308"></a><span class="lineno"> 9308</span>&#160;  <a class="code" href="storage__common_8h.html#ac3f9d7ae37c5a4cb27570f7313891bc8">PGLENGTH</a> dummy_ignore_log_page_size;</div><div class="line"><a name="l09309"></a><span class="lineno"> 9309</span>&#160;  <a class="code" href="cm__broker__admin_8c.html#a8606fb1d53339b43e7417d2f96db025f">INT64</a> dummy_ignore_dbcreation;</div><div class="line"><a name="l09310"></a><span class="lineno"> 9310</span>&#160;  <span class="keywordtype">float</span> dummy_ignore_dbcomp;</div><div class="line"><a name="l09311"></a><span class="lineno"> 9311</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="structdb__charset.html">db_charset</a> = <a class="code" href="intl__support_8h.html#a62642b38e69c029c39114bb176d2f4b7a6d75f4183f1792ba969f6dc176909de6">INTL_CODESET_NONE</a>;</div><div class="line"><a name="l09312"></a><span class="lineno"> 9312</span>&#160;</div><div class="line"><a name="l09313"></a><span class="lineno"> 9313</span>&#160;  <a class="code" href="log__impl_8h.html#a5561d6b89dce60cfa780062fae1bb473">LOG_CS_ENTER</a> (thread_p);</div><div class="line"><a name="l09314"></a><span class="lineno"> 9314</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="log__impl_8h.html#a50409f9f65d32d3f4657a3eef2b9e594">logpb_find_header_parameters</a> (thread_p, db_fullname, logpath, prefix_logname, &amp;dummy_db_iopagesize,</div><div class="line"><a name="l09315"></a><span class="lineno"> 9315</span>&#160;                    &amp;dummy_ignore_log_page_size, &amp;dummy_ignore_dbcreation, &amp;dummy_ignore_dbcomp,</div><div class="line"><a name="l09316"></a><span class="lineno"> 9316</span>&#160;                    &amp;<a class="code" href="structdb__charset.html">db_charset</a>) == -1)</div><div class="line"><a name="l09317"></a><span class="lineno"> 9317</span>&#160;    {</div><div class="line"><a name="l09318"></a><span class="lineno"> 9318</span>&#160;      <span class="comment">/* </span></div><div class="line"><a name="l09319"></a><span class="lineno"> 9319</span>&#160;<span class="comment">       * For case where active log could not be found, user still needs</span></div><div class="line"><a name="l09320"></a><span class="lineno"> 9320</span>&#160;<span class="comment">       * an error.</span></div><div class="line"><a name="l09321"></a><span class="lineno"> 9321</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l09322"></a><span class="lineno"> 9322</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="error__manager_8c.html#a14b629a84676fc1e0aad0c58f0c222c0">er_errid</a> () == <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>)</div><div class="line"><a name="l09323"></a><span class="lineno"> 9323</span>&#160;    {</div><div class="line"><a name="l09324"></a><span class="lineno"> 9324</span>&#160;      <a class="code" href="error__manager_8c.html#afdaf87ce30f2f557802a185ab85b6599">er_set</a> (<a class="code" href="error__manager_8h.html#a5d0d456c474e11fc70779873a30a7432a07ad8f9fda27124d297c94b7d3ea44e8">ER_ERROR_SEVERITY</a>, <a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <a class="code" href="error__code_8h.html#a2212df4c388a4b5343567efe29fc7bfa">ER_LOG_MOUNT_FAIL</a>, 1, <a class="code" href="log__global_8c.html#aef1e7912abb0cade6fe0dd266292df20">log_Name_active</a>);</div><div class="line"><a name="l09325"></a><span class="lineno"> 9325</span>&#160;    }</div><div class="line"><a name="l09326"></a><span class="lineno"> 9326</span>&#160;</div><div class="line"><a name="l09327"></a><span class="lineno"> 9327</span>&#160;      <a class="code" href="log__impl_8h.html#a6a5f95ded1a2f38ed00c8e9c039a9f2e">LOG_CS_EXIT</a> (thread_p);</div><div class="line"><a name="l09328"></a><span class="lineno"> 9328</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="intl__support_8h.html#a62642b38e69c029c39114bb176d2f4b7abbaa6e2d6b1053eb96c607def4aa6dec">INTL_CODESET_ERROR</a>;</div><div class="line"><a name="l09329"></a><span class="lineno"> 9329</span>&#160;    }</div><div class="line"><a name="l09330"></a><span class="lineno"> 9330</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l09331"></a><span class="lineno"> 9331</span>&#160;    {</div><div class="line"><a name="l09332"></a><span class="lineno"> 9332</span>&#160;      <a class="code" href="log__impl_8h.html#a6a5f95ded1a2f38ed00c8e9c039a9f2e">LOG_CS_EXIT</a> (thread_p);</div><div class="line"><a name="l09333"></a><span class="lineno"> 9333</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="structdb__charset.html">db_charset</a>;</div><div class="line"><a name="l09334"></a><span class="lineno"> 9334</span>&#160;    }</div><div class="line"><a name="l09335"></a><span class="lineno"> 9335</span>&#160;}</div><div class="line"><a name="l09336"></a><span class="lineno"> 9336</span>&#160;</div><div class="line"><a name="l09337"></a><span class="lineno"> 9337</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l09338"></a><span class="lineno"> 9338</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l09339"></a><span class="lineno"> 9339</span>&#160;<span class="comment"> *                         GENERIC RECOVERY FUNCTIONS</span></div><div class="line"><a name="l09340"></a><span class="lineno"> 9340</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l09341"></a><span class="lineno"> 9341</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l09342"></a><span class="lineno"> 9342</span>&#160;</div><div class="line"><a name="l09343"></a><span class="lineno"> 9343</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l09344"></a><span class="lineno"> 9344</span>&#160;<span class="comment"> * log_rv_copy_char - Recover (undo or redo) a string of chars/bytes</span></div><div class="line"><a name="l09345"></a><span class="lineno"> 9345</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l09346"></a><span class="lineno"> 9346</span>&#160;<span class="comment"> * return: nothing</span></div><div class="line"><a name="l09347"></a><span class="lineno"> 9347</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l09348"></a><span class="lineno"> 9348</span>&#160;<span class="comment"> *   rcv(in): Recovery structure</span></div><div class="line"><a name="l09349"></a><span class="lineno"> 9349</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l09350"></a><span class="lineno"> 9350</span>&#160;<span class="comment"> * NOTE: Recover (undo/redo) by copying a string of characters/bytes</span></div><div class="line"><a name="l09351"></a><span class="lineno"> 9351</span>&#160;<span class="comment"> *              onto the specified location. This function can be used for</span></div><div class="line"><a name="l09352"></a><span class="lineno"> 9352</span>&#160;<span class="comment"> *              physical logging.</span></div><div class="line"><a name="l09353"></a><span class="lineno"> 9353</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l09354"></a><span class="lineno"> 9354</span>&#160;<span class="keywordtype">int</span></div><div class="line"><a name="l09355"></a><span class="lineno"><a class="line" href="log__manager_8h.html#aa93022b3b73e1ae38f14554977bbe6c5"> 9355</a></span>&#160;<a class="code" href="log__manager_8c.html#aa93022b3b73e1ae38f14554977bbe6c5">log_rv_copy_char</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="structlog__rcv.html">LOG_RCV</a> * rcv)</div><div class="line"><a name="l09356"></a><span class="lineno"> 9356</span>&#160;{</div><div class="line"><a name="l09357"></a><span class="lineno"> 9357</span>&#160;  <span class="keywordtype">char</span> *to_data;</div><div class="line"><a name="l09358"></a><span class="lineno"> 9358</span>&#160;</div><div class="line"><a name="l09359"></a><span class="lineno"> 9359</span>&#160;  <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (rcv-&gt;<a class="code" href="structlog__rcv.html#a4acc4ed244fcaa09adea314ee4f7b861">offset</a> + rcv-&gt;<a class="code" href="structlog__rcv.html#aa86dfb9bbc9edce109df26aacf699915">length</a> &lt;= <a class="code" href="storage__common_8h.html#a4b07671fd9c9a16c3c37363d09050ac5">DB_PAGESIZE</a>);</div><div class="line"><a name="l09360"></a><span class="lineno"> 9360</span>&#160;</div><div class="line"><a name="l09361"></a><span class="lineno"> 9361</span>&#160;  to_data = (<span class="keywordtype">char</span> *) rcv-&gt;<a class="code" href="structlog__rcv.html#a04db9f252907cff6ca339534e8c4f642">pgptr</a> + rcv-&gt;<a class="code" href="structlog__rcv.html#a4acc4ed244fcaa09adea314ee4f7b861">offset</a>;</div><div class="line"><a name="l09362"></a><span class="lineno"> 9362</span>&#160;  memcpy (to_data, rcv-&gt;<a class="code" href="structlog__rcv.html#afc672de81dd88914d00281fada1acc13">data</a>, rcv-&gt;<a class="code" href="structlog__rcv.html#aa86dfb9bbc9edce109df26aacf699915">length</a>);</div><div class="line"><a name="l09363"></a><span class="lineno"> 9363</span>&#160;  <a class="code" href="page__buffer_8c.html#a09e2ab7104c4384bafcd3cf693a49719">pgbuf_set_dirty</a> (thread_p, rcv-&gt;<a class="code" href="structlog__rcv.html#a04db9f252907cff6ca339534e8c4f642">pgptr</a>, <a class="code" href="page__buffer_8h.html#ae91a9e4bbf8b67fb56af5193d8dde649">DONT_FREE</a>);</div><div class="line"><a name="l09364"></a><span class="lineno"> 9364</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>;</div><div class="line"><a name="l09365"></a><span class="lineno"> 9365</span>&#160;}</div><div class="line"><a name="l09366"></a><span class="lineno"> 9366</span>&#160;</div><div class="line"><a name="l09367"></a><span class="lineno"> 9367</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l09368"></a><span class="lineno"> 9368</span>&#160;<span class="comment"> * log_rv_dump_char - DUMP INFORMATION TO RECOVER A SET CHARS/BYTES</span></div><div class="line"><a name="l09369"></a><span class="lineno"> 9369</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l09370"></a><span class="lineno"> 9370</span>&#160;<span class="comment"> * return: nothing</span></div><div class="line"><a name="l09371"></a><span class="lineno"> 9371</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l09372"></a><span class="lineno"> 9372</span>&#160;<span class="comment"> *   length(in): Length of Recovery Data</span></div><div class="line"><a name="l09373"></a><span class="lineno"> 9373</span>&#160;<span class="comment"> *   data(in): The data being logged</span></div><div class="line"><a name="l09374"></a><span class="lineno"> 9374</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l09375"></a><span class="lineno"> 9375</span>&#160;<span class="comment"> * NOTE:Dump the information to recover a set of characters/bytes.</span></div><div class="line"><a name="l09376"></a><span class="lineno"> 9376</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l09377"></a><span class="lineno"> 9377</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l09378"></a><span class="lineno"><a class="line" href="log__manager_8h.html#a5ba507076ad3cea01e22155b6da9b119"> 9378</a></span>&#160;<a class="code" href="log__manager_8c.html#a5ba507076ad3cea01e22155b6da9b119">log_rv_dump_char</a> (FILE * fp, <span class="keywordtype">int</span> length, <span class="keywordtype">void</span> *<a class="code" href="namespacestatdump__to__csv.html#aedcb70fde9c0b07a0732db70deeec616">data</a>)</div><div class="line"><a name="l09379"></a><span class="lineno"> 9379</span>&#160;{</div><div class="line"><a name="l09380"></a><span class="lineno"> 9380</span>&#160;  log_ascii_dump (fp, length, <a class="code" href="namespacestatdump__to__csv.html#aedcb70fde9c0b07a0732db70deeec616">data</a>);</div><div class="line"><a name="l09381"></a><span class="lineno"> 9381</span>&#160;  fprintf (fp, <span class="stringliteral">&quot;\n&quot;</span>);</div><div class="line"><a name="l09382"></a><span class="lineno"> 9382</span>&#160;}</div><div class="line"><a name="l09383"></a><span class="lineno"> 9383</span>&#160;</div><div class="line"><a name="l09384"></a><span class="lineno"> 9384</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l09385"></a><span class="lineno"> 9385</span>&#160;<span class="comment"> * log_rv_dump_hexa () - Point recovery data as hexadecimals.</span></div><div class="line"><a name="l09386"></a><span class="lineno"> 9386</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l09387"></a><span class="lineno"> 9387</span>&#160;<span class="comment"> * return      : Void.</span></div><div class="line"><a name="l09388"></a><span class="lineno"> 9388</span>&#160;<span class="comment"> * fp (in)     : Print output.</span></div><div class="line"><a name="l09389"></a><span class="lineno"> 9389</span>&#160;<span class="comment"> * length (in) : Recovery data length.</span></div><div class="line"><a name="l09390"></a><span class="lineno"> 9390</span>&#160;<span class="comment"> * data (in)   : Recovery data.</span></div><div class="line"><a name="l09391"></a><span class="lineno"> 9391</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l09392"></a><span class="lineno"> 9392</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l09393"></a><span class="lineno"><a class="line" href="log__manager_8h.html#a63b25dae7a31d1ae590d85983af195da"> 9393</a></span>&#160;<a class="code" href="log__manager_8c.html#a63b25dae7a31d1ae590d85983af195da">log_rv_dump_hexa</a> (FILE * fp, <span class="keywordtype">int</span> length, <span class="keywordtype">void</span> *<a class="code" href="namespacestatdump__to__csv.html#aedcb70fde9c0b07a0732db70deeec616">data</a>)</div><div class="line"><a name="l09394"></a><span class="lineno"> 9394</span>&#160;{</div><div class="line"><a name="l09395"></a><span class="lineno"> 9395</span>&#160;  log_hexa_dump (fp, length, <a class="code" href="namespacestatdump__to__csv.html#aedcb70fde9c0b07a0732db70deeec616">data</a>);</div><div class="line"><a name="l09396"></a><span class="lineno"> 9396</span>&#160;}</div><div class="line"><a name="l09397"></a><span class="lineno"> 9397</span>&#160;</div><div class="line"><a name="l09398"></a><span class="lineno"> 9398</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l09399"></a><span class="lineno"> 9399</span>&#160;<span class="comment"> * log_rv_outside_noop_redo - NO-OP of an outside REDO</span></div><div class="line"><a name="l09400"></a><span class="lineno"> 9400</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l09401"></a><span class="lineno"> 9401</span>&#160;<span class="comment"> * return: nothing</span></div><div class="line"><a name="l09402"></a><span class="lineno"> 9402</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l09403"></a><span class="lineno"> 9403</span>&#160;<span class="comment"> *   rcv(in): Recovery structure</span></div><div class="line"><a name="l09404"></a><span class="lineno"> 9404</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l09405"></a><span class="lineno"> 9405</span>&#160;<span class="comment"> * NOTE: No-op of an outside redo.</span></div><div class="line"><a name="l09406"></a><span class="lineno"> 9406</span>&#160;<span class="comment"> *              This can used to fool the recovery manager when doing a</span></div><div class="line"><a name="l09407"></a><span class="lineno"> 9407</span>&#160;<span class="comment"> *              logical UNDO which fails (e.g., unregistering a file that has</span></div><div class="line"><a name="l09408"></a><span class="lineno"> 9408</span>&#160;<span class="comment"> *              already been unregistered) or when doing an external/outside</span></div><div class="line"><a name="l09409"></a><span class="lineno"> 9409</span>&#160;<span class="comment"> *              (e.g., removing a temporary volume) the data base domain.</span></div><div class="line"><a name="l09410"></a><span class="lineno"> 9410</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l09411"></a><span class="lineno"> 9411</span>&#160;<span class="keywordtype">int</span></div><div class="line"><a name="l09412"></a><span class="lineno"><a class="line" href="log__manager_8h.html#ac92df3fb17efd887483ccf4616f20f27"> 9412</a></span>&#160;<a class="code" href="log__manager_8c.html#ac92df3fb17efd887483ccf4616f20f27">log_rv_outside_noop_redo</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="structlog__rcv.html">LOG_RCV</a> * rcv)</div><div class="line"><a name="l09413"></a><span class="lineno"> 9413</span>&#160;{</div><div class="line"><a name="l09414"></a><span class="lineno"> 9414</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>;</div><div class="line"><a name="l09415"></a><span class="lineno"> 9415</span>&#160;}</div><div class="line"><a name="l09416"></a><span class="lineno"> 9416</span>&#160;</div><div class="line"><a name="l09417"></a><span class="lineno"> 9417</span>&#160;<span class="preprocessor">#if defined (ENABLE_UNUSED_FUNCTION)</span></div><div class="line"><a name="l09418"></a><span class="lineno"> 9418</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l09419"></a><span class="lineno"> 9419</span>&#160;<span class="comment"> * log_simulate_crash - Simulate a system crash</span></div><div class="line"><a name="l09420"></a><span class="lineno"> 9420</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l09421"></a><span class="lineno"> 9421</span>&#160;<span class="comment"> * return: nothing</span></div><div class="line"><a name="l09422"></a><span class="lineno"> 9422</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l09423"></a><span class="lineno"> 9423</span>&#160;<span class="comment"> *   flush_log(in): Flush the log before the crash simulation?</span></div><div class="line"><a name="l09424"></a><span class="lineno"> 9424</span>&#160;<span class="comment"> *   flush_data_pages(in): Flush the data pages (page buffer pool) before the</span></div><div class="line"><a name="l09425"></a><span class="lineno"> 9425</span>&#160;<span class="comment"> *                      crash simulation?</span></div><div class="line"><a name="l09426"></a><span class="lineno"> 9426</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l09427"></a><span class="lineno"> 9427</span>&#160;<span class="comment"> * NOTE:Simulate a system crash. If flush_data_pages is true,  the</span></div><div class="line"><a name="l09428"></a><span class="lineno"> 9428</span>&#160;<span class="comment"> *              data page buffer pool is flushed and the log buffer pool is</span></div><div class="line"><a name="l09429"></a><span class="lineno"> 9429</span>&#160;<span class="comment"> *              flushed too regardless of the value of flush_log. If flush_log</span></div><div class="line"><a name="l09430"></a><span class="lineno"> 9430</span>&#160;<span class="comment"> *              is true, the log buffer pool is flushed.</span></div><div class="line"><a name="l09431"></a><span class="lineno"> 9431</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l09432"></a><span class="lineno"> 9432</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l09433"></a><span class="lineno"> 9433</span>&#160;log_simulate_crash (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <span class="keywordtype">int</span> flush_log, <span class="keywordtype">int</span> flush_data_pages)</div><div class="line"><a name="l09434"></a><span class="lineno"> 9434</span>&#160;{</div><div class="line"><a name="l09435"></a><span class="lineno"> 9435</span>&#160;  <a class="code" href="log__impl_8h.html#a5561d6b89dce60cfa780062fae1bb473">LOG_CS_ENTER</a> (thread_p);</div><div class="line"><a name="l09436"></a><span class="lineno"> 9436</span>&#160;</div><div class="line"><a name="l09437"></a><span class="lineno"> 9437</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a4cf383467135a4aa88ffe54e788b4706">trantable</a>.<a class="code" href="structtrantable.html#a51008043f102cad94fc4832a72f1aa47">area</a> == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a> || !<a class="code" href="log__impl_8h.html#ae4025cb5dfaa1070ed2fafc0ec63943e">logpb_is_pool_initialized</a> ())</div><div class="line"><a name="l09438"></a><span class="lineno"> 9438</span>&#160;    {</div><div class="line"><a name="l09439"></a><span class="lineno"> 9439</span>&#160;      <a class="code" href="log__impl_8h.html#a6a5f95ded1a2f38ed00c8e9c039a9f2e">LOG_CS_EXIT</a> (thread_p);</div><div class="line"><a name="l09440"></a><span class="lineno"> 9440</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l09441"></a><span class="lineno"> 9441</span>&#160;    }</div><div class="line"><a name="l09442"></a><span class="lineno"> 9442</span>&#160;</div><div class="line"><a name="l09443"></a><span class="lineno"> 9443</span>&#160;  <span class="keywordflow">if</span> (flush_log != <span class="keyword">false</span> || flush_data_pages != <span class="keyword">false</span>)</div><div class="line"><a name="l09444"></a><span class="lineno"> 9444</span>&#160;    {</div><div class="line"><a name="l09445"></a><span class="lineno"> 9445</span>&#160;      <a class="code" href="log__impl_8h.html#ab5c84aff4d15372a2d150897ad6d2b80">logpb_flush_pages_direct</a> (thread_p);</div><div class="line"><a name="l09446"></a><span class="lineno"> 9446</span>&#160;    }</div><div class="line"><a name="l09447"></a><span class="lineno"> 9447</span>&#160;</div><div class="line"><a name="l09448"></a><span class="lineno"> 9448</span>&#160;  <span class="keywordflow">if</span> (flush_data_pages)</div><div class="line"><a name="l09449"></a><span class="lineno"> 9449</span>&#160;    {</div><div class="line"><a name="l09450"></a><span class="lineno"> 9450</span>&#160;      (void) <a class="code" href="page__buffer_8c.html#afaab282d5976ee6db15214305dcae248">pgbuf_flush_all</a> (thread_p, <a class="code" href="storage__common_8h.html#a5859fbd2f7cd3c37c37e672f812388ff">NULL_VOLID</a>);</div><div class="line"><a name="l09451"></a><span class="lineno"> 9451</span>&#160;      (void) <a class="code" href="file__io_8c.html#a55c9040a1a605ecc2aae549ddc1f4cb0">fileio_synchronize_all</a> (thread_p, <span class="keyword">false</span>);</div><div class="line"><a name="l09452"></a><span class="lineno"> 9452</span>&#160;    }</div><div class="line"><a name="l09453"></a><span class="lineno"> 9453</span>&#160;</div><div class="line"><a name="l09454"></a><span class="lineno"> 9454</span>&#160;  <span class="comment">/* Undefine log buffer pool and transaction table */</span></div><div class="line"><a name="l09455"></a><span class="lineno"> 9455</span>&#160;</div><div class="line"><a name="l09456"></a><span class="lineno"> 9456</span>&#160;  <a class="code" href="log__impl_8h.html#a5ea6483fb4af95ef44ff7eb9d6d35a05">logpb_finalize_pool</a> (thread_p);</div><div class="line"><a name="l09457"></a><span class="lineno"> 9457</span>&#160;  <a class="code" href="log__impl_8h.html#af3b0bac26ee4d5867e1ae5fb093e798a">logtb_undefine_trantable</a> (thread_p);</div><div class="line"><a name="l09458"></a><span class="lineno"> 9458</span>&#160;</div><div class="line"><a name="l09459"></a><span class="lineno"> 9459</span>&#160;  <a class="code" href="log__impl_8h.html#a6a5f95ded1a2f38ed00c8e9c039a9f2e">LOG_CS_EXIT</a> (thread_p);</div><div class="line"><a name="l09460"></a><span class="lineno"> 9460</span>&#160;</div><div class="line"><a name="l09461"></a><span class="lineno"> 9461</span>&#160;  <a class="code" href="log__impl_8h.html#a84f37ef4ed6965224995a001ad15ba7e">LOG_SET_CURRENT_TRAN_INDEX</a> (thread_p, <a class="code" href="storage__common_8h.html#ab6db6dc2e50e5821d2b8cdbfdeee71ef">NULL_TRAN_INDEX</a>);</div><div class="line"><a name="l09462"></a><span class="lineno"> 9462</span>&#160;}</div><div class="line"><a name="l09463"></a><span class="lineno"> 9463</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* ENABLE_UNUSED_FUNCTION */</span><span class="preprocessor"></span></div><div class="line"><a name="l09464"></a><span class="lineno"> 9464</span>&#160;</div><div class="line"><a name="l09465"></a><span class="lineno"> 9465</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l09466"></a><span class="lineno"> 9466</span>&#160;<span class="comment"> * log_active_log_header_start_scan () -</span></div><div class="line"><a name="l09467"></a><span class="lineno"> 9467</span>&#160;<span class="comment"> *   return: NO_ERROR, or ER_code</span></div><div class="line"><a name="l09468"></a><span class="lineno"> 9468</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l09469"></a><span class="lineno"> 9469</span>&#160;<span class="comment"> *   thread_p(in):</span></div><div class="line"><a name="l09470"></a><span class="lineno"> 9470</span>&#160;<span class="comment"> *   show_type(in):</span></div><div class="line"><a name="l09471"></a><span class="lineno"> 9471</span>&#160;<span class="comment"> *   arg_values(in):</span></div><div class="line"><a name="l09472"></a><span class="lineno"> 9472</span>&#160;<span class="comment"> *   arg_cnt(in):</span></div><div class="line"><a name="l09473"></a><span class="lineno"> 9473</span>&#160;<span class="comment"> *   ptr(out): allocate new context. should free by end_scan() function</span></div><div class="line"><a name="l09474"></a><span class="lineno"> 9474</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l09475"></a><span class="lineno"> 9475</span>&#160;<span class="keywordtype">int</span></div><div class="line"><a name="l09476"></a><span class="lineno"><a class="line" href="log__manager_8h.html#afccabc79e094d4f573bb480f3b3e24ca"> 9476</a></span>&#160;<a class="code" href="log__manager_8c.html#afccabc79e094d4f573bb480f3b3e24ca">log_active_log_header_start_scan</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <span class="keywordtype">int</span> show_type, <a class="code" href="structdb__value.html">DB_VALUE</a> ** arg_values, <span class="keywordtype">int</span> arg_cnt,</div><div class="line"><a name="l09477"></a><span class="lineno"> 9477</span>&#160;                  <span class="keywordtype">void</span> **<a class="code" href="expat_8h.html#aaf0497a3bd20a0066017546af6bf80be">ptr</a>)</div><div class="line"><a name="l09478"></a><span class="lineno"> 9478</span>&#160;{</div><div class="line"><a name="l09479"></a><span class="lineno"> 9479</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="run-tests_8php.html#aaa193b0c1c2b93841472b26e2e281751">error</a> = <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>;</div><div class="line"><a name="l09480"></a><span class="lineno"> 9480</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *path;</div><div class="line"><a name="l09481"></a><span class="lineno"> 9481</span>&#160;  <span class="keywordtype">int</span> fd = -1;</div><div class="line"><a name="l09482"></a><span class="lineno"> 9482</span>&#160;  <a class="code" href="structactve__log__header__scan__context.html">ACTIVE_LOG_HEADER_SCAN_CTX</a> *ctx = <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l09483"></a><span class="lineno"> 9483</span>&#160;</div><div class="line"><a name="l09484"></a><span class="lineno"> 9484</span>&#160;  *<a class="code" href="expat_8h.html#aaf0497a3bd20a0066017546af6bf80be">ptr</a> = <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l09485"></a><span class="lineno"> 9485</span>&#160;</div><div class="line"><a name="l09486"></a><span class="lineno"> 9486</span>&#160;  <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (arg_cnt == 1);</div><div class="line"><a name="l09487"></a><span class="lineno"> 9487</span>&#160;</div><div class="line"><a name="l09488"></a><span class="lineno"> 9488</span>&#160;  ctx = (<a class="code" href="structactve__log__header__scan__context.html">ACTIVE_LOG_HEADER_SCAN_CTX</a> *) <a class="code" href="memory__alloc_8h.html#a8b903d0a51cce71105b6a706159717e4">db_private_alloc</a> (thread_p, <span class="keyword">sizeof</span> (<a class="code" href="structactve__log__header__scan__context.html">ACTIVE_LOG_HEADER_SCAN_CTX</a>));</div><div class="line"><a name="l09489"></a><span class="lineno"> 9489</span>&#160;</div><div class="line"><a name="l09490"></a><span class="lineno"> 9490</span>&#160;  <span class="keywordflow">if</span> (ctx == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l09491"></a><span class="lineno"> 9491</span>&#160;    {</div><div class="line"><a name="l09492"></a><span class="lineno"> 9492</span>&#160;      <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (<a class="code" href="error__manager_8c.html#a14b629a84676fc1e0aad0c58f0c222c0">er_errid</a> () != <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>);</div><div class="line"><a name="l09493"></a><span class="lineno"> 9493</span>&#160;      <a class="code" href="run-tests_8php.html#aaa193b0c1c2b93841472b26e2e281751">error</a> = <a class="code" href="error__manager_8c.html#a14b629a84676fc1e0aad0c58f0c222c0">er_errid</a> ();</div><div class="line"><a name="l09494"></a><span class="lineno"> 9494</span>&#160;      <span class="keywordflow">goto</span> exit_on_error;</div><div class="line"><a name="l09495"></a><span class="lineno"> 9495</span>&#160;    }</div><div class="line"><a name="l09496"></a><span class="lineno"> 9496</span>&#160;</div><div class="line"><a name="l09497"></a><span class="lineno"> 9497</span>&#160;  <span class="comment">/* In the case of omit file path, first argument is db null */</span></div><div class="line"><a name="l09498"></a><span class="lineno"> 9498</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="dbtype_8h.html#a51b4eadd6fcd8ba79a6393c24fe18720">DB_VALUE_TYPE</a> (arg_values[0]) == <a class="code" href="dbtype__def_8h.html#a6735f6de14369bd1210b3491e220091da56d7dddc4e60210094b94a704ff8fd18">DB_TYPE_NULL</a>)</div><div class="line"><a name="l09499"></a><span class="lineno"> 9499</span>&#160;    {</div><div class="line"><a name="l09500"></a><span class="lineno"> 9500</span>&#160;      <a class="code" href="log__impl_8h.html#ae0f406b900c5b78e29ff0d9f32205701">LOG_CS_ENTER_READ_MODE</a> (thread_p);</div><div class="line"><a name="l09501"></a><span class="lineno"> 9501</span>&#160;      memcpy (&amp;ctx-&gt;<a class="code" href="structactve__log__header__scan__context.html#ad72cbc85c66879e4a3fc3f2a310f197b">header</a>, &amp;<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>, sizeof (<a class="code" href="structlog__header.html">LOG_HEADER</a>));</div><div class="line"><a name="l09502"></a><span class="lineno"> 9502</span>&#160;      <a class="code" href="log__impl_8h.html#a6a5f95ded1a2f38ed00c8e9c039a9f2e">LOG_CS_EXIT</a> (thread_p);</div><div class="line"><a name="l09503"></a><span class="lineno"> 9503</span>&#160;    }</div><div class="line"><a name="l09504"></a><span class="lineno"> 9504</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l09505"></a><span class="lineno"> 9505</span>&#160;    {</div><div class="line"><a name="l09506"></a><span class="lineno"> 9506</span>&#160;      <span class="keywordtype">char</span> buf[<a class="code" href="storage__common_8h.html#a0a3c7db68a92df0d34666257bb0f17dd">IO_MAX_PAGE_SIZE</a> + <a class="code" href="memory__alloc_8h.html#a81d7e4971ffc775a379eeb4c65fa30f8">MAX_ALIGNMENT</a>];</div><div class="line"><a name="l09507"></a><span class="lineno"> 9507</span>&#160;      <a class="code" href="structlog__page.html">LOG_PAGE</a> *page_hdr = (<a class="code" href="structlog__page.html">LOG_PAGE</a> *) <a class="code" href="memory__alloc_8h.html#a79781c0dbfdd9510d275cba54f1f384f">PTR_ALIGN</a> (buf, <a class="code" href="memory__alloc_8h.html#a81d7e4971ffc775a379eeb4c65fa30f8">MAX_ALIGNMENT</a>);</div><div class="line"><a name="l09508"></a><span class="lineno"> 9508</span>&#160;</div><div class="line"><a name="l09509"></a><span class="lineno"> 9509</span>&#160;      <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (<a class="code" href="dbtype_8h.html#a51b4eadd6fcd8ba79a6393c24fe18720">DB_VALUE_TYPE</a> (arg_values[0]) == <a class="code" href="dbtype__def_8h.html#a6735f6de14369bd1210b3491e220091da851e4d39ed7262dbd439cd2983edcb94">DB_TYPE_CHAR</a>);</div><div class="line"><a name="l09510"></a><span class="lineno"> 9510</span>&#160;      path = <a class="code" href="dbtype__function_8h.html#a672513498ce99f993e55a79fd36d6361">db_get_string</a> (arg_values[0]);</div><div class="line"><a name="l09511"></a><span class="lineno"> 9511</span>&#160;</div><div class="line"><a name="l09512"></a><span class="lineno"> 9512</span>&#160;      fd = <a class="code" href="file__io_8c.html#a3e06db37b56c37b0e9d1a041015ebc13">fileio_open</a> (path, O_RDONLY, 0);</div><div class="line"><a name="l09513"></a><span class="lineno"> 9513</span>&#160;      <span class="keywordflow">if</span> (fd == -1)</div><div class="line"><a name="l09514"></a><span class="lineno"> 9514</span>&#160;    {</div><div class="line"><a name="l09515"></a><span class="lineno"> 9515</span>&#160;      <a class="code" href="error__manager_8c.html#ae4dfdf0d17782bd51e4612e68fc18c68">er_set_with_oserror</a> (<a class="code" href="error__manager_8h.html#a5d0d456c474e11fc70779873a30a7432a07ad8f9fda27124d297c94b7d3ea44e8">ER_ERROR_SEVERITY</a>, <a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <a class="code" href="error__code_8h.html#aaeb0f3698022ae5f56094bff65b0528f">ER_IO_MOUNT_FAIL</a>, 1, path);</div><div class="line"><a name="l09516"></a><span class="lineno"> 9516</span>&#160;      <a class="code" href="run-tests_8php.html#aaa193b0c1c2b93841472b26e2e281751">error</a> = <a class="code" href="error__code_8h.html#aaeb0f3698022ae5f56094bff65b0528f">ER_IO_MOUNT_FAIL</a>;</div><div class="line"><a name="l09517"></a><span class="lineno"> 9517</span>&#160;      <span class="keywordflow">goto</span> exit_on_error;</div><div class="line"><a name="l09518"></a><span class="lineno"> 9518</span>&#160;    }</div><div class="line"><a name="l09519"></a><span class="lineno"> 9519</span>&#160;</div><div class="line"><a name="l09520"></a><span class="lineno"> 9520</span>&#160;      <span class="keywordflow">if</span> (read (fd, page_hdr, <a class="code" href="storage__common_8h.html#a1a7b7663aee8b9e8b1df6b1fbd5a88b9">LOG_PAGESIZE</a>) != <a class="code" href="storage__common_8h.html#a1a7b7663aee8b9e8b1df6b1fbd5a88b9">LOG_PAGESIZE</a>)</div><div class="line"><a name="l09521"></a><span class="lineno"> 9521</span>&#160;    {</div><div class="line"><a name="l09522"></a><span class="lineno"> 9522</span>&#160;      <a class="code" href="error__manager_8c.html#ae4dfdf0d17782bd51e4612e68fc18c68">er_set_with_oserror</a> (<a class="code" href="error__manager_8h.html#a5d0d456c474e11fc70779873a30a7432a07ad8f9fda27124d297c94b7d3ea44e8">ER_ERROR_SEVERITY</a>, <a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <a class="code" href="error__code_8h.html#aaeb0f3698022ae5f56094bff65b0528f">ER_IO_MOUNT_FAIL</a>, 1, path);</div><div class="line"><a name="l09523"></a><span class="lineno"> 9523</span>&#160;      <a class="code" href="run-tests_8php.html#aaa193b0c1c2b93841472b26e2e281751">error</a> = <a class="code" href="error__code_8h.html#aaeb0f3698022ae5f56094bff65b0528f">ER_IO_MOUNT_FAIL</a>;</div><div class="line"><a name="l09524"></a><span class="lineno"> 9524</span>&#160;      <span class="keywordflow">goto</span> exit_on_error;</div><div class="line"><a name="l09525"></a><span class="lineno"> 9525</span>&#160;    }</div><div class="line"><a name="l09526"></a><span class="lineno"> 9526</span>&#160;</div><div class="line"><a name="l09527"></a><span class="lineno"> 9527</span>&#160;      memcpy (&amp;ctx-&gt;<a class="code" href="structactve__log__header__scan__context.html#ad72cbc85c66879e4a3fc3f2a310f197b">header</a>, page_hdr-&gt;<a class="code" href="structlog__page.html#a9b51b4623cdb8d1686f6f8fb64bc9ee2">area</a>, sizeof (<a class="code" href="structlog__header.html">LOG_HEADER</a>));</div><div class="line"><a name="l09528"></a><span class="lineno"> 9528</span>&#160;</div><div class="line"><a name="l09529"></a><span class="lineno"> 9529</span>&#160;      ctx-&gt;<a class="code" href="structactve__log__header__scan__context.html#ad72cbc85c66879e4a3fc3f2a310f197b">header</a>.<a class="code" href="structlog__header.html#a9e2e5afd8f320c1cdf841a58939cf9b2">magic</a>[<span class="keyword">sizeof</span> (ctx-&gt;<a class="code" href="structactve__log__header__scan__context.html#ad72cbc85c66879e4a3fc3f2a310f197b">header</a>.<a class="code" href="structlog__header.html#a9e2e5afd8f320c1cdf841a58939cf9b2">magic</a>) - 1] = 0;</div><div class="line"><a name="l09530"></a><span class="lineno"> 9530</span>&#160;      ctx-&gt;<a class="code" href="structactve__log__header__scan__context.html#ad72cbc85c66879e4a3fc3f2a310f197b">header</a>.<a class="code" href="structlog__header.html#a69b0ace883f579f1f029b57b86901cda">db_release</a>[<span class="keyword">sizeof</span> (ctx-&gt;<a class="code" href="structactve__log__header__scan__context.html#ad72cbc85c66879e4a3fc3f2a310f197b">header</a>.<a class="code" href="structlog__header.html#a69b0ace883f579f1f029b57b86901cda">db_release</a>) - 1] = 0;</div><div class="line"><a name="l09531"></a><span class="lineno"> 9531</span>&#160;      ctx-&gt;<a class="code" href="structactve__log__header__scan__context.html#ad72cbc85c66879e4a3fc3f2a310f197b">header</a>.<a class="code" href="structlog__header.html#a115c418fc5dd536dd0d8073897815513">prefix_name</a>[<span class="keyword">sizeof</span> (ctx-&gt;<a class="code" href="structactve__log__header__scan__context.html#ad72cbc85c66879e4a3fc3f2a310f197b">header</a>.<a class="code" href="structlog__header.html#a115c418fc5dd536dd0d8073897815513">prefix_name</a>) - 1] = 0;</div><div class="line"><a name="l09532"></a><span class="lineno"> 9532</span>&#160;</div><div class="line"><a name="l09533"></a><span class="lineno"> 9533</span>&#160;      close (fd);</div><div class="line"><a name="l09534"></a><span class="lineno"> 9534</span>&#160;      fd = -1;</div><div class="line"><a name="l09535"></a><span class="lineno"> 9535</span>&#160;</div><div class="line"><a name="l09536"></a><span class="lineno"> 9536</span>&#160;      <span class="keywordflow">if</span> (memcmp (ctx-&gt;<a class="code" href="structactve__log__header__scan__context.html#ad72cbc85c66879e4a3fc3f2a310f197b">header</a>.<a class="code" href="structlog__header.html#a9e2e5afd8f320c1cdf841a58939cf9b2">magic</a>, <a class="code" href="storage__common_8h.html#a59c6d5d7e74688bc33d6f35bf6aff46b">CUBRID_MAGIC_LOG_ACTIVE</a>, <a class="code" href="intl__support_8c.html#ab543901c3564a54b2450303d63374f55">strlen</a> (<a class="code" href="storage__common_8h.html#a59c6d5d7e74688bc33d6f35bf6aff46b">CUBRID_MAGIC_LOG_ACTIVE</a>)) != 0)</div><div class="line"><a name="l09537"></a><span class="lineno"> 9537</span>&#160;    {</div><div class="line"><a name="l09538"></a><span class="lineno"> 9538</span>&#160;      <a class="code" href="error__manager_8c.html#afdaf87ce30f2f557802a185ab85b6599">er_set</a> (<a class="code" href="error__manager_8h.html#a5d0d456c474e11fc70779873a30a7432a07ad8f9fda27124d297c94b7d3ea44e8">ER_ERROR_SEVERITY</a>, <a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <a class="code" href="error__code_8h.html#aaeb0f3698022ae5f56094bff65b0528f">ER_IO_MOUNT_FAIL</a>, 1, path);</div><div class="line"><a name="l09539"></a><span class="lineno"> 9539</span>&#160;      <a class="code" href="run-tests_8php.html#aaa193b0c1c2b93841472b26e2e281751">error</a> = <a class="code" href="error__code_8h.html#aaeb0f3698022ae5f56094bff65b0528f">ER_IO_MOUNT_FAIL</a>;</div><div class="line"><a name="l09540"></a><span class="lineno"> 9540</span>&#160;      <span class="keywordflow">goto</span> exit_on_error;</div><div class="line"><a name="l09541"></a><span class="lineno"> 9541</span>&#160;    }</div><div class="line"><a name="l09542"></a><span class="lineno"> 9542</span>&#160;    }</div><div class="line"><a name="l09543"></a><span class="lineno"> 9543</span>&#160;</div><div class="line"><a name="l09544"></a><span class="lineno"> 9544</span>&#160;  *<a class="code" href="expat_8h.html#aaf0497a3bd20a0066017546af6bf80be">ptr</a> = ctx;</div><div class="line"><a name="l09545"></a><span class="lineno"> 9545</span>&#160;  ctx = <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l09546"></a><span class="lineno"> 9546</span>&#160;</div><div class="line"><a name="l09547"></a><span class="lineno"> 9547</span>&#160;exit_on_error:</div><div class="line"><a name="l09548"></a><span class="lineno"> 9548</span>&#160;  <span class="keywordflow">if</span> (fd != -1)</div><div class="line"><a name="l09549"></a><span class="lineno"> 9549</span>&#160;    {</div><div class="line"><a name="l09550"></a><span class="lineno"> 9550</span>&#160;      close (fd);</div><div class="line"><a name="l09551"></a><span class="lineno"> 9551</span>&#160;    }</div><div class="line"><a name="l09552"></a><span class="lineno"> 9552</span>&#160;</div><div class="line"><a name="l09553"></a><span class="lineno"> 9553</span>&#160;  <span class="keywordflow">if</span> (ctx != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l09554"></a><span class="lineno"> 9554</span>&#160;    {</div><div class="line"><a name="l09555"></a><span class="lineno"> 9555</span>&#160;      <a class="code" href="memory__alloc_8h.html#a8a4aab7481b74342b82c75f8e028bcf8">db_private_free_and_init</a> (thread_p, ctx);</div><div class="line"><a name="l09556"></a><span class="lineno"> 9556</span>&#160;    }</div><div class="line"><a name="l09557"></a><span class="lineno"> 9557</span>&#160;</div><div class="line"><a name="l09558"></a><span class="lineno"> 9558</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="run-tests_8php.html#aaa193b0c1c2b93841472b26e2e281751">error</a>;</div><div class="line"><a name="l09559"></a><span class="lineno"> 9559</span>&#160;}</div><div class="line"><a name="l09560"></a><span class="lineno"> 9560</span>&#160;</div><div class="line"><a name="l09561"></a><span class="lineno"> 9561</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l09562"></a><span class="lineno"> 9562</span>&#160;<span class="comment"> * log_active_log_header_next_scan () -</span></div><div class="line"><a name="l09563"></a><span class="lineno"> 9563</span>&#160;<span class="comment"> *   return: NO_ERROR, or ER_code</span></div><div class="line"><a name="l09564"></a><span class="lineno"> 9564</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l09565"></a><span class="lineno"> 9565</span>&#160;<span class="comment"> *   thread_p(in):</span></div><div class="line"><a name="l09566"></a><span class="lineno"> 9566</span>&#160;<span class="comment"> *   cursor(in):</span></div><div class="line"><a name="l09567"></a><span class="lineno"> 9567</span>&#160;<span class="comment"> *   out_values(in):</span></div><div class="line"><a name="l09568"></a><span class="lineno"> 9568</span>&#160;<span class="comment"> *   out_cnt(in):</span></div><div class="line"><a name="l09569"></a><span class="lineno"> 9569</span>&#160;<span class="comment"> *   ptr(in): context pointer</span></div><div class="line"><a name="l09570"></a><span class="lineno"> 9570</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l09571"></a><span class="lineno"> 9571</span>&#160;<a class="code" href="storage__common_8h.html#ad704198b3c56cf17601de69c679a7181">SCAN_CODE</a></div><div class="line"><a name="l09572"></a><span class="lineno"><a class="line" href="log__manager_8h.html#a53d35f511b18f8af20ed5eb09c286c73"> 9572</a></span>&#160;<a class="code" href="log__manager_8c.html#a53d35f511b18f8af20ed5eb09c286c73">log_active_log_header_next_scan</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <span class="keywordtype">int</span> <a class="code" href="structcursor.html">cursor</a>, <a class="code" href="structdb__value.html">DB_VALUE</a> ** out_values, <span class="keywordtype">int</span> out_cnt, <span class="keywordtype">void</span> *<a class="code" href="expat_8h.html#aaf0497a3bd20a0066017546af6bf80be">ptr</a>)</div><div class="line"><a name="l09573"></a><span class="lineno"> 9573</span>&#160;{</div><div class="line"><a name="l09574"></a><span class="lineno"> 9574</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="run-tests_8php.html#aaa193b0c1c2b93841472b26e2e281751">error</a> = <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>;</div><div class="line"><a name="l09575"></a><span class="lineno"> 9575</span>&#160;  <span class="keywordtype">int</span> idx = 0;</div><div class="line"><a name="l09576"></a><span class="lineno"> 9576</span>&#160;  <span class="keywordtype">int</span> val;</div><div class="line"><a name="l09577"></a><span class="lineno"> 9577</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *str;</div><div class="line"><a name="l09578"></a><span class="lineno"> 9578</span>&#160;  <span class="keywordtype">char</span> buf[256];</div><div class="line"><a name="l09579"></a><span class="lineno"> 9579</span>&#160;  <a class="code" href="structdb__datetime.html">DB_DATETIME</a> time_val;</div><div class="line"><a name="l09580"></a><span class="lineno"> 9580</span>&#160;  <a class="code" href="structactve__log__header__scan__context.html">ACTIVE_LOG_HEADER_SCAN_CTX</a> *ctx = (<a class="code" href="structactve__log__header__scan__context.html">ACTIVE_LOG_HEADER_SCAN_CTX</a> *) <a class="code" href="expat_8h.html#aaf0497a3bd20a0066017546af6bf80be">ptr</a>;</div><div class="line"><a name="l09581"></a><span class="lineno"> 9581</span>&#160;  <a class="code" href="structlog__header.html">LOG_HEADER</a> *header = &amp;ctx-&gt;<a class="code" href="structactve__log__header__scan__context.html#ad72cbc85c66879e4a3fc3f2a310f197b">header</a>;</div><div class="line"><a name="l09582"></a><span class="lineno"> 9582</span>&#160;</div><div class="line"><a name="l09583"></a><span class="lineno"> 9583</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="structcursor.html">cursor</a> &gt;= 1)</div><div class="line"><a name="l09584"></a><span class="lineno"> 9584</span>&#160;    {</div><div class="line"><a name="l09585"></a><span class="lineno"> 9585</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="storage__common_8h.html#ad704198b3c56cf17601de69c679a7181a38165d93da431da6482d755a4b65fc4f">S_END</a>;</div><div class="line"><a name="l09586"></a><span class="lineno"> 9586</span>&#160;    }</div><div class="line"><a name="l09587"></a><span class="lineno"> 9587</span>&#160;</div><div class="line"><a name="l09588"></a><span class="lineno"> 9588</span>&#160;  <a class="code" href="dbtype__function_8h.html#a517705ea2963537e8a1f01d45faa1064">db_make_int</a> (out_values[idx], <a class="code" href="log__impl_8h.html#a94895f5d3bc1246f3902870a56738763">LOG_DBLOG_ACTIVE_VOLID</a>);</div><div class="line"><a name="l09589"></a><span class="lineno"> 9589</span>&#160;  idx++;</div><div class="line"><a name="l09590"></a><span class="lineno"> 9590</span>&#160;</div><div class="line"><a name="l09591"></a><span class="lineno"> 9591</span>&#160;  <a class="code" href="run-tests_8php.html#aaa193b0c1c2b93841472b26e2e281751">error</a> = <a class="code" href="dbtype__function_8h.html#a4d82f586c6b675d10808fca453ded49c">db_make_string_copy</a> (out_values[idx], header-&gt;<a class="code" href="structlog__header.html#a9e2e5afd8f320c1cdf841a58939cf9b2">magic</a>);</div><div class="line"><a name="l09592"></a><span class="lineno"> 9592</span>&#160;  idx++;</div><div class="line"><a name="l09593"></a><span class="lineno"> 9593</span>&#160;</div><div class="line"><a name="l09594"></a><span class="lineno"> 9594</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="run-tests_8php.html#aaa193b0c1c2b93841472b26e2e281751">error</a> != <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>)</div><div class="line"><a name="l09595"></a><span class="lineno"> 9595</span>&#160;    {</div><div class="line"><a name="l09596"></a><span class="lineno"> 9596</span>&#160;      <span class="keywordflow">goto</span> exit_on_error;</div><div class="line"><a name="l09597"></a><span class="lineno"> 9597</span>&#160;    }</div><div class="line"><a name="l09598"></a><span class="lineno"> 9598</span>&#160;</div><div class="line"><a name="l09599"></a><span class="lineno"> 9599</span>&#160;  val = <a class="code" href="atldb__cubrid_8h.html#a1d99dd3a57d51d7fa3d98f80297633e1">offsetof</a> (<a class="code" href="structlog__page.html">LOG_PAGE</a>, <a class="code" href="structarea.html">area</a>) + <a class="code" href="atldb__cubrid_8h.html#a1d99dd3a57d51d7fa3d98f80297633e1">offsetof</a> (<a class="code" href="structlog__header.html">LOG_HEADER</a>, magic);</div><div class="line"><a name="l09600"></a><span class="lineno"> 9600</span>&#160;  <a class="code" href="dbtype__function_8h.html#a517705ea2963537e8a1f01d45faa1064">db_make_int</a> (out_values[idx], val);</div><div class="line"><a name="l09601"></a><span class="lineno"> 9601</span>&#160;  idx++;</div><div class="line"><a name="l09602"></a><span class="lineno"> 9602</span>&#160;</div><div class="line"><a name="l09603"></a><span class="lineno"> 9603</span>&#160;  <a class="code" href="db__date_8c.html#a6e1d7212710fa8692140d38b660f1f6b">db_localdatetime</a> ((time_t *) (&amp;header-&gt;<a class="code" href="structlog__header.html#ab7c3c46056f412b19f447caf2ce7b861">db_creation</a>), &amp;time_val);</div><div class="line"><a name="l09604"></a><span class="lineno"> 9604</span>&#160;  <a class="code" href="run-tests_8php.html#aaa193b0c1c2b93841472b26e2e281751">error</a> = <a class="code" href="dbtype__function_8h.html#a609e234af409a47cfefdbad3958d13dc">db_make_datetime</a> (out_values[idx], &amp;time_val);</div><div class="line"><a name="l09605"></a><span class="lineno"> 9605</span>&#160;  idx++;</div><div class="line"><a name="l09606"></a><span class="lineno"> 9606</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="run-tests_8php.html#aaa193b0c1c2b93841472b26e2e281751">error</a> != <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>)</div><div class="line"><a name="l09607"></a><span class="lineno"> 9607</span>&#160;    {</div><div class="line"><a name="l09608"></a><span class="lineno"> 9608</span>&#160;      <span class="keywordflow">goto</span> exit_on_error;</div><div class="line"><a name="l09609"></a><span class="lineno"> 9609</span>&#160;    }</div><div class="line"><a name="l09610"></a><span class="lineno"> 9610</span>&#160;</div><div class="line"><a name="l09611"></a><span class="lineno"> 9611</span>&#160;  <a class="code" href="run-tests_8php.html#aaa193b0c1c2b93841472b26e2e281751">error</a> = <a class="code" href="dbtype__function_8h.html#a4d82f586c6b675d10808fca453ded49c">db_make_string_copy</a> (out_values[idx], header-&gt;<a class="code" href="structlog__header.html#a69b0ace883f579f1f029b57b86901cda">db_release</a>);</div><div class="line"><a name="l09612"></a><span class="lineno"> 9612</span>&#160;  idx++;</div><div class="line"><a name="l09613"></a><span class="lineno"> 9613</span>&#160;</div><div class="line"><a name="l09614"></a><span class="lineno"> 9614</span>&#160;  snprintf (buf, <span class="keyword">sizeof</span> (buf), <span class="stringliteral">&quot;%g&quot;</span>, header-&gt;<a class="code" href="structlog__header.html#ac84fc8c39ca403a029683a4ceeef9bd6">db_compatibility</a>);</div><div class="line"><a name="l09615"></a><span class="lineno"> 9615</span>&#160;  buf[<span class="keyword">sizeof</span> (buf) - 1] = 0;</div><div class="line"><a name="l09616"></a><span class="lineno"> 9616</span>&#160;  <a class="code" href="run-tests_8php.html#aaa193b0c1c2b93841472b26e2e281751">error</a> = <a class="code" href="dbtype__function_8h.html#a4d82f586c6b675d10808fca453ded49c">db_make_string_copy</a> (out_values[idx], buf);</div><div class="line"><a name="l09617"></a><span class="lineno"> 9617</span>&#160;  idx++;</div><div class="line"><a name="l09618"></a><span class="lineno"> 9618</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="run-tests_8php.html#aaa193b0c1c2b93841472b26e2e281751">error</a> != <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>)</div><div class="line"><a name="l09619"></a><span class="lineno"> 9619</span>&#160;    {</div><div class="line"><a name="l09620"></a><span class="lineno"> 9620</span>&#160;      <span class="keywordflow">goto</span> exit_on_error;</div><div class="line"><a name="l09621"></a><span class="lineno"> 9621</span>&#160;    }</div><div class="line"><a name="l09622"></a><span class="lineno"> 9622</span>&#160;</div><div class="line"><a name="l09623"></a><span class="lineno"> 9623</span>&#160;  <a class="code" href="dbtype__function_8h.html#a517705ea2963537e8a1f01d45faa1064">db_make_int</a> (out_values[idx], header-&gt;<a class="code" href="structlog__header.html#a6e36b30ec4db6a60e287d0a48fa5c907">db_iopagesize</a>);</div><div class="line"><a name="l09624"></a><span class="lineno"> 9624</span>&#160;  idx++;</div><div class="line"><a name="l09625"></a><span class="lineno"> 9625</span>&#160;</div><div class="line"><a name="l09626"></a><span class="lineno"> 9626</span>&#160;  <a class="code" href="dbtype__function_8h.html#a517705ea2963537e8a1f01d45faa1064">db_make_int</a> (out_values[idx], header-&gt;<a class="code" href="structlog__header.html#a31fef6acfb938132c62b4623cd1ad953">db_logpagesize</a>);</div><div class="line"><a name="l09627"></a><span class="lineno"> 9627</span>&#160;  idx++;</div><div class="line"><a name="l09628"></a><span class="lineno"> 9628</span>&#160;</div><div class="line"><a name="l09629"></a><span class="lineno"> 9629</span>&#160;  <a class="code" href="dbtype__function_8h.html#a517705ea2963537e8a1f01d45faa1064">db_make_int</a> (out_values[idx], header-&gt;<a class="code" href="structlog__header.html#a7d775819dc76af47b2615f39dc1c9019">is_shutdown</a>);</div><div class="line"><a name="l09630"></a><span class="lineno"> 9630</span>&#160;  idx++;</div><div class="line"><a name="l09631"></a><span class="lineno"> 9631</span>&#160;</div><div class="line"><a name="l09632"></a><span class="lineno"> 9632</span>&#160;  <a class="code" href="dbtype__function_8h.html#a517705ea2963537e8a1f01d45faa1064">db_make_int</a> (out_values[idx], header-&gt;<a class="code" href="structlog__header.html#aa1540adc8fb89ea40a4cf0d18344afd9">next_trid</a>);</div><div class="line"><a name="l09633"></a><span class="lineno"> 9633</span>&#160;  idx++;</div><div class="line"><a name="l09634"></a><span class="lineno"> 9634</span>&#160;</div><div class="line"><a name="l09635"></a><span class="lineno"> 9635</span>&#160;  <a class="code" href="dbtype__function_8h.html#a517705ea2963537e8a1f01d45faa1064">db_make_int</a> (out_values[idx], header-&gt;<a class="code" href="structlog__header.html#acc35ee047773a1cca16705e989ba3456">avg_ntrans</a>);</div><div class="line"><a name="l09636"></a><span class="lineno"> 9636</span>&#160;  idx++;</div><div class="line"><a name="l09637"></a><span class="lineno"> 9637</span>&#160;</div><div class="line"><a name="l09638"></a><span class="lineno"> 9638</span>&#160;  <a class="code" href="dbtype__function_8h.html#a517705ea2963537e8a1f01d45faa1064">db_make_int</a> (out_values[idx], header-&gt;<a class="code" href="structlog__header.html#a74993a3a849045719cb0661356702c8d">avg_nlocks</a>);</div><div class="line"><a name="l09639"></a><span class="lineno"> 9639</span>&#160;  idx++;</div><div class="line"><a name="l09640"></a><span class="lineno"> 9640</span>&#160;</div><div class="line"><a name="l09641"></a><span class="lineno"> 9641</span>&#160;  <a class="code" href="dbtype__function_8h.html#a517705ea2963537e8a1f01d45faa1064">db_make_int</a> (out_values[idx], header-&gt;<a class="code" href="structlog__header.html#abf6f8b71041f36e854e9edaa910525be">npages</a>);</div><div class="line"><a name="l09642"></a><span class="lineno"> 9642</span>&#160;  idx++;</div><div class="line"><a name="l09643"></a><span class="lineno"> 9643</span>&#160;</div><div class="line"><a name="l09644"></a><span class="lineno"> 9644</span>&#160;  <a class="code" href="dbtype__function_8h.html#a517705ea2963537e8a1f01d45faa1064">db_make_int</a> (out_values[idx], header-&gt;<a class="code" href="structlog__header.html#aad70018d473d2cff6e2acd0a5aec5b6a">db_charset</a>);</div><div class="line"><a name="l09645"></a><span class="lineno"> 9645</span>&#160;  idx++;</div><div class="line"><a name="l09646"></a><span class="lineno"> 9646</span>&#160;</div><div class="line"><a name="l09647"></a><span class="lineno"> 9647</span>&#160;  <a class="code" href="dbtype__function_8h.html#ab664deb9d1dcfea0795267828ec424bb">db_make_bigint</a> (out_values[idx], header-&gt;<a class="code" href="structlog__header.html#aa32d860a02d9a2da846a3b9dfc17ce97">fpageid</a>);</div><div class="line"><a name="l09648"></a><span class="lineno"> 9648</span>&#160;  idx++;</div><div class="line"><a name="l09649"></a><span class="lineno"> 9649</span>&#160;</div><div class="line"><a name="l09650"></a><span class="lineno"> 9650</span>&#160;  <a class="code" href="storage__common_8c.html#a1f56b2edce95595c884a8393449e7cde">lsa_to_string</a> (buf, <span class="keyword">sizeof</span> (buf), &amp;header-&gt;<a class="code" href="structlog__header.html#a982b3e55dedc3dabc54a1a7fcddc144e">append_lsa</a>);</div><div class="line"><a name="l09651"></a><span class="lineno"> 9651</span>&#160;  <a class="code" href="run-tests_8php.html#aaa193b0c1c2b93841472b26e2e281751">error</a> = <a class="code" href="dbtype__function_8h.html#a4d82f586c6b675d10808fca453ded49c">db_make_string_copy</a> (out_values[idx], buf);</div><div class="line"><a name="l09652"></a><span class="lineno"> 9652</span>&#160;  idx++;</div><div class="line"><a name="l09653"></a><span class="lineno"> 9653</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="run-tests_8php.html#aaa193b0c1c2b93841472b26e2e281751">error</a> != <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>)</div><div class="line"><a name="l09654"></a><span class="lineno"> 9654</span>&#160;    {</div><div class="line"><a name="l09655"></a><span class="lineno"> 9655</span>&#160;      <span class="keywordflow">goto</span> exit_on_error;</div><div class="line"><a name="l09656"></a><span class="lineno"> 9656</span>&#160;    }</div><div class="line"><a name="l09657"></a><span class="lineno"> 9657</span>&#160;</div><div class="line"><a name="l09658"></a><span class="lineno"> 9658</span>&#160;  <a class="code" href="storage__common_8c.html#a1f56b2edce95595c884a8393449e7cde">lsa_to_string</a> (buf, <span class="keyword">sizeof</span> (buf), &amp;header-&gt;<a class="code" href="structlog__header.html#abd3c92d1eb868dd630bdbfa3561ecf9e">chkpt_lsa</a>);</div><div class="line"><a name="l09659"></a><span class="lineno"> 9659</span>&#160;  <a class="code" href="run-tests_8php.html#aaa193b0c1c2b93841472b26e2e281751">error</a> = <a class="code" href="dbtype__function_8h.html#a4d82f586c6b675d10808fca453ded49c">db_make_string_copy</a> (out_values[idx], buf);</div><div class="line"><a name="l09660"></a><span class="lineno"> 9660</span>&#160;  idx++;</div><div class="line"><a name="l09661"></a><span class="lineno"> 9661</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="run-tests_8php.html#aaa193b0c1c2b93841472b26e2e281751">error</a> != <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>)</div><div class="line"><a name="l09662"></a><span class="lineno"> 9662</span>&#160;    {</div><div class="line"><a name="l09663"></a><span class="lineno"> 9663</span>&#160;      <span class="keywordflow">goto</span> exit_on_error;</div><div class="line"><a name="l09664"></a><span class="lineno"> 9664</span>&#160;    }</div><div class="line"><a name="l09665"></a><span class="lineno"> 9665</span>&#160;</div><div class="line"><a name="l09666"></a><span class="lineno"> 9666</span>&#160;  <a class="code" href="dbtype__function_8h.html#ab664deb9d1dcfea0795267828ec424bb">db_make_bigint</a> (out_values[idx], header-&gt;<a class="code" href="structlog__header.html#af5f33cf0ecf8a996d4646d2327f6540c">nxarv_pageid</a>);</div><div class="line"><a name="l09667"></a><span class="lineno"> 9667</span>&#160;  idx++;</div><div class="line"><a name="l09668"></a><span class="lineno"> 9668</span>&#160;</div><div class="line"><a name="l09669"></a><span class="lineno"> 9669</span>&#160;  <a class="code" href="dbtype__function_8h.html#a517705ea2963537e8a1f01d45faa1064">db_make_int</a> (out_values[idx], header-&gt;<a class="code" href="structlog__header.html#a80c946bc9948fd5bf1011dba3e0481a8">nxarv_phy_pageid</a>);</div><div class="line"><a name="l09670"></a><span class="lineno"> 9670</span>&#160;  idx++;</div><div class="line"><a name="l09671"></a><span class="lineno"> 9671</span>&#160;</div><div class="line"><a name="l09672"></a><span class="lineno"> 9672</span>&#160;  <a class="code" href="dbtype__function_8h.html#a517705ea2963537e8a1f01d45faa1064">db_make_int</a> (out_values[idx], header-&gt;<a class="code" href="structlog__header.html#afd7807a9da370474be5f75cb3aafcffd">nxarv_num</a>);</div><div class="line"><a name="l09673"></a><span class="lineno"> 9673</span>&#160;  idx++;</div><div class="line"><a name="l09674"></a><span class="lineno"> 9674</span>&#160;</div><div class="line"><a name="l09675"></a><span class="lineno"> 9675</span>&#160;  <a class="code" href="dbtype__function_8h.html#a517705ea2963537e8a1f01d45faa1064">db_make_int</a> (out_values[idx], header-&gt;<a class="code" href="structlog__header.html#a56cefc057e0589c8e9454e3a36751c61">last_arv_num_for_syscrashes</a>);</div><div class="line"><a name="l09676"></a><span class="lineno"> 9676</span>&#160;  idx++;</div><div class="line"><a name="l09677"></a><span class="lineno"> 9677</span>&#160;</div><div class="line"><a name="l09678"></a><span class="lineno"> 9678</span>&#160;  <a class="code" href="dbtype__function_8h.html#a517705ea2963537e8a1f01d45faa1064">db_make_int</a> (out_values[idx], header-&gt;<a class="code" href="structlog__header.html#aff6ddf3e8b9f68931ffd114fb90899a5">last_deleted_arv_num</a>);</div><div class="line"><a name="l09679"></a><span class="lineno"> 9679</span>&#160;  idx++;</div><div class="line"><a name="l09680"></a><span class="lineno"> 9680</span>&#160;</div><div class="line"><a name="l09681"></a><span class="lineno"> 9681</span>&#160;  <a class="code" href="storage__common_8c.html#a1f56b2edce95595c884a8393449e7cde">lsa_to_string</a> (buf, <span class="keyword">sizeof</span> (buf), &amp;header-&gt;<a class="code" href="structlog__header.html#ae3e99551830990937f08938f0f9aec11">bkup_level0_lsa</a>);</div><div class="line"><a name="l09682"></a><span class="lineno"> 9682</span>&#160;  <a class="code" href="run-tests_8php.html#aaa193b0c1c2b93841472b26e2e281751">error</a> = <a class="code" href="dbtype__function_8h.html#a4d82f586c6b675d10808fca453ded49c">db_make_string_copy</a> (out_values[idx], buf);</div><div class="line"><a name="l09683"></a><span class="lineno"> 9683</span>&#160;  idx++;</div><div class="line"><a name="l09684"></a><span class="lineno"> 9684</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="run-tests_8php.html#aaa193b0c1c2b93841472b26e2e281751">error</a> != <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>)</div><div class="line"><a name="l09685"></a><span class="lineno"> 9685</span>&#160;    {</div><div class="line"><a name="l09686"></a><span class="lineno"> 9686</span>&#160;      <span class="keywordflow">goto</span> exit_on_error;</div><div class="line"><a name="l09687"></a><span class="lineno"> 9687</span>&#160;    }</div><div class="line"><a name="l09688"></a><span class="lineno"> 9688</span>&#160;</div><div class="line"><a name="l09689"></a><span class="lineno"> 9689</span>&#160;  <a class="code" href="storage__common_8c.html#a1f56b2edce95595c884a8393449e7cde">lsa_to_string</a> (buf, <span class="keyword">sizeof</span> (buf), &amp;header-&gt;<a class="code" href="structlog__header.html#a4e13bc146dbc2b5c9ee65f2a0313a8e1">bkup_level1_lsa</a>);</div><div class="line"><a name="l09690"></a><span class="lineno"> 9690</span>&#160;  <a class="code" href="run-tests_8php.html#aaa193b0c1c2b93841472b26e2e281751">error</a> = <a class="code" href="dbtype__function_8h.html#a4d82f586c6b675d10808fca453ded49c">db_make_string_copy</a> (out_values[idx], buf);</div><div class="line"><a name="l09691"></a><span class="lineno"> 9691</span>&#160;  idx++;</div><div class="line"><a name="l09692"></a><span class="lineno"> 9692</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="run-tests_8php.html#aaa193b0c1c2b93841472b26e2e281751">error</a> != <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>)</div><div class="line"><a name="l09693"></a><span class="lineno"> 9693</span>&#160;    {</div><div class="line"><a name="l09694"></a><span class="lineno"> 9694</span>&#160;      <span class="keywordflow">goto</span> exit_on_error;</div><div class="line"><a name="l09695"></a><span class="lineno"> 9695</span>&#160;    }</div><div class="line"><a name="l09696"></a><span class="lineno"> 9696</span>&#160;</div><div class="line"><a name="l09697"></a><span class="lineno"> 9697</span>&#160;  <a class="code" href="storage__common_8c.html#a1f56b2edce95595c884a8393449e7cde">lsa_to_string</a> (buf, <span class="keyword">sizeof</span> (buf), &amp;header-&gt;<a class="code" href="structlog__header.html#a58201c7b54ca550699752804f305eee0">bkup_level2_lsa</a>);</div><div class="line"><a name="l09698"></a><span class="lineno"> 9698</span>&#160;  <a class="code" href="run-tests_8php.html#aaa193b0c1c2b93841472b26e2e281751">error</a> = <a class="code" href="dbtype__function_8h.html#a4d82f586c6b675d10808fca453ded49c">db_make_string_copy</a> (out_values[idx], buf);</div><div class="line"><a name="l09699"></a><span class="lineno"> 9699</span>&#160;  idx++;</div><div class="line"><a name="l09700"></a><span class="lineno"> 9700</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="run-tests_8php.html#aaa193b0c1c2b93841472b26e2e281751">error</a> != <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>)</div><div class="line"><a name="l09701"></a><span class="lineno"> 9701</span>&#160;    {</div><div class="line"><a name="l09702"></a><span class="lineno"> 9702</span>&#160;      <span class="keywordflow">goto</span> exit_on_error;</div><div class="line"><a name="l09703"></a><span class="lineno"> 9703</span>&#160;    }</div><div class="line"><a name="l09704"></a><span class="lineno"> 9704</span>&#160;</div><div class="line"><a name="l09705"></a><span class="lineno"> 9705</span>&#160;  <a class="code" href="run-tests_8php.html#aaa193b0c1c2b93841472b26e2e281751">error</a> = <a class="code" href="dbtype__function_8h.html#a4d82f586c6b675d10808fca453ded49c">db_make_string_copy</a> (out_values[idx], header-&gt;<a class="code" href="structlog__header.html#a115c418fc5dd536dd0d8073897815513">prefix_name</a>);</div><div class="line"><a name="l09706"></a><span class="lineno"> 9706</span>&#160;  idx++;</div><div class="line"><a name="l09707"></a><span class="lineno"> 9707</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="run-tests_8php.html#aaa193b0c1c2b93841472b26e2e281751">error</a> != <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>)</div><div class="line"><a name="l09708"></a><span class="lineno"> 9708</span>&#160;    {</div><div class="line"><a name="l09709"></a><span class="lineno"> 9709</span>&#160;      <span class="keywordflow">goto</span> exit_on_error;</div><div class="line"><a name="l09710"></a><span class="lineno"> 9710</span>&#160;    }</div><div class="line"><a name="l09711"></a><span class="lineno"> 9711</span>&#160;</div><div class="line"><a name="l09712"></a><span class="lineno"> 9712</span>&#160;  <a class="code" href="dbtype__function_8h.html#a517705ea2963537e8a1f01d45faa1064">db_make_int</a> (out_values[idx], header-&gt;<a class="code" href="structlog__header.html#a8e11d6d1907cbdd412a9c3cb7d79e6f4">has_logging_been_skipped</a>);</div><div class="line"><a name="l09713"></a><span class="lineno"> 9713</span>&#160;  idx++;</div><div class="line"><a name="l09714"></a><span class="lineno"> 9714</span>&#160;</div><div class="line"><a name="l09715"></a><span class="lineno"> 9715</span>&#160;  str = <a class="code" href="log__impl_8h.html#ae9a4d783eb0cfe14758c502723d73ed4">logpb_perm_status_to_string</a> ((<a class="code" href="log__impl_8h.html#a65e356ca467fe1819db2946e15095aab">LOG_PSTATUS</a>) header-&gt;<a class="code" href="structlog__header.html#a67b3ba829a862ebd7fe6c0de32c0ee43">perm_status</a>);</div><div class="line"><a name="l09716"></a><span class="lineno"> 9716</span>&#160;  db_make_string_by_const_str (out_values[idx], str);</div><div class="line"><a name="l09717"></a><span class="lineno"> 9717</span>&#160;  idx++;</div><div class="line"><a name="l09718"></a><span class="lineno"> 9718</span>&#160;</div><div class="line"><a name="l09719"></a><span class="lineno"> 9719</span>&#160;  <a class="code" href="log__impl_8h.html#a1decc5b84f52a36e2d871ced1922a5a2">logpb_backup_level_info_to_string</a> (buf, <span class="keyword">sizeof</span> (buf), header-&gt;<a class="code" href="structlog__header.html#a43b980e328d1dba7c171a93a7d58ca45">bkinfo</a> + <a class="code" href="file__io_8h.html#a1e52f91b8452ad233fce9196397ed45da4ca4365d4e2f0ed4986de6b8a1c3538c">FILEIO_BACKUP_FULL_LEVEL</a>);</div><div class="line"><a name="l09720"></a><span class="lineno"> 9720</span>&#160;  <a class="code" href="run-tests_8php.html#aaa193b0c1c2b93841472b26e2e281751">error</a> = <a class="code" href="dbtype__function_8h.html#a4d82f586c6b675d10808fca453ded49c">db_make_string_copy</a> (out_values[idx], buf);</div><div class="line"><a name="l09721"></a><span class="lineno"> 9721</span>&#160;  idx++;</div><div class="line"><a name="l09722"></a><span class="lineno"> 9722</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="run-tests_8php.html#aaa193b0c1c2b93841472b26e2e281751">error</a> != <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>)</div><div class="line"><a name="l09723"></a><span class="lineno"> 9723</span>&#160;    {</div><div class="line"><a name="l09724"></a><span class="lineno"> 9724</span>&#160;      <span class="keywordflow">goto</span> exit_on_error;</div><div class="line"><a name="l09725"></a><span class="lineno"> 9725</span>&#160;    }</div><div class="line"><a name="l09726"></a><span class="lineno"> 9726</span>&#160;</div><div class="line"><a name="l09727"></a><span class="lineno"> 9727</span>&#160;  <a class="code" href="log__impl_8h.html#a1decc5b84f52a36e2d871ced1922a5a2">logpb_backup_level_info_to_string</a> (buf, <span class="keyword">sizeof</span> (buf), header-&gt;<a class="code" href="structlog__header.html#a43b980e328d1dba7c171a93a7d58ca45">bkinfo</a> + <a class="code" href="file__io_8h.html#a1e52f91b8452ad233fce9196397ed45dae072dab0b3d0522ae0f199e9e931a2a8">FILEIO_BACKUP_BIG_INCREMENT_LEVEL</a>);</div><div class="line"><a name="l09728"></a><span class="lineno"> 9728</span>&#160;  <a class="code" href="run-tests_8php.html#aaa193b0c1c2b93841472b26e2e281751">error</a> = <a class="code" href="dbtype__function_8h.html#a4d82f586c6b675d10808fca453ded49c">db_make_string_copy</a> (out_values[idx], buf);</div><div class="line"><a name="l09729"></a><span class="lineno"> 9729</span>&#160;  idx++;</div><div class="line"><a name="l09730"></a><span class="lineno"> 9730</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="run-tests_8php.html#aaa193b0c1c2b93841472b26e2e281751">error</a> != <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>)</div><div class="line"><a name="l09731"></a><span class="lineno"> 9731</span>&#160;    {</div><div class="line"><a name="l09732"></a><span class="lineno"> 9732</span>&#160;      <span class="keywordflow">goto</span> exit_on_error;</div><div class="line"><a name="l09733"></a><span class="lineno"> 9733</span>&#160;    }</div><div class="line"><a name="l09734"></a><span class="lineno"> 9734</span>&#160;</div><div class="line"><a name="l09735"></a><span class="lineno"> 9735</span>&#160;  <a class="code" href="log__impl_8h.html#a1decc5b84f52a36e2d871ced1922a5a2">logpb_backup_level_info_to_string</a> (buf, <span class="keyword">sizeof</span> (buf), header-&gt;<a class="code" href="structlog__header.html#a43b980e328d1dba7c171a93a7d58ca45">bkinfo</a> + <a class="code" href="file__io_8h.html#a1e52f91b8452ad233fce9196397ed45da17696d88ad6e4dbd2139a09c945fc07d">FILEIO_BACKUP_SMALL_INCREMENT_LEVEL</a>);</div><div class="line"><a name="l09736"></a><span class="lineno"> 9736</span>&#160;  <a class="code" href="run-tests_8php.html#aaa193b0c1c2b93841472b26e2e281751">error</a> = <a class="code" href="dbtype__function_8h.html#a4d82f586c6b675d10808fca453ded49c">db_make_string_copy</a> (out_values[idx], buf);</div><div class="line"><a name="l09737"></a><span class="lineno"> 9737</span>&#160;  idx++;</div><div class="line"><a name="l09738"></a><span class="lineno"> 9738</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="run-tests_8php.html#aaa193b0c1c2b93841472b26e2e281751">error</a> != <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>)</div><div class="line"><a name="l09739"></a><span class="lineno"> 9739</span>&#160;    {</div><div class="line"><a name="l09740"></a><span class="lineno"> 9740</span>&#160;      <span class="keywordflow">goto</span> exit_on_error;</div><div class="line"><a name="l09741"></a><span class="lineno"> 9741</span>&#160;    }</div><div class="line"><a name="l09742"></a><span class="lineno"> 9742</span>&#160;</div><div class="line"><a name="l09743"></a><span class="lineno"> 9743</span>&#160;  str = <a class="code" href="connection__support_8c.html#a059c0aa783f09d15fc92c878ab3835ec">css_ha_server_state_string</a> ((<a class="code" href="boot_8h.html#a158badd371706f1de006dfdffbd19d45">HA_SERVER_STATE</a>) header-&gt;<a class="code" href="structlog__header.html#a04c9c76cfc0ca96fd6f9f5f68d3bd87c">ha_server_state</a>);</div><div class="line"><a name="l09744"></a><span class="lineno"> 9744</span>&#160;  db_make_string_by_const_str (out_values[idx], str);</div><div class="line"><a name="l09745"></a><span class="lineno"> 9745</span>&#160;  idx++;</div><div class="line"><a name="l09746"></a><span class="lineno"> 9746</span>&#160;</div><div class="line"><a name="l09747"></a><span class="lineno"> 9747</span>&#160;  str = <a class="code" href="log__writer_8c.html#af1e1368d8e63a233e503b44c7cad4f4e">logwr_log_ha_filestat_to_string</a> ((<a class="code" href="log__impl_8h.html#acf8424877a6714a77a4aead4a32a9993">LOG_HA_FILESTAT</a>) header-&gt;<a class="code" href="structlog__header.html#a42531bd822942e634a5af20b2123c10c">ha_file_status</a>);</div><div class="line"><a name="l09748"></a><span class="lineno"> 9748</span>&#160;  db_make_string_by_const_str (out_values[idx], str);</div><div class="line"><a name="l09749"></a><span class="lineno"> 9749</span>&#160;  idx++;</div><div class="line"><a name="l09750"></a><span class="lineno"> 9750</span>&#160;</div><div class="line"><a name="l09751"></a><span class="lineno"> 9751</span>&#160;  <a class="code" href="storage__common_8c.html#a1f56b2edce95595c884a8393449e7cde">lsa_to_string</a> (buf, <span class="keyword">sizeof</span> (buf), &amp;header-&gt;<a class="code" href="structlog__header.html#a87b66e6b3d5872e8e0967a42abf04ea6">eof_lsa</a>);</div><div class="line"><a name="l09752"></a><span class="lineno"> 9752</span>&#160;  <a class="code" href="run-tests_8php.html#aaa193b0c1c2b93841472b26e2e281751">error</a> = <a class="code" href="dbtype__function_8h.html#a4d82f586c6b675d10808fca453ded49c">db_make_string_copy</a> (out_values[idx], buf);</div><div class="line"><a name="l09753"></a><span class="lineno"> 9753</span>&#160;  idx++;</div><div class="line"><a name="l09754"></a><span class="lineno"> 9754</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="run-tests_8php.html#aaa193b0c1c2b93841472b26e2e281751">error</a> != <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>)</div><div class="line"><a name="l09755"></a><span class="lineno"> 9755</span>&#160;    {</div><div class="line"><a name="l09756"></a><span class="lineno"> 9756</span>&#160;      <span class="keywordflow">goto</span> exit_on_error;</div><div class="line"><a name="l09757"></a><span class="lineno"> 9757</span>&#160;    }</div><div class="line"><a name="l09758"></a><span class="lineno"> 9758</span>&#160;</div><div class="line"><a name="l09759"></a><span class="lineno"> 9759</span>&#160;  <a class="code" href="storage__common_8c.html#a1f56b2edce95595c884a8393449e7cde">lsa_to_string</a> (buf, <span class="keyword">sizeof</span> (buf), &amp;header-&gt;<a class="code" href="structlog__header.html#abfff061333884447d8cf359d48184620">smallest_lsa_at_last_chkpt</a>);</div><div class="line"><a name="l09760"></a><span class="lineno"> 9760</span>&#160;  <a class="code" href="run-tests_8php.html#aaa193b0c1c2b93841472b26e2e281751">error</a> = <a class="code" href="dbtype__function_8h.html#a4d82f586c6b675d10808fca453ded49c">db_make_string_copy</a> (out_values[idx], buf);</div><div class="line"><a name="l09761"></a><span class="lineno"> 9761</span>&#160;  idx++;</div><div class="line"><a name="l09762"></a><span class="lineno"> 9762</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="run-tests_8php.html#aaa193b0c1c2b93841472b26e2e281751">error</a> != <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>)</div><div class="line"><a name="l09763"></a><span class="lineno"> 9763</span>&#160;    {</div><div class="line"><a name="l09764"></a><span class="lineno"> 9764</span>&#160;      <span class="keywordflow">goto</span> exit_on_error;</div><div class="line"><a name="l09765"></a><span class="lineno"> 9765</span>&#160;    }</div><div class="line"><a name="l09766"></a><span class="lineno"> 9766</span>&#160;</div><div class="line"><a name="l09767"></a><span class="lineno"> 9767</span>&#160;  <a class="code" href="dbtype__function_8h.html#ab664deb9d1dcfea0795267828ec424bb">db_make_bigint</a> (out_values[idx], header-&gt;<a class="code" href="structlog__header.html#a06104560f68d0a20da58e4327a57755a">mvcc_next_id</a>);</div><div class="line"><a name="l09768"></a><span class="lineno"> 9768</span>&#160;  idx++;</div><div class="line"><a name="l09769"></a><span class="lineno"> 9769</span>&#160;</div><div class="line"><a name="l09770"></a><span class="lineno"> 9770</span>&#160;  <a class="code" href="storage__common_8c.html#a1f56b2edce95595c884a8393449e7cde">lsa_to_string</a> (buf, <span class="keyword">sizeof</span> (buf), &amp;header-&gt;<a class="code" href="structlog__header.html#acb3318dc21996d211a62ec8bec70ecc2">mvcc_op_log_lsa</a>);</div><div class="line"><a name="l09771"></a><span class="lineno"> 9771</span>&#160;  <a class="code" href="run-tests_8php.html#aaa193b0c1c2b93841472b26e2e281751">error</a> = <a class="code" href="dbtype__function_8h.html#a4d82f586c6b675d10808fca453ded49c">db_make_string_copy</a> (out_values[idx], buf);</div><div class="line"><a name="l09772"></a><span class="lineno"> 9772</span>&#160;  idx++;</div><div class="line"><a name="l09773"></a><span class="lineno"> 9773</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="run-tests_8php.html#aaa193b0c1c2b93841472b26e2e281751">error</a> != <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>)</div><div class="line"><a name="l09774"></a><span class="lineno"> 9774</span>&#160;    {</div><div class="line"><a name="l09775"></a><span class="lineno"> 9775</span>&#160;      <span class="keywordflow">goto</span> exit_on_error;</div><div class="line"><a name="l09776"></a><span class="lineno"> 9776</span>&#160;    }</div><div class="line"><a name="l09777"></a><span class="lineno"> 9777</span>&#160;</div><div class="line"><a name="l09778"></a><span class="lineno"> 9778</span>&#160;  <span class="keywordflow">if</span> (header-&gt;<a class="code" href="structlog__header.html#a71d96c5226f6697b25a34567942300cf">last_block_oldest_mvccid</a> == <a class="code" href="storage__common_8h.html#afd0bb266f6811f0eef1f13a2d4a2d175">MVCCID_NULL</a>)</div><div class="line"><a name="l09779"></a><span class="lineno"> 9779</span>&#160;    {</div><div class="line"><a name="l09780"></a><span class="lineno"> 9780</span>&#160;      <a class="code" href="dbtype__function_8h.html#ae570f2fc3aeb00331acc11277913b03f">db_make_null</a> (out_values[idx]);</div><div class="line"><a name="l09781"></a><span class="lineno"> 9781</span>&#160;    }</div><div class="line"><a name="l09782"></a><span class="lineno"> 9782</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l09783"></a><span class="lineno"> 9783</span>&#160;    {</div><div class="line"><a name="l09784"></a><span class="lineno"> 9784</span>&#160;      <a class="code" href="dbtype__function_8h.html#ab664deb9d1dcfea0795267828ec424bb">db_make_bigint</a> (out_values[idx], header-&gt;<a class="code" href="structlog__header.html#a71d96c5226f6697b25a34567942300cf">last_block_oldest_mvccid</a>);</div><div class="line"><a name="l09785"></a><span class="lineno"> 9785</span>&#160;    }</div><div class="line"><a name="l09786"></a><span class="lineno"> 9786</span>&#160;  idx++;</div><div class="line"><a name="l09787"></a><span class="lineno"> 9787</span>&#160;</div><div class="line"><a name="l09788"></a><span class="lineno"> 9788</span>&#160;  <span class="keywordflow">if</span> (header-&gt;<a class="code" href="structlog__header.html#a7522e43b86a7c2f068609153f678edeb">last_block_newest_mvccid</a> == <a class="code" href="storage__common_8h.html#afd0bb266f6811f0eef1f13a2d4a2d175">MVCCID_NULL</a>)</div><div class="line"><a name="l09789"></a><span class="lineno"> 9789</span>&#160;    {</div><div class="line"><a name="l09790"></a><span class="lineno"> 9790</span>&#160;      <a class="code" href="dbtype__function_8h.html#ae570f2fc3aeb00331acc11277913b03f">db_make_null</a> (out_values[idx]);</div><div class="line"><a name="l09791"></a><span class="lineno"> 9791</span>&#160;    }</div><div class="line"><a name="l09792"></a><span class="lineno"> 9792</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l09793"></a><span class="lineno"> 9793</span>&#160;    {</div><div class="line"><a name="l09794"></a><span class="lineno"> 9794</span>&#160;      <a class="code" href="dbtype__function_8h.html#ab664deb9d1dcfea0795267828ec424bb">db_make_bigint</a> (out_values[idx], header-&gt;<a class="code" href="structlog__header.html#a7522e43b86a7c2f068609153f678edeb">last_block_newest_mvccid</a>);</div><div class="line"><a name="l09795"></a><span class="lineno"> 9795</span>&#160;    }</div><div class="line"><a name="l09796"></a><span class="lineno"> 9796</span>&#160;  idx++;</div><div class="line"><a name="l09797"></a><span class="lineno"> 9797</span>&#160;</div><div class="line"><a name="l09798"></a><span class="lineno"> 9798</span>&#160;  <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (idx == out_cnt);</div><div class="line"><a name="l09799"></a><span class="lineno"> 9799</span>&#160;</div><div class="line"><a name="l09800"></a><span class="lineno"> 9800</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="storage__common_8h.html#ad704198b3c56cf17601de69c679a7181a29c0c697bde0c7eb16b7f17bea656fb9">S_SUCCESS</a>;</div><div class="line"><a name="l09801"></a><span class="lineno"> 9801</span>&#160;</div><div class="line"><a name="l09802"></a><span class="lineno"> 9802</span>&#160;exit_on_error:</div><div class="line"><a name="l09803"></a><span class="lineno"> 9803</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="run-tests_8php.html#aaa193b0c1c2b93841472b26e2e281751">error</a> == <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a> ? <a class="code" href="storage__common_8h.html#ad704198b3c56cf17601de69c679a7181a29c0c697bde0c7eb16b7f17bea656fb9">S_SUCCESS</a> : <a class="code" href="storage__common_8h.html#ad704198b3c56cf17601de69c679a7181aa09fa5ed5be816eeb89a11be5a00c477">S_ERROR</a>;</div><div class="line"><a name="l09804"></a><span class="lineno"> 9804</span>&#160;}</div><div class="line"><a name="l09805"></a><span class="lineno"> 9805</span>&#160;</div><div class="line"><a name="l09806"></a><span class="lineno"> 9806</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l09807"></a><span class="lineno"> 9807</span>&#160;<span class="comment"> * log_active_log_header_end_scan () - free the context</span></div><div class="line"><a name="l09808"></a><span class="lineno"> 9808</span>&#160;<span class="comment"> *   return: NO_ERROR, or ER_code</span></div><div class="line"><a name="l09809"></a><span class="lineno"> 9809</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l09810"></a><span class="lineno"> 9810</span>&#160;<span class="comment"> *   thread_p(in):</span></div><div class="line"><a name="l09811"></a><span class="lineno"> 9811</span>&#160;<span class="comment"> *   ptr(in): context pointer</span></div><div class="line"><a name="l09812"></a><span class="lineno"> 9812</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l09813"></a><span class="lineno"> 9813</span>&#160;<span class="keywordtype">int</span></div><div class="line"><a name="l09814"></a><span class="lineno"><a class="line" href="log__manager_8h.html#a783bfa7c5f1b28d55d1c7bec2491f971"> 9814</a></span>&#160;<a class="code" href="log__manager_8c.html#a783bfa7c5f1b28d55d1c7bec2491f971">log_active_log_header_end_scan</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <span class="keywordtype">void</span> **<a class="code" href="expat_8h.html#aaf0497a3bd20a0066017546af6bf80be">ptr</a>)</div><div class="line"><a name="l09815"></a><span class="lineno"> 9815</span>&#160;{</div><div class="line"><a name="l09816"></a><span class="lineno"> 9816</span>&#160;  <span class="keywordflow">if</span> (*<a class="code" href="expat_8h.html#aaf0497a3bd20a0066017546af6bf80be">ptr</a> != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l09817"></a><span class="lineno"> 9817</span>&#160;    {</div><div class="line"><a name="l09818"></a><span class="lineno"> 9818</span>&#160;      <a class="code" href="memory__alloc_8h.html#a8a4aab7481b74342b82c75f8e028bcf8">db_private_free_and_init</a> (thread_p, *<a class="code" href="expat_8h.html#aaf0497a3bd20a0066017546af6bf80be">ptr</a>);</div><div class="line"><a name="l09819"></a><span class="lineno"> 9819</span>&#160;    }</div><div class="line"><a name="l09820"></a><span class="lineno"> 9820</span>&#160;</div><div class="line"><a name="l09821"></a><span class="lineno"> 9821</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>;</div><div class="line"><a name="l09822"></a><span class="lineno"> 9822</span>&#160;}</div><div class="line"><a name="l09823"></a><span class="lineno"> 9823</span>&#160;</div><div class="line"><a name="l09824"></a><span class="lineno"> 9824</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l09825"></a><span class="lineno"> 9825</span>&#160;<span class="comment"> * log_archive_log_header_start_scan () -</span></div><div class="line"><a name="l09826"></a><span class="lineno"> 9826</span>&#160;<span class="comment"> *   return: NO_ERROR, or ER_code</span></div><div class="line"><a name="l09827"></a><span class="lineno"> 9827</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l09828"></a><span class="lineno"> 9828</span>&#160;<span class="comment"> *   thread_p(in):</span></div><div class="line"><a name="l09829"></a><span class="lineno"> 9829</span>&#160;<span class="comment"> *   show_type(in):</span></div><div class="line"><a name="l09830"></a><span class="lineno"> 9830</span>&#160;<span class="comment"> *   arg_values(in):</span></div><div class="line"><a name="l09831"></a><span class="lineno"> 9831</span>&#160;<span class="comment"> *   arg_cnt(in):</span></div><div class="line"><a name="l09832"></a><span class="lineno"> 9832</span>&#160;<span class="comment"> *   ptr(out): allocate new context. should free by end_scan() function</span></div><div class="line"><a name="l09833"></a><span class="lineno"> 9833</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l09834"></a><span class="lineno"> 9834</span>&#160;<span class="keywordtype">int</span></div><div class="line"><a name="l09835"></a><span class="lineno"><a class="line" href="log__manager_8h.html#a184221af017af64f0a3bd7c96c3c83e7"> 9835</a></span>&#160;<a class="code" href="log__manager_8c.html#a184221af017af64f0a3bd7c96c3c83e7">log_archive_log_header_start_scan</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <span class="keywordtype">int</span> show_type, <a class="code" href="structdb__value.html">DB_VALUE</a> ** arg_values, <span class="keywordtype">int</span> arg_cnt,</div><div class="line"><a name="l09836"></a><span class="lineno"> 9836</span>&#160;                   <span class="keywordtype">void</span> **<a class="code" href="expat_8h.html#aaf0497a3bd20a0066017546af6bf80be">ptr</a>)</div><div class="line"><a name="l09837"></a><span class="lineno"> 9837</span>&#160;{</div><div class="line"><a name="l09838"></a><span class="lineno"> 9838</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="run-tests_8php.html#aaa193b0c1c2b93841472b26e2e281751">error</a> = <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>;</div><div class="line"><a name="l09839"></a><span class="lineno"> 9839</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *path;</div><div class="line"><a name="l09840"></a><span class="lineno"> 9840</span>&#160;  <span class="keywordtype">int</span> fd;</div><div class="line"><a name="l09841"></a><span class="lineno"> 9841</span>&#160;  <span class="keywordtype">char</span> buf[<a class="code" href="storage__common_8h.html#a0a3c7db68a92df0d34666257bb0f17dd">IO_MAX_PAGE_SIZE</a> + <a class="code" href="memory__alloc_8h.html#a81d7e4971ffc775a379eeb4c65fa30f8">MAX_ALIGNMENT</a>];</div><div class="line"><a name="l09842"></a><span class="lineno"> 9842</span>&#160;  <a class="code" href="structlog__page.html">LOG_PAGE</a> *page_hdr;</div><div class="line"><a name="l09843"></a><span class="lineno"> 9843</span>&#160;  <a class="code" href="structarchive__log__header__scan__context.html">ARCHIVE_LOG_HEADER_SCAN_CTX</a> *ctx = <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l09844"></a><span class="lineno"> 9844</span>&#160;</div><div class="line"><a name="l09845"></a><span class="lineno"> 9845</span>&#160;  *<a class="code" href="expat_8h.html#aaf0497a3bd20a0066017546af6bf80be">ptr</a> = <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l09846"></a><span class="lineno"> 9846</span>&#160;</div><div class="line"><a name="l09847"></a><span class="lineno"> 9847</span>&#160;  <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (<a class="code" href="dbtype_8h.html#a51b4eadd6fcd8ba79a6393c24fe18720">DB_VALUE_TYPE</a> (arg_values[0]) == <a class="code" href="dbtype__def_8h.html#a6735f6de14369bd1210b3491e220091da851e4d39ed7262dbd439cd2983edcb94">DB_TYPE_CHAR</a>);</div><div class="line"><a name="l09848"></a><span class="lineno"> 9848</span>&#160;</div><div class="line"><a name="l09849"></a><span class="lineno"> 9849</span>&#160;  ctx = (<a class="code" href="structarchive__log__header__scan__context.html">ARCHIVE_LOG_HEADER_SCAN_CTX</a> *) <a class="code" href="memory__alloc_8h.html#a8b903d0a51cce71105b6a706159717e4">db_private_alloc</a> (thread_p, <span class="keyword">sizeof</span> (<a class="code" href="structarchive__log__header__scan__context.html">ARCHIVE_LOG_HEADER_SCAN_CTX</a>));</div><div class="line"><a name="l09850"></a><span class="lineno"> 9850</span>&#160;  <span class="keywordflow">if</span> (ctx == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l09851"></a><span class="lineno"> 9851</span>&#160;    {</div><div class="line"><a name="l09852"></a><span class="lineno"> 9852</span>&#160;      <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (<a class="code" href="error__manager_8c.html#a14b629a84676fc1e0aad0c58f0c222c0">er_errid</a> () != <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>);</div><div class="line"><a name="l09853"></a><span class="lineno"> 9853</span>&#160;      <a class="code" href="run-tests_8php.html#aaa193b0c1c2b93841472b26e2e281751">error</a> = <a class="code" href="error__manager_8c.html#a14b629a84676fc1e0aad0c58f0c222c0">er_errid</a> ();</div><div class="line"><a name="l09854"></a><span class="lineno"> 9854</span>&#160;      <span class="keywordflow">goto</span> exit_on_error;</div><div class="line"><a name="l09855"></a><span class="lineno"> 9855</span>&#160;    }</div><div class="line"><a name="l09856"></a><span class="lineno"> 9856</span>&#160;</div><div class="line"><a name="l09857"></a><span class="lineno"> 9857</span>&#160;  path = <a class="code" href="dbtype__function_8h.html#a672513498ce99f993e55a79fd36d6361">db_get_string</a> (arg_values[0]);</div><div class="line"><a name="l09858"></a><span class="lineno"> 9858</span>&#160;</div><div class="line"><a name="l09859"></a><span class="lineno"> 9859</span>&#160;  page_hdr = (<a class="code" href="structlog__page.html">LOG_PAGE</a> *) <a class="code" href="memory__alloc_8h.html#a79781c0dbfdd9510d275cba54f1f384f">PTR_ALIGN</a> (buf, <a class="code" href="memory__alloc_8h.html#a81d7e4971ffc775a379eeb4c65fa30f8">MAX_ALIGNMENT</a>);</div><div class="line"><a name="l09860"></a><span class="lineno"> 9860</span>&#160;</div><div class="line"><a name="l09861"></a><span class="lineno"> 9861</span>&#160;  fd = <a class="code" href="file__io_8c.html#a3e06db37b56c37b0e9d1a041015ebc13">fileio_open</a> (path, O_RDONLY, 0);</div><div class="line"><a name="l09862"></a><span class="lineno"> 9862</span>&#160;  <span class="keywordflow">if</span> (fd == -1)</div><div class="line"><a name="l09863"></a><span class="lineno"> 9863</span>&#160;    {</div><div class="line"><a name="l09864"></a><span class="lineno"> 9864</span>&#160;      <a class="code" href="error__manager_8c.html#ae4dfdf0d17782bd51e4612e68fc18c68">er_set_with_oserror</a> (<a class="code" href="error__manager_8h.html#a5d0d456c474e11fc70779873a30a7432a07ad8f9fda27124d297c94b7d3ea44e8">ER_ERROR_SEVERITY</a>, <a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <a class="code" href="error__code_8h.html#aaeb0f3698022ae5f56094bff65b0528f">ER_IO_MOUNT_FAIL</a>, 1, path);</div><div class="line"><a name="l09865"></a><span class="lineno"> 9865</span>&#160;      <a class="code" href="run-tests_8php.html#aaa193b0c1c2b93841472b26e2e281751">error</a> = <a class="code" href="error__code_8h.html#aaeb0f3698022ae5f56094bff65b0528f">ER_IO_MOUNT_FAIL</a>;</div><div class="line"><a name="l09866"></a><span class="lineno"> 9866</span>&#160;      <span class="keywordflow">goto</span> exit_on_error;</div><div class="line"><a name="l09867"></a><span class="lineno"> 9867</span>&#160;    }</div><div class="line"><a name="l09868"></a><span class="lineno"> 9868</span>&#160;</div><div class="line"><a name="l09869"></a><span class="lineno"> 9869</span>&#160;  <span class="keywordflow">if</span> (read (fd, page_hdr, <a class="code" href="storage__common_8h.html#a1a7b7663aee8b9e8b1df6b1fbd5a88b9">LOG_PAGESIZE</a>) != <a class="code" href="storage__common_8h.html#a1a7b7663aee8b9e8b1df6b1fbd5a88b9">LOG_PAGESIZE</a>)</div><div class="line"><a name="l09870"></a><span class="lineno"> 9870</span>&#160;    {</div><div class="line"><a name="l09871"></a><span class="lineno"> 9871</span>&#160;      <a class="code" href="error__manager_8c.html#ae4dfdf0d17782bd51e4612e68fc18c68">er_set_with_oserror</a> (<a class="code" href="error__manager_8h.html#a5d0d456c474e11fc70779873a30a7432a07ad8f9fda27124d297c94b7d3ea44e8">ER_ERROR_SEVERITY</a>, <a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <a class="code" href="error__code_8h.html#aaeb0f3698022ae5f56094bff65b0528f">ER_IO_MOUNT_FAIL</a>, 1, path);</div><div class="line"><a name="l09872"></a><span class="lineno"> 9872</span>&#160;      <a class="code" href="run-tests_8php.html#aaa193b0c1c2b93841472b26e2e281751">error</a> = <a class="code" href="error__code_8h.html#aaeb0f3698022ae5f56094bff65b0528f">ER_IO_MOUNT_FAIL</a>;</div><div class="line"><a name="l09873"></a><span class="lineno"> 9873</span>&#160;      <span class="keywordflow">goto</span> exit_on_error;</div><div class="line"><a name="l09874"></a><span class="lineno"> 9874</span>&#160;    }</div><div class="line"><a name="l09875"></a><span class="lineno"> 9875</span>&#160;</div><div class="line"><a name="l09876"></a><span class="lineno"> 9876</span>&#160;  memcpy (&amp;ctx-&gt;<a class="code" href="structarchive__log__header__scan__context.html#a0637f5ec1505138e18d9ebb259352961">header</a>, page_hdr-&gt;<a class="code" href="structlog__page.html#a9b51b4623cdb8d1686f6f8fb64bc9ee2">area</a>, sizeof (<a class="code" href="structlog__arv__header.html">LOG_ARV_HEADER</a>));</div><div class="line"><a name="l09877"></a><span class="lineno"> 9877</span>&#160;  close (fd);</div><div class="line"><a name="l09878"></a><span class="lineno"> 9878</span>&#160;  fd = -1;</div><div class="line"><a name="l09879"></a><span class="lineno"> 9879</span>&#160;</div><div class="line"><a name="l09880"></a><span class="lineno"> 9880</span>&#160;  ctx-&gt;<a class="code" href="structarchive__log__header__scan__context.html#a0637f5ec1505138e18d9ebb259352961">header</a>.<a class="code" href="structlog__arv__header.html#a9cded2fa1d3c3ddba7a506c0af952bf0">magic</a>[<span class="keyword">sizeof</span> (ctx-&gt;<a class="code" href="structarchive__log__header__scan__context.html#a0637f5ec1505138e18d9ebb259352961">header</a>.<a class="code" href="structlog__arv__header.html#a9cded2fa1d3c3ddba7a506c0af952bf0">magic</a>) - 1] = 0;</div><div class="line"><a name="l09881"></a><span class="lineno"> 9881</span>&#160;</div><div class="line"><a name="l09882"></a><span class="lineno"> 9882</span>&#160;  <span class="keywordflow">if</span> (memcmp (ctx-&gt;<a class="code" href="structarchive__log__header__scan__context.html#a0637f5ec1505138e18d9ebb259352961">header</a>.<a class="code" href="structlog__arv__header.html#a9cded2fa1d3c3ddba7a506c0af952bf0">magic</a>, <a class="code" href="storage__common_8h.html#a9be5638788c6f0e3cfb4bbcdf5abb342">CUBRID_MAGIC_LOG_ARCHIVE</a>, <a class="code" href="intl__support_8c.html#ab543901c3564a54b2450303d63374f55">strlen</a> (<a class="code" href="storage__common_8h.html#a9be5638788c6f0e3cfb4bbcdf5abb342">CUBRID_MAGIC_LOG_ARCHIVE</a>)) != 0)</div><div class="line"><a name="l09883"></a><span class="lineno"> 9883</span>&#160;    {</div><div class="line"><a name="l09884"></a><span class="lineno"> 9884</span>&#160;      <a class="code" href="error__manager_8c.html#afdaf87ce30f2f557802a185ab85b6599">er_set</a> (<a class="code" href="error__manager_8h.html#a5d0d456c474e11fc70779873a30a7432a07ad8f9fda27124d297c94b7d3ea44e8">ER_ERROR_SEVERITY</a>, <a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <a class="code" href="error__code_8h.html#aaeb0f3698022ae5f56094bff65b0528f">ER_IO_MOUNT_FAIL</a>, 1, path);</div><div class="line"><a name="l09885"></a><span class="lineno"> 9885</span>&#160;      <a class="code" href="run-tests_8php.html#aaa193b0c1c2b93841472b26e2e281751">error</a> = <a class="code" href="error__code_8h.html#aaeb0f3698022ae5f56094bff65b0528f">ER_IO_MOUNT_FAIL</a>;</div><div class="line"><a name="l09886"></a><span class="lineno"> 9886</span>&#160;      <span class="keywordflow">goto</span> exit_on_error;</div><div class="line"><a name="l09887"></a><span class="lineno"> 9887</span>&#160;    }</div><div class="line"><a name="l09888"></a><span class="lineno"> 9888</span>&#160;</div><div class="line"><a name="l09889"></a><span class="lineno"> 9889</span>&#160;  *<a class="code" href="expat_8h.html#aaf0497a3bd20a0066017546af6bf80be">ptr</a> = ctx;</div><div class="line"><a name="l09890"></a><span class="lineno"> 9890</span>&#160;  ctx = <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l09891"></a><span class="lineno"> 9891</span>&#160;</div><div class="line"><a name="l09892"></a><span class="lineno"> 9892</span>&#160;exit_on_error:</div><div class="line"><a name="l09893"></a><span class="lineno"> 9893</span>&#160;  <span class="keywordflow">if</span> (ctx != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l09894"></a><span class="lineno"> 9894</span>&#160;    {</div><div class="line"><a name="l09895"></a><span class="lineno"> 9895</span>&#160;      <a class="code" href="memory__alloc_8h.html#a8a4aab7481b74342b82c75f8e028bcf8">db_private_free_and_init</a> (thread_p, ctx);</div><div class="line"><a name="l09896"></a><span class="lineno"> 9896</span>&#160;    }</div><div class="line"><a name="l09897"></a><span class="lineno"> 9897</span>&#160;</div><div class="line"><a name="l09898"></a><span class="lineno"> 9898</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="run-tests_8php.html#aaa193b0c1c2b93841472b26e2e281751">error</a>;</div><div class="line"><a name="l09899"></a><span class="lineno"> 9899</span>&#160;}</div><div class="line"><a name="l09900"></a><span class="lineno"> 9900</span>&#160;</div><div class="line"><a name="l09901"></a><span class="lineno"> 9901</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l09902"></a><span class="lineno"> 9902</span>&#160;<span class="comment"> * log_archive_log_header_next_scan () -</span></div><div class="line"><a name="l09903"></a><span class="lineno"> 9903</span>&#160;<span class="comment"> *   return: NO_ERROR, or ER_code</span></div><div class="line"><a name="l09904"></a><span class="lineno"> 9904</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l09905"></a><span class="lineno"> 9905</span>&#160;<span class="comment"> *   thread_p(in):</span></div><div class="line"><a name="l09906"></a><span class="lineno"> 9906</span>&#160;<span class="comment"> *   cursor(in):</span></div><div class="line"><a name="l09907"></a><span class="lineno"> 9907</span>&#160;<span class="comment"> *   out_values(in):</span></div><div class="line"><a name="l09908"></a><span class="lineno"> 9908</span>&#160;<span class="comment"> *   out_cnt(in):</span></div><div class="line"><a name="l09909"></a><span class="lineno"> 9909</span>&#160;<span class="comment"> *   ptr(in): context pointer</span></div><div class="line"><a name="l09910"></a><span class="lineno"> 9910</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l09911"></a><span class="lineno"> 9911</span>&#160;<a class="code" href="storage__common_8h.html#ad704198b3c56cf17601de69c679a7181">SCAN_CODE</a></div><div class="line"><a name="l09912"></a><span class="lineno"><a class="line" href="log__manager_8h.html#a1dbd3acc4c9828aa63183a69c54d80c0"> 9912</a></span>&#160;<a class="code" href="log__manager_8c.html#a1dbd3acc4c9828aa63183a69c54d80c0">log_archive_log_header_next_scan</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <span class="keywordtype">int</span> <a class="code" href="structcursor.html">cursor</a>, <a class="code" href="structdb__value.html">DB_VALUE</a> ** out_values, <span class="keywordtype">int</span> out_cnt, <span class="keywordtype">void</span> *<a class="code" href="expat_8h.html#aaf0497a3bd20a0066017546af6bf80be">ptr</a>)</div><div class="line"><a name="l09913"></a><span class="lineno"> 9913</span>&#160;{</div><div class="line"><a name="l09914"></a><span class="lineno"> 9914</span>&#160;  <span class="keywordtype">int</span> <a class="code" href="run-tests_8php.html#aaa193b0c1c2b93841472b26e2e281751">error</a> = <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>;</div><div class="line"><a name="l09915"></a><span class="lineno"> 9915</span>&#160;  <span class="keywordtype">int</span> idx = 0;</div><div class="line"><a name="l09916"></a><span class="lineno"> 9916</span>&#160;  <span class="keywordtype">int</span> val;</div><div class="line"><a name="l09917"></a><span class="lineno"> 9917</span>&#160;  <a class="code" href="structdb__datetime.html">DB_DATETIME</a> time_val;</div><div class="line"><a name="l09918"></a><span class="lineno"> 9918</span>&#160;</div><div class="line"><a name="l09919"></a><span class="lineno"> 9919</span>&#160;  <a class="code" href="structarchive__log__header__scan__context.html">ARCHIVE_LOG_HEADER_SCAN_CTX</a> *ctx = (<a class="code" href="structarchive__log__header__scan__context.html">ARCHIVE_LOG_HEADER_SCAN_CTX</a> *) <a class="code" href="expat_8h.html#aaf0497a3bd20a0066017546af6bf80be">ptr</a>;</div><div class="line"><a name="l09920"></a><span class="lineno"> 9920</span>&#160;  <a class="code" href="structlog__arv__header.html">LOG_ARV_HEADER</a> *header = &amp;ctx-&gt;<a class="code" href="structarchive__log__header__scan__context.html#a0637f5ec1505138e18d9ebb259352961">header</a>;</div><div class="line"><a name="l09921"></a><span class="lineno"> 9921</span>&#160;</div><div class="line"><a name="l09922"></a><span class="lineno"> 9922</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="structcursor.html">cursor</a> &gt;= 1)</div><div class="line"><a name="l09923"></a><span class="lineno"> 9923</span>&#160;    {</div><div class="line"><a name="l09924"></a><span class="lineno"> 9924</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="storage__common_8h.html#ad704198b3c56cf17601de69c679a7181a38165d93da431da6482d755a4b65fc4f">S_END</a>;</div><div class="line"><a name="l09925"></a><span class="lineno"> 9925</span>&#160;    }</div><div class="line"><a name="l09926"></a><span class="lineno"> 9926</span>&#160;</div><div class="line"><a name="l09927"></a><span class="lineno"> 9927</span>&#160;  <a class="code" href="dbtype__function_8h.html#a517705ea2963537e8a1f01d45faa1064">db_make_int</a> (out_values[idx], <a class="code" href="log__impl_8h.html#ac9a26eafda58f6bc67ba71c095c54372">LOG_DBLOG_ARCHIVE_VOLID</a>);</div><div class="line"><a name="l09928"></a><span class="lineno"> 9928</span>&#160;  idx++;</div><div class="line"><a name="l09929"></a><span class="lineno"> 9929</span>&#160;</div><div class="line"><a name="l09930"></a><span class="lineno"> 9930</span>&#160;  <a class="code" href="run-tests_8php.html#aaa193b0c1c2b93841472b26e2e281751">error</a> = <a class="code" href="dbtype__function_8h.html#a4d82f586c6b675d10808fca453ded49c">db_make_string_copy</a> (out_values[idx], header-&gt;<a class="code" href="structlog__arv__header.html#a9cded2fa1d3c3ddba7a506c0af952bf0">magic</a>);</div><div class="line"><a name="l09931"></a><span class="lineno"> 9931</span>&#160;  idx++;</div><div class="line"><a name="l09932"></a><span class="lineno"> 9932</span>&#160;</div><div class="line"><a name="l09933"></a><span class="lineno"> 9933</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="run-tests_8php.html#aaa193b0c1c2b93841472b26e2e281751">error</a> != <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>)</div><div class="line"><a name="l09934"></a><span class="lineno"> 9934</span>&#160;    {</div><div class="line"><a name="l09935"></a><span class="lineno"> 9935</span>&#160;      <span class="keywordflow">goto</span> exit_on_error;</div><div class="line"><a name="l09936"></a><span class="lineno"> 9936</span>&#160;    }</div><div class="line"><a name="l09937"></a><span class="lineno"> 9937</span>&#160;</div><div class="line"><a name="l09938"></a><span class="lineno"> 9938</span>&#160;  val = <a class="code" href="atldb__cubrid_8h.html#a1d99dd3a57d51d7fa3d98f80297633e1">offsetof</a> (<a class="code" href="structlog__page.html">LOG_PAGE</a>, <a class="code" href="structarea.html">area</a>) + <a class="code" href="atldb__cubrid_8h.html#a1d99dd3a57d51d7fa3d98f80297633e1">offsetof</a> (<a class="code" href="structlog__arv__header.html">LOG_ARV_HEADER</a>, magic);</div><div class="line"><a name="l09939"></a><span class="lineno"> 9939</span>&#160;  <a class="code" href="dbtype__function_8h.html#a517705ea2963537e8a1f01d45faa1064">db_make_int</a> (out_values[idx], val);</div><div class="line"><a name="l09940"></a><span class="lineno"> 9940</span>&#160;  idx++;</div><div class="line"><a name="l09941"></a><span class="lineno"> 9941</span>&#160;</div><div class="line"><a name="l09942"></a><span class="lineno"> 9942</span>&#160;  <a class="code" href="db__date_8c.html#a6e1d7212710fa8692140d38b660f1f6b">db_localdatetime</a> ((time_t *) (&amp;header-&gt;<a class="code" href="structlog__arv__header.html#ade257335bdf0e8058db6f2004f2c39c4">db_creation</a>), &amp;time_val);</div><div class="line"><a name="l09943"></a><span class="lineno"> 9943</span>&#160;  <a class="code" href="run-tests_8php.html#aaa193b0c1c2b93841472b26e2e281751">error</a> = <a class="code" href="dbtype__function_8h.html#a609e234af409a47cfefdbad3958d13dc">db_make_datetime</a> (out_values[idx], &amp;time_val);</div><div class="line"><a name="l09944"></a><span class="lineno"> 9944</span>&#160;  idx++;</div><div class="line"><a name="l09945"></a><span class="lineno"> 9945</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="run-tests_8php.html#aaa193b0c1c2b93841472b26e2e281751">error</a> != <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>)</div><div class="line"><a name="l09946"></a><span class="lineno"> 9946</span>&#160;    {</div><div class="line"><a name="l09947"></a><span class="lineno"> 9947</span>&#160;      <span class="keywordflow">goto</span> exit_on_error;</div><div class="line"><a name="l09948"></a><span class="lineno"> 9948</span>&#160;    }</div><div class="line"><a name="l09949"></a><span class="lineno"> 9949</span>&#160;</div><div class="line"><a name="l09950"></a><span class="lineno"> 9950</span>&#160;  <a class="code" href="dbtype__function_8h.html#ab664deb9d1dcfea0795267828ec424bb">db_make_bigint</a> (out_values[idx], header-&gt;<a class="code" href="structlog__arv__header.html#aae0b65f54ba63f485ed171b8571ffdbc">next_trid</a>);</div><div class="line"><a name="l09951"></a><span class="lineno"> 9951</span>&#160;  idx++;</div><div class="line"><a name="l09952"></a><span class="lineno"> 9952</span>&#160;</div><div class="line"><a name="l09953"></a><span class="lineno"> 9953</span>&#160;  <a class="code" href="dbtype__function_8h.html#a517705ea2963537e8a1f01d45faa1064">db_make_int</a> (out_values[idx], header-&gt;<a class="code" href="structlog__arv__header.html#a68c13cca07c8072d6ea245e762af906c">npages</a>);</div><div class="line"><a name="l09954"></a><span class="lineno"> 9954</span>&#160;  idx++;</div><div class="line"><a name="l09955"></a><span class="lineno"> 9955</span>&#160;</div><div class="line"><a name="l09956"></a><span class="lineno"> 9956</span>&#160;  <a class="code" href="dbtype__function_8h.html#ab664deb9d1dcfea0795267828ec424bb">db_make_bigint</a> (out_values[idx], header-&gt;<a class="code" href="structlog__arv__header.html#a0055a1ebac6f2ed3e7b3b5129d6f31ab">fpageid</a>);</div><div class="line"><a name="l09957"></a><span class="lineno"> 9957</span>&#160;  idx++;</div><div class="line"><a name="l09958"></a><span class="lineno"> 9958</span>&#160;</div><div class="line"><a name="l09959"></a><span class="lineno"> 9959</span>&#160;  <a class="code" href="dbtype__function_8h.html#a517705ea2963537e8a1f01d45faa1064">db_make_int</a> (out_values[idx], header-&gt;<a class="code" href="structlog__arv__header.html#a6c89cb36b280741ee7a56f563304fefc">arv_num</a>);</div><div class="line"><a name="l09960"></a><span class="lineno"> 9960</span>&#160;  idx++;</div><div class="line"><a name="l09961"></a><span class="lineno"> 9961</span>&#160;</div><div class="line"><a name="l09962"></a><span class="lineno"> 9962</span>&#160;  <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (idx == out_cnt);</div><div class="line"><a name="l09963"></a><span class="lineno"> 9963</span>&#160;</div><div class="line"><a name="l09964"></a><span class="lineno"> 9964</span>&#160;exit_on_error:</div><div class="line"><a name="l09965"></a><span class="lineno"> 9965</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="run-tests_8php.html#aaa193b0c1c2b93841472b26e2e281751">error</a> == <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a> ? <a class="code" href="storage__common_8h.html#ad704198b3c56cf17601de69c679a7181a29c0c697bde0c7eb16b7f17bea656fb9">S_SUCCESS</a> : <a class="code" href="storage__common_8h.html#ad704198b3c56cf17601de69c679a7181aa09fa5ed5be816eeb89a11be5a00c477">S_ERROR</a>;</div><div class="line"><a name="l09966"></a><span class="lineno"> 9966</span>&#160;}</div><div class="line"><a name="l09967"></a><span class="lineno"> 9967</span>&#160;</div><div class="line"><a name="l09968"></a><span class="lineno"> 9968</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l09969"></a><span class="lineno"> 9969</span>&#160;<span class="comment"> * log_archive_log_header_end_scan () - free the context</span></div><div class="line"><a name="l09970"></a><span class="lineno"> 9970</span>&#160;<span class="comment"> *   return: NO_ERROR, or ER_code</span></div><div class="line"><a name="l09971"></a><span class="lineno"> 9971</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l09972"></a><span class="lineno"> 9972</span>&#160;<span class="comment"> *   thread_p(in):</span></div><div class="line"><a name="l09973"></a><span class="lineno"> 9973</span>&#160;<span class="comment"> *   ptr(in): context pointer</span></div><div class="line"><a name="l09974"></a><span class="lineno"> 9974</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l09975"></a><span class="lineno"> 9975</span>&#160;<span class="keywordtype">int</span></div><div class="line"><a name="l09976"></a><span class="lineno"><a class="line" href="log__manager_8h.html#a6d8db65dcea53cc4da3b654ccc116993"> 9976</a></span>&#160;<a class="code" href="log__manager_8c.html#a6d8db65dcea53cc4da3b654ccc116993">log_archive_log_header_end_scan</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <span class="keywordtype">void</span> **<a class="code" href="expat_8h.html#aaf0497a3bd20a0066017546af6bf80be">ptr</a>)</div><div class="line"><a name="l09977"></a><span class="lineno"> 9977</span>&#160;{</div><div class="line"><a name="l09978"></a><span class="lineno"> 9978</span>&#160;  <span class="keywordflow">if</span> (*<a class="code" href="expat_8h.html#aaf0497a3bd20a0066017546af6bf80be">ptr</a> != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l09979"></a><span class="lineno"> 9979</span>&#160;    {</div><div class="line"><a name="l09980"></a><span class="lineno"> 9980</span>&#160;      <a class="code" href="memory__alloc_8h.html#a8a4aab7481b74342b82c75f8e028bcf8">db_private_free_and_init</a> (thread_p, *<a class="code" href="expat_8h.html#aaf0497a3bd20a0066017546af6bf80be">ptr</a>);</div><div class="line"><a name="l09981"></a><span class="lineno"> 9981</span>&#160;    }</div><div class="line"><a name="l09982"></a><span class="lineno"> 9982</span>&#160;</div><div class="line"><a name="l09983"></a><span class="lineno"> 9983</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>;</div><div class="line"><a name="l09984"></a><span class="lineno"> 9984</span>&#160;}</div><div class="line"><a name="l09985"></a><span class="lineno"> 9985</span>&#160;</div><div class="line"><a name="l09986"></a><span class="lineno"> 9986</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l09987"></a><span class="lineno"> 9987</span>&#160;<span class="comment"> * log_set_ha_promotion_time () - set ha promotion time</span></div><div class="line"><a name="l09988"></a><span class="lineno"> 9988</span>&#160;<span class="comment"> *   return: none</span></div><div class="line"><a name="l09989"></a><span class="lineno"> 9989</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l09990"></a><span class="lineno"> 9990</span>&#160;<span class="comment"> *   thread_p(in):</span></div><div class="line"><a name="l09991"></a><span class="lineno"> 9991</span>&#160;<span class="comment"> *   ha_promotion_time(in):</span></div><div class="line"><a name="l09992"></a><span class="lineno"> 9992</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l09993"></a><span class="lineno"> 9993</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l09994"></a><span class="lineno"><a class="line" href="log__manager_8c.html#aca0cd59cce1fda5d275e881faed4ad8b"> 9994</a></span>&#160;<a class="code" href="log__manager_8c.html#aca0cd59cce1fda5d275e881faed4ad8b">log_set_ha_promotion_time</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="cm__broker__admin_8c.html#a8606fb1d53339b43e7417d2f96db025f">INT64</a> ha_promotion_time)</div><div class="line"><a name="l09995"></a><span class="lineno"> 9995</span>&#160;{</div><div class="line"><a name="l09996"></a><span class="lineno"> 9996</span>&#160;  <a class="code" href="log__impl_8h.html#a5561d6b89dce60cfa780062fae1bb473">LOG_CS_ENTER</a> (thread_p);</div><div class="line"><a name="l09997"></a><span class="lineno"> 9997</span>&#160;  <a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>.<a class="code" href="structlog__header.html#ac54583fc783300b1b8254d14618c1e22">ha_promotion_time</a> = ha_promotion_time;</div><div class="line"><a name="l09998"></a><span class="lineno"> 9998</span>&#160;  <a class="code" href="log__impl_8h.html#a6a5f95ded1a2f38ed00c8e9c039a9f2e">LOG_CS_EXIT</a> (thread_p);</div><div class="line"><a name="l09999"></a><span class="lineno"> 9999</span>&#160;</div><div class="line"><a name="l10000"></a><span class="lineno">10000</span>&#160;  <span class="keywordflow">return</span>;</div><div class="line"><a name="l10001"></a><span class="lineno">10001</span>&#160;}</div><div class="line"><a name="l10002"></a><span class="lineno">10002</span>&#160;</div><div class="line"><a name="l10003"></a><span class="lineno">10003</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l10004"></a><span class="lineno">10004</span>&#160;<span class="comment"> * log_set_db_restore_time () - set db restore time </span></div><div class="line"><a name="l10005"></a><span class="lineno">10005</span>&#160;<span class="comment"> *   return: none</span></div><div class="line"><a name="l10006"></a><span class="lineno">10006</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l10007"></a><span class="lineno">10007</span>&#160;<span class="comment"> *   thread_p(in):</span></div><div class="line"><a name="l10008"></a><span class="lineno">10008</span>&#160;<span class="comment"> *   db_restore_time(in):</span></div><div class="line"><a name="l10009"></a><span class="lineno">10009</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l10010"></a><span class="lineno">10010</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l10011"></a><span class="lineno"><a class="line" href="log__manager_8c.html#ad85f54b15c10504caa3c3b91a58549d9">10011</a></span>&#160;<a class="code" href="log__manager_8c.html#ad85f54b15c10504caa3c3b91a58549d9">log_set_db_restore_time</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="cm__broker__admin_8c.html#a8606fb1d53339b43e7417d2f96db025f">INT64</a> db_restore_time)</div><div class="line"><a name="l10012"></a><span class="lineno">10012</span>&#160;{</div><div class="line"><a name="l10013"></a><span class="lineno">10013</span>&#160;  <a class="code" href="log__impl_8h.html#a5561d6b89dce60cfa780062fae1bb473">LOG_CS_ENTER</a> (thread_p);</div><div class="line"><a name="l10014"></a><span class="lineno">10014</span>&#160;</div><div class="line"><a name="l10015"></a><span class="lineno">10015</span>&#160;  <a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">hdr</a>.<a class="code" href="structlog__header.html#aea3e448b088d656208b3d975797e7e6d">db_restore_time</a> = db_restore_time;</div><div class="line"><a name="l10016"></a><span class="lineno">10016</span>&#160;</div><div class="line"><a name="l10017"></a><span class="lineno">10017</span>&#160;  <a class="code" href="log__impl_8h.html#a6a5f95ded1a2f38ed00c8e9c039a9f2e">LOG_CS_EXIT</a> (thread_p);</div><div class="line"><a name="l10018"></a><span class="lineno">10018</span>&#160;}</div><div class="line"><a name="l10019"></a><span class="lineno">10019</span>&#160;</div><div class="line"><a name="l10020"></a><span class="lineno">10020</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l10021"></a><span class="lineno">10021</span>&#160;<span class="comment"> * log_get_undo_record () - gets undo record from log lsa adress</span></div><div class="line"><a name="l10022"></a><span class="lineno">10022</span>&#160;<span class="comment"> *   return: S_SUCCESS or ER_code</span></div><div class="line"><a name="l10023"></a><span class="lineno">10023</span>&#160;<span class="comment"> * </span></div><div class="line"><a name="l10024"></a><span class="lineno">10024</span>&#160;<span class="comment"> * thread_p (in):</span></div><div class="line"><a name="l10025"></a><span class="lineno">10025</span>&#160;<span class="comment"> * lsa_addr (in):</span></div><div class="line"><a name="l10026"></a><span class="lineno">10026</span>&#160;<span class="comment"> * page (in):</span></div><div class="line"><a name="l10027"></a><span class="lineno">10027</span>&#160;<span class="comment"> * record (in/out):</span></div><div class="line"><a name="l10028"></a><span class="lineno">10028</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l10029"></a><span class="lineno">10029</span>&#160;<a class="code" href="storage__common_8h.html#ad704198b3c56cf17601de69c679a7181">SCAN_CODE</a></div><div class="line"><a name="l10030"></a><span class="lineno"><a class="line" href="log__manager_8h.html#a1aaae82081fc2e08d67075003e537842">10030</a></span>&#160;<a class="code" href="log__manager_8c.html#a1aaae82081fc2e08d67075003e537842">log_get_undo_record</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="structlog__page.html">LOG_PAGE</a> * log_page_p, <a class="code" href="structlog__lsa.html">LOG_LSA</a> process_lsa, <a class="code" href="structrecdes.html">RECDES</a> * <a class="code" href="structrecdes.html">recdes</a>)</div><div class="line"><a name="l10031"></a><span class="lineno">10031</span>&#160;{</div><div class="line"><a name="l10032"></a><span class="lineno">10032</span>&#160;  <a class="code" href="structlog__rec__header.html">LOG_RECORD_HEADER</a> *<a class="code" href="structlog__rec__header.html">log_rec_header</a> = <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l10033"></a><span class="lineno">10033</span>&#160;  <a class="code" href="structlog__rec__mvcc__undo.html">LOG_REC_MVCC_UNDO</a> *mvcc_undo = <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l10034"></a><span class="lineno">10034</span>&#160;  <a class="code" href="structlog__rec__mvcc__undoredo.html">LOG_REC_MVCC_UNDOREDO</a> *mvcc_undoredo = <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l10035"></a><span class="lineno">10035</span>&#160;  <a class="code" href="structlog__rec__undo.html">LOG_REC_UNDO</a> *undo = <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l10036"></a><span class="lineno">10036</span>&#160;  <a class="code" href="structlog__rec__undoredo.html">LOG_REC_UNDOREDO</a> *undoredo = <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l10037"></a><span class="lineno">10037</span>&#160;  <span class="keywordtype">int</span> udata_length;</div><div class="line"><a name="l10038"></a><span class="lineno">10038</span>&#160;  <span class="keywordtype">int</span> udata_size;</div><div class="line"><a name="l10039"></a><span class="lineno">10039</span>&#160;  <span class="keywordtype">char</span> *undo_data;</div><div class="line"><a name="l10040"></a><span class="lineno">10040</span>&#160;  <a class="code" href="structlog__lsa.html">LOG_LSA</a> oldest_prior_lsa;</div><div class="line"><a name="l10041"></a><span class="lineno">10041</span>&#160;  <span class="keywordtype">bool</span> is_zipped = <span class="keyword">false</span>;</div><div class="line"><a name="l10042"></a><span class="lineno">10042</span>&#160;  <span class="keywordtype">char</span> log_buf[<a class="code" href="storage__common_8h.html#a0a3c7db68a92df0d34666257bb0f17dd">IO_MAX_PAGE_SIZE</a> + <a class="code" href="memory__alloc_8h.html#a81d7e4971ffc775a379eeb4c65fa30f8">MAX_ALIGNMENT</a>];</div><div class="line"><a name="l10043"></a><span class="lineno">10043</span>&#160;  <a class="code" href="structlog__zip.html">LOG_ZIP</a> *log_unzip_ptr = <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l10044"></a><span class="lineno">10044</span>&#160;  <span class="keywordtype">char</span> *<a class="code" href="structarea.html">area</a> = <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l10045"></a><span class="lineno">10045</span>&#160;  <a class="code" href="storage__common_8h.html#ad704198b3c56cf17601de69c679a7181">SCAN_CODE</a> scan = <a class="code" href="storage__common_8h.html#ad704198b3c56cf17601de69c679a7181a29c0c697bde0c7eb16b7f17bea656fb9">S_SUCCESS</a>;</div><div class="line"><a name="l10046"></a><span class="lineno">10046</span>&#160;  <span class="keywordtype">bool</span> area_was_mallocated = <span class="keyword">false</span>;</div><div class="line"><a name="l10047"></a><span class="lineno">10047</span>&#160;</div><div class="line"><a name="l10048"></a><span class="lineno">10048</span>&#160;  <span class="comment">/* assert log record is not in prior list */</span></div><div class="line"><a name="l10049"></a><span class="lineno">10049</span>&#160;  oldest_prior_lsa = *<a class="code" href="log__manager_8c.html#ab54a94101ceaa616e6aafc64eba28387">log_get_append_lsa</a> ();</div><div class="line"><a name="l10050"></a><span class="lineno">10050</span>&#160;  <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (<a class="code" href="storage__common_8h.html#a478797f01d6a6ad24c0203c09a639db2">LSA_LT</a> (&amp;process_lsa, &amp;oldest_prior_lsa));</div><div class="line"><a name="l10051"></a><span class="lineno">10051</span>&#160;</div><div class="line"><a name="l10052"></a><span class="lineno">10052</span>&#160;  <a class="code" href="structlog__rec__header.html">log_rec_header</a> = <a class="code" href="log__impl_8h.html#ae37437431a8ea417a8e768ed5fa8f5f6">LOG_GET_LOG_RECORD_HEADER</a> (log_page_p, &amp;process_lsa);</div><div class="line"><a name="l10053"></a><span class="lineno">10053</span>&#160;  <a class="code" href="log__impl_8h.html#afdaa9fdf7d83212b3eec2d515e807686">LOG_READ_ADD_ALIGN</a> (thread_p, <span class="keyword">sizeof</span> (*<a class="code" href="structlog__rec__header.html">log_rec_header</a>), &amp;process_lsa, log_page_p);</div><div class="line"><a name="l10054"></a><span class="lineno">10054</span>&#160;</div><div class="line"><a name="l10055"></a><span class="lineno">10055</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="structlog__rec__header.html">log_rec_header</a>-&gt;<a class="code" href="structlog__rec__header.html#aa9be1266bf7fdca13a0a789dc5ae11bb">type</a> == <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a5eb32eedc7671f3f89c1b10c3d0229c1">LOG_MVCC_UNDO_DATA</a>)</div><div class="line"><a name="l10056"></a><span class="lineno">10056</span>&#160;    {</div><div class="line"><a name="l10057"></a><span class="lineno">10057</span>&#160;      <a class="code" href="log__impl_8h.html#a108c8143796ad50c65f64d4a483e9453">LOG_READ_ADVANCE_WHEN_DOESNT_FIT</a> (thread_p, <span class="keyword">sizeof</span> (*mvcc_undo), &amp;process_lsa, log_page_p);</div><div class="line"><a name="l10058"></a><span class="lineno">10058</span>&#160;      mvcc_undo = (<a class="code" href="structlog__rec__mvcc__undo.html">LOG_REC_MVCC_UNDO</a> *) (log_page_p-&gt;<a class="code" href="structlog__page.html#a9b51b4623cdb8d1686f6f8fb64bc9ee2">area</a> + process_lsa.<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a>);</div><div class="line"><a name="l10059"></a><span class="lineno">10059</span>&#160;</div><div class="line"><a name="l10060"></a><span class="lineno">10060</span>&#160;      udata_length = mvcc_undo-&gt;<a class="code" href="structlog__rec__mvcc__undo.html#a7f17cde1def984989174d8aca50307b6">undo</a>.<a class="code" href="structlog__rec__undo.html#a50bcc130d05619893dbb63c284c3e874">length</a>;</div><div class="line"><a name="l10061"></a><span class="lineno">10061</span>&#160;      <a class="code" href="log__impl_8h.html#afdaa9fdf7d83212b3eec2d515e807686">LOG_READ_ADD_ALIGN</a> (thread_p, <span class="keyword">sizeof</span> (*mvcc_undo), &amp;process_lsa, log_page_p);</div><div class="line"><a name="l10062"></a><span class="lineno">10062</span>&#160;    }</div><div class="line"><a name="l10063"></a><span class="lineno">10063</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="structlog__rec__header.html">log_rec_header</a>-&gt;<a class="code" href="structlog__rec__header.html#aa9be1266bf7fdca13a0a789dc5ae11bb">type</a> == <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7ab4e00d9048c5782ee68b646ff785f6de">LOG_MVCC_UNDOREDO_DATA</a> || <a class="code" href="structlog__rec__header.html">log_rec_header</a>-&gt;<a class="code" href="structlog__rec__header.html#aa9be1266bf7fdca13a0a789dc5ae11bb">type</a> == <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7ae03e50858368a0a9e96e4cb7ce991354">LOG_MVCC_DIFF_UNDOREDO_DATA</a>)</div><div class="line"><a name="l10064"></a><span class="lineno">10064</span>&#160;    {</div><div class="line"><a name="l10065"></a><span class="lineno">10065</span>&#160;      <a class="code" href="log__impl_8h.html#a108c8143796ad50c65f64d4a483e9453">LOG_READ_ADVANCE_WHEN_DOESNT_FIT</a> (thread_p, <span class="keyword">sizeof</span> (*mvcc_undoredo), &amp;process_lsa, log_page_p);</div><div class="line"><a name="l10066"></a><span class="lineno">10066</span>&#160;      mvcc_undoredo = (<a class="code" href="structlog__rec__mvcc__undoredo.html">LOG_REC_MVCC_UNDOREDO</a> *) (log_page_p-&gt;<a class="code" href="structlog__page.html#a9b51b4623cdb8d1686f6f8fb64bc9ee2">area</a> + process_lsa.<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a>);</div><div class="line"><a name="l10067"></a><span class="lineno">10067</span>&#160;</div><div class="line"><a name="l10068"></a><span class="lineno">10068</span>&#160;      udata_length = mvcc_undoredo-&gt;<a class="code" href="structlog__rec__mvcc__undoredo.html#a2183ac89e08754f146da20b81dc18a24">undoredo</a>.<a class="code" href="structlog__rec__undoredo.html#ae7cba71fbe8b2e543bfdb4fe792e1489">ulength</a>;</div><div class="line"><a name="l10069"></a><span class="lineno">10069</span>&#160;      <a class="code" href="log__impl_8h.html#afdaa9fdf7d83212b3eec2d515e807686">LOG_READ_ADD_ALIGN</a> (thread_p, <span class="keyword">sizeof</span> (*mvcc_undoredo), &amp;process_lsa, log_page_p);</div><div class="line"><a name="l10070"></a><span class="lineno">10070</span>&#160;    }</div><div class="line"><a name="l10071"></a><span class="lineno">10071</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="structlog__rec__header.html">log_rec_header</a>-&gt;<a class="code" href="structlog__rec__header.html#aa9be1266bf7fdca13a0a789dc5ae11bb">type</a> == <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a661c01f08dbb476251ceae0d99bb5412">LOG_UNDO_DATA</a>)</div><div class="line"><a name="l10072"></a><span class="lineno">10072</span>&#160;    {</div><div class="line"><a name="l10073"></a><span class="lineno">10073</span>&#160;      <a class="code" href="log__impl_8h.html#a108c8143796ad50c65f64d4a483e9453">LOG_READ_ADVANCE_WHEN_DOESNT_FIT</a> (thread_p, <span class="keyword">sizeof</span> (*undo), &amp;process_lsa, log_page_p);</div><div class="line"><a name="l10074"></a><span class="lineno">10074</span>&#160;      undo = (<a class="code" href="structlog__rec__undo.html">LOG_REC_UNDO</a> *) (log_page_p-&gt;<a class="code" href="structlog__page.html#a9b51b4623cdb8d1686f6f8fb64bc9ee2">area</a> + process_lsa.<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a>);</div><div class="line"><a name="l10075"></a><span class="lineno">10075</span>&#160;</div><div class="line"><a name="l10076"></a><span class="lineno">10076</span>&#160;      udata_length = undo-&gt;<a class="code" href="structlog__rec__undo.html#a50bcc130d05619893dbb63c284c3e874">length</a>;</div><div class="line"><a name="l10077"></a><span class="lineno">10077</span>&#160;      <a class="code" href="log__impl_8h.html#afdaa9fdf7d83212b3eec2d515e807686">LOG_READ_ADD_ALIGN</a> (thread_p, <span class="keyword">sizeof</span> (*undo), &amp;process_lsa, log_page_p);</div><div class="line"><a name="l10078"></a><span class="lineno">10078</span>&#160;    }</div><div class="line"><a name="l10079"></a><span class="lineno">10079</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="structlog__rec__header.html">log_rec_header</a>-&gt;<a class="code" href="structlog__rec__header.html#aa9be1266bf7fdca13a0a789dc5ae11bb">type</a> == <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7aa0d885a58816898b0877635fc7f15716">LOG_UNDOREDO_DATA</a> || <a class="code" href="structlog__rec__header.html">log_rec_header</a>-&gt;<a class="code" href="structlog__rec__header.html#aa9be1266bf7fdca13a0a789dc5ae11bb">type</a> == <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a1e8c5c5dbe12e8cc2388691db7011740">LOG_DIFF_UNDOREDO_DATA</a>)</div><div class="line"><a name="l10080"></a><span class="lineno">10080</span>&#160;    {</div><div class="line"><a name="l10081"></a><span class="lineno">10081</span>&#160;      <a class="code" href="log__impl_8h.html#a108c8143796ad50c65f64d4a483e9453">LOG_READ_ADVANCE_WHEN_DOESNT_FIT</a> (thread_p, <span class="keyword">sizeof</span> (*undoredo), &amp;process_lsa, log_page_p);</div><div class="line"><a name="l10082"></a><span class="lineno">10082</span>&#160;      undoredo = (<a class="code" href="structlog__rec__undoredo.html">LOG_REC_UNDOREDO</a> *) (log_page_p-&gt;<a class="code" href="structlog__page.html#a9b51b4623cdb8d1686f6f8fb64bc9ee2">area</a> + process_lsa.<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a>);</div><div class="line"><a name="l10083"></a><span class="lineno">10083</span>&#160;</div><div class="line"><a name="l10084"></a><span class="lineno">10084</span>&#160;      udata_length = undoredo-&gt;<a class="code" href="structlog__rec__undoredo.html#ae7cba71fbe8b2e543bfdb4fe792e1489">ulength</a>;</div><div class="line"><a name="l10085"></a><span class="lineno">10085</span>&#160;      <a class="code" href="log__impl_8h.html#afdaa9fdf7d83212b3eec2d515e807686">LOG_READ_ADD_ALIGN</a> (thread_p, <span class="keyword">sizeof</span> (*undoredo), &amp;process_lsa, log_page_p);</div><div class="line"><a name="l10086"></a><span class="lineno">10086</span>&#160;    }</div><div class="line"><a name="l10087"></a><span class="lineno">10087</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l10088"></a><span class="lineno">10088</span>&#160;    {</div><div class="line"><a name="l10089"></a><span class="lineno">10089</span>&#160;      <a class="code" href="error__manager_8h.html#a34b88b0e828e26dd5cf930a0b1dd57a7">assert_release</a> (<a class="code" href="structlog__rec__header.html">log_rec_header</a>-&gt;<a class="code" href="structlog__rec__header.html#aa9be1266bf7fdca13a0a789dc5ae11bb">type</a> == <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a5eb32eedc7671f3f89c1b10c3d0229c1">LOG_MVCC_UNDO_DATA</a> || <a class="code" href="structlog__rec__header.html">log_rec_header</a>-&gt;<a class="code" href="structlog__rec__header.html#aa9be1266bf7fdca13a0a789dc5ae11bb">type</a> == <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7ab4e00d9048c5782ee68b646ff785f6de">LOG_MVCC_UNDOREDO_DATA</a></div><div class="line"><a name="l10090"></a><span class="lineno">10090</span>&#160;              || <a class="code" href="structlog__rec__header.html">log_rec_header</a>-&gt;<a class="code" href="structlog__rec__header.html#aa9be1266bf7fdca13a0a789dc5ae11bb">type</a> == <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7ae03e50858368a0a9e96e4cb7ce991354">LOG_MVCC_DIFF_UNDOREDO_DATA</a> || <a class="code" href="structlog__rec__header.html">log_rec_header</a>-&gt;<a class="code" href="structlog__rec__header.html#aa9be1266bf7fdca13a0a789dc5ae11bb">type</a> == <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a661c01f08dbb476251ceae0d99bb5412">LOG_UNDO_DATA</a></div><div class="line"><a name="l10091"></a><span class="lineno">10091</span>&#160;              || <a class="code" href="structlog__rec__header.html">log_rec_header</a>-&gt;<a class="code" href="structlog__rec__header.html#aa9be1266bf7fdca13a0a789dc5ae11bb">type</a> == <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7aa0d885a58816898b0877635fc7f15716">LOG_UNDOREDO_DATA</a></div><div class="line"><a name="l10092"></a><span class="lineno">10092</span>&#160;              || <a class="code" href="structlog__rec__header.html">log_rec_header</a>-&gt;<a class="code" href="structlog__rec__header.html#aa9be1266bf7fdca13a0a789dc5ae11bb">type</a> == <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7ae03e50858368a0a9e96e4cb7ce991354">LOG_MVCC_DIFF_UNDOREDO_DATA</a>);</div><div class="line"><a name="l10093"></a><span class="lineno">10093</span>&#160;      <a class="code" href="error__manager_8c.html#afdaf87ce30f2f557802a185ab85b6599">er_set</a> (<a class="code" href="error__manager_8h.html#a5d0d456c474e11fc70779873a30a7432a3314630dd19f90a68274cf737092c9f2">ER_FATAL_ERROR_SEVERITY</a>, <a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <a class="code" href="error__code_8h.html#a0fe5a2a2c2ff79b0b781f348bec6ead8">ER_LOG_FATAL_ERROR</a>, 1, <span class="stringliteral">&quot;Expecting undo/undoredo log record&quot;</span>);</div><div class="line"><a name="l10094"></a><span class="lineno">10094</span>&#160;      scan = <a class="code" href="storage__common_8h.html#ad704198b3c56cf17601de69c679a7181aa09fa5ed5be816eeb89a11be5a00c477">S_ERROR</a>;</div><div class="line"><a name="l10095"></a><span class="lineno">10095</span>&#160;      <span class="keywordflow">goto</span> exit;</div><div class="line"><a name="l10096"></a><span class="lineno">10096</span>&#160;    }</div><div class="line"><a name="l10097"></a><span class="lineno">10097</span>&#160;</div><div class="line"><a name="l10098"></a><span class="lineno">10098</span>&#160;  <span class="comment">/* get undo record */</span></div><div class="line"><a name="l10099"></a><span class="lineno">10099</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="log__compress_8h.html#acc57c2f6ae6f861d965ca95a4085cdf1">ZIP_CHECK</a> (udata_length))</div><div class="line"><a name="l10100"></a><span class="lineno">10100</span>&#160;    {</div><div class="line"><a name="l10101"></a><span class="lineno">10101</span>&#160;      <span class="comment">/* Get real size */</span></div><div class="line"><a name="l10102"></a><span class="lineno">10102</span>&#160;      udata_size = (<a class="code" href="mprec_8c.html#a61569f2965b7a369eb10b6d75d410d11">int</a>) <a class="code" href="log__compress_8h.html#ac32e36fd25b171236ebb38a5be94d00c">GET_ZIP_LEN</a> (udata_length);</div><div class="line"><a name="l10103"></a><span class="lineno">10103</span>&#160;      is_zipped = <span class="keyword">true</span>;</div><div class="line"><a name="l10104"></a><span class="lineno">10104</span>&#160;    }</div><div class="line"><a name="l10105"></a><span class="lineno">10105</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l10106"></a><span class="lineno">10106</span>&#160;    {</div><div class="line"><a name="l10107"></a><span class="lineno">10107</span>&#160;      udata_size = udata_length;</div><div class="line"><a name="l10108"></a><span class="lineno">10108</span>&#160;    }</div><div class="line"><a name="l10109"></a><span class="lineno">10109</span>&#160;</div><div class="line"><a name="l10110"></a><span class="lineno">10110</span>&#160;  <span class="comment">/* </span></div><div class="line"><a name="l10111"></a><span class="lineno">10111</span>&#160;<span class="comment">   * If data is contained in only one buffer, pass pointer directly.</span></div><div class="line"><a name="l10112"></a><span class="lineno">10112</span>&#160;<span class="comment">   * Otherwise, copy the data into a contiguous area and pass this area.</span></div><div class="line"><a name="l10113"></a><span class="lineno">10113</span>&#160;<span class="comment">   */</span></div><div class="line"><a name="l10114"></a><span class="lineno">10114</span>&#160;  <span class="keywordflow">if</span> (process_lsa.<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a> + udata_size &lt; (<span class="keywordtype">int</span>) <a class="code" href="log__impl_8h.html#a7790a20af76ed5282450723f2e09c4e2">LOGAREA_SIZE</a>)</div><div class="line"><a name="l10115"></a><span class="lineno">10115</span>&#160;    {</div><div class="line"><a name="l10116"></a><span class="lineno">10116</span>&#160;      undo_data = (<span class="keywordtype">char</span> *) log_page_p-&gt;<a class="code" href="structlog__page.html#a9b51b4623cdb8d1686f6f8fb64bc9ee2">area</a> + process_lsa.<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a>;</div><div class="line"><a name="l10117"></a><span class="lineno">10117</span>&#160;    }</div><div class="line"><a name="l10118"></a><span class="lineno">10118</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l10119"></a><span class="lineno">10119</span>&#160;    {</div><div class="line"><a name="l10120"></a><span class="lineno">10120</span>&#160;      <span class="comment">/* Need to copy the data into a contiguous area */</span></div><div class="line"><a name="l10121"></a><span class="lineno">10121</span>&#160;</div><div class="line"><a name="l10122"></a><span class="lineno">10122</span>&#160;      <span class="keywordflow">if</span> (udata_size &lt;= <a class="code" href="storage__common_8h.html#a0a3c7db68a92df0d34666257bb0f17dd">IO_MAX_PAGE_SIZE</a>)</div><div class="line"><a name="l10123"></a><span class="lineno">10123</span>&#160;    {</div><div class="line"><a name="l10124"></a><span class="lineno">10124</span>&#160;      <a class="code" href="structarea.html">area</a> = <a class="code" href="memory__alloc_8h.html#a79781c0dbfdd9510d275cba54f1f384f">PTR_ALIGN</a> (log_buf, <a class="code" href="memory__alloc_8h.html#a81d7e4971ffc775a379eeb4c65fa30f8">MAX_ALIGNMENT</a>);</div><div class="line"><a name="l10125"></a><span class="lineno">10125</span>&#160;    }</div><div class="line"><a name="l10126"></a><span class="lineno">10126</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l10127"></a><span class="lineno">10127</span>&#160;    {</div><div class="line"><a name="l10128"></a><span class="lineno">10128</span>&#160;      <a class="code" href="structarea.html">area</a> = (<span class="keywordtype">char</span> *) <a class="code" href="leak__detector_8h.html#a99aa8fd9f4831e1b0fa9e1cdcde3e249">malloc</a> (udata_size);</div><div class="line"><a name="l10129"></a><span class="lineno">10129</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="structarea.html">area</a> == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l10130"></a><span class="lineno">10130</span>&#160;        {</div><div class="line"><a name="l10131"></a><span class="lineno">10131</span>&#160;          <a class="code" href="error__manager_8c.html#afdaf87ce30f2f557802a185ab85b6599">er_set</a> (<a class="code" href="error__manager_8h.html#a5d0d456c474e11fc70779873a30a7432a07ad8f9fda27124d297c94b7d3ea44e8">ER_ERROR_SEVERITY</a>, <a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <a class="code" href="error__code_8h.html#a1f7116a1f1981bc7ef25fc6078518692">ER_OUT_OF_VIRTUAL_MEMORY</a>, 1, udata_size);</div><div class="line"><a name="l10132"></a><span class="lineno">10132</span>&#160;          scan = <a class="code" href="storage__common_8h.html#ad704198b3c56cf17601de69c679a7181aa09fa5ed5be816eeb89a11be5a00c477">S_ERROR</a>;</div><div class="line"><a name="l10133"></a><span class="lineno">10133</span>&#160;          <span class="keywordflow">goto</span> exit;</div><div class="line"><a name="l10134"></a><span class="lineno">10134</span>&#160;        }</div><div class="line"><a name="l10135"></a><span class="lineno">10135</span>&#160;      area_was_mallocated = <span class="keyword">true</span>;</div><div class="line"><a name="l10136"></a><span class="lineno">10136</span>&#160;    }</div><div class="line"><a name="l10137"></a><span class="lineno">10137</span>&#160;</div><div class="line"><a name="l10138"></a><span class="lineno">10138</span>&#160;      <span class="comment">/* Copy the data */</span></div><div class="line"><a name="l10139"></a><span class="lineno">10139</span>&#160;      <a class="code" href="log__impl_8h.html#a390f2d36dcfc756ef528e21b94f7525c">logpb_copy_from_log</a> (thread_p, <a class="code" href="structarea.html">area</a>, udata_size, &amp;process_lsa, log_page_p);</div><div class="line"><a name="l10140"></a><span class="lineno">10140</span>&#160;      undo_data = <a class="code" href="structarea.html">area</a>;</div><div class="line"><a name="l10141"></a><span class="lineno">10141</span>&#160;    }</div><div class="line"><a name="l10142"></a><span class="lineno">10142</span>&#160;</div><div class="line"><a name="l10143"></a><span class="lineno">10143</span>&#160;  <span class="keywordflow">if</span> (is_zipped)</div><div class="line"><a name="l10144"></a><span class="lineno">10144</span>&#160;    {</div><div class="line"><a name="l10145"></a><span class="lineno">10145</span>&#160;      log_unzip_ptr = <a class="code" href="log__compress_8c.html#a57a48bb541f858a2602ae9f731f5200e">log_zip_alloc</a> (<a class="code" href="storage__common_8h.html#a097b8646f24ea98e209e18c53d74522a">IO_PAGESIZE</a>, <span class="keyword">false</span>);</div><div class="line"><a name="l10146"></a><span class="lineno">10146</span>&#160;      <span class="keywordflow">if</span> (log_unzip_ptr == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l10147"></a><span class="lineno">10147</span>&#160;    {</div><div class="line"><a name="l10148"></a><span class="lineno">10148</span>&#160;      <a class="code" href="log__impl_8h.html#a8e111eafc27b6e1383fbd0ee812b1167">logpb_fatal_error</a> (thread_p, <span class="keyword">true</span>, <a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <span class="stringliteral">&quot;log_get_undo_record&quot;</span>);</div><div class="line"><a name="l10149"></a><span class="lineno">10149</span>&#160;      scan = <a class="code" href="storage__common_8h.html#ad704198b3c56cf17601de69c679a7181aa09fa5ed5be816eeb89a11be5a00c477">S_ERROR</a>;</div><div class="line"><a name="l10150"></a><span class="lineno">10150</span>&#160;      <span class="keywordflow">goto</span> exit;</div><div class="line"><a name="l10151"></a><span class="lineno">10151</span>&#160;    }</div><div class="line"><a name="l10152"></a><span class="lineno">10152</span>&#160;</div><div class="line"><a name="l10153"></a><span class="lineno">10153</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="log__compress_8c.html#a239701bd8e957bb4f8f9db1bfcf370a1">log_unzip</a> (log_unzip_ptr, udata_size, (<span class="keywordtype">char</span> *) undo_data))</div><div class="line"><a name="l10154"></a><span class="lineno">10154</span>&#160;    {</div><div class="line"><a name="l10155"></a><span class="lineno">10155</span>&#160;      udata_size = (<a class="code" href="mprec_8c.html#a61569f2965b7a369eb10b6d75d410d11">int</a>) log_unzip_ptr-&gt;<a class="code" href="structlog__zip.html#a3e723c649a96cb0c0af4516d40fc4aed">data_length</a>;</div><div class="line"><a name="l10156"></a><span class="lineno">10156</span>&#160;      undo_data = (<span class="keywordtype">char</span> *) log_unzip_ptr-&gt;<a class="code" href="structlog__zip.html#ac57b9be7fa6f4be036cf9e6db8565195">log_data</a>;</div><div class="line"><a name="l10157"></a><span class="lineno">10157</span>&#160;    }</div><div class="line"><a name="l10158"></a><span class="lineno">10158</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l10159"></a><span class="lineno">10159</span>&#160;    {</div><div class="line"><a name="l10160"></a><span class="lineno">10160</span>&#160;      <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (<span class="keyword">false</span>);</div><div class="line"><a name="l10161"></a><span class="lineno">10161</span>&#160;      scan = <a class="code" href="storage__common_8h.html#ad704198b3c56cf17601de69c679a7181aa09fa5ed5be816eeb89a11be5a00c477">S_ERROR</a>;</div><div class="line"><a name="l10162"></a><span class="lineno">10162</span>&#160;      <span class="keywordflow">goto</span> exit;</div><div class="line"><a name="l10163"></a><span class="lineno">10163</span>&#160;    }</div><div class="line"><a name="l10164"></a><span class="lineno">10164</span>&#160;    }</div><div class="line"><a name="l10165"></a><span class="lineno">10165</span>&#160;</div><div class="line"><a name="l10166"></a><span class="lineno">10166</span>&#160;  <span class="comment">/* copy the record */</span></div><div class="line"><a name="l10167"></a><span class="lineno">10167</span>&#160;  <a class="code" href="structrecdes.html">recdes</a>-&gt;<a class="code" href="structrecdes.html#a67343783639754b873ee300e3c742bc4">type</a> = *(INT16 *) (undo_data);</div><div class="line"><a name="l10168"></a><span class="lineno">10168</span>&#160;  <a class="code" href="structrecdes.html">recdes</a>-&gt;<a class="code" href="structrecdes.html#ad79507ad26c0f557815cb78ce391be8b">length</a> = udata_size - <span class="keyword">sizeof</span> (<a class="code" href="structrecdes.html">recdes</a>-&gt;<a class="code" href="structrecdes.html#a67343783639754b873ee300e3c742bc4">type</a>);</div><div class="line"><a name="l10169"></a><span class="lineno">10169</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="structrecdes.html">recdes</a>-&gt;<a class="code" href="structrecdes.html#a445953dc76a228f95f98c269ffd1c949">area_size</a> &lt; 0 || <a class="code" href="structrecdes.html">recdes</a>-&gt;<a class="code" href="structrecdes.html#a445953dc76a228f95f98c269ffd1c949">area_size</a> &lt; (<span class="keywordtype">int</span>) <a class="code" href="structrecdes.html">recdes</a>-&gt;<a class="code" href="structrecdes.html#ad79507ad26c0f557815cb78ce391be8b">length</a>)</div><div class="line"><a name="l10170"></a><span class="lineno">10170</span>&#160;    {</div><div class="line"><a name="l10171"></a><span class="lineno">10171</span>&#160;      <span class="comment">/* </span></div><div class="line"><a name="l10172"></a><span class="lineno">10172</span>&#160;<span class="comment">       * DOES NOT FIT</span></div><div class="line"><a name="l10173"></a><span class="lineno">10173</span>&#160;<span class="comment">       * Give a hint to the user of the needed length. Hint is given as a</span></div><div class="line"><a name="l10174"></a><span class="lineno">10174</span>&#160;<span class="comment">       * negative value</span></div><div class="line"><a name="l10175"></a><span class="lineno">10175</span>&#160;<span class="comment">       */</span></div><div class="line"><a name="l10176"></a><span class="lineno">10176</span>&#160;      <span class="comment">/* do not use unary minus because slot_p-&gt;record_length is unsigned */</span></div><div class="line"><a name="l10177"></a><span class="lineno">10177</span>&#160;      <a class="code" href="structrecdes.html">recdes</a>-&gt;<a class="code" href="structrecdes.html#ad79507ad26c0f557815cb78ce391be8b">length</a> *= -1;</div><div class="line"><a name="l10178"></a><span class="lineno">10178</span>&#160;</div><div class="line"><a name="l10179"></a><span class="lineno">10179</span>&#160;      scan = <a class="code" href="storage__common_8h.html#ad704198b3c56cf17601de69c679a7181a35abaa3db871d8483efae56e6287cd67">S_DOESNT_FIT</a>;</div><div class="line"><a name="l10180"></a><span class="lineno">10180</span>&#160;      <span class="keywordflow">goto</span> exit;</div><div class="line"><a name="l10181"></a><span class="lineno">10181</span>&#160;    }</div><div class="line"><a name="l10182"></a><span class="lineno">10182</span>&#160;</div><div class="line"><a name="l10183"></a><span class="lineno">10183</span>&#160;  memcpy (<a class="code" href="structrecdes.html">recdes</a>-&gt;<a class="code" href="structrecdes.html#a78fb3ee3142e50670d431d8f7c302b62">data</a>, (<span class="keywordtype">char</span> *) (undo_data) + sizeof (<a class="code" href="structrecdes.html">recdes</a>-&gt;<a class="code" href="structrecdes.html#a67343783639754b873ee300e3c742bc4">type</a>), <a class="code" href="structrecdes.html">recdes</a>-&gt;<a class="code" href="structrecdes.html#ad79507ad26c0f557815cb78ce391be8b">length</a>);</div><div class="line"><a name="l10184"></a><span class="lineno">10184</span>&#160;</div><div class="line"><a name="l10185"></a><span class="lineno">10185</span>&#160;exit:</div><div class="line"><a name="l10186"></a><span class="lineno">10186</span>&#160;  <span class="keywordflow">if</span> (area_was_mallocated)</div><div class="line"><a name="l10187"></a><span class="lineno">10187</span>&#160;    {</div><div class="line"><a name="l10188"></a><span class="lineno">10188</span>&#160;      <a class="code" href="leak__detector_8h.html#a9d4b5df3530d1bc733070a4669ba6ebc">free</a> (<a class="code" href="structarea.html">area</a>);</div><div class="line"><a name="l10189"></a><span class="lineno">10189</span>&#160;    }</div><div class="line"><a name="l10190"></a><span class="lineno">10190</span>&#160;  <span class="keywordflow">if</span> (log_unzip_ptr != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l10191"></a><span class="lineno">10191</span>&#160;    {</div><div class="line"><a name="l10192"></a><span class="lineno">10192</span>&#160;      <a class="code" href="log__compress_8c.html#a87b9003990e598725fe9ed434ce007c9">log_zip_free</a> (log_unzip_ptr);</div><div class="line"><a name="l10193"></a><span class="lineno">10193</span>&#160;    }</div><div class="line"><a name="l10194"></a><span class="lineno">10194</span>&#160;</div><div class="line"><a name="l10195"></a><span class="lineno">10195</span>&#160;  <span class="keywordflow">return</span> scan;</div><div class="line"><a name="l10196"></a><span class="lineno">10196</span>&#160;}</div><div class="line"><a name="l10197"></a><span class="lineno">10197</span>&#160;</div><div class="line"><a name="l10198"></a><span class="lineno">10198</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l10199"></a><span class="lineno">10199</span>&#160;<span class="comment"> * log_read_sysop_start_postpone () - read system op start postpone and its recovery data</span></div><div class="line"><a name="l10200"></a><span class="lineno">10200</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l10201"></a><span class="lineno">10201</span>&#160;<span class="comment"> * return                     : error code</span></div><div class="line"><a name="l10202"></a><span class="lineno">10202</span>&#160;<span class="comment"> * thread_p (in)              : thread entry</span></div><div class="line"><a name="l10203"></a><span class="lineno">10203</span>&#160;<span class="comment"> * log_lsa (in/out)           : log address</span></div><div class="line"><a name="l10204"></a><span class="lineno">10204</span>&#160;<span class="comment"> * log_page (in/out)          : log page</span></div><div class="line"><a name="l10205"></a><span class="lineno">10205</span>&#160;<span class="comment"> * with_undo_data (in)        : true to read undo data</span></div><div class="line"><a name="l10206"></a><span class="lineno">10206</span>&#160;<span class="comment"> * sysop_start_postpone (out) : output system op start postpone log record</span></div><div class="line"><a name="l10207"></a><span class="lineno">10207</span>&#160;<span class="comment"> * undo_buffer_size (in/out)  : size for undo data buffer</span></div><div class="line"><a name="l10208"></a><span class="lineno">10208</span>&#160;<span class="comment"> * undo_buffer (in/out)       : undo data buffer</span></div><div class="line"><a name="l10209"></a><span class="lineno">10209</span>&#160;<span class="comment"> * undo_size (out)            : output undo data size</span></div><div class="line"><a name="l10210"></a><span class="lineno">10210</span>&#160;<span class="comment"> * undo_data (out)            : output undo data</span></div><div class="line"><a name="l10211"></a><span class="lineno">10211</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l10212"></a><span class="lineno">10212</span>&#160;<span class="keywordtype">int</span></div><div class="line"><a name="l10213"></a><span class="lineno"><a class="line" href="log__manager_8h.html#a3f7aa6e8738dd9b63a10f6476b5161bc">10213</a></span>&#160;<a class="code" href="log__manager_8c.html#a3f7aa6e8738dd9b63a10f6476b5161bc">log_read_sysop_start_postpone</a> (<a class="code" href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a> * thread_p, <a class="code" href="structlog__lsa.html">LOG_LSA</a> * <a class="code" href="structlog__lsa.html">log_lsa</a>, <a class="code" href="structlog__page.html">LOG_PAGE</a> * <a class="code" href="structlog__page.html">log_page</a>, <span class="keywordtype">bool</span> with_undo_data,</div><div class="line"><a name="l10214"></a><span class="lineno">10214</span>&#160;                   <a class="code" href="structlog__rec__sysop__start__postpone.html">LOG_REC_SYSOP_START_POSTPONE</a> * sysop_start_postpone, <span class="keywordtype">int</span> *undo_buffer_size,</div><div class="line"><a name="l10215"></a><span class="lineno">10215</span>&#160;                   <span class="keywordtype">char</span> **undo_buffer, <span class="keywordtype">int</span> *undo_size, <span class="keywordtype">char</span> **undo_data)</div><div class="line"><a name="l10216"></a><span class="lineno">10216</span>&#160;{</div><div class="line"><a name="l10217"></a><span class="lineno">10217</span>&#160;  <span class="keywordtype">int</span> error_code = <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>;</div><div class="line"><a name="l10218"></a><span class="lineno">10218</span>&#160;</div><div class="line"><a name="l10219"></a><span class="lineno">10219</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="structlog__page.html">log_page</a>-&gt;<a class="code" href="structlog__page.html#a52640d2c65b2d7b95a330a670646e8f9">hdr</a>.<a class="code" href="structlog__hdrpage.html#a1fd8a9a0219da51bb77b11766056f149">logical_pageid</a> != <a class="code" href="structlog__lsa.html">log_lsa</a>-&gt;<a class="code" href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">pageid</a>)</div><div class="line"><a name="l10220"></a><span class="lineno">10220</span>&#160;    {</div><div class="line"><a name="l10221"></a><span class="lineno">10221</span>&#160;      error_code = <a class="code" href="log__impl_8h.html#ac67cba94ac6c10da3ae0ab474155ea1a">logpb_fetch_page</a> (thread_p, <a class="code" href="structlog__lsa.html">log_lsa</a>, <a class="code" href="log__impl_8h.html#ab33fe5f69028f102e9910294e97ccd6babc4379db94a7ff5ff8491988a7c28bc1">LOG_CS_FORCE_USE</a>, <a class="code" href="structlog__page.html">log_page</a>);</div><div class="line"><a name="l10222"></a><span class="lineno">10222</span>&#160;      <span class="keywordflow">if</span> (error_code != <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>)</div><div class="line"><a name="l10223"></a><span class="lineno">10223</span>&#160;    {</div><div class="line"><a name="l10224"></a><span class="lineno">10224</span>&#160;      <a class="code" href="error__manager_8h.html#a58c6148c01f4a56a3d04b8719b916d01">ASSERT_ERROR</a> ();</div><div class="line"><a name="l10225"></a><span class="lineno">10225</span>&#160;      <span class="keywordflow">return</span> error_code;</div><div class="line"><a name="l10226"></a><span class="lineno">10226</span>&#160;    }</div><div class="line"><a name="l10227"></a><span class="lineno">10227</span>&#160;    }</div><div class="line"><a name="l10228"></a><span class="lineno">10228</span>&#160;</div><div class="line"><a name="l10229"></a><span class="lineno">10229</span>&#160;  <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (((<a class="code" href="structlog__rec__header.html">LOG_RECORD_HEADER</a> *) (<a class="code" href="structlog__page.html">log_page</a>-&gt;<a class="code" href="structlog__page.html#a9b51b4623cdb8d1686f6f8fb64bc9ee2">area</a> + <a class="code" href="structlog__lsa.html">log_lsa</a>-&gt;<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a>))-&gt;type == <a class="code" href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a198b93b13d51133e5e5d4b8e7c62f54e">LOG_SYSOP_START_POSTPONE</a>);</div><div class="line"><a name="l10230"></a><span class="lineno">10230</span>&#160;</div><div class="line"><a name="l10231"></a><span class="lineno">10231</span>&#160;  <span class="comment">/* skip log record header */</span></div><div class="line"><a name="l10232"></a><span class="lineno">10232</span>&#160;  <a class="code" href="log__impl_8h.html#afdaa9fdf7d83212b3eec2d515e807686">LOG_READ_ADD_ALIGN</a> (thread_p, <span class="keyword">sizeof</span> (<a class="code" href="structlog__rec__header.html">LOG_RECORD_HEADER</a>), <a class="code" href="structlog__lsa.html">log_lsa</a>, <a class="code" href="structlog__page.html">log_page</a>);</div><div class="line"><a name="l10233"></a><span class="lineno">10233</span>&#160;</div><div class="line"><a name="l10234"></a><span class="lineno">10234</span>&#160;  <span class="comment">/* read sysop_start_postpone */</span></div><div class="line"><a name="l10235"></a><span class="lineno">10235</span>&#160;  <a class="code" href="log__impl_8h.html#a108c8143796ad50c65f64d4a483e9453">LOG_READ_ADVANCE_WHEN_DOESNT_FIT</a> (thread_p, <span class="keyword">sizeof</span> (<a class="code" href="structlog__rec__sysop__start__postpone.html">LOG_REC_SYSOP_START_POSTPONE</a>), <a class="code" href="structlog__lsa.html">log_lsa</a>, <a class="code" href="structlog__page.html">log_page</a>);</div><div class="line"><a name="l10236"></a><span class="lineno">10236</span>&#160;  *sysop_start_postpone = *(<a class="code" href="structlog__rec__sysop__start__postpone.html">LOG_REC_SYSOP_START_POSTPONE</a> *) (<a class="code" href="structlog__page.html">log_page</a>-&gt;<a class="code" href="structlog__page.html#a9b51b4623cdb8d1686f6f8fb64bc9ee2">area</a> + <a class="code" href="structlog__lsa.html">log_lsa</a>-&gt;<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a>);</div><div class="line"><a name="l10237"></a><span class="lineno">10237</span>&#160;  <span class="keywordflow">if</span> (!with_undo_data</div><div class="line"><a name="l10238"></a><span class="lineno">10238</span>&#160;      || (sysop_start_postpone-&gt;<a class="code" href="structlog__rec__sysop__start__postpone.html#a75ba94263889a5daa036f05cb3a453dc">sysop_end</a>.<a class="code" href="structlog__rec__sysop__end.html#a3ea9d3ebfe5a0ed547670f1409fb385f">type</a> != <a class="code" href="log__impl_8h.html#a24797b2fe67e0ec8631d7a92fbef25c9ac4566a4bae57d0a42fa6e37cc65e5329">LOG_SYSOP_END_LOGICAL_UNDO</a></div><div class="line"><a name="l10239"></a><span class="lineno">10239</span>&#160;      &amp;&amp; sysop_start_postpone-&gt;<a class="code" href="structlog__rec__sysop__start__postpone.html#a75ba94263889a5daa036f05cb3a453dc">sysop_end</a>.<a class="code" href="structlog__rec__sysop__end.html#a3ea9d3ebfe5a0ed547670f1409fb385f">type</a> != <a class="code" href="log__impl_8h.html#a24797b2fe67e0ec8631d7a92fbef25c9a571011a0354832edf02d40490f512716">LOG_SYSOP_END_LOGICAL_MVCC_UNDO</a>))</div><div class="line"><a name="l10240"></a><span class="lineno">10240</span>&#160;    {</div><div class="line"><a name="l10241"></a><span class="lineno">10241</span>&#160;      <span class="comment">/* no undo */</span></div><div class="line"><a name="l10242"></a><span class="lineno">10242</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>;</div><div class="line"><a name="l10243"></a><span class="lineno">10243</span>&#160;    }</div><div class="line"><a name="l10244"></a><span class="lineno">10244</span>&#160;</div><div class="line"><a name="l10245"></a><span class="lineno">10245</span>&#160;  <span class="comment">/* read undo data and size */</span></div><div class="line"><a name="l10246"></a><span class="lineno">10246</span>&#160;  <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (undo_buffer_size != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l10247"></a><span class="lineno">10247</span>&#160;  <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (undo_buffer != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l10248"></a><span class="lineno">10248</span>&#160;  <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (undo_size != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l10249"></a><span class="lineno">10249</span>&#160;  <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (undo_data != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l10250"></a><span class="lineno">10250</span>&#160;</div><div class="line"><a name="l10251"></a><span class="lineno">10251</span>&#160;  <span class="keywordflow">if</span> (sysop_start_postpone-&gt;<a class="code" href="structlog__rec__sysop__start__postpone.html#a75ba94263889a5daa036f05cb3a453dc">sysop_end</a>.<a class="code" href="structlog__rec__sysop__end.html#a3ea9d3ebfe5a0ed547670f1409fb385f">type</a> == <a class="code" href="log__impl_8h.html#a24797b2fe67e0ec8631d7a92fbef25c9ac4566a4bae57d0a42fa6e37cc65e5329">LOG_SYSOP_END_LOGICAL_UNDO</a>)</div><div class="line"><a name="l10252"></a><span class="lineno">10252</span>&#160;    {</div><div class="line"><a name="l10253"></a><span class="lineno">10253</span>&#160;      *undo_size = sysop_start_postpone-&gt;<a class="code" href="structlog__rec__sysop__start__postpone.html#a75ba94263889a5daa036f05cb3a453dc">sysop_end</a>.<a class="code" href="structlog__rec__sysop__end.html#a34c029c46715b2edc97a8f2c5ce9d309">undo</a>.<a class="code" href="structlog__rec__undo.html#a50bcc130d05619893dbb63c284c3e874">length</a>;</div><div class="line"><a name="l10254"></a><span class="lineno">10254</span>&#160;    }</div><div class="line"><a name="l10255"></a><span class="lineno">10255</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l10256"></a><span class="lineno">10256</span>&#160;    {</div><div class="line"><a name="l10257"></a><span class="lineno">10257</span>&#160;      <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (sysop_start_postpone-&gt;<a class="code" href="structlog__rec__sysop__start__postpone.html#a75ba94263889a5daa036f05cb3a453dc">sysop_end</a>.<a class="code" href="structlog__rec__sysop__end.html#a3ea9d3ebfe5a0ed547670f1409fb385f">type</a> == <a class="code" href="log__impl_8h.html#a24797b2fe67e0ec8631d7a92fbef25c9a571011a0354832edf02d40490f512716">LOG_SYSOP_END_LOGICAL_MVCC_UNDO</a>);</div><div class="line"><a name="l10258"></a><span class="lineno">10258</span>&#160;      *undo_size = sysop_start_postpone-&gt;<a class="code" href="structlog__rec__sysop__start__postpone.html#a75ba94263889a5daa036f05cb3a453dc">sysop_end</a>.<a class="code" href="structlog__rec__sysop__end.html#a013e84a84232dee701d8083c07a172c9">mvcc_undo</a>.<a class="code" href="structlog__rec__mvcc__undo.html#a7f17cde1def984989174d8aca50307b6">undo</a>.<a class="code" href="structlog__rec__undo.html#a50bcc130d05619893dbb63c284c3e874">length</a>;</div><div class="line"><a name="l10259"></a><span class="lineno">10259</span>&#160;    }</div><div class="line"><a name="l10260"></a><span class="lineno">10260</span>&#160;</div><div class="line"><a name="l10261"></a><span class="lineno">10261</span>&#160;  <a class="code" href="log__impl_8h.html#afdaa9fdf7d83212b3eec2d515e807686">LOG_READ_ADD_ALIGN</a> (thread_p, <span class="keyword">sizeof</span> (<a class="code" href="structlog__rec__sysop__start__postpone.html">LOG_REC_SYSOP_START_POSTPONE</a>), <a class="code" href="structlog__lsa.html">log_lsa</a>, <a class="code" href="structlog__page.html">log_page</a>);</div><div class="line"><a name="l10262"></a><span class="lineno">10262</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="structlog__lsa.html">log_lsa</a>-&gt;<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a> + (*undo_size) &lt; (<span class="keywordtype">int</span>) <a class="code" href="log__impl_8h.html#a7790a20af76ed5282450723f2e09c4e2">LOGAREA_SIZE</a>)</div><div class="line"><a name="l10263"></a><span class="lineno">10263</span>&#160;    {</div><div class="line"><a name="l10264"></a><span class="lineno">10264</span>&#160;      *undo_data = <a class="code" href="structlog__page.html">log_page</a>-&gt;<a class="code" href="structlog__page.html#a9b51b4623cdb8d1686f6f8fb64bc9ee2">area</a> + <a class="code" href="structlog__lsa.html">log_lsa</a>-&gt;<a class="code" href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">offset</a>;</div><div class="line"><a name="l10265"></a><span class="lineno">10265</span>&#160;    }</div><div class="line"><a name="l10266"></a><span class="lineno">10266</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l10267"></a><span class="lineno">10267</span>&#160;    {</div><div class="line"><a name="l10268"></a><span class="lineno">10268</span>&#160;      <span class="keywordflow">if</span> (*undo_buffer_size == 0)</div><div class="line"><a name="l10269"></a><span class="lineno">10269</span>&#160;    {</div><div class="line"><a name="l10270"></a><span class="lineno">10270</span>&#160;      *undo_buffer = (<span class="keywordtype">char</span> *) <a class="code" href="memory__alloc_8h.html#a8b903d0a51cce71105b6a706159717e4">db_private_alloc</a> (thread_p, *undo_size);</div><div class="line"><a name="l10271"></a><span class="lineno">10271</span>&#160;    }</div><div class="line"><a name="l10272"></a><span class="lineno">10272</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (*undo_buffer_size &lt; *undo_size)</div><div class="line"><a name="l10273"></a><span class="lineno">10273</span>&#160;    {</div><div class="line"><a name="l10274"></a><span class="lineno">10274</span>&#160;      <span class="keywordtype">char</span> *new_ptr = (<span class="keywordtype">char</span> *) <a class="code" href="memory__alloc_8h.html#a766ee0914a2859955a692c6a41b695c7">db_private_realloc</a> (thread_p, *undo_buffer, *undo_size);</div><div class="line"><a name="l10275"></a><span class="lineno">10275</span>&#160;      <span class="keywordflow">if</span> (new_ptr == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l10276"></a><span class="lineno">10276</span>&#160;        {</div><div class="line"><a name="l10277"></a><span class="lineno">10277</span>&#160;          <a class="code" href="error__manager_8c.html#afdaf87ce30f2f557802a185ab85b6599">er_set</a> (<a class="code" href="error__manager_8h.html#a5d0d456c474e11fc70779873a30a7432a07ad8f9fda27124d297c94b7d3ea44e8">ER_ERROR_SEVERITY</a>, <a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <a class="code" href="error__code_8h.html#a1f7116a1f1981bc7ef25fc6078518692">ER_OUT_OF_VIRTUAL_MEMORY</a>, 1, *undo_size);</div><div class="line"><a name="l10278"></a><span class="lineno">10278</span>&#160;          <span class="keywordflow">return</span> <a class="code" href="error__code_8h.html#a1f7116a1f1981bc7ef25fc6078518692">ER_OUT_OF_VIRTUAL_MEMORY</a>;</div><div class="line"><a name="l10279"></a><span class="lineno">10279</span>&#160;        }</div><div class="line"><a name="l10280"></a><span class="lineno">10280</span>&#160;      *undo_buffer_size = *undo_size;</div><div class="line"><a name="l10281"></a><span class="lineno">10281</span>&#160;      *undo_buffer = new_ptr;</div><div class="line"><a name="l10282"></a><span class="lineno">10282</span>&#160;    }</div><div class="line"><a name="l10283"></a><span class="lineno">10283</span>&#160;      *undo_data = *undo_buffer;</div><div class="line"><a name="l10284"></a><span class="lineno">10284</span>&#160;      <a class="code" href="log__impl_8h.html#a390f2d36dcfc756ef528e21b94f7525c">logpb_copy_from_log</a> (thread_p, *undo_data, *undo_size, <a class="code" href="structlog__lsa.html">log_lsa</a>, <a class="code" href="structlog__page.html">log_page</a>);</div><div class="line"><a name="l10285"></a><span class="lineno">10285</span>&#160;    }</div><div class="line"><a name="l10286"></a><span class="lineno">10286</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a>;</div><div class="line"><a name="l10287"></a><span class="lineno">10287</span>&#160;}</div><div class="line"><a name="l10288"></a><span class="lineno">10288</span>&#160;</div><div class="line"><a name="l10289"></a><span class="lineno">10289</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l10290"></a><span class="lineno">10290</span>&#160;<span class="comment"> * log_get_log_group_commit_interval () - setup flush daemon period based on system parameter</span></div><div class="line"><a name="l10291"></a><span class="lineno">10291</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l10292"></a><span class="lineno">10292</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l10293"></a><span class="lineno"><a class="line" href="log__manager_8c.html#aacd8f24932e99d45e955369e91d5d89b">10293</a></span>&#160;<a class="code" href="log__manager_8c.html#aacd8f24932e99d45e955369e91d5d89b">log_get_log_group_commit_interval</a> (<span class="keywordtype">bool</span> &amp; is_timed_wait, <a class="code" href="namespacecubthread.html#ab660224caa990a5ce9b3d65d5789ba46">cubthread::delta_time</a> &amp; period)</div><div class="line"><a name="l10294"></a><span class="lineno">10294</span>&#160;{</div><div class="line"><a name="l10295"></a><span class="lineno">10295</span>&#160;  is_timed_wait = <span class="keyword">true</span>;</div><div class="line"><a name="l10296"></a><span class="lineno">10296</span>&#160;</div><div class="line"><a name="l10297"></a><span class="lineno">10297</span>&#160;<span class="preprocessor">#if defined (SERVER_MODE)</span></div><div class="line"><a name="l10298"></a><span class="lineno">10298</span>&#160;  <span class="keywordflow">if</span> (log_Flush_has_been_requested)</div><div class="line"><a name="l10299"></a><span class="lineno">10299</span>&#160;    {</div><div class="line"><a name="l10300"></a><span class="lineno">10300</span>&#160;      period = std::chrono::milliseconds (0);</div><div class="line"><a name="l10301"></a><span class="lineno">10301</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l10302"></a><span class="lineno">10302</span>&#160;    }</div><div class="line"><a name="l10303"></a><span class="lineno">10303</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* SERVER_MODE */</span><span class="preprocessor"></span></div><div class="line"><a name="l10304"></a><span class="lineno">10304</span>&#160;</div><div class="line"><a name="l10305"></a><span class="lineno">10305</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> MAX_WAIT_TIME_MSEC = 1000;</div><div class="line"><a name="l10306"></a><span class="lineno">10306</span>&#160;  <span class="keywordtype">int</span> log_group_commit_interval_msec = <a class="code" href="system__parameter_8c.html#aae71e771e08cd2d0452c346650a8da98">prm_get_integer_value</a> (<a class="code" href="system__parameter_8h.html#a23aaf6bca406b9b428f43ad1b6b2b3e0a6326431b1c002fc13abce2674d2bd21f">PRM_ID_LOG_GROUP_COMMIT_INTERVAL_MSECS</a>);</div><div class="line"><a name="l10307"></a><span class="lineno">10307</span>&#160;</div><div class="line"><a name="l10308"></a><span class="lineno">10308</span>&#160;  <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (log_group_commit_interval_msec &gt;= 0);</div><div class="line"><a name="l10309"></a><span class="lineno">10309</span>&#160;</div><div class="line"><a name="l10310"></a><span class="lineno">10310</span>&#160;  <span class="keywordflow">if</span> (log_group_commit_interval_msec == 0)</div><div class="line"><a name="l10311"></a><span class="lineno">10311</span>&#160;    {</div><div class="line"><a name="l10312"></a><span class="lineno">10312</span>&#160;      period = std::chrono::milliseconds (MAX_WAIT_TIME_MSEC);</div><div class="line"><a name="l10313"></a><span class="lineno">10313</span>&#160;    }</div><div class="line"><a name="l10314"></a><span class="lineno">10314</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l10315"></a><span class="lineno">10315</span>&#160;    {</div><div class="line"><a name="l10316"></a><span class="lineno">10316</span>&#160;      period = std::chrono::milliseconds (log_group_commit_interval_msec);</div><div class="line"><a name="l10317"></a><span class="lineno">10317</span>&#160;    }</div><div class="line"><a name="l10318"></a><span class="lineno">10318</span>&#160;}</div><div class="line"><a name="l10319"></a><span class="lineno">10319</span>&#160;</div><div class="line"><a name="l10320"></a><span class="lineno">10320</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l10321"></a><span class="lineno">10321</span>&#160;<span class="comment"> * log_get_checkpoint_interval () - setup log checkpoint daemon period based on system parameter</span></div><div class="line"><a name="l10322"></a><span class="lineno">10322</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l10323"></a><span class="lineno">10323</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l10324"></a><span class="lineno"><a class="line" href="log__manager_8c.html#af75c618a8808a3cbda88f71cc7026ee1">10324</a></span>&#160;<a class="code" href="log__manager_8c.html#af75c618a8808a3cbda88f71cc7026ee1">log_get_checkpoint_interval</a> (<span class="keywordtype">bool</span> &amp; is_timed_wait, <a class="code" href="namespacecubthread.html#ab660224caa990a5ce9b3d65d5789ba46">cubthread::delta_time</a> &amp; period)</div><div class="line"><a name="l10325"></a><span class="lineno">10325</span>&#160;{</div><div class="line"><a name="l10326"></a><span class="lineno">10326</span>&#160;  <span class="keywordtype">int</span> log_checkpoint_interval_sec = <a class="code" href="system__parameter_8c.html#aae71e771e08cd2d0452c346650a8da98">prm_get_integer_value</a> (<a class="code" href="system__parameter_8h.html#a23aaf6bca406b9b428f43ad1b6b2b3e0a0c9cdfff95fcd3c77a8a8111f3d481cb">PRM_ID_LOG_CHECKPOINT_INTERVAL_SECS</a>);</div><div class="line"><a name="l10327"></a><span class="lineno">10327</span>&#160;</div><div class="line"><a name="l10328"></a><span class="lineno">10328</span>&#160;  <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (log_checkpoint_interval_sec &gt;= 0);</div><div class="line"><a name="l10329"></a><span class="lineno">10329</span>&#160;</div><div class="line"><a name="l10330"></a><span class="lineno">10330</span>&#160;  <span class="keywordflow">if</span> (log_checkpoint_interval_sec &gt; 0)</div><div class="line"><a name="l10331"></a><span class="lineno">10331</span>&#160;    {</div><div class="line"><a name="l10332"></a><span class="lineno">10332</span>&#160;      <span class="comment">// if log_checkpoint_interval_sec &gt; 0 (zero) then loop for fixed interval</span></div><div class="line"><a name="l10333"></a><span class="lineno">10333</span>&#160;      is_timed_wait = <span class="keyword">true</span>;</div><div class="line"><a name="l10334"></a><span class="lineno">10334</span>&#160;      period = std::chrono::seconds (log_checkpoint_interval_sec);</div><div class="line"><a name="l10335"></a><span class="lineno">10335</span>&#160;    }</div><div class="line"><a name="l10336"></a><span class="lineno">10336</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l10337"></a><span class="lineno">10337</span>&#160;    {</div><div class="line"><a name="l10338"></a><span class="lineno">10338</span>&#160;      <span class="comment">// infinite wait</span></div><div class="line"><a name="l10339"></a><span class="lineno">10339</span>&#160;      is_timed_wait = <span class="keyword">false</span>;</div><div class="line"><a name="l10340"></a><span class="lineno">10340</span>&#160;    }</div><div class="line"><a name="l10341"></a><span class="lineno">10341</span>&#160;}</div><div class="line"><a name="l10342"></a><span class="lineno">10342</span>&#160;</div><div class="line"><a name="l10343"></a><span class="lineno">10343</span>&#160;<span class="preprocessor">#if defined (SERVER_MODE)</span></div><div class="line"><a name="l10344"></a><span class="lineno">10344</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l10345"></a><span class="lineno">10345</span>&#160;<span class="comment"> * log_wakeup_remove_log_archive_daemon () - wakeup remove log archive daemon</span></div><div class="line"><a name="l10346"></a><span class="lineno">10346</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l10347"></a><span class="lineno">10347</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l10348"></a><span class="lineno">10348</span>&#160;<a class="code" href="log__manager_8h.html#a4452d47a1c11bd369f280162473c067e">log_wakeup_remove_log_archive_daemon</a> ()</div><div class="line"><a name="l10349"></a><span class="lineno">10349</span>&#160;{</div><div class="line"><a name="l10350"></a><span class="lineno">10350</span>&#160;  <span class="keywordflow">if</span> (log_Remove_log_archive_daemon)</div><div class="line"><a name="l10351"></a><span class="lineno">10351</span>&#160;    {</div><div class="line"><a name="l10352"></a><span class="lineno">10352</span>&#160;      log_Remove_log_archive_daemon-&gt;<a class="code" href="classcubthread_1_1daemon.html#a0c85191bbbfc161467c3bab4ea99c401">wakeup</a> ();</div><div class="line"><a name="l10353"></a><span class="lineno">10353</span>&#160;    }</div><div class="line"><a name="l10354"></a><span class="lineno">10354</span>&#160;}</div><div class="line"><a name="l10355"></a><span class="lineno">10355</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* SERVER_MODE */</span><span class="preprocessor"></span></div><div class="line"><a name="l10356"></a><span class="lineno">10356</span>&#160;</div><div class="line"><a name="l10357"></a><span class="lineno">10357</span>&#160;<span class="preprocessor">#if defined (SERVER_MODE)</span></div><div class="line"><a name="l10358"></a><span class="lineno">10358</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l10359"></a><span class="lineno">10359</span>&#160;<span class="comment"> * log_wakeup_checkpoint_daemon () - wakeup checkpoint daemon</span></div><div class="line"><a name="l10360"></a><span class="lineno">10360</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l10361"></a><span class="lineno">10361</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l10362"></a><span class="lineno">10362</span>&#160;<a class="code" href="log__manager_8h.html#a6160ad5bb57554497e3183a7d61b3598">log_wakeup_checkpoint_daemon</a> ()</div><div class="line"><a name="l10363"></a><span class="lineno">10363</span>&#160;{</div><div class="line"><a name="l10364"></a><span class="lineno">10364</span>&#160;  <span class="keywordflow">if</span> (log_Checkpoint_daemon)</div><div class="line"><a name="l10365"></a><span class="lineno">10365</span>&#160;    {</div><div class="line"><a name="l10366"></a><span class="lineno">10366</span>&#160;      log_Checkpoint_daemon-&gt;<a class="code" href="classcubthread_1_1daemon.html#a0c85191bbbfc161467c3bab4ea99c401">wakeup</a> ();</div><div class="line"><a name="l10367"></a><span class="lineno">10367</span>&#160;    }</div><div class="line"><a name="l10368"></a><span class="lineno">10368</span>&#160;}</div><div class="line"><a name="l10369"></a><span class="lineno">10369</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* SERVER_MODE */</span><span class="preprocessor"></span></div><div class="line"><a name="l10370"></a><span class="lineno">10370</span>&#160;</div><div class="line"><a name="l10371"></a><span class="lineno">10371</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l10372"></a><span class="lineno">10372</span>&#160;<span class="comment"> * log_wakeup_log_flush_daemon () - wakeup log flush daemon</span></div><div class="line"><a name="l10373"></a><span class="lineno">10373</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l10374"></a><span class="lineno">10374</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l10375"></a><span class="lineno"><a class="line" href="log__manager_8h.html#ad7d852d6547ead2335b5cc6ce6360ea0">10375</a></span>&#160;<a class="code" href="log__manager_8c.html#ad7d852d6547ead2335b5cc6ce6360ea0">log_wakeup_log_flush_daemon</a> ()</div><div class="line"><a name="l10376"></a><span class="lineno">10376</span>&#160;{</div><div class="line"><a name="l10377"></a><span class="lineno">10377</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="log__manager_8c.html#a4fc5a0d28e92e601bb3f8d8d53a8e29c">log_is_log_flush_daemon_available</a> ())</div><div class="line"><a name="l10378"></a><span class="lineno">10378</span>&#160;    {</div><div class="line"><a name="l10379"></a><span class="lineno">10379</span>&#160;<span class="preprocessor">#if defined (SERVER_MODE)</span></div><div class="line"><a name="l10380"></a><span class="lineno">10380</span>&#160;      log_Flush_has_been_requested = <span class="keyword">true</span>;</div><div class="line"><a name="l10381"></a><span class="lineno">10381</span>&#160;      log_Flush_daemon-&gt;<a class="code" href="classcubthread_1_1daemon.html#a0c85191bbbfc161467c3bab4ea99c401">wakeup</a> ();</div><div class="line"><a name="l10382"></a><span class="lineno">10382</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* SERVER_MODE */</span><span class="preprocessor"></span></div><div class="line"><a name="l10383"></a><span class="lineno">10383</span>&#160;    }</div><div class="line"><a name="l10384"></a><span class="lineno">10384</span>&#160;}</div><div class="line"><a name="l10385"></a><span class="lineno">10385</span>&#160;</div><div class="line"><a name="l10386"></a><span class="lineno">10386</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l10387"></a><span class="lineno">10387</span>&#160;<span class="comment"> * log_is_log_flush_daemon_available () - check if log flush daemon is available</span></div><div class="line"><a name="l10388"></a><span class="lineno">10388</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l10389"></a><span class="lineno">10389</span>&#160;<span class="keywordtype">bool</span></div><div class="line"><a name="l10390"></a><span class="lineno"><a class="line" href="log__manager_8h.html#a4fc5a0d28e92e601bb3f8d8d53a8e29c">10390</a></span>&#160;<a class="code" href="log__manager_8c.html#a4fc5a0d28e92e601bb3f8d8d53a8e29c">log_is_log_flush_daemon_available</a> ()</div><div class="line"><a name="l10391"></a><span class="lineno">10391</span>&#160;{</div><div class="line"><a name="l10392"></a><span class="lineno">10392</span>&#160;<span class="preprocessor">#if defined (SERVER_MODE)</span></div><div class="line"><a name="l10393"></a><span class="lineno">10393</span>&#160;  <span class="keywordflow">return</span> log_Flush_daemon != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>;</div><div class="line"><a name="l10394"></a><span class="lineno">10394</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l10395"></a><span class="lineno">10395</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l10396"></a><span class="lineno">10396</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l10397"></a><span class="lineno">10397</span>&#160;}</div><div class="line"><a name="l10398"></a><span class="lineno">10398</span>&#160;</div><div class="line"><a name="l10399"></a><span class="lineno">10399</span>&#160;<span class="preprocessor">#if defined (SERVER_MODE)</span></div><div class="line"><a name="l10400"></a><span class="lineno">10400</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l10401"></a><span class="lineno">10401</span>&#160;<span class="comment"> * log_flush_daemon_get_stats () - get log flush daemon thread statistics into statsp</span></div><div class="line"><a name="l10402"></a><span class="lineno">10402</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l10403"></a><span class="lineno">10403</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l10404"></a><span class="lineno">10404</span>&#160;log_flush_daemon_get_stats (UINT64 * statsp)</div><div class="line"><a name="l10405"></a><span class="lineno">10405</span>&#160;{</div><div class="line"><a name="l10406"></a><span class="lineno">10406</span>&#160;  <span class="keywordflow">if</span> (log_Flush_daemon != <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>)</div><div class="line"><a name="l10407"></a><span class="lineno">10407</span>&#160;    {</div><div class="line"><a name="l10408"></a><span class="lineno">10408</span>&#160;      log_Flush_daemon-&gt;<a class="code" href="classcubthread_1_1daemon.html#a2fc7761797afb57a0768080a89b07154">get_stats</a> (statsp);</div><div class="line"><a name="l10409"></a><span class="lineno">10409</span>&#160;    }</div><div class="line"><a name="l10410"></a><span class="lineno">10410</span>&#160;}</div><div class="line"><a name="l10411"></a><span class="lineno">10411</span>&#160;<span class="preprocessor">#endif // SERVER_MODE</span></div><div class="line"><a name="l10412"></a><span class="lineno">10412</span>&#160;</div><div class="line"><a name="l10413"></a><span class="lineno">10413</span>&#160;<span class="comment">// *INDENT-OFF*</span></div><div class="line"><a name="l10414"></a><span class="lineno">10414</span>&#160;<span class="preprocessor">#if defined(SERVER_MODE)</span></div><div class="line"><a name="l10415"></a><span class="lineno">10415</span>&#160;<span class="comment">// class log_checkpoint_daemon_task</span></div><div class="line"><a name="l10416"></a><span class="lineno">10416</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l10417"></a><span class="lineno">10417</span>&#160;<span class="comment">//  description:</span></div><div class="line"><a name="l10418"></a><span class="lineno">10418</span>&#160;<span class="comment">//    log checkpoint daemon task</span></div><div class="line"><a name="l10419"></a><span class="lineno">10419</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l10420"></a><span class="lineno">10420</span>&#160;<span class="keyword">class </span>log_checkpoint_daemon_task : <span class="keyword">public</span> <a class="code" href="classcubthread_1_1entry__task.html">cubthread::entry_task</a></div><div class="line"><a name="l10421"></a><span class="lineno">10421</span>&#160;{</div><div class="line"><a name="l10422"></a><span class="lineno">10422</span>&#160;  <span class="keyword">public</span>:</div><div class="line"><a name="l10423"></a><span class="lineno">10423</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classcubthread_1_1task.html#a623fd6821a2500a5827b609d76428ecd">execute</a> (<a class="code" href="classcubthread_1_1entry.html">cubthread::entry</a> &amp; thread_ref)<span class="keyword"> override</span></div><div class="line"><a name="l10424"></a><span class="lineno">10424</span>&#160;<span class="keyword">    </span>{</div><div class="line"><a name="l10425"></a><span class="lineno">10425</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="boot__sr_8h.html#a6a341e7f3388261fe3d7fe1f27d6400a">BO_IS_SERVER_RESTARTED</a> ())</div><div class="line"><a name="l10426"></a><span class="lineno">10426</span>&#160;    {</div><div class="line"><a name="l10427"></a><span class="lineno">10427</span>&#160;      <span class="comment">// wait for boot to finish</span></div><div class="line"><a name="l10428"></a><span class="lineno">10428</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l10429"></a><span class="lineno">10429</span>&#160;    }</div><div class="line"><a name="l10430"></a><span class="lineno">10430</span>&#160;</div><div class="line"><a name="l10431"></a><span class="lineno">10431</span>&#160;      <a class="code" href="log__impl_8h.html#a3afa13fd96a09f0686e865e34d4ba415">logpb_checkpoint</a> (&amp;thread_ref);</div><div class="line"><a name="l10432"></a><span class="lineno">10432</span>&#160;    }</div><div class="line"><a name="l10433"></a><span class="lineno">10433</span>&#160;};</div><div class="line"><a name="l10434"></a><span class="lineno">10434</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* SERVER_MODE */</span><span class="preprocessor"></span></div><div class="line"><a name="l10435"></a><span class="lineno">10435</span>&#160;</div><div class="line"><a name="l10436"></a><span class="lineno">10436</span>&#160;<span class="preprocessor">#if defined(SERVER_MODE)</span></div><div class="line"><a name="l10437"></a><span class="lineno">10437</span>&#160;<span class="comment">// class log_remove_log_archive_daemon_task</span></div><div class="line"><a name="l10438"></a><span class="lineno">10438</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l10439"></a><span class="lineno">10439</span>&#160;<span class="comment">//  description:</span></div><div class="line"><a name="l10440"></a><span class="lineno">10440</span>&#160;<span class="comment">//    remove archive logs daemon task</span></div><div class="line"><a name="l10441"></a><span class="lineno">10441</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l10442"></a><span class="lineno">10442</span>&#160;<span class="keyword">class </span>log_remove_log_archive_daemon_task : <span class="keyword">public</span> <a class="code" href="classcubthread_1_1entry__task.html">cubthread::entry_task</a></div><div class="line"><a name="l10443"></a><span class="lineno">10443</span>&#160;{</div><div class="line"><a name="l10444"></a><span class="lineno">10444</span>&#160;  <span class="keyword">private</span>:</div><div class="line"><a name="l10445"></a><span class="lineno">10445</span>&#160;    <span class="keyword">using</span> <a class="code" href="namespacecubperf.html#a9e08ee211bc3c0d0d0462ba274bf9f6b">clock</a> = std::chrono::system_clock;</div><div class="line"><a name="l10446"></a><span class="lineno">10446</span>&#160;</div><div class="line"><a name="l10447"></a><span class="lineno">10447</span>&#160;    <span class="keywordtype">bool</span> m_is_timed_wait;</div><div class="line"><a name="l10448"></a><span class="lineno">10448</span>&#160;    <a class="code" href="namespacecubthread.html#ab660224caa990a5ce9b3d65d5789ba46">cubthread::delta_time</a> m_period;</div><div class="line"><a name="l10449"></a><span class="lineno">10449</span>&#160;    std::chrono::milliseconds m_param_period;</div><div class="line"><a name="l10450"></a><span class="lineno">10450</span>&#160;    <a class="code" href="namespacecubperf.html#a9bd811041d330e1704e2b1ba756bed34">clock::time_point</a> m_log_deleted_time;</div><div class="line"><a name="l10451"></a><span class="lineno">10451</span>&#160;</div><div class="line"><a name="l10452"></a><span class="lineno">10452</span>&#160;    <span class="keywordtype">void</span> compute_period ()</div><div class="line"><a name="l10453"></a><span class="lineno">10453</span>&#160;    {</div><div class="line"><a name="l10454"></a><span class="lineno">10454</span>&#160;      <span class="comment">// fetch remove log archives interval</span></div><div class="line"><a name="l10455"></a><span class="lineno">10455</span>&#160;      <span class="keywordtype">int</span> remove_log_archives_interval_sec = <a class="code" href="system__parameter_8c.html#aae71e771e08cd2d0452c346650a8da98">prm_get_integer_value</a> (<a class="code" href="system__parameter_8h.html#a23aaf6bca406b9b428f43ad1b6b2b3e0a5dbc37ecf3f779e5b878d30ecc653b75">PRM_ID_REMOVE_LOG_ARCHIVES_INTERVAL</a>);</div><div class="line"><a name="l10456"></a><span class="lineno">10456</span>&#160;      <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (remove_log_archives_interval_sec &gt;= 0);</div><div class="line"><a name="l10457"></a><span class="lineno">10457</span>&#160;</div><div class="line"><a name="l10458"></a><span class="lineno">10458</span>&#160;      <span class="comment">// cache interval for later use</span></div><div class="line"><a name="l10459"></a><span class="lineno">10459</span>&#160;      m_param_period = std::chrono::milliseconds (remove_log_archives_interval_sec * 1000);</div><div class="line"><a name="l10460"></a><span class="lineno">10460</span>&#160;</div><div class="line"><a name="l10461"></a><span class="lineno">10461</span>&#160;      <span class="keywordflow">if</span> (m_param_period &gt; std::chrono::milliseconds (0))</div><div class="line"><a name="l10462"></a><span class="lineno">10462</span>&#160;    {</div><div class="line"><a name="l10463"></a><span class="lineno">10463</span>&#160;      m_is_timed_wait = <span class="keyword">true</span>;</div><div class="line"><a name="l10464"></a><span class="lineno">10464</span>&#160;      <a class="code" href="namespacecubperf.html#a9bd811041d330e1704e2b1ba756bed34">clock::time_point</a> now = clock::now ();</div><div class="line"><a name="l10465"></a><span class="lineno">10465</span>&#160;</div><div class="line"><a name="l10466"></a><span class="lineno">10466</span>&#160;      <span class="comment">// now - m_log_deleted_time: represents time elapsed since last log archive deletion</span></div><div class="line"><a name="l10467"></a><span class="lineno">10467</span>&#160;      <span class="keywordflow">if</span> ((now - m_log_deleted_time) &gt; m_param_period)</div><div class="line"><a name="l10468"></a><span class="lineno">10468</span>&#160;        {</div><div class="line"><a name="l10469"></a><span class="lineno">10469</span>&#160;          m_period = m_param_period;</div><div class="line"><a name="l10470"></a><span class="lineno">10470</span>&#160;        }</div><div class="line"><a name="l10471"></a><span class="lineno">10471</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l10472"></a><span class="lineno">10472</span>&#160;        {</div><div class="line"><a name="l10473"></a><span class="lineno">10473</span>&#160;          m_period = m_param_period - (now - m_log_deleted_time);</div><div class="line"><a name="l10474"></a><span class="lineno">10474</span>&#160;        }</div><div class="line"><a name="l10475"></a><span class="lineno">10475</span>&#160;    }</div><div class="line"><a name="l10476"></a><span class="lineno">10476</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l10477"></a><span class="lineno">10477</span>&#160;    {</div><div class="line"><a name="l10478"></a><span class="lineno">10478</span>&#160;      <span class="comment">// infinite wait</span></div><div class="line"><a name="l10479"></a><span class="lineno">10479</span>&#160;      m_is_timed_wait = <span class="keyword">false</span>;</div><div class="line"><a name="l10480"></a><span class="lineno">10480</span>&#160;    }</div><div class="line"><a name="l10481"></a><span class="lineno">10481</span>&#160;    }</div><div class="line"><a name="l10482"></a><span class="lineno">10482</span>&#160;</div><div class="line"><a name="l10483"></a><span class="lineno">10483</span>&#160;  <span class="keyword">public</span>:</div><div class="line"><a name="l10484"></a><span class="lineno">10484</span>&#160;    log_remove_log_archive_daemon_task ()</div><div class="line"><a name="l10485"></a><span class="lineno">10485</span>&#160;      : m_is_timed_wait (<a class="code" href="system_8h.html#a41f9c5fb8b08eb5dc3edce4dcb37fee7">true</a>)</div><div class="line"><a name="l10486"></a><span class="lineno">10486</span>&#160;      , m_period (0)</div><div class="line"><a name="l10487"></a><span class="lineno">10487</span>&#160;      , m_param_period (0)</div><div class="line"><a name="l10488"></a><span class="lineno">10488</span>&#160;      , m_log_deleted_time ()</div><div class="line"><a name="l10489"></a><span class="lineno">10489</span>&#160;    {</div><div class="line"><a name="l10490"></a><span class="lineno">10490</span>&#160;      <span class="comment">// initialize period</span></div><div class="line"><a name="l10491"></a><span class="lineno">10491</span>&#160;      compute_period ();</div><div class="line"><a name="l10492"></a><span class="lineno">10492</span>&#160;    }</div><div class="line"><a name="l10493"></a><span class="lineno">10493</span>&#160;</div><div class="line"><a name="l10494"></a><span class="lineno">10494</span>&#160;    <span class="keywordtype">void</span> get_remove_log_archives_interval (<span class="keywordtype">bool</span> &amp; is_timed_wait, <a class="code" href="namespacecubthread.html#ab660224caa990a5ce9b3d65d5789ba46">cubthread::delta_time</a> &amp; period)</div><div class="line"><a name="l10495"></a><span class="lineno">10495</span>&#160;    {</div><div class="line"><a name="l10496"></a><span class="lineno">10496</span>&#160;      period = m_period;</div><div class="line"><a name="l10497"></a><span class="lineno">10497</span>&#160;      is_timed_wait = m_is_timed_wait;</div><div class="line"><a name="l10498"></a><span class="lineno">10498</span>&#160;    }</div><div class="line"><a name="l10499"></a><span class="lineno">10499</span>&#160;</div><div class="line"><a name="l10500"></a><span class="lineno">10500</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classcubthread_1_1task.html#a623fd6821a2500a5827b609d76428ecd">execute</a> (<a class="code" href="classcubthread_1_1entry.html">cubthread::entry</a> &amp; thread_ref)<span class="keyword"> override</span></div><div class="line"><a name="l10501"></a><span class="lineno">10501</span>&#160;<span class="keyword">    </span>{</div><div class="line"><a name="l10502"></a><span class="lineno">10502</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="boot__sr_8h.html#a6a341e7f3388261fe3d7fe1f27d6400a">BO_IS_SERVER_RESTARTED</a> ())</div><div class="line"><a name="l10503"></a><span class="lineno">10503</span>&#160;    {</div><div class="line"><a name="l10504"></a><span class="lineno">10504</span>&#160;      <span class="comment">// wait for boot to finish</span></div><div class="line"><a name="l10505"></a><span class="lineno">10505</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l10506"></a><span class="lineno">10506</span>&#160;    }</div><div class="line"><a name="l10507"></a><span class="lineno">10507</span>&#160;</div><div class="line"><a name="l10508"></a><span class="lineno">10508</span>&#160;      <span class="comment">// compute wait period based on configured interval</span></div><div class="line"><a name="l10509"></a><span class="lineno">10509</span>&#160;      compute_period ();</div><div class="line"><a name="l10510"></a><span class="lineno">10510</span>&#160;</div><div class="line"><a name="l10511"></a><span class="lineno">10511</span>&#160;      <span class="keywordflow">if</span> (m_is_timed_wait)</div><div class="line"><a name="l10512"></a><span class="lineno">10512</span>&#160;    {</div><div class="line"><a name="l10513"></a><span class="lineno">10513</span>&#160;      <span class="keywordflow">if</span> (m_period != m_param_period)</div><div class="line"><a name="l10514"></a><span class="lineno">10514</span>&#160;        {</div><div class="line"><a name="l10515"></a><span class="lineno">10515</span>&#160;          <span class="comment">// do not delete logs. wait more time</span></div><div class="line"><a name="l10516"></a><span class="lineno">10516</span>&#160;          <span class="keywordflow">return</span>;</div><div class="line"><a name="l10517"></a><span class="lineno">10517</span>&#160;        }</div><div class="line"><a name="l10518"></a><span class="lineno">10518</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="log__impl_8h.html#a99e07d445f133a194b23cf7effd85c08">logpb_remove_archive_logs_exceed_limit</a> (&amp;thread_ref, 1) &gt; 0)</div><div class="line"><a name="l10519"></a><span class="lineno">10519</span>&#160;        {</div><div class="line"><a name="l10520"></a><span class="lineno">10520</span>&#160;          <span class="comment">// a log was deleted</span></div><div class="line"><a name="l10521"></a><span class="lineno">10521</span>&#160;          m_log_deleted_time = clock::now ();</div><div class="line"><a name="l10522"></a><span class="lineno">10522</span>&#160;        }</div><div class="line"><a name="l10523"></a><span class="lineno">10523</span>&#160;    }</div><div class="line"><a name="l10524"></a><span class="lineno">10524</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l10525"></a><span class="lineno">10525</span>&#160;    {</div><div class="line"><a name="l10526"></a><span class="lineno">10526</span>&#160;      <span class="comment">// remove all unnecessary logs</span></div><div class="line"><a name="l10527"></a><span class="lineno">10527</span>&#160;      <a class="code" href="log__impl_8h.html#a99e07d445f133a194b23cf7effd85c08">logpb_remove_archive_logs_exceed_limit</a> (&amp;thread_ref, 0);</div><div class="line"><a name="l10528"></a><span class="lineno">10528</span>&#160;    }</div><div class="line"><a name="l10529"></a><span class="lineno">10529</span>&#160;    }</div><div class="line"><a name="l10530"></a><span class="lineno">10530</span>&#160;};</div><div class="line"><a name="l10531"></a><span class="lineno">10531</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* SERVER_MODE */</span><span class="preprocessor"></span></div><div class="line"><a name="l10532"></a><span class="lineno">10532</span>&#160;</div><div class="line"><a name="l10533"></a><span class="lineno">10533</span>&#160;<span class="preprocessor">#if defined(SERVER_MODE)</span></div><div class="line"><a name="l10534"></a><span class="lineno">10534</span>&#160;<span class="comment">// class log_clock_daemon_task</span></div><div class="line"><a name="l10535"></a><span class="lineno">10535</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l10536"></a><span class="lineno">10536</span>&#160;<span class="comment">//  description:</span></div><div class="line"><a name="l10537"></a><span class="lineno">10537</span>&#160;<span class="comment">//    log clock daemon task</span></div><div class="line"><a name="l10538"></a><span class="lineno">10538</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l10539"></a><span class="lineno">10539</span>&#160;<span class="keyword">class </span>log_clock_daemon_task : <span class="keyword">public</span> <a class="code" href="classcubthread_1_1entry__task.html">cubthread::entry_task</a></div><div class="line"><a name="l10540"></a><span class="lineno">10540</span>&#160;{</div><div class="line"><a name="l10541"></a><span class="lineno">10541</span>&#160;  <span class="keyword">public</span>:</div><div class="line"><a name="l10542"></a><span class="lineno">10542</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classcubthread_1_1task.html#a623fd6821a2500a5827b609d76428ecd">execute</a> (<a class="code" href="classcubthread_1_1entry.html">cubthread::entry</a> &amp; thread_ref)<span class="keyword"> override</span></div><div class="line"><a name="l10543"></a><span class="lineno">10543</span>&#160;<span class="keyword">    </span>{</div><div class="line"><a name="l10544"></a><span class="lineno">10544</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="boot__sr_8h.html#a6a341e7f3388261fe3d7fe1f27d6400a">BO_IS_SERVER_RESTARTED</a> ())</div><div class="line"><a name="l10545"></a><span class="lineno">10545</span>&#160;    {</div><div class="line"><a name="l10546"></a><span class="lineno">10546</span>&#160;      <span class="comment">// wait for boot to finish</span></div><div class="line"><a name="l10547"></a><span class="lineno">10547</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l10548"></a><span class="lineno">10548</span>&#160;    }</div><div class="line"><a name="l10549"></a><span class="lineno">10549</span>&#160;</div><div class="line"><a name="l10550"></a><span class="lineno">10550</span>&#160;      <span class="keyword">struct </span>timeval now;</div><div class="line"><a name="l10551"></a><span class="lineno">10551</span>&#160;      gettimeofday (&amp;now, <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l10552"></a><span class="lineno">10552</span>&#160;</div><div class="line"><a name="l10553"></a><span class="lineno">10553</span>&#160;      log_Clock_msec = (now.tv_sec * 1000LL) + (now.tv_usec / 1000LL);</div><div class="line"><a name="l10554"></a><span class="lineno">10554</span>&#160;    }</div><div class="line"><a name="l10555"></a><span class="lineno">10555</span>&#160;};</div><div class="line"><a name="l10556"></a><span class="lineno">10556</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* SERVER_MODE */</span><span class="preprocessor"></span></div><div class="line"><a name="l10557"></a><span class="lineno">10557</span>&#160;</div><div class="line"><a name="l10558"></a><span class="lineno">10558</span>&#160;<span class="preprocessor">#if defined(SERVER_MODE)</span></div><div class="line"><a name="l10559"></a><span class="lineno">10559</span>&#160;<span class="comment">// class log_check_ha_delay_info_daemon_task</span></div><div class="line"><a name="l10560"></a><span class="lineno">10560</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l10561"></a><span class="lineno">10561</span>&#160;<span class="comment">//  description:</span></div><div class="line"><a name="l10562"></a><span class="lineno">10562</span>&#160;<span class="comment">//    log check ha delay info daemon_task</span></div><div class="line"><a name="l10563"></a><span class="lineno">10563</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l10564"></a><span class="lineno">10564</span>&#160;<span class="keyword">class </span>log_check_ha_delay_info_daemon_task : <span class="keyword">public</span> <a class="code" href="classcubthread_1_1entry__task.html">cubthread::entry_task</a></div><div class="line"><a name="l10565"></a><span class="lineno">10565</span>&#160;{</div><div class="line"><a name="l10566"></a><span class="lineno">10566</span>&#160;  <span class="keyword">public</span>:</div><div class="line"><a name="l10567"></a><span class="lineno">10567</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classcubthread_1_1task.html#a623fd6821a2500a5827b609d76428ecd">execute</a> (<a class="code" href="classcubthread_1_1entry.html">cubthread::entry</a> &amp;thread_ref)<span class="keyword"> override</span></div><div class="line"><a name="l10568"></a><span class="lineno">10568</span>&#160;<span class="keyword">    </span>{</div><div class="line"><a name="l10569"></a><span class="lineno">10569</span>&#160;<span class="preprocessor">#if defined(WINDOWS)</span></div><div class="line"><a name="l10570"></a><span class="lineno">10570</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l10571"></a><span class="lineno">10571</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* WINDOWS */</span><span class="preprocessor"></span></div><div class="line"><a name="l10572"></a><span class="lineno">10572</span>&#160;</div><div class="line"><a name="l10573"></a><span class="lineno">10573</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="boot__sr_8h.html#a6a341e7f3388261fe3d7fe1f27d6400a">BO_IS_SERVER_RESTARTED</a> ())</div><div class="line"><a name="l10574"></a><span class="lineno">10574</span>&#160;    {</div><div class="line"><a name="l10575"></a><span class="lineno">10575</span>&#160;      <span class="comment">// wait for boot to finish</span></div><div class="line"><a name="l10576"></a><span class="lineno">10576</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l10577"></a><span class="lineno">10577</span>&#160;    }</div><div class="line"><a name="l10578"></a><span class="lineno">10578</span>&#160;</div><div class="line"><a name="l10579"></a><span class="lineno">10579</span>&#160;      time_t log_record_time = 0;</div><div class="line"><a name="l10580"></a><span class="lineno">10580</span>&#160;      <span class="keywordtype">int</span> error_code;</div><div class="line"><a name="l10581"></a><span class="lineno">10581</span>&#160;      <span class="keywordtype">int</span> delay_limit_in_secs;</div><div class="line"><a name="l10582"></a><span class="lineno">10582</span>&#160;      <span class="keywordtype">int</span> acceptable_delay_in_secs;</div><div class="line"><a name="l10583"></a><span class="lineno">10583</span>&#160;      <span class="keywordtype">int</span> curr_delay_in_secs;</div><div class="line"><a name="l10584"></a><span class="lineno">10584</span>&#160;      <a class="code" href="boot_8h.html#a158badd371706f1de006dfdffbd19d45">HA_SERVER_STATE</a> server_state;</div><div class="line"><a name="l10585"></a><span class="lineno">10585</span>&#160;</div><div class="line"><a name="l10586"></a><span class="lineno">10586</span>&#160;      <a class="code" href="cnv_8c.html#a83e607dce0b97d9c195023d606869f5c">csect_enter</a> (&amp;thread_ref, <a class="code" href="critical__section_8h.html#aff3701dfcc246bf08b07f25a2cfd9e6dae9360d7901909430e42369cfccc3f917">CSECT_HA_SERVER_STATE</a>, <a class="code" href="critical__section_8h.html#af26f449e73437e60d22c20b4f2cb2aceaee0535cace8192b31b1edec6bd9df7ec">INF_WAIT</a>);</div><div class="line"><a name="l10587"></a><span class="lineno">10587</span>&#160;</div><div class="line"><a name="l10588"></a><span class="lineno">10588</span>&#160;      server_state = <a class="code" href="client__support_8c.html#a420baac2165c470d8a726a01a1329191">css_ha_server_state</a> ();</div><div class="line"><a name="l10589"></a><span class="lineno">10589</span>&#160;</div><div class="line"><a name="l10590"></a><span class="lineno">10590</span>&#160;      <span class="keywordflow">if</span> (server_state == <a class="code" href="boot_8h.html#aced830d72ca3bc3b775113c1d75a2368a32850340dc1da2b58e0909bccd11a898">HA_SERVER_STATE_ACTIVE</a> || server_state == <a class="code" href="boot_8h.html#aced830d72ca3bc3b775113c1d75a2368a44a4e81589baba558794ef7ad6b73882">HA_SERVER_STATE_TO_BE_STANDBY</a>)</div><div class="line"><a name="l10591"></a><span class="lineno">10591</span>&#160;    {</div><div class="line"><a name="l10592"></a><span class="lineno">10592</span>&#160;      <a class="code" href="server__support_8c.html#ad2a4945bd103012f30859c2cea405b2d">css_unset_ha_repl_delayed</a> ();</div><div class="line"><a name="l10593"></a><span class="lineno">10593</span>&#160;      <a class="code" href="perf__monitor_8h.html#aa0bde53ad8999e70db0c576af32db708">perfmon_set_stat</a> (&amp;thread_ref, <a class="code" href="perf__monitor_8h.html#a165b76d14ae9e30731ed3ca4cf856903afac5289ac60cb4ae52e4a75b7a30e92e">PSTAT_HA_REPL_DELAY</a>, 0, <span class="keyword">true</span>);</div><div class="line"><a name="l10594"></a><span class="lineno">10594</span>&#160;</div><div class="line"><a name="l10595"></a><span class="lineno">10595</span>&#160;      <a class="code" href="log__manager_8c.html#a7ef2b913287067a2beccb363958ee1ae">log_append_ha_server_state</a> (&amp;thread_ref, server_state);</div><div class="line"><a name="l10596"></a><span class="lineno">10596</span>&#160;</div><div class="line"><a name="l10597"></a><span class="lineno">10597</span>&#160;      <a class="code" href="cnv_8c.html#a91e93d72d68bf73e79c405c05e64a5fa">csect_exit</a> (&amp;thread_ref, <a class="code" href="critical__section_8h.html#aff3701dfcc246bf08b07f25a2cfd9e6dae9360d7901909430e42369cfccc3f917">CSECT_HA_SERVER_STATE</a>);</div><div class="line"><a name="l10598"></a><span class="lineno">10598</span>&#160;    }</div><div class="line"><a name="l10599"></a><span class="lineno">10599</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l10600"></a><span class="lineno">10600</span>&#160;    {</div><div class="line"><a name="l10601"></a><span class="lineno">10601</span>&#160;      <a class="code" href="cnv_8c.html#a91e93d72d68bf73e79c405c05e64a5fa">csect_exit</a> (&amp;thread_ref, <a class="code" href="critical__section_8h.html#aff3701dfcc246bf08b07f25a2cfd9e6dae9360d7901909430e42369cfccc3f917">CSECT_HA_SERVER_STATE</a>);</div><div class="line"><a name="l10602"></a><span class="lineno">10602</span>&#160;</div><div class="line"><a name="l10603"></a><span class="lineno">10603</span>&#160;      delay_limit_in_secs = <a class="code" href="system__parameter_8c.html#aae71e771e08cd2d0452c346650a8da98">prm_get_integer_value</a> (<a class="code" href="system__parameter_8h.html#a23aaf6bca406b9b428f43ad1b6b2b3e0a4ba9cca314203d2604689ba87896362d">PRM_ID_HA_DELAY_LIMIT_IN_SECS</a>);</div><div class="line"><a name="l10604"></a><span class="lineno">10604</span>&#160;      acceptable_delay_in_secs = delay_limit_in_secs - <a class="code" href="system__parameter_8c.html#aae71e771e08cd2d0452c346650a8da98">prm_get_integer_value</a> (<a class="code" href="system__parameter_8h.html#a23aaf6bca406b9b428f43ad1b6b2b3e0ae5c58bb4945f78cf1cf89a340013009a">PRM_ID_HA_DELAY_LIMIT_DELTA_IN_SECS</a>);</div><div class="line"><a name="l10605"></a><span class="lineno">10605</span>&#160;</div><div class="line"><a name="l10606"></a><span class="lineno">10606</span>&#160;      <span class="keywordflow">if</span> (acceptable_delay_in_secs &lt; 0)</div><div class="line"><a name="l10607"></a><span class="lineno">10607</span>&#160;        {</div><div class="line"><a name="l10608"></a><span class="lineno">10608</span>&#160;          acceptable_delay_in_secs = 0;</div><div class="line"><a name="l10609"></a><span class="lineno">10609</span>&#160;        }</div><div class="line"><a name="l10610"></a><span class="lineno">10610</span>&#160;</div><div class="line"><a name="l10611"></a><span class="lineno">10611</span>&#160;      error_code = <a class="code" href="catalog__class_8c.html#ae5a7d7ee65169187ff2edadd52509381">catcls_get_apply_info_log_record_time</a> (&amp;thread_ref, &amp;log_record_time);</div><div class="line"><a name="l10612"></a><span class="lineno">10612</span>&#160;</div><div class="line"><a name="l10613"></a><span class="lineno">10613</span>&#160;      <span class="keywordflow">if</span> (error_code == <a class="code" href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a> &amp;&amp; log_record_time &gt; 0)</div><div class="line"><a name="l10614"></a><span class="lineno">10614</span>&#160;        {</div><div class="line"><a name="l10615"></a><span class="lineno">10615</span>&#160;          curr_delay_in_secs = (<a class="code" href="mprec_8c.html#a61569f2965b7a369eb10b6d75d410d11">int</a>) (<a class="code" href="namespacebrokerstatus__to__csv.html#ae075d9642cd7485bc938b7d65b2e6991">time</a> (<a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) - log_record_time);</div><div class="line"><a name="l10616"></a><span class="lineno">10616</span>&#160;          <span class="keywordflow">if</span> (curr_delay_in_secs &gt; 0)</div><div class="line"><a name="l10617"></a><span class="lineno">10617</span>&#160;        {</div><div class="line"><a name="l10618"></a><span class="lineno">10618</span>&#160;          curr_delay_in_secs -= <a class="code" href="connection__defs_8h.html#af25c1168c04e2af339cd1466d541701e">HA_DELAY_ERR_CORRECTION</a>;</div><div class="line"><a name="l10619"></a><span class="lineno">10619</span>&#160;        }</div><div class="line"><a name="l10620"></a><span class="lineno">10620</span>&#160;</div><div class="line"><a name="l10621"></a><span class="lineno">10621</span>&#160;          <span class="keywordflow">if</span> (delay_limit_in_secs &gt; 0)</div><div class="line"><a name="l10622"></a><span class="lineno">10622</span>&#160;        {</div><div class="line"><a name="l10623"></a><span class="lineno">10623</span>&#160;          <span class="keywordflow">if</span> (curr_delay_in_secs &gt; delay_limit_in_secs)</div><div class="line"><a name="l10624"></a><span class="lineno">10624</span>&#160;            {</div><div class="line"><a name="l10625"></a><span class="lineno">10625</span>&#160;              <span class="keywordflow">if</span> (!<a class="code" href="server__support_8c.html#a71d9ec1aba80346f187f67b53b9af03b">css_is_ha_repl_delayed</a> ())</div><div class="line"><a name="l10626"></a><span class="lineno">10626</span>&#160;            {</div><div class="line"><a name="l10627"></a><span class="lineno">10627</span>&#160;              <a class="code" href="error__manager_8c.html#afdaf87ce30f2f557802a185ab85b6599">er_set</a> (<a class="code" href="error__manager_8h.html#a5d0d456c474e11fc70779873a30a7432af9c76cd8146aafca7fb58dabd599e41b">ER_NOTIFICATION_SEVERITY</a>, <a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <a class="code" href="error__code_8h.html#a9734d930fa5948c8b0c1c9170e67c809">ER_HA_REPL_DELAY_DETECTED</a>, 2,</div><div class="line"><a name="l10628"></a><span class="lineno">10628</span>&#160;                  curr_delay_in_secs, delay_limit_in_secs);</div><div class="line"><a name="l10629"></a><span class="lineno">10629</span>&#160;</div><div class="line"><a name="l10630"></a><span class="lineno">10630</span>&#160;              <a class="code" href="server__support_8c.html#a932bc1609226fd2ee2a4103755c553a7">css_set_ha_repl_delayed</a> ();</div><div class="line"><a name="l10631"></a><span class="lineno">10631</span>&#160;            }</div><div class="line"><a name="l10632"></a><span class="lineno">10632</span>&#160;            }</div><div class="line"><a name="l10633"></a><span class="lineno">10633</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (curr_delay_in_secs &lt;= acceptable_delay_in_secs)</div><div class="line"><a name="l10634"></a><span class="lineno">10634</span>&#160;            {</div><div class="line"><a name="l10635"></a><span class="lineno">10635</span>&#160;              <span class="keywordflow">if</span> (<a class="code" href="server__support_8c.html#a71d9ec1aba80346f187f67b53b9af03b">css_is_ha_repl_delayed</a> ())</div><div class="line"><a name="l10636"></a><span class="lineno">10636</span>&#160;            {</div><div class="line"><a name="l10637"></a><span class="lineno">10637</span>&#160;              <a class="code" href="error__manager_8c.html#afdaf87ce30f2f557802a185ab85b6599">er_set</a> (<a class="code" href="error__manager_8h.html#a5d0d456c474e11fc70779873a30a7432af9c76cd8146aafca7fb58dabd599e41b">ER_NOTIFICATION_SEVERITY</a>, <a class="code" href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a>, <a class="code" href="error__code_8h.html#a03134a0c4a1f76b2046a4870ba21993d">ER_HA_REPL_DELAY_RESOLVED</a>, 2,</div><div class="line"><a name="l10638"></a><span class="lineno">10638</span>&#160;                  curr_delay_in_secs, acceptable_delay_in_secs);</div><div class="line"><a name="l10639"></a><span class="lineno">10639</span>&#160;</div><div class="line"><a name="l10640"></a><span class="lineno">10640</span>&#160;              <a class="code" href="server__support_8c.html#ad2a4945bd103012f30859c2cea405b2d">css_unset_ha_repl_delayed</a> ();</div><div class="line"><a name="l10641"></a><span class="lineno">10641</span>&#160;            }</div><div class="line"><a name="l10642"></a><span class="lineno">10642</span>&#160;            }</div><div class="line"><a name="l10643"></a><span class="lineno">10643</span>&#160;        }</div><div class="line"><a name="l10644"></a><span class="lineno">10644</span>&#160;</div><div class="line"><a name="l10645"></a><span class="lineno">10645</span>&#160;          <a class="code" href="perf__monitor_8h.html#aa0bde53ad8999e70db0c576af32db708">perfmon_set_stat</a> (&amp;thread_ref, <a class="code" href="perf__monitor_8h.html#a165b76d14ae9e30731ed3ca4cf856903afac5289ac60cb4ae52e4a75b7a30e92e">PSTAT_HA_REPL_DELAY</a>, curr_delay_in_secs, <span class="keyword">true</span>);</div><div class="line"><a name="l10646"></a><span class="lineno">10646</span>&#160;        }</div><div class="line"><a name="l10647"></a><span class="lineno">10647</span>&#160;    }</div><div class="line"><a name="l10648"></a><span class="lineno">10648</span>&#160;    }</div><div class="line"><a name="l10649"></a><span class="lineno">10649</span>&#160;};</div><div class="line"><a name="l10650"></a><span class="lineno">10650</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* SERVER_MODE */</span><span class="preprocessor"></span></div><div class="line"><a name="l10651"></a><span class="lineno">10651</span>&#160;</div><div class="line"><a name="l10652"></a><span class="lineno">10652</span>&#160;<span class="preprocessor">#if defined (SERVER_MODE)</span></div><div class="line"><a name="l10653"></a><span class="lineno">10653</span>&#160;<span class="comment">// class log_flush_daemon_task</span></div><div class="line"><a name="l10654"></a><span class="lineno">10654</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l10655"></a><span class="lineno">10655</span>&#160;<span class="comment">//  description:</span></div><div class="line"><a name="l10656"></a><span class="lineno">10656</span>&#160;<span class="comment">//    log flush daemon task</span></div><div class="line"><a name="l10657"></a><span class="lineno">10657</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l10658"></a><span class="lineno">10658</span>&#160;<span class="keyword">class </span>log_flush_daemon_task : <span class="keyword">public</span> <a class="code" href="classcubthread_1_1entry__task.html">cubthread::entry_task</a></div><div class="line"><a name="l10659"></a><span class="lineno">10659</span>&#160;{</div><div class="line"><a name="l10660"></a><span class="lineno">10660</span>&#160;  <span class="keyword">public</span>:</div><div class="line"><a name="l10661"></a><span class="lineno">10661</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classcubthread_1_1task.html#a623fd6821a2500a5827b609d76428ecd">execute</a> (<a class="code" href="classcubthread_1_1entry.html">cubthread::entry</a> &amp; thread_ref)<span class="keyword"> override</span></div><div class="line"><a name="l10662"></a><span class="lineno">10662</span>&#160;<span class="keyword">    </span>{</div><div class="line"><a name="l10663"></a><span class="lineno">10663</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="boot__sr_8h.html#a6a341e7f3388261fe3d7fe1f27d6400a">BO_IS_SERVER_RESTARTED</a> () || !log_Flush_has_been_requested)</div><div class="line"><a name="l10664"></a><span class="lineno">10664</span>&#160;    {</div><div class="line"><a name="l10665"></a><span class="lineno">10665</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l10666"></a><span class="lineno">10666</span>&#160;    }</div><div class="line"><a name="l10667"></a><span class="lineno">10667</span>&#160;</div><div class="line"><a name="l10668"></a><span class="lineno">10668</span>&#160;      <span class="comment">// refresh log trace flush time</span></div><div class="line"><a name="l10669"></a><span class="lineno">10669</span>&#160;      thread_ref.<a class="code" href="classcubthread_1_1entry.html#a0d1763b36869fd274154c4ae5ef9d2c0">event_stats</a>.<a class="code" href="structevent__stat.html#aca6622b3b2d7a83cba5b846d4eb3d5b5">trace_log_flush_time</a> = <a class="code" href="system__parameter_8c.html#aae71e771e08cd2d0452c346650a8da98">prm_get_integer_value</a> (<a class="code" href="system__parameter_8h.html#a23aaf6bca406b9b428f43ad1b6b2b3e0a8e25487e08db74e58fe85b48e2bd9771">PRM_ID_LOG_TRACE_FLUSH_TIME_MSECS</a>);</div><div class="line"><a name="l10670"></a><span class="lineno">10670</span>&#160;</div><div class="line"><a name="l10671"></a><span class="lineno">10671</span>&#160;      <a class="code" href="log__impl_8h.html#a5561d6b89dce60cfa780062fae1bb473">LOG_CS_ENTER</a> (&amp;thread_ref);</div><div class="line"><a name="l10672"></a><span class="lineno">10672</span>&#160;      <a class="code" href="log__impl_8h.html#ab5c84aff4d15372a2d150897ad6d2b80">logpb_flush_pages_direct</a> (&amp;thread_ref);</div><div class="line"><a name="l10673"></a><span class="lineno">10673</span>&#160;      <a class="code" href="log__impl_8h.html#a6a5f95ded1a2f38ed00c8e9c039a9f2e">LOG_CS_EXIT</a> (&amp;thread_ref);</div><div class="line"><a name="l10674"></a><span class="lineno">10674</span>&#160;</div><div class="line"><a name="l10675"></a><span class="lineno">10675</span>&#160;      <a class="code" href="log__impl_8h.html#af18a3c0b2ebcb342344e71db70c4f1c1">log_Stat</a>.<a class="code" href="structlog__logging__stat.html#a294ade121e65833ef710019a304c4288">gc_flush_count</a>++;</div><div class="line"><a name="l10676"></a><span class="lineno">10676</span>&#160;</div><div class="line"><a name="l10677"></a><span class="lineno">10677</span>&#160;      <a class="code" href="log__manager_8c.html#a3bd1ad5edf8fc93f783af77e8cd6ee9a">pthread_mutex_lock</a> (&amp;<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1d49125845fa987161f4724c69317403">group_commit_info</a>.<a class="code" href="structlog__group__commit__info.html#a5a6ab6aa5a763c49b53d1cde4621df7a">gc_mutex</a>);</div><div class="line"><a name="l10678"></a><span class="lineno">10678</span>&#160;      pthread_cond_broadcast (&amp;<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1d49125845fa987161f4724c69317403">group_commit_info</a>.<a class="code" href="structlog__group__commit__info.html#ab3b1d1fcf98e9d21ad8539ac227da927">gc_cond</a>);</div><div class="line"><a name="l10679"></a><span class="lineno">10679</span>&#160;      log_Flush_has_been_requested = <span class="keyword">false</span>;</div><div class="line"><a name="l10680"></a><span class="lineno">10680</span>&#160;      <a class="code" href="log__manager_8c.html#aa91b7ec8ae8a2d699fb09cc20c444fe8">pthread_mutex_unlock</a> (&amp;<a class="code" href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a>.<a class="code" href="structlog__global.html#a1d49125845fa987161f4724c69317403">group_commit_info</a>.<a class="code" href="structlog__group__commit__info.html#a5a6ab6aa5a763c49b53d1cde4621df7a">gc_mutex</a>);</div><div class="line"><a name="l10681"></a><span class="lineno">10681</span>&#160;    }</div><div class="line"><a name="l10682"></a><span class="lineno">10682</span>&#160;};</div><div class="line"><a name="l10683"></a><span class="lineno">10683</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* SERVER_MODE */</span><span class="preprocessor"></span></div><div class="line"><a name="l10684"></a><span class="lineno">10684</span>&#160;</div><div class="line"><a name="l10685"></a><span class="lineno">10685</span>&#160;<span class="preprocessor">#if defined(SERVER_MODE)</span></div><div class="line"><a name="l10686"></a><span class="lineno">10686</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l10687"></a><span class="lineno">10687</span>&#160;<span class="comment"> * log_checkpoint_daemon_init () - initialize checkpoint daemon</span></div><div class="line"><a name="l10688"></a><span class="lineno">10688</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l10689"></a><span class="lineno">10689</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l10690"></a><span class="lineno">10690</span>&#160;log_checkpoint_daemon_init ()</div><div class="line"><a name="l10691"></a><span class="lineno">10691</span>&#160;{</div><div class="line"><a name="l10692"></a><span class="lineno">10692</span>&#160;  <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (log_Checkpoint_daemon == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l10693"></a><span class="lineno">10693</span>&#160;</div><div class="line"><a name="l10694"></a><span class="lineno">10694</span>&#160;  <a class="code" href="classcubthread_1_1looper.html">cubthread::looper</a> looper = <a class="code" href="classcubthread_1_1looper.html">cubthread::looper</a> (<a class="code" href="log__manager_8c.html#af75c618a8808a3cbda88f71cc7026ee1">log_get_checkpoint_interval</a>);</div><div class="line"><a name="l10695"></a><span class="lineno">10695</span>&#160;  log_checkpoint_daemon_task *daemon_task = <span class="keyword">new</span> log_checkpoint_daemon_task ();</div><div class="line"><a name="l10696"></a><span class="lineno">10696</span>&#160;</div><div class="line"><a name="l10697"></a><span class="lineno">10697</span>&#160;  <span class="comment">// create checkpoint daemon thread</span></div><div class="line"><a name="l10698"></a><span class="lineno">10698</span>&#160;  log_Checkpoint_daemon = <a class="code" href="namespacecubthread.html#a0b0f629740d5037917c1773030847800">cubthread::get_manager</a> ()-&gt;<a class="code" href="classcubthread_1_1manager.html#ae0175b93cea685c1f35e1c7730df1f01">create_daemon</a> (looper, daemon_task, <span class="stringliteral">&quot;log_checkpoint&quot;</span>);</div><div class="line"><a name="l10699"></a><span class="lineno">10699</span>&#160;}</div><div class="line"><a name="l10700"></a><span class="lineno">10700</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* SERVER_MODE */</span><span class="preprocessor"></span></div><div class="line"><a name="l10701"></a><span class="lineno">10701</span>&#160;</div><div class="line"><a name="l10702"></a><span class="lineno">10702</span>&#160;<span class="preprocessor">#if defined(SERVER_MODE)</span></div><div class="line"><a name="l10703"></a><span class="lineno">10703</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l10704"></a><span class="lineno">10704</span>&#160;<span class="comment"> * log_remove_log_archive_daemon_init () - initialize remove log archive daemon</span></div><div class="line"><a name="l10705"></a><span class="lineno">10705</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l10706"></a><span class="lineno">10706</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l10707"></a><span class="lineno">10707</span>&#160;log_remove_log_archive_daemon_init ()</div><div class="line"><a name="l10708"></a><span class="lineno">10708</span>&#160;{</div><div class="line"><a name="l10709"></a><span class="lineno">10709</span>&#160;  <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (log_Remove_log_archive_daemon == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l10710"></a><span class="lineno">10710</span>&#160;</div><div class="line"><a name="l10711"></a><span class="lineno">10711</span>&#160;  log_remove_log_archive_daemon_task *daemon_task = <span class="keyword">new</span> log_remove_log_archive_daemon_task ();</div><div class="line"><a name="l10712"></a><span class="lineno">10712</span>&#160;  <a class="code" href="namespacecubthread.html#a55c08a869cb69385e8c7351668caeffa">cubthread::period_function</a> setup_period_function = std::bind (</div><div class="line"><a name="l10713"></a><span class="lineno">10713</span>&#160;      &amp;log_remove_log_archive_daemon_task::get_remove_log_archives_interval,</div><div class="line"><a name="l10714"></a><span class="lineno">10714</span>&#160;      daemon_task,</div><div class="line"><a name="l10715"></a><span class="lineno">10715</span>&#160;      std::placeholders::_1,</div><div class="line"><a name="l10716"></a><span class="lineno">10716</span>&#160;      std::placeholders::_2);</div><div class="line"><a name="l10717"></a><span class="lineno">10717</span>&#160;</div><div class="line"><a name="l10718"></a><span class="lineno">10718</span>&#160;  <a class="code" href="classcubthread_1_1looper.html">cubthread::looper</a> looper = <a class="code" href="classcubthread_1_1looper.html">cubthread::looper</a> (setup_period_function);</div><div class="line"><a name="l10719"></a><span class="lineno">10719</span>&#160;</div><div class="line"><a name="l10720"></a><span class="lineno">10720</span>&#160;  <span class="comment">// create log archive remover daemon thread</span></div><div class="line"><a name="l10721"></a><span class="lineno">10721</span>&#160;  log_Remove_log_archive_daemon = <a class="code" href="namespacecubthread.html#a0b0f629740d5037917c1773030847800">cubthread::get_manager</a> ()-&gt;<a class="code" href="classcubthread_1_1manager.html#ae0175b93cea685c1f35e1c7730df1f01">create_daemon</a> (looper, daemon_task,</div><div class="line"><a name="l10722"></a><span class="lineno">10722</span>&#160;                                                                            <span class="stringliteral">&quot;log_remove_log_archive&quot;</span>);</div><div class="line"><a name="l10723"></a><span class="lineno">10723</span>&#160;}</div><div class="line"><a name="l10724"></a><span class="lineno">10724</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* SERVER_MODE */</span><span class="preprocessor"></span></div><div class="line"><a name="l10725"></a><span class="lineno">10725</span>&#160;</div><div class="line"><a name="l10726"></a><span class="lineno">10726</span>&#160;<span class="preprocessor">#if defined(SERVER_MODE)</span></div><div class="line"><a name="l10727"></a><span class="lineno">10727</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l10728"></a><span class="lineno">10728</span>&#160;<span class="comment"> * log_clock_daemon_init () - initialize log clock daemon</span></div><div class="line"><a name="l10729"></a><span class="lineno">10729</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l10730"></a><span class="lineno">10730</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l10731"></a><span class="lineno">10731</span>&#160;log_clock_daemon_init ()</div><div class="line"><a name="l10732"></a><span class="lineno">10732</span>&#160;{</div><div class="line"><a name="l10733"></a><span class="lineno">10733</span>&#160;  <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (log_Clock_daemon == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l10734"></a><span class="lineno">10734</span>&#160;</div><div class="line"><a name="l10735"></a><span class="lineno">10735</span>&#160;  <a class="code" href="classcubthread_1_1looper.html">cubthread::looper</a> looper = <a class="code" href="classcubthread_1_1looper.html">cubthread::looper</a> (std::chrono::milliseconds (200));</div><div class="line"><a name="l10736"></a><span class="lineno">10736</span>&#160;  log_Clock_daemon = <a class="code" href="namespacecubthread.html#a0b0f629740d5037917c1773030847800">cubthread::get_manager</a> ()-&gt;<a class="code" href="classcubthread_1_1manager.html#ae0175b93cea685c1f35e1c7730df1f01">create_daemon</a> (looper, <span class="keyword">new</span> log_clock_daemon_task (), <span class="stringliteral">&quot;log_clock&quot;</span>);</div><div class="line"><a name="l10737"></a><span class="lineno">10737</span>&#160;}</div><div class="line"><a name="l10738"></a><span class="lineno">10738</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* SERVER_MODE */</span><span class="preprocessor"></span></div><div class="line"><a name="l10739"></a><span class="lineno">10739</span>&#160;</div><div class="line"><a name="l10740"></a><span class="lineno">10740</span>&#160;<span class="preprocessor">#if defined(SERVER_MODE)</span></div><div class="line"><a name="l10741"></a><span class="lineno">10741</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l10742"></a><span class="lineno">10742</span>&#160;<span class="comment"> * log_check_ha_delay_info_daemon_init () - initialize check ha delay info daemon</span></div><div class="line"><a name="l10743"></a><span class="lineno">10743</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l10744"></a><span class="lineno">10744</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l10745"></a><span class="lineno">10745</span>&#160;log_check_ha_delay_info_daemon_init ()</div><div class="line"><a name="l10746"></a><span class="lineno">10746</span>&#160;{</div><div class="line"><a name="l10747"></a><span class="lineno">10747</span>&#160;  <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (log_Check_ha_delay_info_daemon == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l10748"></a><span class="lineno">10748</span>&#160;</div><div class="line"><a name="l10749"></a><span class="lineno">10749</span>&#160;  <a class="code" href="classcubthread_1_1looper.html">cubthread::looper</a> looper = <a class="code" href="classcubthread_1_1looper.html">cubthread::looper</a> (std::chrono::seconds (1));</div><div class="line"><a name="l10750"></a><span class="lineno">10750</span>&#160;  log_check_ha_delay_info_daemon_task *daemon_task = <span class="keyword">new</span> log_check_ha_delay_info_daemon_task ();</div><div class="line"><a name="l10751"></a><span class="lineno">10751</span>&#160;</div><div class="line"><a name="l10752"></a><span class="lineno">10752</span>&#160;  log_Check_ha_delay_info_daemon = <a class="code" href="namespacecubthread.html#a0b0f629740d5037917c1773030847800">cubthread::get_manager</a> ()-&gt;<a class="code" href="classcubthread_1_1manager.html#ae0175b93cea685c1f35e1c7730df1f01">create_daemon</a> (looper, daemon_task,</div><div class="line"><a name="l10753"></a><span class="lineno">10753</span>&#160;                                                                             <span class="stringliteral">&quot;log_check_ha_delay_info&quot;</span>);</div><div class="line"><a name="l10754"></a><span class="lineno">10754</span>&#160;}</div><div class="line"><a name="l10755"></a><span class="lineno">10755</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* SERVER_MODE */</span><span class="preprocessor"></span></div><div class="line"><a name="l10756"></a><span class="lineno">10756</span>&#160;</div><div class="line"><a name="l10757"></a><span class="lineno">10757</span>&#160;<span class="preprocessor">#if defined(SERVER_MODE)</span></div><div class="line"><a name="l10758"></a><span class="lineno">10758</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l10759"></a><span class="lineno">10759</span>&#160;<span class="comment"> * log_flush_daemon_init () - initialize log flush daemon</span></div><div class="line"><a name="l10760"></a><span class="lineno">10760</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l10761"></a><span class="lineno">10761</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l10762"></a><span class="lineno">10762</span>&#160;log_flush_daemon_init ()</div><div class="line"><a name="l10763"></a><span class="lineno">10763</span>&#160;{</div><div class="line"><a name="l10764"></a><span class="lineno">10764</span>&#160;  <a class="code" href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a> (log_Flush_daemon == <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l10765"></a><span class="lineno">10765</span>&#160;</div><div class="line"><a name="l10766"></a><span class="lineno">10766</span>&#160;  <a class="code" href="classcubthread_1_1looper.html">cubthread::looper</a> looper = <a class="code" href="classcubthread_1_1looper.html">cubthread::looper</a> (<a class="code" href="log__manager_8c.html#aacd8f24932e99d45e955369e91d5d89b">log_get_log_group_commit_interval</a>);</div><div class="line"><a name="l10767"></a><span class="lineno">10767</span>&#160;  log_flush_daemon_task *daemon_task = <span class="keyword">new</span> log_flush_daemon_task ();</div><div class="line"><a name="l10768"></a><span class="lineno">10768</span>&#160;</div><div class="line"><a name="l10769"></a><span class="lineno">10769</span>&#160;  log_Flush_daemon = <a class="code" href="namespacecubthread.html#a0b0f629740d5037917c1773030847800">cubthread::get_manager</a> ()-&gt;<a class="code" href="classcubthread_1_1manager.html#ae0175b93cea685c1f35e1c7730df1f01">create_daemon</a> (looper, daemon_task, <span class="stringliteral">&quot;log_flush&quot;</span>);</div><div class="line"><a name="l10770"></a><span class="lineno">10770</span>&#160;}</div><div class="line"><a name="l10771"></a><span class="lineno">10771</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* SERVER_MODE */</span><span class="preprocessor"></span></div><div class="line"><a name="l10772"></a><span class="lineno">10772</span>&#160;</div><div class="line"><a name="l10773"></a><span class="lineno">10773</span>&#160;<span class="preprocessor">#if defined(SERVER_MODE)</span></div><div class="line"><a name="l10774"></a><span class="lineno">10774</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l10775"></a><span class="lineno">10775</span>&#160;<span class="comment"> * log_daemons_init () - initialize daemon threads</span></div><div class="line"><a name="l10776"></a><span class="lineno">10776</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l10777"></a><span class="lineno">10777</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div><div class="line"><a name="l10778"></a><span class="lineno">10778</span>&#160;log_daemons_init ()</div><div class="line"><a name="l10779"></a><span class="lineno">10779</span>&#160;{</div><div class="line"><a name="l10780"></a><span class="lineno">10780</span>&#160;  log_remove_log_archive_daemon_init ();</div><div class="line"><a name="l10781"></a><span class="lineno">10781</span>&#160;  log_checkpoint_daemon_init ();</div><div class="line"><a name="l10782"></a><span class="lineno">10782</span>&#160;  log_check_ha_delay_info_daemon_init ();</div><div class="line"><a name="l10783"></a><span class="lineno">10783</span>&#160;  log_clock_daemon_init ();</div><div class="line"><a name="l10784"></a><span class="lineno">10784</span>&#160;  log_flush_daemon_init ();</div><div class="line"><a name="l10785"></a><span class="lineno">10785</span>&#160;}</div><div class="line"><a name="l10786"></a><span class="lineno">10786</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* SERVER_MODE */</span><span class="preprocessor"></span></div><div class="line"><a name="l10787"></a><span class="lineno">10787</span>&#160;</div><div class="line"><a name="l10788"></a><span class="lineno">10788</span>&#160;<span class="preprocessor">#if defined(SERVER_MODE)</span></div><div class="line"><a name="l10789"></a><span class="lineno">10789</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l10790"></a><span class="lineno">10790</span>&#160;<span class="comment"> * log_daemons_destroy () - destroy daemon threads</span></div><div class="line"><a name="l10791"></a><span class="lineno">10791</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l10792"></a><span class="lineno">10792</span>&#160;<span class="keyword">static</span> <span class="keywordtype">void</span></div><div class="line"><a name="l10793"></a><span class="lineno">10793</span>&#160;log_daemons_destroy ()</div><div class="line"><a name="l10794"></a><span class="lineno">10794</span>&#160;{</div><div class="line"><a name="l10795"></a><span class="lineno">10795</span>&#160;  <a class="code" href="namespacecubthread.html#a0b0f629740d5037917c1773030847800">cubthread::get_manager</a> ()-&gt;<a class="code" href="classcubthread_1_1manager.html#a17ac861861c6329321c40be37a5dc436">destroy_daemon</a> (log_Remove_log_archive_daemon);</div><div class="line"><a name="l10796"></a><span class="lineno">10796</span>&#160;  <a class="code" href="namespacecubthread.html#a0b0f629740d5037917c1773030847800">cubthread::get_manager</a> ()-&gt;<a class="code" href="classcubthread_1_1manager.html#a17ac861861c6329321c40be37a5dc436">destroy_daemon</a> (log_Checkpoint_daemon);</div><div class="line"><a name="l10797"></a><span class="lineno">10797</span>&#160;  <a class="code" href="namespacecubthread.html#a0b0f629740d5037917c1773030847800">cubthread::get_manager</a> ()-&gt;<a class="code" href="classcubthread_1_1manager.html#a17ac861861c6329321c40be37a5dc436">destroy_daemon</a> (log_Check_ha_delay_info_daemon);</div><div class="line"><a name="l10798"></a><span class="lineno">10798</span>&#160;  <a class="code" href="namespacecubthread.html#a0b0f629740d5037917c1773030847800">cubthread::get_manager</a> ()-&gt;<a class="code" href="classcubthread_1_1manager.html#a17ac861861c6329321c40be37a5dc436">destroy_daemon</a> (log_Clock_daemon);</div><div class="line"><a name="l10799"></a><span class="lineno">10799</span>&#160;  <a class="code" href="namespacecubthread.html#a0b0f629740d5037917c1773030847800">cubthread::get_manager</a> ()-&gt;<a class="code" href="classcubthread_1_1manager.html#a17ac861861c6329321c40be37a5dc436">destroy_daemon</a> (log_Flush_daemon);</div><div class="line"><a name="l10800"></a><span class="lineno">10800</span>&#160;}</div><div class="line"><a name="l10801"></a><span class="lineno">10801</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* SERVER_MODE */</span><span class="preprocessor"></span></div><div class="line"><a name="l10802"></a><span class="lineno">10802</span>&#160;<span class="comment">// *INDENT-ON*</span></div><div class="line"><a name="l10803"></a><span class="lineno">10803</span>&#160;</div><div class="line"><a name="l10804"></a><span class="lineno">10804</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l10805"></a><span class="lineno">10805</span>&#160;<span class="comment"> * log_get_clock_msec () - get current system time in milliseconds.</span></div><div class="line"><a name="l10806"></a><span class="lineno">10806</span>&#160;<span class="comment"> *   return cached value by log_Clock_daemon if SERVER_MODE is defined</span></div><div class="line"><a name="l10807"></a><span class="lineno">10807</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l10808"></a><span class="lineno">10808</span>&#160;<a class="code" href="cm__broker__admin_8c.html#a8606fb1d53339b43e7417d2f96db025f">INT64</a></div><div class="line"><a name="l10809"></a><span class="lineno"><a class="line" href="log__manager_8h.html#aae543993eb8d25f8467ca12ae4e92363">10809</a></span>&#160;<a class="code" href="log__manager_8c.html#aae543993eb8d25f8467ca12ae4e92363">log_get_clock_msec</a> (<span class="keywordtype">void</span>)</div><div class="line"><a name="l10810"></a><span class="lineno">10810</span>&#160;{</div><div class="line"><a name="l10811"></a><span class="lineno">10811</span>&#160;<span class="preprocessor">#if defined (SERVER_MODE)</span></div><div class="line"><a name="l10812"></a><span class="lineno">10812</span>&#160;  <span class="keywordflow">if</span> (log_Clock_msec &gt; 0)</div><div class="line"><a name="l10813"></a><span class="lineno">10813</span>&#160;    {</div><div class="line"><a name="l10814"></a><span class="lineno">10814</span>&#160;      <span class="keywordflow">return</span> log_Clock_msec;</div><div class="line"><a name="l10815"></a><span class="lineno">10815</span>&#160;    }</div><div class="line"><a name="l10816"></a><span class="lineno">10816</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* SERVER_MODE */</span><span class="preprocessor"></span></div><div class="line"><a name="l10817"></a><span class="lineno">10817</span>&#160;</div><div class="line"><a name="l10818"></a><span class="lineno">10818</span>&#160;  <span class="keyword">struct </span>timeval now;</div><div class="line"><a name="l10819"></a><span class="lineno">10819</span>&#160;  gettimeofday (&amp;now, <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>);</div><div class="line"><a name="l10820"></a><span class="lineno">10820</span>&#160;</div><div class="line"><a name="l10821"></a><span class="lineno">10821</span>&#160;  <span class="keywordflow">return</span> (now.tv_sec * 1000LL) + (now.tv_usec / 1000LL);</div><div class="line"><a name="l10822"></a><span class="lineno">10822</span>&#160;}</div><div class="line"><a name="l10823"></a><span class="lineno">10823</span>&#160;</div><div class="line"><a name="l10824"></a><span class="lineno">10824</span>&#160;<span class="comment">// *INDENT-OFF*</span></div><div class="line"><a name="l10825"></a><span class="lineno">10825</span>&#160;<span class="preprocessor">#if defined (SERVER_MODE)</span></div><div class="line"><a name="l10826"></a><span class="lineno">10826</span>&#160;<span class="keywordtype">void</span></div><div class="line"><a name="l10827"></a><span class="lineno">10827</span>&#160;log_abort_task::execute (context_type &amp;thread_ref)</div><div class="line"><a name="l10828"></a><span class="lineno">10828</span>&#160;{</div><div class="line"><a name="l10829"></a><span class="lineno">10829</span>&#160;  (void) log_abort_by_tdes (&amp;thread_ref, &amp;m_tdes);</div><div class="line"><a name="l10830"></a><span class="lineno">10830</span>&#160;}</div><div class="line"><a name="l10831"></a><span class="lineno">10831</span>&#160;<span class="preprocessor">#endif // SERVER_MODE</span></div><div class="line"><a name="l10832"></a><span class="lineno">10832</span>&#160;<span class="comment">// *INDENT-ON*</span></div><div class="ttc" id="log__impl_8h_html_afdaa9fdf7d83212b3eec2d515e807686"><div class="ttname"><a href="log__impl_8h.html#afdaa9fdf7d83212b3eec2d515e807686">LOG_READ_ADD_ALIGN</a></div><div class="ttdeci">#define LOG_READ_ADD_ALIGN(thread_p, add, lsa, log_pgptr)</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00901">log_impl.h:901</a></div></div>
<div class="ttc" id="structlog__rec__2pc__prepcommit_html_a2fb6434c8a904488679bec8d1c5fd161"><div class="ttname"><a href="structlog__rec__2pc__prepcommit.html#a2fb6434c8a904488679bec8d1c5fd161">log_rec_2pc_prepcommit::num_object_locks</a></div><div class="ttdeci">unsigned int num_object_locks</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01645">log_impl.h:1645</a></div></div>
<div class="ttc" id="structlog__rcv_html_a4acc4ed244fcaa09adea314ee4f7b861"><div class="ttname"><a href="structlog__rcv.html#a4acc4ed244fcaa09adea314ee4f7b861">log_rcv::offset</a></div><div class="ttdeci">PGLENGTH offset</div><div class="ttdef"><b>Definition:</b> <a href="recovery_8h_source.html#l00194">recovery.h:194</a></div></div>
<div class="ttc" id="log__impl_8h_html_aaa150f6c2ae6a1748640ab281ffd94f7a1e8c5c5dbe12e8cc2388691db7011740"><div class="ttname"><a href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a1e8c5c5dbe12e8cc2388691db7011740">LOG_DIFF_UNDOREDO_DATA</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00613">log_impl.h:613</a></div></div>
<div class="ttc" id="structlog__tdes_html"><div class="ttname"><a href="structlog__tdes.html">log_tdes</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01686">log_impl.h:1686</a></div></div>
<div class="ttc" id="structlog__lsa_html_ae74e9840dd02d9c77f51f47ffd3212fd"><div class="ttname"><a href="structlog__lsa.html#ae74e9840dd02d9c77f51f47ffd3212fd">log_lsa::offset</a></div><div class="ttdeci">INT64 offset</div><div class="ttdef"><b>Definition:</b> <a href="storage__common_8h_source.html#l00106">storage_common.h:106</a></div></div>
<div class="ttc" id="filter__pred__cache_8c_html_a7f6fe5a24f5b913ff994c9482252c6bc"><div class="ttname"><a href="filter__pred__cache_8c.html#a7f6fe5a24f5b913ff994c9482252c6bc">fpcache_remove_by_class</a></div><div class="ttdeci">void fpcache_remove_by_class(THREAD_ENTRY *thread_p, OID *class_oid)</div><div class="ttdef"><b>Definition:</b> <a href="filter__pred__cache_8c_source.html#l00501">filter_pred_cache.c:501</a></div></div>
<div class="ttc" id="storage__common_8h_html_ae4a052db40daa4a44a890bad45d8ecdc"><div class="ttname"><a href="storage__common_8h.html#ae4a052db40daa4a44a890bad45d8ecdc">PAGE_PTR</a></div><div class="ttdeci">char * PAGE_PTR</div><div class="ttdef"><b>Definition:</b> <a href="storage__common_8h_source.html#l00210">storage_common.h:210</a></div></div>
<div class="ttc" id="structlog__rec__mvcc__undo_html_a7f17cde1def984989174d8aca50307b6"><div class="ttname"><a href="structlog__rec__mvcc__undo.html#a7f17cde1def984989174d8aca50307b6">log_rec_mvcc_undo::undo</a></div><div class="ttdeci">LOG_REC_UNDO undo</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00700">log_impl.h:700</a></div></div>
<div class="ttc" id="structtrantable_html_a59bdef55722fd22f2e4717a8e0e9cb37"><div class="ttname"><a href="structtrantable.html#a59bdef55722fd22f2e4717a8e0e9cb37">trantable::num_coord_loose_end_indices</a></div><div class="ttdeci">int num_coord_loose_end_indices</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01788">log_impl.h:1788</a></div></div>
<div class="ttc" id="error__code_8h_html_ad5735127cf22213983902c7ab2eecfce"><div class="ttname"><a href="error__code_8h.html#ad5735127cf22213983902c7ab2eecfce">ER_LK_UNILATERALLY_ABORTED</a></div><div class="ttdeci">#define ER_LK_UNILATERALLY_ABORTED</div><div class="ttdef"><b>Definition:</b> <a href="error__code_8h_source.html#l00126">error_code.h:126</a></div></div>
<div class="ttc" id="vacuum_8h_html_a6d5983bac579d9dfbc3b22e6542380fa"><div class="ttname"><a href="vacuum_8h.html#a6d5983bac579d9dfbc3b22e6542380fa">vacuum_is_skip_undo_allowed</a></div><div class="ttdeci">STATIC_INLINE bool vacuum_is_skip_undo_allowed(THREAD_ENTRY *thread_p) __attribute__((ALWAYS_INLINE))</div><div class="ttdef"><b>Definition:</b> <a href="vacuum_8h_source.html#l00207">vacuum.h:207</a></div></div>
<div class="ttc" id="src_2base_2rb__tree_8h_html_a2852fb3d5ccc9f1d3a245096fee9eb0b"><div class="ttname"><a href="src_2base_2rb__tree_8h.html#a2852fb3d5ccc9f1d3a245096fee9eb0b">RB_NEXT</a></div><div class="ttdeci">#define RB_NEXT(name, x, y)</div><div class="ttdef"><b>Definition:</b> <a href="src_2base_2rb__tree_8h_source.html#l00470">rb_tree.h:470</a></div></div>
<div class="ttc" id="structlog__rec__sysop__start__postpone_html"><div class="ttname"><a href="structlog__rec__sysop__start__postpone.html">log_rec_sysop_start_postpone</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01580">log_impl.h:1580</a></div></div>
<div class="ttc" id="structlog__rec__2pc__prepcommit_html_a928285756947bb78b88ba7d399713430"><div class="ttname"><a href="structlog__rec__2pc__prepcommit.html#a928285756947bb78b88ba7d399713430">log_rec_2pc_prepcommit::gtrid</a></div><div class="ttdeci">int gtrid</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01643">log_impl.h:1643</a></div></div>
<div class="ttc" id="structlog__logging__stat_html_a294ade121e65833ef710019a304c4288"><div class="ttname"><a href="structlog__logging__stat.html#a294ade121e65833ef710019a304c4288">log_logging_stat::gc_flush_count</a></div><div class="ttdeci">unsigned long gc_flush_count</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l02039">log_impl.h:2039</a></div></div>
<div class="ttc" id="structlog__rec__run__postpone_html_af54dfa4bc67af1f75ddbda8c6f070e74"><div class="ttname"><a href="structlog__rec__run__postpone.html#af54dfa4bc67af1f75ddbda8c6f070e74">log_rec_run_postpone::length</a></div><div class="ttdeci">int length</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01592">log_impl.h:1592</a></div></div>
<div class="ttc" id="partition_8c_html_a52a95bcc2d70fec238c91c2b07d02230"><div class="ttname"><a href="partition_8c.html#a52a95bcc2d70fec238c91c2b07d02230">partition_decache_class</a></div><div class="ttdeci">void partition_decache_class(THREAD_ENTRY *thread_p, const OID *class_oid)</div><div class="ttdef"><b>Definition:</b> <a href="partition_8c_source.html#l00771">partition.c:771</a></div></div>
<div class="ttc" id="structlog__append__info_html_af6d8c5019dce873f9312d4a625d3febe"><div class="ttname"><a href="structlog__append__info.html#af6d8c5019dce873f9312d4a625d3febe">log_append_info::vdes</a></div><div class="ttdeci">int vdes</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01204">log_impl.h:1204</a></div></div>
<div class="ttc" id="log__impl_8h_html_aaa150f6c2ae6a1748640ab281ffd94f7aec133d8bc86aabdcf6dcda157999bd21"><div class="ttname"><a href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7aec133d8bc86aabdcf6dcda157999bd21">LOG_DUMMY_GENERIC</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00624">log_impl.h:624</a></div></div>
<div class="ttc" id="structlog__rec__compensate_html_a7222173e854c1f68568c5ce564325a7a"><div class="ttname"><a href="structlog__rec__compensate.html#a7222173e854c1f68568c5ce564325a7a">log_rec_compensate::undo_nxlsa</a></div><div class="ttdeci">LOG_LSA undo_nxlsa</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01527">log_impl.h:1527</a></div></div>
<div class="ttc" id="message__catalog_8h_html"><div class="ttname"><a href="message__catalog_8h.html">message_catalog.h</a></div></div>
<div class="ttc" id="structlog__rec__sysop__end_html_a3ea9d3ebfe5a0ed547670f1409fb385f"><div class="ttname"><a href="structlog__rec__sysop__end.html#a3ea9d3ebfe5a0ed547670f1409fb385f">log_rec_sysop_end::type</a></div><div class="ttdeci">LOG_SYSOP_END_TYPE type</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01563">log_impl.h:1563</a></div></div>
<div class="ttc" id="log__manager_8c_html_a294c54799d2139f97b333e3123f69948"><div class="ttname"><a href="log__manager_8c.html#a294c54799d2139f97b333e3123f69948">log_initialize</a></div><div class="ttdeci">void log_initialize(THREAD_ENTRY *thread_p, const char *db_fullname, const char *logpath, const char *prefix_logname, int ismedia_crash, BO_RESTART_ARG *r_args)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l01050">log_manager.c:1050</a></div></div>
<div class="ttc" id="structlog__header_html_a115c418fc5dd536dd0d8073897815513"><div class="ttname"><a href="structlog__header.html#a115c418fc5dd536dd0d8073897815513">log_header::prefix_name</a></div><div class="ttdeci">char prefix_name[MAXLOGNAME]</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00224">log_impl.h:224</a></div></div>
<div class="ttc" id="dbtype__function_8h_html_a609e234af409a47cfefdbad3958d13dc"><div class="ttname"><a href="dbtype__function_8h.html#a609e234af409a47cfefdbad3958d13dc">db_make_datetime</a></div><div class="ttdeci">int db_make_datetime(DB_VALUE *value, const DB_DATETIME *datetime)</div></div>
<div class="ttc" id="connection__sr_8c_html_a6a26eaa100bc11d5421afc8fadaed6f4"><div class="ttname"><a href="connection__sr_8c.html#a6a26eaa100bc11d5421afc8fadaed6f4">css_find_conn_by_tran_index</a></div><div class="ttdeci">CSS_CONN_ENTRY * css_find_conn_by_tran_index(int tran_index)</div><div class="ttdef"><b>Definition:</b> <a href="connection__sr_8c_source.html#l01207">connection_sr.c:1207</a></div></div>
<div class="ttc" id="structlog__tdes_html_ae9437cf94e11e2307172ef5fc7b32aa9"><div class="ttname"><a href="structlog__tdes.html#ae9437cf94e11e2307172ef5fc7b32aa9">log_tdes::tran_index</a></div><div class="ttdeci">int tran_index</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01691">log_impl.h:1691</a></div></div>
<div class="ttc" id="structbo__restart__arg_html_a4570fd2224f3900da9fd22de143e51ab"><div class="ttname"><a href="structbo__restart__arg.html#a4570fd2224f3900da9fd22de143e51ab">bo_restart_arg::restart_repl_lsa</a></div><div class="ttdeci">LOG_LSA restart_repl_lsa</div><div class="ttdef"><b>Definition:</b> <a href="storage__common_8h_source.html#l00589">storage_common.h:589</a></div></div>
<div class="ttc" id="log__impl_8h_html_a40a91713414be68a8000f379f883ad06aca23e3e0be0d810de2059773fdb641bb"><div class="ttname"><a href="log__impl_8h.html#a40a91713414be68a8000f379f883ad06aca23e3e0be0d810de2059773fdb641bb">LOB_TRANSIENT_DELETED</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00458">log_impl.h:458</a></div></div>
<div class="ttc" id="thread__manager_8hpp_html_a40d17fa7739ffcbb231e21a1944c50d0"><div class="ttname"><a href="thread__manager_8hpp.html#a40d17fa7739ffcbb231e21a1944c50d0">thread_get_thread_entry_info</a></div><div class="ttdeci">cubthread::entry * thread_get_thread_entry_info(void)</div><div class="ttdef"><b>Definition:</b> <a href="thread__manager_8hpp_source.html#l00368">thread_manager.hpp:368</a></div></div>
<div class="ttc" id="error__code_8h_html_a258bb72419ef143530a2f8f55e7d57af"><div class="ttname"><a href="error__code_8h.html#a258bb72419ef143530a2f8f55e7d57af">NO_ERROR</a></div><div class="ttdeci">#define NO_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="error__code_8h_source.html#l00042">error_code.h:42</a></div></div>
<div class="ttc" id="structlog__header_html_a71d96c5226f6697b25a34567942300cf"><div class="ttname"><a href="structlog__header.html#a71d96c5226f6697b25a34567942300cf">log_header::last_block_oldest_mvccid</a></div><div class="ttdeci">MVCCID last_block_oldest_mvccid</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00241">log_impl.h:241</a></div></div>
<div class="ttc" id="structlog__tdes_html_a85697ad65f1a480fcc83d865e14f5818"><div class="ttname"><a href="structlog__tdes.html#a85697ad65f1a480fcc83d865e14f5818">log_tdes::cur_repl_record</a></div><div class="ttdeci">int cur_repl_record</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01733">log_impl.h:1733</a></div></div>
<div class="ttc" id="structlog__header_html_abf6f8b71041f36e854e9edaa910525be"><div class="ttname"><a href="structlog__header.html#abf6f8b71041f36e854e9edaa910525be">log_header::npages</a></div><div class="ttdeci">DKNPAGES npages</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00208">log_impl.h:208</a></div></div>
<div class="ttc" id="dtoa_8c_html_aeab71244afb687f16d8c4f5ee9d6ef0e"><div class="ttname"><a href="dtoa_8c.html#aeab71244afb687f16d8c4f5ee9d6ef0e">n</a></div><div class="ttdeci">n</div><div class="ttdef"><b>Definition:</b> <a href="dtoa_8c_source.html#l00048">dtoa.c:48</a></div></div>
<div class="ttc" id="log__impl_8h_html_aef2f79ba5cf874d653206f1a95017eb4"><div class="ttname"><a href="log__impl_8h.html#aef2f79ba5cf874d653206f1a95017eb4">logpb_initialize_log_names</a></div><div class="ttdeci">int logpb_initialize_log_names(THREAD_ENTRY *thread_p, const char *db_fullname, const char *logpath, const char *prefix_logname)</div><div class="ttdef"><b>Definition:</b> <a href="log__page__buffer_8c_source.html#l07802">log_page_buffer.c:7802</a></div></div>
<div class="ttc" id="structrecdes_html_a445953dc76a228f95f98c269ffd1c949"><div class="ttname"><a href="structrecdes.html#a445953dc76a228f95f98c269ffd1c949">recdes::area_size</a></div><div class="ttdeci">int area_size</div><div class="ttdef"><b>Definition:</b> <a href="storage__common_8h_source.html#l00342">storage_common.h:342</a></div></div>
<div class="ttc" id="log__manager_8c_html_a76afb51129a3be19c2520daa64bebf9e"><div class="ttname"><a href="log__manager_8c.html#a76afb51129a3be19c2520daa64bebf9e">log_append_redo_data</a></div><div class="ttdeci">void log_append_redo_data(THREAD_ENTRY *thread_p, LOG_RCVINDEX rcvindex, LOG_DATA_ADDR *addr, int length, const void *data)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l02009">log_manager.c:2009</a></div></div>
<div class="ttc" id="error__manager_8h_html_a5d0d456c474e11fc70779873a30a7432a07ad8f9fda27124d297c94b7d3ea44e8"><div class="ttname"><a href="error__manager_8h.html#a5d0d456c474e11fc70779873a30a7432a07ad8f9fda27124d297c94b7d3ea44e8">ER_ERROR_SEVERITY</a></div><div class="ttdef"><b>Definition:</b> <a href="error__manager_8h_source.html#l00118">error_manager.h:118</a></div></div>
<div class="ttc" id="leak__detector_8h_html_ad832104a69551cf1e4e347fffa9dc77c"><div class="ttname"><a href="leak__detector_8h.html#ad832104a69551cf1e4e347fffa9dc77c">strdup</a></div><div class="ttdeci">#define strdup(s)</div><div class="ttdef"><b>Definition:</b> <a href="leak__detector_8h_source.html#l00008">leak_detector.h:8</a></div></div>
<div class="ttc" id="porting_8h_html_a0cbd627eb8cc7711df91bf84de75bd82"><div class="ttname"><a href="porting_8h.html#a0cbd627eb8cc7711df91bf84de75bd82">__attribute__</a></div><div class="ttdeci">#define __attribute__(X)</div><div class="ttdef"><b>Definition:</b> <a href="porting_8h_source.html#l00037">porting.h:37</a></div></div>
<div class="ttc" id="dbtype__def_8h_html_aca2202a80bb85043948f7c7a714aa070"><div class="ttname"><a href="dbtype__def_8h.html#aca2202a80bb85043948f7c7a714aa070">DB_MAX_SCHEMA_LENGTH</a></div><div class="ttdeci">#define DB_MAX_SCHEMA_LENGTH</div><div class="ttdef"><b>Definition:</b> <a href="dbtype__def_8h_source.html#l00530">dbtype_def.h:530</a></div></div>
<div class="ttc" id="structlog__tdes_html_a034edbe7866ca98df7b9e54e1b5e3de2"><div class="ttname"><a href="structlog__tdes.html#a034edbe7866ca98df7b9e54e1b5e3de2">log_tdes::lob_locator_root</a></div><div class="ttdeci">struct lob_rb_root lob_locator_root</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01743">log_impl.h:1743</a></div></div>
<div class="ttc" id="log__manager_8c_html_ac8cc1b1140e661523c729c0e9e8f6523"><div class="ttname"><a href="log__manager_8c.html#ac8cc1b1140e661523c729c0e9e8f6523">log_commit_local</a></div><div class="ttdeci">TRAN_STATE log_commit_local(THREAD_ENTRY *thread_p, LOG_TDES *tdes, bool retain_lock, bool is_local_tran)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l05503">log_manager.c:5503</a></div></div>
<div class="ttc" id="log__impl_8h_html_aaa68f52fa8fd0a57a73d5201e7214321"><div class="ttname"><a href="log__impl_8h.html#aaa68f52fa8fd0a57a73d5201e7214321">LOG_DBLOG_BKUPINFO_VOLID</a></div><div class="ttdeci">#define LOG_DBLOG_BKUPINFO_VOLID</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00489">log_impl.h:489</a></div></div>
<div class="ttc" id="log__manager_8c_html_acc276f18c02a976bd38d99c017921401"><div class="ttname"><a href="log__manager_8c.html#acc276f18c02a976bd38d99c017921401">log_append_repl_info</a></div><div class="ttdeci">void log_append_repl_info(THREAD_ENTRY *thread_p, LOG_TDES *tdes, bool is_commit)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l04622">log_manager.c:4622</a></div></div>
<div class="ttc" id="error__code_8h_html_a735645c59f194f130c655b1974b6df17"><div class="ttname"><a href="error__code_8h.html#a735645c59f194f130c655b1974b6df17">ER_LOG_REDO_INTERFACE</a></div><div class="ttdeci">#define ER_LOG_REDO_INTERFACE</div><div class="ttdef"><b>Definition:</b> <a href="error__code_8h_source.html#l00145">error_code.h:145</a></div></div>
<div class="ttc" id="structlob__savepoint__entry_html_af8cc29daa202c0ddba6cbec4cf30882a"><div class="ttname"><a href="structlob__savepoint__entry.html#af8cc29daa202c0ddba6cbec4cf30882a">lob_savepoint_entry::locator</a></div><div class="ttdeci">ES_URI locator</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l00163">log_manager.c:163</a></div></div>
<div class="ttc" id="structlog__header_html_a74993a3a849045719cb0661356702c8d"><div class="ttname"><a href="structlog__header.html#a74993a3a849045719cb0661356702c8d">log_header::avg_nlocks</a></div><div class="ttdeci">int avg_nlocks</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00207">log_impl.h:207</a></div></div>
<div class="ttc" id="structlog__rec__replication_html_ae914ee167eab6535e3072163d40ff2c3"><div class="ttname"><a href="structlog__rec__replication.html#ae914ee167eab6535e3072163d40ff2c3">log_rec_replication::rcvindex</a></div><div class="ttdeci">int rcvindex</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00719">log_impl.h:719</a></div></div>
<div class="ttc" id="dbtype_8h_html"><div class="ttname"><a href="dbtype_8h.html">dbtype.h</a></div></div>
<div class="ttc" id="log__impl_8h_html_ab85dbe80b115a32bf7a430c32ddc5b8b"><div class="ttname"><a href="log__impl_8h.html#ab85dbe80b115a32bf7a430c32ddc5b8b">LOG_RECTYPE</a></div><div class="ttdeci">enum log_rectype LOG_RECTYPE</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00629">log_impl.h:629</a></div></div>
<div class="ttc" id="structlog__header_html_ac84fc8c39ca403a029683a4ceeef9bd6"><div class="ttname"><a href="structlog__header.html#ac84fc8c39ca403a029683a4ceeef9bd6">log_header::db_compatibility</a></div><div class="ttdeci">float db_compatibility</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00198">log_impl.h:198</a></div></div>
<div class="ttc" id="error__code_8h_html_a320868638688e5fee6412ef68fa1f3eb"><div class="ttname"><a href="error__code_8h.html#a320868638688e5fee6412ef68fa1f3eb">ER_LOG_UNKNOWN_SAVEPOINT</a></div><div class="ttdeci">#define ER_LOG_UNKNOWN_SAVEPOINT</div><div class="ttdef"><b>Definition:</b> <a href="error__code_8h_source.html#l00644">error_code.h:644</a></div></div>
<div class="ttc" id="log__impl_8h_html_acf8424877a6714a77a4aead4a32a9993"><div class="ttname"><a href="log__impl_8h.html#acf8424877a6714a77a4aead4a32a9993">LOG_HA_FILESTAT</a></div><div class="ttdeci">LOG_HA_FILESTAT</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00465">log_impl.h:465</a></div></div>
<div class="ttc" id="error__code_8h_html_afb34238455b940cb2bacb3ddd899bb03"><div class="ttname"><a href="error__code_8h.html#afb34238455b940cb2bacb3ddd899bb03">ER_LOG_MAYNEED_MEDIA_RECOVERY</a></div><div class="ttdeci">#define ER_LOG_MAYNEED_MEDIA_RECOVERY</div><div class="ttdef"><b>Definition:</b> <a href="error__code_8h_source.html#l00151">error_code.h:151</a></div></div>
<div class="ttc" id="log__impl_8h_html_abced029cdab388279dc4b134179929c3"><div class="ttname"><a href="log__impl_8h.html#abced029cdab388279dc4b134179929c3">logtb_complete_mvcc</a></div><div class="ttdeci">void logtb_complete_mvcc(THREAD_ENTRY *thread_p, LOG_TDES *tdes, bool committed)</div><div class="ttdef"><b>Definition:</b> <a href="log__tran__table_8c_source.html#l04768">log_tran_table.c:4768</a></div></div>
<div class="ttc" id="log__global_8c_html_ac27e93d7a688f2c6a273eed757062705"><div class="ttname"><a href="log__global_8c.html#ac27e93d7a688f2c6a273eed757062705">log_Db_fullname</a></div><div class="ttdeci">const char * log_Db_fullname</div><div class="ttdef"><b>Definition:</b> <a href="log__global_8c_source.html#l00114">log_global.c:114</a></div></div>
<div class="ttc" id="log__impl_8h_html_a40a91713414be68a8000f379f883ad06a284ad932872157db9e2055b6ec003e36"><div class="ttname"><a href="log__impl_8h.html#a40a91713414be68a8000f379f883ad06a284ad932872157db9e2055b6ec003e36">LOB_TRANSIENT_CREATED</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00457">log_impl.h:457</a></div></div>
<div class="ttc" id="perf__monitor_8h_html_a165b76d14ae9e30731ed3ca4cf856903a45f0a392cf22a81f266b6b6c70bd8a60"><div class="ttname"><a href="perf__monitor_8h.html#a165b76d14ae9e30731ed3ca4cf856903a45f0a392cf22a81f266b6b6c70bd8a60">PSTAT_TRAN_NUM_SAVEPOINTS</a></div><div class="ttdef"><b>Definition:</b> <a href="perf__monitor_8h_source.html#l00325">perf_monitor.h:325</a></div></div>
<div class="ttc" id="log__manager_8c_html_addfa3d47a458055afd11100d64b0865b"><div class="ttname"><a href="log__manager_8c.html#addfa3d47a458055afd11100d64b0865b">log_append_undoredo_data2</a></div><div class="ttdeci">void log_append_undoredo_data2(THREAD_ENTRY *thread_p, LOG_RCVINDEX rcvindex, const VFID *vfid, PAGE_PTR pgptr, PGLENGTH offset, int undo_length, int redo_length, const void *undo_data, const void *redo_data)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l01891">log_manager.c:1891</a></div></div>
<div class="ttc" id="fault__injection_8h_html_ad69d24ac236045dc719cbc6ea7b8bc77ab2710d25847fddeee711f9f106dbc50f"><div class="ttname"><a href="fault__injection_8h.html#ad69d24ac236045dc719cbc6ea7b8bc77ab2710d25847fddeee711f9f106dbc50f">FI_TEST_LOG_MANAGER_RANDOM_EXIT_AT_END_SYSTEMOP</a></div><div class="ttdef"><b>Definition:</b> <a href="fault__injection_8h_source.html#l00079">fault_injection.h:79</a></div></div>
<div class="ttc" id="xserver__interface_8h_html_a8523aec0bf38f7fb896126ad26ed6665"><div class="ttname"><a href="xserver__interface_8h.html#a8523aec0bf38f7fb896126ad26ed6665">xdisk_get_purpose_and_space_info</a></div><div class="ttdeci">int xdisk_get_purpose_and_space_info(THREAD_ENTRY *thread_p, VOLID volid, DISK_VOLPURPOSE *vol_purpose, DISK_VOLUME_SPACE_INFO *space_info)</div><div class="ttdef"><b>Definition:</b> <a href="disk__manager_8c_source.html#l05559">disk_manager.c:5559</a></div></div>
<div class="ttc" id="server__support_8c_html_a932bc1609226fd2ee2a4103755c553a7"><div class="ttname"><a href="server__support_8c.html#a932bc1609226fd2ee2a4103755c553a7">css_set_ha_repl_delayed</a></div><div class="ttdeci">void css_set_ha_repl_delayed(void)</div><div class="ttdef"><b>Definition:</b> <a href="server__support_8c_source.html#l02053">server_support.c:2053</a></div></div>
<div class="ttc" id="get__shard__id_8c_html_ae688d728e1acdfe5988c7db45d6f0166"><div class="ttname"><a href="get__shard__id_8c.html#ae688d728e1acdfe5988c7db45d6f0166">PATH_MAX</a></div><div class="ttdeci">#define PATH_MAX</div><div class="ttdef"><b>Definition:</b> <a href="get__shard__id_8c_source.html#l00041">get_shard_id.c:41</a></div></div>
<div class="ttc" id="structbo__restart__arg_html_ac2691a46737fc6a722755a50ad9b8e71"><div class="ttname"><a href="structbo__restart__arg.html#ac2691a46737fc6a722755a50ad9b8e71">bo_restart_arg::restore_slave</a></div><div class="ttdeci">bool restore_slave</div><div class="ttdef"><b>Definition:</b> <a href="storage__common_8h_source.html#l00586">storage_common.h:586</a></div></div>
<div class="ttc" id="page__buffer_8c_html_ad57fb80ce30a5d3a727768a9198e51fc"><div class="ttname"><a href="page__buffer_8c.html#ad57fb80ce30a5d3a727768a9198e51fc">pgbuf_is_lsa_temporary</a></div><div class="ttdeci">bool pgbuf_is_lsa_temporary(PAGE_PTR pgptr)</div><div class="ttdef"><b>Definition:</b> <a href="page__buffer_8c_source.html#l04855">page_buffer.c:4855</a></div></div>
<div class="ttc" id="log__manager_8c_html_a514c12210485928e3c0446bf9e3d371c"><div class="ttname"><a href="log__manager_8c.html#a514c12210485928e3c0446bf9e3d371c">LOG_TDES_LAST_SYSOP</a></div><div class="ttdeci">#define LOG_TDES_LAST_SYSOP(tdes)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l00203">log_manager.c:203</a></div></div>
<div class="ttc" id="storage__common_8h_html_a097b8646f24ea98e209e18c53d74522a"><div class="ttname"><a href="storage__common_8h.html#a097b8646f24ea98e209e18c53d74522a">IO_PAGESIZE</a></div><div class="ttdeci">#define IO_PAGESIZE</div><div class="ttdef"><b>Definition:</b> <a href="storage__common_8h_source.html#l00164">storage_common.h:164</a></div></div>
<div class="ttc" id="log__2pc_8c_html_ab47b2cdecdd3831c4f54258773eef82a"><div class="ttname"><a href="log__2pc_8c.html#ab47b2cdecdd3831c4f54258773eef82a">log_2pc_commit</a></div><div class="ttdeci">TRAN_STATE log_2pc_commit(THREAD_ENTRY *thread_p, LOG_TDES *tdes, LOG_2PC_EXECUTE execute_2pc_type, bool *decision)</div><div class="ttdef"><b>Definition:</b> <a href="log__2pc_8c_source.html#l00744">log_2pc.c:744</a></div></div>
<div class="ttc" id="structlog__global_html_a4cf383467135a4aa88ffe54e788b4706"><div class="ttname"><a href="structlog__global.html#a4cf383467135a4aa88ffe54e788b4706">log_global::trantable</a></div><div class="ttdeci">TRANTABLE trantable</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01938">log_impl.h:1938</a></div></div>
<div class="ttc" id="log__manager_8h_html"><div class="ttname"><a href="log__manager_8h.html">log_manager.h</a></div></div>
<div class="ttc" id="boot__sr_8h_html_a6a341e7f3388261fe3d7fe1f27d6400a"><div class="ttname"><a href="boot__sr_8h.html#a6a341e7f3388261fe3d7fe1f27d6400a">BO_IS_SERVER_RESTARTED</a></div><div class="ttdeci">#define BO_IS_SERVER_RESTARTED()</div><div class="ttdef"><b>Definition:</b> <a href="boot__sr_8h_source.html#l00083">boot_sr.h:83</a></div></div>
<div class="ttc" id="log__manager_8c_html_acede8354bdcf6ae570ee030b4f57c07b"><div class="ttname"><a href="log__manager_8c.html#acede8354bdcf6ae570ee030b4f57c07b">log_sysop_end_final</a></div><div class="ttdeci">STATIC_INLINE void log_sysop_end_final(THREAD_ENTRY *thread_p, LOG_TDES *tdes) __attribute__((ALWAYS_INLINE))</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l03812">log_manager.c:3812</a></div></div>
<div class="ttc" id="recovery_8h_html_a526c4dc065c989256afca8b3b56d4d2ba62fd60ee126c842a43a0686dd479f3e7"><div class="ttname"><a href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2ba62fd60ee126c842a43a0686dd479f3e7">RVHF_UPDATE_NOTIFY_VACUUM</a></div><div class="ttdef"><b>Definition:</b> <a href="recovery_8h_source.html#l00094">recovery.h:94</a></div></div>
<div class="ttc" id="log__2pc_8c_html_a5ca4289c73c7a20f910ab4b689620520"><div class="ttname"><a href="log__2pc_8c.html#a5ca4289c73c7a20f910ab4b689620520">log_2pc_dump_acqobj_locks</a></div><div class="ttdeci">void log_2pc_dump_acqobj_locks(FILE *fp, int length, void *data)</div><div class="ttdef"><b>Definition:</b> <a href="log__2pc_8c_source.html#l01620">log_2pc.c:1620</a></div></div>
<div class="ttc" id="structlog__rec__undoredo_html_ae7cba71fbe8b2e543bfdb4fe792e1489"><div class="ttname"><a href="structlog__rec__undoredo.html#ae7cba71fbe8b2e543bfdb4fe792e1489">log_rec_undoredo::ulength</a></div><div class="ttdeci">int ulength</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00657">log_impl.h:657</a></div></div>
<div class="ttc" id="structtrantable_html_a4a29a2fef75af5ba908037e1ad1218e0"><div class="ttname"><a href="structtrantable.html#a4a29a2fef75af5ba908037e1ad1218e0">trantable::num_total_indices</a></div><div class="ttdeci">int num_total_indices</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01785">log_impl.h:1785</a></div></div>
<div class="ttc" id="storage__common_8h_html_ad704198b3c56cf17601de69c679a7181a35abaa3db871d8483efae56e6287cd67"><div class="ttname"><a href="storage__common_8h.html#ad704198b3c56cf17601de69c679a7181a35abaa3db871d8483efae56e6287cd67">S_DOESNT_FIT</a></div><div class="ttdef"><b>Definition:</b> <a href="storage__common_8h_source.html#l00645">storage_common.h:645</a></div></div>
<div class="ttc" id="log__impl_8h_html_a3a7892fc280ade1dfd26f3e21ac3da16"><div class="ttname"><a href="log__impl_8h.html#a3a7892fc280ade1dfd26f3e21ac3da16">logpb_initialize_header</a></div><div class="ttdeci">int logpb_initialize_header(THREAD_ENTRY *thread_p, LOG_HEADER *loghdr, const char *prefix_logname, DKNPAGES npages, INT64 *db_creation)</div><div class="ttdef"><b>Definition:</b> <a href="log__page__buffer_8c_source.html#l01431">log_page_buffer.c:1431</a></div></div>
<div class="ttc" id="log__manager_8c_html_a1bfabe29d0a3621d3f9d12f3e77cd3ee"><div class="ttname"><a href="log__manager_8c.html#a1bfabe29d0a3621d3f9d12f3e77cd3ee">log_get_io_page_size</a></div><div class="ttdeci">PGLENGTH log_get_io_page_size(THREAD_ENTRY *thread_p, const char *db_fullname, const char *logpath, const char *prefix_logname)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l09231">log_manager.c:9231</a></div></div>
<div class="ttc" id="log__impl_8h_html_a24797b2fe67e0ec8631d7a92fbef25c9ada41432cf121d5aafecae01984edd8e7"><div class="ttname"><a href="log__impl_8h.html#a24797b2fe67e0ec8631d7a92fbef25c9ada41432cf121d5aafecae01984edd8e7">LOG_SYSOP_END_LOGICAL_RUN_POSTPONE</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01546">log_impl.h:1546</a></div></div>
<div class="ttc" id="structlog__rec__redo_html_a0a55afc612491df6d6b3b4be22d1c703"><div class="ttname"><a href="structlog__rec__redo.html#a0a55afc612491df6d6b3b4be22d1c703">log_rec_redo::length</a></div><div class="ttdeci">int length</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00674">log_impl.h:674</a></div></div>
<div class="ttc" id="log__manager_8c_html_a6ae789049ef769d2489e14fd6bec41f8"><div class="ttname"><a href="log__manager_8c.html#a6ae789049ef769d2489e14fd6bec41f8">log_abort</a></div><div class="ttdeci">TRAN_STATE log_abort(THREAD_ENTRY *thread_p, int tran_index)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l05813">log_manager.c:5813</a></div></div>
<div class="ttc" id="log__manager_8c_html_a487dabcb7a4dc15bab76299fb5ff1660"><div class="ttname"><a href="log__manager_8c.html#a487dabcb7a4dc15bab76299fb5ff1660">log_append_undoredo_crumbs</a></div><div class="ttdeci">void log_append_undoredo_crumbs(THREAD_ENTRY *thread_p, LOG_RCVINDEX rcvindex, LOG_DATA_ADDR *addr, int num_undo_crumbs, int num_redo_crumbs, const LOG_CRUMB *undo_crumbs, const LOG_CRUMB *redo_crumbs)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l02060">log_manager.c:2060</a></div></div>
<div class="ttc" id="page__buffer_8c_html_a8ed4cd7af3b754c2707daa523eeee534"><div class="ttname"><a href="page__buffer_8c.html#a8ed4cd7af3b754c2707daa523eeee534">pgbuf_flush_all_unfixed_and_set_lsa_as_null</a></div><div class="ttdeci">int pgbuf_flush_all_unfixed_and_set_lsa_as_null(THREAD_ENTRY *thread_p, VOLID volid)</div><div class="ttdef"><b>Definition:</b> <a href="page__buffer_8c_source.html#l03101">page_buffer.c:3101</a></div></div>
<div class="ttc" id="error__manager_8h_html_a58c6148c01f4a56a3d04b8719b916d01"><div class="ttname"><a href="error__manager_8h.html#a58c6148c01f4a56a3d04b8719b916d01">ASSERT_ERROR</a></div><div class="ttdeci">#define ASSERT_ERROR()</div><div class="ttdef"><b>Definition:</b> <a href="error__manager_8h_source.html#l00157">error_manager.h:157</a></div></div>
<div class="ttc" id="storage__common_8h_html_ad704198b3c56cf17601de69c679a7181"><div class="ttname"><a href="storage__common_8h.html#ad704198b3c56cf17601de69c679a7181">SCAN_CODE</a></div><div class="ttdeci">SCAN_CODE</div><div class="ttdef"><b>Definition:</b> <a href="storage__common_8h_source.html#l00639">storage_common.h:639</a></div></div>
<div class="ttc" id="log__manager_8c_html_a922a0c5f839b07dc18e05320911311f4"><div class="ttname"><a href="log__manager_8c.html#a922a0c5f839b07dc18e05320911311f4">locator_drop_transient_class_name_entries</a></div><div class="ttdeci">int locator_drop_transient_class_name_entries(THREAD_ENTRY *thread_p, LOG_LSA *savep_lsa)</div><div class="ttdef"><b>Definition:</b> <a href="locator__sr_8c_source.html#l01248">locator_sr.c:1248</a></div></div>
<div class="ttc" id="structlog__rec__dbout__redo_html"><div class="ttname"><a href="structlog__rec__dbout__redo.html">log_rec_dbout_redo</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01516">log_impl.h:1516</a></div></div>
<div class="ttc" id="storage__common_8h_html_a467739272b1ee74686bae4be2354197a"><div class="ttname"><a href="storage__common_8h.html#a467739272b1ee74686bae4be2354197a">LSA_GT</a></div><div class="ttdeci">#define LSA_GT(lsa_ptr1, lsa_ptr2)</div><div class="ttdef"><b>Definition:</b> <a href="storage__common_8h_source.html#l00154">storage_common.h:154</a></div></div>
<div class="ttc" id="vacuum_8c_html_a51dbaefecbd3e7004cc239b63a47dadd"><div class="ttname"><a href="vacuum_8c.html#a51dbaefecbd3e7004cc239b63a47dadd">vacuum_do_postpone_from_cache</a></div><div class="ttdeci">bool vacuum_do_postpone_from_cache(THREAD_ENTRY *thread_p, LOG_LSA *start_postpone_lsa)</div><div class="ttdef"><b>Definition:</b> <a href="vacuum_8c_source.html#l07632">vacuum.c:7632</a></div></div>
<div class="ttc" id="query__manager_8c_html_aef469e9b70e98d1fb4e113d9757bab26"><div class="ttname"><a href="query__manager_8c.html#aef469e9b70e98d1fb4e113d9757bab26">qmgr_clear_trans_wakeup</a></div><div class="ttdeci">void qmgr_clear_trans_wakeup(THREAD_ENTRY *thread_p, int tran_index, bool is_tran_died, bool is_abort)</div><div class="ttdef"><b>Definition:</b> <a href="query__manager_8c_source.html#l02042">query_manager.c:2042</a></div></div>
<div class="ttc" id="recovery_8h_html_a526c4dc065c989256afca8b3b56d4d2ba1091dedb4bd49edbff1021e98dcb7562"><div class="ttname"><a href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2ba1091dedb4bd49edbff1021e98dcb7562">RVREPL_DATA_UPDATE_START</a></div><div class="ttdef"><b>Definition:</b> <a href="recovery_8h_source.html#l00153">recovery.h:153</a></div></div>
<div class="ttc" id="structlog__rec__redo_html_a96ea9b5f13d7c0934ec9b5cd95ae274d"><div class="ttname"><a href="structlog__rec__redo.html#a96ea9b5f13d7c0934ec9b5cd95ae274d">log_rec_redo::data</a></div><div class="ttdeci">LOG_DATA data</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00673">log_impl.h:673</a></div></div>
<div class="ttc" id="structlog__group__commit__info_html_a5a6ab6aa5a763c49b53d1cde4621df7a"><div class="ttname"><a href="structlog__group__commit__info.html#a5a6ab6aa5a763c49b53d1cde4621df7a">log_group_commit_info::gc_mutex</a></div><div class="ttdeci">pthread_mutex_t gc_mutex</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01136">log_impl.h:1136</a></div></div>
<div class="ttc" id="connection__defs_8h_html_af25c1168c04e2af339cd1466d541701e"><div class="ttname"><a href="connection__defs_8h.html#af25c1168c04e2af339cd1466d541701e">HA_DELAY_ERR_CORRECTION</a></div><div class="ttdeci">#define HA_DELAY_ERR_CORRECTION</div><div class="ttdef"><b>Definition:</b> <a href="connection__defs_8h_source.html#l00328">connection_defs.h:328</a></div></div>
<div class="ttc" id="structlog__global_html_a1b54cbf9234422852527cbc8336d6b99"><div class="ttname"><a href="structlog__global.html#a1b54cbf9234422852527cbc8336d6b99">log_global::chkpt_redo_lsa</a></div><div class="ttdeci">LOG_LSA chkpt_redo_lsa</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01948">log_impl.h:1948</a></div></div>
<div class="ttc" id="dbtype__def_8h_html_ae85379d0c7c731c668592fb40e8bc6f2a704030cd9f3edcce778f711af24c7111"><div class="ttname"><a href="dbtype__def_8h.html#ae85379d0c7c731c668592fb40e8bc6f2a704030cd9f3edcce778f711af24c7111">DB_TEMPORARY_DATA_PURPOSE</a></div><div class="ttdef"><b>Definition:</b> <a href="dbtype__def_8h_source.html#l00215">dbtype_def.h:215</a></div></div>
<div class="ttc" id="structlog__rec__2pc__start_html_a3c155bc7cfea4d61a03ac96a09ec9e40"><div class="ttname"><a href="structlog__rec__2pc__start.html#a3c155bc7cfea4d61a03ac96a09ec9e40">log_rec_2pc_start::user_name</a></div><div class="ttdeci">char user_name[DB_MAX_USER_LENGTH+1]</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01654">log_impl.h:1654</a></div></div>
<div class="ttc" id="structlog__header_html_a4e13bc146dbc2b5c9ee65f2a0313a8e1"><div class="ttname"><a href="structlog__header.html#a4e13bc146dbc2b5c9ee65f2a0313a8e1">log_header::bkup_level1_lsa</a></div><div class="ttdeci">LOG_LSA bkup_level1_lsa</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00222">log_impl.h:222</a></div></div>
<div class="ttc" id="server__support_8c_html_a828e24952477283b9d9f5f3c6d88de04"><div class="ttname"><a href="server__support_8c.html#a828e24952477283b9d9f5f3c6d88de04">css_count_transaction_worker_threads</a></div><div class="ttdeci">size_t css_count_transaction_worker_threads(THREAD_ENTRY *thread_p, int tran_index, int client_id)</div><div class="ttdef"><b>Definition:</b> <a href="server__support_8c_source.html#l03322">server_support.c:3322</a></div></div>
<div class="ttc" id="recovery_8c_html_a9489c3632ab4b52fc008b589ce45cbdc"><div class="ttname"><a href="recovery_8c.html#a9489c3632ab4b52fc008b589ce45cbdc">rv_rcvindex_string</a></div><div class="ttdeci">const char * rv_rcvindex_string(LOG_RCVINDEX rcvindex)</div><div class="ttdef"><b>Definition:</b> <a href="recovery_8c_source.html#l00818">recovery.c:818</a></div></div>
<div class="ttc" id="log__impl_8h_html_a8e111eafc27b6e1383fbd0ee812b1167"><div class="ttname"><a href="log__impl_8h.html#a8e111eafc27b6e1383fbd0ee812b1167">logpb_fatal_error</a></div><div class="ttdeci">void logpb_fatal_error(THREAD_ENTRY *thread_p, bool logexit, const char *file_name, const int lineno, const char *fmt,...)</div><div class="ttdef"><b>Definition:</b> <a href="log__page__buffer_8c_source.html#l11356">log_page_buffer.c:11356</a></div></div>
<div class="ttc" id="mprec_8c_html_a61569f2965b7a369eb10b6d75d410d11"><div class="ttname"><a href="mprec_8c.html#a61569f2965b7a369eb10b6d75d410d11">int</a></div><div class="ttdeci">int</div><div class="ttdef"><b>Definition:</b> <a href="mprec_8c_source.html#l00252">mprec.c:252</a></div></div>
<div class="ttc" id="storage__common_8h_html_a129ad3bf94287c74f68d634d7e1f0228"><div class="ttname"><a href="storage__common_8h.html#a129ad3bf94287c74f68d634d7e1f0228">TRANID</a></div><div class="ttdeci">int TRANID</div><div class="ttdef"><b>Definition:</b> <a href="storage__common_8h_source.html#l00457">storage_common.h:457</a></div></div>
<div class="ttc" id="critical__section_8h_html_a3059160b974349c3ccbc8d9489a38709"><div class="ttname"><a href="critical__section_8h.html#a3059160b974349c3ccbc8d9489a38709">rmutex_unlock</a></div><div class="ttdeci">#define rmutex_unlock(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="critical__section_8h_source.html#l00221">critical_section.h:221</a></div></div>
<div class="ttc" id="log__impl_8h_html_a65e356ca467fe1819db2946e15095aab"><div class="ttname"><a href="log__impl_8h.html#a65e356ca467fe1819db2946e15095aab">LOG_PSTATUS</a></div><div class="ttdeci">LOG_PSTATUS</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00507">log_impl.h:507</a></div></div>
<div class="ttc" id="error__code_8h_html_a0fe5a2a2c2ff79b0b781f348bec6ead8"><div class="ttname"><a href="error__code_8h.html#a0fe5a2a2c2ff79b0b781f348bec6ead8">ER_LOG_FATAL_ERROR</a></div><div class="ttdeci">#define ER_LOG_FATAL_ERROR</div><div class="ttdef"><b>Definition:</b> <a href="error__code_8h_source.html#l00773">error_code.h:773</a></div></div>
<div class="ttc" id="log__comm_8h_html_a3c0be9b9f104459ab90ee18af95c4b3eaaed7a3b3de7b11b4ac81fedf6471e10c"><div class="ttname"><a href="log__comm_8h.html#a3c0be9b9f104459ab90ee18af95c4b3eaaed7a3b3de7b11b4ac81fedf6471e10c">TRAN_UNACTIVE_UNKNOWN</a></div><div class="ttdef"><b>Definition:</b> <a href="log__comm_8h_source.html#l00069">log_comm.h:69</a></div></div>
<div class="ttc" id="leak__detector_8h_html_a99aa8fd9f4831e1b0fa9e1cdcde3e249"><div class="ttname"><a href="leak__detector_8h.html#a99aa8fd9f4831e1b0fa9e1cdcde3e249">malloc</a></div><div class="ttdeci">#define malloc(n)</div><div class="ttdef"><b>Definition:</b> <a href="leak__detector_8h_source.html#l00003">leak_detector.h:3</a></div></div>
<div class="ttc" id="structrvfun_html_af48854e9fe4be091abcca9982252bde7"><div class="ttname"><a href="structrvfun.html#af48854e9fe4be091abcca9982252bde7">rvfun::undofun</a></div><div class="ttdeci">int(* undofun)(THREAD_ENTRY *thread_p, LOG_RCV *logrcv)</div><div class="ttdef"><b>Definition:</b> <a href="recovery_8h_source.html#l00208">recovery.h:208</a></div></div>
<div class="ttc" id="structbo__restart__arg_html_accfb5a74c1f5aa4e82c663cc0c844743"><div class="ttname"><a href="structbo__restart__arg.html#accfb5a74c1f5aa4e82c663cc0c844743">bo_restart_arg::db_creation</a></div><div class="ttdeci">INT64 db_creation</div><div class="ttdef"><b>Definition:</b> <a href="storage__common_8h_source.html#l00588">storage_common.h:588</a></div></div>
<div class="ttc" id="thread__entry__task_8hpp_html"><div class="ttname"><a href="thread__entry__task_8hpp.html">thread_entry_task.hpp</a></div></div>
<div class="ttc" id="classcubthread_1_1entry_html_a0d1763b36869fd274154c4ae5ef9d2c0"><div class="ttname"><a href="classcubthread_1_1entry.html#a0d1763b36869fd274154c4ae5ef9d2c0">cubthread::entry::event_stats</a></div><div class="ttdeci">EVENT_STAT event_stats</div><div class="ttdef"><b>Definition:</b> <a href="thread__entry_8hpp_source.html#l00255">thread_entry.hpp:255</a></div></div>
<div class="ttc" id="log__manager_8c_html_afd1a2421cd94bcd23d1eae834e6a1d28"><div class="ttname"><a href="log__manager_8c.html#afd1a2421cd94bcd23d1eae834e6a1d28">log_sysop_end_logical_compensate</a></div><div class="ttdeci">void log_sysop_end_logical_compensate(THREAD_ENTRY *thread_p, LOG_LSA *undo_nxlsa)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l04043">log_manager.c:4043</a></div></div>
<div class="ttc" id="log__manager_8c_html_a3ecc2751989b36deb454d7a32e1ee5b8"><div class="ttname"><a href="log__manager_8c.html#a3ecc2751989b36deb454d7a32e1ee5b8">vacuum_Global_oldest_active_blockers_counter</a></div><div class="ttdeci">INT32 vacuum_Global_oldest_active_blockers_counter</div><div class="ttdef"><b>Definition:</b> <a href="vacuum_8c_source.html#l00342">vacuum.c:342</a></div></div>
<div class="ttc" id="log__impl_8h_html_aaa150f6c2ae6a1748640ab281ffd94f7a3d03de268419fc962e6ca48de324a644"><div class="ttname"><a href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a3d03de268419fc962e6ca48de324a644">LOG_DUMMY_OVF_RECORD</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00615">log_impl.h:615</a></div></div>
<div class="ttc" id="structlog__tdes_html_ac6b6a36cbca989a3a6da12acc2227d56"><div class="ttname"><a href="structlog__tdes.html#ac6b6a36cbca989a3a6da12acc2227d56">log_tdes::repl_update_lsa</a></div><div class="ttdeci">LOG_LSA repl_update_lsa</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01738">log_impl.h:1738</a></div></div>
<div class="ttc" id="log__manager_8c_html_a4f05d5c0a4f3f3106fe28a2d45424683"><div class="ttname"><a href="log__manager_8c.html#a4f05d5c0a4f3f3106fe28a2d45424683">log_append_dboutside_redo</a></div><div class="ttdeci">void log_append_dboutside_redo(THREAD_ENTRY *thread_p, LOG_RCVINDEX rcvindex, int length, const void *data)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l02646">log_manager.c:2646</a></div></div>
<div class="ttc" id="structlog__topops__stack_html_a5e509dcc15d89abc0c6ba486af6dba4d"><div class="ttname"><a href="structlog__topops__stack.html#a5e509dcc15d89abc0c6ba486af6dba4d">log_topops_stack::last</a></div><div class="ttdeci">int last</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01290">log_impl.h:1290</a></div></div>
<div class="ttc" id="log__impl_8h_html_a9ccf9110ba2ff23abcdad35e144269b8"><div class="ttname"><a href="log__impl_8h.html#a9ccf9110ba2ff23abcdad35e144269b8">LOG_GETNEWTRID</a></div><div class="ttdeci">enum log_getnewtrid LOG_GETNEWTRID</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01085">log_impl.h:1085</a></div></div>
<div class="ttc" id="storage__common_8h_html_a261e4bc7334f8eabe6e1f0a3d7f7dcb4"><div class="ttname"><a href="storage__common_8h.html#a261e4bc7334f8eabe6e1f0a3d7f7dcb4">DKNPAGES</a></div><div class="ttdeci">PAGEID DKNPAGES</div><div class="ttdef"><b>Definition:</b> <a href="storage__common_8h_source.html#l00086">storage_common.h:86</a></div></div>
<div class="ttc" id="structlog__zip_html_ac57b9be7fa6f4be036cf9e6db8565195"><div class="ttname"><a href="structlog__zip.html#ac57b9be7fa6f4be036cf9e6db8565195">log_zip::log_data</a></div><div class="ttdeci">lzo_bytep log_data</div><div class="ttdef"><b>Definition:</b> <a href="log__compress_8h_source.html#l00059">log_compress.h:59</a></div></div>
<div class="ttc" id="structlog__header_html_afd7807a9da370474be5f75cb3aafcffd"><div class="ttname"><a href="structlog__header.html#afd7807a9da370474be5f75cb3aafcffd">log_header::nxarv_num</a></div><div class="ttdeci">int nxarv_num</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00218">log_impl.h:218</a></div></div>
<div class="ttc" id="log__compress_8c_html_a57a48bb541f858a2602ae9f731f5200e"><div class="ttname"><a href="log__compress_8c.html#a57a48bb541f858a2602ae9f731f5200e">log_zip_alloc</a></div><div class="ttdeci">LOG_ZIP * log_zip_alloc(LOG_ZIP_SIZE_T size, bool is_zip)</div><div class="ttdef"><b>Definition:</b> <a href="log__compress_8c_source.html#l00199">log_compress.c:199</a></div></div>
<div class="ttc" id="structlog__prior__node_html"><div class="ttname"><a href="structlog__prior__node.html">log_prior_node</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01848">log_impl.h:1848</a></div></div>
<div class="ttc" id="error__code_8h_html_a486c1c6b307c5a60224c189358e70915"><div class="ttname"><a href="error__code_8h.html#a486c1c6b307c5a60224c189358e70915">ER_LOG_PAGE_CORRUPTED</a></div><div class="ttdeci">#define ER_LOG_PAGE_CORRUPTED</div><div class="ttdef"><b>Definition:</b> <a href="error__code_8h_source.html#l00136">error_code.h:136</a></div></div>
<div class="ttc" id="dbtype__function_8h_html_ab664deb9d1dcfea0795267828ec424bb"><div class="ttname"><a href="dbtype__function_8h.html#ab664deb9d1dcfea0795267828ec424bb">db_make_bigint</a></div><div class="ttdeci">int db_make_bigint(DB_VALUE *value, const DB_BIGINT num)</div></div>
<div class="ttc" id="structlog__rec__mvcc__undo_html_afb6e7f17fc0d9cbb25f0d94e0bba4efd"><div class="ttname"><a href="structlog__rec__mvcc__undo.html#afb6e7f17fc0d9cbb25f0d94e0bba4efd">log_rec_mvcc_undo::vacuum_info</a></div><div class="ttdeci">LOG_VACUUM_INFO vacuum_info</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00702">log_impl.h:702</a></div></div>
<div class="ttc" id="structnodeptr_html"><div class="ttname"><a href="structnodeptr.html">nodeptr</a></div><div class="ttdef"><b>Definition:</b> <a href="external_2include_2queue_8h_source.html#l00029">queue.h:29</a></div></div>
<div class="ttc" id="log__impl_8h_html_a7790a20af76ed5282450723f2e09c4e2"><div class="ttname"><a href="log__impl_8h.html#a7790a20af76ed5282450723f2e09c4e2">LOGAREA_SIZE</a></div><div class="ttdeci">#define LOGAREA_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00857">log_impl.h:857</a></div></div>
<div class="ttc" id="structlog__tdes_html_a13da289398281e91e89ab374b3c17936"><div class="ttname"><a href="structlog__tdes.html#a13da289398281e91e89ab374b3c17936">log_tdes::coord</a></div><div class="ttdeci">LOG_2PC_COORDINATOR * coord</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01715">log_impl.h:1715</a></div></div>
<div class="ttc" id="structlog__rec__sysop__end_html_a34c029c46715b2edc97a8f2c5ce9d309"><div class="ttname"><a href="structlog__rec__sysop__end.html#a34c029c46715b2edc97a8f2c5ce9d309">log_rec_sysop_end::undo</a></div><div class="ttdeci">LOG_REC_UNDO undo</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01566">log_impl.h:1566</a></div></div>
<div class="ttc" id="log__impl_8h_html_aaa150f6c2ae6a1748640ab281ffd94f7a8fc57c015374d8ecf822c5ea0f39faa0"><div class="ttname"><a href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a8fc57c015374d8ecf822c5ea0f39faa0">LOG_SMALLER_LOGREC_TYPE</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00529">log_impl.h:529</a></div></div>
<div class="ttc" id="log__impl_8h_html_aaa150f6c2ae6a1748640ab281ffd94f7a76c06d374c551ca295e0594b74c9ff19"><div class="ttname"><a href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a76c06d374c551ca295e0594b74c9ff19">LOG_END_CHKPT</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00588">log_impl.h:588</a></div></div>
<div class="ttc" id="structlog__arv__header_html"><div class="ttname"><a href="structlog__arv__header.html">log_arv_header</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00412">log_impl.h:412</a></div></div>
<div class="ttc" id="structlog__rcv__tdes_html_a4b7c5dcb737ffa720f8981b314627080"><div class="ttname"><a href="structlog__rcv__tdes.html#a4b7c5dcb737ffa720f8981b314627080">log_rcv_tdes::sysop_start_postpone_lsa</a></div><div class="ttdeci">LOG_LSA sysop_start_postpone_lsa</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01676">log_impl.h:1676</a></div></div>
<div class="ttc" id="recovery_8h_html_a526c4dc065c989256afca8b3b56d4d2b"><div class="ttname"><a href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2b">LOG_RCVINDEX</a></div><div class="ttdeci">LOG_RCVINDEX</div><div class="ttdef"><b>Definition:</b> <a href="recovery_8h_source.html#l00036">recovery.h:36</a></div></div>
<div class="ttc" id="log__compress_8h_html_ac32e36fd25b171236ebb38a5be94d00c"><div class="ttname"><a href="log__compress_8h.html#ac32e36fd25b171236ebb38a5be94d00c">GET_ZIP_LEN</a></div><div class="ttdeci">#define GET_ZIP_LEN(length)</div><div class="ttdef"><b>Definition:</b> <a href="log__compress_8h_source.html#l00038">log_compress.h:38</a></div></div>
<div class="ttc" id="log__impl_8h_html_a0d3a513ea8174d22b361c70c7df970bc"><div class="ttname"><a href="log__impl_8h.html#a0d3a513ea8174d22b361c70c7df970bc">MSGCAT_LOG_FINISH_COMMIT</a></div><div class="ttdeci">#define MSGCAT_LOG_FINISH_COMMIT</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00101">log_impl.h:101</a></div></div>
<div class="ttc" id="src_2base_2rb__tree_8h_html_a5b9861a8925c953340e483ae0a0f5120"><div class="ttname"><a href="src_2base_2rb__tree_8h.html#a5b9861a8925c953340e483ae0a0f5120">RB_INSERT</a></div><div class="ttdeci">#define RB_INSERT(name, x, y)</div><div class="ttdef"><b>Definition:</b> <a href="src_2base_2rb__tree_8h_source.html#l00466">rb_tree.h:466</a></div></div>
<div class="ttc" id="log__manager_8c_html_ab54a94101ceaa616e6aafc64eba28387"><div class="ttname"><a href="log__manager_8c.html#ab54a94101ceaa616e6aafc64eba28387">log_get_append_lsa</a></div><div class="ttdeci">LOG_LSA * log_get_append_lsa(void)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l00604">log_manager.c:604</a></div></div>
<div class="ttc" id="log__impl_8h_html_afcfc70a06711e89b04a4cbd09ecba5d1"><div class="ttname"><a href="log__impl_8h.html#afcfc70a06711e89b04a4cbd09ecba5d1">LOG_FIND_TRAN_LOWEST_ACTIVE_MVCCID</a></div><div class="ttdeci">#define LOG_FIND_TRAN_LOWEST_ACTIVE_MVCCID(tran_index)</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00949">log_impl.h:949</a></div></div>
<div class="ttc" id="storage__common_8h_html_a59c6d5d7e74688bc33d6f35bf6aff46b"><div class="ttname"><a href="storage__common_8h.html#a59c6d5d7e74688bc33d6f35bf6aff46b">CUBRID_MAGIC_LOG_ACTIVE</a></div><div class="ttdeci">#define CUBRID_MAGIC_LOG_ACTIVE</div><div class="ttdef"><b>Definition:</b> <a href="storage__common_8h_source.html#l00596">storage_common.h:596</a></div></div>
<div class="ttc" id="log__manager_8c_html_ae26c12c22d460e7b63ac626074a4cf4c"><div class="ttname"><a href="log__manager_8c.html#ae26c12c22d460e7b63ac626074a4cf4c">log_sysop_start_atomic</a></div><div class="ttdeci">void log_sysop_start_atomic(THREAD_ENTRY *thread_p)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l03710">log_manager.c:3710</a></div></div>
<div class="ttc" id="storage__common_8h_html_a4dd9bcee89c0dcf1d0334b737cc51e9a"><div class="ttname"><a href="storage__common_8h.html#a4dd9bcee89c0dcf1d0334b737cc51e9a">DISK_VOLPURPOSE</a></div><div class="ttdeci">#define DISK_VOLPURPOSE</div><div class="ttdef"><b>Definition:</b> <a href="storage__common_8h_source.html#l00453">storage_common.h:453</a></div></div>
<div class="ttc" id="log__manager_8c_html_a63b25dae7a31d1ae590d85983af195da"><div class="ttname"><a href="log__manager_8c.html#a63b25dae7a31d1ae590d85983af195da">log_rv_dump_hexa</a></div><div class="ttdeci">void log_rv_dump_hexa(FILE *fp, int length, void *data)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l09393">log_manager.c:9393</a></div></div>
<div class="ttc" id="error__code_8h_html_a51778caf175b7d6bfe9e8977d9a0032e"><div class="ttname"><a href="error__code_8h.html#a51778caf175b7d6bfe9e8977d9a0032e">ER_FAILED</a></div><div class="ttdeci">#define ER_FAILED</div><div class="ttdef"><b>Definition:</b> <a href="error__code_8h_source.html#l00043">error_code.h:43</a></div></div>
<div class="ttc" id="recovery_8h_html_a6d691036d814022c71635238f2e411cb"><div class="ttname"><a href="recovery_8h.html#a6d691036d814022c71635238f2e411cb">RCV_IS_LOGICAL_LOG</a></div><div class="ttdeci">#define RCV_IS_LOGICAL_LOG(vpid, idx)</div><div class="ttdef"><b>Definition:</b> <a href="recovery_8h_source.html#l00243">recovery.h:243</a></div></div>
<div class="ttc" id="structlog__rec__mvcc__redo_html_ad04bef79ce810fc1e84eca618217baa5"><div class="ttname"><a href="structlog__rec__mvcc__redo.html#ad04bef79ce810fc1e84eca618217baa5">log_rec_mvcc_redo::redo</a></div><div class="ttdeci">LOG_REC_REDO redo</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00709">log_impl.h:709</a></div></div>
<div class="ttc" id="storage__common_8h_html_a9be5638788c6f0e3cfb4bbcdf5abb342"><div class="ttname"><a href="storage__common_8h.html#a9be5638788c6f0e3cfb4bbcdf5abb342">CUBRID_MAGIC_LOG_ARCHIVE</a></div><div class="ttdeci">#define CUBRID_MAGIC_LOG_ARCHIVE</div><div class="ttdef"><b>Definition:</b> <a href="storage__common_8h_source.html#l00597">storage_common.h:597</a></div></div>
<div class="ttc" id="boot__sr_8h_html"><div class="ttname"><a href="boot__sr_8h.html">boot_sr.h</a></div></div>
<div class="ttc" id="partition__sr_8h_html"><div class="ttname"><a href="partition__sr_8h.html">partition_sr.h</a></div></div>
<div class="ttc" id="fault__injection_8h_html_ad69d24ac236045dc719cbc6ea7b8bc77a565657e5d315f713ea6a2c2e6135ccd5"><div class="ttname"><a href="fault__injection_8h.html#ad69d24ac236045dc719cbc6ea7b8bc77a565657e5d315f713ea6a2c2e6135ccd5">FI_TEST_LOG_MANAGER_RANDOM_EXIT_AT_RUN_POSTPONE</a></div><div class="ttdef"><b>Definition:</b> <a href="fault__injection_8h_source.html#l00078">fault_injection.h:78</a></div></div>
<div class="ttc" id="log__manager_8c_html_a90c9718c441f1c4a8c37c48542494fab"><div class="ttname"><a href="log__manager_8c.html#a90c9718c441f1c4a8c37c48542494fab">log_get_eof_lsa</a></div><div class="ttdeci">LOG_LSA * log_get_eof_lsa(void)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l00617">log_manager.c:617</a></div></div>
<div class="ttc" id="structlog__global_html_a1f07a6d04e0467ece5bf1a871016d4bd"><div class="ttname"><a href="structlog__global.html#a1f07a6d04e0467ece5bf1a871016d4bd">log_global::hdr</a></div><div class="ttdeci">LOG_HEADER hdr</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01941">log_impl.h:1941</a></div></div>
<div class="ttc" id="vacuum_8h_html_a85a0ab6d41bb8ef710931f6dba63d611aa6dd4742f38124c2af51869d50e6c040"><div class="ttname"><a href="vacuum_8h.html#a85a0ab6d41bb8ef710931f6dba63d611aa6dd4742f38124c2af51869d50e6c040">VACUUM_WORKER_STATE_EXECUTE</a></div><div class="ttdef"><b>Definition:</b> <a href="vacuum_8h_source.html#l00087">vacuum.h:87</a></div></div>
<div class="ttc" id="query__manager_8h_html"><div class="ttname"><a href="query__manager_8h.html">query_manager.h</a></div></div>
<div class="ttc" id="cnv_8c_html_a83e607dce0b97d9c195023d606869f5c"><div class="ttname"><a href="cnv_8c.html#a83e607dce0b97d9c195023d606869f5c">csect_enter</a></div><div class="ttdeci">#define csect_enter(a, b, c)</div><div class="ttdef"><b>Definition:</b> <a href="cnv_8c_source.html#l00138">cnv.c:138</a></div></div>
<div class="ttc" id="log__impl_8h_html_a04538e7143a5fb7ccadf92186efc74db"><div class="ttname"><a href="log__impl_8h.html#a04538e7143a5fb7ccadf92186efc74db">prior_lsa_alloc_and_copy_crumbs</a></div><div class="ttdeci">LOG_PRIOR_NODE * prior_lsa_alloc_and_copy_crumbs(THREAD_ENTRY *thread_p, LOG_RECTYPE rec_type, LOG_RCVINDEX rcvindex, LOG_DATA_ADDR *addr, const int num_ucrumbs, const LOG_CRUMB *ucrumbs, const int num_rcrumbs, const LOG_CRUMB *rcrumbs)</div><div class="ttdef"><b>Definition:</b> <a href="log__page__buffer_8c_source.html#l03771">log_page_buffer.c:3771</a></div></div>
<div class="ttc" id="storage__common_8h_html_a65e269153dcbaf685a77e98b007b6a19"><div class="ttname"><a href="storage__common_8h.html#a65e269153dcbaf685a77e98b007b6a19">NULL_TRANID</a></div><div class="ttdeci">#define NULL_TRANID</div><div class="ttdef"><b>Definition:</b> <a href="storage__common_8h_source.html#l00459">storage_common.h:459</a></div></div>
<div class="ttc" id="log__impl_8h_html_a24797b2fe67e0ec8631d7a92fbef25c9a9530c67a9b21ab7a54d7c906f900a247"><div class="ttname"><a href="log__impl_8h.html#a24797b2fe67e0ec8631d7a92fbef25c9a9530c67a9b21ab7a54d7c906f900a247">LOG_SYSOP_END_ABORT</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01542">log_impl.h:1542</a></div></div>
<div class="ttc" id="perf__monitor_8h_html_a165b76d14ae9e30731ed3ca4cf856903afea83068933c6e6230b2300f3a5f19ab"><div class="ttname"><a href="perf__monitor_8h.html#a165b76d14ae9e30731ed3ca4cf856903afea83068933c6e6230b2300f3a5f19ab">PSTAT_TRAN_NUM_COMMITS</a></div><div class="ttdef"><b>Definition:</b> <a href="perf__monitor_8h_source.html#l00323">perf_monitor.h:323</a></div></div>
<div class="ttc" id="file__io_8c_html_a27724bf8b48796a8b30252cef51d9910"><div class="ttname"><a href="file__io_8c.html#a27724bf8b48796a8b30252cef51d9910">fileio_find_next_perm_volume</a></div><div class="ttdeci">VOLID fileio_find_next_perm_volume(THREAD_ENTRY *thread_p, VOLID volid)</div><div class="ttdef"><b>Definition:</b> <a href="file__io_8c_source.html#l06318">file_io.c:6318</a></div></div>
<div class="ttc" id="log__impl_8h_html_aaa150f6c2ae6a1748640ab281ffd94f7a6b03dd6d350881f805f7b3adeedcf10f"><div class="ttname"><a href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a6b03dd6d350881f805f7b3adeedcf10f">LOG_COMMIT_WITH_POSTPONE</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00549">log_impl.h:549</a></div></div>
<div class="ttc" id="structbo__restart__arg_html_afdb3d6eda54cdc30cd8beea186dc5957"><div class="ttname"><a href="structbo__restart__arg.html#afdb3d6eda54cdc30cd8beea186dc5957">bo_restart_arg::stopat</a></div><div class="ttdeci">time_t stopat</div><div class="ttdef"><b>Definition:</b> <a href="storage__common_8h_source.html#l00578">storage_common.h:578</a></div></div>
<div class="ttc" id="structlog__tdes_html_a27e8d1fddf3a2b68196b2c02a5318a21"><div class="ttname"><a href="structlog__tdes.html#a27e8d1fddf3a2b68196b2c02a5318a21">log_tdes::topop_lsa</a></div><div class="ttdeci">LOG_LSA topop_lsa</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01705">log_impl.h:1705</a></div></div>
<div class="ttc" id="structlog__page_html_a52640d2c65b2d7b95a330a670646e8f9"><div class="ttname"><a href="structlog__page.html#a52640d2c65b2d7b95a330a670646e8f9">log_page::hdr</a></div><div class="ttdeci">LOG_HDRPAGE hdr</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00145">log_impl.h:145</a></div></div>
<div class="ttc" id="log__impl_8h_html_a395681f78c8d3aa0e26c7132fb05e0df"><div class="ttname"><a href="log__impl_8h.html#a395681f78c8d3aa0e26c7132fb05e0df">logpb_flush_page</a></div><div class="ttdeci">int logpb_flush_page(THREAD_ENTRY *thread_p, LOG_PAGE *log_pgptr)</div><div class="ttdef"><b>Definition:</b> <a href="log__page__buffer_8c_source.html#l01165">log_page_buffer.c:1165</a></div></div>
<div class="ttc" id="log__impl_8h_html_a44eb784dcaf09b76943d76ad06af5832"><div class="ttname"><a href="log__impl_8h.html#a44eb784dcaf09b76943d76ad06af5832">logpb_background_archiving</a></div><div class="ttdeci">int logpb_background_archiving(THREAD_ENTRY *thread_p)</div><div class="ttdef"><b>Definition:</b> <a href="log__page__buffer_8c_source.html#l11764">log_page_buffer.c:11764</a></div></div>
<div class="ttc" id="log__impl_8h_html_ab33fe5f69028f102e9910294e97ccd6babc4379db94a7ff5ff8491988a7c28bc1"><div class="ttname"><a href="log__impl_8h.html#ab33fe5f69028f102e9910294e97ccd6babc4379db94a7ff5ff8491988a7c28bc1">LOG_CS_FORCE_USE</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l02047">log_impl.h:2047</a></div></div>
<div class="ttc" id="log__manager_8c_html_a0b5c9a920835f24684e8d027792c0539"><div class="ttname"><a href="log__manager_8c.html#a0b5c9a920835f24684e8d027792c0539">log_set_no_logging</a></div><div class="ttdeci">int log_set_no_logging(void)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l00996">log_manager.c:996</a></div></div>
<div class="ttc" id="page__buffer_8h_html_a3bfa0f717b33e17651fff6daf57637ce"><div class="ttname"><a href="page__buffer_8h.html#a3bfa0f717b33e17651fff6daf57637ce">pgbuf_unfix</a></div><div class="ttdeci">#define pgbuf_unfix(thread_p, pgptr)</div><div class="ttdef"><b>Definition:</b> <a href="page__buffer_8h_source.html#l00267">page_buffer.h:267</a></div></div>
<div class="ttc" id="recovery_8h_html_a526c4dc065c989256afca8b3b56d4d2ba44bda7714c3d5eeb33154a5bbd45b86e"><div class="ttname"><a href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2ba44bda7714c3d5eeb33154a5bbd45b86e">RVBT_MVCC_INCREMENTS_UPD</a></div><div class="ttdef"><b>Definition:</b> <a href="recovery_8h_source.html#l00126">recovery.h:126</a></div></div>
<div class="ttc" id="structlog__rec__sysop__end_html_a972f4330fb7cee921ad0dd2dbd6677ae"><div class="ttname"><a href="structlog__rec__sysop__end.html#a972f4330fb7cee921ad0dd2dbd6677ae">log_rec_sysop_end::run_postpone</a></div><div class="ttdeci">struct log_rec_sysop_end::@228::@230 run_postpone</div></div>
<div class="ttc" id="structlog__rec__header_html_ab88354b51f9cabaaace23420eec7ac7e"><div class="ttname"><a href="structlog__rec__header.html#ab88354b51f9cabaaace23420eec7ac7e">log_rec_header::forw_lsa</a></div><div class="ttdeci">LOG_LSA forw_lsa</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00637">log_impl.h:637</a></div></div>
<div class="ttc" id="structlog__rec__chkpt_html"><div class="ttname"><a href="structlog__rec__chkpt.html">log_rec_chkpt</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01597">log_impl.h:1597</a></div></div>
<div class="ttc" id="error__code_8h_html_a1029f54d1ce04fb5a6a02ab458663ec6"><div class="ttname"><a href="error__code_8h.html#a1029f54d1ce04fb5a6a02ab458663ec6">ER_LOG_HAS_TOPOPS_DURING_COMMIT_ABORT</a></div><div class="ttdeci">#define ER_LOG_HAS_TOPOPS_DURING_COMMIT_ABORT</div><div class="ttdef"><b>Definition:</b> <a href="error__code_8h_source.html#l00772">error_code.h:772</a></div></div>
<div class="ttc" id="structlog__topops__addresses_html_a94da18d9054fe91a3b114b4262301737"><div class="ttname"><a href="structlog__topops__addresses.html#a94da18d9054fe91a3b114b4262301737">log_topops_addresses::posp_lsa</a></div><div class="ttdeci">LOG_LSA posp_lsa</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01273">log_impl.h:1273</a></div></div>
<div class="ttc" id="structlog__rec__header_html_a40f61f4c609c77826f4d5dd3482f3a38"><div class="ttname"><a href="structlog__rec__header.html#a40f61f4c609c77826f4d5dd3482f3a38">log_rec_header::prev_tranlsa</a></div><div class="ttdeci">LOG_LSA prev_tranlsa</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00635">log_impl.h:635</a></div></div>
<div class="ttc" id="log__impl_8h_html_a850b8bbb60976a9cbd23dab38dcf1767"><div class="ttname"><a href="log__impl_8h.html#a850b8bbb60976a9cbd23dab38dcf1767">xlogtb_dump_trantable</a></div><div class="ttdeci">void xlogtb_dump_trantable(THREAD_ENTRY *thread_p, FILE *out_fp)</div><div class="ttdef"><b>Definition:</b> <a href="log__tran__table_8c_source.html#l01725">log_tran_table.c:1725</a></div></div>
<div class="ttc" id="log__impl_8h_html_aaa150f6c2ae6a1748640ab281ffd94f7a3839799b1d15f4333e439c136a3a21ca"><div class="ttname"><a href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a3839799b1d15f4333e439c136a3a21ca">LOG_SYSOP_ATOMIC_START</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00621">log_impl.h:621</a></div></div>
<div class="ttc" id="log__global_8c_html_a386a5ea4cd7829b9dd7565ac856da927"><div class="ttname"><a href="log__global_8c.html#a386a5ea4cd7829b9dd7565ac856da927">log_Gl</a></div><div class="ttdeci">LOG_GLOBAL log_Gl</div><div class="ttdef"><b>Definition:</b> <a href="log__global_8c_source.html#l00043">log_global.c:43</a></div></div>
<div class="ttc" id="log__impl_8h_html_a2c4c459f1e7836725bc9a7ff4cbba64e"><div class="ttname"><a href="log__impl_8h.html#a2c4c459f1e7836725bc9a7ff4cbba64e">MSGCAT_LOG_LOGINFO_ACTIVE</a></div><div class="ttdeci">#define MSGCAT_LOG_LOGINFO_ACTIVE</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00100">log_impl.h:100</a></div></div>
<div class="ttc" id="structlog__lsa_html"><div class="ttname"><a href="structlog__lsa.html">log_lsa</a></div><div class="ttdef"><b>Definition:</b> <a href="storage__common_8h_source.html#l00103">storage_common.h:103</a></div></div>
<div class="ttc" id="log__manager_8c_html_a8d551fdad2195f69634062351625e395"><div class="ttname"><a href="log__manager_8c.html#a8d551fdad2195f69634062351625e395">log_execute_run_postpone</a></div><div class="ttdeci">int log_execute_run_postpone(THREAD_ENTRY *thread_p, LOG_LSA *log_lsa, LOG_REC_REDO *redo, char *redo_rcv_data)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l08872">log_manager.c:8872</a></div></div>
<div class="ttc" id="log__impl_8h_html_a644a0b1dcc4cd9fb30d50f076becdcae"><div class="ttname"><a href="log__impl_8h.html#a644a0b1dcc4cd9fb30d50f076becdcae">LOG_SYSTEM_TRAN_INDEX</a></div><div class="ttdeci">#define LOG_SYSTEM_TRAN_INDEX</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00767">log_impl.h:767</a></div></div>
<div class="ttc" id="log__manager_8c_html_a710b4ca5cba1f04821a8bd736e64b485"><div class="ttname"><a href="log__manager_8c.html#a710b4ca5cba1f04821a8bd736e64b485">log_skip_logging_set_lsa</a></div><div class="ttdeci">void log_skip_logging_set_lsa(THREAD_ENTRY *thread_p, LOG_DATA_ADDR *addr)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l03228">log_manager.c:3228</a></div></div>
<div class="ttc" id="thread__manager_8hpp_html_ac617fc70870fb0af15f7eb889c856e2d"><div class="ttname"><a href="thread__manager_8hpp.html#ac617fc70870fb0af15f7eb889c856e2d">thread_sleep</a></div><div class="ttdeci">void thread_sleep(double millisec)</div><div class="ttdef"><b>Definition:</b> <a href="thread__manager_8hpp_source.html#l00424">thread_manager.hpp:424</a></div></div>
<div class="ttc" id="structlog__rec__2pc__prepcommit_html_acc5535d8ddf82b6e57b4e2c877f5df3b"><div class="ttname"><a href="structlog__rec__2pc__prepcommit.html#acc5535d8ddf82b6e57b4e2c877f5df3b">log_rec_2pc_prepcommit::user_name</a></div><div class="ttdeci">char user_name[DB_MAX_USER_LENGTH+1]</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01642">log_impl.h:1642</a></div></div>
<div class="ttc" id="log__impl_8h_html_a6c5edebbae75e1a92360baf780ce8377"><div class="ttname"><a href="log__impl_8h.html#a6c5edebbae75e1a92360baf780ce8377">logtb_clear_tdes</a></div><div class="ttdeci">void logtb_clear_tdes(THREAD_ENTRY *thread_p, LOG_TDES *tdes)</div><div class="ttdef"><b>Definition:</b> <a href="log__tran__table_8c_source.html#l01834">log_tran_table.c:1834</a></div></div>
<div class="ttc" id="error__code_8h_html_a525962e6b4784dd775c34b2a7fdffcc5"><div class="ttname"><a href="error__code_8h.html#a525962e6b4784dd775c34b2a7fdffcc5">ER_LOG_POSTPONE_INTERFACE</a></div><div class="ttdeci">#define ER_LOG_POSTPONE_INTERFACE</div><div class="ttdef"><b>Definition:</b> <a href="error__code_8h_source.html#l00146">error_code.h:146</a></div></div>
<div class="ttc" id="log__impl_8h_html_aad53b9bfa046f25c2c4bd187223ecf85"><div class="ttname"><a href="log__impl_8h.html#aad53b9bfa046f25c2c4bd187223ecf85">LOG_WRITE_EOT_LOG</a></div><div class="ttdeci">enum log_wrote_eot_log LOG_WRITE_EOT_LOG</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01089">log_impl.h:1089</a></div></div>
<div class="ttc" id="structlog__rec__dbout__redo_html_aece481275dfdf407eea3e15acc97c0f9"><div class="ttname"><a href="structlog__rec__dbout__redo.html#aece481275dfdf407eea3e15acc97c0f9">log_rec_dbout_redo::length</a></div><div class="ttdeci">int length</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01519">log_impl.h:1519</a></div></div>
<div class="ttc" id="structlog__arv__header_html_a6c89cb36b280741ee7a56f563304fefc"><div class="ttname"><a href="structlog__arv__header.html#a6c89cb36b280741ee7a56f563304fefc">log_arv_header::arv_num</a></div><div class="ttdeci">int arv_num</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00421">log_impl.h:421</a></div></div>
<div class="ttc" id="log__impl_8h_html_ae07522b7703365448895621aa8f48335"><div class="ttname"><a href="log__impl_8h.html#ae07522b7703365448895621aa8f48335">LOGPB_HEADER_PAGE_ID</a></div><div class="ttdeci">#define LOGPB_HEADER_PAGE_ID</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00077">log_impl.h:77</a></div></div>
<div class="ttc" id="structlog__global_html_afdcd3ed7bb720aba887367ea88800c69"><div class="ttname"><a href="structlog__global.html#afdcd3ed7bb720aba887367ea88800c69">log_global::loghdr_pgptr</a></div><div class="ttdeci">LOG_PAGE * loghdr_pgptr</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01960">log_impl.h:1960</a></div></div>
<div class="ttc" id="classcubthread_1_1daemon_html_a2fc7761797afb57a0768080a89b07154"><div class="ttname"><a href="classcubthread_1_1daemon.html#a2fc7761797afb57a0768080a89b07154">cubthread::daemon::get_stats</a></div><div class="ttdeci">void get_stats(cubperf::stat_value *stats_out)</div><div class="ttdef"><b>Definition:</b> <a href="thread__daemon_8cpp_source.html#l00119">thread_daemon.cpp:119</a></div></div>
<div class="ttc" id="recovery_8h_html_a526c4dc065c989256afca8b3b56d4d2baba87dd0eef27f1deff3c187b554068f2"><div class="ttname"><a href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2baba87dd0eef27f1deff3c187b554068f2">RVBT_MVCC_NOTIFY_VACUUM</a></div><div class="ttdef"><b>Definition:</b> <a href="recovery_8h_source.html#l00127">recovery.h:127</a></div></div>
<div class="ttc" id="error__manager_8h_html_a34b88b0e828e26dd5cf930a0b1dd57a7"><div class="ttname"><a href="error__manager_8h.html#a34b88b0e828e26dd5cf930a0b1dd57a7">assert_release</a></div><div class="ttdeci">#define assert_release(e)</div><div class="ttdef"><b>Definition:</b> <a href="error__manager_8h_source.html#l00097">error_manager.h:97</a></div></div>
<div class="ttc" id="recovery_8h_html_a526c4dc065c989256afca8b3b56d4d2ba7278715d46550803f5e85a7e5ea42984"><div class="ttname"><a href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2ba7278715d46550803f5e85a7e5ea42984">RVREPL_DATA_UPDATE</a></div><div class="ttdef"><b>Definition:</b> <a href="recovery_8h_source.html#l00150">recovery.h:150</a></div></div>
<div class="ttc" id="structmodified__class__entry_html_ad721351a182c9e8df087382283d495c7"><div class="ttname"><a href="structmodified__class__entry.html#ad721351a182c9e8df087382283d495c7">modified_class_entry::m_class_oid</a></div><div class="ttdeci">OID m_class_oid</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01299">log_impl.h:1299</a></div></div>
<div class="ttc" id="structlog__tdes_html_a0c486814dae3bd754b76014a91051f32"><div class="ttname"><a href="structlog__tdes.html#a0c486814dae3bd754b76014a91051f32">log_tdes::max_unique_btrees</a></div><div class="ttdeci">int max_unique_btrees</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01719">log_impl.h:1719</a></div></div>
<div class="ttc" id="release__string_8h_html_ac57c963a6d505d37dd3989a52edf6299"><div class="ttname"><a href="release__string_8h.html#ac57c963a6d505d37dd3989a52edf6299">REL_MAX_RELEASE_LENGTH</a></div><div class="ttdeci">#define REL_MAX_RELEASE_LENGTH</div><div class="ttdef"><b>Definition:</b> <a href="release__string_8h_source.html#l00032">release_string.h:32</a></div></div>
<div class="ttc" id="page__buffer_8h_html"><div class="ttname"><a href="page__buffer_8h.html">page_buffer.h</a></div></div>
<div class="ttc" id="page__buffer_8c_html_a09e2ab7104c4384bafcd3cf693a49719"><div class="ttname"><a href="page__buffer_8c.html#a09e2ab7104c4384bafcd3cf693a49719">pgbuf_set_dirty</a></div><div class="ttdeci">void pgbuf_set_dirty(THREAD_ENTRY *thread_p, PAGE_PTR pgptr, bool free_page)</div><div class="ttdef"><b>Definition:</b> <a href="page__buffer_8c_source.html#l04322">page_buffer.c:4322</a></div></div>
<div class="ttc" id="log__impl_8h_html_a2d9876809ffa8473b6b47c5edcff6ca2"><div class="ttname"><a href="log__impl_8h.html#a2d9876809ffa8473b6b47c5edcff6ca2">LOG_CHECK_LOG_APPLIER</a></div><div class="ttdeci">#define LOG_CHECK_LOG_APPLIER(thread_p)</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01038">log_impl.h:1038</a></div></div>
<div class="ttc" id="log__manager_8c_html_ae1eeb2b0f7ebd757e323a4a866b4edc9"><div class="ttname"><a href="log__manager_8c.html#ae1eeb2b0f7ebd757e323a4a866b4edc9">log_get_restart_lsa</a></div><div class="ttdeci">LOG_LSA * log_get_restart_lsa(void)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l00560">log_manager.c:560</a></div></div>
<div class="ttc" id="log__manager_8c_html_aae543993eb8d25f8467ca12ae4e92363"><div class="ttname"><a href="log__manager_8c.html#aae543993eb8d25f8467ca12ae4e92363">log_get_clock_msec</a></div><div class="ttdeci">INT64 log_get_clock_msec(void)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l10809">log_manager.c:10809</a></div></div>
<div class="ttc" id="vacuum_8h_html_ab0e1deb8da1aa663aa073b0ce78606a2"><div class="ttname"><a href="vacuum_8h.html#ab0e1deb8da1aa663aa073b0ce78606a2">VACUUM_IS_THREAD_VACUUM</a></div><div class="ttdeci">#define VACUUM_IS_THREAD_VACUUM</div><div class="ttdef"><b>Definition:</b> <a href="vacuum_8h_source.html#l00275">vacuum.h:275</a></div></div>
<div class="ttc" id="page__buffer_8c_html_a68c72a9eaad187a1b53344a25905e2fc"><div class="ttname"><a href="page__buffer_8c.html#a68c72a9eaad187a1b53344a25905e2fc">pgbuf_notify_vacuum_follows</a></div><div class="ttdeci">void pgbuf_notify_vacuum_follows(THREAD_ENTRY *thread_p, PAGE_PTR page)</div><div class="ttdef"><b>Definition:</b> <a href="page__buffer_8c_source.html#l15189">page_buffer.c:15189</a></div></div>
<div class="ttc" id="log__impl_8h_html_a2ecd65770a4af1c8d61a8611e0177157"><div class="ttname"><a href="log__impl_8h.html#a2ecd65770a4af1c8d61a8611e0177157">logpb_add_volume</a></div><div class="ttdeci">VOLID logpb_add_volume(const char *db_fullname, VOLID new_volid, const char *new_volfullname, DISK_VOLPURPOSE new_volpurpose)</div><div class="ttdef"><b>Definition:</b> <a href="log__page__buffer_8c_source.html#l06028">log_page_buffer.c:6028</a></div></div>
<div class="ttc" id="dbtype__def_8h_html_a363125e989d56ec5b9f89f39a743c018"><div class="ttname"><a href="dbtype__def_8h.html#a363125e989d56ec5b9f89f39a743c018">VFID_AS_ARGS</a></div><div class="ttdeci">#define VFID_AS_ARGS(vfidp)</div><div class="ttdef"><b>Definition:</b> <a href="dbtype__def_8h_source.html#l00917">dbtype_def.h:917</a></div></div>
<div class="ttc" id="log__manager_8c_html_a34b6f583b3036cd74a105b48d8f4be6d"><div class="ttname"><a href="log__manager_8c.html#a34b6f583b3036cd74a105b48d8f4be6d">log_append_undo_data2</a></div><div class="ttdeci">void log_append_undo_data2(THREAD_ENTRY *thread_p, LOG_RCVINDEX rcvindex, const VFID *vfid, PAGE_PTR pgptr, PGLENGTH offset, int length, const void *data)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l01963">log_manager.c:1963</a></div></div>
<div class="ttc" id="error__code_8h_html_a5cdf624077306151c8e1e79fe224b83f"><div class="ttname"><a href="error__code_8h.html#a5cdf624077306151c8e1e79fe224b83f">ER_LOG_THEREARE_PENDING_ACTIONS_MUST_LOG</a></div><div class="ttdeci">#define ER_LOG_THEREARE_PENDING_ACTIONS_MUST_LOG</div><div class="ttdef"><b>Definition:</b> <a href="error__code_8h_source.html#l00728">error_code.h:728</a></div></div>
<div class="ttc" id="storage__common_8h_html_a0da39ba47abe69bdc4cf837e4890d7ab"><div class="ttname"><a href="storage__common_8h.html#a0da39ba47abe69bdc4cf837e4890d7ab">VOLID</a></div><div class="ttdeci">INT16 VOLID</div><div class="ttdef"><b>Definition:</b> <a href="storage__common_8h_source.html#l00082">storage_common.h:82</a></div></div>
<div class="ttc" id="storage__common_8h_html_afd0bb266f6811f0eef1f13a2d4a2d175"><div class="ttname"><a href="storage__common_8h.html#afd0bb266f6811f0eef1f13a2d4a2d175">MVCCID_NULL</a></div><div class="ttdeci">#define MVCCID_NULL</div><div class="ttdef"><b>Definition:</b> <a href="storage__common_8h_source.html#l00461">storage_common.h:461</a></div></div>
<div class="ttc" id="log__global_8c_html_aef1e7912abb0cade6fe0dd266292df20"><div class="ttname"><a href="log__global_8c.html#aef1e7912abb0cade6fe0dd266292df20">log_Name_active</a></div><div class="ttdeci">char log_Name_active[PATH_MAX]</div><div class="ttdef"><b>Definition:</b> <a href="log__global_8c_source.html#l00115">log_global.c:115</a></div></div>
<div class="ttc" id="log__manager_8c_html_acbc3a63215e8924ed23841fb2321cd78"><div class="ttname"><a href="log__manager_8c.html#acbc3a63215e8924ed23841fb2321cd78">log_sysop_start</a></div><div class="ttdeci">void log_sysop_start(THREAD_ENTRY *thread_p)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l03606">log_manager.c:3606</a></div></div>
<div class="ttc" id="structlog__crumb_html_a27fa2f547d67332b369d31002bd7ea75"><div class="ttname"><a href="structlog__crumb.html#a27fa2f547d67332b369d31002bd7ea75">log_crumb::length</a></div><div class="ttdeci">int length</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01808">log_impl.h:1808</a></div></div>
<div class="ttc" id="log__impl_8h_html_af7b3d3d0155756e96ceaaf24df4b1bb6"><div class="ttname"><a href="log__impl_8h.html#af7b3d3d0155756e96ceaaf24df4b1bb6">MSGCAT_LOG_FINISH_ABORT</a></div><div class="ttdeci">#define MSGCAT_LOG_FINISH_ABORT</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00102">log_impl.h:102</a></div></div>
<div class="ttc" id="structlog__logging__stat_html_a38ace8b59ae1ca20fec2e0d648834d5a"><div class="ttname"><a href="structlog__logging__stat.html#a38ace8b59ae1ca20fec2e0d648834d5a">log_logging_stat::commit_count</a></div><div class="ttdeci">unsigned long commit_count</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l02016">log_impl.h:2016</a></div></div>
<div class="ttc" id="log__manager_8c_html_af70d0e6ef6233c296087a8a4c7b26843"><div class="ttname"><a href="log__manager_8c.html#af70d0e6ef6233c296087a8a4c7b26843">xlog_dump</a></div><div class="ttdeci">void xlog_dump(THREAD_ENTRY *thread_p, FILE *out_fp, int isforward, LOG_PAGEID start_logpageid, DKNPAGES dump_npages, TRANID desired_tranid)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l07424">log_manager.c:7424</a></div></div>
<div class="ttc" id="recovery_8h_html_a526c4dc065c989256afca8b3b56d4d2babafc7610a68e7852f0293731f9b004a5"><div class="ttname"><a href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2babafc7610a68e7852f0293731f9b004a5">RVHF_MVCC_INSERT</a></div><div class="ttdef"><b>Definition:</b> <a href="recovery_8h_source.html#l00088">recovery.h:88</a></div></div>
<div class="ttc" id="log__manager_8c_html_a0bff5e1b57f5aa9e8dceb0b5e34ca1e2"><div class="ttname"><a href="log__manager_8c.html#a0bff5e1b57f5aa9e8dceb0b5e34ca1e2">xlog_add_lob_locator</a></div><div class="ttdeci">int xlog_add_lob_locator(THREAD_ENTRY *thread_p, const char *locator, LOB_LOCATOR_STATE state)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l05114">log_manager.c:5114</a></div></div>
<div class="ttc" id="structlog__data_html_ad5635159b85ee07322bf30e39a5dee76"><div class="ttname"><a href="structlog__data.html#ad5635159b85ee07322bf30e39a5dee76">log_data::volid</a></div><div class="ttdeci">VOLID volid</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00649">log_impl.h:649</a></div></div>
<div class="ttc" id="vacuum_8h_html_a6a1dc228ca433bf85d100084b318153f"><div class="ttname"><a href="vacuum_8h.html#a6a1dc228ca433bf85d100084b318153f">vacuum_worker_state_is_topop</a></div><div class="ttdeci">STATIC_INLINE bool vacuum_worker_state_is_topop(THREAD_ENTRY *thread_p) __attribute__((ALWAYS_INLINE))</div><div class="ttdef"><b>Definition:</b> <a href="vacuum_8h_source.html#l00256">vacuum.h:256</a></div></div>
<div class="ttc" id="structlog__tdes_html_a5b128a08476a5b499cf82e3163e6d62b"><div class="ttname"><a href="structlog__tdes.html#a5b128a08476a5b499cf82e3163e6d62b">log_tdes::tail_lsa</a></div><div class="ttdeci">LOG_LSA tail_lsa</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01699">log_impl.h:1699</a></div></div>
<div class="ttc" id="system__parameter_8h_html_a23aaf6bca406b9b428f43ad1b6b2b3e0a15ba2db908b5e054f48a2f74267fc92f"><div class="ttname"><a href="system__parameter_8h.html#a23aaf6bca406b9b428f43ad1b6b2b3e0a15ba2db908b5e054f48a2f74267fc92f">PRM_ID_LOG_CHECKPOINT_NPAGES</a></div><div class="ttdef"><b>Definition:</b> <a href="system__parameter_8h_source.html#l00125">system_parameter.h:125</a></div></div>
<div class="ttc" id="log__manager_8c_html_ab66f5229e5ed16479f13659587baef54"><div class="ttname"><a href="log__manager_8c.html#ab66f5229e5ed16479f13659587baef54">log_clear_lob_locator_list</a></div><div class="ttdeci">void log_clear_lob_locator_list(THREAD_ENTRY *thread_p, LOG_TDES *tdes, bool at_commit, LOG_LSA *savept_lsa)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l05343">log_manager.c:5343</a></div></div>
<div class="ttc" id="structlog__data__addr_html"><div class="ttname"><a href="structlog__data__addr.html">log_data_addr</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01837">log_impl.h:1837</a></div></div>
<div class="ttc" id="log__manager_8c_html_a0cb138cb6e789ecf8abb67698e42abd2"><div class="ttname"><a href="log__manager_8c.html#a0cb138cb6e789ecf8abb67698e42abd2">log_get_charset_from_header_page</a></div><div class="ttdeci">int log_get_charset_from_header_page(THREAD_ENTRY *thread_p, const char *db_fullname, const char *logpath, const char *prefix_logname)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l09304">log_manager.c:9304</a></div></div>
<div class="ttc" id="log__manager_8c_html_a184221af017af64f0a3bd7c96c3c83e7"><div class="ttname"><a href="log__manager_8c.html#a184221af017af64f0a3bd7c96c3c83e7">log_archive_log_header_start_scan</a></div><div class="ttdeci">int log_archive_log_header_start_scan(THREAD_ENTRY *thread_p, int show_type, DB_VALUE **arg_values, int arg_cnt, void **ptr)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l09835">log_manager.c:9835</a></div></div>
<div class="ttc" id="structlog__topop__range_html_a6b28d3117f59854fe142175bf94cb878"><div class="ttname"><a href="structlog__topop__range.html#a6b28d3117f59854fe142175bf94cb878">log_topop_range::end_lsa</a></div><div class="ttdeci">LOG_LSA end_lsa</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8h_source.html#l00053">log_manager.h:53</a></div></div>
<div class="ttc" id="file__io_8h_html_a1e52f91b8452ad233fce9196397ed45dae072dab0b3d0522ae0f199e9e931a2a8"><div class="ttname"><a href="file__io_8h.html#a1e52f91b8452ad233fce9196397ed45dae072dab0b3d0522ae0f199e9e931a2a8">FILEIO_BACKUP_BIG_INCREMENT_LEVEL</a></div><div class="ttdef"><b>Definition:</b> <a href="file__io_8h_source.html#l00091">file_io.h:91</a></div></div>
<div class="ttc" id="error__code_8h_html_a2212df4c388a4b5343567efe29fc7bfa"><div class="ttname"><a href="error__code_8h.html#a2212df4c388a4b5343567efe29fc7bfa">ER_LOG_MOUNT_FAIL</a></div><div class="ttdeci">#define ER_LOG_MOUNT_FAIL</div><div class="ttdef"><b>Definition:</b> <a href="error__code_8h_source.html#l00137">error_code.h:137</a></div></div>
<div class="ttc" id="structrecdes_html_a78fb3ee3142e50670d431d8f7c302b62"><div class="ttname"><a href="structrecdes.html#a78fb3ee3142e50670d431d8f7c302b62">recdes::data</a></div><div class="ttdeci">char * data</div><div class="ttdef"><b>Definition:</b> <a href="storage__common_8h_source.html#l00346">storage_common.h:346</a></div></div>
<div class="ttc" id="release__string_8h_html_a56d4a5f45afe109eadcb56d2d46dd1ac"><div class="ttname"><a href="release__string_8h.html#a56d4a5f45afe109eadcb56d2d46dd1ac">REL_FIXUP_FUNCTION</a></div><div class="ttdeci">void(* REL_FIXUP_FUNCTION)(void)</div><div class="ttdef"><b>Definition:</b> <a href="release__string_8h_source.html#l00041">release_string.h:41</a></div></div>
<div class="ttc" id="structlog__rec__compensate_html_a1cf8b84dd2777a88d87f1401c1799a2b"><div class="ttname"><a href="structlog__rec__compensate.html#a1cf8b84dd2777a88d87f1401c1799a2b">log_rec_compensate::data</a></div><div class="ttdeci">LOG_DATA data</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01526">log_impl.h:1526</a></div></div>
<div class="ttc" id="structlog__global_html_a1d49125845fa987161f4724c69317403"><div class="ttname"><a href="structlog__global.html#a1d49125845fa987161f4724c69317403">log_global::group_commit_info</a></div><div class="ttdeci">LOG_GROUP_COMMIT_INFO group_commit_info</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01966">log_impl.h:1966</a></div></div>
<div class="ttc" id="page__buffer_8h_html_aead1e6e920c3a36e36e755709754b381aa61503371245884e97d94da1460491c4"><div class="ttname"><a href="page__buffer_8h.html#aead1e6e920c3a36e36e755709754b381aa61503371245884e97d94da1460491c4">OLD_PAGE</a></div><div class="ttdef"><b>Definition:</b> <a href="page__buffer_8h_source.html#l00160">page_buffer.h:160</a></div></div>
<div class="ttc" id="page__buffer_8c_html_a05c13a976dabead4ff4483f000c03d71"><div class="ttname"><a href="page__buffer_8c.html#a05c13a976dabead4ff4483f000c03d71">pgbuf_flush_all_unfixed</a></div><div class="ttdeci">int pgbuf_flush_all_unfixed(THREAD_ENTRY *thread_p, VOLID volid)</div><div class="ttdef"><b>Definition:</b> <a href="page__buffer_8c_source.html#l03084">page_buffer.c:3084</a></div></div>
<div class="ttc" id="storage__common_8h_html_a7f9d98414f81d41e639e744027e15947"><div class="ttname"><a href="storage__common_8h.html#a7f9d98414f81d41e639e744027e15947">LSA_LE</a></div><div class="ttdeci">#define LSA_LE(lsa_ptr1, lsa_ptr2)</div><div class="ttdef"><b>Definition:</b> <a href="storage__common_8h_source.html#l00153">storage_common.h:153</a></div></div>
<div class="ttc" id="structlog__arv__header_html_a0055a1ebac6f2ed3e7b3b5129d6f31ab"><div class="ttname"><a href="structlog__arv__header.html#a0055a1ebac6f2ed3e7b3b5129d6f31ab">log_arv_header::fpageid</a></div><div class="ttdeci">LOG_PAGEID fpageid</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00420">log_impl.h:420</a></div></div>
<div class="ttc" id="structlog__rcv_html_a0ea812ae4a6bb0266f74937ed1f1632f"><div class="ttname"><a href="structlog__rcv.html#a0ea812ae4a6bb0266f74937ed1f1632f">log_rcv::mvcc_id</a></div><div class="ttdeci">MVCCID mvcc_id</div><div class="ttdef"><b>Definition:</b> <a href="recovery_8h_source.html#l00191">recovery.h:191</a></div></div>
<div class="ttc" id="log__impl_8h_html_a31cc6db6a89961d1f11c73edba048dc3"><div class="ttname"><a href="log__impl_8h.html#a31cc6db6a89961d1f11c73edba048dc3">logpb_create_volume_info</a></div><div class="ttdeci">int logpb_create_volume_info(const char *db_fullname)</div><div class="ttdef"><b>Definition:</b> <a href="log__page__buffer_8c_source.html#l05911">log_page_buffer.c:5911</a></div></div>
<div class="ttc" id="vacuum_8h_html_a086e1f02468f0051c19a0f8d66cad1be"><div class="ttname"><a href="vacuum_8h.html#a086e1f02468f0051c19a0f8d66cad1be">VACUUM_ER_LOG_TOPOPS</a></div><div class="ttdeci">#define VACUUM_ER_LOG_TOPOPS</div><div class="ttdef"><b>Definition:</b> <a href="vacuum_8h_source.html#l00054">vacuum.h:54</a></div></div>
<div class="ttc" id="log__manager_8c_html_addd42d55d5a83c58800380301cda3d0e"><div class="ttname"><a href="log__manager_8c.html#addd42d55d5a83c58800380301cda3d0e">RB_GENERATE_STATIC</a></div><div class="ttdeci">RB_GENERATE_STATIC(lob_rb_root, lob_locator_entry, head, lob_locator_cmp)</div></div>
<div class="ttc" id="object__representation_8h_html_ae4f63e3132c23d8c0b35bb1a59ca21e5"><div class="ttname"><a href="object__representation_8h.html#ae4f63e3132c23d8c0b35bb1a59ca21e5">or_unpack_string_nocopy</a></div><div class="ttdeci">char * or_unpack_string_nocopy(char *ptr, char **string)</div><div class="ttdef"><b>Definition:</b> <a href="object__representation_8c_source.html#l04064">object_representation.c:4064</a></div></div>
<div class="ttc" id="structvpid_html_a5863283d85ba76aaec01bf80c89a9d36"><div class="ttname"><a href="structvpid.html#a5863283d85ba76aaec01bf80c89a9d36">vpid::pageid</a></div><div class="ttdeci">int32_t pageid</div><div class="ttdef"><b>Definition:</b> <a href="dbtype__def_8h_source.html#l00904">dbtype_def.h:904</a></div></div>
<div class="ttc" id="db__value__printer_8hpp_html"><div class="ttname"><a href="db__value__printer_8hpp.html">db_value_printer.hpp</a></div></div>
<div class="ttc" id="structlog__tdes_html_a1118927d0fabac722cf0f9d04dee1378"><div class="ttname"><a href="structlog__tdes.html#a1118927d0fabac722cf0f9d04dee1378">log_tdes::rmutex_topop</a></div><div class="ttdeci">SYNC_RMUTEX rmutex_topop</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01711">log_impl.h:1711</a></div></div>
<div class="ttc" id="log__impl_8h_html_a5561d6b89dce60cfa780062fae1bb473"><div class="ttname"><a href="log__impl_8h.html#a5561d6b89dce60cfa780062fae1bb473">LOG_CS_ENTER</a></div><div class="ttdeci">#define LOG_CS_ENTER(thread_p)</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00810">log_impl.h:810</a></div></div>
<div class="ttc" id="log__impl_8h_html_aaa150f6c2ae6a1748640ab281ffd94f7a92e0794a329897d52f3345d13359914e"><div class="ttname"><a href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a92e0794a329897d52f3345d13359914e">LOG_COMPENSATE</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00540">log_impl.h:540</a></div></div>
<div class="ttc" id="structlog__tdes_html_a81f8323632791e9ca56aa0b1ba838609"><div class="ttname"><a href="structlog__tdes.html#a81f8323632791e9ca56aa0b1ba838609">log_tdes::block_global_oldest_active_until_commit</a></div><div class="ttdeci">bool block_global_oldest_active_until_commit</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01765">log_impl.h:1765</a></div></div>
<div class="ttc" id="log__impl_8h_html_a4012c5af4c2bbf3def3c0d6ffbd47edb"><div class="ttname"><a href="log__impl_8h.html#a4012c5af4c2bbf3def3c0d6ffbd47edb">LOG_DBFIRST_VOLID</a></div><div class="ttdeci">#define LOG_DBFIRST_VOLID</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00482">log_impl.h:482</a></div></div>
<div class="ttc" id="log__impl_8h_html_a9bf9166a3f6ad5e2a402119016094fbc"><div class="ttname"><a href="log__impl_8h.html#a9bf9166a3f6ad5e2a402119016094fbc">LOG_DBLOG_BG_ARCHIVE_VOLID</a></div><div class="ttdeci">#define LOG_DBLOG_BG_ARCHIVE_VOLID</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00493">log_impl.h:493</a></div></div>
<div class="ttc" id="file__io_8c_html_a2698b23075fc7b789192fe12bb868af9"><div class="ttname"><a href="file__io_8c.html#a2698b23075fc7b789192fe12bb868af9">fileio_reset_volume</a></div><div class="ttdeci">int fileio_reset_volume(THREAD_ENTRY *thread_p, int vol_fd, const char *vlabel, DKNPAGES npages, LOG_LSA *reset_lsa_p)</div><div class="ttdef"><b>Definition:</b> <a href="file__io_8c_source.html#l02883">file_io.c:2883</a></div></div>
<div class="ttc" id="perf__monitor_8h_html_a165b76d14ae9e30731ed3ca4cf856903a1dc9e18210b62c04850a1bb49dc3472b"><div class="ttname"><a href="perf__monitor_8h.html#a165b76d14ae9e30731ed3ca4cf856903a1dc9e18210b62c04850a1bb49dc3472b">PSTAT_TRAN_NUM_END_TOPOPS</a></div><div class="ttdef"><b>Definition:</b> <a href="perf__monitor_8h_source.html#l00327">perf_monitor.h:327</a></div></div>
<div class="ttc" id="structlog__rec__2pc__prepcommit_html_aebbcaf39734bdbba0c37af1292a7cb9e"><div class="ttname"><a href="structlog__rec__2pc__prepcommit.html#aebbcaf39734bdbba0c37af1292a7cb9e">log_rec_2pc_prepcommit::gtrinfo_length</a></div><div class="ttdeci">int gtrinfo_length</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01644">log_impl.h:1644</a></div></div>
<div class="ttc" id="error__manager_8c_html_a14b629a84676fc1e0aad0c58f0c222c0"><div class="ttname"><a href="error__manager_8c.html#a14b629a84676fc1e0aad0c58f0c222c0">er_errid</a></div><div class="ttdeci">int er_errid(void)</div><div class="ttdef"><b>Definition:</b> <a href="error__manager_8c_source.html#l01799">error_manager.c:1799</a></div></div>
<div class="ttc" id="log__impl_8h_html_a73baa6645b24b8b7c11e7ec7f4f53e8ca14a79f362dece4ce17360938edb94090"><div class="ttname"><a href="log__impl_8h.html#a73baa6645b24b8b7c11e7ec7f4f53e8ca14a79f362dece4ce17360938edb94090">LOG_2PC_EXECUTE_ABORT_DECISION</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01246">log_impl.h:1246</a></div></div>
<div class="ttc" id="vacuum_8h_html_a21f8b652e2aa9c21a099d1eea14dc0e3"><div class="ttname"><a href="vacuum_8h.html#a21f8b652e2aa9c21a099d1eea14dc0e3">VACUUM_ER_LOG_WORKER</a></div><div class="ttdeci">#define VACUUM_ER_LOG_WORKER</div><div class="ttdef"><b>Definition:</b> <a href="vacuum_8h_source.html#l00051">vacuum.h:51</a></div></div>
<div class="ttc" id="log__manager_8h_html_ae5eb3ef7758cbee166b922bd5541dfae"><div class="ttname"><a href="log__manager_8h.html#ae5eb3ef7758cbee166b922bd5541dfae">LOG_TOPOP_STACK_INIT_SIZE</a></div><div class="ttdeci">#define LOG_TOPOP_STACK_INIT_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8h_source.html#l00047">log_manager.h:47</a></div></div>
<div class="ttc" id="intl__support_8h_html_a62642b38e69c029c39114bb176d2f4b7a6d75f4183f1792ba969f6dc176909de6"><div class="ttname"><a href="intl__support_8h.html#a62642b38e69c029c39114bb176d2f4b7a6d75f4183f1792ba969f6dc176909de6">INTL_CODESET_NONE</a></div><div class="ttdef"><b>Definition:</b> <a href="intl__support_8h_source.html#l00180">intl_support.h:180</a></div></div>
<div class="ttc" id="structlog__zip_html_a3e723c649a96cb0c0af4516d40fc4aed"><div class="ttname"><a href="structlog__zip.html#a3e723c649a96cb0c0af4516d40fc4aed">log_zip::data_length</a></div><div class="ttdeci">LOG_ZIP_SIZE_T data_length</div><div class="ttdef"><b>Definition:</b> <a href="log__compress_8h_source.html#l00057">log_compress.h:57</a></div></div>
<div class="ttc" id="structdb__charset_html"><div class="ttname"><a href="structdb__charset.html">db_charset</a></div><div class="ttdef"><b>Definition:</b> <a href="language__support_8h_source.html#l00132">language_support.h:132</a></div></div>
<div class="ttc" id="log__manager_8c_html_a3cec5baaf013ea91aa2dca8fe7860686"><div class="ttname"><a href="log__manager_8c.html#a3cec5baaf013ea91aa2dca8fe7860686">log_sysop_get_level</a></div><div class="ttdeci">STATIC_INLINE int log_sysop_get_level(THREAD_ENTRY *thread_p) __attribute__((ALWAYS_INLINE))</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l04204">log_manager.c:4204</a></div></div>
<div class="ttc" id="recovery_8c_html_a8f5d1d7742eaee7cb4d25c8250b9e565"><div class="ttname"><a href="recovery_8c.html#a8f5d1d7742eaee7cb4d25c8250b9e565">rv_check_rvfuns</a></div><div class="ttdeci">void rv_check_rvfuns(void)</div><div class="ttdef"><b>Definition:</b> <a href="recovery_8c_source.html#l00833">recovery.c:833</a></div></div>
<div class="ttc" id="error__code_8h_html_a80b3ce28a965d5be79dc7b4c22566853"><div class="ttname"><a href="error__code_8h.html#a80b3ce28a965d5be79dc7b4c22566853">ER_LOG_COMPENSATE_INTERFACE</a></div><div class="ttdeci">#define ER_LOG_COMPENSATE_INTERFACE</div><div class="ttdef"><b>Definition:</b> <a href="error__code_8h_source.html#l00147">error_code.h:147</a></div></div>
<div class="ttc" id="log__2pc_8c_html_a2854dc00bf3ef6c931e74ef18a87f999"><div class="ttname"><a href="log__2pc_8c.html#a2854dc00bf3ef6c931e74ef18a87f999">log_2pc_dump_gtrinfo</a></div><div class="ttdeci">void log_2pc_dump_gtrinfo(FILE *fp, int length, void *data)</div><div class="ttdef"><b>Definition:</b> <a href="log__2pc_8c_source.html#l01605">log_2pc.c:1605</a></div></div>
<div class="ttc" id="log__comm_8c_html_a7d21e9c2307baa1c134e93315dfe1d91"><div class="ttname"><a href="log__comm_8c.html#a7d21e9c2307baa1c134e93315dfe1d91">log_state_string</a></div><div class="ttdeci">const char * log_state_string(TRAN_STATE state)</div><div class="ttdef"><b>Definition:</b> <a href="log__comm_8c_source.html#l00125">log_comm.c:125</a></div></div>
<div class="ttc" id="memory__alloc_8h_html_a79781c0dbfdd9510d275cba54f1f384f"><div class="ttname"><a href="memory__alloc_8h.html#a79781c0dbfdd9510d275cba54f1f384f">PTR_ALIGN</a></div><div class="ttdeci">#define PTR_ALIGN(addr, boundary)</div><div class="ttdef"><b>Definition:</b> <a href="memory__alloc_8h_source.html#l00078">memory_alloc.h:78</a></div></div>
<div class="ttc" id="dbtype__function_8h_html_a4d82f586c6b675d10808fca453ded49c"><div class="ttname"><a href="dbtype__function_8h.html#a4d82f586c6b675d10808fca453ded49c">db_make_string_copy</a></div><div class="ttdeci">int db_make_string_copy(DB_VALUE *value, const char *str)</div></div>
<div class="ttc" id="log__impl_8h_html_a421fd50c31a6b7e87ada9559a39e22c5"><div class="ttname"><a href="log__impl_8h.html#a421fd50c31a6b7e87ada9559a39e22c5">logpb_check_and_reset_temp_lsa</a></div><div class="ttdeci">int logpb_check_and_reset_temp_lsa(THREAD_ENTRY *thread_p, VOLID volid)</div><div class="ttdef"><b>Definition:</b> <a href="log__page__buffer_8c_source.html#l11593">log_page_buffer.c:11593</a></div></div>
<div class="ttc" id="structlog__header_html_a67b3ba829a862ebd7fe6c0de32c0ee43"><div class="ttname"><a href="structlog__header.html#a67b3ba829a862ebd7fe6c0de32c0ee43">log_header::perm_status</a></div><div class="ttdeci">int perm_status</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00228">log_impl.h:228</a></div></div>
<div class="ttc" id="expat_8h_html_ad0c30ee1add42468a6d7c022f2efdf70"><div class="ttname"><a href="expat_8h.html#ad0c30ee1add42468a6d7c022f2efdf70">offset</a></div><div class="ttdeci">int * offset</div><div class="ttdef"><b>Definition:</b> <a href="expat_8h_source.html#l00891">expat.h:891</a></div></div>
<div class="ttc" id="system__parameter_8h_html_a23aaf6bca406b9b428f43ad1b6b2b3e0ae5c58bb4945f78cf1cf89a340013009a"><div class="ttname"><a href="system__parameter_8h.html#a23aaf6bca406b9b428f43ad1b6b2b3e0ae5c58bb4945f78cf1cf89a340013009a">PRM_ID_HA_DELAY_LIMIT_DELTA_IN_SECS</a></div><div class="ttdef"><b>Definition:</b> <a href="system__parameter_8h_source.html#l00242">system_parameter.h:242</a></div></div>
<div class="ttc" id="structlog__rec__mvcc__undoredo_html_ac07321188e6dd5041d4398462ee0c1cf"><div class="ttname"><a href="structlog__rec__mvcc__undoredo.html#ac07321188e6dd5041d4398462ee0c1cf">log_rec_mvcc_undoredo::vacuum_info</a></div><div class="ttdeci">LOG_VACUUM_INFO vacuum_info</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00693">log_impl.h:693</a></div></div>
<div class="ttc" id="structlob__locator__entry_html"><div class="ttname"><a href="structlob__locator__entry.html">lob_locator_entry</a></div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l00166">log_manager.c:166</a></div></div>
<div class="ttc" id="log__impl_8h_html_ae0f406b900c5b78e29ff0d9f32205701"><div class="ttname"><a href="log__impl_8h.html#ae0f406b900c5b78e29ff0d9f32205701">LOG_CS_ENTER_READ_MODE</a></div><div class="ttdeci">#define LOG_CS_ENTER_READ_MODE(thread_p)</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00811">log_impl.h:811</a></div></div>
<div class="ttc" id="log__manager_8c_html_af6c9cbd5b7eedd3a08ed81eba4dc5556"><div class="ttname"><a href="log__manager_8c.html#af6c9cbd5b7eedd3a08ed81eba4dc5556">log_sysop_end_logical_undo</a></div><div class="ttdeci">void log_sysop_end_logical_undo(THREAD_ENTRY *thread_p, LOG_RCVINDEX rcvindex, const VFID *vfid, int undo_size, const char *undo_data)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l04004">log_manager.c:4004</a></div></div>
<div class="ttc" id="error__manager_8h_html_a075eb8873354909bbe8edafa0f18f58c"><div class="ttname"><a href="error__manager_8h.html#a075eb8873354909bbe8edafa0f18f58c">er_log_debug</a></div><div class="ttdeci">#define er_log_debug(...)</div><div class="ttdef"><b>Definition:</b> <a href="error__manager_8h_source.html#l00207">error_manager.h:207</a></div></div>
<div class="ttc" id="system__parameter_8h_html_a23aaf6bca406b9b428f43ad1b6b2b3e0ad056c84e225c203537202fa2001c1c09"><div class="ttname"><a href="system__parameter_8h.html#a23aaf6bca406b9b428f43ad1b6b2b3e0ad056c84e225c203537202fa2001c1c09">PRM_ID_LOG_BTREE_OPS</a></div><div class="ttdef"><b>Definition:</b> <a href="system__parameter_8h_source.html#l00352">system_parameter.h:352</a></div></div>
<div class="ttc" id="recovery_8h_html_a526c4dc065c989256afca8b3b56d4d2bac974752cd664dc6af0946c1d7ef4ce74"><div class="ttname"><a href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2bac974752cd664dc6af0946c1d7ef4ce74">RVREPL_STATEMENT</a></div><div class="ttdef"><b>Definition:</b> <a href="recovery_8h_source.html#l00152">recovery.h:152</a></div></div>
<div class="ttc" id="structlog__repl_html_a6f07078be78c9519a03b298baccbe5fd"><div class="ttname"><a href="structlog__repl.html#a6f07078be78c9519a03b298baccbe5fd">log_repl::lsa</a></div><div class="ttdeci">LOG_LSA lsa</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01508">log_impl.h:1508</a></div></div>
<div class="ttc" id="string__buffer_8hpp_html"><div class="ttname"><a href="string__buffer_8hpp.html">string_buffer.hpp</a></div></div>
<div class="ttc" id="structlog__header_html_a982b3e55dedc3dabc54a1a7fcddc144e"><div class="ttname"><a href="structlog__header.html#a982b3e55dedc3dabc54a1a7fcddc144e">log_header::append_lsa</a></div><div class="ttdeci">LOG_LSA append_lsa</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00214">log_impl.h:214</a></div></div>
<div class="ttc" id="lock__manager_8h_html_ab0bca202e031bb24d8cfdfd10fef32a8"><div class="ttname"><a href="lock__manager_8h.html#ab0bca202e031bb24d8cfdfd10fef32a8">LK_ACQOBJ_LOCK</a></div><div class="ttdeci">struct lk_acqobj_lock LK_ACQOBJ_LOCK</div><div class="ttdef"><b>Definition:</b> <a href="lock__manager_8h_source.html#l00104">lock_manager.h:104</a></div></div>
<div class="ttc" id="structlog__header_html_a8e11d6d1907cbdd412a9c3cb7d79e6f4"><div class="ttname"><a href="structlog__header.html#a8e11d6d1907cbdd412a9c3cb7d79e6f4">log_header::has_logging_been_skipped</a></div><div class="ttdeci">bool has_logging_been_skipped</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00225">log_impl.h:225</a></div></div>
<div class="ttc" id="log__manager_8c_html_a2e83f32f5ca5ea01d8bc0077e489bca6"><div class="ttname"><a href="log__manager_8c.html#a2e83f32f5ca5ea01d8bc0077e489bca6">LOCATOR_META</a></div><div class="ttdeci">#define LOCATOR_META(locator_)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l00145">log_manager.c:145</a></div></div>
<div class="ttc" id="src_2base_2rb__tree_8h_html_ad97eb44d2c39debda8cfbbbbcb354cce"><div class="ttname"><a href="src_2base_2rb__tree_8h.html#ad97eb44d2c39debda8cfbbbbcb354cce">RB_REMOVE</a></div><div class="ttdeci">#define RB_REMOVE(name, x, y)</div><div class="ttdef"><b>Definition:</b> <a href="src_2base_2rb__tree_8h_source.html#l00467">rb_tree.h:467</a></div></div>
<div class="ttc" id="object__primitive_8h_html"><div class="ttname"><a href="object__primitive_8h.html">object_primitive.h</a></div></div>
<div class="ttc" id="page__buffer_8h_html_a7aba065674febb0ea4b7534c1bb7773c"><div class="ttname"><a href="page__buffer_8h.html#a7aba065674febb0ea4b7534c1bb7773c">pgbuf_invalidate_all</a></div><div class="ttdeci">#define pgbuf_invalidate_all(thread_p, volid)</div><div class="ttdef"><b>Definition:</b> <a href="page__buffer_8h_source.html#l00277">page_buffer.h:277</a></div></div>
<div class="ttc" id="log__impl_8h_html_a48a9214aa55783d4ae5648457f686c6c"><div class="ttname"><a href="log__impl_8h.html#a48a9214aa55783d4ae5648457f686c6c">logpb_flush_header</a></div><div class="ttdeci">void logpb_flush_header(THREAD_ENTRY *thread_p)</div><div class="ttdef"><b>Definition:</b> <a href="log__page__buffer_8c_source.html#l01699">log_page_buffer.c:1699</a></div></div>
<div class="ttc" id="structlog__topops__addresses_html_afe759effcd137f8d3ecfdb7e89814e7c"><div class="ttname"><a href="structlog__topops__addresses.html#afe759effcd137f8d3ecfdb7e89814e7c">log_topops_addresses::lastparent_lsa</a></div><div class="ttdeci">LOG_LSA lastparent_lsa</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01271">log_impl.h:1271</a></div></div>
<div class="ttc" id="error__manager_8c_html_a4b0a47356bddaa48a4c83984b5ac9fbe"><div class="ttname"><a href="error__manager_8c.html#a4b0a47356bddaa48a4c83984b5ac9fbe">_er_log_debug</a></div><div class="ttdeci">void _er_log_debug(const char *file_name, const int line_no, const char *fmt,...)</div><div class="ttdef"><b>Definition:</b> <a href="error__manager_8c_source.html#l01942">error_manager.c:1942</a></div></div>
<div class="ttc" id="file__io_8h_html_af6836ff47a9fdc109eb60b2ed5a3093d"><div class="ttname"><a href="file__io_8h.html#af6836ff47a9fdc109eb60b2ed5a3093d">NULL_VOLDES</a></div><div class="ttdeci">#define NULL_VOLDES</div><div class="ttdef"><b>Definition:</b> <a href="file__io_8h_source.html#l00044">file_io.h:44</a></div></div>
<div class="ttc" id="error__code_8h_html_aeb9b1799184e0af16d7395444437ff02"><div class="ttname"><a href="error__code_8h.html#aeb9b1799184e0af16d7395444437ff02">ER_ONLY_IN_STANDALONE</a></div><div class="ttdeci">#define ER_ONLY_IN_STANDALONE</div><div class="ttdef"><b>Definition:</b> <a href="error__code_8h_source.html#l00727">error_code.h:727</a></div></div>
<div class="ttc" id="memory__alloc_8h_html_a81d7e4971ffc775a379eeb4c65fa30f8"><div class="ttname"><a href="memory__alloc_8h.html#a81d7e4971ffc775a379eeb4c65fa30f8">MAX_ALIGNMENT</a></div><div class="ttdeci">#define MAX_ALIGNMENT</div><div class="ttdef"><b>Definition:</b> <a href="memory__alloc_8h_source.html#l00071">memory_alloc.h:71</a></div></div>
<div class="ttc" id="log__impl_8h_html_aaa150f6c2ae6a1748640ab281ffd94f7ae03e50858368a0a9e96e4cb7ce991354"><div class="ttname"><a href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7ae03e50858368a0a9e96e4cb7ce991354">LOG_MVCC_DIFF_UNDOREDO_DATA</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00620">log_impl.h:620</a></div></div>
<div class="ttc" id="log__manager_8c_html_ad7d852d6547ead2335b5cc6ce6360ea0"><div class="ttname"><a href="log__manager_8c.html#ad7d852d6547ead2335b5cc6ce6360ea0">log_wakeup_log_flush_daemon</a></div><div class="ttdeci">void log_wakeup_log_flush_daemon()</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l10375">log_manager.c:10375</a></div></div>
<div class="ttc" id="classcubthread_1_1looper_html"><div class="ttname"><a href="classcubthread_1_1looper.html">cubthread::looper</a></div><div class="ttdef"><b>Definition:</b> <a href="thread__looper_8hpp_source.html#l00082">thread_looper.hpp:82</a></div></div>
<div class="ttc" id="oid_8h_html_a05700e09529ceccd047f910e9ff64d3c"><div class="ttname"><a href="oid_8h.html#a05700e09529ceccd047f910e9ff64d3c">COPY_OID</a></div><div class="ttdeci">#define COPY_OID(dest_oid_ptr, src_oid_ptr)</div><div class="ttdef"><b>Definition:</b> <a href="oid_8h_source.html#l00064">oid.h:64</a></div></div>
<div class="ttc" id="structlob__savepoint__entry_html"><div class="ttname"><a href="structlob__savepoint__entry.html">lob_savepoint_entry</a></div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l00158">log_manager.c:158</a></div></div>
<div class="ttc" id="vacuum_8h_html_a85a0ab6d41bb8ef710931f6dba63d611a37ecce03b3ae2c51389cc18c8365e788"><div class="ttname"><a href="vacuum_8h.html#a85a0ab6d41bb8ef710931f6dba63d611a37ecce03b3ae2c51389cc18c8365e788">VACUUM_WORKER_STATE_TOPOP</a></div><div class="ttdef"><b>Definition:</b> <a href="vacuum_8h_source.html#l00088">vacuum.h:88</a></div></div>
<div class="ttc" id="log__impl_8h_html_a7152cb8ed5c589ffd3b3ba8e753c2113"><div class="ttname"><a href="log__impl_8h.html#a7152cb8ed5c589ffd3b3ba8e753c2113">logpb_set_dirty</a></div><div class="ttdeci">void logpb_set_dirty(THREAD_ENTRY *thread_p, LOG_PAGE *log_pgptr)</div><div class="ttdef"><b>Definition:</b> <a href="log__page__buffer_8c_source.html#l01045">log_page_buffer.c:1045</a></div></div>
<div class="ttc" id="classstring__buffer_html"><div class="ttname"><a href="classstring__buffer.html">string_buffer</a></div><div class="ttdef"><b>Definition:</b> <a href="string__buffer_8hpp_source.html#l00046">string_buffer.hpp:46</a></div></div>
<div class="ttc" id="log__impl_8h_html_ae4d9be9c39c53c4e9448995435767e99"><div class="ttname"><a href="log__impl_8h.html#ae4d9be9c39c53c4e9448995435767e99">LOG_INFO_CHKPT_TRANS</a></div><div class="ttdeci">struct log_info_chkpt_trans LOG_INFO_CHKPT_TRANS</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01605">log_impl.h:1605</a></div></div>
<div class="ttc" id="log__impl_8h_html_a24797b2fe67e0ec8631d7a92fbef25c9a69f84e9574e7f583c88733bdea3a415f"><div class="ttname"><a href="log__impl_8h.html#a24797b2fe67e0ec8631d7a92fbef25c9a69f84e9574e7f583c88733bdea3a415f">LOG_SYSOP_END_LOGICAL_COMPENSATE</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01545">log_impl.h:1545</a></div></div>
<div class="ttc" id="file__io_8c_html_a26c82a33f296d5b511cbdf8b157c3ef3"><div class="ttname"><a href="file__io_8c.html#a26c82a33f296d5b511cbdf8b157c3ef3">fileio_mount</a></div><div class="ttdeci">int fileio_mount(THREAD_ENTRY *thread_p, const char *db_full_name_p, const char *vol_label_p, VOLID vol_id, int lock_wait, bool is_do_sync)</div><div class="ttdef"><b>Definition:</b> <a href="file__io_8c_source.html#l02936">file_io.c:2936</a></div></div>
<div class="ttc" id="structmodified__class__entry_html_a8e554ffc2197d19b7f0fdcaac385ea15"><div class="ttname"><a href="structmodified__class__entry.html#a8e554ffc2197d19b7f0fdcaac385ea15">modified_class_entry::m_last_modified_lsa</a></div><div class="ttdeci">LOG_LSA m_last_modified_lsa</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01300">log_impl.h:1300</a></div></div>
<div class="ttc" id="structlog__rec__2pc__start_html_a7652d396bdd0451db1db52822a55abc9"><div class="ttname"><a href="structlog__rec__2pc__start.html#a7652d396bdd0451db1db52822a55abc9">log_rec_2pc_start::num_particps</a></div><div class="ttdeci">int num_particps</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01656">log_impl.h:1656</a></div></div>
<div class="ttc" id="xserver__interface_8h_html_a109d4fa7bce7704b128b212a69062908"><div class="ttname"><a href="xserver__interface_8h.html#a109d4fa7bce7704b128b212a69062908">xlogtb_reset_wait_msecs</a></div><div class="ttdeci">int xlogtb_reset_wait_msecs(THREAD_ENTRY *thread_p, int wait_msecs)</div><div class="ttdef"><b>Definition:</b> <a href="log__tran__table_8c_source.html#l02883">log_tran_table.c:2883</a></div></div>
<div class="ttc" id="log__manager_8c_html_a1504524244c9badcc53c1bb8b0d4213f"><div class="ttname"><a href="log__manager_8c.html#a1504524244c9badcc53c1bb8b0d4213f">log_sysop_end_begin</a></div><div class="ttdeci">STATIC_INLINE void log_sysop_end_begin(THREAD_ENTRY *thread_p, int *tran_index_out, LOG_TDES **tdes_out) __attribute__((ALWAYS_INLINE))</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l03769">log_manager.c:3769</a></div></div>
<div class="ttc" id="structdb__value_html"><div class="ttname"><a href="structdb__value.html">db_value</a></div><div class="ttdef"><b>Definition:</b> <a href="dbtype__def_8h_source.html#l01105">dbtype_def.h:1105</a></div></div>
<div class="ttc" id="log__manager_8c_html_ab278939e239bb84cc9c118b55260a500"><div class="ttname"><a href="log__manager_8c.html#ab278939e239bb84cc9c118b55260a500">LOG_TDES_LAST_SYSOP_PARENT_LSA</a></div><div class="ttdeci">#define LOG_TDES_LAST_SYSOP_PARENT_LSA(tdes)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l00204">log_manager.c:204</a></div></div>
<div class="ttc" id="structlog__rec__header_html_a210194ed9baf246456495d89fb411725"><div class="ttname"><a href="structlog__rec__header.html#a210194ed9baf246456495d89fb411725">log_rec_header::trid</a></div><div class="ttdeci">TRANID trid</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00638">log_impl.h:638</a></div></div>
<div class="ttc" id="log__manager_8c_html_aac5e93bab6adf7b42b70451c7c1753b7"><div class="ttname"><a href="log__manager_8c.html#aac5e93bab6adf7b42b70451c7c1753b7">log_do_postpone</a></div><div class="ttdeci">void log_do_postpone(THREAD_ENTRY *thread_p, LOG_TDES *tdes, LOG_LSA *start_postpone_lsa)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l08567">log_manager.c:8567</a></div></div>
<div class="ttc" id="structlog__rec__header_html_af86b0fae64edb2a53b87dc354baf543c"><div class="ttname"><a href="structlog__rec__header.html#af86b0fae64edb2a53b87dc354baf543c">log_rec_header::back_lsa</a></div><div class="ttdeci">LOG_LSA back_lsa</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00636">log_impl.h:636</a></div></div>
<div class="ttc" id="log__comm_8h_html_a3c0be9b9f104459ab90ee18af95c4b3ea10373ab725a87c9ac3126b85a1400846"><div class="ttname"><a href="log__comm_8h.html#a3c0be9b9f104459ab90ee18af95c4b3ea10373ab725a87c9ac3126b85a1400846">TRAN_UNACTIVE_WILL_COMMIT</a></div><div class="ttdef"><b>Definition:</b> <a href="log__comm_8h_source.html#l00045">log_comm.h:45</a></div></div>
<div class="ttc" id="file__manager_8h_html_a3c0dad2de1e9fca1501e28181db1c688"><div class="ttname"><a href="file__manager_8h.html#a3c0dad2de1e9fca1501e28181db1c688">VFID_ISNULL</a></div><div class="ttdeci">#define VFID_ISNULL(vfid_ptr)</div><div class="ttdef"><b>Definition:</b> <a href="file__manager_8h_source.html#l00072">file_manager.h:72</a></div></div>
<div class="ttc" id="thread__compat_8hpp_html_a89b282e93055510be0849001ca0561e1"><div class="ttname"><a href="thread__compat_8hpp.html#a89b282e93055510be0849001ca0561e1">THREAD_ENTRY</a></div><div class="ttdeci">void THREAD_ENTRY</div><div class="ttdef"><b>Definition:</b> <a href="thread__compat_8hpp_source.html#l00044">thread_compat.hpp:44</a></div></div>
<div class="ttc" id="storage__common_8h_html_a7ed60eef43941f46fadae895f63ee033"><div class="ttname"><a href="storage__common_8h.html#a7ed60eef43941f46fadae895f63ee033">NULL_PAGEID</a></div><div class="ttdeci">#define NULL_PAGEID</div><div class="ttdef"><b>Definition:</b> <a href="storage__common_8h_source.html#l00047">storage_common.h:47</a></div></div>
<div class="ttc" id="log__impl_8h_html_a2b616997f446dcb588a6addcc65cf5b7"><div class="ttname"><a href="log__impl_8h.html#a2b616997f446dcb588a6addcc65cf5b7">prior_lsa_alloc_and_copy_data</a></div><div class="ttdeci">LOG_PRIOR_NODE * prior_lsa_alloc_and_copy_data(THREAD_ENTRY *thread_p, LOG_RECTYPE rec_type, LOG_RCVINDEX rcvindex, LOG_DATA_ADDR *addr, int ulength, const char *udata, int rlength, const char *rdata)</div><div class="ttdef"><b>Definition:</b> <a href="log__page__buffer_8c_source.html#l03639">log_page_buffer.c:3639</a></div></div>
<div class="ttc" id="structlog__data_html_afd25836b0952561036b01b5a50c310b2"><div class="ttname"><a href="structlog__data.html#afd25836b0952561036b01b5a50c310b2">log_data::offset</a></div><div class="ttdeci">PGLENGTH offset</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00648">log_impl.h:648</a></div></div>
<div class="ttc" id="structlog__tdes_html_a35e52753b9c8d5e70696ae8f0479072f"><div class="ttname"><a href="structlog__tdes.html#a35e52753b9c8d5e70696ae8f0479072f">log_tdes::tail_topresult_lsa</a></div><div class="ttdeci">LOG_LSA tail_topresult_lsa</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01706">log_impl.h:1706</a></div></div>
<div class="ttc" id="structlog__header_html_a43b980e328d1dba7c171a93a7d58ca45"><div class="ttname"><a href="structlog__header.html#a43b980e328d1dba7c171a93a7d58ca45">log_header::bkinfo</a></div><div class="ttdeci">LOG_HDR_BKUP_LEVEL_INFO bkinfo[FILEIO_BACKUP_UNDEFINED_LEVEL]</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00231">log_impl.h:231</a></div></div>
<div class="ttc" id="error__manager_8h_html_a5d0d456c474e11fc70779873a30a7432af9c76cd8146aafca7fb58dabd599e41b"><div class="ttname"><a href="error__manager_8h.html#a5d0d456c474e11fc70779873a30a7432af9c76cd8146aafca7fb58dabd599e41b">ER_NOTIFICATION_SEVERITY</a></div><div class="ttdef"><b>Definition:</b> <a href="error__manager_8h_source.html#l00120">error_manager.h:120</a></div></div>
<div class="ttc" id="file__manager_8c_html_a266493da17b6d1e9ec9c2494c86164a0"><div class="ttname"><a href="file__manager_8c.html#a266493da17b6d1e9ec9c2494c86164a0">file_tempcache_drop_tran_temp_files</a></div><div class="ttdeci">void file_tempcache_drop_tran_temp_files(THREAD_ENTRY *thread_p)</div><div class="ttdef"><b>Definition:</b> <a href="file__manager_8c_source.html#l09034">file_manager.c:9034</a></div></div>
<div class="ttc" id="log__manager_8c_html_a6e093782f446a5806cc9631a97eba1c3"><div class="ttname"><a href="log__manager_8c.html#a6e093782f446a5806cc9631a97eba1c3">log_to_string</a></div><div class="ttdeci">const char * log_to_string(LOG_RECTYPE type)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l00388">log_manager.c:388</a></div></div>
<div class="ttc" id="system__parameter_8h_html_a23aaf6bca406b9b428f43ad1b6b2b3e0a0c9cdfff95fcd3c77a8a8111f3d481cb"><div class="ttname"><a href="system__parameter_8h.html#a23aaf6bca406b9b428f43ad1b6b2b3e0a0c9cdfff95fcd3c77a8a8111f3d481cb">PRM_ID_LOG_CHECKPOINT_INTERVAL_SECS</a></div><div class="ttdef"><b>Definition:</b> <a href="system__parameter_8h_source.html#l00127">system_parameter.h:127</a></div></div>
<div class="ttc" id="perf__monitor_8h_html_a165b76d14ae9e30731ed3ca4cf856903acec1ac222608da8bd2b15687f12223eb"><div class="ttname"><a href="perf__monitor_8h.html#a165b76d14ae9e30731ed3ca4cf856903acec1ac222608da8bd2b15687f12223eb">PSTAT_TRAN_NUM_START_TOPOPS</a></div><div class="ttdef"><b>Definition:</b> <a href="perf__monitor_8h_source.html#l00326">perf_monitor.h:326</a></div></div>
<div class="ttc" id="log__impl_8h_html_a7c06e439fe569ee687eaa368cbb7e4f7"><div class="ttname"><a href="log__impl_8h.html#a7c06e439fe569ee687eaa368cbb7e4f7">TR_TABLE_CS_ENTER</a></div><div class="ttdeci">#define TR_TABLE_CS_ENTER(thread_p)</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00816">log_impl.h:816</a></div></div>
<div class="ttc" id="structactve__log__header__scan__context_html"><div class="ttname"><a href="structactve__log__header__scan__context.html">actve_log_header_scan_context</a></div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l00180">log_manager.c:180</a></div></div>
<div class="ttc" id="log__impl_8h_html_a4d2d36199fa78b84a55e80f87d2146a7"><div class="ttname"><a href="log__impl_8h.html#a4d2d36199fa78b84a55e80f87d2146a7">LOG_FIND_CURRENT_TDES</a></div><div class="ttdeci">#define LOG_FIND_CURRENT_TDES(thrd)</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00953">log_impl.h:953</a></div></div>
<div class="ttc" id="structarea_html"><div class="ttname"><a href="structarea.html">area</a></div><div class="ttdef"><b>Definition:</b> <a href="area__alloc_8h_source.html#l00070">area_alloc.h:70</a></div></div>
<div class="ttc" id="message__catalog_8h_html_aa04e075e72cdb43d5397319b05e9184f"><div class="ttname"><a href="message__catalog_8h.html#aa04e075e72cdb43d5397319b05e9184f">MSGCAT_SET_LOG</a></div><div class="ttdeci">#define MSGCAT_SET_LOG</div><div class="ttdef"><b>Definition:</b> <a href="message__catalog_8h_source.html#l00055">message_catalog.h:55</a></div></div>
<div class="ttc" id="log__impl_8h_html_ae37437431a8ea417a8e768ed5fa8f5f6"><div class="ttname"><a href="log__impl_8h.html#ae37437431a8ea417a8e768ed5fa8f5f6">LOG_GET_LOG_RECORD_HEADER</a></div><div class="ttdeci">#define LOG_GET_LOG_RECORD_HEADER(log_page_p, lsa)</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00729">log_impl.h:729</a></div></div>
<div class="ttc" id="log__manager_8c_html_ad85f54b15c10504caa3c3b91a58549d9"><div class="ttname"><a href="log__manager_8c.html#ad85f54b15c10504caa3c3b91a58549d9">log_set_db_restore_time</a></div><div class="ttdeci">void log_set_db_restore_time(THREAD_ENTRY *thread_p, INT64 db_restore_time)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l10011">log_manager.c:10011</a></div></div>
<div class="ttc" id="classcubthread_1_1task_html_a623fd6821a2500a5827b609d76428ecd"><div class="ttname"><a href="classcubthread_1_1task.html#a623fd6821a2500a5827b609d76428ecd">cubthread::task&lt; entry &gt;::execute</a></div><div class="ttdeci">virtual void execute(context_type &amp;)=0</div></div>
<div class="ttc" id="structlog__header_html_ab7c3c46056f412b19f447caf2ce7b861"><div class="ttname"><a href="structlog__header.html#ab7c3c46056f412b19f447caf2ce7b861">log_header::db_creation</a></div><div class="ttdeci">INT64 db_creation</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00194">log_impl.h:194</a></div></div>
<div class="ttc" id="structmodified__class__entry_html_a25d46b6e46ce413b419562bfd54fe841"><div class="ttname"><a href="structmodified__class__entry.html#a25d46b6e46ce413b419562bfd54fe841">modified_class_entry::m_next</a></div><div class="ttdeci">MODIFIED_CLASS_ENTRY * m_next</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01297">log_impl.h:1297</a></div></div>
<div class="ttc" id="structlog__info__chkpt__sysop_html"><div class="ttname"><a href="structlog__info__chkpt__sysop.html">log_info_chkpt_sysop</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01624">log_impl.h:1624</a></div></div>
<div class="ttc" id="log__manager_8c_html_aac6bd2dc11adb08f6b6da5bcaf2986b3"><div class="ttname"><a href="log__manager_8c.html#aac6bd2dc11adb08f6b6da5bcaf2986b3">log_append_redo_data2</a></div><div class="ttdeci">void log_append_redo_data2(THREAD_ENTRY *thread_p, LOG_RCVINDEX rcvindex, const VFID *vfid, PAGE_PTR pgptr, PGLENGTH offset, int length, const void *data)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l02025">log_manager.c:2025</a></div></div>
<div class="ttc" id="log__manager_8h_html_a82c9a5b14b839795ad6792b5e633ed14"><div class="ttname"><a href="log__manager_8h.html#a82c9a5b14b839795ad6792b5e633ed14">LOG_IS_SYSTEM_OP_STARTED</a></div><div class="ttdeci">#define LOG_IS_SYSTEM_OP_STARTED(tdes)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8h_source.html#l00056">log_manager.h:56</a></div></div>
<div class="ttc" id="log__impl_8h_html_aaa150f6c2ae6a1748640ab281ffd94f7a59ac89fe85edd8011e84db21095290a7"><div class="ttname"><a href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a59ac89fe85edd8011e84db21095290a7">LOG_RUN_POSTPONE</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00539">log_impl.h:539</a></div></div>
<div class="ttc" id="storage__common_8h_html_ad704198b3c56cf17601de69c679a7181aa09fa5ed5be816eeb89a11be5a00c477"><div class="ttname"><a href="storage__common_8h.html#ad704198b3c56cf17601de69c679a7181aa09fa5ed5be816eeb89a11be5a00c477">S_ERROR</a></div><div class="ttdef"><b>Definition:</b> <a href="storage__common_8h_source.html#l00641">storage_common.h:641</a></div></div>
<div class="ttc" id="release__string_8h_html_aa7483b60e70f1b66a28d488d26b04819"><div class="ttname"><a href="release__string_8h.html#aa7483b60e70f1b66a28d488d26b04819">REL_COMPATIBILITY</a></div><div class="ttdeci">REL_COMPATIBILITY</div><div class="ttdef"><b>Definition:</b> <a href="release__string_8h_source.html#l00047">release_string.h:47</a></div></div>
<div class="ttc" id="structlog__rec__header_html_aa9be1266bf7fdca13a0a789dc5ae11bb"><div class="ttname"><a href="structlog__rec__header.html#aa9be1266bf7fdca13a0a789dc5ae11bb">log_rec_header::type</a></div><div class="ttdeci">LOG_RECTYPE type</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00639">log_impl.h:639</a></div></div>
<div class="ttc" id="log__manager_8c_html_ac6a08ce8b6271d689e48b7bd96a32c7a"><div class="ttname"><a href="log__manager_8c.html#ac6a08ce8b6271d689e48b7bd96a32c7a">log_sysop_get_tran_index_and_tdes</a></div><div class="ttdeci">STATIC_INLINE void log_sysop_get_tran_index_and_tdes(THREAD_ENTRY *thread_p, int *tran_index_out, LOG_TDES **tdes_out) __attribute__((ALWAYS_INLINE))</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l04228">log_manager.c:4228</a></div></div>
<div class="ttc" id="structlog__prior__lsa__info_html_a08e7110c91df43323c7bb53da0d38446"><div class="ttname"><a href="structlog__prior__lsa__info.html#a08e7110c91df43323c7bb53da0d38446">log_prior_lsa_info::prev_lsa</a></div><div class="ttdeci">LOG_LSA prev_lsa</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01870">log_impl.h:1870</a></div></div>
<div class="ttc" id="error__manager_8h_html_a5d0d456c474e11fc70779873a30a7432ab550b3cd73fa19e9a2430d5b4552a2b1"><div class="ttname"><a href="error__manager_8h.html#a5d0d456c474e11fc70779873a30a7432ab550b3cd73fa19e9a2430d5b4552a2b1">ER_WARNING_SEVERITY</a></div><div class="ttdef"><b>Definition:</b> <a href="error__manager_8h_source.html#l00119">error_manager.h:119</a></div></div>
<div class="ttc" id="error__code_8h_html_ade4920aba636e2047c0111dfaa9d67e0"><div class="ttname"><a href="error__code_8h.html#ade4920aba636e2047c0111dfaa9d67e0">ER_LOG_CORRUPTED_DB_DUE_NOLOGGING</a></div><div class="ttdeci">#define ER_LOG_CORRUPTED_DB_DUE_NOLOGGING</div><div class="ttdef"><b>Definition:</b> <a href="error__code_8h_source.html#l00725">error_code.h:725</a></div></div>
<div class="ttc" id="structlog__rec__mvcc__redo_html"><div class="ttname"><a href="structlog__rec__mvcc__redo.html">log_rec_mvcc_redo</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00707">log_impl.h:707</a></div></div>
<div class="ttc" id="structlog__rec__undo_html"><div class="ttname"><a href="structlog__rec__undo.html">log_rec_undo</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00663">log_impl.h:663</a></div></div>
<div class="ttc" id="structlog__rec__donetime_html"><div class="ttname"><a href="structlog__rec__donetime.html">log_rec_donetime</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00724">log_impl.h:724</a></div></div>
<div class="ttc" id="namespacecubthread_html_a0b0f629740d5037917c1773030847800"><div class="ttname"><a href="namespacecubthread.html#a0b0f629740d5037917c1773030847800">cubthread::get_manager</a></div><div class="ttdeci">manager * get_manager(void)</div><div class="ttdef"><b>Definition:</b> <a href="thread__manager_8cpp_source.html#l00550">thread_manager.cpp:550</a></div></div>
<div class="ttc" id="disk__manager_8c_html_ad06d8503a3b798b95e324fe9e6be6374"><div class="ttname"><a href="disk__manager_8c.html#ad06d8503a3b798b95e324fe9e6be6374">disk_set_creation</a></div><div class="ttdeci">int disk_set_creation(THREAD_ENTRY *thread_p, INT16 volid, const char *new_vol_fullname, const INT64 *new_dbcreation, const LOG_LSA *new_chkptlsa, bool logchange, DISK_FLUSH_TYPE flush)</div><div class="ttdef"><b>Definition:</b> <a href="disk__manager_8c_source.html#l00850">disk_manager.c:850</a></div></div>
<div class="ttc" id="structlog__tdes_html_ac9e24cb7fdff0af7ecdaed07174fb170"><div class="ttname"><a href="structlog__tdes.html#ac9e24cb7fdff0af7ecdaed07174fb170">log_tdes::modified_class_list</a></div><div class="ttdeci">MODIFIED_CLASS_ENTRY * modified_class_list</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01729">log_impl.h:1729</a></div></div>
<div class="ttc" id="log__impl_8h_html_aaa150f6c2ae6a1748640ab281ffd94f7a9e2aba85fbc168e57ae1744fa9da8a88"><div class="ttname"><a href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a9e2aba85fbc168e57ae1744fa9da8a88">LOG_START_CHKPT</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00587">log_impl.h:587</a></div></div>
<div class="ttc" id="file__io_8h_html_a1e52f91b8452ad233fce9196397ed45da4ca4365d4e2f0ed4986de6b8a1c3538c"><div class="ttname"><a href="file__io_8h.html#a1e52f91b8452ad233fce9196397ed45da4ca4365d4e2f0ed4986de6b8a1c3538c">FILEIO_BACKUP_FULL_LEVEL</a></div><div class="ttdef"><b>Definition:</b> <a href="file__io_8h_source.html#l00090">file_io.h:90</a></div></div>
<div class="ttc" id="structbackground__archiving__info_html_addf88471d7c9b883a744ed73332204c3"><div class="ttname"><a href="structbackground__archiving__info.html#addf88471d7c9b883a744ed73332204c3">background_archiving_info::vdes</a></div><div class="ttdeci">int vdes</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00391">log_impl.h:391</a></div></div>
<div class="ttc" id="structlog__arv__header_html_ade257335bdf0e8058db6f2004f2c39c4"><div class="ttname"><a href="structlog__arv__header.html#ade257335bdf0e8058db6f2004f2c39c4">log_arv_header::db_creation</a></div><div class="ttdeci">INT64 db_creation</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00416">log_impl.h:416</a></div></div>
<div class="ttc" id="log__impl_8h_html_aaa150f6c2ae6a1748640ab281ffd94f7aa83e8becd5b186f65485f6e819e416ea"><div class="ttname"><a href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7aa83e8becd5b186f65485f6e819e416ea">LOG_2PC_PREPARE</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00590">log_impl.h:590</a></div></div>
<div class="ttc" id="structlog__tdes_html_a192e60c7a47b3874e40d640a0f4fc8f5"><div class="ttname"><a href="structlog__tdes.html#a192e60c7a47b3874e40d640a0f4fc8f5">log_tdes::client_id</a></div><div class="ttdeci">int client_id</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01707">log_impl.h:1707</a></div></div>
<div class="ttc" id="error__manager_8c_html_afdaf87ce30f2f557802a185ab85b6599"><div class="ttname"><a href="error__manager_8c.html#afdaf87ce30f2f557802a185ab85b6599">er_set</a></div><div class="ttdeci">void er_set(int severity, const char *file_name, const int line_no, int err_id, int num_args,...)</div><div class="ttdef"><b>Definition:</b> <a href="error__manager_8c_source.html#l01213">error_manager.c:1213</a></div></div>
<div class="ttc" id="lock__manager_8c_html_a7a4552847269854167212acb2d02de60"><div class="ttname"><a href="lock__manager_8c.html#a7a4552847269854167212acb2d02de60">lock_unlock_all</a></div><div class="ttdeci">void lock_unlock_all(THREAD_ENTRY *thread_p)</div><div class="ttdef"><b>Definition:</b> <a href="lock__manager_8c_source.html#l07101">lock_manager.c:7101</a></div></div>
<div class="ttc" id="xserver__interface_8h_html_a8e1f6f9672d860f0cd4dd45806e8461d"><div class="ttname"><a href="xserver__interface_8h.html#a8e1f6f9672d860f0cd4dd45806e8461d">xdisk_get_fullname</a></div><div class="ttdeci">char * xdisk_get_fullname(THREAD_ENTRY *thread_p, VOLID volid, char *vol_fullname)</div><div class="ttdef"><b>Definition:</b> <a href="disk__manager_8c_source.html#l05730">disk_manager.c:5730</a></div></div>
<div class="ttc" id="server__support_8c_html_adc1b9bc6e1d670a3eacb31fc3c953820"><div class="ttname"><a href="server__support_8c.html#adc1b9bc6e1d670a3eacb31fc3c953820">css_push_external_task</a></div><div class="ttdeci">void css_push_external_task(CSS_CONN_ENTRY *conn, cubthread::entry_task *task)</div><div class="ttdef"><b>Definition:</b> <a href="server__support_8c_source.html#l02836">server_support.c:2836</a></div></div>
<div class="ttc" id="slotted__page_8c_html_ac4e01996e09e34fc3db406713fdd4aa6"><div class="ttname"><a href="slotted__page_8c.html#ac4e01996e09e34fc3db406713fdd4aa6">spage_free_saved_spaces</a></div><div class="ttdeci">void spage_free_saved_spaces(THREAD_ENTRY *thread_p, void *first_save_entry)</div><div class="ttdef"><b>Definition:</b> <a href="slotted__page_8c_source.html#l00359">slotted_page.c:359</a></div></div>
<div class="ttc" id="log__impl_8h_html_aaa150f6c2ae6a1748640ab281ffd94f7ae96755081dc4d3599f98356864dfd7e0"><div class="ttname"><a href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7ae96755081dc4d3599f98356864dfd7e0">LOG_SAVEPOINT</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00589">log_impl.h:589</a></div></div>
<div class="ttc" id="structlog__header_html_aea3e448b088d656208b3d975797e7e6d"><div class="ttname"><a href="structlog__header.html#aea3e448b088d656208b3d975797e7e6d">log_header::db_restore_time</a></div><div class="ttdeci">INT64 db_restore_time</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00245">log_impl.h:245</a></div></div>
<div class="ttc" id="filter__pred__cache_8h_html"><div class="ttname"><a href="filter__pred__cache_8h.html">filter_pred_cache.h</a></div></div>
<div class="ttc" id="log__impl_8h_html_ab5c84aff4d15372a2d150897ad6d2b80"><div class="ttname"><a href="log__impl_8h.html#ab5c84aff4d15372a2d150897ad6d2b80">logpb_flush_pages_direct</a></div><div class="ttdeci">void logpb_flush_pages_direct(THREAD_ENTRY *thread_p)</div><div class="ttdef"><b>Definition:</b> <a href="log__page__buffer_8c_source.html#l05013">log_page_buffer.c:5013</a></div></div>
<div class="ttc" id="get__shard__id_8c_html_aae3371f3a2ed27aefae9c4e26982fc99"><div class="ttname"><a href="get__shard__id_8c.html#aae3371f3a2ed27aefae9c4e26982fc99">LINE_MAX</a></div><div class="ttdeci">#define LINE_MAX</div><div class="ttdef"><b>Definition:</b> <a href="get__shard__id_8c_source.html#l00042">get_shard_id.c:42</a></div></div>
<div class="ttc" id="structlog__rec__chkpt_html_af3d8e20ddd54a1e43d1b57d120a27bf8"><div class="ttname"><a href="structlog__rec__chkpt.html#af3d8e20ddd54a1e43d1b57d120a27bf8">log_rec_chkpt::ntops</a></div><div class="ttdeci">int ntops</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01601">log_impl.h:1601</a></div></div>
<div class="ttc" id="log__manager_8c_html_a3f7aa6e8738dd9b63a10f6476b5161bc"><div class="ttname"><a href="log__manager_8c.html#a3f7aa6e8738dd9b63a10f6476b5161bc">log_read_sysop_start_postpone</a></div><div class="ttdeci">int log_read_sysop_start_postpone(THREAD_ENTRY *thread_p, LOG_LSA *log_lsa, LOG_PAGE *log_page, bool with_undo_data, LOG_REC_SYSOP_START_POSTPONE *sysop_start_postpone, int *undo_buffer_size, char **undo_buffer, int *undo_size, char **undo_data)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l10213">log_manager.c:10213</a></div></div>
<div class="ttc" id="file__io_8c_html_a251cdd92358703f9c482c5d84f8d7dc0"><div class="ttname"><a href="file__io_8c.html#a251cdd92358703f9c482c5d84f8d7dc0">fileio_get_volume_label</a></div><div class="ttdeci">char * fileio_get_volume_label(VOLID vol_id, bool is_peek)</div><div class="ttdef"><b>Definition:</b> <a href="file__io_8c_source.html#l06090">file_io.c:6090</a></div></div>
<div class="ttc" id="structlog__rec__sysop__start__postpone_html_a75ba94263889a5daa036f05cb3a453dc"><div class="ttname"><a href="structlog__rec__sysop__start__postpone.html#a75ba94263889a5daa036f05cb3a453dc">log_rec_sysop_start_postpone::sysop_end</a></div><div class="ttdeci">LOG_REC_SYSOP_END sysop_end</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01582">log_impl.h:1582</a></div></div>
<div class="ttc" id="log__impl_8h_html_ad2c80360c1561744c3631fa2570ff1c4"><div class="ttname"><a href="log__impl_8h.html#ad2c80360c1561744c3631fa2570ff1c4">LOG_SYSOP_END_TYPE</a></div><div class="ttdeci">enum log_sysop_end_type LOG_SYSOP_END_TYPE</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01548">log_impl.h:1548</a></div></div>
<div class="ttc" id="error__code_8h_html_a9734d930fa5948c8b0c1c9170e67c809"><div class="ttname"><a href="error__code_8h.html#a9734d930fa5948c8b0c1c9170e67c809">ER_HA_REPL_DELAY_DETECTED</a></div><div class="ttdeci">#define ER_HA_REPL_DELAY_DETECTED</div><div class="ttdef"><b>Definition:</b> <a href="error__code_8h_source.html#l01278">error_code.h:1278</a></div></div>
<div class="ttc" id="log__manager_8c_html_a6e6203b82cc1468c2d16162ec6796aff"><div class="ttname"><a href="log__manager_8c.html#a6e6203b82cc1468c2d16162ec6796aff">log_complete_for_2pc</a></div><div class="ttdeci">TRAN_STATE log_complete_for_2pc(THREAD_ENTRY *thread_p, LOG_TDES *tdes, LOG_RECTYPE iscommitted, LOG_GETNEWTRID get_newtrid)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l06126">log_manager.c:6126</a></div></div>
<div class="ttc" id="structbo__restart__arg_html"><div class="ttname"><a href="structbo__restart__arg.html">bo_restart_arg</a></div><div class="ttdef"><b>Definition:</b> <a href="storage__common_8h_source.html#l00575">storage_common.h:575</a></div></div>
<div class="ttc" id="log__impl_8h_html_aaa150f6c2ae6a1748640ab281ffd94f7ac17426d82957cd6c312341d4f5badd87"><div class="ttname"><a href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7ac17426d82957cd6c312341d4f5badd87">LOG_REDO_DATA</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00536">log_impl.h:536</a></div></div>
<div class="ttc" id="log__impl_8h_html_a73baa6645b24b8b7c11e7ec7f4f53e8caf17ce35fc60e09af740a57c5eb5a338c"><div class="ttname"><a href="log__impl_8h.html#a73baa6645b24b8b7c11e7ec7f4f53e8caf17ce35fc60e09af740a57c5eb5a338c">LOG_2PC_EXECUTE_FULL</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01242">log_impl.h:1242</a></div></div>
<div class="ttc" id="storage__common_8h_html_aa90a06bd1f1a9925ac8ef0f856d1d872"><div class="ttname"><a href="storage__common_8h.html#aa90a06bd1f1a9925ac8ef0f856d1d872">LSA_GE</a></div><div class="ttdeci">#define LSA_GE(lsa_ptr1, lsa_ptr2)</div><div class="ttdef"><b>Definition:</b> <a href="storage__common_8h_source.html#l00155">storage_common.h:155</a></div></div>
<div class="ttc" id="log__manager_8c_html_aa93022b3b73e1ae38f14554977bbe6c5"><div class="ttname"><a href="log__manager_8c.html#aa93022b3b73e1ae38f14554977bbe6c5">log_rv_copy_char</a></div><div class="ttdeci">int log_rv_copy_char(THREAD_ENTRY *thread_p, LOG_RCV *rcv)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l09355">log_manager.c:9355</a></div></div>
<div class="ttc" id="structlog__rcv_html_a04db9f252907cff6ca339534e8c4f642"><div class="ttname"><a href="structlog__rcv.html#a04db9f252907cff6ca339534e8c4f642">log_rcv::pgptr</a></div><div class="ttdeci">PAGE_PTR pgptr</div><div class="ttdef"><b>Definition:</b> <a href="recovery_8h_source.html#l00192">recovery.h:192</a></div></div>
<div class="ttc" id="log__manager_8c_html_af7bfbd98d66410cc6e3d1d050cec24ec"><div class="ttname"><a href="log__manager_8c.html#af7bfbd98d66410cc6e3d1d050cec24ec">log_skip_logging</a></div><div class="ttdeci">void log_skip_logging(THREAD_ENTRY *thread_p, LOG_DATA_ADDR *addr)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l03270">log_manager.c:3270</a></div></div>
<div class="ttc" id="system__parameter_8h_html_a23aaf6bca406b9b428f43ad1b6b2b3e0a24522bca59b73bae2a49d5cfd7c5eed3"><div class="ttname"><a href="system__parameter_8h.html#a23aaf6bca406b9b428f43ad1b6b2b3e0a24522bca59b73bae2a49d5cfd7c5eed3">PRM_ID_LOG_BACKGROUND_ARCHIVING</a></div><div class="ttdef"><b>Definition:</b> <a href="system__parameter_8h_source.html#l00130">system_parameter.h:130</a></div></div>
<div class="ttc" id="structlog__repl_html_ab796c9584a750f2604278befaefbdb93"><div class="ttname"><a href="structlog__repl.html#ab796c9584a750f2604278befaefbdb93">log_repl::length</a></div><div class="ttdeci">int length</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01510">log_impl.h:1510</a></div></div>
<div class="ttc" id="log__manager_8c_html_a9947563d0c9dba8024923957fb69bb85"><div class="ttname"><a href="log__manager_8c.html#a9947563d0c9dba8024923957fb69bb85">log_is_logged_since_restart</a></div><div class="ttdeci">bool log_is_logged_since_restart(const LOG_LSA *lsa_ptr)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l00638">log_manager.c:638</a></div></div>
<div class="ttc" id="structlog__global_html_a7f624279622c1c0c52492877129f95c6"><div class="ttname"><a href="structlog__global.html#a7f624279622c1c0c52492877129f95c6">log_global::rcv_phase</a></div><div class="ttdeci">LOG_RECVPHASE rcv_phase</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01950">log_impl.h:1950</a></div></div>
<div class="ttc" id="structlog__global_html_a7e0857f2c37da4e5285573f7167ed5a1"><div class="ttname"><a href="structlog__global.html#a7e0857f2c37da4e5285573f7167ed5a1">log_global::append</a></div><div class="ttdeci">LOG_APPEND_INFO append</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01939">log_impl.h:1939</a></div></div>
<div class="ttc" id="namespacecubperf_html_a9bd811041d330e1704e2b1ba756bed34"><div class="ttname"><a href="namespacecubperf.html#a9bd811041d330e1704e2b1ba756bed34">cubperf::time_point</a></div><div class="ttdeci">clock::time_point time_point</div><div class="ttdef"><b>Definition:</b> <a href="perf__def_8hpp_source.html#l00041">perf_def.hpp:41</a></div></div>
<div class="ttc" id="error__code_8h_html_a2f6caf428982f062d3baad1927f74676"><div class="ttname"><a href="error__code_8h.html#a2f6caf428982f062d3baad1927f74676">ER_LK_PAGE_TIMEOUT</a></div><div class="ttdeci">#define ER_LK_PAGE_TIMEOUT</div><div class="ttdef"><b>Definition:</b> <a href="error__code_8h_source.html#l00130">error_code.h:130</a></div></div>
<div class="ttc" id="structlog__prior__lsa__info_html_ac2dc752b216f5b6c9d60aa082d35609a"><div class="ttname"><a href="structlog__prior__lsa__info.html#ac2dc752b216f5b6c9d60aa082d35609a">log_prior_lsa_info::prior_lsa</a></div><div class="ttdeci">LOG_LSA prior_lsa</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01869">log_impl.h:1869</a></div></div>
<div class="ttc" id="log__global_8c_html_a65818d3fd50e018ad0787dee588d7b25"><div class="ttname"><a href="log__global_8c.html#a65818d3fd50e018ad0787dee588d7b25">log_Name_info</a></div><div class="ttdeci">char log_Name_info[PATH_MAX]</div><div class="ttdef"><b>Definition:</b> <a href="log__global_8c_source.html#l00116">log_global.c:116</a></div></div>
<div class="ttc" id="structlog__header_html_aa32d860a02d9a2da846a3b9dfc17ce97"><div class="ttname"><a href="structlog__header.html#aa32d860a02d9a2da846a3b9dfc17ce97">log_header::fpageid</a></div><div class="ttdeci">LOG_PAGEID fpageid</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00213">log_impl.h:213</a></div></div>
<div class="ttc" id="log__manager_8c_html_aae3120d951badf0f042b20d1039584ff"><div class="ttname"><a href="log__manager_8c.html#aae3120d951badf0f042b20d1039584ff">log_final</a></div><div class="ttdeci">void log_final(THREAD_ENTRY *thread_p)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l01705">log_manager.c:1705</a></div></div>
<div class="ttc" id="structvfid_html_a5ffe7d18a4d504c67610dfd928774ad6"><div class="ttname"><a href="structvfid.html#a5ffe7d18a4d504c67610dfd928774ad6">vfid::fileid</a></div><div class="ttdeci">int32_t fileid</div><div class="ttdef"><b>Definition:</b> <a href="dbtype__def_8h_source.html#l00911">dbtype_def.h:911</a></div></div>
<div class="ttc" id="page__buffer_8h_html_aafea7625b165348a0cf4715f54301603a4bffd61081f056fbc5a197836b0d82d2"><div class="ttname"><a href="page__buffer_8h.html#aafea7625b165348a0cf4715f54301603a4bffd61081f056fbc5a197836b0d82d2">PGBUF_UNCONDITIONAL_LATCH</a></div><div class="ttdef"><b>Definition:</b> <a href="page__buffer_8h_source.html#l00185">page_buffer.h:185</a></div></div>
<div class="ttc" id="structlog__append__info_html_a2a19250fa5f61b17a808f3523394001f"><div class="ttname"><a href="structlog__append__info.html#a2a19250fa5f61b17a808f3523394001f">log_append_info::log_pgptr</a></div><div class="ttdeci">LOG_PAGE * log_pgptr</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01207">log_impl.h:1207</a></div></div>
<div class="ttc" id="recovery_8h_html_a526c4dc065c989256afca8b3b56d4d2ba74979a9555a5d5f1ae0e879ccf00e184"><div class="ttname"><a href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2ba74979a9555a5d5f1ae0e879ccf00e184">RVBT_LOG_GLOBAL_UNIQUE_STATS_COMMIT</a></div><div class="ttdef"><b>Definition:</b> <a href="recovery_8h_source.html#l00128">recovery.h:128</a></div></div>
<div class="ttc" id="expat_8h_html_a9ce2ec4812a92cb6ab39f6e81e9173a9"><div class="ttname"><a href="expat_8h.html#a9ce2ec4812a92cb6ab39f6e81e9173a9">arg</a></div><div class="ttdeci">void * arg</div><div class="ttdef"><b>Definition:</b> <a href="expat_8h_source.html#l00582">expat.h:582</a></div></div>
<div class="ttc" id="log__impl_8h_html_aaa150f6c2ae6a1748640ab281ffd94f7a29a7c510ffdadeb0e4c5304e6825a5ec"><div class="ttname"><a href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a29a7c510ffdadeb0e4c5304e6825a5ec">LOG_SYSOP_END</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00558">log_impl.h:558</a></div></div>
<div class="ttc" id="recovery_8h_html_a526c4dc065c989256afca8b3b56d4d2ba8f43c180538657b73f7f59fbefbd22c8"><div class="ttname"><a href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2ba8f43c180538657b73f7f59fbefbd22c8">RVHF_INSERT</a></div><div class="ttdef"><b>Definition:</b> <a href="recovery_8h_source.html#l00082">recovery.h:82</a></div></div>
<div class="ttc" id="structlob__savepoint__entry_html_aa8e71ec03245bca07f9b9734738b4149"><div class="ttname"><a href="structlob__savepoint__entry.html#aa8e71ec03245bca07f9b9734738b4149">lob_savepoint_entry::state</a></div><div class="ttdeci">LOB_LOCATOR_STATE state</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l00160">log_manager.c:160</a></div></div>
<div class="ttc" id="system__parameter_8c_html_aae71e771e08cd2d0452c346650a8da98"><div class="ttname"><a href="system__parameter_8c.html#aae71e771e08cd2d0452c346650a8da98">prm_get_integer_value</a></div><div class="ttdeci">int prm_get_integer_value(PARAM_ID prm_id)</div><div class="ttdef"><b>Definition:</b> <a href="system__parameter_8c_source.html#l10445">system_parameter.c:10445</a></div></div>
<div class="ttc" id="log__impl_8h_html_ac35dbc3c280632065bc9b67d1a29bc21"><div class="ttname"><a href="log__impl_8h.html#ac35dbc3c280632065bc9b67d1a29bc21">logpb_fetch_start_append_page</a></div><div class="ttdeci">int logpb_fetch_start_append_page(THREAD_ENTRY *thread_p)</div><div class="ttdef"><b>Definition:</b> <a href="log__page__buffer_8c_source.html#l02401">log_page_buffer.c:2401</a></div></div>
<div class="ttc" id="page__buffer_8c_html_a4d36b807bfa07b2b42d1faa0274655e3"><div class="ttname"><a href="page__buffer_8c.html#a4d36b807bfa07b2b42d1faa0274655e3">pgbuf_get_lsa</a></div><div class="ttdeci">LOG_LSA * pgbuf_get_lsa(PAGE_PTR pgptr)</div><div class="ttdef"><b>Definition:</b> <a href="page__buffer_8c_source.html#l04360">page_buffer.c:4360</a></div></div>
<div class="ttc" id="log__impl_8h_html_af18a3c0b2ebcb342344e71db70c4f1c1"><div class="ttname"><a href="log__impl_8h.html#af18a3c0b2ebcb342344e71db70c4f1c1">log_Stat</a></div><div class="ttdeci">LOG_LOGGING_STAT log_Stat</div><div class="ttdef"><b>Definition:</b> <a href="log__page__buffer_8c_source.html#l00294">log_page_buffer.c:294</a></div></div>
<div class="ttc" id="structvfid_html"><div class="ttname"><a href="structvfid.html">vfid</a></div><div class="ttdef"><b>Definition:</b> <a href="dbtype__def_8h_source.html#l00909">dbtype_def.h:909</a></div></div>
<div class="ttc" id="log__impl_8h_html_af65c435e9509efe8e005c094e49a0b2fa0ccf60db52a36e795a53906683f34b26"><div class="ttname"><a href="log__impl_8h.html#af65c435e9509efe8e005c094e49a0b2fa0ccf60db52a36e795a53906683f34b26">LOG_ALREADY_WROTE_EOT_LOG</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01088">log_impl.h:1088</a></div></div>
<div class="ttc" id="structlog__tdes_html_a4e3335b7f0e4ca7f858416446ae8f782"><div class="ttname"><a href="structlog__tdes.html#a4e3335b7f0e4ca7f858416446ae8f782">log_tdes::undo_nxlsa</a></div><div class="ttdeci">LOG_LSA undo_nxlsa</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01700">log_impl.h:1700</a></div></div>
<div class="ttc" id="structlog__rec__chkpt_html_a7ffc41738640c267a1c3c58d16ac5e9d"><div class="ttname"><a href="structlog__rec__chkpt.html#a7ffc41738640c267a1c3c58d16ac5e9d">log_rec_chkpt::ntrans</a></div><div class="ttdeci">int ntrans</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01600">log_impl.h:1600</a></div></div>
<div class="ttc" id="structlog__topop__range_html_ad4fb3b4332309daa2b923b17de58498c"><div class="ttname"><a href="structlog__topop__range.html#ad4fb3b4332309daa2b923b17de58498c">log_topop_range::start_lsa</a></div><div class="ttdeci">LOG_LSA start_lsa</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8h_source.html#l00052">log_manager.h:52</a></div></div>
<div class="ttc" id="log__impl_8h_html_aa81dc352329c9f96467c795c1547be74"><div class="ttname"><a href="log__impl_8h.html#aa81dc352329c9f96467c795c1547be74">LOG_ISTRAN_ACTIVE</a></div><div class="ttdeci">#define LOG_ISTRAN_ACTIVE(tdes)</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00956">log_impl.h:956</a></div></div>
<div class="ttc" id="structlog__rec__sysop__end_html"><div class="ttname"><a href="structlog__rec__sysop__end.html">log_rec_sysop_end</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01559">log_impl.h:1559</a></div></div>
<div class="ttc" id="namespacecubperf_html_a9e08ee211bc3c0d0d0462ba274bf9f6b"><div class="ttname"><a href="namespacecubperf.html#a9e08ee211bc3c0d0d0462ba274bf9f6b">cubperf::clock</a></div><div class="ttdeci">std::chrono::high_resolution_clock clock</div><div class="ttdef"><b>Definition:</b> <a href="perf__def_8hpp_source.html#l00040">perf_def.hpp:40</a></div></div>
<div class="ttc" id="structlob__savepoint__entry_html_a8be0cf46b6d7ca084114befa450fcd4a"><div class="ttname"><a href="structlob__savepoint__entry.html#a8be0cf46b6d7ca084114befa450fcd4a">lob_savepoint_entry::savept_lsa</a></div><div class="ttdeci">LOG_LSA savept_lsa</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l00161">log_manager.c:161</a></div></div>
<div class="ttc" id="log__manager_8c_html_acbe7c7db028f78d1f9ceda699b93c74e"><div class="ttname"><a href="log__manager_8c.html#acbe7c7db028f78d1f9ceda699b93c74e">LOG_NEED_TO_SET_LSA</a></div><div class="ttdeci">#define LOG_NEED_TO_SET_LSA(RCVI, PGPTR)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l00136">log_manager.c:136</a></div></div>
<div class="ttc" id="structlog__header_html_a31fef6acfb938132c62b4623cd1ad953"><div class="ttname"><a href="structlog__header.html#a31fef6acfb938132c62b4623cd1ad953">log_header::db_logpagesize</a></div><div class="ttdeci">PGLENGTH db_logpagesize</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00201">log_impl.h:201</a></div></div>
<div class="ttc" id="vacuum_8h_html_addf44811efa9c66ec7896f7dc2dc20eb"><div class="ttname"><a href="vacuum_8h.html#addf44811efa9c66ec7896f7dc2dc20eb">VACUUM_IS_THREAD_VACUUM_WORKER</a></div><div class="ttdeci">#define VACUUM_IS_THREAD_VACUUM_WORKER</div><div class="ttdef"><b>Definition:</b> <a href="vacuum_8h_source.html#l00276">vacuum.h:276</a></div></div>
<div class="ttc" id="log__impl_8h_html_adab64773ba835fc0f3e7ab4f9b382e5c"><div class="ttname"><a href="log__impl_8h.html#adab64773ba835fc0f3e7ab4f9b382e5c">logtb_realloc_topops_stack</a></div><div class="ttdeci">void * logtb_realloc_topops_stack(LOG_TDES *tdes, int num_elms)</div><div class="ttdef"><b>Definition:</b> <a href="log__tran__table_8c_source.html#l00193">log_tran_table.c:193</a></div></div>
<div class="ttc" id="error__code_8h_html_a1f7116a1f1981bc7ef25fc6078518692"><div class="ttname"><a href="error__code_8h.html#a1f7116a1f1981bc7ef25fc6078518692">ER_OUT_OF_VIRTUAL_MEMORY</a></div><div class="ttdeci">#define ER_OUT_OF_VIRTUAL_MEMORY</div><div class="ttdef"><b>Definition:</b> <a href="error__code_8h_source.html#l00046">error_code.h:46</a></div></div>
<div class="ttc" id="log__impl_8h_html_ac738f2699dc478c4bb643fdb176f26de"><div class="ttname"><a href="log__impl_8h.html#ac738f2699dc478c4bb643fdb176f26de">LOG_HAS_LOGGING_BEEN_IGNORED</a></div><div class="ttdeci">#define LOG_HAS_LOGGING_BEEN_IGNORED()</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01027">log_impl.h:1027</a></div></div>
<div class="ttc" id="log__manager_8c_html_ab689c730c941c75daa26b5d968070f3c"><div class="ttname"><a href="log__manager_8c.html#ab689c730c941c75daa26b5d968070f3c">log_append_undo_data</a></div><div class="ttdeci">void log_append_undo_data(THREAD_ENTRY *thread_p, LOG_RCVINDEX rcvindex, LOG_DATA_ADDR *addr, int length, const void *data)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l01947">log_manager.c:1947</a></div></div>
<div class="ttc" id="boot_8h_html_aced830d72ca3bc3b775113c1d75a2368a32850340dc1da2b58e0909bccd11a898"><div class="ttname"><a href="boot_8h.html#aced830d72ca3bc3b775113c1d75a2368a32850340dc1da2b58e0909bccd11a898">HA_SERVER_STATE_ACTIVE</a></div><div class="ttdef"><b>Definition:</b> <a href="boot_8h_source.html#l00149">boot.h:149</a></div></div>
<div class="ttc" id="structbackground__archiving__info_html_a1a185832de42bb7b9dd1a1d527161e64"><div class="ttname"><a href="structbackground__archiving__info.html#a1a185832de42bb7b9dd1a1d527161e64">background_archiving_info::current_page_id</a></div><div class="ttdeci">LOG_PAGEID current_page_id</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00389">log_impl.h:389</a></div></div>
<div class="ttc" id="log__impl_8h_html_a08fee41cfcf592e8afdbc4988ffbc8e4"><div class="ttname"><a href="log__impl_8h.html#a08fee41cfcf592e8afdbc4988ffbc8e4">LOG_FIND_TDES</a></div><div class="ttdeci">#define LOG_FIND_TDES(tran_index)</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00945">log_impl.h:945</a></div></div>
<div class="ttc" id="structmodified__class__entry_html_aa2c44513a27ed926f4547a0ae65c9d31"><div class="ttname"><a href="structmodified__class__entry.html#aa2c44513a27ed926f4547a0ae65c9d31">modified_class_entry::m_classname</a></div><div class="ttdeci">const char * m_classname</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01298">log_impl.h:1298</a></div></div>
<div class="ttc" id="log__impl_8h_html_abe26fd2d0581fbb5221bfcebec7db16e"><div class="ttname"><a href="log__impl_8h.html#abe26fd2d0581fbb5221bfcebec7db16e">logpb_initialize_logging_statistics</a></div><div class="ttdeci">void logpb_initialize_logging_statistics(void)</div><div class="ttdef"><b>Definition:</b> <a href="log__page__buffer_8c_source.html#l11750">log_page_buffer.c:11750</a></div></div>
<div class="ttc" id="structlog__header_html_aff6ddf3e8b9f68931ffd114fb90899a5"><div class="ttname"><a href="structlog__header.html#aff6ddf3e8b9f68931ffd114fb90899a5">log_header::last_deleted_arv_num</a></div><div class="ttdeci">int last_deleted_arv_num</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00220">log_impl.h:220</a></div></div>
<div class="ttc" id="structlog__header_html_a04c9c76cfc0ca96fd6f9f5f68d3bd87c"><div class="ttname"><a href="structlog__header.html#a04c9c76cfc0ca96fd6f9f5f68d3bd87c">log_header::ha_server_state</a></div><div class="ttdeci">int ha_server_state</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00234">log_impl.h:234</a></div></div>
<div class="ttc" id="log__impl_8h_html_a10dc05607248603c703e1c9d1e5a5b0f"><div class="ttname"><a href="log__impl_8h.html#a10dc05607248603c703e1c9d1e5a5b0f">logpb_initialize_pool</a></div><div class="ttdeci">int logpb_initialize_pool(THREAD_ENTRY *thread_p)</div><div class="ttdef"><b>Definition:</b> <a href="log__page__buffer_8c_source.html#l00602">log_page_buffer.c:602</a></div></div>
<div class="ttc" id="log__impl_8h_html_ae9a4d783eb0cfe14758c502723d73ed4"><div class="ttname"><a href="log__impl_8h.html#ae9a4d783eb0cfe14758c502723d73ed4">logpb_perm_status_to_string</a></div><div class="ttdeci">const char * logpb_perm_status_to_string(enum LOG_PSTATUS val)</div><div class="ttdef"><b>Definition:</b> <a href="log__page__buffer_8c_source.html#l12235">log_page_buffer.c:12235</a></div></div>
<div class="ttc" id="structlog__page_html_a9b51b4623cdb8d1686f6f8fb64bc9ee2"><div class="ttname"><a href="structlog__page.html#a9b51b4623cdb8d1686f6f8fb64bc9ee2">log_page::area</a></div><div class="ttdeci">char area[1]</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00146">log_impl.h:146</a></div></div>
<div class="ttc" id="src_2base_2rb__tree_8h_html_a0827c86d4c8c63495f665141d857f380"><div class="ttname"><a href="src_2base_2rb__tree_8h.html#a0827c86d4c8c63495f665141d857f380">RB_MIN</a></div><div class="ttdeci">#define RB_MIN(name, x)</div><div class="ttdef"><b>Definition:</b> <a href="src_2base_2rb__tree_8h_source.html#l00472">rb_tree.h:472</a></div></div>
<div class="ttc" id="structlog__rec__sysop__start__postpone_html_a7a4784f826dbfb985de3cdeafce2a202"><div class="ttname"><a href="structlog__rec__sysop__start__postpone.html#a7a4784f826dbfb985de3cdeafce2a202">log_rec_sysop_start_postpone::posp_lsa</a></div><div class="ttdeci">LOG_LSA posp_lsa</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01583">log_impl.h:1583</a></div></div>
<div class="ttc" id="log__impl_8h_html_aaa150f6c2ae6a1748640ab281ffd94f7a1ec512ba54217805936aa5afb03b3d98"><div class="ttname"><a href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a1ec512ba54217805936aa5afb03b3d98">LOG_DUMMY_CRASH_RECOVERY</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00601">log_impl.h:601</a></div></div>
<div class="ttc" id="log__manager_8h_html_a6160ad5bb57554497e3183a7d61b3598"><div class="ttname"><a href="log__manager_8h.html#a6160ad5bb57554497e3183a7d61b3598">log_wakeup_checkpoint_daemon</a></div><div class="ttdeci">void log_wakeup_checkpoint_daemon()</div></div>
<div class="ttc" id="structlog__global_html_a54df6484811f3eeaceb445c50426e066"><div class="ttname"><a href="structlog__global.html#a54df6484811f3eeaceb445c50426e066">log_global::final_restored_lsa</a></div><div class="ttdeci">LOG_LSA final_restored_lsa</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01956">log_impl.h:1956</a></div></div>
<div class="ttc" id="log__manager_8c_html_ada4567801f3c4fec0f0dcd8096408fd8"><div class="ttname"><a href="log__manager_8c.html#ada4567801f3c4fec0f0dcd8096408fd8">log_append_redo_recdes2</a></div><div class="ttdeci">void log_append_redo_recdes2(THREAD_ENTRY *thread_p, LOG_RCVINDEX rcvindex, const VFID *vfid, PAGE_PTR pgptr, PGLENGTH offset, const RECDES *recdes)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l02598">log_manager.c:2598</a></div></div>
<div class="ttc" id="structdisk__volume__space__info_html_a5d523352ce9703b23a43d172b3ce6aaf"><div class="ttname"><a href="structdisk__volume__space__info.html#a5d523352ce9703b23a43d172b3ce6aaf">disk_volume_space_info::n_total_sects</a></div><div class="ttdeci">INT32 n_total_sects</div><div class="ttdef"><b>Definition:</b> <a href="disk__manager_8h_source.html#l00064">disk_manager.h:64</a></div></div>
<div class="ttc" id="log__manager_8c_html_a0f43301a77dc33dd0c1a66f9d1ec9aac"><div class="ttname"><a href="log__manager_8c.html#a0f43301a77dc33dd0c1a66f9d1ec9aac">LOG_TDES_LAST_SYSOP_POSP_LSA</a></div><div class="ttdeci">#define LOG_TDES_LAST_SYSOP_POSP_LSA(tdes)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l00205">log_manager.c:205</a></div></div>
<div class="ttc" id="log__manager_8c_html_a4fc5a0d28e92e601bb3f8d8d53a8e29c"><div class="ttname"><a href="log__manager_8c.html#a4fc5a0d28e92e601bb3f8d8d53a8e29c">log_is_log_flush_daemon_available</a></div><div class="ttdeci">bool log_is_log_flush_daemon_available()</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l10390">log_manager.c:10390</a></div></div>
<div class="ttc" id="structrecdes_html"><div class="ttname"><a href="structrecdes.html">recdes</a></div><div class="ttdef"><b>Definition:</b> <a href="storage__common_8h_source.html#l00340">storage_common.h:340</a></div></div>
<div class="ttc" id="log__impl_8h_html_aaa150f6c2ae6a1748640ab281ffd94f7ab4e00d9048c5782ee68b646ff785f6de"><div class="ttname"><a href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7ab4e00d9048c5782ee68b646ff785f6de">LOG_MVCC_UNDOREDO_DATA</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00617">log_impl.h:617</a></div></div>
<div class="ttc" id="log__impl_8h_html_aaa150f6c2ae6a1748640ab281ffd94f7a034d486f56b110bc31fba3b6db5dd980"><div class="ttname"><a href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a034d486f56b110bc31fba3b6db5dd980">LOG_END_OF_LOG</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00599">log_impl.h:599</a></div></div>
<div class="ttc" id="storage__common_8h_html_a4c9bc15296fe6728cf0351726cc6ad09"><div class="ttname"><a href="storage__common_8h.html#a4c9bc15296fe6728cf0351726cc6ad09">LSA_COPY</a></div><div class="ttdeci">STATIC_INLINE void LSA_COPY(LOG_LSA *plsa1, const LOG_LSA *plsa2)</div><div class="ttdef"><b>Definition:</b> <a href="storage__common_8h_source.html#l00113">storage_common.h:113</a></div></div>
<div class="ttc" id="connection__support_8c_html_a059c0aa783f09d15fc92c878ab3835ec"><div class="ttname"><a href="connection__support_8c.html#a059c0aa783f09d15fc92c878ab3835ec">css_ha_server_state_string</a></div><div class="ttdeci">const char * css_ha_server_state_string(HA_SERVER_STATE state)</div><div class="ttdef"><b>Definition:</b> <a href="connection__support_8c_source.html#l02143">connection_support.c:2143</a></div></div>
<div class="ttc" id="structlog__rec__savept_html_aa2bda94b58670443b2a14129a78a06fb"><div class="ttname"><a href="structlog__rec__savept.html#aa2bda94b58670443b2a14129a78a06fb">log_rec_savept::prv_savept</a></div><div class="ttdeci">LOG_LSA prv_savept</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01634">log_impl.h:1634</a></div></div>
<div class="ttc" id="log__manager_8c_html_a7dabe9d7858297fd2182b90398ca3a94"><div class="ttname"><a href="log__manager_8c.html#a7dabe9d7858297fd2182b90398ca3a94">log_sysop_end_recovery_postpone</a></div><div class="ttdeci">void log_sysop_end_recovery_postpone(THREAD_ENTRY *thread_p, LOG_REC_SYSOP_END *log_record, int data_size, const char *data)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l04083">log_manager.c:4083</a></div></div>
<div class="ttc" id="dbtype__def_8h_html_ae14c1fc20d3372b987bc4ea936f180f7"><div class="ttname"><a href="dbtype__def_8h.html#ae14c1fc20d3372b987bc4ea936f180f7">DB_INT32_MAX</a></div><div class="ttdeci">#define DB_INT32_MAX</div><div class="ttdef"><b>Definition:</b> <a href="dbtype__def_8h_source.html#l00658">dbtype_def.h:658</a></div></div>
<div class="ttc" id="structvpid_html"><div class="ttname"><a href="structvpid.html">vpid</a></div><div class="ttdef"><b>Definition:</b> <a href="dbtype__def_8h_source.html#l00902">dbtype_def.h:902</a></div></div>
<div class="ttc" id="structlog__rec__ha__server__state_html"><div class="ttname"><a href="structlog__rec__ha__server__state.html">log_rec_ha_server_state</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00759">log_impl.h:759</a></div></div>
<div class="ttc" id="disk__manager_8h_html_a1d6c5b1532a11cd17ca350cddf84aea6"><div class="ttname"><a href="disk__manager_8h.html#a1d6c5b1532a11cd17ca350cddf84aea6">DISK_SECTS_NPAGES</a></div><div class="ttdeci">#define DISK_SECTS_NPAGES(nsects)</div><div class="ttdef"><b>Definition:</b> <a href="disk__manager_8h_source.html#l00070">disk_manager.h:70</a></div></div>
<div class="ttc" id="cm__broker__admin_8c_html_a8606fb1d53339b43e7417d2f96db025f"><div class="ttname"><a href="cm__broker__admin_8c.html#a8606fb1d53339b43e7417d2f96db025f">INT64</a></div><div class="ttdeci">#define INT64</div><div class="ttdef"><b>Definition:</b> <a href="cm__broker__admin_8c_source.html#l00031">cm_broker_admin.c:31</a></div></div>
<div class="ttc" id="recovery_8c_html_ad2eee9d1e5914fa34d3a7868bf2549f4"><div class="ttname"><a href="recovery_8c.html#ad2eee9d1e5914fa34d3a7868bf2549f4">RV_fun</a></div><div class="ttdeci">struct rvfun RV_fun[]</div><div class="ttdef"><b>Definition:</b> <a href="recovery_8c_source.html#l00050">recovery.c:50</a></div></div>
<div class="ttc" id="structbackground__archiving__info_html_a7dfeb28ac4961a979f87f1de8d93192b"><div class="ttname"><a href="structbackground__archiving__info.html#a7dfeb28ac4961a979f87f1de8d93192b">background_archiving_info::last_sync_pageid</a></div><div class="ttdeci">LOG_PAGEID last_sync_pageid</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00390">log_impl.h:390</a></div></div>
<div class="ttc" id="structlog__topops__stack_html_a332cd1918ade0476cdb34f2b478b6944"><div class="ttname"><a href="structlog__topops__stack.html#a332cd1918ade0476cdb34f2b478b6944">log_topops_stack::max</a></div><div class="ttdeci">int max</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01289">log_impl.h:1289</a></div></div>
<div class="ttc" id="structlog__hdrpage_html_a1fd8a9a0219da51bb77b11766056f149"><div class="ttname"><a href="structlog__hdrpage.html#a1fd8a9a0219da51bb77b11766056f149">log_hdrpage::logical_pageid</a></div><div class="ttdeci">LOG_PAGEID logical_pageid</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00127">log_impl.h:127</a></div></div>
<div class="ttc" id="log__impl_8h_html_ac0cf574979e19ca9286ba21b23b482fa"><div class="ttname"><a href="log__impl_8h.html#ac0cf574979e19ca9286ba21b23b482fa">logpb_decache_archive_info</a></div><div class="ttdeci">void logpb_decache_archive_info(THREAD_ENTRY *thread_p)</div><div class="ttdef"><b>Definition:</b> <a href="log__page__buffer_8c_source.html#l06345">log_page_buffer.c:6345</a></div></div>
<div class="ttc" id="log__manager_8h_html_a4452d47a1c11bd369f280162473c067e"><div class="ttname"><a href="log__manager_8h.html#a4452d47a1c11bd369f280162473c067e">log_wakeup_remove_log_archive_daemon</a></div><div class="ttdeci">void log_wakeup_remove_log_archive_daemon()</div></div>
<div class="ttc" id="structlog__rec__mvcc__undo_html"><div class="ttname"><a href="structlog__rec__mvcc__undo.html">log_rec_mvcc_undo</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00698">log_impl.h:698</a></div></div>
<div class="ttc" id="log__comm_8h_html_a53ab06461fc97ae6864aa9485fa990f6"><div class="ttname"><a href="log__comm_8h.html#a53ab06461fc97ae6864aa9485fa990f6">TRAN_LOCK_INFINITE_WAIT</a></div><div class="ttdeci">#define TRAN_LOCK_INFINITE_WAIT</div><div class="ttdef"><b>Definition:</b> <a href="log__comm_8h_source.html#l00032">log_comm.h:32</a></div></div>
<div class="ttc" id="db__date_8c_html_a6e1d7212710fa8692140d38b660f1f6b"><div class="ttname"><a href="db__date_8c.html#a6e1d7212710fa8692140d38b660f1f6b">db_localdatetime</a></div><div class="ttdeci">void db_localdatetime(time_t *epoch_time, DB_DATETIME *datetime)</div><div class="ttdef"><b>Definition:</b> <a href="db__date_8c_source.html#l01030">db_date.c:1030</a></div></div>
<div class="ttc" id="structlog__tdes_html_ac2dac7e98c4049c6787fccd7faf3d92a"><div class="ttname"><a href="structlog__tdes.html#ac2dac7e98c4049c6787fccd7faf3d92a">log_tdes::savept_lsa</a></div><div class="ttdeci">LOG_LSA savept_lsa</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01704">log_impl.h:1704</a></div></div>
<div class="ttc" id="system_8h_html_abb452686968e48b67397da5f97445f5b"><div class="ttname"><a href="system_8h.html#abb452686968e48b67397da5f97445f5b">bool</a></div><div class="ttdeci">#define bool</div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00090">system.h:90</a></div></div>
<div class="ttc" id="structlog__rec__donetime_html_ab2f504036b88c922a0a3f1db4524d70b"><div class="ttname"><a href="structlog__rec__donetime.html#ab2f504036b88c922a0a3f1db4524d70b">log_rec_donetime::at_time</a></div><div class="ttdeci">INT64 at_time</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00726">log_impl.h:726</a></div></div>
<div class="ttc" id="log__impl_8h_html_a452399b8f7135d60770a82357dad5934"><div class="ttname"><a href="log__impl_8h.html#a452399b8f7135d60770a82357dad5934">LOG_APPEND_PTR</a></div><div class="ttdeci">#define LOG_APPEND_PTR()</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00879">log_impl.h:879</a></div></div>
<div class="ttc" id="log__manager_8c_html_abb91bc4aca8cb9ed6264576e8102979e"><div class="ttname"><a href="log__manager_8c.html#abb91bc4aca8cb9ed6264576e8102979e">log_append_compensate_with_undo_nxlsa</a></div><div class="ttdeci">void log_append_compensate_with_undo_nxlsa(THREAD_ENTRY *thread_p, LOG_RCVINDEX rcvindex, const VPID *vpid, PGLENGTH offset, PAGE_PTR pgptr, int length, const void *data, LOG_TDES *tdes, const LOG_LSA *undo_nxlsa)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l03018">log_manager.c:3018</a></div></div>
<div class="ttc" id="structlog__2pc__coordinator_html_aef73165750bf09cf443c6b363ab02965"><div class="ttname"><a href="structlog__2pc__coordinator.html#aef73165750bf09cf443c6b363ab02965">log_2pc_coordinator::num_particps</a></div><div class="ttdeci">int num_particps</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01262">log_impl.h:1262</a></div></div>
<div class="ttc" id="structlog__header_html_a42531bd822942e634a5af20b2123c10c"><div class="ttname"><a href="structlog__header.html#a42531bd822942e634a5af20b2123c10c">log_header::ha_file_status</a></div><div class="ttdeci">int ha_file_status</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00235">log_impl.h:235</a></div></div>
<div class="ttc" id="structcursor_html"><div class="ttname"><a href="structcursor.html">cursor</a></div><div class="ttdef"><b>Definition:</b> <a href="esql__cli_8c_source.html#l00309">esql_cli.c:309</a></div></div>
<div class="ttc" id="log__manager_8c_html_af75c618a8808a3cbda88f71cc7026ee1"><div class="ttname"><a href="log__manager_8c.html#af75c618a8808a3cbda88f71cc7026ee1">log_get_checkpoint_interval</a></div><div class="ttdeci">void log_get_checkpoint_interval(bool &amp;is_timed_wait, cubthread::delta_time &amp;period)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l10324">log_manager.c:10324</a></div></div>
<div class="ttc" id="log__manager_8c_html_a425ed5fad08e748df89edfd0350986f9"><div class="ttname"><a href="log__manager_8c.html#a425ed5fad08e748df89edfd0350986f9">log_restart_emergency</a></div><div class="ttdeci">void log_restart_emergency(THREAD_ENTRY *thread_p, const char *db_fullname, const char *logpath, const char *prefix_logname)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l01841">log_manager.c:1841</a></div></div>
<div class="ttc" id="vacuum_8h_html_ac8a084d067e28ed6cf7989a1597af721"><div class="ttname"><a href="vacuum_8h.html#ac8a084d067e28ed6cf7989a1597af721">vacuum_worker_state_is_recovery</a></div><div class="ttdeci">STATIC_INLINE bool vacuum_worker_state_is_recovery(THREAD_ENTRY *thread_p) __attribute__((ALWAYS_INLINE))</div><div class="ttdef"><b>Definition:</b> <a href="vacuum_8h_source.html#l00262">vacuum.h:262</a></div></div>
<div class="ttc" id="structlog__header_html_ac54583fc783300b1b8254d14618c1e22"><div class="ttname"><a href="structlog__header.html#ac54583fc783300b1b8254d14618c1e22">log_header::ha_promotion_time</a></div><div class="ttdeci">INT64 ha_promotion_time</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00244">log_impl.h:244</a></div></div>
<div class="ttc" id="structlog__rec__sysop__end_html_a013e84a84232dee701d8083c07a172c9"><div class="ttname"><a href="structlog__rec__sysop__end.html#a013e84a84232dee701d8083c07a172c9">log_rec_sysop_end::mvcc_undo</a></div><div class="ttdeci">LOG_REC_MVCC_UNDO mvcc_undo</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01567">log_impl.h:1567</a></div></div>
<div class="ttc" id="catalog__class_8c_html_ae5a7d7ee65169187ff2edadd52509381"><div class="ttname"><a href="catalog__class_8c.html#ae5a7d7ee65169187ff2edadd52509381">catcls_get_apply_info_log_record_time</a></div><div class="ttdeci">int catcls_get_apply_info_log_record_time(THREAD_ENTRY *thread_p, time_t *log_record_time)</div><div class="ttdef"><b>Definition:</b> <a href="catalog__class_8c_source.html#l05143">catalog_class.c:5143</a></div></div>
<div class="ttc" id="log__manager_8c_html_a1dbd3acc4c9828aa63183a69c54d80c0"><div class="ttname"><a href="log__manager_8c.html#a1dbd3acc4c9828aa63183a69c54d80c0">log_archive_log_header_next_scan</a></div><div class="ttdeci">SCAN_CODE log_archive_log_header_next_scan(THREAD_ENTRY *thread_p, int cursor, DB_VALUE **out_values, int out_cnt, void *ptr)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l09912">log_manager.c:9912</a></div></div>
<div class="ttc" id="xserver__interface_8h_html"><div class="ttname"><a href="xserver__interface_8h.html">xserver_interface.h</a></div></div>
<div class="ttc" id="log__impl_8h_html_a8a3ce7b7aa59fe26c04eca3577e434e8"><div class="ttname"><a href="log__impl_8h.html#a8a3ce7b7aa59fe26c04eca3577e434e8">prior_lsa_next_record</a></div><div class="ttdeci">LOG_LSA prior_lsa_next_record(THREAD_ENTRY *thread_p, LOG_PRIOR_NODE *node, LOG_TDES *tdes)</div><div class="ttdef"><b>Definition:</b> <a href="log__page__buffer_8c_source.html#l04059">log_page_buffer.c:4059</a></div></div>
<div class="ttc" id="log__impl_8h_html_ab33fe5f69028f102e9910294e97ccd6ba1a83d875d6d32208d2b7bed2283c959b"><div class="ttname"><a href="log__impl_8h.html#ab33fe5f69028f102e9910294e97ccd6ba1a83d875d6d32208d2b7bed2283c959b">LOG_CS_SAFE_READER</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l02047">log_impl.h:2047</a></div></div>
<div class="ttc" id="fault__injection_8h_html_a388a03eac9117728e2ff741e6dccde37"><div class="ttname"><a href="fault__injection_8h.html#a388a03eac9117728e2ff741e6dccde37">FI_TEST_ARG</a></div><div class="ttdeci">#define FI_TEST_ARG(th, code, arg, state)</div><div class="ttdef"><b>Definition:</b> <a href="fault__injection_8h_source.html#l00039">fault_injection.h:39</a></div></div>
<div class="ttc" id="structvpid_html_a54e222d402e758d24ae0df524a9e677d"><div class="ttname"><a href="structvpid.html#a54e222d402e758d24ae0df524a9e677d">vpid::volid</a></div><div class="ttdeci">short volid</div><div class="ttdef"><b>Definition:</b> <a href="dbtype__def_8h_source.html#l00905">dbtype_def.h:905</a></div></div>
<div class="ttc" id="log__manager_8c_html_a1b9d7ef3a0e157511a172c7dc6439ca5"><div class="ttname"><a href="log__manager_8c.html#a1b9d7ef3a0e157511a172c7dc6439ca5">log_append_compensate</a></div><div class="ttdeci">void log_append_compensate(THREAD_ENTRY *thread_p, LOG_RCVINDEX rcvindex, const VPID *vpid, PGLENGTH offset, PAGE_PTR pgptr, int length, const void *data, LOG_TDES *tdes)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l02992">log_manager.c:2992</a></div></div>
<div class="ttc" id="xserver__interface_8h_html_a0a2c9ebbbfb3f4d8812e5fe0f9181d0d"><div class="ttname"><a href="xserver__interface_8h.html#a0a2c9ebbbfb3f4d8812e5fe0f9181d0d">log_get_db_compatibility</a></div><div class="ttdeci">float log_get_db_compatibility(void)</div></div>
<div class="ttc" id="es_8c_html_ad23d253074d43cbcf384cc0d3d1b77be"><div class="ttname"><a href="es_8c.html#ad23d253074d43cbcf384cc0d3d1b77be">es_rename_file</a></div><div class="ttdeci">int es_rename_file(const char *in_uri, const char *metaname, char *out_uri)</div><div class="ttdef"><b>Definition:</b> <a href="es_8c_source.html#l00425">es.c:425</a></div></div>
<div class="ttc" id="structlog__vacuum__info_html_a1fc0aeb2562118f210e453ffff9d75da"><div class="ttname"><a href="structlog__vacuum__info.html#a1fc0aeb2562118f210e453ffff9d75da">log_vacuum_info::prev_mvcc_op_log_lsa</a></div><div class="ttdeci">LOG_LSA prev_mvcc_op_log_lsa</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00681">log_impl.h:681</a></div></div>
<div class="ttc" id="recovery_8h_html_abcf26d0f67b04c0e8820d2b59b2ac8f4"><div class="ttname"><a href="recovery_8h.html#abcf26d0f67b04c0e8820d2b59b2ac8f4">RCV_IS_LOGICAL_RUN_POSTPONE_MANUAL</a></div><div class="ttdeci">#define RCV_IS_LOGICAL_RUN_POSTPONE_MANUAL(idx)</div><div class="ttdef"><b>Definition:</b> <a href="recovery_8h_source.html#l00238">recovery.h:238</a></div></div>
<div class="ttc" id="server__support_8c_html_a8b07e301b0f090fa52920cc1b48b4777"><div class="ttname"><a href="server__support_8c.html#a8b07e301b0f090fa52920cc1b48b4777">css_is_shutdown_timeout_expired</a></div><div class="ttdeci">bool css_is_shutdown_timeout_expired(void)</div><div class="ttdef"><b>Definition:</b> <a href="server__support_8c_source.html#l00877">server_support.c:877</a></div></div>
<div class="ttc" id="structtrantable_html_abf145892ae263e97866b85009e2ad425"><div class="ttname"><a href="structtrantable.html#abf145892ae263e97866b85009e2ad425">trantable::num_prepared_loose_end_indices</a></div><div class="ttdeci">int num_prepared_loose_end_indices</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01790">log_impl.h:1790</a></div></div>
<div class="ttc" id="oid_8h_html_a2e75f71b34eb92af87dbbe5abc3974e7"><div class="ttname"><a href="oid_8h.html#a2e75f71b34eb92af87dbbe5abc3974e7">OID_EQ</a></div><div class="ttdeci">#define OID_EQ(oidp1, oidp2)</div><div class="ttdef"><b>Definition:</b> <a href="oid_8h_source.html#l00093">oid.h:93</a></div></div>
<div class="ttc" id="structlog__tdes_html_aef11834afdfbe3e8bd7f530ec269b327"><div class="ttname"><a href="structlog__tdes.html#aef11834afdfbe3e8bd7f530ec269b327">log_tdes::posp_nxlsa</a></div><div class="ttdeci">LOG_LSA posp_nxlsa</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01702">log_impl.h:1702</a></div></div>
<div class="ttc" id="log__impl_8h_html_aef9749d0e1fb73442a24537f0ac750e6"><div class="ttname"><a href="log__impl_8h.html#aef9749d0e1fb73442a24537f0ac750e6">log_startof_nxrec</a></div><div class="ttdeci">LOG_LSA * log_startof_nxrec(THREAD_ENTRY *thread_p, LOG_LSA *lsa, bool canuse_forwaddr)</div><div class="ttdef"><b>Definition:</b> <a href="log__recovery_8c_source.html#l05318">log_recovery.c:5318</a></div></div>
<div class="ttc" id="boot_8h_html_aced830d72ca3bc3b775113c1d75a2368"><div class="ttname"><a href="boot_8h.html#aced830d72ca3bc3b775113c1d75a2368">ha_server_state</a></div><div class="ttdeci">ha_server_state</div><div class="ttdef"><b>Definition:</b> <a href="boot_8h_source.html#l00145">boot.h:145</a></div></div>
<div class="ttc" id="classstring__buffer_html_a98ea31d493efa108286d8e3907b29454"><div class="ttname"><a href="classstring__buffer.html#a98ea31d493efa108286d8e3907b29454">string_buffer::get_buffer</a></div><div class="ttdeci">const char * get_buffer() const</div><div class="ttdef"><b>Definition:</b> <a href="string__buffer_8hpp_source.html#l00069">string_buffer.hpp:69</a></div></div>
<div class="ttc" id="system__parameter_8c_html_a5e5c602234655dfab40f1816b2bb3305"><div class="ttname"><a href="system__parameter_8c.html#a5e5c602234655dfab40f1816b2bb3305">sysprm_reload_and_init</a></div><div class="ttdeci">int sysprm_reload_and_init(const char *db_name, const char *conf_file)</div><div class="ttdef"><b>Definition:</b> <a href="system__parameter_8c_source.html#l06340">system_parameter.c:6340</a></div></div>
<div class="ttc" id="log__impl_8h_html_aaa150f6c2ae6a1748640ab281ffd94f7a942105cb887dd1030b0c6151087d24ac"><div class="ttname"><a href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a942105cb887dd1030b0c6151087d24ac">LOG_DUMMY_HA_SERVER_STATE</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00614">log_impl.h:614</a></div></div>
<div class="ttc" id="log__compress_8h_html"><div class="ttname"><a href="log__compress_8h.html">log_compress.h</a></div></div>
<div class="ttc" id="boot_8h_html_aced830d72ca3bc3b775113c1d75a2368a44a4e81589baba558794ef7ad6b73882"><div class="ttname"><a href="boot_8h.html#aced830d72ca3bc3b775113c1d75a2368a44a4e81589baba558794ef7ad6b73882">HA_SERVER_STATE_TO_BE_STANDBY</a></div><div class="ttdef"><b>Definition:</b> <a href="boot_8h_source.html#l00152">boot.h:152</a></div></div>
<div class="ttc" id="file__io_8c_html_ac8f2a9a060d18cbc18f83c2804d18ec3"><div class="ttname"><a href="file__io_8c.html#ac8f2a9a060d18cbc18f83c2804d18ec3">fileio_dismount</a></div><div class="ttdeci">void fileio_dismount(THREAD_ENTRY *thread_p, int vol_fd)</div><div class="ttdef"><b>Definition:</b> <a href="file__io_8c_source.html#l03078">file_io.c:3078</a></div></div>
<div class="ttc" id="release__string_8c_html_a3a3d73521805f4e99a61c68853e6f8d9"><div class="ttname"><a href="release__string_8c.html#a3a3d73521805f4e99a61c68853e6f8d9">rel_is_log_compatible</a></div><div class="ttdeci">bool rel_is_log_compatible(const char *writer_rel_str, const char *reader_rel_str)</div><div class="ttdef"><b>Definition:</b> <a href="release__string_8c_source.html#l00460">release_string.c:460</a></div></div>
<div class="ttc" id="log__manager_8c_html_a337f8a4c9ef75b8f01e4f5293d2f3381"><div class="ttname"><a href="log__manager_8c.html#a337f8a4c9ef75b8f01e4f5293d2f3381">log_abort_partial</a></div><div class="ttdeci">TRAN_STATE log_abort_partial(THREAD_ENTRY *thread_p, const char *savepoint_name, LOG_LSA *savept_lsa)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l05920">log_manager.c:5920</a></div></div>
<div class="ttc" id="log__comm_8h_html_a3c0be9b9f104459ab90ee18af95c4b3ea4e0d5b2bf0b5b43452dfaf5618a149aa"><div class="ttname"><a href="log__comm_8h.html#a3c0be9b9f104459ab90ee18af95c4b3ea4e0d5b2bf0b5b43452dfaf5618a149aa">TRAN_RECOVERY</a></div><div class="ttdef"><b>Definition:</b> <a href="log__comm_8h_source.html#l00041">log_comm.h:41</a></div></div>
<div class="ttc" id="log__impl_8h_html_a63624ee9f291d9eb7e727bc45775f09d"><div class="ttname"><a href="log__impl_8h.html#a63624ee9f291d9eb7e727bc45775f09d">logpb_create_header_page</a></div><div class="ttdeci">LOG_PAGE * logpb_create_header_page(THREAD_ENTRY *thread_p)</div><div class="ttdef"><b>Definition:</b> <a href="log__page__buffer_8c_source.html#l01520">log_page_buffer.c:1520</a></div></div>
<div class="ttc" id="cas__cci_8h_html_a0d4ade6def04e94015e9bf647f0a2d73a0d30deada26a110df6d7f81dbddb7470"><div class="ttname"><a href="cas__cci_8h.html#a0d4ade6def04e94015e9bf647f0a2d73a0d30deada26a110df6d7f81dbddb7470">TRAN_SERIALIZABLE</a></div><div class="ttdef"><b>Definition:</b> <a href="cas__cci_8h_source.html#l00745">cas_cci.h:745</a></div></div>
<div class="ttc" id="xserver__interface_8h_html_aa649c59686e25bf7fb7609f8c7dd0989"><div class="ttname"><a href="xserver__interface_8h.html#aa649c59686e25bf7fb7609f8c7dd0989">log_get_final_restored_lsa</a></div><div class="ttdeci">LOG_LSA * log_get_final_restored_lsa(void)</div></div>
<div class="ttc" id="log__manager_8c_html_a0d4074e0032a75ccf74ad2fdc9264083"><div class="ttname"><a href="log__manager_8c.html#a0d4074e0032a75ccf74ad2fdc9264083">PUT_LOCATOR_META</a></div><div class="ttdeci">#define PUT_LOCATOR_META(meta_name_, locator_)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l00146">log_manager.c:146</a></div></div>
<div class="ttc" id="log__impl_8h_html_ac67cba94ac6c10da3ae0ab474155ea1a"><div class="ttname"><a href="log__impl_8h.html#ac67cba94ac6c10da3ae0ab474155ea1a">logpb_fetch_page</a></div><div class="ttdeci">int logpb_fetch_page(THREAD_ENTRY *thread_p, LOG_LSA *req_lsa, LOG_CS_ACCESS_MODE access_mode, LOG_PAGE *log_pgptr)</div><div class="ttdef"><b>Definition:</b> <a href="log__page__buffer_8c_source.html#l01761">log_page_buffer.c:1761</a></div></div>
<div class="ttc" id="expat_8h_html_a013fbe20efe68dbd323a536ffdb1e2a8"><div class="ttname"><a href="expat_8h.html#a013fbe20efe68dbd323a536ffdb1e2a8">end</a></div><div class="ttdeci">XML_EndCdataSectionHandler end</div><div class="ttdef"><b>Definition:</b> <a href="expat_8h_source.html#l00541">expat.h:541</a></div></div>
<div class="ttc" id="release__string_8c_html_acf0e9c4e17259551cf008bfa5f925dfe"><div class="ttname"><a href="release__string_8c.html#acf0e9c4e17259551cf008bfa5f925dfe">rel_name</a></div><div class="ttdeci">const char * rel_name(void)</div><div class="ttdef"><b>Definition:</b> <a href="release__string_8c_source.html#l00145">release_string.c:145</a></div></div>
<div class="ttc" id="file__io_8c_html_a55c9040a1a605ecc2aae549ddc1f4cb0"><div class="ttname"><a href="file__io_8c.html#a55c9040a1a605ecc2aae549ddc1f4cb0">fileio_synchronize_all</a></div><div class="ttdeci">int fileio_synchronize_all(THREAD_ENTRY *thread_p, bool is_include)</div><div class="ttdef"><b>Definition:</b> <a href="file__io_8c_source.html#l04569">file_io.c:4569</a></div></div>
<div class="ttc" id="structlog__repl_html_a7e74ec3812134e817a9b2a455ee5de1f"><div class="ttname"><a href="structlog__repl.html#a7e74ec3812134e817a9b2a455ee5de1f">log_repl::repl_data</a></div><div class="ttdeci">char * repl_data</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01509">log_impl.h:1509</a></div></div>
<div class="ttc" id="structlog__rcv_html_aa86dfb9bbc9edce109df26aacf699915"><div class="ttname"><a href="structlog__rcv.html#aa86dfb9bbc9edce109df26aacf699915">log_rcv::length</a></div><div class="ttdeci">int length</div><div class="ttdef"><b>Definition:</b> <a href="recovery_8h_source.html#l00195">recovery.h:195</a></div></div>
<div class="ttc" id="structlog__header_html_af5f33cf0ecf8a996d4646d2327f6540c"><div class="ttname"><a href="structlog__header.html#af5f33cf0ecf8a996d4646d2327f6540c">log_header::nxarv_pageid</a></div><div class="ttdeci">LOG_PAGEID nxarv_pageid</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00216">log_impl.h:216</a></div></div>
<div class="ttc" id="log__manager_8c_html_a5350790c3500298962602bf4b728bb1e"><div class="ttname"><a href="log__manager_8c.html#a5350790c3500298962602bf4b728bb1e">log_get_parent_lsa_system_op</a></div><div class="ttdeci">LOG_LSA * log_get_parent_lsa_system_op(THREAD_ENTRY *thread_p, LOG_LSA *parent_lsa)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l04297">log_manager.c:4297</a></div></div>
<div class="ttc" id="structlog__global_html_a11014fae55d34fdc69e77941301a59a1"><div class="ttname"><a href="structlog__global.html#a11014fae55d34fdc69e77941301a59a1">log_global::chkpt_every_npages</a></div><div class="ttdeci">DKNPAGES chkpt_every_npages</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01949">log_impl.h:1949</a></div></div>
<div class="ttc" id="structdb__datetime_html"><div class="ttname"><a href="structdb__datetime.html">db_datetime</a></div><div class="ttdef"><b>Definition:</b> <a href="dbtype__def_8h_source.html#l00799">dbtype_def.h:799</a></div></div>
<div class="ttc" id="structlog__rec__mvcc__undo_html_ae7c1bf9c8eb5a86167f621ac40445f96"><div class="ttname"><a href="structlog__rec__mvcc__undo.html#ae7c1bf9c8eb5a86167f621ac40445f96">log_rec_mvcc_undo::mvccid</a></div><div class="ttdeci">MVCCID mvccid</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00701">log_impl.h:701</a></div></div>
<div class="ttc" id="log__manager_8c_html_aff0ddf74133f090a894a4b4b68b7acb6"><div class="ttname"><a href="log__manager_8c.html#aff0ddf74133f090a894a4b4b68b7acb6">LOG_ISCHECKPOINT_TIME</a></div><div class="ttdeci">#define LOG_ISCHECKPOINT_TIME()</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l00098">log_manager.c:98</a></div></div>
<div class="ttc" id="dbtype__def_8h_html_ae85379d0c7c731c668592fb40e8bc6f2aaf315bc853f080ca48aebf812eabcb71"><div class="ttname"><a href="dbtype__def_8h.html#ae85379d0c7c731c668592fb40e8bc6f2aaf315bc853f080ca48aebf812eabcb71">DISK_UNKNOWN_PURPOSE</a></div><div class="ttdef"><b>Definition:</b> <a href="dbtype__def_8h_source.html#l00216">dbtype_def.h:216</a></div></div>
<div class="ttc" id="storage__common_8h_html_a26871e1bd203b43825e17ebfd14d072d"><div class="ttname"><a href="storage__common_8h.html#a26871e1bd203b43825e17ebfd14d072d">LOG_PAGEID</a></div><div class="ttdeci">INT64 LOG_PAGEID</div><div class="ttdef"><b>Definition:</b> <a href="storage__common_8h_source.html#l00088">storage_common.h:88</a></div></div>
<div class="ttc" id="log__manager_8c_html_ad2eeada203e066baffcd4c6207a573b8"><div class="ttname"><a href="log__manager_8c.html#ad2eeada203e066baffcd4c6207a573b8">log_create</a></div><div class="ttdeci">int log_create(THREAD_ENTRY *thread_p, const char *db_fullname, const char *logpath, const char *prefix_logname, DKNPAGES npages)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l00794">log_manager.c:794</a></div></div>
<div class="ttc" id="server__support_8h_html"><div class="ttname"><a href="server__support_8h.html">server_support.h</a></div></div>
<div class="ttc" id="classcubthread_1_1entry__task_html"><div class="ttname"><a href="classcubthread_1_1entry__task.html">cubthread::entry_task</a></div><div class="ttdef"><b>Definition:</b> <a href="thread__entry__task_8hpp_source.html#l00058">thread_entry_task.hpp:58</a></div></div>
<div class="ttc" id="structlog__rec__undo_html_a08b364e1c642e56ea610a5e51beb7d2b"><div class="ttname"><a href="structlog__rec__undo.html#a08b364e1c642e56ea610a5e51beb7d2b">log_rec_undo::data</a></div><div class="ttdeci">LOG_DATA data</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00665">log_impl.h:665</a></div></div>
<div class="ttc" id="log__impl_8h_html_ab0e135eabcb7c4a5d08244226f68f0ba"><div class="ttname"><a href="log__impl_8h.html#ab0e135eabcb7c4a5d08244226f68f0ba">LOG_ISTRAN_ABORTED</a></div><div class="ttdeci">#define LOG_ISTRAN_ABORTED(tdes)</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00966">log_impl.h:966</a></div></div>
<div class="ttc" id="structlog__global_html_a73c801b0d3d19a743cf3d20ec7ae63c6"><div class="ttname"><a href="structlog__global.html#a73c801b0d3d19a743cf3d20ec7ae63c6">log_global::rcv_phase_lsa</a></div><div class="ttdeci">LOG_LSA rcv_phase_lsa</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01951">log_impl.h:1951</a></div></div>
<div class="ttc" id="freelistheap_8h_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="freelistheap_8h_source.html#l00019">freelistheap.h:19</a></div></div>
<div class="ttc" id="porting_8h_html_a7b4ba06a388856deeb25508d04470eaa"><div class="ttname"><a href="porting_8h.html#a7b4ba06a388856deeb25508d04470eaa">CTIME_MAX</a></div><div class="ttdeci">#define CTIME_MAX</div><div class="ttdef"><b>Definition:</b> <a href="porting_8h_source.html#l00092">porting.h:92</a></div></div>
<div class="ttc" id="es_8c_html_a85daafaae7e65285fdc167f61d47fb41"><div class="ttname"><a href="es_8c.html#a85daafaae7e65285fdc167f61d47fb41">es_delete_file</a></div><div class="ttdeci">int es_delete_file(const char *uri)</div><div class="ttdef"><b>Definition:</b> <a href="es_8c_source.html#l00309">es.c:309</a></div></div>
<div class="ttc" id="intl__support_8h_html_a62642b38e69c029c39114bb176d2f4b7abbaa6e2d6b1053eb96c607def4aa6dec"><div class="ttname"><a href="intl__support_8h.html#a62642b38e69c029c39114bb176d2f4b7abbaa6e2d6b1053eb96c607def4aa6dec">INTL_CODESET_ERROR</a></div><div class="ttdef"><b>Definition:</b> <a href="intl__support_8h_source.html#l00179">intl_support.h:179</a></div></div>
<div class="ttc" id="structlog__rec__compensate_html_aa7dd1825a2cbaacc90ad2c40a8d5f97f"><div class="ttname"><a href="structlog__rec__compensate.html#aa7dd1825a2cbaacc90ad2c40a8d5f97f">log_rec_compensate::length</a></div><div class="ttdeci">int length</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01528">log_impl.h:1528</a></div></div>
<div class="ttc" id="log__impl_8h_html_aaa150f6c2ae6a1748640ab281ffd94f7a4ab5b053c95a07cab41de19454b7663c"><div class="ttname"><a href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a4ab5b053c95a07cab41de19454b7663c">LOG_2PC_RECV_ACK</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00597">log_impl.h:597</a></div></div>
<div class="ttc" id="storage__common_8h_html_a6cdffe739d5149557924b03acf945d1c"><div class="ttname"><a href="storage__common_8h.html#a6cdffe739d5149557924b03acf945d1c">MVCCID</a></div><div class="ttdeci">UINT64 MVCCID</div><div class="ttdef"><b>Definition:</b> <a href="storage__common_8h_source.html#l00250">storage_common.h:250</a></div></div>
<div class="ttc" id="log__manager_8c_html_a9ba19c0baec377fbab0da02a75c7260d"><div class="ttname"><a href="log__manager_8c.html#a9ba19c0baec377fbab0da02a75c7260d">log_append_undo_crumbs</a></div><div class="ttdeci">void log_append_undo_crumbs(THREAD_ENTRY *thread_p, LOG_RCVINDEX rcvindex, LOG_DATA_ADDR *addr, int num_crumbs, const LOG_CRUMB *crumbs)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l02197">log_manager.c:2197</a></div></div>
<div class="ttc" id="structlog__rec__undoredo_html_a3d088b72f92c7881d303916b3a1d7632"><div class="ttname"><a href="structlog__rec__undoredo.html#a3d088b72f92c7881d303916b3a1d7632">log_rec_undoredo::data</a></div><div class="ttdeci">LOG_DATA data</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00656">log_impl.h:656</a></div></div>
<div class="ttc" id="log__manager_8c_html_ac92df3fb17efd887483ccf4616f20f27"><div class="ttname"><a href="log__manager_8c.html#ac92df3fb17efd887483ccf4616f20f27">log_rv_outside_noop_redo</a></div><div class="ttdeci">int log_rv_outside_noop_redo(THREAD_ENTRY *thread_p, LOG_RCV *rcv)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l09412">log_manager.c:9412</a></div></div>
<div class="ttc" id="structrvfun_html_aca33a8111da1e70b7ed633e5028760ce"><div class="ttname"><a href="structrvfun.html#aca33a8111da1e70b7ed633e5028760ce">rvfun::redofun</a></div><div class="ttdeci">int(* redofun)(THREAD_ENTRY *thread_p, LOG_RCV *logrcv)</div><div class="ttdef"><b>Definition:</b> <a href="recovery_8h_source.html#l00209">recovery.h:209</a></div></div>
<div class="ttc" id="structlog__tdes_html_a58eaa41917555c02b46a13556f72b254"><div class="ttname"><a href="structlog__tdes.html#a58eaa41917555c02b46a13556f72b254">log_tdes::num_unique_btrees</a></div><div class="ttdeci">int num_unique_btrees</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01718">log_impl.h:1718</a></div></div>
<div class="ttc" id="critical__section_8h_html_a9cf8d48fdcf0a6b0bd8391d6083c63e5"><div class="ttname"><a href="critical__section_8h.html#a9cf8d48fdcf0a6b0bd8391d6083c63e5">rmutex_lock</a></div><div class="ttdeci">#define rmutex_lock(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="critical__section_8h_source.html#l00220">critical_section.h:220</a></div></div>
<div class="ttc" id="log__impl_8h_html_aaa150f6c2ae6a1748640ab281ffd94f7ac9476ec323cd3909823f79ecc3938afd"><div class="ttname"><a href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7ac9476ec323cd3909823f79ecc3938afd">LOG_REPLICATION_STATEMENT</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00608">log_impl.h:608</a></div></div>
<div class="ttc" id="log__manager_8c_html_a2caab20af5b0e7a0a89abf77ffa8e404"><div class="ttname"><a href="log__manager_8c.html#a2caab20af5b0e7a0a89abf77ffa8e404">log_is_in_crash_recovery</a></div><div class="ttdeci">bool log_is_in_crash_recovery(void)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l00521">log_manager.c:521</a></div></div>
<div class="ttc" id="structlog__data__addr_html_a23830dd623509faa8744024abec22ca8"><div class="ttname"><a href="structlog__data__addr.html#a23830dd623509faa8744024abec22ca8">log_data_addr::vfid</a></div><div class="ttdeci">const VFID * vfid</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01839">log_impl.h:1839</a></div></div>
<div class="ttc" id="log__manager_8c_html_ab82d5be060189c3aa56e57399a458e3a"><div class="ttname"><a href="log__manager_8c.html#ab82d5be060189c3aa56e57399a458e3a">log_append_run_postpone</a></div><div class="ttdeci">void log_append_run_postpone(THREAD_ENTRY *thread_p, LOG_RCVINDEX rcvindex, LOG_DATA_ADDR *addr, const VPID *rcv_vpid, int length, const void *data, const LOG_LSA *ref_lsa)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l02892">log_manager.c:2892</a></div></div>
<div class="ttc" id="log__impl_8h_html_a5774cee12f9750e57015dc32de76bc4a"><div class="ttname"><a href="log__impl_8h.html#a5774cee12f9750e57015dc32de76bc4a">logpb_initialize_arv_page_info_table</a></div><div class="ttdeci">void logpb_initialize_arv_page_info_table(void)</div><div class="ttdef"><b>Definition:</b> <a href="log__page__buffer_8c_source.html#l11736">log_page_buffer.c:11736</a></div></div>
<div class="ttc" id="log__impl_8h_html_aaa150f6c2ae6a1748640ab281ffd94f7a5eb32eedc7671f3f89c1b10c3d0229c1"><div class="ttname"><a href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a5eb32eedc7671f3f89c1b10c3d0229c1">LOG_MVCC_UNDO_DATA</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00618">log_impl.h:618</a></div></div>
<div class="ttc" id="log__impl_8h_html_abb2a79de9a9c6b39a4137ba3417daa0b"><div class="ttname"><a href="log__impl_8h.html#abb2a79de9a9c6b39a4137ba3417daa0b">LOG_IS_MVCC_OPERATION</a></div><div class="ttdeci">#define LOG_IS_MVCC_OPERATION(rcvindex)</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01493">log_impl.h:1493</a></div></div>
<div class="ttc" id="vacuum_8h_html_a914ef372e17262e546187ec8506ed689"><div class="ttname"><a href="vacuum_8h.html#a914ef372e17262e546187ec8506ed689">vacuum_er_log</a></div><div class="ttdeci">#define vacuum_er_log(er_log_level, msg,...)</div><div class="ttdef"><b>Definition:</b> <a href="vacuum_8h_source.html#l00063">vacuum.h:63</a></div></div>
<div class="ttc" id="log__impl_8h_html_ac27166ed5a81c72375cfccc620c702da"><div class="ttname"><a href="log__impl_8h.html#ac27166ed5a81c72375cfccc620c702da">logtb_define_trantable_log_latch</a></div><div class="ttdeci">int logtb_define_trantable_log_latch(THREAD_ENTRY *thread_p, int num_expected_tran_indices)</div><div class="ttdef"><b>Definition:</b> <a href="log__tran__table_8c_source.html#l00437">log_tran_table.c:437</a></div></div>
<div class="ttc" id="error__code_8h_html_aaeb0f3698022ae5f56094bff65b0528f"><div class="ttname"><a href="error__code_8h.html#aaeb0f3698022ae5f56094bff65b0528f">ER_IO_MOUNT_FAIL</a></div><div class="ttdeci">#define ER_IO_MOUNT_FAIL</div><div class="ttdef"><b>Definition:</b> <a href="error__code_8h_source.html#l00055">error_code.h:55</a></div></div>
<div class="ttc" id="log__comm_8h_html_a3c0be9b9f104459ab90ee18af95c4b3ea6ddb25e9eb5bdd0477b4da46f8edcaba"><div class="ttname"><a href="log__comm_8h.html#a3c0be9b9f104459ab90ee18af95c4b3ea6ddb25e9eb5bdd0477b4da46f8edcaba">TRAN_UNACTIVE_COMMITTED</a></div><div class="ttdef"><b>Definition:</b> <a href="log__comm_8h_source.html#l00044">log_comm.h:44</a></div></div>
<div class="ttc" id="log__manager_8c_html_a9b372c8c519e6c4760653da1bff49851"><div class="ttname"><a href="log__manager_8c.html#a9b372c8c519e6c4760653da1bff49851">log_append_undoredo_recdes</a></div><div class="ttdeci">void log_append_undoredo_recdes(THREAD_ENTRY *thread_p, LOG_RCVINDEX rcvindex, LOG_DATA_ADDR *addr, const RECDES *undo_recdes, const RECDES *redo_recdes)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l02451">log_manager.c:2451</a></div></div>
<div class="ttc" id="structlog__header_html_a58201c7b54ca550699752804f305eee0"><div class="ttname"><a href="structlog__header.html#a58201c7b54ca550699752804f305eee0">log_header::bkup_level2_lsa</a></div><div class="ttdeci">LOG_LSA bkup_level2_lsa</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00223">log_impl.h:223</a></div></div>
<div class="ttc" id="log__manager_8c_html_a5b86861d06b273efd9a45cfefc83d3f6"><div class="ttname"><a href="log__manager_8c.html#a5b86861d06b273efd9a45cfefc83d3f6">log_append_undoredo_recdes2</a></div><div class="ttdeci">void log_append_undoredo_recdes2(THREAD_ENTRY *thread_p, LOG_RCVINDEX rcvindex, const VFID *vfid, PAGE_PTR pgptr, PGLENGTH offset, const RECDES *undo_recdes, const RECDES *redo_recdes)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l02458">log_manager.c:2458</a></div></div>
<div class="ttc" id="vacuum_8c_html_a28d7f980eeb489f0a736fa1c8cc61546"><div class="ttname"><a href="vacuum_8c.html#a28d7f980eeb489f0a736fa1c8cc61546">vacuum_cache_log_postpone_redo_data</a></div><div class="ttdeci">void vacuum_cache_log_postpone_redo_data(THREAD_ENTRY *thread_p, char *data_header, char *rcv_data, int rcv_data_length)</div><div class="ttdef"><b>Definition:</b> <a href="vacuum_8c_source.html#l07516">vacuum.c:7516</a></div></div>
<div class="ttc" id="expat_8h_html_aaf0497a3bd20a0066017546af6bf80be"><div class="ttname"><a href="expat_8h.html#aaf0497a3bd20a0066017546af6bf80be">ptr</a></div><div class="ttdeci">void * ptr</div><div class="ttdef"><b>Definition:</b> <a href="expat_8h_source.html#l00904">expat.h:904</a></div></div>
<div class="ttc" id="structlog__data__addr_html_a3c632dae3ad660a8572d9298716d9522"><div class="ttname"><a href="structlog__data__addr.html#a3c632dae3ad660a8572d9298716d9522">log_data_addr::pgptr</a></div><div class="ttdeci">PAGE_PTR pgptr</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01840">log_impl.h:1840</a></div></div>
<div class="ttc" id="log__impl_8h_html_ab8ba4bbbc183a2fee8d21494c5afae34"><div class="ttname"><a href="log__impl_8h.html#ab8ba4bbbc183a2fee8d21494c5afae34">LOG_RESET_PREV_LSA</a></div><div class="ttdeci">#define LOG_RESET_PREV_LSA(lsa)</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00871">log_impl.h:871</a></div></div>
<div class="ttc" id="log__manager_8c_html_a62ffd154657b96161bcae79f707b4295"><div class="ttname"><a href="log__manager_8c.html#a62ffd154657b96161bcae79f707b4295">log_get_num_pages_for_creation</a></div><div class="ttdeci">int log_get_num_pages_for_creation(int db_npages)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l00741">log_manager.c:741</a></div></div>
<div class="ttc" id="log__2pc_8c_html_a43497b937744325d2a9da2ac9e7718fa"><div class="ttname"><a href="log__2pc_8c.html#a43497b937744325d2a9da2ac9e7718fa">log_2pc_dump_participants</a></div><div class="ttdeci">void log_2pc_dump_participants(FILE *fp, int block_length, void *block_particps_ids)</div><div class="ttdef"><b>Definition:</b> <a href="log__2pc_8c_source.html#l00256">log_2pc.c:256</a></div></div>
<div class="ttc" id="log__impl_8h_html_a2009f11bd300ce6fb8b2901332593f28"><div class="ttname"><a href="log__impl_8h.html#a2009f11bd300ce6fb8b2901332593f28">logtb_assign_tran_index</a></div><div class="ttdeci">int logtb_assign_tran_index(THREAD_ENTRY *thread_p, TRANID trid, TRAN_STATE state, const BOOT_CLIENT_CREDENTIAL *client_credential, TRAN_STATE *current_state, int wait_msecs, TRAN_ISOLATION isolation)</div><div class="ttdef"><b>Definition:</b> <a href="log__tran__table_8c_source.html#l00858">log_tran_table.c:858</a></div></div>
<div class="ttc" id="memory__alloc_8h_html_a8a4aab7481b74342b82c75f8e028bcf8"><div class="ttname"><a href="memory__alloc_8h.html#a8a4aab7481b74342b82c75f8e028bcf8">db_private_free_and_init</a></div><div class="ttdeci">#define db_private_free_and_init(thrd, ptr)</div><div class="ttdef"><b>Definition:</b> <a href="memory__alloc_8h_source.html#l00142">memory_alloc.h:142</a></div></div>
<div class="ttc" id="structlog__header_html_a56cefc057e0589c8e9454e3a36751c61"><div class="ttname"><a href="structlog__header.html#a56cefc057e0589c8e9454e3a36751c61">log_header::last_arv_num_for_syscrashes</a></div><div class="ttdeci">int last_arv_num_for_syscrashes</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00219">log_impl.h:219</a></div></div>
<div class="ttc" id="log__manager_8c_html_a3bd1ad5edf8fc93f783af77e8cd6ee9a"><div class="ttname"><a href="log__manager_8c.html#a3bd1ad5edf8fc93f783af77e8cd6ee9a">pthread_mutex_lock</a></div><div class="ttdeci">#define pthread_mutex_lock(a)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l00085">log_manager.c:85</a></div></div>
<div class="ttc" id="log__impl_8h_html_a98c98195fe088cf7345b3c4d7d3149fb"><div class="ttname"><a href="log__impl_8h.html#a98c98195fe088cf7345b3c4d7d3149fb">LOG_2PC_EXECUTE</a></div><div class="ttdeci">enum log_2pc_execute LOG_2PC_EXECUTE</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01250">log_impl.h:1250</a></div></div>
<div class="ttc" id="log__manager_8c_html_a5c4af392f84fee0ddddee9e29e94752b"><div class="ttname"><a href="log__manager_8c.html#a5c4af392f84fee0ddddee9e29e94752b">log_append_undoredo_data</a></div><div class="ttdeci">void log_append_undoredo_data(THREAD_ENTRY *thread_p, LOG_RCVINDEX rcvindex, LOG_DATA_ADDR *addr, int undo_length, int redo_length, const void *undo_data, const void *redo_data)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l01867">log_manager.c:1867</a></div></div>
<div class="ttc" id="log__manager_8c_html_acfafced0123d02511d2ec4590684f89f"><div class="ttname"><a href="log__manager_8c.html#acfafced0123d02511d2ec4590684f89f">xlog_find_lob_locator</a></div><div class="ttdeci">LOB_LOCATOR_STATE xlog_find_lob_locator(THREAD_ENTRY *thread_p, const char *locator, char *real_locator)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l05072">log_manager.c:5072</a></div></div>
<div class="ttc" id="structlog__rec__sysop__end_html_ac228866b1723dfd1165550c037fdc3aa"><div class="ttname"><a href="structlog__rec__sysop__end.html#ac228866b1723dfd1165550c037fdc3aa">log_rec_sysop_end::lastparent_lsa</a></div><div class="ttdeci">LOG_LSA lastparent_lsa</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01561">log_impl.h:1561</a></div></div>
<div class="ttc" id="page__buffer_8h_html_aa93d50649e448bef4b4bd8dc2c6428f7"><div class="ttname"><a href="page__buffer_8h.html#aa93d50649e448bef4b4bd8dc2c6428f7">pgbuf_fix</a></div><div class="ttdeci">#define pgbuf_fix(thread_p, vpid, fetch_mode, requestmode, condition)</div><div class="ttdef"><b>Definition:</b> <a href="page__buffer_8h_source.html#l00246">page_buffer.h:246</a></div></div>
<div class="ttc" id="namespacestatdump__to__csv_html_aedcb70fde9c0b07a0732db70deeec616"><div class="ttname"><a href="namespacestatdump__to__csv.html#aedcb70fde9c0b07a0732db70deeec616">statdump_to_csv.data</a></div><div class="ttdeci">list data</div><div class="ttdef"><b>Definition:</b> <a href="statdump__to__csv_8py_source.html#l00110">statdump_to_csv.py:110</a></div></div>
<div class="ttc" id="recovery_8h_html_a526c4dc065c989256afca8b3b56d4d2ba9ebbe138eea08c3a9b8a08f70039fa5c"><div class="ttname"><a href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2ba9ebbe138eea08c3a9b8a08f70039fa5c">RVREPL_DATA_INSERT</a></div><div class="ttdef"><b>Definition:</b> <a href="recovery_8h_source.html#l00149">recovery.h:149</a></div></div>
<div class="ttc" id="structlog__tdes_html_ad1e00bb06c2561a9600ed0ba6c410943"><div class="ttname"><a href="structlog__tdes.html#ad1e00bb06c2561a9600ed0ba6c410943">log_tdes::head_lsa</a></div><div class="ttdeci">LOG_LSA head_lsa</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01698">log_impl.h:1698</a></div></div>
<div class="ttc" id="mprec_8c_html_a4db1c1a80cf2e1dafd165ee7c7bf6aeb"><div class="ttname"><a href="mprec_8c.html#a4db1c1a80cf2e1dafd165ee7c7bf6aeb">assert</a></div><div class="ttdeci">assert(k&lt;=ptr-&gt;_max_k)</div></div>
<div class="ttc" id="structlog__hdrpage_html_a581cc8236b70bf22034b8006e44570d5"><div class="ttname"><a href="structlog__hdrpage.html#a581cc8236b70bf22034b8006e44570d5">log_hdrpage::offset</a></div><div class="ttdeci">PGLENGTH offset</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00128">log_impl.h:128</a></div></div>
<div class="ttc" id="classcubthread_1_1entry_html"><div class="ttname"><a href="classcubthread_1_1entry.html">cubthread::entry</a></div><div class="ttdef"><b>Definition:</b> <a href="thread__entry_8hpp_source.html#l00179">thread_entry.hpp:179</a></div></div>
<div class="ttc" id="server__support_8c_html_ad2a4945bd103012f30859c2cea405b2d"><div class="ttname"><a href="server__support_8c.html#ad2a4945bd103012f30859c2cea405b2d">css_unset_ha_repl_delayed</a></div><div class="ttdeci">void css_unset_ha_repl_delayed(void)</div><div class="ttdef"><b>Definition:</b> <a href="server__support_8c_source.html#l02059">server_support.c:2059</a></div></div>
<div class="ttc" id="cnv_8c_html_a91e93d72d68bf73e79c405c05e64a5fa"><div class="ttname"><a href="cnv_8c.html#a91e93d72d68bf73e79c405c05e64a5fa">csect_exit</a></div><div class="ttdeci">#define csect_exit(a, b)</div><div class="ttdef"><b>Definition:</b> <a href="cnv_8c_source.html#l00139">cnv.c:139</a></div></div>
<div class="ttc" id="object__representation_8h_html_a098782fa7cb5f64510f83998d6ad67fa"><div class="ttname"><a href="object__representation_8h.html#a098782fa7cb5f64510f83998d6ad67fa">or_unpack_int</a></div><div class="ttdeci">char * or_unpack_int(char *ptr, int *number)</div><div class="ttdef"><b>Definition:</b> <a href="object__representation_8c_source.html#l03079">object_representation.c:3079</a></div></div>
<div class="ttc" id="log__impl_8h_html_a721f75e714fb216eb1c86e38c1640644"><div class="ttname"><a href="log__impl_8h.html#a721f75e714fb216eb1c86e38c1640644">logpb_read_page_from_file</a></div><div class="ttdeci">int logpb_read_page_from_file(THREAD_ENTRY *thread_p, LOG_PAGEID pageid, LOG_CS_ACCESS_MODE access_mode, LOG_PAGE *log_pgptr)</div><div class="ttdef"><b>Definition:</b> <a href="log__page__buffer_8c_source.html#l02010">log_page_buffer.c:2010</a></div></div>
<div class="ttc" id="storage__common_8h_html_ad704198b3c56cf17601de69c679a7181a38165d93da431da6482d755a4b65fc4f"><div class="ttname"><a href="storage__common_8h.html#ad704198b3c56cf17601de69c679a7181a38165d93da431da6482d755a4b65fc4f">S_END</a></div><div class="ttdef"><b>Definition:</b> <a href="storage__common_8h_source.html#l00642">storage_common.h:642</a></div></div>
<div class="ttc" id="structlog__tdes_html_a3f287d08461d1ab5a7499ed4f07d1423"><div class="ttname"><a href="structlog__tdes.html#a3f287d08461d1ab5a7499ed4f07d1423">log_tdes::tran_unique_stats</a></div><div class="ttdeci">BTREE_UNIQUE_STATS * tran_unique_stats</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01720">log_impl.h:1720</a></div></div>
<div class="ttc" id="recovery_8h_html_a526c4dc065c989256afca8b3b56d4d2baca88567f8ffeb5458461f87ec8a3b6b5"><div class="ttname"><a href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2baca88567f8ffeb5458461f87ec8a3b6b5">RVES_NOTIFY_VACUUM</a></div><div class="ttdef"><b>Definition:</b> <a href="recovery_8h_source.html#l00171">recovery.h:171</a></div></div>
<div class="ttc" id="memory__hash_8c_html_ac22328249a11f6113491897b4cf4a08d"><div class="ttname"><a href="memory__hash_8c.html#ac22328249a11f6113491897b4cf4a08d">mht_5strhash</a></div><div class="ttdeci">unsigned int mht_5strhash(const void *key, const unsigned int ht_size)</div><div class="ttdef"><b>Definition:</b> <a href="memory__hash_8c_source.html#l00522">memory_hash.c:522</a></div></div>
<div class="ttc" id="system__parameter_8h_html_a23aaf6bca406b9b428f43ad1b6b2b3e0a8e25487e08db74e58fe85b48e2bd9771"><div class="ttname"><a href="system__parameter_8h.html#a23aaf6bca406b9b428f43ad1b6b2b3e0a8e25487e08db74e58fe85b48e2bd9771">PRM_ID_LOG_TRACE_FLUSH_TIME_MSECS</a></div><div class="ttdef"><b>Definition:</b> <a href="system__parameter_8h_source.html#l00307">system_parameter.h:307</a></div></div>
<div class="ttc" id="memory__alloc_8h_html_a8b903d0a51cce71105b6a706159717e4"><div class="ttname"><a href="memory__alloc_8h.html#a8b903d0a51cce71105b6a706159717e4">db_private_alloc</a></div><div class="ttdeci">#define db_private_alloc(thrd, size)</div><div class="ttdef"><b>Definition:</b> <a href="memory__alloc_8h_source.html#l00228">memory_alloc.h:228</a></div></div>
<div class="ttc" id="classcubthread_1_1daemon_html"><div class="ttname"><a href="classcubthread_1_1daemon.html">cubthread::daemon</a></div><div class="ttdef"><b>Definition:</b> <a href="thread__daemon_8hpp_source.html#l00078">thread_daemon.hpp:78</a></div></div>
<div class="ttc" id="log__comm_8h_html_a3c0be9b9f104459ab90ee18af95c4b3eaef0e7c96ca3684ce2422a33afe8f35fc"><div class="ttname"><a href="log__comm_8h.html#a3c0be9b9f104459ab90ee18af95c4b3eaef0e7c96ca3684ce2422a33afe8f35fc">TRAN_UNACTIVE_COMMITTED_WITH_POSTPONE</a></div><div class="ttdef"><b>Definition:</b> <a href="log__comm_8h_source.html#l00046">log_comm.h:46</a></div></div>
<div class="ttc" id="system__parameter_8h_html_a23aaf6bca406b9b428f43ad1b6b2b3e0af85fd9025390891d6e2b7992f43082fb"><div class="ttname"><a href="system__parameter_8h.html#a23aaf6bca406b9b428f43ad1b6b2b3e0af85fd9025390891d6e2b7992f43082fb">PRM_ID_LOG_SWEEP_CLEAN</a></div><div class="ttdef"><b>Definition:</b> <a href="system__parameter_8h_source.html#l00136">system_parameter.h:136</a></div></div>
<div class="ttc" id="log__manager_8c_html_aa47fde07d75699fe2a4167ba8d760664"><div class="ttname"><a href="log__manager_8c.html#aa47fde07d75699fe2a4167ba8d760664">log_sysop_end_random_exit</a></div><div class="ttdeci">STATIC_INLINE void log_sysop_end_random_exit(THREAD_ENTRY *thread_p) __attribute__((ALWAYS_INLINE))</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l03752">log_manager.c:3752</a></div></div>
<div class="ttc" id="log__global_8c_html_a60bf1affc62af917b4de5664211c181f"><div class="ttname"><a href="log__global_8c.html#a60bf1affc62af917b4de5664211c181f">log_Name_bkupinfo</a></div><div class="ttdeci">char log_Name_bkupinfo[PATH_MAX]</div><div class="ttdef"><b>Definition:</b> <a href="log__global_8c_source.html#l00117">log_global.c:117</a></div></div>
<div class="ttc" id="structlog__2pc__coordinator_html_a8a6d9a179baa8194a02bd804e2c8c0cd"><div class="ttname"><a href="structlog__2pc__coordinator.html#a8a6d9a179baa8194a02bd804e2c8c0cd">log_2pc_coordinator::ack_received</a></div><div class="ttdeci">int * ack_received</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01265">log_impl.h:1265</a></div></div>
<div class="ttc" id="atldb__cubrid_8h_html_a1d99dd3a57d51d7fa3d98f80297633e1"><div class="ttname"><a href="atldb__cubrid_8h.html#a1d99dd3a57d51d7fa3d98f80297633e1">offsetof</a></div><div class="ttdeci">LPOLESTR DBORDINAL flags BYTE BYTE offsetof(_Class, member) \ }</div></div>
<div class="ttc" id="structlog__rec__replication_html"><div class="ttname"><a href="structlog__rec__replication.html">log_rec_replication</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00715">log_impl.h:715</a></div></div>
<div class="ttc" id="storage__common_8h_html_a5b0ca3ea530f289fa3f19921e5b0faf3"><div class="ttname"><a href="storage__common_8h.html#a5b0ca3ea530f289fa3f19921e5b0faf3">NULL_OFFSET</a></div><div class="ttdeci">#define NULL_OFFSET</div><div class="ttdef"><b>Definition:</b> <a href="storage__common_8h_source.html#l00049">storage_common.h:49</a></div></div>
<div class="ttc" id="log__impl_8h_html_a7377d8298f9fa6a5d11a79e4fb412729a1c16c3853a4b9406340b78d31d264b36"><div class="ttname"><a href="log__impl_8h.html#a7377d8298f9fa6a5d11a79e4fb412729a1c16c3853a4b9406340b78d31d264b36">LOG_RESTARTED</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01815">log_impl.h:1815</a></div></div>
<div class="ttc" id="log__impl_8h_html_aaa150f6c2ae6a1748640ab281ffd94f7a017e6014fefb381f8583c7ccd87c4133"><div class="ttname"><a href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a017e6014fefb381f8583c7ccd87c4133">LOG_2PC_ABORT_INFORM_PARTICPS</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00596">log_impl.h:596</a></div></div>
<div class="ttc" id="structlog__prior__lsa__info_html_adb03b78b697ffe97dce7c7d1fc763dc4"><div class="ttname"><a href="structlog__prior__lsa__info.html#adb03b78b697ffe97dce7c7d1fc763dc4">log_prior_lsa_info::prior_lsa_mutex</a></div><div class="ttdeci">pthread_mutex_t prior_lsa_mutex</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01881">log_impl.h:1881</a></div></div>
<div class="ttc" id="log__comm_8h_html_a3c0be9b9f104459ab90ee18af95c4b3ea476b9d64087d43ced76a1534a089fbcd"><div class="ttname"><a href="log__comm_8h.html#a3c0be9b9f104459ab90ee18af95c4b3ea476b9d64087d43ced76a1534a089fbcd">TRAN_UNACTIVE_COMMITTED_INFORMING_PARTICIPANTS</a></div><div class="ttdef"><b>Definition:</b> <a href="log__comm_8h_source.html#l00064">log_comm.h:64</a></div></div>
<div class="ttc" id="storage__common_8h_html_a26dd766712df5b5c4fcd158f571a75e4"><div class="ttname"><a href="storage__common_8h.html#a26dd766712df5b5c4fcd158f571a75e4">LSA_ISNULL</a></div><div class="ttdeci">#define LSA_ISNULL(lsa_ptr)</div><div class="ttdef"><b>Definition:</b> <a href="storage__common_8h_source.html#l00137">storage_common.h:137</a></div></div>
<div class="ttc" id="structlog__global_html_a1e76ccd9e44777acc719b8f1bdbb93bb"><div class="ttname"><a href="structlog__global.html#a1e76ccd9e44777acc719b8f1bdbb93bb">log_global::prior_info</a></div><div class="ttdeci">LOG_PRIOR_LSA_INFO prior_info</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01940">log_impl.h:1940</a></div></div>
<div class="ttc" id="log__impl_8h_html_a99e07d445f133a194b23cf7effd85c08"><div class="ttname"><a href="log__impl_8h.html#a99e07d445f133a194b23cf7effd85c08">logpb_remove_archive_logs_exceed_limit</a></div><div class="ttdeci">int logpb_remove_archive_logs_exceed_limit(THREAD_ENTRY *thread_p, int max_count)</div><div class="ttdef"><b>Definition:</b> <a href="log__page__buffer_8c_source.html#l07209">log_page_buffer.c:7209</a></div></div>
<div class="ttc" id="log__impl_8h_html_a84f37ef4ed6965224995a001ad15ba7e"><div class="ttname"><a href="log__impl_8h.html#a84f37ef4ed6965224995a001ad15ba7e">LOG_SET_CURRENT_TRAN_INDEX</a></div><div class="ttdeci">#define LOG_SET_CURRENT_TRAN_INDEX(thrd, index)</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00941">log_impl.h:941</a></div></div>
<div class="ttc" id="log__global_8c_html_a9ee59aac2d33d791fecba2731f3fa531"><div class="ttname"><a href="log__global_8c.html#a9ee59aac2d33d791fecba2731f3fa531">log_Name_bg_archive</a></div><div class="ttdeci">char log_Name_bg_archive[PATH_MAX]</div><div class="ttdef"><b>Definition:</b> <a href="log__global_8c_source.html#l00119">log_global.c:119</a></div></div>
<div class="ttc" id="log__impl_8h_html_a40a91713414be68a8000f379f883ad06a56092aa8f2fff2e94d2925351bf404c1"><div class="ttname"><a href="log__impl_8h.html#a40a91713414be68a8000f379f883ad06a56092aa8f2fff2e94d2925351bf404c1">LOB_PERMANENT_DELETED</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00460">log_impl.h:460</a></div></div>
<div class="ttc" id="page__buffer_8c_html_afaab282d5976ee6db15214305dcae248"><div class="ttname"><a href="page__buffer_8c.html#afaab282d5976ee6db15214305dcae248">pgbuf_flush_all</a></div><div class="ttdeci">int pgbuf_flush_all(THREAD_ENTRY *thread_p, VOLID volid)</div><div class="ttdef"><b>Definition:</b> <a href="page__buffer_8c_source.html#l03068">page_buffer.c:3068</a></div></div>
<div class="ttc" id="error__manager_8c_html_ae4dfdf0d17782bd51e4612e68fc18c68"><div class="ttname"><a href="error__manager_8c.html#ae4dfdf0d17782bd51e4612e68fc18c68">er_set_with_oserror</a></div><div class="ttdeci">void er_set_with_oserror(int severity, const char *file_name, const int line_no, int err_id, int num_args,...)</div><div class="ttdef"><b>Definition:</b> <a href="error__manager_8c_source.html#l01270">error_manager.c:1270</a></div></div>
<div class="ttc" id="storage__common_8c_html_a1f56b2edce95595c884a8393449e7cde"><div class="ttname"><a href="storage__common_8c.html#a1f56b2edce95595c884a8393449e7cde">lsa_to_string</a></div><div class="ttdeci">char * lsa_to_string(char *buf, int buf_size, LOG_LSA *lsa)</div><div class="ttdef"><b>Definition:</b> <a href="storage__common_8c_source.html#l00372">storage_common.c:372</a></div></div>
<div class="ttc" id="error__code_8h_html_a4b8e41e78be77c579a2c58f5248fefe2"><div class="ttname"><a href="error__code_8h.html#a4b8e41e78be77c579a2c58f5248fefe2">ER_LOG_UNKNOWN_TRANINDEX</a></div><div class="ttdeci">#define ER_LOG_UNKNOWN_TRANINDEX</div><div class="ttdef"><b>Definition:</b> <a href="error__code_8h_source.html#l00909">error_code.h:909</a></div></div>
<div class="ttc" id="object__primitive_8c_html_a7c633c9f87690aa563bdeaf44f340307"><div class="ttname"><a href="object__primitive_8c.html#a7c633c9f87690aa563bdeaf44f340307">pr_clear_value</a></div><div class="ttdeci">int pr_clear_value(DB_VALUE *value)</div><div class="ttdef"><b>Definition:</b> <a href="object__primitive_8c_source.html#l01920">object_primitive.c:1920</a></div></div>
<div class="ttc" id="message__catalog_8h_html_a9b41bc5c782e79c0112014e50461e364"><div class="ttname"><a href="message__catalog_8h.html#a9b41bc5c782e79c0112014e50461e364">MSGCAT_CATALOG_CUBRID</a></div><div class="ttdeci">#define MSGCAT_CATALOG_CUBRID</div><div class="ttdef"><b>Definition:</b> <a href="message__catalog_8h_source.html#l00035">message_catalog.h:35</a></div></div>
<div class="ttc" id="log__manager_8c_html_a7ef2b913287067a2beccb363958ee1ae"><div class="ttname"><a href="log__manager_8c.html#a7ef2b913287067a2beccb363958ee1ae">log_append_ha_server_state</a></div><div class="ttdeci">void log_append_ha_server_state(THREAD_ENTRY *thread_p, int state)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l03178">log_manager.c:3178</a></div></div>
<div class="ttc" id="log__manager_8c_html_a783bfa7c5f1b28d55d1c7bec2491f971"><div class="ttname"><a href="log__manager_8c.html#a783bfa7c5f1b28d55d1c7bec2491f971">log_active_log_header_end_scan</a></div><div class="ttdeci">int log_active_log_header_end_scan(THREAD_ENTRY *thread_p, void **ptr)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l09814">log_manager.c:9814</a></div></div>
<div class="ttc" id="log__impl_8h_html_aaa150f6c2ae6a1748640ab281ffd94f7a69f87b42501f2ccfe66922ab196102d7"><div class="ttname"><a href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a69f87b42501f2ccfe66922ab196102d7">LOG_2PC_START</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00591">log_impl.h:591</a></div></div>
<div class="ttc" id="xasl__cache_8c_html_a5bb382a71045eea422d2ce819c1d0736"><div class="ttname"><a href="xasl__cache_8c.html#a5bb382a71045eea422d2ce819c1d0736">xcache_remove_by_oid</a></div><div class="ttdeci">void xcache_remove_by_oid(THREAD_ENTRY *thread_p, OID *oid)</div><div class="ttdef"><b>Definition:</b> <a href="xasl__cache_8c_source.html#l01790">xasl_cache.c:1790</a></div></div>
<div class="ttc" id="structlog__rec__savept_html_af4be23754ed4d5067cff4a7e2bc4f726"><div class="ttname"><a href="structlog__rec__savept.html#af4be23754ed4d5067cff4a7e2bc4f726">log_rec_savept::length</a></div><div class="ttdeci">int length</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01635">log_impl.h:1635</a></div></div>
<div class="ttc" id="structarchive__log__header__scan__context_html"><div class="ttname"><a href="structarchive__log__header__scan__context.html">archive_log_header_scan_context</a></div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l00187">log_manager.c:187</a></div></div>
<div class="ttc" id="object__representation_8h_html_a8e0944f13c6ffe078d6aeb50c91171d1"><div class="ttname"><a href="object__representation_8h.html#a8e0944f13c6ffe078d6aeb50c91171d1">or_unpack_mem_value</a></div><div class="ttdeci">char * or_unpack_mem_value(char *buf, DB_VALUE *value)</div><div class="ttdef"><b>Definition:</b> <a href="object__representation_8c_source.html#l07017">object_representation.c:7017</a></div></div>
<div class="ttc" id="structlog__rec__mvcc__undoredo_html_a2183ac89e08754f146da20b81dc18a24"><div class="ttname"><a href="structlog__rec__mvcc__undoredo.html#a2183ac89e08754f146da20b81dc18a24">log_rec_mvcc_undoredo::undoredo</a></div><div class="ttdeci">LOG_REC_UNDOREDO undoredo</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00691">log_impl.h:691</a></div></div>
<div class="ttc" id="atldb__cubrid_8h_html_ae1f6914bd1202350b5825827bef9bba5"><div class="ttname"><a href="atldb__cubrid_8h.html#ae1f6914bd1202350b5825827bef9bba5">size</a></div><div class="ttdeci">size</div><div class="ttdef"><b>Definition:</b> <a href="atldb__cubrid_8h_source.html#l19380">atldb_cubrid.h:19380</a></div></div>
<div class="ttc" id="structlog__group__commit__info_html_ab3b1d1fcf98e9d21ad8539ac227da927"><div class="ttname"><a href="structlog__group__commit__info.html#ab3b1d1fcf98e9d21ad8539ac227da927">log_group_commit_info::gc_cond</a></div><div class="ttdeci">pthread_cond_t gc_cond</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01137">log_impl.h:1137</a></div></div>
<div class="ttc" id="page__buffer_8c_html_a95c9161ba3bb8e129b0c2407447c1b1b"><div class="ttname"><a href="page__buffer_8c.html#a95c9161ba3bb8e129b0c2407447c1b1b">pgbuf_set_lsa</a></div><div class="ttdeci">const LOG_LSA * pgbuf_set_lsa(THREAD_ENTRY *thread_p, PAGE_PTR pgptr, const LOG_LSA *lsa_ptr)</div><div class="ttdef"><b>Definition:</b> <a href="page__buffer_8c_source.html#l04406">page_buffer.c:4406</a></div></div>
<div class="ttc" id="structlog__header_html_a69b0ace883f579f1f029b57b86901cda"><div class="ttname"><a href="structlog__header.html#a69b0ace883f579f1f029b57b86901cda">log_header::db_release</a></div><div class="ttdeci">char db_release[REL_MAX_RELEASE_LENGTH]</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00196">log_impl.h:196</a></div></div>
<div class="ttc" id="structlog__repl_html_a631c551c097c7f5d7e15bb59f4ec5219"><div class="ttname"><a href="structlog__repl.html#a631c551c097c7f5d7e15bb59f4ec5219">log_repl::must_flush</a></div><div class="ttdeci">LOG_REPL_FLUSH must_flush</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01511">log_impl.h:1511</a></div></div>
<div class="ttc" id="log__manager_8c_html_a8ba8a8666ca892dac7b456367d153965"><div class="ttname"><a href="log__manager_8c.html#a8ba8a8666ca892dac7b456367d153965">log_sysop_abort</a></div><div class="ttdeci">void log_sysop_abort(THREAD_ENTRY *thread_p)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l04097">log_manager.c:4097</a></div></div>
<div class="ttc" id="error__code_8h_html_ab640f510b37216f99230b20f1994131b"><div class="ttname"><a href="error__code_8h.html#ab640f510b37216f99230b20f1994131b">ER_LOG_MISSING_COMPENSATING_RECORD</a></div><div class="ttdeci">#define ER_LOG_MISSING_COMPENSATING_RECORD</div><div class="ttdef"><b>Definition:</b> <a href="error__code_8h_source.html#l00775">error_code.h:775</a></div></div>
<div class="ttc" id="structlog__tdes_html_ab60d7bef0b3e1d89b1a0a9865a2a4bef"><div class="ttname"><a href="structlog__tdes.html#ab60d7bef0b3e1d89b1a0a9865a2a4bef">log_tdes::repl_records</a></div><div class="ttdeci">struct log_repl * repl_records</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01736">log_impl.h:1736</a></div></div>
<div class="ttc" id="system__parameter_8h_html_a23aaf6bca406b9b428f43ad1b6b2b3e0a5dbc37ecf3f779e5b878d30ecc653b75"><div class="ttname"><a href="system__parameter_8h.html#a23aaf6bca406b9b428f43ad1b6b2b3e0a5dbc37ecf3f779e5b878d30ecc653b75">PRM_ID_REMOVE_LOG_ARCHIVES_INTERVAL</a></div><div class="ttdef"><b>Definition:</b> <a href="system__parameter_8h_source.html#l00274">system_parameter.h:274</a></div></div>
<div class="ttc" id="structlog__rec__undoredo_html"><div class="ttname"><a href="structlog__rec__undoredo.html">log_rec_undoredo</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00654">log_impl.h:654</a></div></div>
<div class="ttc" id="structlog__rec__sysop__end_html_aee18ec7d007cfa72f33ca61fcb93e7b3"><div class="ttname"><a href="structlog__rec__sysop__end.html#aee18ec7d007cfa72f33ca61fcb93e7b3">log_rec_sysop_end::prv_topresult_lsa</a></div><div class="ttdeci">LOG_LSA prv_topresult_lsa</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01562">log_impl.h:1562</a></div></div>
<div class="ttc" id="structlog__rcv_html_a8400bbfec907d992bc47a641dbd2eeb2"><div class="ttname"><a href="structlog__rcv.html#a8400bbfec907d992bc47a641dbd2eeb2">log_rcv::reference_lsa</a></div><div class="ttdeci">LOG_LSA reference_lsa</div><div class="ttdef"><b>Definition:</b> <a href="recovery_8h_source.html#l00197">recovery.h:197</a></div></div>
<div class="ttc" id="log__impl_8h_html_aaa150f6c2ae6a1748640ab281ffd94f7a1903de7cf7fa88081eb8010a667e1839"><div class="ttname"><a href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a1903de7cf7fa88081eb8010a667e1839">LOG_COMMIT</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00553">log_impl.h:553</a></div></div>
<div class="ttc" id="log__manager_8c_html_a62a934c871b6ec0f1feeecaea8cfc4dd"><div class="ttname"><a href="log__manager_8c.html#a62a934c871b6ec0f1feeecaea8cfc4dd">LOG_FLUSH_LOGGING_HAS_BEEN_SKIPPED</a></div><div class="ttdeci">#define LOG_FLUSH_LOGGING_HAS_BEEN_SKIPPED(thread_p)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l00117">log_manager.c:117</a></div></div>
<div class="ttc" id="log__manager_8c_html_a53d35f511b18f8af20ed5eb09c286c73"><div class="ttname"><a href="log__manager_8c.html#a53d35f511b18f8af20ed5eb09c286c73">log_active_log_header_next_scan</a></div><div class="ttdeci">SCAN_CODE log_active_log_header_next_scan(THREAD_ENTRY *thread_p, int cursor, DB_VALUE **out_values, int out_cnt, void *ptr)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l09572">log_manager.c:9572</a></div></div>
<div class="ttc" id="log__impl_8h_html_abc226e48b6f8147e3e0fe83c98eb69fb"><div class="ttname"><a href="log__impl_8h.html#abc226e48b6f8147e3e0fe83c98eb69fb">LOG_ISTRAN_2PC_PREPARE</a></div><div class="ttdeci">#define LOG_ISTRAN_2PC_PREPARE(tdes)</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00991">log_impl.h:991</a></div></div>
<div class="ttc" id="log__manager_8c_html_a857d88396b8d4d3ee5880e3005eeb90d"><div class="ttname"><a href="log__manager_8c.html#a857d88396b8d4d3ee5880e3005eeb90d">LOCATOR_KEY</a></div><div class="ttdeci">#define LOCATOR_KEY(locator_)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l00144">log_manager.c:144</a></div></div>
<div class="ttc" id="log__impl_8h_html_acf5f6153472b3cc0416da31dd9f276c0"><div class="ttname"><a href="log__impl_8h.html#acf5f6153472b3cc0416da31dd9f276c0">logtb_get_current_mvccid</a></div><div class="ttdeci">MVCCID logtb_get_current_mvccid(THREAD_ENTRY *thread_p)</div><div class="ttdef"><b>Definition:</b> <a href="log__tran__table_8c_source.html#l04662">log_tran_table.c:4662</a></div></div>
<div class="ttc" id="structlog__global_html_a7083cc630872e035c2a886397b2dfdf6"><div class="ttname"><a href="structlog__global.html#a7083cc630872e035c2a886397b2dfdf6">log_global::run_nxchkpt_atpageid</a></div><div class="ttdeci">LOG_PAGEID run_nxchkpt_atpageid</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01943">log_impl.h:1943</a></div></div>
<div class="ttc" id="system__parameter_8h_html_a23aaf6bca406b9b428f43ad1b6b2b3e0aaa655444407adc3dbc365fa01c062ec1"><div class="ttname"><a href="system__parameter_8h.html#a23aaf6bca406b9b428f43ad1b6b2b3e0aaa655444407adc3dbc365fa01c062ec1">PRM_ID_LOG_NBUFFERS</a></div><div class="ttdef"><b>Definition:</b> <a href="system__parameter_8h_source.html#l00123">system_parameter.h:123</a></div></div>
<div class="ttc" id="recovery_8h_html_af3c089b92ed018ab83b9aec566a04d88"><div class="ttname"><a href="recovery_8h.html#af3c089b92ed018ab83b9aec566a04d88">RCV_IS_BTREE_LOGICAL_LOG</a></div><div class="ttdeci">#define RCV_IS_BTREE_LOGICAL_LOG(idx)</div><div class="ttdef"><b>Definition:</b> <a href="recovery_8h_source.html#l00221">recovery.h:221</a></div></div>
<div class="ttc" id="environment__variable_8c_html_ad0768cecff71f50ceac4edefb8958d30"><div class="ttname"><a href="environment__variable_8c.html#ad0768cecff71f50ceac4edefb8958d30">envvar_get</a></div><div class="ttdeci">const char * envvar_get(const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="environment__variable_8c_source.html#l00190">environment_variable.c:190</a></div></div>
<div class="ttc" id="storage__common_8h_html_ab6db6dc2e50e5821d2b8cdbfdeee71ef"><div class="ttname"><a href="storage__common_8h.html#ab6db6dc2e50e5821d2b8cdbfdeee71ef">NULL_TRAN_INDEX</a></div><div class="ttdeci">#define NULL_TRAN_INDEX</div><div class="ttdef"><b>Definition:</b> <a href="storage__common_8h_source.html#l00460">storage_common.h:460</a></div></div>
<div class="ttc" id="structbackground__archiving__info_html_a762172b07fc9fff23ea47f01026f36df"><div class="ttname"><a href="structbackground__archiving__info.html#a762172b07fc9fff23ea47f01026f36df">background_archiving_info::start_page_id</a></div><div class="ttdeci">LOG_PAGEID start_page_id</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00388">log_impl.h:388</a></div></div>
<div class="ttc" id="run-tests_8php_html_aaa193b0c1c2b93841472b26e2e281751"><div class="ttname"><a href="run-tests_8php.html#aaa193b0c1c2b93841472b26e2e281751">error</a></div><div class="ttdeci">error($message)</div><div class="ttdef"><b>Definition:</b> <a href="run-tests_8php_source.html#l02122">run-tests.php:2122</a></div></div>
<div class="ttc" id="structlog__tdes_html_a6889e1a9d5092d507af7143097394692"><div class="ttname"><a href="structlog__tdes.html#a6889e1a9d5092d507af7143097394692">log_tdes::append_repl_recidx</a></div><div class="ttdeci">int append_repl_recidx</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01734">log_impl.h:1734</a></div></div>
<div class="ttc" id="heap__file_8c_html_a6adbab21addd8609c2d132eb1ed5e609"><div class="ttname"><a href="heap__file_8c.html#a6adbab21addd8609c2d132eb1ed5e609">heap_classrepr_decache</a></div><div class="ttdeci">int heap_classrepr_decache(THREAD_ENTRY *thread_p, const OID *class_oid)</div><div class="ttdef"><b>Definition:</b> <a href="heap__file_8c_source.html#l01739">heap_file.c:1739</a></div></div>
<div class="ttc" id="log__comm_8h_html_a3c0be9b9f104459ab90ee18af95c4b3eac19d6ad89f93ec75c1e1904db0e5c0ad"><div class="ttname"><a href="log__comm_8h.html#a3c0be9b9f104459ab90ee18af95c4b3eac19d6ad89f93ec75c1e1904db0e5c0ad">TRAN_UNACTIVE_ABORTED</a></div><div class="ttdef"><b>Definition:</b> <a href="log__comm_8h_source.html#l00049">log_comm.h:49</a></div></div>
<div class="ttc" id="structlog__header_html_a6e36b30ec4db6a60e287d0a48fa5c907"><div class="ttname"><a href="structlog__header.html#a6e36b30ec4db6a60e287d0a48fa5c907">log_header::db_iopagesize</a></div><div class="ttdeci">PGLENGTH db_iopagesize</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00199">log_impl.h:199</a></div></div>
<div class="ttc" id="src_2base_2rb__tree_8h_html_a9c7350c93a42f7c017405c95676a3092"><div class="ttname"><a href="src_2base_2rb__tree_8h.html#a9c7350c93a42f7c017405c95676a3092">RB_ENTRY</a></div><div class="ttdeci">#define RB_ENTRY(type)</div><div class="ttdef"><b>Definition:</b> <a href="src_2base_2rb__tree_8h_source.html#l00050">rb_tree.h:50</a></div></div>
<div class="ttc" id="log__manager_8c_html_a853fd7ef5f6abc4a182d6e79f0a4846f"><div class="ttname"><a href="log__manager_8c.html#a853fd7ef5f6abc4a182d6e79f0a4846f">log_append_postpone</a></div><div class="ttdeci">void log_append_postpone(THREAD_ENTRY *thread_p, LOG_RCVINDEX rcvindex, LOG_DATA_ADDR *addr, int length, const void *data)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l02720">log_manager.c:2720</a></div></div>
<div class="ttc" id="structlog__append__info_html_a749ad18f9d9d9fd65aaf1b9b8a25e926"><div class="ttname"><a href="structlog__append__info.html#a749ad18f9d9d9fd65aaf1b9b8a25e926">log_append_info::prev_lsa</a></div><div class="ttdeci">LOG_LSA prev_lsa</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01206">log_impl.h:1206</a></div></div>
<div class="ttc" id="system__parameter_8h_html_a23aaf6bca406b9b428f43ad1b6b2b3e0a941dffd866597ae3fa646a852919fef4"><div class="ttname"><a href="system__parameter_8h.html#a23aaf6bca406b9b428f43ad1b6b2b3e0a941dffd866597ae3fa646a852919fef4">PRM_ID_LOG_TRACE_DEBUG</a></div><div class="ttdef"><b>Definition:</b> <a href="system__parameter_8h_source.html#l00262">system_parameter.h:262</a></div></div>
<div class="ttc" id="dbtype__def_8h_html_a63597e7809fc77d3110c5b22699f2e0a"><div class="ttname"><a href="dbtype__def_8h.html#a63597e7809fc77d3110c5b22699f2e0a">VPID_ISNULL</a></div><div class="ttdeci">#define VPID_ISNULL(vpid_ptr)</div><div class="ttdef"><b>Definition:</b> <a href="dbtype__def_8h_source.html#l00950">dbtype_def.h:950</a></div></div>
<div class="ttc" id="structlog__header_html_a80c946bc9948fd5bf1011dba3e0481a8"><div class="ttname"><a href="structlog__header.html#a80c946bc9948fd5bf1011dba3e0481a8">log_header::nxarv_phy_pageid</a></div><div class="ttdeci">LOG_PHY_PAGEID nxarv_phy_pageid</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00217">log_impl.h:217</a></div></div>
<div class="ttc" id="log__impl_8h_html_a94895f5d3bc1246f3902870a56738763"><div class="ttname"><a href="log__impl_8h.html#a94895f5d3bc1246f3902870a56738763">LOG_DBLOG_ACTIVE_VOLID</a></div><div class="ttdeci">#define LOG_DBLOG_ACTIVE_VOLID</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00491">log_impl.h:491</a></div></div>
<div class="ttc" id="structlog__rec__2pc__particp__ack_html_ad3ac1fafb79f0ce5ab5551517bb78785"><div class="ttname"><a href="structlog__rec__2pc__particp__ack.html#ad3ac1fafb79f0ce5ab5551517bb78785">log_rec_2pc_particp_ack::particp_index</a></div><div class="ttdeci">int particp_index</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01667">log_impl.h:1667</a></div></div>
<div class="ttc" id="structlog__rcv_html_afc672de81dd88914d00281fada1acc13"><div class="ttname"><a href="structlog__rcv.html#afc672de81dd88914d00281fada1acc13">log_rcv::data</a></div><div class="ttdeci">const char * data</div><div class="ttdef"><b>Definition:</b> <a href="recovery_8h_source.html#l00196">recovery.h:196</a></div></div>
<div class="ttc" id="page__buffer_8h_html_a4c8498d851d45af7bd1aa005f03c71adabbd389e885455638c44f6bea1524ae65"><div class="ttname"><a href="page__buffer_8h.html#a4c8498d851d45af7bd1aa005f03c71adabbd389e885455638c44f6bea1524ae65">PGBUF_LATCH_WRITE</a></div><div class="ttdef"><b>Definition:</b> <a href="page__buffer_8h_source.html#l00178">page_buffer.h:178</a></div></div>
<div class="ttc" id="release__string_8c_html_ac6111ab82c826c5ad99f66dbba0892a3"><div class="ttname"><a href="release__string_8c.html#ac6111ab82c826c5ad99f66dbba0892a3">rel_get_disk_compatible</a></div><div class="ttdeci">REL_COMPATIBILITY rel_get_disk_compatible(float db_level, REL_FIXUP_FUNCTION **fixups)</div><div class="ttdef"><b>Definition:</b> <a href="release__string_8c_source.html#l00295">release_string.c:295</a></div></div>
<div class="ttc" id="log__manager_8c_html_a699da5ea92f9390e4ae6169d7b2ac73a"><div class="ttname"><a href="log__manager_8c.html#a699da5ea92f9390e4ae6169d7b2ac73a">log_append_undo_recdes2</a></div><div class="ttdeci">void log_append_undo_recdes2(THREAD_ENTRY *thread_p, LOG_RCVINDEX rcvindex, const VFID *vfid, PAGE_PTR pgptr, PGLENGTH offset, const RECDES *recdes)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l02557">log_manager.c:2557</a></div></div>
<div class="ttc" id="structlog__repl_html_ad89451a257ef66d62f1bb92bec8c99b6"><div class="ttname"><a href="structlog__repl.html#ad89451a257ef66d62f1bb92bec8c99b6">log_repl::repl_type</a></div><div class="ttdeci">LOG_RECTYPE repl_type</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01505">log_impl.h:1505</a></div></div>
<div class="ttc" id="perf__monitor_8h_html_af4850f6b1c604051a0aa7704883eeb07"><div class="ttname"><a href="perf__monitor_8h.html#af4850f6b1c604051a0aa7704883eeb07">perfmon_inc_stat</a></div><div class="ttdeci">STATIC_INLINE void perfmon_inc_stat(THREAD_ENTRY *thread_p, PERF_STAT_ID psid) __attribute__((ALWAYS_INLINE))</div></div>
<div class="ttc" id="classcubthread_1_1daemon_html_a0c85191bbbfc161467c3bab4ea99c401"><div class="ttname"><a href="classcubthread_1_1daemon.html#a0c85191bbbfc161467c3bab4ea99c401">cubthread::daemon::wakeup</a></div><div class="ttdeci">void wakeup(void)</div><div class="ttdef"><b>Definition:</b> <a href="thread__daemon_8cpp_source.html#l00072">thread_daemon.cpp:72</a></div></div>
<div class="ttc" id="namespacecubthread_html_ab660224caa990a5ce9b3d65d5789ba46"><div class="ttname"><a href="namespacecubthread.html#ab660224caa990a5ce9b3d65d5789ba46">cubthread::delta_time</a></div><div class="ttdeci">std::chrono::system_clock::duration delta_time</div><div class="ttdef"><b>Definition:</b> <a href="thread__looper_8hpp_source.html#l00041">thread_looper.hpp:41</a></div></div>
<div class="ttc" id="src_2base_2rb__tree_8h_html_af0ae89dc9239fbe8c056eeed595cedac"><div class="ttname"><a href="src_2base_2rb__tree_8h.html#af0ae89dc9239fbe8c056eeed595cedac">RB_FIND</a></div><div class="ttdeci">#define RB_FIND(name, x, y)</div><div class="ttdef"><b>Definition:</b> <a href="src_2base_2rb__tree_8h_source.html#l00468">rb_tree.h:468</a></div></div>
<div class="ttc" id="system_8h_html_a41f9c5fb8b08eb5dc3edce4dcb37fee7"><div class="ttname"><a href="system_8h.html#a41f9c5fb8b08eb5dc3edce4dcb37fee7">true</a></div><div class="ttdeci">#define true</div><div class="ttdef"><b>Definition:</b> <a href="system_8h_source.html#l00094">system.h:94</a></div></div>
<div class="ttc" id="log__impl_8h_html_ab6259b55420e741a2b4e5b9d05778f85"><div class="ttname"><a href="log__impl_8h.html#ab6259b55420e741a2b4e5b9d05778f85">logtb_free_tran_index</a></div><div class="ttdeci">void logtb_free_tran_index(THREAD_ENTRY *thread_p, int tran_index)</div><div class="ttdef"><b>Definition:</b> <a href="log__tran__table_8c_source.html#l01490">log_tran_table.c:1490</a></div></div>
<div class="ttc" id="log__manager_8c_html_a057f42ec8bf86c3671408fa458a7166a"><div class="ttname"><a href="log__manager_8c.html#a057f42ec8bf86c3671408fa458a7166a">log_check_system_op_is_started</a></div><div class="ttdeci">bool log_check_system_op_is_started(THREAD_ENTRY *thread_p)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l04256">log_manager.c:4256</a></div></div>
<div class="ttc" id="structlog__rec__start__postpone_html"><div class="ttname"><a href="structlog__rec__start__postpone.html">log_rec_start_postpone</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01533">log_impl.h:1533</a></div></div>
<div class="ttc" id="log__impl_8h_html_aaa150f6c2ae6a1748640ab281ffd94f7a661c01f08dbb476251ceae0d99bb5412"><div class="ttname"><a href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a661c01f08dbb476251ceae0d99bb5412">LOG_UNDO_DATA</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00535">log_impl.h:535</a></div></div>
<div class="ttc" id="page__buffer_8h_html_ae6319b9827ca0534c44c3e713c6fd2f3"><div class="ttname"><a href="page__buffer_8h.html#ae6319b9827ca0534c44c3e713c6fd2f3">pgbuf_fix_if_not_deallocated</a></div><div class="ttdeci">#define pgbuf_fix_if_not_deallocated(thread_p, vpid, latch_mode, latch_condition, page)</div><div class="ttdef"><b>Definition:</b> <a href="page__buffer_8h_source.html#l00427">page_buffer.h:427</a></div></div>
<div class="ttc" id="structlog__page_html"><div class="ttname"><a href="structlog__page.html">log_page</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00143">log_impl.h:143</a></div></div>
<div class="ttc" id="perf__monitor_8h_html_a55d27b01d605ba6ee2929ddfe8588320"><div class="ttname"><a href="perf__monitor_8h.html#a55d27b01d605ba6ee2929ddfe8588320">LOG_FIND_THREAD_TRAN_INDEX</a></div><div class="ttdeci">#define LOG_FIND_THREAD_TRAN_INDEX(thrd)</div><div class="ttdef"><b>Definition:</b> <a href="perf__monitor_8h_source.html#l00157">perf_monitor.h:157</a></div></div>
<div class="ttc" id="thread__manager_8hpp_html"><div class="ttname"><a href="thread__manager_8hpp.html">thread_manager.hpp</a></div></div>
<div class="ttc" id="log__impl_8h_html_abad882a19ae7b3bc3ccf42a8cdcdb689"><div class="ttname"><a href="log__impl_8h.html#abad882a19ae7b3bc3ccf42a8cdcdb689">LOG_READ_ALIGN</a></div><div class="ttdeci">#define LOG_READ_ALIGN(thread_p, lsa, log_pgptr)</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00882">log_impl.h:882</a></div></div>
<div class="ttc" id="structlog__rec__compensate_html"><div class="ttname"><a href="structlog__rec__compensate.html">log_rec_compensate</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01524">log_impl.h:1524</a></div></div>
<div class="ttc" id="log__impl_8h_html_a24797b2fe67e0ec8631d7a92fbef25c9ac4566a4bae57d0a42fa6e37cc65e5329"><div class="ttname"><a href="log__impl_8h.html#a24797b2fe67e0ec8631d7a92fbef25c9ac4566a4bae57d0a42fa6e37cc65e5329">LOG_SYSOP_END_LOGICAL_UNDO</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01543">log_impl.h:1543</a></div></div>
<div class="ttc" id="leak__detector_8h_html_a9d4b5df3530d1bc733070a4669ba6ebc"><div class="ttname"><a href="leak__detector_8h.html#a9d4b5df3530d1bc733070a4669ba6ebc">free</a></div><div class="ttdeci">#define free(p)</div><div class="ttdef"><b>Definition:</b> <a href="leak__detector_8h_source.html#l00005">leak_detector.h:5</a></div></div>
<div class="ttc" id="error__code_8h_html_a03134a0c4a1f76b2046a4870ba21993d"><div class="ttname"><a href="error__code_8h.html#a03134a0c4a1f76b2046a4870ba21993d">ER_HA_REPL_DELAY_RESOLVED</a></div><div class="ttdeci">#define ER_HA_REPL_DELAY_RESOLVED</div><div class="ttdef"><b>Definition:</b> <a href="error__code_8h_source.html#l01279">error_code.h:1279</a></div></div>
<div class="ttc" id="error__manager_8h_html_acab3c3bd72ee8932697910ae60349ffc"><div class="ttname"><a href="error__manager_8h.html#acab3c3bd72ee8932697910ae60349ffc">ARG_FILE_LINE</a></div><div class="ttdeci">#define ARG_FILE_LINE</div><div class="ttdef"><b>Definition:</b> <a href="error__manager_8h_source.html#l00045">error_manager.h:45</a></div></div>
<div class="ttc" id="porting_8c_html_aeb79f86261de904967d433c1b5e9a1de"><div class="ttname"><a href="porting_8c.html#aeb79f86261de904967d433c1b5e9a1de">strlcpy</a></div><div class="ttdeci">size_t strlcpy(char *dst, const char *src, size_t siz)</div><div class="ttdef"><b>Definition:</b> <a href="porting_8c_source.html#l02585">porting.c:2585</a></div></div>
<div class="ttc" id="log__impl_8h_html_aaa150f6c2ae6a1748640ab281ffd94f7a66f7a15b57486fb9081e733c142d35ea"><div class="ttname"><a href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a66f7a15b57486fb9081e733c142d35ea">LOG_ABORT</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00582">log_impl.h:582</a></div></div>
<div class="ttc" id="classcubthread_1_1manager_html_a17ac861861c6329321c40be37a5dc436"><div class="ttname"><a href="classcubthread_1_1manager.html#a17ac861861c6329321c40be37a5dc436">cubthread::manager::destroy_daemon</a></div><div class="ttdeci">void destroy_daemon(daemon *&amp;daemon_arg)</div><div class="ttdef"><b>Definition:</b> <a href="thread__manager_8cpp_source.html#l00335">thread_manager.cpp:335</a></div></div>
<div class="ttc" id="log__impl_8h_html_aaa150f6c2ae6a1748640ab281ffd94f7a198b93b13d51133e5e5d4b8e7c62f54e"><div class="ttname"><a href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a198b93b13d51133e5e5d4b8e7c62f54e">LOG_SYSOP_START_POSTPONE</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00554">log_impl.h:554</a></div></div>
<div class="ttc" id="system__parameter_8h_html_a23aaf6bca406b9b428f43ad1b6b2b3e0afcaa557b00069f4903d605c4d0435e39"><div class="ttname"><a href="system__parameter_8h.html#a23aaf6bca406b9b428f43ad1b6b2b3e0afcaa557b00069f4903d605c4d0435e39">PRM_ID_LK_TIMEOUT_SECS</a></div><div class="ttdef"><b>Definition:</b> <a href="system__parameter_8h_source.html#l00120">system_parameter.h:120</a></div></div>
<div class="ttc" id="structlog__rec__redo_html"><div class="ttname"><a href="structlog__rec__redo.html">log_rec_redo</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00671">log_impl.h:671</a></div></div>
<div class="ttc" id="log__impl_8h_html_aaa150f6c2ae6a1748640ab281ffd94f7acf273d42fe8e9c360fb16c8c0f96c480"><div class="ttname"><a href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7acf273d42fe8e9c360fb16c8c0f96c480">LOG_POSTPONE</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00538">log_impl.h:538</a></div></div>
<div class="ttc" id="storage__common_8h_html_a8cf9ddda54aae97036680d35fcd95fd5"><div class="ttname"><a href="storage__common_8h.html#a8cf9ddda54aae97036680d35fcd95fd5">LOGPAGEID_MAX</a></div><div class="ttdeci">#define LOGPAGEID_MAX</div><div class="ttdef"><b>Definition:</b> <a href="storage__common_8h_source.html#l00059">storage_common.h:59</a></div></div>
<div class="ttc" id="log__impl_8h_html_a7377d8298f9fa6a5d11a79e4fb412729aef403ca21850fa90e6cdf48715ef9f94"><div class="ttname"><a href="log__impl_8h.html#a7377d8298f9fa6a5d11a79e4fb412729aef403ca21850fa90e6cdf48715ef9f94">LOG_RECOVERY_ANALYSIS_PHASE</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01816">log_impl.h:1816</a></div></div>
<div class="ttc" id="log__writer_8c_html_af1e1368d8e63a233e503b44c7cad4f4e"><div class="ttname"><a href="log__writer_8c.html#af1e1368d8e63a233e503b44c7cad4f4e">logwr_log_ha_filestat_to_string</a></div><div class="ttdeci">const char * logwr_log_ha_filestat_to_string(enum LOG_HA_FILESTAT val)</div><div class="ttdef"><b>Definition:</b> <a href="log__writer_8c_source.html#l01679">log_writer.c:1679</a></div></div>
<div class="ttc" id="log__compress_8c_html_a239701bd8e957bb4f8f9db1bfcf370a1"><div class="ttname"><a href="log__compress_8c.html#a239701bd8e957bb4f8f9db1bfcf370a1">log_unzip</a></div><div class="ttdeci">bool log_unzip(LOG_ZIP *log_unzip, LOG_ZIP_SIZE_T length, void *data)</div><div class="ttdef"><b>Definition:</b> <a href="log__compress_8c_source.html#l00103">log_compress.c:103</a></div></div>
<div class="ttc" id="log__manager_8c_html_a965680d1292c6bd89c0353d65b2074cb"><div class="ttname"><a href="log__manager_8c.html#a965680d1292c6bd89c0353d65b2074cb">log_add_to_modified_class_list</a></div><div class="ttdeci">int log_add_to_modified_class_list(THREAD_ENTRY *thread_p, const char *classname, const OID *class_oid)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l04800">log_manager.c:4800</a></div></div>
<div class="ttc" id="structlog__rec__replication_html_a8d945514d95904e726b652d4c7e034d8"><div class="ttname"><a href="structlog__rec__replication.html#a8d945514d95904e726b652d4c7e034d8">log_rec_replication::lsa</a></div><div class="ttdeci">LOG_LSA lsa</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00717">log_impl.h:717</a></div></div>
<div class="ttc" id="recovery_8h_html"><div class="ttname"><a href="recovery_8h.html">recovery.h</a></div></div>
<div class="ttc" id="recovery_8h_html_a526c4dc065c989256afca8b3b56d4d2badb0beae889294e6a1fce8fa119a8cfe3"><div class="ttname"><a href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2badb0beae889294e6a1fce8fa119a8cfe3">RVOVF_CHANGE_LINK</a></div><div class="ttdef"><b>Definition:</b> <a href="recovery_8h_source.html#l00103">recovery.h:103</a></div></div>
<div class="ttc" id="log__impl_8h_html_a40a91713414be68a8000f379f883ad06ae75408b47fb2d17f8a7337b033acd927"><div class="ttname"><a href="log__impl_8h.html#a40a91713414be68a8000f379f883ad06ae75408b47fb2d17f8a7337b033acd927">LOB_PERMANENT_CREATED</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00459">log_impl.h:459</a></div></div>
<div class="ttc" id="log__impl_8h_html_aaa150f6c2ae6a1748640ab281ffd94f7aa0d885a58816898b0877635fc7f15716"><div class="ttname"><a href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7aa0d885a58816898b0877635fc7f15716">LOG_UNDOREDO_DATA</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00534">log_impl.h:534</a></div></div>
<div class="ttc" id="structlog__tdes_html_a97c1d42917ab4d08ffe3194fc7233018"><div class="ttname"><a href="structlog__tdes.html#a97c1d42917ab4d08ffe3194fc7233018">log_tdes::topops</a></div><div class="ttdeci">LOG_TOPOPS_STACK topops</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01712">log_impl.h:1712</a></div></div>
<div class="ttc" id="log__impl_8h_html_ae1aad1a6b2c71bde2d1b93df8bc54e38a64cd568849ed79c339bd3b320dcacb25"><div class="ttname"><a href="log__impl_8h.html#ae1aad1a6b2c71bde2d1b93df8bc54e38a64cd568849ed79c339bd3b320dcacb25">LOG_PRIOR_LSA_WITHOUT_LOCK</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01093">log_impl.h:1093</a></div></div>
<div class="ttc" id="storage__common_8h_html_ac3f9d7ae37c5a4cb27570f7313891bc8"><div class="ttname"><a href="storage__common_8h.html#ac3f9d7ae37c5a4cb27570f7313891bc8">PGLENGTH</a></div><div class="ttdeci">INT16 PGLENGTH</div><div class="ttdef"><b>Definition:</b> <a href="storage__common_8h_source.html#l00096">storage_common.h:96</a></div></div>
<div class="ttc" id="file__io_8c_html_a6b98ae31a8457cd2e4775d6f00f1351c"><div class="ttname"><a href="file__io_8c.html#a6b98ae31a8457cd2e4775d6f00f1351c">fileio_get_number_of_volume_pages</a></div><div class="ttdeci">DKNPAGES fileio_get_number_of_volume_pages(int vol_fd, size_t page_size)</div><div class="ttdef"><b>Definition:</b> <a href="file__io_8c_source.html#l04869">file_io.c:4869</a></div></div>
<div class="ttc" id="structlog__rec__sysop__end_html_ab094b81b70e8d75dbb0d38f29cc18f62"><div class="ttname"><a href="structlog__rec__sysop__end.html#ab094b81b70e8d75dbb0d38f29cc18f62">log_rec_sysop_end::compensate_lsa</a></div><div class="ttdeci">LOG_LSA compensate_lsa</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01568">log_impl.h:1568</a></div></div>
<div class="ttc" id="log__impl_8h_html_ae1aad1a6b2c71bde2d1b93df8bc54e38a6c10b3c3be256976a47bf7f85174c7d3"><div class="ttname"><a href="log__impl_8h.html#ae1aad1a6b2c71bde2d1b93df8bc54e38a6c10b3c3be256976a47bf7f85174c7d3">LOG_PRIOR_LSA_WITH_LOCK</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01094">log_impl.h:1094</a></div></div>
<div class="ttc" id="system__parameter_8h_html_a23aaf6bca406b9b428f43ad1b6b2b3e0a6326431b1c002fc13abce2674d2bd21f"><div class="ttname"><a href="system__parameter_8h.html#a23aaf6bca406b9b428f43ad1b6b2b3e0a6326431b1c002fc13abce2674d2bd21f">PRM_ID_LOG_GROUP_COMMIT_INTERVAL_MSECS</a></div><div class="ttdef"><b>Definition:</b> <a href="system__parameter_8h_source.html#l00251">system_parameter.h:251</a></div></div>
<div class="ttc" id="structlog__tdes_html_a01ee2bddd37deb419f9418bf2f20678c"><div class="ttname"><a href="structlog__tdes.html#a01ee2bddd37deb419f9418bf2f20678c">log_tdes::first_save_entry</a></div><div class="ttdeci">void * first_save_entry</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01739">log_impl.h:1739</a></div></div>
<div class="ttc" id="log__manager_8c_html_a205cb9f31defd227b8340f7f4bd24a09"><div class="ttname"><a href="log__manager_8c.html#a205cb9f31defd227b8340f7f4bd24a09">log_complete</a></div><div class="ttdeci">TRAN_STATE log_complete(THREAD_ENTRY *thread_p, LOG_TDES *tdes, LOG_RECTYPE iscommitted, LOG_GETNEWTRID get_newtrid, LOG_WRITE_EOT_LOG wrote_eot_log)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l06015">log_manager.c:6015</a></div></div>
<div class="ttc" id="log__impl_8h_html_aa72336694761e5c0510f22416b65a0e2a20282e762d82417e44db85f0fb56bd2b"><div class="ttname"><a href="log__impl_8h.html#aa72336694761e5c0510f22416b65a0e2a20282e762d82417e44db85f0fb56bd2b">LOG_REPL_DONT_NEED_FLUSH</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01466">log_impl.h:1466</a></div></div>
<div class="ttc" id="structtrantable_html_a51008043f102cad94fc4832a72f1aa47"><div class="ttname"><a href="structtrantable.html#a51008043f102cad94fc4832a72f1aa47">trantable::area</a></div><div class="ttdeci">LOG_ADDR_TDESAREA * area</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01798">log_impl.h:1798</a></div></div>
<div class="ttc" id="log__impl_8h_html_a6a5f95ded1a2f38ed00c8e9c039a9f2e"><div class="ttname"><a href="log__impl_8h.html#a6a5f95ded1a2f38ed00c8e9c039a9f2e">LOG_CS_EXIT</a></div><div class="ttdeci">#define LOG_CS_EXIT(thread_p)</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00814">log_impl.h:814</a></div></div>
<div class="ttc" id="mem__block_8hpp_html"><div class="ttname"><a href="mem__block_8hpp.html">mem_block.hpp</a></div></div>
<div class="ttc" id="structlog__rec__chkpt_html_aa5f6f5deedab3ff3f702c2c81f8bbc54"><div class="ttname"><a href="structlog__rec__chkpt.html#aa5f6f5deedab3ff3f702c2c81f8bbc54">log_rec_chkpt::redo_lsa</a></div><div class="ttdeci">LOG_LSA redo_lsa</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01599">log_impl.h:1599</a></div></div>
<div class="ttc" id="structlog__global_html_af65edc6529edb3fbcebe3ab59ac209c1"><div class="ttname"><a href="structlog__global.html#af65edc6529edb3fbcebe3ab59ac209c1">log_global::bg_archive_info</a></div><div class="ttdeci">BACKGROUND_ARCHIVING_INFO bg_archive_info</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01970">log_impl.h:1970</a></div></div>
<div class="ttc" id="structlog__repl_html"><div class="ttname"><a href="structlog__repl.html">log_repl</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01503">log_impl.h:1503</a></div></div>
<div class="ttc" id="structlog__rec__run__postpone_html_a239cb60ac50b699715ef2dc143ba25e5"><div class="ttname"><a href="structlog__rec__run__postpone.html#a239cb60ac50b699715ef2dc143ba25e5">log_rec_run_postpone::data</a></div><div class="ttdeci">LOG_DATA data</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01590">log_impl.h:1590</a></div></div>
<div class="ttc" id="structlog__rec__savept_html"><div class="ttname"><a href="structlog__rec__savept.html">log_rec_savept</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01632">log_impl.h:1632</a></div></div>
<div class="ttc" id="structlog__rec__start__postpone_html_a4743d8c14a75a36ff44fa8e41e659283"><div class="ttname"><a href="structlog__rec__start__postpone.html#a4743d8c14a75a36ff44fa8e41e659283">log_rec_start_postpone::posp_lsa</a></div><div class="ttdeci">LOG_LSA posp_lsa</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01535">log_impl.h:1535</a></div></div>
<div class="ttc" id="storage__common_8h_html_a6a4baec606189dd320678e8f412ca957"><div class="ttname"><a href="storage__common_8h.html#a6a4baec606189dd320678e8f412ca957">LSA_SET_NULL</a></div><div class="ttdeci">STATIC_INLINE void LSA_SET_NULL(LOG_LSA *lsa_ptr)</div><div class="ttdef"><b>Definition:</b> <a href="storage__common_8h_source.html#l00120">storage_common.h:120</a></div></div>
<div class="ttc" id="db__date_8h_html"><div class="ttname"><a href="db__date_8h.html">db_date.h</a></div></div>
<div class="ttc" id="log__compress_8c_html_a87b9003990e598725fe9ed434ce007c9"><div class="ttname"><a href="log__compress_8c.html#a87b9003990e598725fe9ed434ce007c9">log_zip_free</a></div><div class="ttdeci">void log_zip_free(LOG_ZIP *log_zip)</div><div class="ttdef"><b>Definition:</b> <a href="log__compress_8c_source.html#l00249">log_compress.c:249</a></div></div>
<div class="ttc" id="structlog__rec__mvcc__undoredo_html"><div class="ttname"><a href="structlog__rec__mvcc__undoredo.html">log_rec_mvcc_undoredo</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00689">log_impl.h:689</a></div></div>
<div class="ttc" id="structlog__tdes_html_a21b2b5a56efdbf3078c64649dc6a548c"><div class="ttname"><a href="structlog__tdes.html#a21b2b5a56efdbf3078c64649dc6a548c">log_tdes::isloose_end</a></div><div class="ttdeci">bool isloose_end</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01694">log_impl.h:1694</a></div></div>
<div class="ttc" id="slotted__page_8h_html"><div class="ttname"><a href="slotted__page_8h.html">slotted_page.h</a></div></div>
<div class="ttc" id="structlog__header_html_acc35ee047773a1cca16705e989ba3456"><div class="ttname"><a href="structlog__header.html#acc35ee047773a1cca16705e989ba3456">log_header::avg_ntrans</a></div><div class="ttdeci">int avg_ntrans</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00206">log_impl.h:206</a></div></div>
<div class="ttc" id="structlog__crumb_html"><div class="ttname"><a href="structlog__crumb.html">log_crumb</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01806">log_impl.h:1806</a></div></div>
<div class="ttc" id="structlog__data_html_a8410b9d70cc70d2bc6fb6df88ea48bb4"><div class="ttname"><a href="structlog__data.html#a8410b9d70cc70d2bc6fb6df88ea48bb4">log_data::pageid</a></div><div class="ttdeci">PAGEID pageid</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00647">log_impl.h:647</a></div></div>
<div class="ttc" id="memory__alloc_8h_html_a794b5a73adc277837a0c4d12da4af5af"><div class="ttname"><a href="memory__alloc_8h.html#a794b5a73adc277837a0c4d12da4af5af">free_and_init</a></div><div class="ttdeci">#define free_and_init(ptr)</div><div class="ttdef"><b>Definition:</b> <a href="memory__alloc_8h_source.html#l00148">memory_alloc.h:148</a></div></div>
<div class="ttc" id="log__impl_8h_html_a8f08025b469332f89fee8ce83dc2d3ff"><div class="ttname"><a href="log__impl_8h.html#a8f08025b469332f89fee8ce83dc2d3ff">LOG_ISRESTARTED</a></div><div class="ttdeci">#define LOG_ISRESTARTED()</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01030">log_impl.h:1030</a></div></div>
<div class="ttc" id="structlog__tdes_html_aafccc5902319242f425656aaebdc615b"><div class="ttname"><a href="structlog__tdes.html#aafccc5902319242f425656aaebdc615b">log_tdes::repl_insert_lsa</a></div><div class="ttdeci">LOG_LSA repl_insert_lsa</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01737">log_impl.h:1737</a></div></div>
<div class="ttc" id="intl__support_8c_html_ab543901c3564a54b2450303d63374f55"><div class="ttname"><a href="intl__support_8c.html#ab543901c3564a54b2450303d63374f55">strlen</a></div><div class="ttdeci">#define strlen(s1)</div><div class="ttdef"><b>Definition:</b> <a href="intl__support_8c_source.html#l00045">intl_support.c:45</a></div></div>
<div class="ttc" id="system__parameter_8h_html_a23aaf6bca406b9b428f43ad1b6b2b3e0ad0b59ddf899047a33b1874b59ca09354"><div class="ttname"><a href="system__parameter_8h.html#a23aaf6bca406b9b428f43ad1b6b2b3e0ad0b59ddf899047a33b1874b59ca09354">PRM_ID_FORCE_RESTART_TO_SKIP_RECOVERY</a></div><div class="ttdef"><b>Definition:</b> <a href="system__parameter_8h_source.html#l00388">system_parameter.h:388</a></div></div>
<div class="ttc" id="vacuum_8h_html_af90b05fa6c5fb7fbc6797de411b6d466"><div class="ttname"><a href="vacuum_8h.html#af90b05fa6c5fb7fbc6797de411b6d466">vacuum_worker_state_is_execute</a></div><div class="ttdeci">STATIC_INLINE bool vacuum_worker_state_is_execute(THREAD_ENTRY *thread_p) __attribute__((ALWAYS_INLINE))</div><div class="ttdef"><b>Definition:</b> <a href="vacuum_8h_source.html#l00250">vacuum.h:250</a></div></div>
<div class="ttc" id="utils_8h_html_a8de3ed741dadc9c979a4ff17c0a9116e"><div class="ttname"><a href="utils_8h.html#a8de3ed741dadc9c979a4ff17c0a9116e">NDEBUG</a></div><div class="ttdeci">#define NDEBUG</div><div class="ttdef"><b>Definition:</b> <a href="utils_8h_source.html#l00014">utils.h:14</a></div></div>
<div class="ttc" id="recovery_8h_html_a526c4dc065c989256afca8b3b56d4d2ba0b40e1edf3b9938d9177487ef402c97a"><div class="ttname"><a href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2ba0b40e1edf3b9938d9177487ef402c97a">RVHF_INSERT_NEWHOME</a></div><div class="ttdef"><b>Definition:</b> <a href="recovery_8h_source.html#l00095">recovery.h:95</a></div></div>
<div class="ttc" id="environment__variable_8h_html"><div class="ttname"><a href="environment__variable_8h.html">environment_variable.h</a></div></div>
<div class="ttc" id="porting_8h_html_aa1dec568e79152c892dcf63f445cbd7a"><div class="ttname"><a href="porting_8h.html#aa1dec568e79152c892dcf63f445cbd7a">ALWAYS_INLINE</a></div><div class="ttdeci">#define ALWAYS_INLINE</div><div class="ttdef"><b>Definition:</b> <a href="porting_8h_source.html#l00043">porting.h:43</a></div></div>
<div class="ttc" id="log__impl_8h_html_af65c435e9509efe8e005c094e49a0b2fa64ac1d15aa4fce7a8d40eeb22a4b95cd"><div class="ttname"><a href="log__impl_8h.html#af65c435e9509efe8e005c094e49a0b2fa64ac1d15aa4fce7a8d40eeb22a4b95cd">LOG_NEED_TO_WRITE_EOT_LOG</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01088">log_impl.h:1088</a></div></div>
<div class="ttc" id="structlog__tdes_html_a3baeff284ed2167bcef74c5ef34d4f3b"><div class="ttname"><a href="structlog__tdes.html#a3baeff284ed2167bcef74c5ef34d4f3b">log_tdes::trid</a></div><div class="ttdeci">TRANID trid</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01692">log_impl.h:1692</a></div></div>
<div class="ttc" id="log__impl_8h_html_aa91abaf89af63e703737ac5c00d7cd7d"><div class="ttname"><a href="log__impl_8h.html#aa91abaf89af63e703737ac5c00d7cd7d">logpb_flush_pages</a></div><div class="ttdeci">void logpb_flush_pages(THREAD_ENTRY *thread_p, LOG_LSA *flush_lsa)</div><div class="ttdef"><b>Definition:</b> <a href="log__page__buffer_8c_source.html#l05041">log_page_buffer.c:5041</a></div></div>
<div class="ttc" id="file__io_8h_html_a1e52f91b8452ad233fce9196397ed45da17696d88ad6e4dbd2139a09c945fc07d"><div class="ttname"><a href="file__io_8h.html#a1e52f91b8452ad233fce9196397ed45da17696d88ad6e4dbd2139a09c945fc07d">FILEIO_BACKUP_SMALL_INCREMENT_LEVEL</a></div><div class="ttdef"><b>Definition:</b> <a href="file__io_8h_source.html#l00092">file_io.h:92</a></div></div>
<div class="ttc" id="log__impl_8h_html_a390f2d36dcfc756ef528e21b94f7525c"><div class="ttname"><a href="log__impl_8h.html#a390f2d36dcfc756ef528e21b94f7525c">logpb_copy_from_log</a></div><div class="ttdeci">void logpb_copy_from_log(THREAD_ENTRY *thread_p, char *area, int length, LOG_LSA *log_lsa, LOG_PAGE *log_pgptr)</div><div class="ttdef"><b>Definition:</b> <a href="log__page__buffer_8c_source.html#l07635">log_page_buffer.c:7635</a></div></div>
<div class="ttc" id="storage__common_8h_html_a4b07671fd9c9a16c3c37363d09050ac5"><div class="ttname"><a href="storage__common_8h.html#a4b07671fd9c9a16c3c37363d09050ac5">DB_PAGESIZE</a></div><div class="ttdeci">#define DB_PAGESIZE</div><div class="ttdef"><b>Definition:</b> <a href="storage__common_8h_source.html#l00165">storage_common.h:165</a></div></div>
<div class="ttc" id="namespacecubthread_html_a55c08a869cb69385e8c7351668caeffa"><div class="ttname"><a href="namespacecubthread.html#a55c08a869cb69385e8c7351668caeffa">cubthread::period_function</a></div><div class="ttdeci">std::function&lt; void(bool &amp;, delta_time &amp;)&gt; period_function</div><div class="ttdef"><b>Definition:</b> <a href="thread__looper_8hpp_source.html#l00042">thread_looper.hpp:42</a></div></div>
<div class="ttc" id="disk__manager_8h_html_a061f0551f90af344b54bc6d875cbea17aaf8a1d85c58b4a9f27a82eb8e2c280ec"><div class="ttname"><a href="disk__manager_8h.html#a061f0551f90af344b54bc6d875cbea17aaf8a1d85c58b4a9f27a82eb8e2c280ec">DISK_DONT_FLUSH</a></div><div class="ttdef"><b>Definition:</b> <a href="disk__manager_8h_source.html#l00048">disk_manager.h:48</a></div></div>
<div class="ttc" id="structlog__tdes_html_a916fdc86e53965a678853a935599ad1d"><div class="ttname"><a href="structlog__tdes.html#a916fdc86e53965a678853a935599ad1d">log_tdes::rcv</a></div><div class="ttdeci">LOG_RCV_TDES rcv</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01767">log_impl.h:1767</a></div></div>
<div class="ttc" id="structlog__header_html_a7d775819dc76af47b2615f39dc1c9019"><div class="ttname"><a href="structlog__header.html#a7d775819dc76af47b2615f39dc1c9019">log_header::is_shutdown</a></div><div class="ttdeci">bool is_shutdown</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00202">log_impl.h:202</a></div></div>
<div class="ttc" id="log__impl_8h_html_a860ddfff66bc38ab51576892904b975c"><div class="ttname"><a href="log__impl_8h.html#a860ddfff66bc38ab51576892904b975c">LOB_LOCATOR_STATE</a></div><div class="ttdeci">enum lob_locator_state LOB_LOCATOR_STATE</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00463">log_impl.h:463</a></div></div>
<div class="ttc" id="structlog__rcv_html"><div class="ttname"><a href="structlog__rcv.html">log_rcv</a></div><div class="ttdef"><b>Definition:</b> <a href="recovery_8h_source.html#l00189">recovery.h:189</a></div></div>
<div class="ttc" id="log__impl_8h_html_ae4025cb5dfaa1070ed2fafc0ec63943e"><div class="ttname"><a href="log__impl_8h.html#ae4025cb5dfaa1070ed2fafc0ec63943e">logpb_is_pool_initialized</a></div><div class="ttdeci">bool logpb_is_pool_initialized(void)</div><div class="ttdef"><b>Definition:</b> <a href="log__page__buffer_8c_source.html#l00842">log_page_buffer.c:842</a></div></div>
<div class="ttc" id="log__manager_8c_html_a1315d00aaa26d2a280a675338f59c9ac"><div class="ttname"><a href="log__manager_8c.html#a1315d00aaa26d2a280a675338f59c9ac">log_append_empty_record</a></div><div class="ttdeci">void log_append_empty_record(THREAD_ENTRY *thread_p, LOG_RECTYPE logrec_type, LOG_DATA_ADDR *addr)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l03127">log_manager.c:3127</a></div></div>
<div class="ttc" id="critical__section_8h_html_aff3701dfcc246bf08b07f25a2cfd9e6dae9360d7901909430e42369cfccc3f917"><div class="ttname"><a href="critical__section_8h.html#aff3701dfcc246bf08b07f25a2cfd9e6dae9360d7901909430e42369cfccc3f917">CSECT_HA_SERVER_STATE</a></div><div class="ttdef"><b>Definition:</b> <a href="critical__section_8h_source.html#l00071">critical_section.h:71</a></div></div>
<div class="ttc" id="recovery_8h_html_a526c4dc065c989256afca8b3b56d4d2ba6ea83d694355ec2c529960461a086f26"><div class="ttname"><a href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2ba6ea83d694355ec2c529960461a086f26">RV_NOT_DEFINED</a></div><div class="ttdef"><b>Definition:</b> <a href="recovery_8h_source.html#l00182">recovery.h:182</a></div></div>
<div class="ttc" id="log__manager_8c_html_a3d4edebd76e57a967b3cf677e1599c6c"><div class="ttname"><a href="log__manager_8c.html#a3d4edebd76e57a967b3cf677e1599c6c">RB_PROTOTYPE_STATIC</a></div><div class="ttdeci">RB_PROTOTYPE_STATIC(lob_rb_root, lob_locator_entry, head, lob_locator_cmp)</div></div>
<div class="ttc" id="structlog__rec__2pc__particp__ack_html"><div class="ttname"><a href="structlog__rec__2pc__particp__ack.html">log_rec_2pc_particp_ack</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01665">log_impl.h:1665</a></div></div>
<div class="ttc" id="structlog__rec__2pc__prepcommit_html"><div class="ttname"><a href="structlog__rec__2pc__prepcommit.html">log_rec_2pc_prepcommit</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01640">log_impl.h:1640</a></div></div>
<div class="ttc" id="log__manager_8c_html_a5ba507076ad3cea01e22155b6da9b119"><div class="ttname"><a href="log__manager_8c.html#a5ba507076ad3cea01e22155b6da9b119">log_rv_dump_char</a></div><div class="ttdeci">void log_rv_dump_char(FILE *fp, int length, void *data)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l09378">log_manager.c:9378</a></div></div>
<div class="ttc" id="log__impl_8h_html_aa2a6e20070602d985015f39d448f8125"><div class="ttname"><a href="log__impl_8h.html#aa2a6e20070602d985015f39d448f8125">logpb_is_page_in_archive</a></div><div class="ttdeci">bool logpb_is_page_in_archive(LOG_PAGEID pageid)</div><div class="ttdef"><b>Definition:</b> <a href="log__page__buffer_8c_source.html#l06221">log_page_buffer.c:6221</a></div></div>
<div class="ttc" id="structlog__header_html_abfff061333884447d8cf359d48184620"><div class="ttname"><a href="structlog__header.html#abfff061333884447d8cf359d48184620">log_header::smallest_lsa_at_last_chkpt</a></div><div class="ttdeci">LOG_LSA smallest_lsa_at_last_chkpt</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00238">log_impl.h:238</a></div></div>
<div class="ttc" id="system__parameter_8c_html_a678756564699cbc93bd758cf6f99a042"><div class="ttname"><a href="system__parameter_8c.html#a678756564699cbc93bd758cf6f99a042">prm_get_bool_value</a></div><div class="ttdeci">bool prm_get_bool_value(PARAM_ID prm_id)</div><div class="ttdef"><b>Definition:</b> <a href="system__parameter_8c_source.html#l10460">system_parameter.c:10460</a></div></div>
<div class="ttc" id="log__impl_8h_html_a73baa6645b24b8b7c11e7ec7f4f53e8ca47291680922a0611854ee67af1ba9938"><div class="ttname"><a href="log__impl_8h.html#a73baa6645b24b8b7c11e7ec7f4f53e8ca47291680922a0611854ee67af1ba9938">LOG_2PC_EXECUTE_COMMIT_DECISION</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01244">log_impl.h:1244</a></div></div>
<div class="ttc" id="structlog__header_html_a9e2e5afd8f320c1cdf841a58939cf9b2"><div class="ttname"><a href="structlog__header.html#a9e2e5afd8f320c1cdf841a58939cf9b2">log_header::magic</a></div><div class="ttdeci">char magic[CUBRID_MAGIC_MAX_LENGTH]</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00191">log_impl.h:191</a></div></div>
<div class="ttc" id="log__impl_8h_html_a40a91713414be68a8000f379f883ad06aa0fe8afc3a13afb48be4dcd5d704655a"><div class="ttname"><a href="log__impl_8h.html#a40a91713414be68a8000f379f883ad06aa0fe8afc3a13afb48be4dcd5d704655a">LOB_NOT_FOUND</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00461">log_impl.h:461</a></div></div>
<div class="ttc" id="log__comm_8h_html_a3c0be9b9f104459ab90ee18af95c4b3ea04e4c5688a6020948963e1e0fffe9c15"><div class="ttname"><a href="log__comm_8h.html#a3c0be9b9f104459ab90ee18af95c4b3ea04e4c5688a6020948963e1e0fffe9c15">TRAN_UNACTIVE_TOPOPE_COMMITTED_WITH_POSTPONE</a></div><div class="ttdef"><b>Definition:</b> <a href="log__comm_8h_source.html#l00048">log_comm.h:48</a></div></div>
<div class="ttc" id="external_2include_2queue_8h_html_a465e28dbd1a1c60ff504d3ea275613ed"><div class="ttname"><a href="external_2include_2queue_8h.html#a465e28dbd1a1c60ff504d3ea275613ed">node</a></div><div class="ttdeci">struct nodeptr node</div></div>
<div class="ttc" id="log__compress_8h_html_acc57c2f6ae6f861d965ca95a4085cdf1"><div class="ttname"><a href="log__compress_8h.html#acc57c2f6ae6f861d965ca95a4085cdf1">ZIP_CHECK</a></div><div class="ttdeci">#define ZIP_CHECK(length)</div><div class="ttdef"><b>Definition:</b> <a href="log__compress_8h_source.html#l00041">log_compress.h:41</a></div></div>
<div class="ttc" id="server__support_8c_html_a71d9ec1aba80346f187f67b53b9af03b"><div class="ttname"><a href="server__support_8c.html#a71d9ec1aba80346f187f67b53b9af03b">css_is_ha_repl_delayed</a></div><div class="ttdeci">bool css_is_ha_repl_delayed(void)</div><div class="ttdef"><b>Definition:</b> <a href="server__support_8c_source.html#l02047">server_support.c:2047</a></div></div>
<div class="ttc" id="error__code_8h_html_ac0f36d84bb9db8341537c11fbe97ffeb"><div class="ttname"><a href="error__code_8h.html#ac0f36d84bb9db8341537c11fbe97ffeb">ER_LOG_INCOMPATIBLE_DATABASE</a></div><div class="ttdeci">#define ER_LOG_INCOMPATIBLE_DATABASE</div><div class="ttdef"><b>Definition:</b> <a href="error__code_8h_source.html#l00141">error_code.h:141</a></div></div>
<div class="ttc" id="src_2base_2rb__tree_8h_html_a0d85aa035345c2d3f890bf6bc602c068"><div class="ttname"><a href="src_2base_2rb__tree_8h.html#a0d85aa035345c2d3f890bf6bc602c068">RB_EMPTY</a></div><div class="ttdeci">#define RB_EMPTY(head)</div><div class="ttdef"><b>Definition:</b> <a href="src_2base_2rb__tree_8h_source.html#l00063">rb_tree.h:63</a></div></div>
<div class="ttc" id="client__support_8c_html_a420baac2165c470d8a726a01a1329191"><div class="ttname"><a href="client__support_8c.html#a420baac2165c470d8a726a01a1329191">css_ha_server_state</a></div><div class="ttdeci">HA_SERVER_STATE css_ha_server_state(void)</div><div class="ttdef"><b>Definition:</b> <a href="client__support_8c_source.html#l00692">client_support.c:692</a></div></div>
<div class="ttc" id="log__impl_8h_html_aaa150f6c2ae6a1748640ab281ffd94f7a40516d04f27c98062921adb5282b4933"><div class="ttname"><a href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a40516d04f27c98062921adb5282b4933">LOG_WILL_COMMIT</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00548">log_impl.h:548</a></div></div>
<div class="ttc" id="mprec_8c_html_a115f98821af8b9ac2f97f2ac2cb2797f"><div class="ttname"><a href="mprec_8c.html#a115f98821af8b9ac2f97f2ac2cb2797f">rv</a></div><div class="ttdeci">_Bigint *_Bigint * rv</div><div class="ttdef"><b>Definition:</b> <a href="mprec_8c_source.html#l00113">mprec.c:113</a></div></div>
<div class="ttc" id="error__code_8h_html_a0ecbcb61ebdccc9cfdb2e8284ef5a3d3"><div class="ttname"><a href="error__code_8h.html#a0ecbcb61ebdccc9cfdb2e8284ef5a3d3">ER_LOG_NOTACTIVE_TOPOPS</a></div><div class="ttdeci">#define ER_LOG_NOTACTIVE_TOPOPS</div><div class="ttdef"><b>Definition:</b> <a href="error__code_8h_source.html#l00771">error_code.h:771</a></div></div>
<div class="ttc" id="structlog__info__chkpt__sysop_html_ae79cc5b9e69174cee57f076c829424fc"><div class="ttname"><a href="structlog__info__chkpt__sysop.html#ae79cc5b9e69174cee57f076c829424fc">log_info_chkpt_sysop::sysop_start_postpone_lsa</a></div><div class="ttdeci">LOG_LSA sysop_start_postpone_lsa</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01627">log_impl.h:1627</a></div></div>
<div class="ttc" id="structlog__rec__2pc__start_html_a8ca8c9f4109c567382d51e681606ab24"><div class="ttname"><a href="structlog__rec__2pc__start.html#a8ca8c9f4109c567382d51e681606ab24">log_rec_2pc_start::particp_id_length</a></div><div class="ttdeci">int particp_id_length</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01657">log_impl.h:1657</a></div></div>
<div class="ttc" id="log__impl_8h_html_a24797b2fe67e0ec8631d7a92fbef25c9a571011a0354832edf02d40490f512716"><div class="ttname"><a href="log__impl_8h.html#a24797b2fe67e0ec8631d7a92fbef25c9a571011a0354832edf02d40490f512716">LOG_SYSOP_END_LOGICAL_MVCC_UNDO</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01544">log_impl.h:1544</a></div></div>
<div class="ttc" id="log__impl_8h_html_aaa150f6c2ae6a1748640ab281ffd94f7a869d94e68bfc3354ad6bd211130cf13b"><div class="ttname"><a href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a869d94e68bfc3354ad6bd211130cf13b">LOG_2PC_ABORT_DECISION</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00594">log_impl.h:594</a></div></div>
<div class="ttc" id="log__impl_8h_html_aaa150f6c2ae6a1748640ab281ffd94f7a97003f753507d5a7a65a0bf078a078f4"><div class="ttname"><a href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a97003f753507d5a7a65a0bf078a078f4">LOG_REPLICATION_DATA</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00607">log_impl.h:607</a></div></div>
<div class="ttc" id="log__manager_8c_html_a5e97a30aa978dafbca4f7180c5d3909f"><div class="ttname"><a href="log__manager_8c.html#a5e97a30aa978dafbca4f7180c5d3909f">log_sysop_attach_to_outer</a></div><div class="ttdeci">void log_sysop_attach_to_outer(THREAD_ENTRY *thread_p)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l04156">log_manager.c:4156</a></div></div>
<div class="ttc" id="log__manager_8c_html_afd9452b54b685a02fedb03d949b279cb"><div class="ttname"><a href="log__manager_8c.html#afd9452b54b685a02fedb03d949b279cb">log_recreate</a></div><div class="ttdeci">int log_recreate(THREAD_ENTRY *thread_p, const char *db_fullname, const char *logpath, const char *prefix_logname, DKNPAGES log_npages, FILE *out_fp)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l09108">log_manager.c:9108</a></div></div>
<div class="ttc" id="structlog__zip_html"><div class="ttname"><a href="structlog__zip.html">log_zip</a></div><div class="ttdef"><b>Definition:</b> <a href="log__compress_8h_source.html#l00055">log_compress.h:55</a></div></div>
<div class="ttc" id="log__manager_8c_html_a6d8db65dcea53cc4da3b654ccc116993"><div class="ttname"><a href="log__manager_8c.html#a6d8db65dcea53cc4da3b654ccc116993">log_archive_log_header_end_scan</a></div><div class="ttdeci">int log_archive_log_header_end_scan(THREAD_ENTRY *thread_p, void **ptr)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l09976">log_manager.c:9976</a></div></div>
<div class="ttc" id="log__impl_8h_html_a2a627b149f4e82c3afe669897cf2b5a5"><div class="ttname"><a href="log__impl_8h.html#a2a627b149f4e82c3afe669897cf2b5a5">logpb_dump_checkpoint_trans</a></div><div class="ttdeci">void logpb_dump_checkpoint_trans(FILE *out_fp, int length, void *data)</div><div class="ttdef"><b>Definition:</b> <a href="log__page__buffer_8c_source.html#l08422">log_page_buffer.c:8422</a></div></div>
<div class="ttc" id="log__manager_8c_html_a328d8671b52e43b27fdaa575415c61ed"><div class="ttname"><a href="log__manager_8c.html#a328d8671b52e43b27fdaa575415c61ed">log_sysop_commit</a></div><div class="ttdeci">void log_sysop_commit(THREAD_ENTRY *thread_p)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l03979">log_manager.c:3979</a></div></div>
<div class="ttc" id="es_8h_html_abc5f1830c52f82388529df13a21535aa"><div class="ttname"><a href="es_8h.html#abc5f1830c52f82388529df13a21535aa">ES_URI</a></div><div class="ttdeci">char ES_URI[ES_MAX_URI_LEN]</div><div class="ttdef"><b>Definition:</b> <a href="es_8h_source.html#l00036">es.h:36</a></div></div>
<div class="ttc" id="log__impl_8h_html_a25de713746a915b7dc019384ef68a8f0"><div class="ttname"><a href="log__impl_8h.html#a25de713746a915b7dc019384ef68a8f0">log_recovery</a></div><div class="ttdeci">void log_recovery(THREAD_ENTRY *thread_p, int ismedia_crash, time_t *stopat)</div><div class="ttdef"><b>Definition:</b> <a href="log__recovery_8c_source.html#l00653">log_recovery.c:653</a></div></div>
<div class="ttc" id="log__manager_8c_html_a16ef3597e53279503520c6a8167ff821"><div class="ttname"><a href="log__manager_8c.html#a16ef3597e53279503520c6a8167ff821">log_abort_local</a></div><div class="ttdeci">TRAN_STATE log_abort_local(THREAD_ENTRY *thread_p, LOG_TDES *tdes, bool is_local_tran)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l05621">log_manager.c:5621</a></div></div>
<div class="ttc" id="file__io_8c_html_a118ecc6747be6cc833228db57b67941d"><div class="ttname"><a href="file__io_8c.html#a118ecc6747be6cc833228db57b67941d">fileio_format</a></div><div class="ttdeci">int fileio_format(THREAD_ENTRY *thread_p, const char *db_full_name_p, const char *vol_label_p, VOLID vol_id, DKNPAGES npages, bool is_sweep_clean, bool is_do_lock, bool is_do_sync, size_t page_size, int kbytes_to_be_written_per_sec, bool reuse_file)</div><div class="ttdef"><b>Definition:</b> <a href="file__io_8c_source.html#l02294">file_io.c:2294</a></div></div>
<div class="ttc" id="log__manager_8c_html_aa91b7ec8ae8a2d699fb09cc20c444fe8"><div class="ttname"><a href="log__manager_8c.html#aa91b7ec8ae8a2d699fb09cc20c444fe8">pthread_mutex_unlock</a></div><div class="ttdeci">#define pthread_mutex_unlock(a)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l00086">log_manager.c:86</a></div></div>
<div class="ttc" id="dbtype_8h_html_a51b4eadd6fcd8ba79a6393c24fe18720"><div class="ttname"><a href="dbtype_8h.html#a51b4eadd6fcd8ba79a6393c24fe18720">DB_VALUE_TYPE</a></div><div class="ttdeci">#define DB_VALUE_TYPE(value)</div><div class="ttdef"><b>Definition:</b> <a href="dbtype_8h_source.html#l00070">dbtype.h:70</a></div></div>
<div class="ttc" id="log__manager_8c_html_ad39dc10a11df5427f5af4c203e9d98a6"><div class="ttname"><a href="log__manager_8c.html#ad39dc10a11df5427f5af4c203e9d98a6">log_append_redo_crumbs</a></div><div class="ttdeci">void log_append_redo_crumbs(THREAD_ENTRY *thread_p, LOG_RCVINDEX rcvindex, LOG_DATA_ADDR *addr, int num_crumbs, const LOG_CRUMB *crumbs)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l02328">log_manager.c:2328</a></div></div>
<div class="ttc" id="dynamic__load_8c_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="dynamic__load_8c_source.html#l00955">dynamic_load.c:955</a></div></div>
<div class="ttc" id="structlog__data__addr_html_ab8ee0b45ab1d94bffa3626936b282d5f"><div class="ttname"><a href="structlog__data__addr.html#ab8ee0b45ab1d94bffa3626936b282d5f">log_data_addr::offset</a></div><div class="ttdeci">PGLENGTH offset</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01841">log_impl.h:1841</a></div></div>
<div class="ttc" id="log__manager_8c_html_afccabc79e094d4f573bb480f3b3e24ca"><div class="ttname"><a href="log__manager_8c.html#afccabc79e094d4f573bb480f3b3e24ca">log_active_log_header_start_scan</a></div><div class="ttdeci">int log_active_log_header_start_scan(THREAD_ENTRY *thread_p, int show_type, DB_VALUE **arg_values, int arg_cnt, void **ptr)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l09476">log_manager.c:9476</a></div></div>
<div class="ttc" id="structlog__repl_html_a5e4f8edc08618b5369397f68a1edb949"><div class="ttname"><a href="structlog__repl.html#a5e4f8edc08618b5369397f68a1edb949">log_repl::rcvindex</a></div><div class="ttdeci">LOG_RCVINDEX rcvindex</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01506">log_impl.h:1506</a></div></div>
<div class="ttc" id="dbtype__function_8h_html_ae570f2fc3aeb00331acc11277913b03f"><div class="ttname"><a href="dbtype__function_8h.html#ae570f2fc3aeb00331acc11277913b03f">db_make_null</a></div><div class="ttdeci">int db_make_null(DB_VALUE *value)</div></div>
<div class="ttc" id="message__catalog_8c_html_af9597674b8d4504be6fd55145b5af6f0"><div class="ttname"><a href="message__catalog_8c.html#af9597674b8d4504be6fd55145b5af6f0">msgcat_message</a></div><div class="ttdeci">char * msgcat_message(int cat_id, int set_id, int msg_id)</div><div class="ttdef"><b>Definition:</b> <a href="message__catalog_8c_source.html#l00559">message_catalog.c:559</a></div></div>
<div class="ttc" id="structlog__header_html"><div class="ttname"><a href="structlog__header.html">log_header</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00189">log_impl.h:189</a></div></div>
<div class="ttc" id="log__impl_8h_html_ab0c98093893d496bd3c00c6825c3941bacf3113fe0ba179d76a1bbae698248c79"><div class="ttname"><a href="log__impl_8h.html#ab0c98093893d496bd3c00c6825c3941bacf3113fe0ba179d76a1bbae698248c79">LOG_NEED_NEWTRID</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01084">log_impl.h:1084</a></div></div>
<div class="ttc" id="error__code_8h_html_ae60295c7460c5059ecfcf7af1ef29615"><div class="ttname"><a href="error__code_8h.html#ae60295c7460c5059ecfcf7af1ef29615">ER_LOG_DOESNT_CORRESPOND_TO_DATABASE</a></div><div class="ttdeci">#define ER_LOG_DOESNT_CORRESPOND_TO_DATABASE</div><div class="ttdef"><b>Definition:</b> <a href="error__code_8h_source.html#l00144">error_code.h:144</a></div></div>
<div class="ttc" id="structactve__log__header__scan__context_html_ad72cbc85c66879e4a3fc3f2a310f197b"><div class="ttname"><a href="structactve__log__header__scan__context.html#ad72cbc85c66879e4a3fc3f2a310f197b">actve_log_header_scan_context::header</a></div><div class="ttdeci">LOG_HEADER header</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l00182">log_manager.c:182</a></div></div>
<div class="ttc" id="structlog__header_html_a7522e43b86a7c2f068609153f678edeb"><div class="ttname"><a href="structlog__header.html#a7522e43b86a7c2f068609153f678edeb">log_header::last_block_newest_mvccid</a></div><div class="ttdeci">MVCCID last_block_newest_mvccid</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00242">log_impl.h:242</a></div></div>
<div class="ttc" id="log__impl_8h_html_a2e4a0eee53c67888cd1625c9884ff350"><div class="ttname"><a href="log__impl_8h.html#a2e4a0eee53c67888cd1625c9884ff350">logpb_fetch_header</a></div><div class="ttdeci">void logpb_fetch_header(THREAD_ENTRY *thread_p, LOG_HEADER *hdr)</div><div class="ttdef"><b>Definition:</b> <a href="log__page__buffer_8c_source.html#l01563">log_page_buffer.c:1563</a></div></div>
<div class="ttc" id="structlog__rec__header_html"><div class="ttname"><a href="structlog__rec__header.html">log_rec_header</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00633">log_impl.h:633</a></div></div>
<div class="ttc" id="dbtype__def_8h_html_a6735f6de14369bd1210b3491e220091da56d7dddc4e60210094b94a704ff8fd18"><div class="ttname"><a href="dbtype__def_8h.html#a6735f6de14369bd1210b3491e220091da56d7dddc4e60210094b94a704ff8fd18">DB_TYPE_NULL</a></div><div class="ttdef"><b>Definition:</b> <a href="dbtype__def_8h_source.html#l00699">dbtype_def.h:699</a></div></div>
<div class="ttc" id="storage__common_8h_html_a392873d6ffa4a8a6b2eb5f4b4fbbc97c"><div class="ttname"><a href="storage__common_8h.html#a392873d6ffa4a8a6b2eb5f4b4fbbc97c">LSA_AS_ARGS</a></div><div class="ttdeci">#define LSA_AS_ARGS(lsa_ptr)</div><div class="ttdef"><b>Definition:</b> <a href="storage__common_8h_source.html#l00135">storage_common.h:135</a></div></div>
<div class="ttc" id="log__manager_8c_html_a656b541276983a5b1306515c1c568ec7"><div class="ttname"><a href="log__manager_8c.html#a656b541276983a5b1306515c1c568ec7">log_get_crash_point_lsa</a></div><div class="ttdeci">LOG_LSA * log_get_crash_point_lsa(void)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l00582">log_manager.c:582</a></div></div>
<div class="ttc" id="log__manager_8c_html_a43c3e6965dc07096503c8de506a1069f"><div class="ttname"><a href="log__manager_8c.html#a43c3e6965dc07096503c8de506a1069f">log_abort_all_active_transaction</a></div><div class="ttdeci">void log_abort_all_active_transaction(THREAD_ENTRY *thread_p)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l01597">log_manager.c:1597</a></div></div>
<div class="ttc" id="log__manager_8c_html_a473bb054a7d22bdf84f89cac923ea9ac"><div class="ttname"><a href="log__manager_8c.html#a473bb054a7d22bdf84f89cac923ea9ac">log_is_in_crash_recovery_and_not_yet_completes_redo</a></div><div class="ttdeci">bool log_is_in_crash_recovery_and_not_yet_completes_redo(void)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l00540">log_manager.c:540</a></div></div>
<div class="ttc" id="log__manager_8c_html_aacd8f24932e99d45e955369e91d5d89b"><div class="ttname"><a href="log__manager_8c.html#aacd8f24932e99d45e955369e91d5d89b">log_get_log_group_commit_interval</a></div><div class="ttdeci">void log_get_log_group_commit_interval(bool &amp;is_timed_wait, cubthread::delta_time &amp;period)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l10293">log_manager.c:10293</a></div></div>
<div class="ttc" id="log__impl_8h_html_aa72336694761e5c0510f22416b65a0e2a4b8883515586d53ebdb4fb072300076f"><div class="ttname"><a href="log__impl_8h.html#aa72336694761e5c0510f22416b65a0e2a4b8883515586d53ebdb4fb072300076f">LOG_REPL_NEED_FLUSH</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01468">log_impl.h:1468</a></div></div>
<div class="ttc" id="structarchive__log__header__scan__context_html_a0637f5ec1505138e18d9ebb259352961"><div class="ttname"><a href="structarchive__log__header__scan__context.html#a0637f5ec1505138e18d9ebb259352961">archive_log_header_scan_context::header</a></div><div class="ttdeci">LOG_ARV_HEADER header</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l00189">log_manager.c:189</a></div></div>
<div class="ttc" id="log__impl_8h_html_a7377d8298f9fa6a5d11a79e4fb412729a786efe8f7626ad4859a7b0fd1880c18a"><div class="ttname"><a href="log__impl_8h.html#a7377d8298f9fa6a5d11a79e4fb412729a786efe8f7626ad4859a7b0fd1880c18a">LOG_RECOVERY_REDO_PHASE</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01817">log_impl.h:1817</a></div></div>
<div class="ttc" id="structlog__header_html_a87b66e6b3d5872e8e0967a42abf04ea6"><div class="ttname"><a href="structlog__header.html#a87b66e6b3d5872e8e0967a42abf04ea6">log_header::eof_lsa</a></div><div class="ttdeci">LOG_LSA eof_lsa</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00236">log_impl.h:236</a></div></div>
<div class="ttc" id="structlog__header_html_aad70018d473d2cff6e2acd0a5aec5b6a"><div class="ttname"><a href="structlog__header.html#aad70018d473d2cff6e2acd0a5aec5b6a">log_header::db_charset</a></div><div class="ttdeci">INT8 db_charset</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00209">log_impl.h:209</a></div></div>
<div class="ttc" id="perf__monitor_8h_html_aa0bde53ad8999e70db0c576af32db708"><div class="ttname"><a href="perf__monitor_8h.html#aa0bde53ad8999e70db0c576af32db708">perfmon_set_stat</a></div><div class="ttdeci">STATIC_INLINE void perfmon_set_stat(THREAD_ENTRY *thread_p, PERF_STAT_ID psid, int statval, bool check_watchers) __attribute__((ALWAYS_INLINE))</div></div>
<div class="ttc" id="structrecdes_html_a67343783639754b873ee300e3c742bc4"><div class="ttname"><a href="structrecdes.html#a67343783639754b873ee300e3c742bc4">recdes::type</a></div><div class="ttdeci">INT16 type</div><div class="ttdef"><b>Definition:</b> <a href="storage__common_8h_source.html#l00345">storage_common.h:345</a></div></div>
<div class="ttc" id="structlog__topops__stack_html_aeeae85de5bdc4f49b8ba730b25ab092b"><div class="ttname"><a href="structlog__topops__stack.html#aeeae85de5bdc4f49b8ba730b25ab092b">log_topops_stack::stack</a></div><div class="ttdeci">LOG_TOPOPS_ADDRESSES * stack</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01291">log_impl.h:1291</a></div></div>
<div class="ttc" id="structlog__rec__undoredo_html_a3aa626d1fe1436d8f7a258688fafaf9f"><div class="ttname"><a href="structlog__rec__undoredo.html#a3aa626d1fe1436d8f7a258688fafaf9f">log_rec_undoredo::rlength</a></div><div class="ttdeci">int rlength</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00658">log_impl.h:658</a></div></div>
<div class="ttc" id="log__comm_8c_html_a915b9b45cf29a152ab733755f7986572"><div class="ttname"><a href="log__comm_8c.html#a915b9b45cf29a152ab733755f7986572">log_dump_log_info</a></div><div class="ttdeci">int log_dump_log_info(const char *logname_info, bool also_stdout, const char *fmt,...)</div><div class="ttdef"><b>Definition:</b> <a href="log__comm_8c_source.html#l00205">log_comm.c:205</a></div></div>
<div class="ttc" id="structlog__arv__header_html_a9cded2fa1d3c3ddba7a506c0af952bf0"><div class="ttname"><a href="structlog__arv__header.html#a9cded2fa1d3c3ddba7a506c0af952bf0">log_arv_header::magic</a></div><div class="ttdeci">char magic[CUBRID_MAGIC_MAX_LENGTH]</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00414">log_impl.h:414</a></div></div>
<div class="ttc" id="thread__daemon_8hpp_html"><div class="ttname"><a href="thread__daemon_8hpp.html">thread_daemon.hpp</a></div></div>
<div class="ttc" id="storage__common_8h_html_a5859fbd2f7cd3c37c37e672f812388ff"><div class="ttname"><a href="storage__common_8h.html#a5859fbd2f7cd3c37c37e672f812388ff">NULL_VOLID</a></div><div class="ttdeci">#define NULL_VOLID</div><div class="ttdef"><b>Definition:</b> <a href="storage__common_8h_source.html#l00045">storage_common.h:45</a></div></div>
<div class="ttc" id="structlog__data_html_ab1a17fceea659d32f5187b81a7b80412"><div class="ttname"><a href="structlog__data.html#ab1a17fceea659d32f5187b81a7b80412">log_data::rcvindex</a></div><div class="ttdeci">LOG_RCVINDEX rcvindex</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00646">log_impl.h:646</a></div></div>
<div class="ttc" id="structlog__tdes_html_ad924146690490b840ef5c3f65c3a5a6c"><div class="ttname"><a href="structlog__tdes.html#ad924146690490b840ef5c3f65c3a5a6c">log_tdes::state</a></div><div class="ttdeci">TRAN_STATE state</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01695">log_impl.h:1695</a></div></div>
<div class="ttc" id="log__comm_8h_html_a3c0be9b9f104459ab90ee18af95c4b3e"><div class="ttname"><a href="log__comm_8h.html#a3c0be9b9f104459ab90ee18af95c4b3e">TRAN_STATE</a></div><div class="ttdeci">TRAN_STATE</div><div class="ttdef"><b>Definition:</b> <a href="log__comm_8h_source.html#l00039">log_comm.h:39</a></div></div>
<div class="ttc" id="storage__common_8h_html_a0a3c7db68a92df0d34666257bb0f17dd"><div class="ttname"><a href="storage__common_8h.html#a0a3c7db68a92df0d34666257bb0f17dd">IO_MAX_PAGE_SIZE</a></div><div class="ttdeci">#define IO_MAX_PAGE_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="storage__common_8h_source.html#l00161">storage_common.h:161</a></div></div>
<div class="ttc" id="release__string_8h_html_aa7483b60e70f1b66a28d488d26b04819aa6a56ca07bc482994856dd67d4769bfe"><div class="ttname"><a href="release__string_8h.html#aa7483b60e70f1b66a28d488d26b04819aa6a56ca07bc482994856dd67d4769bfe">REL_FULLY_COMPATIBLE</a></div><div class="ttdef"><b>Definition:</b> <a href="release__string_8h_source.html#l00050">release_string.h:50</a></div></div>
<div class="ttc" id="structlob__savepoint__entry_html_a3d018fd9135834945409660addac0520"><div class="ttname"><a href="structlob__savepoint__entry.html#a3d018fd9135834945409660addac0520">lob_savepoint_entry::prev</a></div><div class="ttdeci">LOB_SAVEPOINT_ENTRY * prev</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l00162">log_manager.c:162</a></div></div>
<div class="ttc" id="structlog__rec__run__postpone_html"><div class="ttname"><a href="structlog__rec__run__postpone.html">log_rec_run_postpone</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01588">log_impl.h:1588</a></div></div>
<div class="ttc" id="log__impl_8h_html_a0e075f8cf3a95dd3685eaaa9890335dc"><div class="ttname"><a href="log__impl_8h.html#a0e075f8cf3a95dd3685eaaa9890335dc">logtb_get_new_tran_id</a></div><div class="ttdeci">int logtb_get_new_tran_id(THREAD_ENTRY *thread_p, LOG_TDES *tdes)</div><div class="ttdef"><b>Definition:</b> <a href="log__tran__table_8c_source.html#l02075">log_tran_table.c:2075</a></div></div>
<div class="ttc" id="storage__common_8h_html_a1a7b7663aee8b9e8b1df6b1fbd5a88b9"><div class="ttname"><a href="storage__common_8h.html#a1a7b7663aee8b9e8b1df6b1fbd5a88b9">LOG_PAGESIZE</a></div><div class="ttdeci">#define LOG_PAGESIZE</div><div class="ttdef"><b>Definition:</b> <a href="storage__common_8h_source.html#l00163">storage_common.h:163</a></div></div>
<div class="ttc" id="log__impl_8h_html_ad6e16f99d29b73760a0855d9b0ac7e1b"><div class="ttname"><a href="log__impl_8h.html#ad6e16f99d29b73760a0855d9b0ac7e1b">prior_lsa_next_record_with_lock</a></div><div class="ttdeci">LOG_LSA prior_lsa_next_record_with_lock(THREAD_ENTRY *thread_p, LOG_PRIOR_NODE *node, LOG_TDES *tdes)</div><div class="ttdef"><b>Definition:</b> <a href="log__page__buffer_8c_source.html#l04065">log_page_buffer.c:4065</a></div></div>
<div class="ttc" id="log__impl_8h_html_aaa150f6c2ae6a1748640ab281ffd94f7a4252bfab0a4f9fbbcd7bd68ba32dea1d"><div class="ttname"><a href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a4252bfab0a4f9fbbcd7bd68ba32dea1d">LOG_MVCC_REDO_DATA</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00619">log_impl.h:619</a></div></div>
<div class="ttc" id="fault__injection_8h_html"><div class="ttname"><a href="fault__injection_8h.html">fault_injection.h</a></div></div>
<div class="ttc" id="structrecdes_html_ad79507ad26c0f557815cb78ce391be8b"><div class="ttname"><a href="structrecdes.html#ad79507ad26c0f557815cb78ce391be8b">recdes::length</a></div><div class="ttdeci">int length</div><div class="ttdef"><b>Definition:</b> <a href="storage__common_8h_source.html#l00344">storage_common.h:344</a></div></div>
<div class="ttc" id="dynamic__load_8c_html_ac6b02e4f4d9489ed432b5074c4defd5d"><div class="ttname"><a href="dynamic__load_8c.html#ac6b02e4f4d9489ed432b5074c4defd5d">_exit</a></div><div class="ttdeci">_exit(1)</div></div>
<div class="ttc" id="vacuum_8h_html_a85a0ab6d41bb8ef710931f6dba63d611a9245875052e8a4c44961fa17f81aff27"><div class="ttname"><a href="vacuum_8h.html#a85a0ab6d41bb8ef710931f6dba63d611a9245875052e8a4c44961fa17f81aff27">VACUUM_WORKER_STATE_RECOVERY</a></div><div class="ttdef"><b>Definition:</b> <a href="vacuum_8h_source.html#l00089">vacuum.h:89</a></div></div>
<div class="ttc" id="connection__support_8h_html"><div class="ttname"><a href="connection__support_8h.html">connection_support.h</a></div></div>
<div class="ttc" id="dbtype__function_8h_html_a517705ea2963537e8a1f01d45faa1064"><div class="ttname"><a href="dbtype__function_8h.html#a517705ea2963537e8a1f01d45faa1064">db_make_int</a></div><div class="ttdeci">int db_make_int(DB_VALUE *value, const int num)</div></div>
<div class="ttc" id="system__parameter_8h_html_a23aaf6bca406b9b428f43ad1b6b2b3e0a4ba9cca314203d2604689ba87896362d"><div class="ttname"><a href="system__parameter_8h.html#a23aaf6bca406b9b428f43ad1b6b2b3e0a4ba9cca314203d2604689ba87896362d">PRM_ID_HA_DELAY_LIMIT_IN_SECS</a></div><div class="ttdef"><b>Definition:</b> <a href="system__parameter_8h_source.html#l00241">system_parameter.h:241</a></div></div>
<div class="ttc" id="recovery_8h_html_a9447936a4f3c944165a741c6c7d25200"><div class="ttname"><a href="recovery_8h.html#a9447936a4f3c944165a741c6c7d25200">RCV_IS_LOGICAL_COMPENSATE_MANUAL</a></div><div class="ttdeci">#define RCV_IS_LOGICAL_COMPENSATE_MANUAL(idx)</div><div class="ttdef"><b>Definition:</b> <a href="recovery_8h_source.html#l00231">recovery.h:231</a></div></div>
<div class="ttc" id="recovery_8h_html_a526c4dc065c989256afca8b3b56d4d2ba2d4bae310e581efb860f5b180b730527"><div class="ttname"><a href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2ba2d4bae310e581efb860f5b180b730527">RVREPL_DATA_DELETE</a></div><div class="ttdef"><b>Definition:</b> <a href="recovery_8h_source.html#l00151">recovery.h:151</a></div></div>
<div class="ttc" id="log__impl_8h_html_aaa150f6c2ae6a1748640ab281ffd94f7a25bfb5a0ac528c508558bd8be6704739"><div class="ttname"><a href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a25bfb5a0ac528c508558bd8be6704739">LOG_LARGER_LOGREC_TYPE</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00627">log_impl.h:627</a></div></div>
<div class="ttc" id="structdb__identifier_html_a07604ea396d24b1babeab350ff10d07d"><div class="ttname"><a href="structdb__identifier.html#a07604ea396d24b1babeab350ff10d07d">db_identifier::volid</a></div><div class="ttdeci">short volid</div><div class="ttdef"><b>Definition:</b> <a href="dbtype__def_8h_source.html#l00989">dbtype_def.h:989</a></div></div>
<div class="ttc" id="structlog__rec__mvcc__redo_html_ac35ee3f43631b9679ca7e47fc6eae558"><div class="ttname"><a href="structlog__rec__mvcc__redo.html#ac35ee3f43631b9679ca7e47fc6eae558">log_rec_mvcc_redo::mvccid</a></div><div class="ttdeci">MVCCID mvccid</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00710">log_impl.h:710</a></div></div>
<div class="ttc" id="log__impl_8h_html_a4034ab2422d5e7947469cb6e2df3df4d"><div class="ttname"><a href="log__impl_8h.html#a4034ab2422d5e7947469cb6e2df3df4d">logtb_reset_bit_area_start_mvccid</a></div><div class="ttdeci">void logtb_reset_bit_area_start_mvccid(void)</div><div class="ttdef"><b>Definition:</b> <a href="log__tran__table_8c_source.html#l06807">log_tran_table.c:6807</a></div></div>
<div class="ttc" id="log__manager_8c_html_a03a220d809fc3d4eaaf0e1c12b297ea1"><div class="ttname"><a href="log__manager_8c.html#a03a220d809fc3d4eaaf0e1c12b297ea1">log_is_tran_in_system_op</a></div><div class="ttdeci">bool log_is_tran_in_system_op(THREAD_ENTRY *thread_p)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l04333">log_manager.c:4333</a></div></div>
<div class="ttc" id="structvfid_html_a09b59011789a52a37f2061aa7bf93477"><div class="ttname"><a href="structvfid.html#a09b59011789a52a37f2061aa7bf93477">vfid::volid</a></div><div class="ttdeci">short volid</div><div class="ttdef"><b>Definition:</b> <a href="dbtype__def_8h_source.html#l00912">dbtype_def.h:912</a></div></div>
<div class="ttc" id="log__manager_8c_html_a00976c440ea1347035bf5d8a707279e5"><div class="ttname"><a href="log__manager_8c.html#a00976c440ea1347035bf5d8a707279e5">log_sysop_end_logical_run_postpone</a></div><div class="ttdeci">void log_sysop_end_logical_run_postpone(THREAD_ENTRY *thread_p, LOG_LSA *posp_lsa)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l04062">log_manager.c:4062</a></div></div>
<div class="ttc" id="error__code_8h_html_aa588dd125f3c69e5b0cd960d3ed94e27"><div class="ttname"><a href="error__code_8h.html#aa588dd125f3c69e5b0cd960d3ed94e27">ER_LOG_INCOMPATIBLE_PREFIX_NAME</a></div><div class="ttdeci">#define ER_LOG_INCOMPATIBLE_PREFIX_NAME</div><div class="ttdef"><b>Definition:</b> <a href="error__code_8h_source.html#l00140">error_code.h:140</a></div></div>
<div class="ttc" id="log__impl_8h_html_af3b0bac26ee4d5867e1ae5fb093e798a"><div class="ttname"><a href="log__impl_8h.html#af3b0bac26ee4d5867e1ae5fb093e798a">logtb_undefine_trantable</a></div><div class="ttdeci">void logtb_undefine_trantable(THREAD_ENTRY *thread_p)</div><div class="ttdef"><b>Definition:</b> <a href="log__tran__table_8c_source.html#l00637">log_tran_table.c:637</a></div></div>
<div class="ttc" id="structmodified__class__entry_html"><div class="ttname"><a href="structmodified__class__entry.html">modified_class_entry</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01295">log_impl.h:1295</a></div></div>
<div class="ttc" id="disk__manager_8c_html_a24f513433165475abd985275f2eedda2"><div class="ttname"><a href="disk__manager_8c.html#a24f513433165475abd985275f2eedda2">disk_get_creation_time</a></div><div class="ttdeci">int disk_get_creation_time(THREAD_ENTRY *thread_p, INT16 volid, INT64 *db_creation)</div><div class="ttdef"><b>Definition:</b> <a href="disk__manager_8c_source.html#l05495">disk_manager.c:5495</a></div></div>
<div class="ttc" id="boot_8h_html_a158badd371706f1de006dfdffbd19d45"><div class="ttname"><a href="boot_8h.html#a158badd371706f1de006dfdffbd19d45">HA_SERVER_STATE</a></div><div class="ttdeci">enum ha_server_state HA_SERVER_STATE</div><div class="ttdef"><b>Definition:</b> <a href="boot_8h_source.html#l00156">boot.h:156</a></div></div>
<div class="ttc" id="perf__monitor_8h_html_a4411dd2d4a5c0b032f1f05805a48ecc4"><div class="ttname"><a href="perf__monitor_8h.html#a4411dd2d4a5c0b032f1f05805a48ecc4">log_Tran_index</a></div><div class="ttdeci">int log_Tran_index</div><div class="ttdef"><b>Definition:</b> <a href="log__global_8c_source.html#l00040">log_global.c:40</a></div></div>
<div class="ttc" id="oid_8h_html_a0f82ba684a0a36730f8373de8d4ba9ef"><div class="ttname"><a href="oid_8h.html#a0f82ba684a0a36730f8373de8d4ba9ef">OID_ISNULL</a></div><div class="ttdeci">#define OID_ISNULL(oidp)</div><div class="ttdef"><b>Definition:</b> <a href="oid_8h_source.html#l00082">oid.h:82</a></div></div>
<div class="ttc" id="structlog__info__chkpt__sysop_html_a34b9b7d8b5668b83c0301e95f012d067"><div class="ttname"><a href="structlog__info__chkpt__sysop.html#a34b9b7d8b5668b83c0301e95f012d067">log_info_chkpt_sysop::trid</a></div><div class="ttdeci">TRANID trid</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01626">log_impl.h:1626</a></div></div>
<div class="ttc" id="structlog__header_html_ae3e99551830990937f08938f0f9aec11"><div class="ttname"><a href="structlog__header.html#ae3e99551830990937f08938f0f9aec11">log_header::bkup_level0_lsa</a></div><div class="ttdeci">LOG_LSA bkup_level0_lsa</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00221">log_impl.h:221</a></div></div>
<div class="ttc" id="structlog__header_html_aa1540adc8fb89ea40a4cf0d18344afd9"><div class="ttname"><a href="structlog__header.html#aa1540adc8fb89ea40a4cf0d18344afd9">log_header::next_trid</a></div><div class="ttdeci">TRANID next_trid</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00204">log_impl.h:204</a></div></div>
<div class="ttc" id="page__buffer_8h_html_ae91a9e4bbf8b67fb56af5193d8dde649"><div class="ttname"><a href="page__buffer_8h.html#ae91a9e4bbf8b67fb56af5193d8dde649">DONT_FREE</a></div><div class="ttdeci">#define DONT_FREE</div><div class="ttdef"><b>Definition:</b> <a href="page__buffer_8h_source.html#l00039">page_buffer.h:39</a></div></div>
<div class="ttc" id="log__impl_8h_html_a3afa13fd96a09f0686e865e34d4ba415"><div class="ttname"><a href="log__impl_8h.html#a3afa13fd96a09f0686e865e34d4ba415">logpb_checkpoint</a></div><div class="ttdeci">LOG_PAGEID logpb_checkpoint(THREAD_ENTRY *thread_p)</div><div class="ttdef"><b>Definition:</b> <a href="log__page__buffer_8c_source.html#l07890">log_page_buffer.c:7890</a></div></div>
<div class="ttc" id="system__parameter_8h_html_a23aaf6bca406b9b428f43ad1b6b2b3e0ae353cf7f659005063e2daf4371fe712c"><div class="ttname"><a href="system__parameter_8h.html#a23aaf6bca406b9b428f43ad1b6b2b3e0ae353cf7f659005063e2daf4371fe712c">PRM_ID_LOG_NO_LOGGING</a></div><div class="ttdef"><b>Definition:</b> <a href="system__parameter_8h_source.html#l00275">system_parameter.h:275</a></div></div>
<div class="ttc" id="log__impl_8h_html_a5ea6483fb4af95ef44ff7eb9d6d35a05"><div class="ttname"><a href="log__impl_8h.html#a5ea6483fb4af95ef44ff7eb9d6d35a05">logpb_finalize_pool</a></div><div class="ttdeci">void logpb_finalize_pool(THREAD_ENTRY *thread_p)</div><div class="ttdef"><b>Definition:</b> <a href="log__page__buffer_8c_source.html#l00770">log_page_buffer.c:770</a></div></div>
<div class="ttc" id="log__comm_8c_html_ae3b5771bd95aa37a187f3a6e0cb2b32d"><div class="ttname"><a href="log__comm_8c.html#ae3b5771bd95aa37a187f3a6e0cb2b32d">log_does_allow_replication</a></div><div class="ttdeci">bool log_does_allow_replication(void)</div><div class="ttdef"><b>Definition:</b> <a href="log__comm_8c_source.html#l00270">log_comm.c:270</a></div></div>
<div class="ttc" id="error__code_8h_html_a16424fdd574a5296db5db6e546034ab5"><div class="ttname"><a href="error__code_8h.html#a16424fdd574a5296db5db6e546034ab5">ER_LOG_RECOVER_ON_OLD_RELEASE</a></div><div class="ttdeci">#define ER_LOG_RECOVER_ON_OLD_RELEASE</div><div class="ttdef"><b>Definition:</b> <a href="error__code_8h_source.html#l00142">error_code.h:142</a></div></div>
<div class="ttc" id="structlog__rec__undo_html_a50bcc130d05619893dbb63c284c3e874"><div class="ttname"><a href="structlog__rec__undo.html#a50bcc130d05619893dbb63c284c3e874">log_rec_undo::length</a></div><div class="ttdeci">int length</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00666">log_impl.h:666</a></div></div>
<div class="ttc" id="log__comm_8h_html_a3c0be9b9f104459ab90ee18af95c4b3ea0eb30d00abe6035a862198e833cc4f76"><div class="ttname"><a href="log__comm_8h.html#a3c0be9b9f104459ab90ee18af95c4b3ea0eb30d00abe6035a862198e833cc4f76">TRAN_UNACTIVE_ABORTED_INFORMING_PARTICIPANTS</a></div><div class="ttdef"><b>Definition:</b> <a href="log__comm_8h_source.html#l00066">log_comm.h:66</a></div></div>
<div class="ttc" id="error__code_8h_html_ad2e133a8a3c778d3231f733d9e9f960d"><div class="ttname"><a href="error__code_8h.html#ad2e133a8a3c778d3231f733d9e9f960d">ER_LOG_NONAME_SAVEPOINT</a></div><div class="ttdeci">#define ER_LOG_NONAME_SAVEPOINT</div><div class="ttdef"><b>Definition:</b> <a href="error__code_8h_source.html#l00770">error_code.h:770</a></div></div>
<div class="ttc" id="structlog__header_html_a06104560f68d0a20da58e4327a57755a"><div class="ttname"><a href="structlog__header.html#a06104560f68d0a20da58e4327a57755a">log_header::mvcc_next_id</a></div><div class="ttdeci">MVCCID mvcc_next_id</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00205">log_impl.h:205</a></div></div>
<div class="ttc" id="log__impl_8h_html_aaa150f6c2ae6a1748640ab281ffd94f7a15a1ebeb5fd50ffb5ae73b0cb26f9e7e"><div class="ttname"><a href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a15a1ebeb5fd50ffb5ae73b0cb26f9e7e">LOG_2PC_COMMIT_DECISION</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00593">log_impl.h:593</a></div></div>
<div class="ttc" id="structlog__topop__range_html"><div class="ttname"><a href="structlog__topop__range.html">log_topop_range</a></div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8h_source.html#l00050">log_manager.h:50</a></div></div>
<div class="ttc" id="log__manager_8c_html_af1e00d30dcc26ca3a967f9bd1a82cb27"><div class="ttname"><a href="log__manager_8c.html#af1e00d30dcc26ca3a967f9bd1a82cb27">log_sysop_end_unstack</a></div><div class="ttdeci">STATIC_INLINE void log_sysop_end_unstack(THREAD_ENTRY *thread_p, LOG_TDES *tdes) __attribute__((ALWAYS_INLINE))</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l03791">log_manager.c:3791</a></div></div>
<div class="ttc" id="porting_8h_html_a718749e18d63ca0d6b0d1b918efb41d6"><div class="ttname"><a href="porting_8h.html#a718749e18d63ca0d6b0d1b918efb41d6">STATIC_INLINE</a></div><div class="ttdeci">#define STATIC_INLINE</div><div class="ttdef"><b>Definition:</b> <a href="porting_8h_source.html#l00055">porting.h:55</a></div></div>
<div class="ttc" id="log__manager_8c_html_a390852f8765cd90576d47d02ef0d10b6"><div class="ttname"><a href="log__manager_8c.html#a390852f8765cd90576d47d02ef0d10b6">log_commit</a></div><div class="ttdeci">TRAN_STATE log_commit(THREAD_ENTRY *thread_p, int tran_index, bool retain_lock)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l05694">log_manager.c:5694</a></div></div>
<div class="ttc" id="log__manager_8c_html_a0ee86d15ed1d1d8ba92e9cbdd43badf5"><div class="ttname"><a href="log__manager_8c.html#a0ee86d15ed1d1d8ba92e9cbdd43badf5">log_append_savepoint</a></div><div class="ttdeci">LOG_LSA * log_append_savepoint(THREAD_ENTRY *thread_p, const char *savept_name)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l03370">log_manager.c:3370</a></div></div>
<div class="ttc" id="error__manager_8h_html_a5d0d456c474e11fc70779873a30a7432a3314630dd19f90a68274cf737092c9f2"><div class="ttname"><a href="error__manager_8h.html#a5d0d456c474e11fc70779873a30a7432a3314630dd19f90a68274cf737092c9f2">ER_FATAL_ERROR_SEVERITY</a></div><div class="ttdef"><b>Definition:</b> <a href="error__manager_8h_source.html#l00118">error_manager.h:118</a></div></div>
<div class="ttc" id="vacuum_8h_html_a3bae574be1c3bf9a786050397a1cde68"><div class="ttname"><a href="vacuum_8h.html#a3bae574be1c3bf9a786050397a1cde68">vacuum_get_worker_tdes</a></div><div class="ttdeci">STATIC_INLINE LOG_TDES * vacuum_get_worker_tdes(THREAD_ENTRY *thread_p) __attribute__((ALWAYS_INLINE))</div><div class="ttdef"><b>Definition:</b> <a href="vacuum_8h_source.html#l00218">vacuum.h:218</a></div></div>
<div class="ttc" id="structlog__arv__header_html_aae0b65f54ba63f485ed171b8571ffdbc"><div class="ttname"><a href="structlog__arv__header.html#aae0b65f54ba63f485ed171b8571ffdbc">log_arv_header::next_trid</a></div><div class="ttdeci">TRANID next_trid</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00418">log_impl.h:418</a></div></div>
<div class="ttc" id="storage__common_8h_html_a9a90f006879719246747fb497b16a663"><div class="ttname"><a href="storage__common_8h.html#a9a90f006879719246747fb497b16a663">LSA_INITIALIZER</a></div><div class="ttdeci">#define LSA_INITIALIZER</div><div class="ttdef"><b>Definition:</b> <a href="storage__common_8h_source.html#l00133">storage_common.h:133</a></div></div>
<div class="ttc" id="classcubthread_1_1manager_html_ae0175b93cea685c1f35e1c7730df1f01"><div class="ttname"><a href="classcubthread_1_1manager.html#ae0175b93cea685c1f35e1c7730df1f01">cubthread::manager::create_daemon</a></div><div class="ttdeci">daemon * create_daemon(const looper &amp;looper_arg, entry_task *exec_p, const char *daemon_name=&quot;&quot;, entry_manager *context_manager=NULL)</div><div class="ttdef"><b>Definition:</b> <a href="thread__manager_8cpp_source.html#l00167">thread_manager.cpp:167</a></div></div>
<div class="ttc" id="recovery_8h_html_a526c4dc065c989256afca8b3b56d4d2ba50c9179078858190e4f031e62c45314d"><div class="ttname"><a href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2ba50c9179078858190e4f031e62c45314d">RVREPL_DATA_UPDATE_END</a></div><div class="ttdef"><b>Definition:</b> <a href="recovery_8h_source.html#l00154">recovery.h:154</a></div></div>
<div class="ttc" id="release__string_8c_html_a9ffcff225b06b8ad183c576ad9edb8c3"><div class="ttname"><a href="release__string_8c.html#a9ffcff225b06b8ad183c576ad9edb8c3">rel_release_string</a></div><div class="ttdeci">const char * rel_release_string(void)</div><div class="ttdef"><b>Definition:</b> <a href="release__string_8c_source.html#l00155">release_string.c:155</a></div></div>
<div class="ttc" id="structlog__crumb_html_a01a9e2039ac048536a6c4aaefaa78896"><div class="ttname"><a href="structlog__crumb.html#a01a9e2039ac048536a6c4aaefaa78896">log_crumb::data</a></div><div class="ttdeci">const void * data</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01809">log_impl.h:1809</a></div></div>
<div class="ttc" id="perf__monitor_8h_html_a165b76d14ae9e30731ed3ca4cf856903afac5289ac60cb4ae52e4a75b7a30e92e"><div class="ttname"><a href="perf__monitor_8h.html#a165b76d14ae9e30731ed3ca4cf856903afac5289ac60cb4ae52e4a75b7a30e92e">PSTAT_HA_REPL_DELAY</a></div><div class="ttdef"><b>Definition:</b> <a href="perf__monitor_8h_source.html#l00382">perf_monitor.h:382</a></div></div>
<div class="ttc" id="structevent__stat_html_aca6622b3b2d7a83cba5b846d4eb3d5b5"><div class="ttname"><a href="structevent__stat.html#aca6622b3b2d7a83cba5b846d4eb3d5b5">event_stat::trace_log_flush_time</a></div><div class="ttdeci">int trace_log_flush_time</div><div class="ttdef"><b>Definition:</b> <a href="thread__entry_8hpp_source.html#l00106">thread_entry.hpp:106</a></div></div>
<div class="ttc" id="atldb__cubrid_8h_html_ad939da76b5d12fca40de18001582d63a"><div class="ttname"><a href="atldb__cubrid_8h.html#ad939da76b5d12fca40de18001582d63a">type</a></div><div class="ttdeci">type</div><div class="ttdef"><b>Definition:</b> <a href="atldb__cubrid_8h_source.html#l19394">atldb_cubrid.h:19394</a></div></div>
<div class="ttc" id="error__code_8h_html_afda48b732466fde2809e572b896f59f3"><div class="ttname"><a href="error__code_8h.html#afda48b732466fde2809e572b896f59f3">ER_LOG_CANNOT_ADD_SAVEPOINT</a></div><div class="ttdeci">#define ER_LOG_CANNOT_ADD_SAVEPOINT</div><div class="ttdef"><b>Definition:</b> <a href="error__code_8h_source.html#l00769">error_code.h:769</a></div></div>
<div class="ttc" id="cubrid__data__seek__test_8php_html_a7bf795f554c1ff05baccf023cc804198"><div class="ttname"><a href="cubrid__data__seek__test_8php.html#a7bf795f554c1ff05baccf023cc804198">if</a></div><div class="ttdeci">if( $result)</div><div class="ttdef"><b>Definition:</b> <a href="cubrid__data__seek__test_8php_source.html#l00057">cubrid_data_seek_test.php:57</a></div></div>
<div class="ttc" id="classdb__value__printer_html"><div class="ttname"><a href="classdb__value__printer.html">db_value_printer</a></div><div class="ttdef"><b>Definition:</b> <a href="db__value__printer_8hpp_source.html#l00035">db_value_printer.hpp:35</a></div></div>
<div class="ttc" id="log__impl_8h_html_aaa150f6c2ae6a1748640ab281ffd94f7a7557d9dfb53f14fd3b6eef04a165476b"><div class="ttname"><a href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a7557d9dfb53f14fd3b6eef04a165476b">LOG_DBEXTERN_REDO_DATA</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00537">log_impl.h:537</a></div></div>
<div class="ttc" id="storage__common_8h_html_a478797f01d6a6ad24c0203c09a639db2"><div class="ttname"><a href="storage__common_8h.html#a478797f01d6a6ad24c0203c09a639db2">LSA_LT</a></div><div class="ttdeci">#define LSA_LT(lsa_ptr1, lsa_ptr2)</div><div class="ttdef"><b>Definition:</b> <a href="storage__common_8h_source.html#l00142">storage_common.h:142</a></div></div>
<div class="ttc" id="recovery_8h_html_a526c4dc065c989256afca8b3b56d4d2bad08a05274deb3b86f225471a3763b75f"><div class="ttname"><a href="recovery_8h.html#a526c4dc065c989256afca8b3b56d4d2bad08a05274deb3b86f225471a3763b75f">RVHF_UPDATE</a></div><div class="ttdef"><b>Definition:</b> <a href="recovery_8h_source.html#l00084">recovery.h:84</a></div></div>
<div class="ttc" id="log__impl_8h_html_a1decc5b84f52a36e2d871ced1922a5a2"><div class="ttname"><a href="log__impl_8h.html#a1decc5b84f52a36e2d871ced1922a5a2">logpb_backup_level_info_to_string</a></div><div class="ttdeci">char * logpb_backup_level_info_to_string(char *buf, int buf_size, const LOG_HDR_BKUP_LEVEL_INFO *info)</div><div class="ttdef"><b>Definition:</b> <a href="log__page__buffer_8c_source.html#l12205">log_page_buffer.c:12205</a></div></div>
<div class="ttc" id="structlog__rcv__tdes_html_a320d4df908ebab286b06e64c5cfb2cd9"><div class="ttname"><a href="structlog__rcv__tdes.html#a320d4df908ebab286b06e64c5cfb2cd9">log_rcv_tdes::tran_start_postpone_lsa</a></div><div class="ttdeci">LOG_LSA tran_start_postpone_lsa</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01678">log_impl.h:1678</a></div></div>
<div class="ttc" id="memory__alloc_8h_html_a766ee0914a2859955a692c6a41b695c7"><div class="ttname"><a href="memory__alloc_8h.html#a766ee0914a2859955a692c6a41b695c7">db_private_realloc</a></div><div class="ttdeci">#define db_private_realloc(thrd, ptr, size)</div><div class="ttdef"><b>Definition:</b> <a href="memory__alloc_8h_source.html#l00232">memory_alloc.h:232</a></div></div>
<div class="ttc" id="log__impl_8h_html_a6814fb771a56f2ae611ec2d9bcbdf0fd"><div class="ttname"><a href="log__impl_8h.html#a6814fb771a56f2ae611ec2d9bcbdf0fd">TR_TABLE_CS_EXIT</a></div><div class="ttdeci">#define TR_TABLE_CS_EXIT(thread_p)</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00818">log_impl.h:818</a></div></div>
<div class="ttc" id="log__impl_8h_html_af2199b00d5310519162d48e131800e52"><div class="ttname"><a href="log__impl_8h.html#af2199b00d5310519162d48e131800e52">logpb_create_log_info</a></div><div class="ttdeci">void logpb_create_log_info(const char *logname_info, const char *db_fullname)</div><div class="ttdef"><b>Definition:</b> <a href="log__page__buffer_8c_source.html#l05743">log_page_buffer.c:5743</a></div></div>
<div class="ttc" id="log__manager_8c_html_aac95e62fd0455db6b8c123bc559a8acd"><div class="ttname"><a href="log__manager_8c.html#aac95e62fd0455db6b8c123bc559a8acd">log_get_next_nested_top</a></div><div class="ttdeci">int log_get_next_nested_top(THREAD_ENTRY *thread_p, LOG_TDES *tdes, LOG_LSA *start_postpone_lsa, LOG_TOPOP_RANGE **out_nxtop_range_stack)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l08363">log_manager.c:8363</a></div></div>
<div class="ttc" id="structlog__rec__2pc__start_html_ae1eddc500ab6f74e454396b6b8b3c580"><div class="ttname"><a href="structlog__rec__2pc__start.html#ae1eddc500ab6f74e454396b6b8b3c580">log_rec_2pc_start::gtrid</a></div><div class="ttdeci">int gtrid</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01655">log_impl.h:1655</a></div></div>
<div class="ttc" id="structlog__vacuum__info_html_aeb919b86c45ee91e08f67f3c13bb9465"><div class="ttname"><a href="structlog__vacuum__info.html#aeb919b86c45ee91e08f67f3c13bb9465">log_vacuum_info::vfid</a></div><div class="ttdeci">VFID vfid</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00682">log_impl.h:682</a></div></div>
<div class="ttc" id="log__impl_8h_html_aaa150f6c2ae6a1748640ab281ffd94f7ab9a91cb4efa2ad495c98d7dc7fef8ee1"><div class="ttname"><a href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7ab9a91cb4efa2ad495c98d7dc7fef8ee1">LOG_DUMMY_HEAD_POSTPONE</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00600">log_impl.h:600</a></div></div>
<div class="ttc" id="heap__file_8h_html"><div class="ttname"><a href="heap__file_8h.html">heap_file.h</a></div></div>
<div class="ttc" id="structlog__header_html_acb3318dc21996d211a62ec8bec70ecc2"><div class="ttname"><a href="structlog__header.html#acb3318dc21996d211a62ec8bec70ecc2">log_header::mvcc_op_log_lsa</a></div><div class="ttdeci">LOG_LSA mvcc_op_log_lsa</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00240">log_impl.h:240</a></div></div>
<div class="ttc" id="log__impl_8h_html_ac9a26eafda58f6bc67ba71c095c54372"><div class="ttname"><a href="log__impl_8h.html#ac9a26eafda58f6bc67ba71c095c54372">LOG_DBLOG_ARCHIVE_VOLID</a></div><div class="ttdeci">#define LOG_DBLOG_ARCHIVE_VOLID</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00495">log_impl.h:495</a></div></div>
<div class="ttc" id="structlog__rec__dbout__redo_html_a0d09baf4c8445cdbfe9ebd3e17271b3f"><div class="ttname"><a href="structlog__rec__dbout__redo.html#a0d09baf4c8445cdbfe9ebd3e17271b3f">log_rec_dbout_redo::rcvindex</a></div><div class="ttdeci">LOG_RCVINDEX rcvindex</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01518">log_impl.h:1518</a></div></div>
<div class="ttc" id="log__manager_8c_html_a261a2f1a76400a49a6d0babe12e31f98"><div class="ttname"><a href="log__manager_8c.html#a261a2f1a76400a49a6d0babe12e31f98">log_get_db_start_parameters</a></div><div class="ttdeci">int log_get_db_start_parameters(INT64 *db_creation, LOG_LSA *chkpt_lsa)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l00713">log_manager.c:713</a></div></div>
<div class="ttc" id="namespacebrokerstatus__to__csv_html_ae075d9642cd7485bc938b7d65b2e6991"><div class="ttname"><a href="namespacebrokerstatus__to__csv.html#ae075d9642cd7485bc938b7d65b2e6991">brokerstatus_to_csv.time</a></div><div class="ttdeci">time</div><div class="ttdef"><b>Definition:</b> <a href="brokerstatus__to__csv_8py_source.html#l00065">brokerstatus_to_csv.py:65</a></div></div>
<div class="ttc" id="structlog__rec__run__postpone_html_adee9338343c1891a51bb05e32dc6d120"><div class="ttname"><a href="structlog__rec__run__postpone.html#adee9338343c1891a51bb05e32dc6d120">log_rec_run_postpone::ref_lsa</a></div><div class="ttdeci">LOG_LSA ref_lsa</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01591">log_impl.h:1591</a></div></div>
<div class="ttc" id="log__comm_8h_html_a3c0be9b9f104459ab90ee18af95c4b3ea83800b7312eba64d331b924c80ce32b4"><div class="ttname"><a href="log__comm_8h.html#a3c0be9b9f104459ab90ee18af95c4b3ea83800b7312eba64d331b924c80ce32b4">TRAN_UNACTIVE_UNILATERALLY_ABORTED</a></div><div class="ttdef"><b>Definition:</b> <a href="log__comm_8h_source.html#l00050">log_comm.h:50</a></div></div>
<div class="ttc" id="regcomp_8c_html_aa25dac8b80db8b8f03732eeb9ca23934"><div class="ttname"><a href="regcomp_8c.html#aa25dac8b80db8b8f03732eeb9ca23934">PEEK</a></div><div class="ttdeci">#define PEEK()</div><div class="ttdef"><b>Definition:</b> <a href="regcomp_8c_source.html#l00040">regcomp.c:40</a></div></div>
<div class="ttc" id="vacuum_8c_html_a91948a8e1d29a833fa70822b8e64ccdf"><div class="ttname"><a href="vacuum_8c.html#a91948a8e1d29a833fa70822b8e64ccdf">vacuum_cache_log_postpone_lsa</a></div><div class="ttdeci">void vacuum_cache_log_postpone_lsa(THREAD_ENTRY *thread_p, LOG_LSA *lsa)</div><div class="ttdef"><b>Definition:</b> <a href="vacuum_8c_source.html#l07600">vacuum.c:7600</a></div></div>
<div class="ttc" id="critical__section_8h_html_af26f449e73437e60d22c20b4f2cb2aceaee0535cace8192b31b1edec6bd9df7ec"><div class="ttname"><a href="critical__section_8h.html#af26f449e73437e60d22c20b4f2cb2aceaee0535cace8192b31b1edec6bd9df7ec">INF_WAIT</a></div><div class="ttdef"><b>Definition:</b> <a href="critical__section_8h_source.html#l00050">critical_section.h:50</a></div></div>
<div class="ttc" id="file__io_8c_html_a3e06db37b56c37b0e9d1a041015ebc13"><div class="ttname"><a href="file__io_8c.html#a3e06db37b56c37b0e9d1a041015ebc13">fileio_open</a></div><div class="ttdeci">int fileio_open(const char *vol_label_p, int flags, int mode)</div><div class="ttdef"><b>Definition:</b> <a href="file__io_8c_source.html#l01937">file_io.c:1937</a></div></div>
<div class="ttc" id="log__impl_8h_html_a50409f9f65d32d3f4657a3eef2b9e594"><div class="ttname"><a href="log__impl_8h.html#a50409f9f65d32d3f4657a3eef2b9e594">logpb_find_header_parameters</a></div><div class="ttdeci">PGLENGTH logpb_find_header_parameters(THREAD_ENTRY *thread_p, const char *db_fullname, const char *logpath, const char *prefix_logname, PGLENGTH *io_page_size, PGLENGTH *log_page_size, INT64 *db_creation, float *db_compatibility, int *db_charset)</div><div class="ttdef"><b>Definition:</b> <a href="log__page__buffer_8c_source.html#l02274">log_page_buffer.c:2274</a></div></div>
<div class="ttc" id="structlog__lsa_html_abb57dd9b907435a584cbdea1d638523a"><div class="ttname"><a href="structlog__lsa.html#abb57dd9b907435a584cbdea1d638523a">log_lsa::pageid</a></div><div class="ttdeci">INT64 pageid</div><div class="ttdef"><b>Definition:</b> <a href="storage__common_8h_source.html#l00105">storage_common.h:105</a></div></div>
<div class="ttc" id="storage__common_8h_html_ad704198b3c56cf17601de69c679a7181a29c0c697bde0c7eb16b7f17bea656fb9"><div class="ttname"><a href="storage__common_8h.html#ad704198b3c56cf17601de69c679a7181a29c0c697bde0c7eb16b7f17bea656fb9">S_SUCCESS</a></div><div class="ttdef"><b>Definition:</b> <a href="storage__common_8h_source.html#l00643">storage_common.h:643</a></div></div>
<div class="ttc" id="dbtype__def_8h_html_a6735f6de14369bd1210b3491e220091da851e4d39ed7262dbd439cd2983edcb94"><div class="ttname"><a href="dbtype__def_8h.html#a6735f6de14369bd1210b3491e220091da851e4d39ed7262dbd439cd2983edcb94">DB_TYPE_CHAR</a></div><div class="ttdef"><b>Definition:</b> <a href="dbtype__def_8h_source.html#l00724">dbtype_def.h:724</a></div></div>
<div class="ttc" id="log__manager_8c_html_a0731525f63330e65340e1b0b61c0c158"><div class="ttname"><a href="log__manager_8c.html#a0731525f63330e65340e1b0b61c0c158">xlog_change_state_of_locator</a></div><div class="ttdeci">int xlog_change_state_of_locator(THREAD_ENTRY *thread_p, const char *locator, const char *new_locator, LOB_LOCATOR_STATE state)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l05180">log_manager.c:5180</a></div></div>
<div class="ttc" id="structdb__identifier_html"><div class="ttname"><a href="structdb__identifier.html">db_identifier</a></div><div class="ttdef"><b>Definition:</b> <a href="dbtype__def_8h_source.html#l00985">dbtype_def.h:985</a></div></div>
<div class="ttc" id="structlog__rcv__tdes_html_a3c513a5b19b9c04ebcf6bc57b76261e7"><div class="ttname"><a href="structlog__rcv__tdes.html#a3c513a5b19b9c04ebcf6bc57b76261e7">log_rcv_tdes::atomic_sysop_start_lsa</a></div><div class="ttdeci">LOG_LSA atomic_sysop_start_lsa</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01682">log_impl.h:1682</a></div></div>
<div class="ttc" id="log__manager_8c_html_a1aaae82081fc2e08d67075003e537842"><div class="ttname"><a href="log__manager_8c.html#a1aaae82081fc2e08d67075003e537842">log_get_undo_record</a></div><div class="ttdeci">SCAN_CODE log_get_undo_record(THREAD_ENTRY *thread_p, LOG_PAGE *log_page_p, LOG_LSA process_lsa, RECDES *recdes)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l10030">log_manager.c:10030</a></div></div>
<div class="ttc" id="log__writer_8h_html"><div class="ttname"><a href="log__writer_8h.html">log_writer.h</a></div></div>
<div class="ttc" id="structlog__header_html_abd3c92d1eb868dd630bdbfa3561ecf9e"><div class="ttname"><a href="structlog__header.html#abd3c92d1eb868dd630bdbfa3561ecf9e">log_header::chkpt_lsa</a></div><div class="ttdeci">LOG_LSA chkpt_lsa</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00215">log_impl.h:215</a></div></div>
<div class="ttc" id="vacuum_8h_html_aa06eb2e938f101b0b1b6c75c329e3f9d"><div class="ttname"><a href="vacuum_8h.html#aa06eb2e938f101b0b1b6c75c329e3f9d">vacuum_set_worker_state</a></div><div class="ttdeci">STATIC_INLINE void vacuum_set_worker_state(THREAD_ENTRY *thread_p, VACUUM_WORKER_STATE state) __attribute__((ALWAYS_INLINE))</div><div class="ttdef"><b>Definition:</b> <a href="vacuum_8h_source.html#l00232">vacuum.h:232</a></div></div>
<div class="ttc" id="structlog__rec__replication_html_abe7a28ec1533b0903038b517c3a7d1d1"><div class="ttname"><a href="structlog__rec__replication.html#abe7a28ec1533b0903038b517c3a7d1d1">log_rec_replication::length</a></div><div class="ttdeci">int length</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00718">log_impl.h:718</a></div></div>
<div class="ttc" id="structlog__rec__2pc__start_html"><div class="ttname"><a href="structlog__rec__2pc__start.html">log_rec_2pc_start</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01652">log_impl.h:1652</a></div></div>
<div class="ttc" id="log__manager_8c_html_aca0cd59cce1fda5d275e881faed4ad8b"><div class="ttname"><a href="log__manager_8c.html#aca0cd59cce1fda5d275e881faed4ad8b">log_set_ha_promotion_time</a></div><div class="ttdeci">void log_set_ha_promotion_time(THREAD_ENTRY *thread_p, INT64 ha_promotion_time)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l09994">log_manager.c:9994</a></div></div>
<div class="ttc" id="log__manager_8c_html_a4b52943a60e04cf7685b2355ad7e1d4a"><div class="ttname"><a href="log__manager_8c.html#a4b52943a60e04cf7685b2355ad7e1d4a">LOG_ISUNSAFE_TO_SKIP_RCVINDEX</a></div><div class="ttdeci">#define LOG_ISUNSAFE_TO_SKIP_RCVINDEX(RCVI)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l00133">log_manager.c:133</a></div></div>
<div class="ttc" id="error__code_8h_html_a8554831fac0d3c50e5ab2fd0354bf495"><div class="ttname"><a href="error__code_8h.html#a8554831fac0d3c50e5ab2fd0354bf495">ER_LOG_COMPILATION_RELEASE</a></div><div class="ttdeci">#define ER_LOG_COMPILATION_RELEASE</div><div class="ttdef"><b>Definition:</b> <a href="error__code_8h_source.html#l00143">error_code.h:143</a></div></div>
<div class="ttc" id="storage__common_8c_html_aa2fc36147d16be92850b4acfabeba733"><div class="ttname"><a href="storage__common_8c.html#aa2fc36147d16be92850b4acfabeba733">db_set_page_size</a></div><div class="ttdeci">int db_set_page_size(PGLENGTH io_page_size, PGLENGTH log_page_size)</div><div class="ttdef"><b>Definition:</b> <a href="storage__common_8c_source.html#l00096">storage_common.c:96</a></div></div>
<div class="ttc" id="log__impl_8h_html_a24797b2fe67e0ec8631d7a92fbef25c9a9e1c6cb1f049797b7b3f9230308663a3"><div class="ttname"><a href="log__impl_8h.html#a24797b2fe67e0ec8631d7a92fbef25c9a9e1c6cb1f049797b7b3f9230308663a3">LOG_SYSOP_END_COMMIT</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01541">log_impl.h:1541</a></div></div>
<div class="ttc" id="log__manager_8c_html_ab903fb10f0ff9d3073f703ab991cf8a3"><div class="ttname"><a href="log__manager_8c.html#ab903fb10f0ff9d3073f703ab991cf8a3">log_is_class_being_modified</a></div><div class="ttdeci">bool log_is_class_being_modified(THREAD_ENTRY *thread_p, const OID *class_oid)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l04881">log_manager.c:4881</a></div></div>
<div class="ttc" id="log__2pc_8c_html_a566c7760f8c68cf6cccc5f80045984e7"><div class="ttname"><a href="log__2pc_8c.html#a566c7760f8c68cf6cccc5f80045984e7">log_clear_and_is_tran_distributed</a></div><div class="ttdeci">bool log_clear_and_is_tran_distributed(LOG_TDES *tdes)</div><div class="ttdef"><b>Definition:</b> <a href="log__2pc_8c_source.html#l02798">log_2pc.c:2798</a></div></div>
<div class="ttc" id="log__impl_8h_html_aaa150f6c2ae6a1748640ab281ffd94f7a1ea8bf762d53de919a4eec322ebe9a1d"><div class="ttname"><a href="log__impl_8h.html#aaa150f6c2ae6a1748640ab281ffd94f7a1ea8bf762d53de919a4eec322ebe9a1d">LOG_2PC_COMMIT_INFORM_PARTICPS</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00595">log_impl.h:595</a></div></div>
<div class="ttc" id="file__io_8c_html_a4756450084f251e83a14fbe2c835e4d9"><div class="ttname"><a href="file__io_8c.html#a4756450084f251e83a14fbe2c835e4d9">fileio_map_mounted</a></div><div class="ttdeci">bool fileio_map_mounted(THREAD_ENTRY *thread_p, bool(*fun)(THREAD_ENTRY *thread_p, VOLID vol_id, void *args), void *args)</div><div class="ttdef"><b>Definition:</b> <a href="file__io_8c_source.html#l03407">file_io.c:3407</a></div></div>
<div class="ttc" id="log__manager_8c_html_a7a434244945b53f5459db505d15068fe"><div class="ttname"><a href="log__manager_8c.html#a7a434244945b53f5459db505d15068fe">xlog_drop_lob_locator</a></div><div class="ttdeci">int xlog_drop_lob_locator(THREAD_ENTRY *thread_p, const char *locator)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l05250">log_manager.c:5250</a></div></div>
<div class="ttc" id="log__manager_8c_html_ad746664fdeb839dc9faf0d92e0623c3d"><div class="ttname"><a href="log__manager_8c.html#ad746664fdeb839dc9faf0d92e0623c3d">log_append_redo_recdes</a></div><div class="ttdeci">void log_append_redo_recdes(THREAD_ENTRY *thread_p, LOG_RCVINDEX rcvindex, LOG_DATA_ADDR *addr, const RECDES *recdes)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l02592">log_manager.c:2592</a></div></div>
<div class="ttc" id="log__impl_8h_html_ae1aad1a6b2c71bde2d1b93df8bc54e38"><div class="ttname"><a href="log__impl_8h.html#ae1aad1a6b2c71bde2d1b93df8bc54e38">LOG_PRIOR_LSA_LOCK</a></div><div class="ttdeci">LOG_PRIOR_LSA_LOCK</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l01091">log_impl.h:1091</a></div></div>
<div class="ttc" id="structdisk__volume__space__info_html"><div class="ttname"><a href="structdisk__volume__space__info.html">disk_volume_space_info</a></div><div class="ttdef"><b>Definition:</b> <a href="disk__manager_8h_source.html#l00061">disk_manager.h:61</a></div></div>
<div class="ttc" id="structlog__rec__mvcc__undoredo_html_adf64ef5b403ea259100fa835d9b75c12"><div class="ttname"><a href="structlog__rec__mvcc__undoredo.html#adf64ef5b403ea259100fa835d9b75c12">log_rec_mvcc_undoredo::mvccid</a></div><div class="ttdeci">MVCCID mvccid</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00692">log_impl.h:692</a></div></div>
<div class="ttc" id="vacuum_8h_html_a34562043d3500a01b17bd84ca27940ad"><div class="ttname"><a href="vacuum_8h.html#a34562043d3500a01b17bd84ca27940ad">vacuum_get_worker_state</a></div><div class="ttdeci">STATIC_INLINE VACUUM_WORKER_STATE vacuum_get_worker_state(THREAD_ENTRY *thread_p) __attribute__((ALWAYS_INLINE))</div><div class="ttdef"><b>Definition:</b> <a href="vacuum_8h_source.html#l00225">vacuum.h:225</a></div></div>
<div class="ttc" id="structbackground__archiving__info_html"><div class="ttname"><a href="structbackground__archiving__info.html">background_archiving_info</a></div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00386">log_impl.h:386</a></div></div>
<div class="ttc" id="log__impl_8h_html_aa501d3de75690fbad474f906ff686b19"><div class="ttname"><a href="log__impl_8h.html#aa501d3de75690fbad474f906ff686b19">LOG_RESET_APPEND_LSA</a></div><div class="ttdeci">#define LOG_RESET_APPEND_LSA(lsa)</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00863">log_impl.h:863</a></div></div>
<div class="ttc" id="log__manager_8c_html_aaa9c09a7c8de8d4a759762633f07c8a1"><div class="ttname"><a href="log__manager_8c.html#aaa9c09a7c8de8d4a759762633f07c8a1">log_sysop_end_type_string</a></div><div class="ttdeci">const char * log_sysop_end_type_string(LOG_SYSOP_END_TYPE end_type)</div><div class="ttdef"><b>Definition:</b> <a href="log__manager_8c_source.html#l03577">log_manager.c:3577</a></div></div>
<div class="ttc" id="log__impl_8h_html_a108c8143796ad50c65f64d4a483e9453"><div class="ttname"><a href="log__impl_8h.html#a108c8143796ad50c65f64d4a483e9453">LOG_READ_ADVANCE_WHEN_DOESNT_FIT</a></div><div class="ttdeci">#define LOG_READ_ADVANCE_WHEN_DOESNT_FIT(thread_p, length, lsa, log_pgptr)</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00909">log_impl.h:909</a></div></div>
<div class="ttc" id="file__io_8c_html_a9d683e94e5800584f0dfabf144fc758f"><div class="ttname"><a href="file__io_8c.html#a9d683e94e5800584f0dfabf144fc758f">fileio_get_volume_descriptor</a></div><div class="ttdeci">int fileio_get_volume_descriptor(VOLID vol_id)</div><div class="ttdef"><b>Definition:</b> <a href="file__io_8c_source.html#l06396">file_io.c:6396</a></div></div>
<div class="ttc" id="dbtype__function_8h_html_a672513498ce99f993e55a79fd36d6361"><div class="ttname"><a href="dbtype__function_8h.html#a672513498ce99f993e55a79fd36d6361">db_get_string</a></div><div class="ttdeci">DB_C_CHAR db_get_string(const DB_VALUE *value)</div></div>
<div class="ttc" id="structlog__arv__header_html_a68c13cca07c8072d6ea245e762af906c"><div class="ttname"><a href="structlog__arv__header.html#a68c13cca07c8072d6ea245e762af906c">log_arv_header::npages</a></div><div class="ttdeci">DKNPAGES npages</div><div class="ttdef"><b>Definition:</b> <a href="log__impl_8h_source.html#l00419">log_impl.h:419</a></div></div>
<div class="ttc" id="storage__common_8h_html_aa8d8ea0049b43e3faf4c471641af5f98"><div class="ttname"><a href="storage__common_8h.html#aa8d8ea0049b43e3faf4c471641af5f98">LSA_EQ</a></div><div class="ttdeci">#define LSA_EQ(lsa_ptr1, lsa_ptr2)</div><div class="ttdef"><b>Definition:</b> <a href="storage__common_8h_source.html#l00148">storage_common.h:148</a></div></div>
<div class="ttc" id="expat_8h_html_afed088663f8704004425cdae2120b9b3"><div class="ttname"><a href="expat_8h.html#afed088663f8704004425cdae2120b9b3">len</a></div><div class="ttdeci">const char int len</div><div class="ttdef"><b>Definition:</b> <a href="expat_8h_source.html#l00713">expat.h:713</a></div></div>
<div class="ttc" id="perf__monitor_8h_html_a165b76d14ae9e30731ed3ca4cf856903a4e18bb2055926d898d835f85870c7bed"><div class="ttname"><a href="perf__monitor_8h.html#a165b76d14ae9e30731ed3ca4cf856903a4e18bb2055926d898d835f85870c7bed">PSTAT_TRAN_NUM_ROLLBACKS</a></div><div class="ttdef"><b>Definition:</b> <a href="perf__monitor_8h_source.html#l00324">perf_monitor.h:324</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_483b32a6ce93291d0160e24fe223c96c.html">transaction</a></li><li class="navelem"><a class="el" href="log__manager_8c.html">log_manager.c</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
