<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CUBRID Engine: src/oledb/type.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CUBRID Engine
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('type_8cpp_source.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">type.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="type_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * Copyright (C) 2008 Search Solution Corporation. All rights reserved by Search Solution. </span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> * Redistribution and use in source and binary forms, with or without modification, </span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> * are permitted provided that the following conditions are met: </span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> * - Redistributions of source code must retain the above copyright notice, </span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> *   this list of conditions and the following disclaimer. </span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> * - Redistributions in binary form must reproduce the above copyright notice, </span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> *   this list of conditions and the following disclaimer in the documentation </span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> *   and/or other materials provided with the distribution. </span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> * - Neither the name of the &lt;ORGANIZATION&gt; nor the names of its contributors </span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> *   may be used to endorse or promote products derived from this software without </span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> *   specific prior written permission. </span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"> * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND </span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment"> * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED </span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"> * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. </span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment"> * IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, </span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment"> * INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, </span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment"> * BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, </span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment"> * OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, </span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment"> * WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) </span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment"> * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY </span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment"> * OF SUCH DAMAGE. </span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="oledb_2stdafx_8h.html">stdafx.h</a>&quot;</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="type_8h.html">type.h</a>&quot;</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;math.h&quot;</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="ProviderInfo_8h.html">ProviderInfo.h</a>&quot;</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;</div><div class="line"><a name="l00036"></a><span class="lineno"><a class="line" href="namespaceType.html">   36</a></span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceType.html">Type</a> {</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div><div class="line"><a name="l00038"></a><span class="lineno"><a class="line" href="type_8cpp.html#a9621823ebe0c6011abf47c1b4cf96222">   38</a></span>&#160;<span class="preprocessor">#define CCIDATETYPE_DATE        1</span></div><div class="line"><a name="l00039"></a><span class="lineno"><a class="line" href="type_8cpp.html#a2e2644b526842246ecbcbfbb13b3e232">   39</a></span>&#160;<span class="preprocessor">#define CCIDATETYPE_TIME        2</span></div><div class="line"><a name="l00040"></a><span class="lineno"><a class="line" href="type_8cpp.html#aa31c5a0dc62b9da3c345095cc6d4d30d">   40</a></span>&#160;<span class="preprocessor">#define CCIDATETYPE_TIMESTAMP   3</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;</div><div class="line"><a name="l00042"></a><span class="lineno"><a class="line" href="namespaceType.html#abce8b84baded7c05d4dabb3072d6f327">   42</a></span>&#160;<a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812">T_CCI_U_TYPE</a> <a class="code" href="namespaceType.html#abce8b84baded7c05d4dabb3072d6f327">GetCASTypeUFromProviderType</a>(LPOLESTR provType)</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;{</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; <a class="code" href="namespaceProvInfo.html#a85427466c835b24ce2bf55ae6a5ccc23">ProvInfo::size_provider_types</a>; <a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        <span class="keywordflow">if</span> (!_wcsicmp(<a class="code" href="namespaceProvInfo.html#a9de8dfa82da6330548d128dce1a11c7a">ProvInfo::provider_types</a>[<a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>].szName, provType))</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="namespaceProvInfo.html#a9de8dfa82da6330548d128dce1a11c7a">ProvInfo::provider_types</a>[<a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="structProvInfo_1_1__ptypes.html#ad7755f56868a8d44eff186977fec07d5">nCCIUType</a>;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a816edf276f251f83824d11e32785920b">CCI_U_TYPE_UNKNOWN</a>;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;}</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div><div class="line"><a name="l00050"></a><span class="lineno"><a class="line" href="namespaceType.html#a78f493b8bf8743a2fdc9a0e1b0bdb06b">   50</a></span>&#160;HRESULT <a class="code" href="namespaceType.html#a78f493b8bf8743a2fdc9a0e1b0bdb06b">GetColumnDefinitionString</a>(DBCOLUMNDESC colDesc, CComBSTR&amp; strType)</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;{</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="keywordtype">char</span> strColSize[15];</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812">T_CCI_U_TYPE</a> uType;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    CComBSTR defaultVal;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    ULONG cPropertySets = colDesc.cPropertySets;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="keywordtype">bool</span> bIsFixedLength = <span class="keyword">false</span>;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="keywordtype">bool</span> bIsNullable = <span class="keyword">true</span>;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="keywordtype">bool</span> bIsLong = <span class="keyword">false</span>;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="keywordtype">bool</span> bIsPrimaryKey = <span class="keyword">false</span>;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <span class="keywordtype">bool</span> bIsUnique = <span class="keyword">false</span>;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="keywordtype">bool</span> bHasDefault = <span class="keyword">false</span>;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    HRESULT hr = <a class="code" href="atldb__cubrid_8h.html#a1c8f62bc38a50376a62d4dad41a5e2aa">S_OK</a>;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="keywordflow">if</span> (cPropertySets)</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    {</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        <span class="keywordflow">if</span> (!(colDesc.rgPropertySets))</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;            <span class="keywordflow">return</span> E_INVALIDARG;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        <span class="comment">// TODO: CUtlProps를 이용하면 좋지 않을까?</span></div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        <span class="comment">//DBPROPSET_COLUMN property set이 있기만 하면 에러는 없으며 나머지 property set은 무시      for (ULONG i = 0; i &lt; cPropertySets; i++)
        {
            if (colDesc.rgPropertySets[i].cProperties &amp;&amp;
                !colDesc.rgPropertySets[i].rgProperties)
                return E_INVALIDARG;

            if (colDesc.rgPropertySets[i].guidPropertySet == DBPROPSET_COLUMN)
            {
                ULONG numProp = colDesc.rgPropertySets[i].cProperties;
                for (ULONG j = 0; j &lt; numProp; j++)
                {
                    DBPROPID propID = colDesc.rgPropertySets[i].rgProperties[j].dwPropertyID;
                    VARIANT val = colDesc.rgPropertySets[i].rgProperties[j].vValue;
                    VARTYPE type = colDesc.rgPropertySets[i].rgProperties[j].vValue.vt;
                    DBPROPOPTIONS options = colDesc.rgPropertySets[i].rgProperties[j].dwOptions;
                    DBPROPSTATUS* status = &amp;colDesc.rgPropertySets[i].rgProperties[j].dwStatus;
                    
                    if (options != DBPROPOPTIONS_REQUIRED &amp;&amp;
                        options != DBPROPOPTIONS_OPTIONAL)
                    {
                        *status = DBPROPSTATUS_BADOPTION;
                        return DB_E_ERRORSOCCURRED;
                    }

                    //프로퍼티에 맞는 타입인지 체크
                    if ((propID == DBPROP_COL_FIXEDLENGTH) ||
                        (propID == DBPROP_COL_NULLABLE) ||
                        (propID == DBPROP_COL_ISLONG) ||
                        (propID == DBPROP_COL_PRIMARYKEY) ||
                        (propID == DBPROP_COL_UNIQUE))
                    {
                        if (type != VT_BOOL) //Type Error
                        {
                            *status = DBPROPSTATUS_BADVALUE;

                            if (options == DBPROPOPTIONS_REQUIRED)
                            {
                                return DB_E_ERRORSOCCURRED;
                            } else
                                hr = DB_S_ERRORSOCCURRED;
                        } else
                        {
                            switch(propID)
                            {
                            case DBPROP_COL_FIXEDLENGTH:
                                bIsFixedLength = (V_BOOL(&amp;val)==VARIANT_TRUE);
                                *status = DBPROPSTATUS_OK;
                                break;
                            case DBPROP_COL_NULLABLE:
                                if (bIsPrimaryKey)
                                {
                                    *status = DBPROPSTATUS_CONFLICTING;

                                    if (options == DBPROPOPTIONS_REQUIRED)
                                    {
                                        return DB_E_ERRORSOCCURRED;
                                    } else
                                        hr = DB_S_ERRORSOCCURRED;
                                } else
                                {
                                    if (V_BOOL(&amp;val)==VARIANT_FALSE)
                                        bIsNullable = false;

                                    *status = DBPROPSTATUS_OK;
                                }
                                break;
                            case DBPROP_COL_ISLONG:
                                bIsLong = (V_BOOL(&amp;val)==VARIANT_TRUE);
                                *status = DBPROPSTATUS_OK;
                                break;
                            case DBPROP_COL_PRIMARYKEY:
                                if (bIsUnique || bHasDefault)
                                {
                                    *status = DBPROPSTATUS_CONFLICTING;

                                    if (options == DBPROPOPTIONS_REQUIRED)
                                    {
                                        return DB_E_ERRORSOCCURRED;
                                    } else
                                        hr = DB_S_ERRORSOCCURRED;
                                } else
                                {
                                    bIsPrimaryKey = (V_BOOL(&amp;val)==VARIANT_TRUE);
                                    *status = DBPROPSTATUS_OK;
                                }
                                break;
                            case DBPROP_COL_UNIQUE:
                                if (bIsPrimaryKey)
                                {
                                    *status = DBPROPSTATUS_CONFLICTING;

                                    if (options == DBPROPOPTIONS_REQUIRED)
                                    {
                                        return DB_E_ERRORSOCCURRED;
                                    } else
                                        hr = DB_S_ERRORSOCCURRED;
                                } else
                                {
                                    bIsUnique = (V_BOOL(&amp;val)==VARIANT_TRUE);
                                    *status = DBPROPSTATUS_OK;
                                }
                                break;
                            }
                        }
                    } else if (propID == DBPROP_COL_DEFAULT)
                    {
                        if (bIsPrimaryKey)
                        {
                            *status = DBPROPSTATUS_CONFLICTING;

                            if (options == DBPROPOPTIONS_REQUIRED)
                            {
                                return DB_E_ERRORSOCCURRED;
                            } else
                                hr = DB_S_ERRORSOCCURRED;
                        } else
                        {
                            CComVariant variant(val);
                            if (FAILED(variant.ChangeType(VT_BSTR)))
                            {
                                *status = DBPROPSTATUS_BADVALUE;

                                if (options == DBPROPOPTIONS_REQUIRED)
                                {
                                    return DB_E_ERRORSOCCURRED;
                                } else
                                    hr = DB_S_ERRORSOCCURRED;
                            } else
                            {
                                bHasDefault = true;
                                defaultVal.Append(variant.bstrVal);
                                *status = DBPROPSTATUS_OK;
                            }
                        }
                    }
                    else
                    {
                        *status = DBPROPSTATUS_NOTSUPPORTED;

                        if (options == DBPROPOPTIONS_REQUIRED)
                            return DB_E_ERRORSOCCURRED;
                        else
                            hr = DB_S_ERRORSOCCURRED;
                    }
                }
            }
            else
            {
                for (ULONG j = 0; j &lt; colDesc.rgPropertySets[i].cProperties; j++)
                {
                    colDesc.rgPropertySets[i].rgProperties[j].dwStatus = DBPROPSTATUS_NOTSUPPORTED;

                    if (colDesc.rgPropertySets[i].rgProperties[j].dwOptions == DBPROPOPTIONS_REQUIRED)
                        return DB_E_ERRORSOCCURRED;
                    else
                        hr = DB_S_ERRORSOCCURRED;
                }
            }
        } 
    }

    if (colDesc.pTypeInfo)
        return DB_E_BADTYPE;

    if (colDesc.pwszTypeName &amp;&amp; wcslen(colDesc.pwszTypeName) &gt; 0)
    {
        /* CUBRID Provider-Specific types
         L&quot;CHAR&quot;
         L&quot;VARCHAR&quot;
         L&quot;NCHAR&quot;
         L&quot;NCHAR VARYING&quot;
         L&quot;BIT&quot;
         L&quot;BIT VARYING&quot;
         L&quot;NUMERIC&quot;
         L&quot;INT&quot;
         L&quot;SMALLINT&quot;
         L&quot;FLOAT&quot;
         L&quot;DOUBLE&quot;
         L&quot;MONETARY&quot;
         L&quot;DATE&quot;
         L&quot;TIME&quot;
         L&quot;TIMESTAMP&quot;
        */
        LPWSTR pwszTypeName = colDesc.pwszTypeName;
        DBLENGTH colSize = colDesc.ulColumnSize;
        T_CCI_U_TYPE targetType;

        DBTYPE validType = GetOledbTypeFromName(pwszTypeName);
        if (validType != colDesc.wType)
            return DB_E_BADTYPE;

        if (!_wcsicmp(pwszTypeName, L&quot;CHAR&quot;) || !_wcsicmp(pwszTypeName, L&quot;VARCHAR&quot;))
        {
            if (bIsFixedLength) targetType = CCI_U_TYPE_CHAR;
            else targetType = CCI_U_TYPE_STRING;

            if (!colSize)
            {
                StaticTypeInfo tInfo = GetStaticTypeInfo(targetType);
                colSize = tInfo.ulSize;
            }

            if (bIsFixedLength) strType.Append(&quot;CHAR&quot;);
            else strType.Append(&quot;VARCHAR&quot;);
            sprintf(strColSize, &quot;(%ld)&quot;, colSize);
            strType.Append(strColSize);
        } else if (!_wcsicmp(pwszTypeName, L&quot;NCHAR&quot;) || !_wcsicmp(pwszTypeName, L&quot;NCHAR VARYING&quot;))
        {
            if (bIsFixedLength) targetType = CCI_U_TYPE_NCHAR;
            else targetType = CCI_U_TYPE_VARNCHAR;

            if (!colSize)
            {
                StaticTypeInfo tInfo = GetStaticTypeInfo(targetType);
                colSize = tInfo.ulSize;
            } else
                colSize *= 2;
            
            if (bIsFixedLength) strType.Append(&quot;NCHAR&quot;);
            else strType.Append(&quot;NCHAR VARYING&quot;);
            sprintf(strColSize, &quot;(%ld)&quot;, colSize);
            strType.Append(strColSize);
        } else if (!_wcsicmp(pwszTypeName, L&quot;BIT&quot;) || !_wcsicmp(pwszTypeName, L&quot;BIT VARYING&quot;))
        {
            if (bIsFixedLength) targetType = CCI_U_TYPE_BIT;
            else targetType = CCI_U_TYPE_VARBIT;

            if (!colSize)
            {
                StaticTypeInfo tInfo = GetStaticTypeInfo(targetType);
                colSize = tInfo.ulSize;
            } else
                colSize *= 8;
            
            if (bIsFixedLength) strType.Append(&quot;BIT&quot;);
            else strType.Append(&quot;BIT VARYING&quot;);
            sprintf(strColSize, &quot;(%u)&quot;, colSize);
            strType.Append(strColSize);
        } else if (!_wcsicmp(pwszTypeName, L&quot;NUMERIC&quot;))
        {

            if (colDesc.bPrecision &lt; 1 || colDesc.bPrecision &gt; 38)
                return DB_E_BADPRECISION;

            if (colDesc.bPrecision &lt; colDesc.bScale)
                return DB_E_BADSCALE;

            strType.Append(pwszTypeName);
            sprintf(strColSize, &quot;(%ld,%ld)&quot;, colDesc.bPrecision, colDesc.bScale);
            strType.Append(strColSize);
        } else if (!_wcsicmp(pwszTypeName, L&quot;INT&quot;) || !_wcsicmp(pwszTypeName, L&quot;SMALLINT&quot;) ||
                    !_wcsicmp(pwszTypeName, L&quot;FLOAT&quot;) || !_wcsicmp(pwszTypeName, L&quot;DOUBLE&quot;) ||
                    !_wcsicmp(pwszTypeName, L&quot;MONETARY&quot;) || !_wcsicmp(pwszTypeName, L&quot;DATE&quot;) ||
                    !_wcsicmp(pwszTypeName, L&quot;TIME&quot;) || !_wcsicmp(pwszTypeName, L&quot;TIMESTAMP&quot;))
        {
            strType.Append(pwszTypeName);
        }
    } else
    {       
        uType = GetCASTypeU(colDesc.wType);
        if (uType == CCI_U_TYPE_UNKNOWN)
            return DB_E_BADTYPE;

        DBLENGTH colSize;
        //컬럼 사이즈가 0인 경우는 static type info에서 컬럼 사이즈를 가져온다
        if (!colDesc.ulColumnSize)
        {
            StaticTypeInfo tInfo = GetStaticTypeInfo(uType);
            colSize = tInfo.ulSize;
        } else
            colSize = colDesc.ulColumnSize;

        switch (uType)
        {
        case CCI_U_TYPE_CHAR: 
            sprintf(strColSize, &quot;(%ld)&quot;, colSize);
            strType.Append(strColSize);
            break;
        case CCI_U_TYPE_STRING : 
            if (bIsFixedLength)
                strType.Append(L&quot;Char&quot;);
            else
                strType.Append(L&quot;Varchar&quot;);
            sprintf(strColSize, &quot;(%ld)&quot;, colSize);
            strType.Append(strColSize);
            break;
        case CCI_U_TYPE_NCHAR : 
            if (bIsFixedLength)
                strType.Append(L&quot;NChar&quot;);
            else
                strType.Append(L&quot;NChar Varying&quot;);

            //사용자가 원하는 길이의 두 배로 저장해야 한다
           if (colDesc.ulColumnSize)
                colSize *= 2;

            sprintf(strColSize, &quot;(%ld)&quot;, colSize);
            strType.Append(strColSize);
            break;
        case CCI_U_TYPE_BIT : 
            if (bIsFixedLength)
                strType.Append(L&quot;Bit&quot;);
            else
                strType.Append(L&quot;Bit Varying&quot;);

            //사용자가 원하는 길이의 여덟 배로 저장해야 한다
         if (colDesc.ulColumnSize)
                colSize *= 8;

            sprintf(strColSize, &quot;(%u)&quot;, colSize);
            strType.Append(strColSize);
            break;
        case CCI_U_TYPE_NUMERIC : 
            if (colDesc.bPrecision &lt; 1 || colDesc.bPrecision &gt; 38)
                return DB_E_BADPRECISION;

            if (colDesc.bPrecision &lt; colDesc.bScale)
                return DB_E_BADSCALE;

            strType.Append(L&quot;Numeric&quot;);
            sprintf(strColSize, &quot;(%ld,%ld)&quot;, colDesc.bPrecision, colDesc.bScale);
            strType.Append(strColSize);
            break;
        case CCI_U_TYPE_INT : strType.Append(L&quot;Integer&quot;);
            break;
        case CCI_U_TYPE_SHORT : strType.Append(L&quot;Smallint&quot;);
            break;
        case CCI_U_TYPE_MONETARY : strType.Append(L&quot;Monetary&quot;);
            break;
        case CCI_U_TYPE_FLOAT : strType.Append(L&quot;Float&quot;);
            break;
        case CCI_U_TYPE_DOUBLE : strType.Append(L&quot;Double&quot;);
            break;
        case CCI_U_TYPE_DATE : strType.Append(L&quot;Date&quot;);
            break;
        case CCI_U_TYPE_TIME : strType.Append(L&quot;Time&quot;);
            break;
        case CCI_U_TYPE_TIMESTAMP : strType.Append(L&quot;Timestamp&quot;);
            break;
        case CCI_U_TYPE_SET : strType.Append(L&quot;SET&quot;);
            break;
        case CCI_U_TYPE_MULTISET : strType.Append(L&quot;Multiset&quot;);
            break;
        case CCI_U_TYPE_SEQUENCE : strType.Append(L&quot;Sequence&quot;);
            break;
        case CCI_U_TYPE_OBJECT : strType.Append(L&quot;Object&quot;);
            break;
        default : strType.Append(L&quot;&quot;);
        }
    }

    if (bHasDefault)
    {
        strType.Append(L&quot; DEFAULT &quot;);
        strType.Append(defaultVal);
    }
    if (bIsPrimaryKey)
        strType.Append(L&quot; PRIMARY KEY &quot;);
    if (!bIsNullable)
        strType.Append(L&quot; NOT NULL &quot;);
    if (bIsUnique)
        strType.Append(L&quot; UNIQUE &quot;);

    return hr;
}

T_CCI_A_TYPE GetCASTypeA(DBTYPE wType)
{
    switch(wType)
    {
    case DBTYPE_I1:
    case DBTYPE_I2:
    case DBTYPE_I4:
    case DBTYPE_UI1:
    case DBTYPE_UI2:
    case DBTYPE_UI4:
        return CCI_A_TYPE_INT;
    case DBTYPE_I8:
    case DBTYPE_UI8:
        return CCI_A_TYPE_BIGINT;
    case DBTYPE_R4:
        return CCI_A_TYPE_FLOAT;
    case DBTYPE_R8:
        return CCI_A_TYPE_DOUBLE;
    case DBTYPE_BOOL:
    case DBTYPE_BYTES:
        return CCI_A_TYPE_BIT;
    case DBTYPE_DECIMAL:
    case DBTYPE_NUMERIC: 
    case DBTYPE_WSTR:
    case DBTYPE_BSTR:
    case DBTYPE_STR:
        return CCI_A_TYPE_STR;
    case DBTYPE_DBDATE:
    case DBTYPE_DBTIME:
    case DBTYPE_DBTIMESTAMP:
        return CCI_A_TYPE_DATE;
    }
    return CCI_A_TYPE_FIRST;
}

T_CCI_U_TYPE GetCASTypeU(DBTYPE wType)
{
    switch(wType)
    {
    case DBTYPE_I1:
        return CCI_U_TYPE_CHAR;
    case DBTYPE_I2:
        return CCI_U_TYPE_SHORT;
    case DBTYPE_I4:
        return CCI_U_TYPE_INT;
    case DBTYPE_R4:
        return CCI_U_TYPE_FLOAT;
    case DBTYPE_R8:
        return CCI_U_TYPE_DOUBLE;
    case DBTYPE_BOOL:
    case DBTYPE_BYTES:
        return CCI_U_TYPE_BIT;
    case DBTYPE_UI2:
    case DBTYPE_UI4:
    case DBTYPE_UI8:
    case DBTYPE_DECIMAL:
    case DBTYPE_NUMERIC:
        return CCI_U_TYPE_NUMERIC;
    case DBTYPE_DBDATE:
        return CCI_U_TYPE_DATE;
    case DBTYPE_DBTIME:
        return CCI_U_TYPE_TIME;
    case DBTYPE_DBTIMESTAMP:
        return CCI_U_TYPE_TIMESTAMP;
    case DBTYPE_BSTR: 
    case DBTYPE_WSTR:
        return CCI_U_TYPE_NCHAR;
    case DBTYPE_STR:
        return CCI_U_TYPE_STRING;             
    }
    return CCI_U_TYPE_UNKNOWN;
}

HRESULT OLEDBValueToCCIValue(DBTYPE wType, T_CCI_A_TYPE* aType, T_CCI_U_TYPE* uType,
        void *pValue, DBLENGTH dwLength, void** dstValue, DBSTATUS* status, const CComPtr&lt;IDataConvert&gt; &amp;spConvert)
{
    if(pValue==NULL) return E_FAIL;
    
    switch(wType)
    {
    case DBTYPE_UI1:
    case DBTYPE_I1:
        *dstValue = CoTaskMemAlloc(sizeof(int));
        *(int*)*dstValue = *(BYTE*)pValue;
        break;
    case DBTYPE_I2: 
        *dstValue = CoTaskMemAlloc(sizeof(int));
        *(int*)*dstValue = *(short*)pValue;
        break;
    case DBTYPE_I4:
        *dstValue = CoTaskMemAlloc(sizeof(int));
        *(int*)*dstValue = *(int*)pValue;
        break;
    case DBTYPE_I8:
        /*
        value = CoTaskMemAlloc(sizeof(LONGLONG));
        *(LONGLONG*)value = *(LONGLONG*)pValue;
        break;  
        */
        *status = DBSTATUS_E_DATAOVERFLOW;
        return DB_E_ERRORSOCCURRED;
    case DBTYPE_R4: 
        *dstValue = CoTaskMemAlloc(sizeof(float));
        *(float*)*dstValue = *(float*)pValue;
        break;  
    case DBTYPE_R8:
        *dstValue = CoTaskMemAlloc(sizeof(double));
        *(double*)*dstValue = *(double*)pValue;
        break;
    case DBTYPE_BOOL:
        *dstValue = CoTaskMemAlloc(sizeof(VARIANT));
        ((VARIANT *)*dstValue)-&gt;boolVal = ((VARIANT *)pValue)-&gt;boolVal;
        break;
    case DBTYPE_BYTES:
        *dstValue = CoTaskMemAlloc(sizeof(T_CCI_BIT));
        ((T_CCI_BIT *)*dstValue)-&gt;size = (int)dwLength;
        ((T_CCI_BIT *)*dstValue)-&gt;buf = 0;
        if(pValue &amp;&amp; dwLength&gt;0)
        {
            ((T_CCI_BIT *)*dstValue)-&gt;buf = (char *)CoTaskMemAlloc(dwLength);
            memcpy(((T_CCI_BIT *)*dstValue)-&gt;buf, pValue, dwLength);
        }
        break;
    case DBTYPE_BSTR:
    case DBTYPE_WSTR:
        /*{
        WCHAR *src = (WCHAR *)pValue;
        DBLENGTH DstLen;
        DBSTATUS dbStat = DBSTATUS_S_OK;
        DBLENGTH cbMaxLen = dwLength + 1;
        *dstValue = CoTaskMemAlloc(cbMaxLen + 1);
        HRESULT hr = spConvert-&gt;DataConvert(wType, DBTYPE_STR, dwLength, &amp;DstLen,
            src, *dstValue, cbMaxLen, dbStat, &amp;dbStat, 0, 0, 0);
        if (FAILED(hr)) return hr;
        }*/
        *dstValue = CoTaskMemAlloc((dwLength + 1) * sizeof(wchar_t));
        strcpy((char *)*dstValue, CW2A((wchar_t *)pValue));
        break;
    case DBTYPE_STR:
        /*{
        char *src = (char *)pValue;
        DBLENGTH DstLen;
        DBSTATUS dbStat = DBSTATUS_S_OK;
        DBLENGTH cbMaxLen = dwLength + 1;
        *dstValue = CoTaskMemAlloc(cbMaxLen + 1);
        HRESULT hr = spConvert-&gt;DataConvert(wType, DBTYPE_STR, dwLength, &amp;DstLen,
            src, *dstValue, cbMaxLen, dbStat, &amp;dbStat, 0, 0, 0);
        if (FAILED(hr)) return hr;
        }*/
        *dstValue = CoTaskMemAlloc((dwLength + 1) * sizeof(char));
        strcpy((char *)*dstValue, (char *)pValue);
        break;
    case DBTYPE_DBDATE:
        *dstValue = CoTaskMemAlloc(sizeof(T_CCI_DATE));
        ((T_CCI_DATE *)*dstValue)-&gt;yr = ((DBDATE *)pValue)-&gt;year;
        ((T_CCI_DATE *)*dstValue)-&gt;mon = ((DBDATE *)pValue)-&gt;month;
        ((T_CCI_DATE *)*dstValue)-&gt;day = ((DBDATE *)pValue)-&gt;day;
        break;
    case DBTYPE_DBTIME: 
        *dstValue = CoTaskMemAlloc(sizeof(T_CCI_DATE));
        ((T_CCI_DATE *)*dstValue)-&gt;hh = ((DBTIME *)pValue)-&gt;hour;
        ((T_CCI_DATE *)*dstValue)-&gt;mm = ((DBTIME *)pValue)-&gt;minute;
        ((T_CCI_DATE *)*dstValue)-&gt;ss = ((DBTIME *)pValue)-&gt;second;
        break;
    case DBTYPE_DBTIMESTAMP:
        *dstValue = CoTaskMemAlloc(sizeof(T_CCI_DATE));
        ((T_CCI_DATE *)*dstValue)-&gt;yr = ((DBTIMESTAMP *)pValue)-&gt;year;
        ((T_CCI_DATE *)*dstValue)-&gt;mon = ((DBTIMESTAMP *)pValue)-&gt;month;
        ((T_CCI_DATE *)*dstValue)-&gt;day = ((DBTIMESTAMP *)pValue)-&gt;day;
        ((T_CCI_DATE *)*dstValue)-&gt;hh = ((DBTIMESTAMP *)pValue)-&gt;hour;
        ((T_CCI_DATE *)*dstValue)-&gt;mm = ((DBTIMESTAMP *)pValue)-&gt;minute;
        ((T_CCI_DATE *)*dstValue)-&gt;ss = ((DBTIMESTAMP *)pValue)-&gt;second;
        break;
    case DBTYPE_DECIMAL:
    case DBTYPE_NUMERIC:
        {
            DB_NUMERIC *src = (DB_NUMERIC *)pValue;
            DBLENGTH DstLen;
            DBSTATUS dbStat = DBSTATUS_S_OK;
            DBLENGTH cbMaxLen = 41;
            *dstValue = CoTaskMemAlloc(cbMaxLen + 1);
            spConvert-&gt;DataConvert(DBTYPE_NUMERIC, DBTYPE_STR, sizeof(DB_NUMERIC), &amp;DstLen,
                src, *dstValue, cbMaxLen, dbStat, &amp;dbStat, src-&gt;precision, src-&gt;scale, 0);
        }
        break;
    case DBTYPE_VARIANT:
        {
            VARIANT* var = (VARIANT *)pValue;
            DBTYPE targetType = var-&gt;vt;
            DBLENGTH SrcLen = dwLength, DstLen;
            DBSTATUS dbStat = DBSTATUS_S_OK;
            DBLENGTH cbMaxLen = 0;

            switch (targetType)
            {
            case VT_UI1:
            case VT_I1:   
            case VT_I2:   
                            *dstValue = CoTaskMemAlloc(sizeof(short));
                            *aType = CCI_A_TYPE_INT;
                            *uType = CCI_U_TYPE_SHORT;
                            break;
            case VT_I4:
            case VT_INT:
            case VT_UINT:
                            *dstValue = CoTaskMemAlloc(sizeof(int));
                            *aType = CCI_A_TYPE_INT;
                            *uType = CCI_U_TYPE_INT;
                            break;
            case VT_I8:
                            *dstValue = CoTaskMemAlloc(sizeof(__int64));
                            *aType = CCI_A_TYPE_BIGINT;
                            *uType = CCI_U_TYPE_BIGINT;
                            break;
            case VT_R4:
                            *dstValue = CoTaskMemAlloc(sizeof(float));
                            *aType = CCI_A_TYPE_FLOAT;
                            *uType = CCI_U_TYPE_FLOAT;
                            break;
            case VT_R8:
                            *dstValue = CoTaskMemAlloc(sizeof(double));
                            *aType = CCI_A_TYPE_DOUBLE;
                            *uType = CCI_U_TYPE_DOUBLE;
                            break;
            case VT_DATE:
                            *dstValue = CoTaskMemAlloc(sizeof(T_CCI_DATE));
                            ((T_CCI_DATE *)*dstValue)-&gt;yr = ((DBTIMESTAMP *)pValue)-&gt;year;
                            ((T_CCI_DATE *)*dstValue)-&gt;mon = ((DBTIMESTAMP *)pValue)-&gt;month;
                            ((T_CCI_DATE *)*dstValue)-&gt;day = ((DBTIMESTAMP *)pValue)-&gt;day;
                            ((T_CCI_DATE *)*dstValue)-&gt;hh = ((DBTIMESTAMP *)pValue)-&gt;hour;
                            ((T_CCI_DATE *)*dstValue)-&gt;mm = ((DBTIMESTAMP *)pValue)-&gt;minute;
                            ((T_CCI_DATE *)*dstValue)-&gt;ss = ((DBTIMESTAMP *)pValue)-&gt;second;
                            *aType = CCI_A_TYPE_DATE;
                            *uType = CCI_U_TYPE_TIMESTAMP;
                            break;
            case VT_BSTR:   targetType = DBTYPE_STR;
                            *dstValue = CoTaskMemAlloc((2*dwLength) * sizeof(char) + 1);
                            dwLength *= 2;
                            cbMaxLen = dwLength + 1;
                            *aType = CCI_A_TYPE_STR;
                            *uType = CCI_U_TYPE_STRING;
                            break;
            case VT_DECIMAL:
                            DB_NUMERIC *src = (DB_NUMERIC *)pValue;
                            SrcLen = sizeof(DB_NUMERIC);
                            cbMaxLen = 41;
                            *dstValue = CoTaskMemAlloc(cbMaxLen + 1);
                            targetType = DBTYPE_STR;
                            *aType = CCI_A_TYPE_STR;
                            *uType = CCI_U_TYPE_NUMERIC;
            }
            
            if (targetType != VT_DATE)
            {
                HRESULT hr = spConvert-&gt;DataConvert(DBTYPE_VARIANT, targetType, SrcLen, &amp;DstLen,
                    var, *dstValue, cbMaxLen, dbStat, &amp;dbStat, 0, 0, 0);
                if (FAILED(hr)) return hr;
            }
        }
        break;
    }

    return S_OK;
}

DBTYPE GetOledbTypeFromName(LPCWSTR pwszName)
{
    const struct
    {
        LPCWSTR pwszName;
        DBTYPE wType;
    } types[] = {
        { L&quot;DBTYPE_I1&quot;, DBTYPE_I1 },        { L&quot;INTEGER(1)&quot;, DBTYPE_I1 },
        { L&quot;TINYINT&quot;, DBTYPE_I1 },

        { L&quot;DBTYPE_I2&quot;, DBTYPE_I2 },        { L&quot;INTEGER(2)&quot;, DBTYPE_I2 },
        { L&quot;AUTOINC(2)&quot;, DBTYPE_I2 },       { L&quot;SMALLINT&quot;, DBTYPE_I2 },
        { L&quot;SMALLINDENTITY&quot;, DBTYPE_I2 },   { L&quot;YEAR&quot;, DBTYPE_I2 },

        { L&quot;DBTYPE_I4&quot;, DBTYPE_I4 },        { L&quot;INTEGER(4)&quot;, DBTYPE_I4 },
        { L&quot;AUTOINC(4)&quot;, DBTYPE_I4 },       { L&quot;INTEGER&quot;, DBTYPE_I4 },
        { L&quot;MEDIUMINT&quot;, DBTYPE_I4 },        { L&quot;INT&quot;, DBTYPE_I4 },
        { L&quot;IDENTITY&quot;, DBTYPE_I4 },

        { L&quot;DBTYPE_I8&quot;, DBTYPE_I8 },        { L&quot;INTEGER(8)&quot;, DBTYPE_I8 },
        { L&quot;BIGINT&quot;, DBTYPE_I8 },

        { L&quot;DBTYPE_R4&quot;, DBTYPE_R4 },        { L&quot;FLOAT(4)&quot;, DBTYPE_R4 },
        { L&quot;BFLOAT(4)&quot;, DBTYPE_R4 },        { L&quot;REAL&quot;, DBTYPE_R4 },
        { L&quot;FLOAT&quot;, DBTYPE_R4 },            { L&quot;FLOAT UNSIGNED&quot;, DBTYPE_R4 },

        { L&quot;DBTYPE_R8&quot;, DBTYPE_R8 },        { L&quot;FLOAT(8)&quot;, DBTYPE_R8 },
        { L&quot;BFLOAT(8)&quot;, DBTYPE_R8 },        { L&quot;MONEY&quot;, DBTYPE_R8 },
        { L&quot;DECIMAL&quot;, DBTYPE_R8 },          { L&quot;DOUBLE&quot;, DBTYPE_R8 },
        { L&quot;DOUBLE UNSIGNED&quot;, DBTYPE_R8 },  { L&quot;DOUBLE PRECISION&quot;, DBTYPE_R8 },
        { L&quot;NUMERIC&quot;, DBTYPE_R8 },          { L&quot;NUMERICSA&quot;, DBTYPE_R8 },
        { L&quot;NUMERICSTS&quot;, DBTYPE_R8 },       { L&quot;MONETARY&quot;, DBTYPE_R8 },

        { L&quot;DBTYPE_CY&quot;, DBTYPE_CY },        { L&quot;CURRENCY&quot;, DBTYPE_CY },

        { L&quot;DBTYPE_BOOL&quot;, DBTYPE_BOOL },    { L&quot;LOGICAL&quot;, DBTYPE_BOOL },
        //{ L&quot;BIT&quot;, DBTYPE_BOOL },

        { L&quot;DBTYPE_UI1&quot;, DBTYPE_UI1 },      { L&quot;UNSIGNED(1)&quot;, DBTYPE_UI1 },
        { L&quot;UTINYINT&quot;, DBTYPE_UI1 },        { L&quot;TINYINT UNSIGNED&quot;, DBTYPE_UI1 },

        { L&quot;DBTYPE_UI2&quot;, DBTYPE_UI2 },      { L&quot;UNSIGNED(2)&quot;, DBTYPE_UI2 },
        { L&quot;USMALLINT&quot;, DBTYPE_UI2 },       { L&quot;SMALLINT UNSIGNED&quot;, DBTYPE_UI2 },

        { L&quot;DBTYPE_UI4&quot;, DBTYPE_UI4 },      { L&quot;UNSIGNED(4)&quot;, DBTYPE_UI4 },
        { L&quot;UINTEGER&quot;, DBTYPE_UI4 },        { L&quot;INTEGER UNSIGNED&quot;, DBTYPE_UI4 },
        { L&quot;MEDIUMINT UNSIGNED&quot;, DBTYPE_UI4 },

        { L&quot;DBTYPE_UI8&quot;, DBTYPE_UI8 },      { L&quot;UNSIGNED(8)&quot;, DBTYPE_UI8 },
        { L&quot;BIGINT UNSIGNED&quot;, DBTYPE_UI8 }, { L&quot;UBIGINT&quot;, DBTYPE_UI8 },

        { L&quot;DBTYPE_STR&quot;, DBTYPE_STR },      { L&quot;CHARACTER&quot;, DBTYPE_STR },
        { L&quot;LSTRING&quot;, DBTYPE_STR },         { L&quot;ZSTRING&quot;, DBTYPE_STR },
        { L&quot;NOTE&quot;, DBTYPE_STR },            { L&quot;CHAR&quot;, DBTYPE_STR },
        { L&quot;VARCHAR&quot;, DBTYPE_STR },         { L&quot;LONGVARCHAR&quot;, DBTYPE_STR },
        { L&quot;BLOB&quot;, DBTYPE_STR },            { L&quot;TINYBLOB&quot;, DBTYPE_STR },
        { L&quot;MEDIUMBLOB&quot;, DBTYPE_STR },      { L&quot;LONGBLOB&quot;, DBTYPE_STR },
        { L&quot;TEXT&quot;, DBTYPE_STR },            { L&quot;TINYTEXT&quot;, DBTYPE_STR },
        { L&quot;MEDIUMTEXT&quot;, DBTYPE_STR },      { L&quot;LONGTEXT&quot;, DBTYPE_STR },
        { L&quot;NULL&quot;, DBTYPE_STR },            { L&quot;ENUM&quot;, DBTYPE_STR },
        { L&quot;SET&quot;, DBTYPE_STR },

        { L&quot;NCHAR&quot;, DBTYPE_WSTR },          { L&quot;NCHAR VARYING&quot;, DBTYPE_WSTR },

        { L&quot;DBTYPE_BYTES&quot;, DBTYPE_BYTES },  { L&quot;LVAR&quot;, DBTYPE_BYTES },
        { L&quot;LONG VARBINARY&quot;, DBTYPE_BYTES },{ L&quot;LONGVARBINARY&quot;, DBTYPE_BYTES },
        { L&quot;BINARY&quot;, DBTYPE_BYTES },        { L&quot;BIT&quot;, DBTYPE_BYTES },
        { L&quot;BIT VARYING&quot;, DBTYPE_BYTES },

        { L&quot;DBTYPE_DBDATE&quot;, DBTYPE_DBDATE },{ L&quot;DATE&quot;, DBTYPE_DBDATE },

        { L&quot;DBTYPE_DBTIME&quot;, DBTYPE_DBTIME },{ L&quot;TIME&quot;, DBTYPE_DBTIME },

        { L&quot;DBTYPE_DBTIMESTAMP&quot;, DBTYPE_DBTIMESTAMP },
        { L&quot;TIMESTAMP&quot;, DBTYPE_DBTIMESTAMP },
        { L&quot;DATETIME&quot;, DBTYPE_DBTIMESTAMP },
    };

    if(pwszName==NULL) return DBTYPE_WSTR;

    for(int i=1;i&lt;sizeof(types)/sizeof(*types);i++)
    {
        if(_wcsicmp(pwszName, types[i].pwszName)==0)
            return types[i].wType;
    }

    return DBTYPE_STR;
}

static HRESULT CompareSTR(DBCOMPAREOP CompareOp, const char *szRowValue, const char *szFindValue)
{
    DBCOMPAREOP LocalOp = CompareOp &amp; ~DBCOMPAREOPS_CASESENSITIVE &amp; ~DBCOMPAREOPS_CASEINSENSITIVE;

    switch(LocalOp)
    {
    case DBCOMPAREOPS_LT:
    case DBCOMPAREOPS_LE:
    case DBCOMPAREOPS_EQ:
    case DBCOMPAREOPS_GE:
    case DBCOMPAREOPS_GT:
    case DBCOMPAREOPS_NE:
        {
            // 디폴트는 case sensitive
            int res;
            if(CompareOp &amp; DBCOMPAREOPS_CASEINSENSITIVE)
                res = _stricmp(szRowValue, szFindValue);
            else
                res = strcmp(szRowValue, szFindValue);

            if( ( LocalOp==DBCOMPAREOPS_LT &amp;&amp; res&lt; 0 ) ||
                ( LocalOp==DBCOMPAREOPS_LE &amp;&amp; res&lt;=0 ) ||
                ( LocalOp==DBCOMPAREOPS_EQ &amp;&amp; res==0 ) ||
                ( LocalOp==DBCOMPAREOPS_GE &amp;&amp; res&gt;=0 ) ||
                ( LocalOp==DBCOMPAREOPS_GT &amp;&amp; res&gt; 0 ) ||
                ( LocalOp==DBCOMPAREOPS_NE &amp;&amp; res!=0 ) )
                return S_OK;

            return S_FALSE;
        }

    case DBCOMPAREOPS_BEGINSWITH:
        {
            int res;
            size_t len = strlen(szFindValue);
            if(CompareOp &amp; DBCOMPAREOPS_CASEINSENSITIVE)
                res = _strnicmp(szRowValue, szFindValue, len);
            else
                res = strncmp(szRowValue, szFindValue, len);
            return res==0 ? S_OK : S_FALSE;
        }
    case DBCOMPAREOPS_NOTBEGINSWITH:
        {
            int res;
            size_t len = strlen(szFindValue);
            if(CompareOp &amp; DBCOMPAREOPS_CASEINSENSITIVE)
                res = _strnicmp(szRowValue, szFindValue, len);
            else
                res = strncmp(szRowValue, szFindValue, len);
            return res!=0 ? S_OK : S_FALSE;
        }

    // TODO: case insensitive
    case DBCOMPAREOPS_CONTAINS:
        {
            const char *res;
            if(CompareOp &amp; DBCOMPAREOPS_CASEINSENSITIVE)
            {
                CStringA row(szRowValue), find(szFindValue);
                row.MakeUpper(); find.MakeUpper();
                res = strstr(row, find);
            }
            else
                res = strstr(szRowValue, szFindValue);
            return res!=0 ? S_OK : S_FALSE;
        }
    case DBCOMPAREOPS_NOTCONTAINS:
        {
            const char *res;
            if(CompareOp &amp; DBCOMPAREOPS_CASEINSENSITIVE)
            {
                CStringA row(szRowValue), find(szFindValue);
                row.MakeUpper(); find.MakeUpper();
                res = strstr(row, find);
            }
            else
                res = strstr(szRowValue, szFindValue);
            return res==0 ? S_OK : S_FALSE;
        }
    }

    return DB_E_BADCOMPAREOP;
}

static HRESULT CompareI4(DBCOMPAREOP CompareOp, const char *szRowValue, const char *szFindValue)
{
    if( CompareOp!=DBCOMPAREOPS_LT &amp;&amp; CompareOp!=DBCOMPAREOPS_LE &amp;&amp;
        CompareOp!=DBCOMPAREOPS_EQ &amp;&amp; CompareOp!=DBCOMPAREOPS_NE &amp;&amp;
        CompareOp!=DBCOMPAREOPS_GE &amp;&amp; CompareOp!=DBCOMPAREOPS_GT )
        return DB_E_BADCOMPAREOP;

    int nRowValue = atoi(szRowValue);
    int nFindValue = atoi(szFindValue);

    if( ( CompareOp==DBCOMPAREOPS_LT &amp;&amp; nRowValue&lt; nFindValue ) ||
        ( CompareOp==DBCOMPAREOPS_LE &amp;&amp; nRowValue&lt;=nFindValue ) ||
        ( CompareOp==DBCOMPAREOPS_EQ &amp;&amp; nRowValue==nFindValue ) ||
        ( CompareOp==DBCOMPAREOPS_GE &amp;&amp; nRowValue&gt;=nFindValue ) ||
        ( CompareOp==DBCOMPAREOPS_GT &amp;&amp; nRowValue&gt; nFindValue ) ||
        ( CompareOp==DBCOMPAREOPS_NE &amp;&amp; nRowValue!=nFindValue ) )
        return S_OK;
    return S_FALSE;
}

static HRESULT CompareI2(DBCOMPAREOP CompareOp, const char *szRowValue, const char *szFindValue)
{
    if( CompareOp!=DBCOMPAREOPS_LT &amp;&amp; CompareOp!=DBCOMPAREOPS_LE &amp;&amp;
        CompareOp!=DBCOMPAREOPS_EQ &amp;&amp; CompareOp!=DBCOMPAREOPS_NE &amp;&amp;
        CompareOp!=DBCOMPAREOPS_GE &amp;&amp; CompareOp!=DBCOMPAREOPS_GT )
        return DB_E_BADCOMPAREOP;

    short nRowValue = (short)atoi(szRowValue);
    short nFindValue = (short)atoi(szFindValue);

    if( ( CompareOp==DBCOMPAREOPS_LT &amp;&amp; nRowValue&lt; nFindValue ) ||
        ( CompareOp==DBCOMPAREOPS_LE &amp;&amp; nRowValue&lt;=nFindValue ) ||
        ( CompareOp==DBCOMPAREOPS_EQ &amp;&amp; nRowValue==nFindValue ) ||
        ( CompareOp==DBCOMPAREOPS_GE &amp;&amp; nRowValue&gt;=nFindValue ) ||
        ( CompareOp==DBCOMPAREOPS_GT &amp;&amp; nRowValue&gt; nFindValue ) ||
        ( CompareOp==DBCOMPAREOPS_NE &amp;&amp; nRowValue!=nFindValue ) )
        return S_OK;
    return S_FALSE;
}

static HRESULT CompareR4(DBCOMPAREOP CompareOp, const char *szRowValue, const char *szFindValue)
{
    if( CompareOp!=DBCOMPAREOPS_LT &amp;&amp; CompareOp!=DBCOMPAREOPS_LE &amp;&amp;
        CompareOp!=DBCOMPAREOPS_EQ &amp;&amp; CompareOp!=DBCOMPAREOPS_NE &amp;&amp;
        CompareOp!=DBCOMPAREOPS_GE &amp;&amp; CompareOp!=DBCOMPAREOPS_GT )
        return DB_E_BADCOMPAREOP;

    float fRowValue = (float)atof(szRowValue);
    float fFindValue = (float)atof(szFindValue);

    if( ( CompareOp==DBCOMPAREOPS_LT &amp;&amp; fRowValue&lt; fFindValue ) ||
        ( CompareOp==DBCOMPAREOPS_LE &amp;&amp; fRowValue&lt;=fFindValue ) ||
        ( CompareOp==DBCOMPAREOPS_EQ &amp;&amp; fRowValue==fFindValue ) ||
        ( CompareOp==DBCOMPAREOPS_GE &amp;&amp; fRowValue&gt;=fFindValue ) ||
        ( CompareOp==DBCOMPAREOPS_GT &amp;&amp; fRowValue&gt; fFindValue ) ||
        ( CompareOp==DBCOMPAREOPS_NE &amp;&amp; fRowValue!=fFindValue ) )
        return S_OK;
    return S_FALSE;
}

static HRESULT CompareR8(DBCOMPAREOP CompareOp, const char *szRowValue, const char *szFindValue)
{
    if( CompareOp!=DBCOMPAREOPS_LT &amp;&amp; CompareOp!=DBCOMPAREOPS_LE &amp;&amp;
        CompareOp!=DBCOMPAREOPS_EQ &amp;&amp; CompareOp!=DBCOMPAREOPS_NE &amp;&amp;
        CompareOp!=DBCOMPAREOPS_GE &amp;&amp; CompareOp!=DBCOMPAREOPS_GT )
        return DB_E_BADCOMPAREOP;

    double dRowValue = atof(szRowValue);
    double dFindValue = atof(szFindValue);

    if( ( CompareOp==DBCOMPAREOPS_LT &amp;&amp; dRowValue&lt; dFindValue ) ||
        ( CompareOp==DBCOMPAREOPS_LE &amp;&amp; dRowValue&lt;=dFindValue ) ||
        ( CompareOp==DBCOMPAREOPS_EQ &amp;&amp; dRowValue==dFindValue ) ||
        ( CompareOp==DBCOMPAREOPS_GE &amp;&amp; dRowValue&gt;=dFindValue ) ||
        ( CompareOp==DBCOMPAREOPS_GT &amp;&amp; dRowValue&gt; dFindValue ) ||
        ( CompareOp==DBCOMPAREOPS_NE &amp;&amp; dRowValue!=dFindValue ) )
        return S_OK;
    return S_FALSE;
}

HRESULT Compare(DBCOMPAREOP CompareOp, DBTYPE wType, const char *szRowValue, const char *szFindValue)
{
    switch(wType)
    {
    case DBTYPE_STR:
    case DBTYPE_WSTR:
        return CompareSTR(CompareOp, szRowValue, szFindValue);
        break;

    case DBTYPE_I4:
        return CompareI4(CompareOp, szRowValue, szFindValue);

    case DBTYPE_I2:
        return CompareI2(CompareOp, szRowValue, szFindValue);

    case DBTYPE_R4:
        return CompareR4(CompareOp, szRowValue, szFindValue);

    case DBTYPE_R8:
        return CompareR8(CompareOp, szRowValue, szFindValue);

    default:
        return DB_E_BADCOMPAREOP;
        break;
    }
}

long GetFindCompareOps(DBTYPE wType)
{
    switch(wType)
    {
    case DBTYPE_STR:
    case DBTYPE_WSTR:
        return DBPROPVAL_CO_EQUALITY | DBPROPVAL_CO_STRING | DBPROPVAL_CO_CONTAINS
                | DBPROPVAL_CO_BEGINSWITH | DBPROPVAL_CO_CASEINSENSITIVE;
    case DBTYPE_I4:
    case DBTYPE_I2:
    case DBTYPE_R4:
    case DBTYPE_R8:
        return DBPROPVAL_CO_EQUALITY;
    }
    return 0;
}

// 원래 VARIANT_BOOL은 VARIANT_TRUE와 VARIANT_FALSE만을 갖지만 1을 가지는 경우도 있다.
// 이경우 GetDBStatus에서 DBSTATUS_S_ISNULL을 반환하고, 값은 무시되므로 괜찮다.
static StaticTypeInfo static_type_infos[] = {
    // CCI type,           OLEDB type,     size, prefix, suffix, case sensitive, searchable,        unsigned,      fixed length,  long,          fixed p&amp;s
    { CCI_U_TYPE_UNKNOWN,  DBTYPE_STR,  4000, L&quot;&quot;,   L&quot;&quot;,  VARIANT_TRUE, DB_SEARCHABLE,    1,             VARIANT_FALSE, VARIANT_FALSE, VARIANT_TRUE  },
    { CCI_U_TYPE_CHAR,     DBTYPE_STR,  1073741823, L&quot;&#39;&quot;,  L&quot;&#39;&quot;, VARIANT_TRUE,  DB_SEARCHABLE,      1,             VARIANT_TRUE,  VARIANT_TRUE,  VARIANT_TRUE  },
    { CCI_U_TYPE_STRING,   DBTYPE_STR,  1073741823, L&quot;&#39;&quot;,  L&quot;&#39;&quot;, VARIANT_TRUE,  DB_SEARCHABLE,      1,             VARIANT_FALSE, VARIANT_TRUE,  VARIANT_TRUE  },
    // TODO: NCHAR와 WSTR은 좀 차이가 있다. 그래서 문제가 생길 여지가 좀 있는데
    //       그렇다고 STR으로 할 수는 없어서, WSTR으로 한다.
    { CCI_U_TYPE_NCHAR,    DBTYPE_WSTR,  536870911/2, L&quot;N&#39;&quot;, L&quot;&#39;&quot;, VARIANT_TRUE,  DB_SEARCHABLE,      1,             VARIANT_TRUE,  VARIANT_TRUE,  VARIANT_TRUE  },
    { CCI_U_TYPE_VARNCHAR, DBTYPE_WSTR,  536870911/2, L&quot;N&#39;&quot;, L&quot;&#39;&quot;, VARIANT_TRUE,  DB_SEARCHABLE,      1,             VARIANT_FALSE, VARIANT_TRUE,  VARIANT_TRUE  },
    // TODO: 크기를 1073741823로 해야 하는지, 268435455 또는 134217727으로 해야 하는지 모르겠음
    //       LTM에서는 &#39;F111...&#39;과 같은 데이터를 만들어서 prefix는 16진수를 쓰는 걸로 함
    { CCI_U_TYPE_BIT,     DBTYPE_BYTES, 1073741823, L&quot;X&#39;&quot;, L&quot;&#39;&quot;, VARIANT_FALSE, DB_ALL_EXCEPT_LIKE, 1,             VARIANT_TRUE,  VARIANT_TRUE,  VARIANT_TRUE  },
    { CCI_U_TYPE_VARBIT,  DBTYPE_BYTES, 1073741823, L&quot;X&#39;&quot;, L&quot;&#39;&quot;, VARIANT_FALSE, DB_ALL_EXCEPT_LIKE, 1,             VARIANT_FALSE, VARIANT_TRUE,  VARIANT_TRUE  },
    { CCI_U_TYPE_NUMERIC,  DBTYPE_NUMERIC,      38, L&quot;&quot;,   L&quot;&quot;,  VARIANT_FALSE, DB_ALL_EXCEPT_LIKE, VARIANT_FALSE, VARIANT_FALSE, VARIANT_FALSE, VARIANT_TRUE  },
    { CCI_U_TYPE_INT,      DBTYPE_I4,           10, L&quot;&quot;,   L&quot;&quot;,  VARIANT_FALSE, DB_ALL_EXCEPT_LIKE, VARIANT_FALSE, VARIANT_TRUE,  VARIANT_FALSE, VARIANT_TRUE  },
    { CCI_U_TYPE_SHORT,    DBTYPE_I2,            5, L&quot;&quot;,   L&quot;&quot;,  VARIANT_FALSE, DB_ALL_EXCEPT_LIKE, VARIANT_FALSE, VARIANT_TRUE,  VARIANT_FALSE, VARIANT_TRUE  },
    { CCI_U_TYPE_MONETARY, DBTYPE_R8,           15, L&quot;&quot;,   L&quot;&quot;,  VARIANT_FALSE, DB_ALL_EXCEPT_LIKE, VARIANT_FALSE, VARIANT_TRUE,  VARIANT_FALSE, VARIANT_FALSE },
    { CCI_U_TYPE_FLOAT,    DBTYPE_R4,            7, L&quot;&quot;,   L&quot;&quot;,  VARIANT_FALSE, DB_ALL_EXCEPT_LIKE, VARIANT_FALSE, VARIANT_TRUE,  VARIANT_FALSE, VARIANT_FALSE },
    { CCI_U_TYPE_DOUBLE,   DBTYPE_R8,           15, L&quot;&quot;,   L&quot;&quot;,  VARIANT_FALSE, DB_ALL_EXCEPT_LIKE, VARIANT_FALSE, VARIANT_TRUE,  VARIANT_FALSE, VARIANT_FALSE },
    { CCI_U_TYPE_DATE,     DBTYPE_DBDATE,       10, L&quot;&#39;&quot;,  L&quot;&#39;&quot;, VARIANT_FALSE, DB_ALL_EXCEPT_LIKE, 1,             VARIANT_TRUE,  VARIANT_FALSE, VARIANT_TRUE  },
    // NOTE: time의 &#39;am&#39;, &#39;pm&#39; 자리까지 생각해서 size를 정하면
  //       LTM은 1/100초 자리로 생각을 함. 그래서 뺌
    { CCI_U_TYPE_TIME,     DBTYPE_DBTIME,        8, L&quot;&#39;&quot;,  L&quot;&#39;&quot;, VARIANT_FALSE, DB_ALL_EXCEPT_LIKE, 1,             VARIANT_TRUE,  VARIANT_FALSE, VARIANT_TRUE  },
    { CCI_U_TYPE_TIMESTAMP, DBTYPE_DBTIMESTAMP, 19, L&quot;&#39;&quot;,  L&quot;&#39;&quot;, VARIANT_FALSE, DB_ALL_EXCEPT_LIKE, 1,             VARIANT_TRUE,  VARIANT_FALSE, VARIANT_TRUE  },
    // TODO: mapping to DBTYPE_IUnknown?
    { CCI_U_TYPE_OBJECT,   DBTYPE_STR,  1073741823, L&quot;&#39;&quot;,  L&quot;&#39;&quot;, VARIANT_TRUE,  DB_SEARCHABLE,      1,             VARIANT_FALSE, VARIANT_TRUE,  VARIANT_TRUE  },
    { CCI_U_TYPE_MULTISET,   DBTYPE_STR,  1073741823, L&quot;&#39;&quot;,  L&quot;&#39;&quot;, VARIANT_TRUE,  DB_SEARCHABLE,      1,             VARIANT_FALSE, VARIANT_TRUE,  VARIANT_TRUE  },
    { CCI_U_TYPE_SET,   DBTYPE_STR,  1073741823, L&quot;&#39;&quot;,  L&quot;&#39;&quot;, VARIANT_TRUE,  DB_SEARCHABLE,      1,             VARIANT_FALSE, VARIANT_TRUE,  VARIANT_TRUE  },
};

const StaticTypeInfo &amp;GetStaticTypeInfo(T_CCI_U_TYPE nCCIUType)
{
    for(int i=1;i&lt;sizeof(static_type_infos)/sizeof(*static_type_infos);i++)
    {
        if(static_type_infos[i].nCCIUType==nCCIUType)
            return static_type_infos[i];
    }
    return static_type_infos[0];
}

DynamicTypeInfo GetDynamicTypeInfo(T_CCI_U_TYPE nCCIUType, int nPrecision, int nScale, bool bNullable)
{
    /* 스펙엔 &#39;this is the size of the data type&#39;라고 되어 있어서
     * ulColumnSize = StaticTypeInfo::ulSize (문자열로 봤을 때의 길이) 라고 생각했으나
     * LTM을 보니 저장공간의 크기를 말하는 것 같다.
     */
    DynamicTypeInfo dyn_info;
    const StaticTypeInfo &amp;sta_info = GetStaticTypeInfo(nCCIUType);

    dyn_info.ulFlags = 0;
    dyn_info.ulFlags |= DBCOLUMNFLAGS_WRITEUNKNOWN;
    dyn_info.ulFlags |= DBCOLUMNFLAGS_ISFIXEDLENGTH;
    if(bNullable)
        dyn_info.ulFlags |= DBCOLUMNFLAGS_ISNULLABLE | DBCOLUMNFLAGS_MAYBENULL;
    dyn_info.ulColumnSize = (ULONG)~0;
    dyn_info.bPrecision = ~0;
    dyn_info.bScale = ~0;
    dyn_info.ulCharMaxLength = (ULONG)~0;
    dyn_info.ulCharOctetLength = (ULONG)~0;
    dyn_info.nNumericPrecision = (USHORT)~0;
    dyn_info.nNumericScale = -1;
    dyn_info.ulDateTimePrecision = (ULONG)~0;

    switch(nCCIUType)
    {
    case CCI_U_TYPE_STRING:
    case CCI_U_TYPE_VARNCHAR:
        dyn_info.ulFlags &amp;= ~DBCOLUMNFLAGS_ISFIXEDLENGTH; // 주의 break 없음
    case CCI_U_TYPE_CHAR:
    case CCI_U_TYPE_NCHAR:
        if(nCCIUType==CCI_U_TYPE_VARNCHAR || nCCIUType==CCI_U_TYPE_NCHAR)
            dyn_info.ulColumnSize = nPrecision / 2;
        else
            dyn_info.ulColumnSize = nPrecision;

        dyn_info.ulCharMaxLength = dyn_info.ulColumnSize;
        dyn_info.ulCharOctetLength = dyn_info.ulCharMaxLength;
        if(nCCIUType==CCI_U_TYPE_VARNCHAR || nCCIUType==CCI_U_TYPE_NCHAR)
        {
            dyn_info.ulCharOctetLength *= 2; // TODO: 좀 다르긴 하지만 LTM을 위해 일단 2배를 한다.
        }
        break;

    case CCI_U_TYPE_VARBIT:
        dyn_info.ulFlags &amp;= ~DBCOLUMNFLAGS_ISFIXEDLENGTH; // 주의 break 없음
    case CCI_U_TYPE_BIT:
        // TODO: Maximum length니까 올림을 하는게 맞을 것 같은데, 하면 LTM은
        //       BYTE단위로 데이터를 만들어서 BIT로 보면 초과해서 에러가 난다.
        dyn_info.ulColumnSize = (int)(nPrecision/8);
        dyn_info.ulCharMaxLength = dyn_info.ulColumnSize;
        dyn_info.ulCharOctetLength = dyn_info.ulCharMaxLength;
        break;

    case CCI_U_TYPE_NUMERIC:
        dyn_info.ulColumnSize = sizeof(DB_NUMERIC);
        dyn_info.bPrecision = nPrecision;
        dyn_info.bScale = nScale;
        dyn_info.nNumericPrecision = dyn_info.bPrecision;
        dyn_info.nNumericScale = dyn_info.bScale;
        break;

    case CCI_U_TYPE_INT:
        dyn_info.ulColumnSize = 4;
        dyn_info.bPrecision = (BYTE)sta_info.ulSize;
        dyn_info.nNumericPrecision = dyn_info.bPrecision;
        break;

    case CCI_U_TYPE_SHORT:
        dyn_info.ulColumnSize = 2;
        dyn_info.bPrecision = (BYTE)sta_info.ulSize;
        dyn_info.nNumericPrecision = dyn_info.bPrecision;
        break;

    case CCI_U_TYPE_MONETARY:
        dyn_info.ulColumnSize = sizeof(double);
        dyn_info.bPrecision = (BYTE)sta_info.ulSize;
        dyn_info.nNumericPrecision = dyn_info.bPrecision;
        break;

    case CCI_U_TYPE_FLOAT:
        dyn_info.ulColumnSize = sizeof(float);
        dyn_info.bPrecision = (BYTE)sta_info.ulSize;
        dyn_info.nNumericPrecision = dyn_info.bPrecision;
        break;

    case CCI_U_TYPE_DOUBLE:
        dyn_info.ulColumnSize = sizeof(double);
        dyn_info.bPrecision = (BYTE)sta_info.ulSize;
        dyn_info.nNumericPrecision = dyn_info.bPrecision;
        break;

    case CCI_U_TYPE_DATE:
        dyn_info.ulColumnSize = sizeof(DBDATE);
        break;

    case CCI_U_TYPE_TIME:
        dyn_info.ulColumnSize = sizeof(DBTIME);
        break;

    case CCI_U_TYPE_TIMESTAMP:
        dyn_info.ulColumnSize = sizeof(DBTIMESTAMP);
        dyn_info.bPrecision = (BYTE)sta_info.ulSize;
        dyn_info.bScale = 0;
        dyn_info.ulDateTimePrecision = dyn_info.bScale;
        break;

    case CCI_U_TYPE_OBJECT:
        //dyn_info.ulColumnSize = nPrecision;
        //OID 스트링 max length를 15로 보고 수정
        dyn_info.ulColumnSize = 15;
        dyn_info.ulCharMaxLength = dyn_info.ulColumnSize;
        dyn_info.ulCharOctetLength = dyn_info.ulCharMaxLength;
        break;

    case CCI_U_TYPE_SET:
    case CCI_U_TYPE_MULTISET:
        ATLTRACE(atlTraceDBProvider, 2, _T(&quot;Here!!\n&quot;));
        dyn_info.ulColumnSize = nPrecision;
        dyn_info.ulCharMaxLength = dyn_info.ulColumnSize;
        dyn_info.ulCharOctetLength = dyn_info.ulCharMaxLength;
        break;
    default:
        dyn_info.ulColumnSize = sta_info.ulSize;
        dyn_info.ulCharMaxLength = sta_info.ulSize;
        dyn_info.ulCharOctetLength = sta_info.ulSize;
        break;
    }

    if(dyn_info.ulColumnSize&gt;8000) // 8000은 atldbcli.h의 CDynamicAccessor가 쓰는 값
        dyn_info.ulFlags |= DBCOLUMNFLAGS_ISLONG;

    return dyn_info;
}

static HRESULT GetTableInfo_FetchData(int hReq, TableInfo &amp;info)
{
    char *strval;
    int intval, ind, res;
    T_CCI_ERROR err_buf;

    res = cci_fetch(hReq, &amp;err_buf);
    if(res&lt;0) return E_FAIL;

    res = cci_get_data(hReq, 12, CCI_A_TYPE_STR, &amp;strval, &amp;ind);
    if(res&lt;0) return E_FAIL;
    info.strSourceClass = CA2W(strval);

    res = cci_get_data(hReq, 10, CCI_A_TYPE_INT, &amp;intval, &amp;ind);
    if(res&lt;0) return E_FAIL;
    info.iOrdinal = intval;

    res = cci_get_data(hReq, 8, CCI_A_TYPE_INT, &amp;intval, &amp;ind);
    if(res&lt;0) return E_FAIL;
    info.bIsUnique = (intval==1);
    ::VariantClear(&amp;info.varDefault);
    res = cci_get_data(hReq, 9, CCI_A_TYPE_STR, &amp;strval, &amp;ind);
    if(res&lt;0) return E_FAIL;
    if(ind!=-1)
    {
        CComVariant var = strval;
        var.Detach(&amp;info.varDefault);
    }

    return S_OK;
}

HRESULT GetTableInfo(int hConn, char *szTableName, CAtlArray&lt;TableInfo&gt; &amp;infos)
{
    // 기존의 데이터 모두 삭제
    infos.RemoveAll();

    T_CCI_ERROR err_buf;
    int hReq = cci_schema_info(hConn, CCI_SCH_ATTRIBUTE, szTableName, NULL,
                    CCI_CLASS_NAME_PATTERN_MATCH | CCI_ATTR_NAME_PATTERN_MATCH, &amp;err_buf);
    if(hReq&lt;0)
    {
        ATLTRACE2(&quot;GetTableInfo: cci_schema_info fail\n&quot;);
        return E_FAIL;
    }

    int res = cci_cursor(hReq, 1, CCI_CURSOR_FIRST, &amp;err_buf);
    if(res==CCI_ER_NO_MORE_DATA) goto done;
    if(res&lt;0) goto error;

    size_t cur = 0;
    while(1)
    {
        infos.SetCount(infos.GetCount()+1);
        HRESULT hr = GetTableInfo_FetchData(hReq, infos[cur]);
        if(FAILED(hr)) goto error;

        res = cci_cursor(hReq, 1, CCI_CURSOR_CURRENT, &amp;err_buf);
        if(res==CCI_ER_NO_MORE_DATA) goto done;
        if(res&lt;0) goto error;

        cur++;
    }

error:
    ATLTRACE2(&quot;GetTableInfo: fail to fetch data\n&quot;);
    cci_close_req_handle(hReq);
    infos.RemoveAll();
    return E_FAIL;
done:
    cci_close_req_handle(hReq);
    return S_OK;
}

}

/*
create table ztest (c1 char, c2 char(20), c3 varchar, c4 varchar(20), c5 nchar, c6 nchar(20),
c7 nchar varying, c8 nchar varying(20), c9 bit, c10 bit(20), c11 bit varying, c12 bit varying(20),
c13 numeric, c14 numeric(10), c15 numeric(15,8), c16 int, c17 smallint, c18 float, c19 float(5),
c20 float(14), c21 double, c22 monetary, c23 date, c24 time, c25 timestamp, c26 set(varchar(20), int),
c27 set(), c28 multiset(float, int), c29 list(float,int), c30 sequence())

***** cci_schema_info의 결과값 *****
name, domain, scale, precision, indexed, non_null, shared, unique, default, attr_order, class_name, source_class
c1  1   0   1           0   0   0   0   null    1   ztest   ztest   : character(1)
c2  1   0   20          0   0   0   0   null    2   ztest   ztest   : character(20)
c3  2   0   1073741823  0   0   0   0   null    3   ztest   ztest   : character varying(1073741823)
c4  2   0   20          0   0   0   0   null    4   ztest   ztest   : character varying(20)
c5  3   0   1           0   0   0   0   null    5   ztest   ztest   : national character(1)
c6  3   0   20          0   0   0   0   null    6   ztest   ztest   : national character(20)
c7  4   0   536870911   0   0   0   0   null    7   ztest   ztest   : national character varying(536870911)
c8  4   0   20          0   0   0   0   null    8   ztest   ztest   : national character varying(20)
c9  5   0   1           0   0   0   0   null    9   ztest   ztest   : bit(1)
c10 5   0   20          0   0   0   0   null    10  ztest   ztest   : bit(20)
c11 6   0   1073741823  0   0   0   0   null    11  ztest   ztest   : bit varying(1073741823)
c12 6   0   20          0   0   0   0   null    12  ztest   ztest   : bit varying(20)
c13 7   0   15          0   0   0   0   null    13  ztest   ztest   : numeric(15,0)
c14 7   0   10          0   0   0   0   null    14  ztest   ztest   : numeric(10,0)
c15 7   8   15          0   0   0   0   null    15  ztest   ztest   : numeric(15,8)
c16 8   0   0           0   0   0   0   null    16  ztest   ztest   : integer
c17 9   0   0           0   0   0   0   null    17  ztest   ztest   : smallint
c18 11  0   0           0   0   0   0   null    18  ztest   ztest   : float
c19 11  0   0           0   0   0   0   null    19  ztest   ztest   : float
c20 11  0   0           0   0   0   0   null    20  ztest   ztest   : float
c21 12  0   0           0   0   0   0   null    21  ztest   ztest   : double
c22 10  0   0           0   0   0   0   null    22  ztest   ztest   : monetary
c23 13  0   0           0   0   0   0   null    23  ztest   ztest   : date
c24 14  0   0           0   0   0   0   null    24  ztest   ztest   : time
c25 15  0   0           0   0   0   0   null    25  ztest   ztest   : timestamp
c26 -1  0   0           0   0   0   0   null    26  ztest   ztest   : set_of(character varying(20), integer)
c27 -1  0   0           0   0   0   0   null    27  ztest   ztest   : set_of()
c28 -1  0   0           0   0   0   0   null    28  ztest   ztest   : multiset_of(float, integer)
c29 -1  0   0           0   0   0   0   null    29  ztest   ztest   : sequence_of(float, integer)
c30 -1  0   0           0   0   0   0   null    30  ztest   ztest   : sequence_of()

***** cci_get_result_info의 결과값 *****
type, is_non_null, scale, precision, col_name, real_attr, class_name
1   0   0   1           c1  null    ztest
1   0   0   20          c2  null    ztest
2   0   0   1073741823  c3  null    ztest
2   0   0   20          c4  null    ztest
3   0   0   1           c5  null    ztest
3   0   0   20          c6  null    ztest
4   0   0   536870911   c7  null    ztest
4   0   0   20          c8  null    ztest
5   0   0   1           c9  null    ztest
5   0   0   20          c10 null    ztest
6   0   0   1073741823  c11 null    ztest
6   0   0   20          c12 null    ztest
7   0   0   15          c13 null    ztest
7   0   0   10          c14 null    ztest
7   0   8   15          c15 null    ztest
8   0   0   0           c16 null    ztest
9   0   0   0           c17 null    ztest
11  0   0   0           c18 null    ztest
11  0   0   0           c19 null    ztest
11  0   0   0           c20 null    ztest
12  0   0   0           c21 null    ztest
10  0   0   0           c22 null    ztest
13  0   0   0           c23 null    ztest
14  0   0   0           c24 null    ztest
15  0   0   0           c25 null    ztest
-1  0   0   0           c26 null    ztest
-1  0   0   0           c27 null    ztest
-1  0   0   0           c28 null    ztest
-1  0   0   0           c29 null    ztest
-1  0   0   0           c30 null    ztest
*/
</span></div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        <span class="keywordflow">for</span> (ULONG <a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> = 0; <a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> &lt; cPropertySets; <a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        {</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;            <span class="keywordflow">if</span> (colDesc.rgPropertySets[<a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>].cProperties &amp;&amp;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                !colDesc.rgPropertySets[<a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>].rgProperties)</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                <span class="keywordflow">return</span> E_INVALIDARG;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;            <span class="keywordflow">if</span> (colDesc.rgPropertySets[<a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>].guidPropertySet == DBPROPSET_COLUMN)</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;            {</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;                ULONG numProp = colDesc.rgPropertySets[<a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>].cProperties;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;                <span class="keywordflow">for</span> (ULONG <a class="code" href="mprec_8c.html#abf2bc2545a4a5f5683d9ef3ed0d977e0">j</a> = 0; <a class="code" href="mprec_8c.html#abf2bc2545a4a5f5683d9ef3ed0d977e0">j</a> &lt; numProp; <a class="code" href="mprec_8c.html#abf2bc2545a4a5f5683d9ef3ed0d977e0">j</a>++)</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;                {</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;                    DBPROPID propID = colDesc.rgPropertySets[<a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>].rgProperties[<a class="code" href="mprec_8c.html#abf2bc2545a4a5f5683d9ef3ed0d977e0">j</a>].dwPropertyID;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;                    VARIANT val = colDesc.rgPropertySets[<a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>].rgProperties[<a class="code" href="mprec_8c.html#abf2bc2545a4a5f5683d9ef3ed0d977e0">j</a>].vValue;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;                    VARTYPE <a class="code" href="atldb__cubrid_8h.html#ad939da76b5d12fca40de18001582d63a">type</a> = colDesc.rgPropertySets[<a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>].rgProperties[<a class="code" href="mprec_8c.html#abf2bc2545a4a5f5683d9ef3ed0d977e0">j</a>].vValue.vt;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;                    DBPROPOPTIONS <a class="code" href="namespacebroker__log__top.html#a53d103cb6308629a5314cd78fa0a68b7">options</a> = colDesc.rgPropertySets[<a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>].rgProperties[<a class="code" href="mprec_8c.html#abf2bc2545a4a5f5683d9ef3ed0d977e0">j</a>].dwOptions;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;                    DBPROPSTATUS* <a class="code" href="expat_8h.html#ab89a24535d44e00f35e040a50104facf">status</a> = &amp;colDesc.rgPropertySets[<a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>].rgProperties[<a class="code" href="mprec_8c.html#abf2bc2545a4a5f5683d9ef3ed0d977e0">j</a>].dwStatus;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;                    </div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="namespacebroker__log__top.html#a53d103cb6308629a5314cd78fa0a68b7">options</a> != DBPROPOPTIONS_REQUIRED &amp;&amp;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;                        <a class="code" href="namespacebroker__log__top.html#a53d103cb6308629a5314cd78fa0a68b7">options</a> != DBPROPOPTIONS_OPTIONAL)</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;                    {</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;                        *<a class="code" href="expat_8h.html#ab89a24535d44e00f35e040a50104facf">status</a> = DBPROPSTATUS_BADOPTION;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;                        <span class="keywordflow">return</span> DB_E_ERRORSOCCURRED;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;                    }</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;                    <span class="comment">//프로퍼티에 맞는 타입인지 체크</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                    <span class="keywordflow">if</span> ((propID == DBPROP_COL_FIXEDLENGTH) ||</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                        (propID == DBPROP_COL_NULLABLE) ||</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                        (propID == DBPROP_COL_ISLONG) ||</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                        (propID == DBPROP_COL_PRIMARYKEY) ||</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                        (propID == DBPROP_COL_UNIQUE))</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                    {</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="atldb__cubrid_8h.html#ad939da76b5d12fca40de18001582d63a">type</a> != VT_BOOL) <span class="comment">//Type Error</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                        {</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                            *<a class="code" href="expat_8h.html#ab89a24535d44e00f35e040a50104facf">status</a> = DBPROPSTATUS_BADVALUE;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                            <span class="keywordflow">if</span> (<a class="code" href="namespacebroker__log__top.html#a53d103cb6308629a5314cd78fa0a68b7">options</a> == DBPROPOPTIONS_REQUIRED)</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                            {</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                                <span class="keywordflow">return</span> DB_E_ERRORSOCCURRED;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                            } <span class="keywordflow">else</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                                hr = DB_S_ERRORSOCCURRED;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                        } <span class="keywordflow">else</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                        {</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                            <span class="keywordflow">switch</span>(propID)</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                            {</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                            <span class="keywordflow">case</span> DBPROP_COL_FIXEDLENGTH:</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                                bIsFixedLength = (V_BOOL(&amp;val)==VARIANT_TRUE);</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                                *<a class="code" href="expat_8h.html#ab89a24535d44e00f35e040a50104facf">status</a> = DBPROPSTATUS_OK;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                            <span class="keywordflow">case</span> DBPROP_COL_NULLABLE:</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                                <span class="keywordflow">if</span> (bIsPrimaryKey)</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                                {</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                                    *<a class="code" href="expat_8h.html#ab89a24535d44e00f35e040a50104facf">status</a> = DBPROPSTATUS_CONFLICTING;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                                    <span class="keywordflow">if</span> (<a class="code" href="namespacebroker__log__top.html#a53d103cb6308629a5314cd78fa0a68b7">options</a> == DBPROPOPTIONS_REQUIRED)</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                                    {</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                                        <span class="keywordflow">return</span> DB_E_ERRORSOCCURRED;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                                    } <span class="keywordflow">else</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                                        hr = DB_S_ERRORSOCCURRED;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                                } <span class="keywordflow">else</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                                {</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                                    <span class="keywordflow">if</span> (V_BOOL(&amp;val)==VARIANT_FALSE)</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                                        bIsNullable = <span class="keyword">false</span>;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                                    *<a class="code" href="expat_8h.html#ab89a24535d44e00f35e040a50104facf">status</a> = DBPROPSTATUS_OK;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                                }</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                            <span class="keywordflow">case</span> DBPROP_COL_ISLONG:</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                                bIsLong = (V_BOOL(&amp;val)==VARIANT_TRUE);</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                                *<a class="code" href="expat_8h.html#ab89a24535d44e00f35e040a50104facf">status</a> = DBPROPSTATUS_OK;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                            <span class="keywordflow">case</span> DBPROP_COL_PRIMARYKEY:</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                                <span class="keywordflow">if</span> (bIsUnique || bHasDefault)</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                                {</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                                    *<a class="code" href="expat_8h.html#ab89a24535d44e00f35e040a50104facf">status</a> = DBPROPSTATUS_CONFLICTING;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                                    <span class="keywordflow">if</span> (<a class="code" href="namespacebroker__log__top.html#a53d103cb6308629a5314cd78fa0a68b7">options</a> == DBPROPOPTIONS_REQUIRED)</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                                    {</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                                        <span class="keywordflow">return</span> DB_E_ERRORSOCCURRED;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                                    } <span class="keywordflow">else</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                                        hr = DB_S_ERRORSOCCURRED;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;                                } <span class="keywordflow">else</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                                {</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                                    bIsPrimaryKey = (V_BOOL(&amp;val)==VARIANT_TRUE);</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                                    *<a class="code" href="expat_8h.html#ab89a24535d44e00f35e040a50104facf">status</a> = DBPROPSTATUS_OK;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                                }</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                            <span class="keywordflow">case</span> DBPROP_COL_UNIQUE:</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                                <span class="keywordflow">if</span> (bIsPrimaryKey)</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                                {</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                                    *<a class="code" href="expat_8h.html#ab89a24535d44e00f35e040a50104facf">status</a> = DBPROPSTATUS_CONFLICTING;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                                    <span class="keywordflow">if</span> (<a class="code" href="namespacebroker__log__top.html#a53d103cb6308629a5314cd78fa0a68b7">options</a> == DBPROPOPTIONS_REQUIRED)</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                                    {</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                                        <span class="keywordflow">return</span> DB_E_ERRORSOCCURRED;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                                    } <span class="keywordflow">else</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                                        hr = DB_S_ERRORSOCCURRED;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                                } <span class="keywordflow">else</span></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                                {</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                                    bIsUnique = (V_BOOL(&amp;val)==VARIANT_TRUE);</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                                    *<a class="code" href="expat_8h.html#ab89a24535d44e00f35e040a50104facf">status</a> = DBPROPSTATUS_OK;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                                }</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                            }</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                        }</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (propID == DBPROP_COL_DEFAULT)</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                    {</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                        <span class="keywordflow">if</span> (bIsPrimaryKey)</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                        {</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                            *<a class="code" href="expat_8h.html#ab89a24535d44e00f35e040a50104facf">status</a> = DBPROPSTATUS_CONFLICTING;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                            <span class="keywordflow">if</span> (<a class="code" href="namespacebroker__log__top.html#a53d103cb6308629a5314cd78fa0a68b7">options</a> == DBPROPOPTIONS_REQUIRED)</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                            {</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                                <span class="keywordflow">return</span> DB_E_ERRORSOCCURRED;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                            } <span class="keywordflow">else</span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                                hr = DB_S_ERRORSOCCURRED;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                        } <span class="keywordflow">else</span></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                        {</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                            CComVariant variant(val);</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                            <span class="keywordflow">if</span> (FAILED(variant.ChangeType(VT_BSTR)))</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                            {</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                                *<a class="code" href="expat_8h.html#ab89a24535d44e00f35e040a50104facf">status</a> = DBPROPSTATUS_BADVALUE;</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                                <span class="keywordflow">if</span> (<a class="code" href="namespacebroker__log__top.html#a53d103cb6308629a5314cd78fa0a68b7">options</a> == DBPROPOPTIONS_REQUIRED)</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                                {</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                                    <span class="keywordflow">return</span> DB_E_ERRORSOCCURRED;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                                } <span class="keywordflow">else</span></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                                    hr = DB_S_ERRORSOCCURRED;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                            } <span class="keywordflow">else</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                            {</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                                bHasDefault = <span class="keyword">true</span>;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                                defaultVal.Append(variant.bstrVal);</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                                *<a class="code" href="expat_8h.html#ab89a24535d44e00f35e040a50104facf">status</a> = DBPROPSTATUS_OK;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                            }</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                        }</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                    }</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                    <span class="keywordflow">else</span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                    {</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                        *<a class="code" href="expat_8h.html#ab89a24535d44e00f35e040a50104facf">status</a> = DBPROPSTATUS_NOTSUPPORTED;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                        <span class="keywordflow">if</span> (<a class="code" href="namespacebroker__log__top.html#a53d103cb6308629a5314cd78fa0a68b7">options</a> == DBPROPOPTIONS_REQUIRED)</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                            <span class="keywordflow">return</span> DB_E_ERRORSOCCURRED;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                        <span class="keywordflow">else</span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                            hr = DB_S_ERRORSOCCURRED;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                    }</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                }</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;            }</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;            {</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                <span class="keywordflow">for</span> (ULONG <a class="code" href="mprec_8c.html#abf2bc2545a4a5f5683d9ef3ed0d977e0">j</a> = 0; <a class="code" href="mprec_8c.html#abf2bc2545a4a5f5683d9ef3ed0d977e0">j</a> &lt; colDesc.rgPropertySets[<a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>].cProperties; <a class="code" href="mprec_8c.html#abf2bc2545a4a5f5683d9ef3ed0d977e0">j</a>++)</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                {</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                    colDesc.rgPropertySets[<a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>].rgProperties[<a class="code" href="mprec_8c.html#abf2bc2545a4a5f5683d9ef3ed0d977e0">j</a>].dwStatus = DBPROPSTATUS_NOTSUPPORTED;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                    <span class="keywordflow">if</span> (colDesc.rgPropertySets[<a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>].rgProperties[<a class="code" href="mprec_8c.html#abf2bc2545a4a5f5683d9ef3ed0d977e0">j</a>].dwOptions == DBPROPOPTIONS_REQUIRED)</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                        <span class="keywordflow">return</span> DB_E_ERRORSOCCURRED;</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                    <span class="keywordflow">else</span></div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                        hr = DB_S_ERRORSOCCURRED;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                }</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;            }</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        } </div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    }</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="keywordflow">if</span> (colDesc.pTypeInfo)</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        <span class="keywordflow">return</span> DB_E_BADTYPE;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="keywordflow">if</span> (colDesc.pwszTypeName &amp;&amp; wcslen(colDesc.pwszTypeName) &gt; 0)</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    {</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        <span class="comment">/* CUBRID Provider-Specific types</span></div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment">         L&quot;CHAR&quot;</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment">         L&quot;VARCHAR&quot;</span></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment">         L&quot;NCHAR&quot;</span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">         L&quot;NCHAR VARYING&quot;</span></div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment">         L&quot;BIT&quot;</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment">         L&quot;BIT VARYING&quot;</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment">         L&quot;NUMERIC&quot;</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment">         L&quot;INT&quot;</span></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment">         L&quot;SMALLINT&quot;</span></div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment">         L&quot;FLOAT&quot;</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="comment">         L&quot;DOUBLE&quot;</span></div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment">         L&quot;MONETARY&quot;</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment">         L&quot;DATE&quot;</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment">         L&quot;TIME&quot;</span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment">         L&quot;TIMESTAMP&quot;</span></div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment">        */</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        LPWSTR pwszTypeName = colDesc.pwszTypeName;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        DBLENGTH <a class="code" href="atldb__cubrid_8h.html#a080c6299f67db3aab5e21e5e45f9e90f">colSize</a> = colDesc.ulColumnSize;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812">T_CCI_U_TYPE</a> targetType;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        DBTYPE validType = <a class="code" href="namespaceType.html#aa499185608fd079c05b367ff02696c0f">GetOledbTypeFromName</a>(pwszTypeName);</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        <span class="keywordflow">if</span> (validType != colDesc.wType)</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;            <span class="keywordflow">return</span> DB_E_BADTYPE;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        <span class="keywordflow">if</span> (!_wcsicmp(pwszTypeName, L<span class="stringliteral">&quot;CHAR&quot;</span>) || !_wcsicmp(pwszTypeName, L<span class="stringliteral">&quot;VARCHAR&quot;</span>))</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        {</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;            <span class="keywordflow">if</span> (bIsFixedLength) targetType = <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a0005b45612de0477eee20270f01e84be">CCI_U_TYPE_CHAR</a>;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;            <span class="keywordflow">else</span> targetType = <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a17e9464e2c9d5dc2c753e99a4d1a0bd3">CCI_U_TYPE_STRING</a>;</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="atldb__cubrid_8h.html#a080c6299f67db3aab5e21e5e45f9e90f">colSize</a>)</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;            {</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                <a class="code" href="structType_1_1StaticTypeInfo.html">StaticTypeInfo</a> tInfo = <a class="code" href="namespaceType.html#a3f46b78f9ce3d04003861be8ab39eeec">GetStaticTypeInfo</a>(targetType);</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                <a class="code" href="atldb__cubrid_8h.html#a080c6299f67db3aab5e21e5e45f9e90f">colSize</a> = tInfo.<a class="code" href="structType_1_1StaticTypeInfo.html#a8016a345e7bd87d77131664400d01706">ulSize</a>;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;            }</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;            <span class="keywordflow">if</span> (bIsFixedLength) strType.Append(<span class="stringliteral">&quot;CHAR&quot;</span>);</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;            <span class="keywordflow">else</span> strType.Append(<span class="stringliteral">&quot;VARCHAR&quot;</span>);</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;            sprintf(strColSize, <span class="stringliteral">&quot;(%ld)&quot;</span>, <a class="code" href="atldb__cubrid_8h.html#a080c6299f67db3aab5e21e5e45f9e90f">colSize</a>);</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;            strType.Append(strColSize);</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!_wcsicmp(pwszTypeName, L<span class="stringliteral">&quot;NCHAR&quot;</span>) || !_wcsicmp(pwszTypeName, L<span class="stringliteral">&quot;NCHAR VARYING&quot;</span>))</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        {</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;            <span class="keywordflow">if</span> (bIsFixedLength) targetType = <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a2a9a7f31a26489fa99f9e188109ffbcd">CCI_U_TYPE_NCHAR</a>;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;            <span class="keywordflow">else</span> targetType = <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a1d55418f4dba6a23dd5da424c296eff1">CCI_U_TYPE_VARNCHAR</a>;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="atldb__cubrid_8h.html#a080c6299f67db3aab5e21e5e45f9e90f">colSize</a>)</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;            {</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                <a class="code" href="structType_1_1StaticTypeInfo.html">StaticTypeInfo</a> tInfo = <a class="code" href="namespaceType.html#a3f46b78f9ce3d04003861be8ab39eeec">GetStaticTypeInfo</a>(targetType);</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;                <a class="code" href="atldb__cubrid_8h.html#a080c6299f67db3aab5e21e5e45f9e90f">colSize</a> = tInfo.<a class="code" href="structType_1_1StaticTypeInfo.html#a8016a345e7bd87d77131664400d01706">ulSize</a>;</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;            } <span class="keywordflow">else</span></div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                <a class="code" href="atldb__cubrid_8h.html#a080c6299f67db3aab5e21e5e45f9e90f">colSize</a> *= 2;</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;            </div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;            <span class="keywordflow">if</span> (bIsFixedLength) strType.Append(<span class="stringliteral">&quot;NCHAR&quot;</span>);</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;            <span class="keywordflow">else</span> strType.Append(<span class="stringliteral">&quot;NCHAR VARYING&quot;</span>);</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;            sprintf(strColSize, <span class="stringliteral">&quot;(%ld)&quot;</span>, <a class="code" href="atldb__cubrid_8h.html#a080c6299f67db3aab5e21e5e45f9e90f">colSize</a>);</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;            strType.Append(strColSize);</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!_wcsicmp(pwszTypeName, L<span class="stringliteral">&quot;BIT&quot;</span>) || !_wcsicmp(pwszTypeName, L<span class="stringliteral">&quot;BIT VARYING&quot;</span>))</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        {</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;            <span class="keywordflow">if</span> (bIsFixedLength) targetType = <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a3331febb5322b5e1fc0b1aff9d4109c7">CCI_U_TYPE_BIT</a>;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;            <span class="keywordflow">else</span> targetType = <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a25875f983ab7c580ccdc55230fb27ce8">CCI_U_TYPE_VARBIT</a>;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="atldb__cubrid_8h.html#a080c6299f67db3aab5e21e5e45f9e90f">colSize</a>)</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;            {</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                <a class="code" href="structType_1_1StaticTypeInfo.html">StaticTypeInfo</a> tInfo = <a class="code" href="namespaceType.html#a3f46b78f9ce3d04003861be8ab39eeec">GetStaticTypeInfo</a>(targetType);</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                <a class="code" href="atldb__cubrid_8h.html#a080c6299f67db3aab5e21e5e45f9e90f">colSize</a> = tInfo.<a class="code" href="structType_1_1StaticTypeInfo.html#a8016a345e7bd87d77131664400d01706">ulSize</a>;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;            } <span class="keywordflow">else</span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                <a class="code" href="atldb__cubrid_8h.html#a080c6299f67db3aab5e21e5e45f9e90f">colSize</a> *= 8;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;            </div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;            <span class="keywordflow">if</span> (bIsFixedLength) strType.Append(<span class="stringliteral">&quot;BIT&quot;</span>);</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;            <span class="keywordflow">else</span> strType.Append(<span class="stringliteral">&quot;BIT VARYING&quot;</span>);</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;            sprintf(strColSize, <span class="stringliteral">&quot;(%u)&quot;</span>, <a class="code" href="atldb__cubrid_8h.html#a080c6299f67db3aab5e21e5e45f9e90f">colSize</a>);</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;            strType.Append(strColSize);</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!_wcsicmp(pwszTypeName, L<span class="stringliteral">&quot;NUMERIC&quot;</span>))</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        {</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;            <span class="keywordflow">if</span> (colDesc.bPrecision &lt; 1 || colDesc.bPrecision &gt; 38)</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;                <span class="keywordflow">return</span> DB_E_BADPRECISION;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;            <span class="keywordflow">if</span> (colDesc.bPrecision &lt; colDesc.bScale)</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                <span class="keywordflow">return</span> DB_E_BADSCALE;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;            strType.Append(pwszTypeName);</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;            sprintf(strColSize, <span class="stringliteral">&quot;(%ld,%ld)&quot;</span>, colDesc.bPrecision, colDesc.bScale);</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;            strType.Append(strColSize);</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!_wcsicmp(pwszTypeName, L<span class="stringliteral">&quot;INT&quot;</span>) || !_wcsicmp(pwszTypeName, L<span class="stringliteral">&quot;SMALLINT&quot;</span>) ||</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                    !_wcsicmp(pwszTypeName, L<span class="stringliteral">&quot;FLOAT&quot;</span>) || !_wcsicmp(pwszTypeName, L<span class="stringliteral">&quot;DOUBLE&quot;</span>) ||</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                    !_wcsicmp(pwszTypeName, L<span class="stringliteral">&quot;MONETARY&quot;</span>) || !_wcsicmp(pwszTypeName, L<span class="stringliteral">&quot;DATE&quot;</span>) ||</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;                    !_wcsicmp(pwszTypeName, L<span class="stringliteral">&quot;TIME&quot;</span>) || !_wcsicmp(pwszTypeName, L<span class="stringliteral">&quot;TIMESTAMP&quot;</span>))</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        {</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;            strType.Append(pwszTypeName);</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        }</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    } <span class="keywordflow">else</span></div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    {       </div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        uType = <a class="code" href="namespaceType.html#ac61886b1804c34091d0c90074fabe60a">GetCASTypeU</a>(colDesc.wType);</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        <span class="keywordflow">if</span> (uType == <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a816edf276f251f83824d11e32785920b">CCI_U_TYPE_UNKNOWN</a>)</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;            <span class="keywordflow">return</span> DB_E_BADTYPE;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        DBLENGTH <a class="code" href="atldb__cubrid_8h.html#a080c6299f67db3aab5e21e5e45f9e90f">colSize</a>;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        <span class="comment">//컬럼 사이즈가 0인 경우는 static type info에서 컬럼 사이즈를 가져온다         if (!colDesc.ulColumnSize)
        {
            StaticTypeInfo tInfo = GetStaticTypeInfo(uType);
            colSize = tInfo.ulSize;
        } else
            colSize = colDesc.ulColumnSize;

        switch (uType)
        {
        case CCI_U_TYPE_CHAR: 
            sprintf(strColSize, &quot;(%ld)&quot;, colSize);
            strType.Append(strColSize);
            break;
        case CCI_U_TYPE_STRING : 
            if (bIsFixedLength)
                strType.Append(L&quot;Char&quot;);
            else
                strType.Append(L&quot;Varchar&quot;);
            sprintf(strColSize, &quot;(%ld)&quot;, colSize);
            strType.Append(strColSize);
            break;
        case CCI_U_TYPE_NCHAR : 
            if (bIsFixedLength)
                strType.Append(L&quot;NChar&quot;);
            else
                strType.Append(L&quot;NChar Varying&quot;);

            //사용자가 원하는 길이의 두 배로 저장해야 한다
           if (colDesc.ulColumnSize)
                colSize *= 2;

            sprintf(strColSize, &quot;(%ld)&quot;, colSize);
            strType.Append(strColSize);
            break;
        case CCI_U_TYPE_BIT : 
            if (bIsFixedLength)
                strType.Append(L&quot;Bit&quot;);
            else
                strType.Append(L&quot;Bit Varying&quot;);

            //사용자가 원하는 길이의 여덟 배로 저장해야 한다
         if (colDesc.ulColumnSize)
                colSize *= 8;

            sprintf(strColSize, &quot;(%u)&quot;, colSize);
            strType.Append(strColSize);
            break;
        case CCI_U_TYPE_NUMERIC : 
            if (colDesc.bPrecision &lt; 1 || colDesc.bPrecision &gt; 38)
                return DB_E_BADPRECISION;

            if (colDesc.bPrecision &lt; colDesc.bScale)
                return DB_E_BADSCALE;

            strType.Append(L&quot;Numeric&quot;);
            sprintf(strColSize, &quot;(%ld,%ld)&quot;, colDesc.bPrecision, colDesc.bScale);
            strType.Append(strColSize);
            break;
        case CCI_U_TYPE_INT : strType.Append(L&quot;Integer&quot;);
            break;
        case CCI_U_TYPE_SHORT : strType.Append(L&quot;Smallint&quot;);
            break;
        case CCI_U_TYPE_MONETARY : strType.Append(L&quot;Monetary&quot;);
            break;
        case CCI_U_TYPE_FLOAT : strType.Append(L&quot;Float&quot;);
            break;
        case CCI_U_TYPE_DOUBLE : strType.Append(L&quot;Double&quot;);
            break;
        case CCI_U_TYPE_DATE : strType.Append(L&quot;Date&quot;);
            break;
        case CCI_U_TYPE_TIME : strType.Append(L&quot;Time&quot;);
            break;
        case CCI_U_TYPE_TIMESTAMP : strType.Append(L&quot;Timestamp&quot;);
            break;
        case CCI_U_TYPE_SET : strType.Append(L&quot;SET&quot;);
            break;
        case CCI_U_TYPE_MULTISET : strType.Append(L&quot;Multiset&quot;);
            break;
        case CCI_U_TYPE_SEQUENCE : strType.Append(L&quot;Sequence&quot;);
            break;
        case CCI_U_TYPE_OBJECT : strType.Append(L&quot;Object&quot;);
            break;
        default : strType.Append(L&quot;&quot;);
        }
    }

    if (bHasDefault)
    {
        strType.Append(L&quot; DEFAULT &quot;);
        strType.Append(defaultVal);
    }
    if (bIsPrimaryKey)
        strType.Append(L&quot; PRIMARY KEY &quot;);
    if (!bIsNullable)
        strType.Append(L&quot; NOT NULL &quot;);
    if (bIsUnique)
        strType.Append(L&quot; UNIQUE &quot;);

    return hr;
}

T_CCI_A_TYPE GetCASTypeA(DBTYPE wType)
{
    switch(wType)
    {
    case DBTYPE_I1:
    case DBTYPE_I2:
    case DBTYPE_I4:
    case DBTYPE_UI1:
    case DBTYPE_UI2:
    case DBTYPE_UI4:
        return CCI_A_TYPE_INT;
    case DBTYPE_I8:
    case DBTYPE_UI8:
        return CCI_A_TYPE_BIGINT;
    case DBTYPE_R4:
        return CCI_A_TYPE_FLOAT;
    case DBTYPE_R8:
        return CCI_A_TYPE_DOUBLE;
    case DBTYPE_BOOL:
    case DBTYPE_BYTES:
        return CCI_A_TYPE_BIT;
    case DBTYPE_DECIMAL:
    case DBTYPE_NUMERIC: 
    case DBTYPE_WSTR:
    case DBTYPE_BSTR:
    case DBTYPE_STR:
        return CCI_A_TYPE_STR;
    case DBTYPE_DBDATE:
    case DBTYPE_DBTIME:
    case DBTYPE_DBTIMESTAMP:
        return CCI_A_TYPE_DATE;
    }
    return CCI_A_TYPE_FIRST;
}

T_CCI_U_TYPE GetCASTypeU(DBTYPE wType)
{
    switch(wType)
    {
    case DBTYPE_I1:
        return CCI_U_TYPE_CHAR;
    case DBTYPE_I2:
        return CCI_U_TYPE_SHORT;
    case DBTYPE_I4:
        return CCI_U_TYPE_INT;
    case DBTYPE_R4:
        return CCI_U_TYPE_FLOAT;
    case DBTYPE_R8:
        return CCI_U_TYPE_DOUBLE;
    case DBTYPE_BOOL:
    case DBTYPE_BYTES:
        return CCI_U_TYPE_BIT;
    case DBTYPE_UI2:
    case DBTYPE_UI4:
    case DBTYPE_UI8:
    case DBTYPE_DECIMAL:
    case DBTYPE_NUMERIC:
        return CCI_U_TYPE_NUMERIC;
    case DBTYPE_DBDATE:
        return CCI_U_TYPE_DATE;
    case DBTYPE_DBTIME:
        return CCI_U_TYPE_TIME;
    case DBTYPE_DBTIMESTAMP:
        return CCI_U_TYPE_TIMESTAMP;
    case DBTYPE_BSTR: 
    case DBTYPE_WSTR:
        return CCI_U_TYPE_NCHAR;
    case DBTYPE_STR:
        return CCI_U_TYPE_STRING;             
    }
    return CCI_U_TYPE_UNKNOWN;
}

HRESULT OLEDBValueToCCIValue(DBTYPE wType, T_CCI_A_TYPE* aType, T_CCI_U_TYPE* uType,
        void *pValue, DBLENGTH dwLength, void** dstValue, DBSTATUS* status, const CComPtr&lt;IDataConvert&gt; &amp;spConvert)
{
    if(pValue==NULL) return E_FAIL;
    
    switch(wType)
    {
    case DBTYPE_UI1:
    case DBTYPE_I1:
        *dstValue = CoTaskMemAlloc(sizeof(int));
        *(int*)*dstValue = *(BYTE*)pValue;
        break;
    case DBTYPE_I2: 
        *dstValue = CoTaskMemAlloc(sizeof(int));
        *(int*)*dstValue = *(short*)pValue;
        break;
    case DBTYPE_I4:
        *dstValue = CoTaskMemAlloc(sizeof(int));
        *(int*)*dstValue = *(int*)pValue;
        break;
    case DBTYPE_I8:
        /*
        value = CoTaskMemAlloc(sizeof(LONGLONG));
        *(LONGLONG*)value = *(LONGLONG*)pValue;
        break;  
        */
        *status = DBSTATUS_E_DATAOVERFLOW;
        return DB_E_ERRORSOCCURRED;
    case DBTYPE_R4: 
        *dstValue = CoTaskMemAlloc(sizeof(float));
        *(float*)*dstValue = *(float*)pValue;
        break;  
    case DBTYPE_R8:
        *dstValue = CoTaskMemAlloc(sizeof(double));
        *(double*)*dstValue = *(double*)pValue;
        break;
    case DBTYPE_BOOL:
        *dstValue = CoTaskMemAlloc(sizeof(VARIANT));
        ((VARIANT *)*dstValue)-&gt;boolVal = ((VARIANT *)pValue)-&gt;boolVal;
        break;
    case DBTYPE_BYTES:
        *dstValue = CoTaskMemAlloc(sizeof(T_CCI_BIT));
        ((T_CCI_BIT *)*dstValue)-&gt;size = (int)dwLength;
        ((T_CCI_BIT *)*dstValue)-&gt;buf = 0;
        if(pValue &amp;&amp; dwLength&gt;0)
        {
            ((T_CCI_BIT *)*dstValue)-&gt;buf = (char *)CoTaskMemAlloc(dwLength);
            memcpy(((T_CCI_BIT *)*dstValue)-&gt;buf, pValue, dwLength);
        }
        break;
    case DBTYPE_BSTR:
    case DBTYPE_WSTR:
        /*{
        WCHAR *src = (WCHAR *)pValue;
        DBLENGTH DstLen;
        DBSTATUS dbStat = DBSTATUS_S_OK;
        DBLENGTH cbMaxLen = dwLength + 1;
        *dstValue = CoTaskMemAlloc(cbMaxLen + 1);
        HRESULT hr = spConvert-&gt;DataConvert(wType, DBTYPE_STR, dwLength, &amp;DstLen,
            src, *dstValue, cbMaxLen, dbStat, &amp;dbStat, 0, 0, 0);
        if (FAILED(hr)) return hr;
        }*/
        *dstValue = CoTaskMemAlloc((dwLength + 1) * sizeof(wchar_t));
        strcpy((char *)*dstValue, CW2A((wchar_t *)pValue));
        break;
    case DBTYPE_STR:
        /*{
        char *src = (char *)pValue;
        DBLENGTH DstLen;
        DBSTATUS dbStat = DBSTATUS_S_OK;
        DBLENGTH cbMaxLen = dwLength + 1;
        *dstValue = CoTaskMemAlloc(cbMaxLen + 1);
        HRESULT hr = spConvert-&gt;DataConvert(wType, DBTYPE_STR, dwLength, &amp;DstLen,
            src, *dstValue, cbMaxLen, dbStat, &amp;dbStat, 0, 0, 0);
        if (FAILED(hr)) return hr;
        }*/
        *dstValue = CoTaskMemAlloc((dwLength + 1) * sizeof(char));
        strcpy((char *)*dstValue, (char *)pValue);
        break;
    case DBTYPE_DBDATE:
        *dstValue = CoTaskMemAlloc(sizeof(T_CCI_DATE));
        ((T_CCI_DATE *)*dstValue)-&gt;yr = ((DBDATE *)pValue)-&gt;year;
        ((T_CCI_DATE *)*dstValue)-&gt;mon = ((DBDATE *)pValue)-&gt;month;
        ((T_CCI_DATE *)*dstValue)-&gt;day = ((DBDATE *)pValue)-&gt;day;
        break;
    case DBTYPE_DBTIME: 
        *dstValue = CoTaskMemAlloc(sizeof(T_CCI_DATE));
        ((T_CCI_DATE *)*dstValue)-&gt;hh = ((DBTIME *)pValue)-&gt;hour;
        ((T_CCI_DATE *)*dstValue)-&gt;mm = ((DBTIME *)pValue)-&gt;minute;
        ((T_CCI_DATE *)*dstValue)-&gt;ss = ((DBTIME *)pValue)-&gt;second;
        break;
    case DBTYPE_DBTIMESTAMP:
        *dstValue = CoTaskMemAlloc(sizeof(T_CCI_DATE));
        ((T_CCI_DATE *)*dstValue)-&gt;yr = ((DBTIMESTAMP *)pValue)-&gt;year;
        ((T_CCI_DATE *)*dstValue)-&gt;mon = ((DBTIMESTAMP *)pValue)-&gt;month;
        ((T_CCI_DATE *)*dstValue)-&gt;day = ((DBTIMESTAMP *)pValue)-&gt;day;
        ((T_CCI_DATE *)*dstValue)-&gt;hh = ((DBTIMESTAMP *)pValue)-&gt;hour;
        ((T_CCI_DATE *)*dstValue)-&gt;mm = ((DBTIMESTAMP *)pValue)-&gt;minute;
        ((T_CCI_DATE *)*dstValue)-&gt;ss = ((DBTIMESTAMP *)pValue)-&gt;second;
        break;
    case DBTYPE_DECIMAL:
    case DBTYPE_NUMERIC:
        {
            DB_NUMERIC *src = (DB_NUMERIC *)pValue;
            DBLENGTH DstLen;
            DBSTATUS dbStat = DBSTATUS_S_OK;
            DBLENGTH cbMaxLen = 41;
            *dstValue = CoTaskMemAlloc(cbMaxLen + 1);
            spConvert-&gt;DataConvert(DBTYPE_NUMERIC, DBTYPE_STR, sizeof(DB_NUMERIC), &amp;DstLen,
                src, *dstValue, cbMaxLen, dbStat, &amp;dbStat, src-&gt;precision, src-&gt;scale, 0);
        }
        break;
    case DBTYPE_VARIANT:
        {
            VARIANT* var = (VARIANT *)pValue;
            DBTYPE targetType = var-&gt;vt;
            DBLENGTH SrcLen = dwLength, DstLen;
            DBSTATUS dbStat = DBSTATUS_S_OK;
            DBLENGTH cbMaxLen = 0;

            switch (targetType)
            {
            case VT_UI1:
            case VT_I1:   
            case VT_I2:   
                            *dstValue = CoTaskMemAlloc(sizeof(short));
                            *aType = CCI_A_TYPE_INT;
                            *uType = CCI_U_TYPE_SHORT;
                            break;
            case VT_I4:
            case VT_INT:
            case VT_UINT:
                            *dstValue = CoTaskMemAlloc(sizeof(int));
                            *aType = CCI_A_TYPE_INT;
                            *uType = CCI_U_TYPE_INT;
                            break;
            case VT_I8:
                            *dstValue = CoTaskMemAlloc(sizeof(__int64));
                            *aType = CCI_A_TYPE_BIGINT;
                            *uType = CCI_U_TYPE_BIGINT;
                            break;
            case VT_R4:
                            *dstValue = CoTaskMemAlloc(sizeof(float));
                            *aType = CCI_A_TYPE_FLOAT;
                            *uType = CCI_U_TYPE_FLOAT;
                            break;
            case VT_R8:
                            *dstValue = CoTaskMemAlloc(sizeof(double));
                            *aType = CCI_A_TYPE_DOUBLE;
                            *uType = CCI_U_TYPE_DOUBLE;
                            break;
            case VT_DATE:
                            *dstValue = CoTaskMemAlloc(sizeof(T_CCI_DATE));
                            ((T_CCI_DATE *)*dstValue)-&gt;yr = ((DBTIMESTAMP *)pValue)-&gt;year;
                            ((T_CCI_DATE *)*dstValue)-&gt;mon = ((DBTIMESTAMP *)pValue)-&gt;month;
                            ((T_CCI_DATE *)*dstValue)-&gt;day = ((DBTIMESTAMP *)pValue)-&gt;day;
                            ((T_CCI_DATE *)*dstValue)-&gt;hh = ((DBTIMESTAMP *)pValue)-&gt;hour;
                            ((T_CCI_DATE *)*dstValue)-&gt;mm = ((DBTIMESTAMP *)pValue)-&gt;minute;
                            ((T_CCI_DATE *)*dstValue)-&gt;ss = ((DBTIMESTAMP *)pValue)-&gt;second;
                            *aType = CCI_A_TYPE_DATE;
                            *uType = CCI_U_TYPE_TIMESTAMP;
                            break;
            case VT_BSTR:   targetType = DBTYPE_STR;
                            *dstValue = CoTaskMemAlloc((2*dwLength) * sizeof(char) + 1);
                            dwLength *= 2;
                            cbMaxLen = dwLength + 1;
                            *aType = CCI_A_TYPE_STR;
                            *uType = CCI_U_TYPE_STRING;
                            break;
            case VT_DECIMAL:
                            DB_NUMERIC *src = (DB_NUMERIC *)pValue;
                            SrcLen = sizeof(DB_NUMERIC);
                            cbMaxLen = 41;
                            *dstValue = CoTaskMemAlloc(cbMaxLen + 1);
                            targetType = DBTYPE_STR;
                            *aType = CCI_A_TYPE_STR;
                            *uType = CCI_U_TYPE_NUMERIC;
            }
            
            if (targetType != VT_DATE)
            {
                HRESULT hr = spConvert-&gt;DataConvert(DBTYPE_VARIANT, targetType, SrcLen, &amp;DstLen,
                    var, *dstValue, cbMaxLen, dbStat, &amp;dbStat, 0, 0, 0);
                if (FAILED(hr)) return hr;
            }
        }
        break;
    }

    return S_OK;
}

DBTYPE GetOledbTypeFromName(LPCWSTR pwszName)
{
    const struct
    {
        LPCWSTR pwszName;
        DBTYPE wType;
    } types[] = {
        { L&quot;DBTYPE_I1&quot;, DBTYPE_I1 },        { L&quot;INTEGER(1)&quot;, DBTYPE_I1 },
        { L&quot;TINYINT&quot;, DBTYPE_I1 },

        { L&quot;DBTYPE_I2&quot;, DBTYPE_I2 },        { L&quot;INTEGER(2)&quot;, DBTYPE_I2 },
        { L&quot;AUTOINC(2)&quot;, DBTYPE_I2 },       { L&quot;SMALLINT&quot;, DBTYPE_I2 },
        { L&quot;SMALLINDENTITY&quot;, DBTYPE_I2 },   { L&quot;YEAR&quot;, DBTYPE_I2 },

        { L&quot;DBTYPE_I4&quot;, DBTYPE_I4 },        { L&quot;INTEGER(4)&quot;, DBTYPE_I4 },
        { L&quot;AUTOINC(4)&quot;, DBTYPE_I4 },       { L&quot;INTEGER&quot;, DBTYPE_I4 },
        { L&quot;MEDIUMINT&quot;, DBTYPE_I4 },        { L&quot;INT&quot;, DBTYPE_I4 },
        { L&quot;IDENTITY&quot;, DBTYPE_I4 },

        { L&quot;DBTYPE_I8&quot;, DBTYPE_I8 },        { L&quot;INTEGER(8)&quot;, DBTYPE_I8 },
        { L&quot;BIGINT&quot;, DBTYPE_I8 },

        { L&quot;DBTYPE_R4&quot;, DBTYPE_R4 },        { L&quot;FLOAT(4)&quot;, DBTYPE_R4 },
        { L&quot;BFLOAT(4)&quot;, DBTYPE_R4 },        { L&quot;REAL&quot;, DBTYPE_R4 },
        { L&quot;FLOAT&quot;, DBTYPE_R4 },            { L&quot;FLOAT UNSIGNED&quot;, DBTYPE_R4 },

        { L&quot;DBTYPE_R8&quot;, DBTYPE_R8 },        { L&quot;FLOAT(8)&quot;, DBTYPE_R8 },
        { L&quot;BFLOAT(8)&quot;, DBTYPE_R8 },        { L&quot;MONEY&quot;, DBTYPE_R8 },
        { L&quot;DECIMAL&quot;, DBTYPE_R8 },          { L&quot;DOUBLE&quot;, DBTYPE_R8 },
        { L&quot;DOUBLE UNSIGNED&quot;, DBTYPE_R8 },  { L&quot;DOUBLE PRECISION&quot;, DBTYPE_R8 },
        { L&quot;NUMERIC&quot;, DBTYPE_R8 },          { L&quot;NUMERICSA&quot;, DBTYPE_R8 },
        { L&quot;NUMERICSTS&quot;, DBTYPE_R8 },       { L&quot;MONETARY&quot;, DBTYPE_R8 },

        { L&quot;DBTYPE_CY&quot;, DBTYPE_CY },        { L&quot;CURRENCY&quot;, DBTYPE_CY },

        { L&quot;DBTYPE_BOOL&quot;, DBTYPE_BOOL },    { L&quot;LOGICAL&quot;, DBTYPE_BOOL },
        //{ L&quot;BIT&quot;, DBTYPE_BOOL },

        { L&quot;DBTYPE_UI1&quot;, DBTYPE_UI1 },      { L&quot;UNSIGNED(1)&quot;, DBTYPE_UI1 },
        { L&quot;UTINYINT&quot;, DBTYPE_UI1 },        { L&quot;TINYINT UNSIGNED&quot;, DBTYPE_UI1 },

        { L&quot;DBTYPE_UI2&quot;, DBTYPE_UI2 },      { L&quot;UNSIGNED(2)&quot;, DBTYPE_UI2 },
        { L&quot;USMALLINT&quot;, DBTYPE_UI2 },       { L&quot;SMALLINT UNSIGNED&quot;, DBTYPE_UI2 },

        { L&quot;DBTYPE_UI4&quot;, DBTYPE_UI4 },      { L&quot;UNSIGNED(4)&quot;, DBTYPE_UI4 },
        { L&quot;UINTEGER&quot;, DBTYPE_UI4 },        { L&quot;INTEGER UNSIGNED&quot;, DBTYPE_UI4 },
        { L&quot;MEDIUMINT UNSIGNED&quot;, DBTYPE_UI4 },

        { L&quot;DBTYPE_UI8&quot;, DBTYPE_UI8 },      { L&quot;UNSIGNED(8)&quot;, DBTYPE_UI8 },
        { L&quot;BIGINT UNSIGNED&quot;, DBTYPE_UI8 }, { L&quot;UBIGINT&quot;, DBTYPE_UI8 },

        { L&quot;DBTYPE_STR&quot;, DBTYPE_STR },      { L&quot;CHARACTER&quot;, DBTYPE_STR },
        { L&quot;LSTRING&quot;, DBTYPE_STR },         { L&quot;ZSTRING&quot;, DBTYPE_STR },
        { L&quot;NOTE&quot;, DBTYPE_STR },            { L&quot;CHAR&quot;, DBTYPE_STR },
        { L&quot;VARCHAR&quot;, DBTYPE_STR },         { L&quot;LONGVARCHAR&quot;, DBTYPE_STR },
        { L&quot;BLOB&quot;, DBTYPE_STR },            { L&quot;TINYBLOB&quot;, DBTYPE_STR },
        { L&quot;MEDIUMBLOB&quot;, DBTYPE_STR },      { L&quot;LONGBLOB&quot;, DBTYPE_STR },
        { L&quot;TEXT&quot;, DBTYPE_STR },            { L&quot;TINYTEXT&quot;, DBTYPE_STR },
        { L&quot;MEDIUMTEXT&quot;, DBTYPE_STR },      { L&quot;LONGTEXT&quot;, DBTYPE_STR },
        { L&quot;NULL&quot;, DBTYPE_STR },            { L&quot;ENUM&quot;, DBTYPE_STR },
        { L&quot;SET&quot;, DBTYPE_STR },

        { L&quot;NCHAR&quot;, DBTYPE_WSTR },          { L&quot;NCHAR VARYING&quot;, DBTYPE_WSTR },

        { L&quot;DBTYPE_BYTES&quot;, DBTYPE_BYTES },  { L&quot;LVAR&quot;, DBTYPE_BYTES },
        { L&quot;LONG VARBINARY&quot;, DBTYPE_BYTES },{ L&quot;LONGVARBINARY&quot;, DBTYPE_BYTES },
        { L&quot;BINARY&quot;, DBTYPE_BYTES },        { L&quot;BIT&quot;, DBTYPE_BYTES },
        { L&quot;BIT VARYING&quot;, DBTYPE_BYTES },

        { L&quot;DBTYPE_DBDATE&quot;, DBTYPE_DBDATE },{ L&quot;DATE&quot;, DBTYPE_DBDATE },

        { L&quot;DBTYPE_DBTIME&quot;, DBTYPE_DBTIME },{ L&quot;TIME&quot;, DBTYPE_DBTIME },

        { L&quot;DBTYPE_DBTIMESTAMP&quot;, DBTYPE_DBTIMESTAMP },
        { L&quot;TIMESTAMP&quot;, DBTYPE_DBTIMESTAMP },
        { L&quot;DATETIME&quot;, DBTYPE_DBTIMESTAMP },
    };

    if(pwszName==NULL) return DBTYPE_WSTR;

    for(int i=1;i&lt;sizeof(types)/sizeof(*types);i++)
    {
        if(_wcsicmp(pwszName, types[i].pwszName)==0)
            return types[i].wType;
    }

    return DBTYPE_STR;
}

static HRESULT CompareSTR(DBCOMPAREOP CompareOp, const char *szRowValue, const char *szFindValue)
{
    DBCOMPAREOP LocalOp = CompareOp &amp; ~DBCOMPAREOPS_CASESENSITIVE &amp; ~DBCOMPAREOPS_CASEINSENSITIVE;

    switch(LocalOp)
    {
    case DBCOMPAREOPS_LT:
    case DBCOMPAREOPS_LE:
    case DBCOMPAREOPS_EQ:
    case DBCOMPAREOPS_GE:
    case DBCOMPAREOPS_GT:
    case DBCOMPAREOPS_NE:
        {
            // 디폴트는 case sensitive
            int res;
            if(CompareOp &amp; DBCOMPAREOPS_CASEINSENSITIVE)
                res = _stricmp(szRowValue, szFindValue);
            else
                res = strcmp(szRowValue, szFindValue);

            if( ( LocalOp==DBCOMPAREOPS_LT &amp;&amp; res&lt; 0 ) ||
                ( LocalOp==DBCOMPAREOPS_LE &amp;&amp; res&lt;=0 ) ||
                ( LocalOp==DBCOMPAREOPS_EQ &amp;&amp; res==0 ) ||
                ( LocalOp==DBCOMPAREOPS_GE &amp;&amp; res&gt;=0 ) ||
                ( LocalOp==DBCOMPAREOPS_GT &amp;&amp; res&gt; 0 ) ||
                ( LocalOp==DBCOMPAREOPS_NE &amp;&amp; res!=0 ) )
                return S_OK;

            return S_FALSE;
        }

    case DBCOMPAREOPS_BEGINSWITH:
        {
            int res;
            size_t len = strlen(szFindValue);
            if(CompareOp &amp; DBCOMPAREOPS_CASEINSENSITIVE)
                res = _strnicmp(szRowValue, szFindValue, len);
            else
                res = strncmp(szRowValue, szFindValue, len);
            return res==0 ? S_OK : S_FALSE;
        }
    case DBCOMPAREOPS_NOTBEGINSWITH:
        {
            int res;
            size_t len = strlen(szFindValue);
            if(CompareOp &amp; DBCOMPAREOPS_CASEINSENSITIVE)
                res = _strnicmp(szRowValue, szFindValue, len);
            else
                res = strncmp(szRowValue, szFindValue, len);
            return res!=0 ? S_OK : S_FALSE;
        }

    // TODO: case insensitive
    case DBCOMPAREOPS_CONTAINS:
        {
            const char *res;
            if(CompareOp &amp; DBCOMPAREOPS_CASEINSENSITIVE)
            {
                CStringA row(szRowValue), find(szFindValue);
                row.MakeUpper(); find.MakeUpper();
                res = strstr(row, find);
            }
            else
                res = strstr(szRowValue, szFindValue);
            return res!=0 ? S_OK : S_FALSE;
        }
    case DBCOMPAREOPS_NOTCONTAINS:
        {
            const char *res;
            if(CompareOp &amp; DBCOMPAREOPS_CASEINSENSITIVE)
            {
                CStringA row(szRowValue), find(szFindValue);
                row.MakeUpper(); find.MakeUpper();
                res = strstr(row, find);
            }
            else
                res = strstr(szRowValue, szFindValue);
            return res==0 ? S_OK : S_FALSE;
        }
    }

    return DB_E_BADCOMPAREOP;
}

static HRESULT CompareI4(DBCOMPAREOP CompareOp, const char *szRowValue, const char *szFindValue)
{
    if( CompareOp!=DBCOMPAREOPS_LT &amp;&amp; CompareOp!=DBCOMPAREOPS_LE &amp;&amp;
        CompareOp!=DBCOMPAREOPS_EQ &amp;&amp; CompareOp!=DBCOMPAREOPS_NE &amp;&amp;
        CompareOp!=DBCOMPAREOPS_GE &amp;&amp; CompareOp!=DBCOMPAREOPS_GT )
        return DB_E_BADCOMPAREOP;

    int nRowValue = atoi(szRowValue);
    int nFindValue = atoi(szFindValue);

    if( ( CompareOp==DBCOMPAREOPS_LT &amp;&amp; nRowValue&lt; nFindValue ) ||
        ( CompareOp==DBCOMPAREOPS_LE &amp;&amp; nRowValue&lt;=nFindValue ) ||
        ( CompareOp==DBCOMPAREOPS_EQ &amp;&amp; nRowValue==nFindValue ) ||
        ( CompareOp==DBCOMPAREOPS_GE &amp;&amp; nRowValue&gt;=nFindValue ) ||
        ( CompareOp==DBCOMPAREOPS_GT &amp;&amp; nRowValue&gt; nFindValue ) ||
        ( CompareOp==DBCOMPAREOPS_NE &amp;&amp; nRowValue!=nFindValue ) )
        return S_OK;
    return S_FALSE;
}

static HRESULT CompareI2(DBCOMPAREOP CompareOp, const char *szRowValue, const char *szFindValue)
{
    if( CompareOp!=DBCOMPAREOPS_LT &amp;&amp; CompareOp!=DBCOMPAREOPS_LE &amp;&amp;
        CompareOp!=DBCOMPAREOPS_EQ &amp;&amp; CompareOp!=DBCOMPAREOPS_NE &amp;&amp;
        CompareOp!=DBCOMPAREOPS_GE &amp;&amp; CompareOp!=DBCOMPAREOPS_GT )
        return DB_E_BADCOMPAREOP;

    short nRowValue = (short)atoi(szRowValue);
    short nFindValue = (short)atoi(szFindValue);

    if( ( CompareOp==DBCOMPAREOPS_LT &amp;&amp; nRowValue&lt; nFindValue ) ||
        ( CompareOp==DBCOMPAREOPS_LE &amp;&amp; nRowValue&lt;=nFindValue ) ||
        ( CompareOp==DBCOMPAREOPS_EQ &amp;&amp; nRowValue==nFindValue ) ||
        ( CompareOp==DBCOMPAREOPS_GE &amp;&amp; nRowValue&gt;=nFindValue ) ||
        ( CompareOp==DBCOMPAREOPS_GT &amp;&amp; nRowValue&gt; nFindValue ) ||
        ( CompareOp==DBCOMPAREOPS_NE &amp;&amp; nRowValue!=nFindValue ) )
        return S_OK;
    return S_FALSE;
}

static HRESULT CompareR4(DBCOMPAREOP CompareOp, const char *szRowValue, const char *szFindValue)
{
    if( CompareOp!=DBCOMPAREOPS_LT &amp;&amp; CompareOp!=DBCOMPAREOPS_LE &amp;&amp;
        CompareOp!=DBCOMPAREOPS_EQ &amp;&amp; CompareOp!=DBCOMPAREOPS_NE &amp;&amp;
        CompareOp!=DBCOMPAREOPS_GE &amp;&amp; CompareOp!=DBCOMPAREOPS_GT )
        return DB_E_BADCOMPAREOP;

    float fRowValue = (float)atof(szRowValue);
    float fFindValue = (float)atof(szFindValue);

    if( ( CompareOp==DBCOMPAREOPS_LT &amp;&amp; fRowValue&lt; fFindValue ) ||
        ( CompareOp==DBCOMPAREOPS_LE &amp;&amp; fRowValue&lt;=fFindValue ) ||
        ( CompareOp==DBCOMPAREOPS_EQ &amp;&amp; fRowValue==fFindValue ) ||
        ( CompareOp==DBCOMPAREOPS_GE &amp;&amp; fRowValue&gt;=fFindValue ) ||
        ( CompareOp==DBCOMPAREOPS_GT &amp;&amp; fRowValue&gt; fFindValue ) ||
        ( CompareOp==DBCOMPAREOPS_NE &amp;&amp; fRowValue!=fFindValue ) )
        return S_OK;
    return S_FALSE;
}

static HRESULT CompareR8(DBCOMPAREOP CompareOp, const char *szRowValue, const char *szFindValue)
{
    if( CompareOp!=DBCOMPAREOPS_LT &amp;&amp; CompareOp!=DBCOMPAREOPS_LE &amp;&amp;
        CompareOp!=DBCOMPAREOPS_EQ &amp;&amp; CompareOp!=DBCOMPAREOPS_NE &amp;&amp;
        CompareOp!=DBCOMPAREOPS_GE &amp;&amp; CompareOp!=DBCOMPAREOPS_GT )
        return DB_E_BADCOMPAREOP;

    double dRowValue = atof(szRowValue);
    double dFindValue = atof(szFindValue);

    if( ( CompareOp==DBCOMPAREOPS_LT &amp;&amp; dRowValue&lt; dFindValue ) ||
        ( CompareOp==DBCOMPAREOPS_LE &amp;&amp; dRowValue&lt;=dFindValue ) ||
        ( CompareOp==DBCOMPAREOPS_EQ &amp;&amp; dRowValue==dFindValue ) ||
        ( CompareOp==DBCOMPAREOPS_GE &amp;&amp; dRowValue&gt;=dFindValue ) ||
        ( CompareOp==DBCOMPAREOPS_GT &amp;&amp; dRowValue&gt; dFindValue ) ||
        ( CompareOp==DBCOMPAREOPS_NE &amp;&amp; dRowValue!=dFindValue ) )
        return S_OK;
    return S_FALSE;
}

HRESULT Compare(DBCOMPAREOP CompareOp, DBTYPE wType, const char *szRowValue, const char *szFindValue)
{
    switch(wType)
    {
    case DBTYPE_STR:
    case DBTYPE_WSTR:
        return CompareSTR(CompareOp, szRowValue, szFindValue);
        break;

    case DBTYPE_I4:
        return CompareI4(CompareOp, szRowValue, szFindValue);

    case DBTYPE_I2:
        return CompareI2(CompareOp, szRowValue, szFindValue);

    case DBTYPE_R4:
        return CompareR4(CompareOp, szRowValue, szFindValue);

    case DBTYPE_R8:
        return CompareR8(CompareOp, szRowValue, szFindValue);

    default:
        return DB_E_BADCOMPAREOP;
        break;
    }
}

long GetFindCompareOps(DBTYPE wType)
{
    switch(wType)
    {
    case DBTYPE_STR:
    case DBTYPE_WSTR:
        return DBPROPVAL_CO_EQUALITY | DBPROPVAL_CO_STRING | DBPROPVAL_CO_CONTAINS
                | DBPROPVAL_CO_BEGINSWITH | DBPROPVAL_CO_CASEINSENSITIVE;
    case DBTYPE_I4:
    case DBTYPE_I2:
    case DBTYPE_R4:
    case DBTYPE_R8:
        return DBPROPVAL_CO_EQUALITY;
    }
    return 0;
}

// 원래 VARIANT_BOOL은 VARIANT_TRUE와 VARIANT_FALSE만을 갖지만 1을 가지는 경우도 있다.
// 이경우 GetDBStatus에서 DBSTATUS_S_ISNULL을 반환하고, 값은 무시되므로 괜찮다.
static StaticTypeInfo static_type_infos[] = {
    // CCI type,           OLEDB type,     size, prefix, suffix, case sensitive, searchable,        unsigned,      fixed length,  long,          fixed p&amp;s
    { CCI_U_TYPE_UNKNOWN,  DBTYPE_STR,  4000, L&quot;&quot;,   L&quot;&quot;,  VARIANT_TRUE, DB_SEARCHABLE,    1,             VARIANT_FALSE, VARIANT_FALSE, VARIANT_TRUE  },
    { CCI_U_TYPE_CHAR,     DBTYPE_STR,  1073741823, L&quot;&#39;&quot;,  L&quot;&#39;&quot;, VARIANT_TRUE,  DB_SEARCHABLE,      1,             VARIANT_TRUE,  VARIANT_TRUE,  VARIANT_TRUE  },
    { CCI_U_TYPE_STRING,   DBTYPE_STR,  1073741823, L&quot;&#39;&quot;,  L&quot;&#39;&quot;, VARIANT_TRUE,  DB_SEARCHABLE,      1,             VARIANT_FALSE, VARIANT_TRUE,  VARIANT_TRUE  },
    // TODO: NCHAR와 WSTR은 좀 차이가 있다. 그래서 문제가 생길 여지가 좀 있는데
    //       그렇다고 STR으로 할 수는 없어서, WSTR으로 한다.
    { CCI_U_TYPE_NCHAR,    DBTYPE_WSTR,  536870911/2, L&quot;N&#39;&quot;, L&quot;&#39;&quot;, VARIANT_TRUE,  DB_SEARCHABLE,      1,             VARIANT_TRUE,  VARIANT_TRUE,  VARIANT_TRUE  },
    { CCI_U_TYPE_VARNCHAR, DBTYPE_WSTR,  536870911/2, L&quot;N&#39;&quot;, L&quot;&#39;&quot;, VARIANT_TRUE,  DB_SEARCHABLE,      1,             VARIANT_FALSE, VARIANT_TRUE,  VARIANT_TRUE  },
    // TODO: 크기를 1073741823로 해야 하는지, 268435455 또는 134217727으로 해야 하는지 모르겠음
    //       LTM에서는 &#39;F111...&#39;과 같은 데이터를 만들어서 prefix는 16진수를 쓰는 걸로 함
    { CCI_U_TYPE_BIT,     DBTYPE_BYTES, 1073741823, L&quot;X&#39;&quot;, L&quot;&#39;&quot;, VARIANT_FALSE, DB_ALL_EXCEPT_LIKE, 1,             VARIANT_TRUE,  VARIANT_TRUE,  VARIANT_TRUE  },
    { CCI_U_TYPE_VARBIT,  DBTYPE_BYTES, 1073741823, L&quot;X&#39;&quot;, L&quot;&#39;&quot;, VARIANT_FALSE, DB_ALL_EXCEPT_LIKE, 1,             VARIANT_FALSE, VARIANT_TRUE,  VARIANT_TRUE  },
    { CCI_U_TYPE_NUMERIC,  DBTYPE_NUMERIC,      38, L&quot;&quot;,   L&quot;&quot;,  VARIANT_FALSE, DB_ALL_EXCEPT_LIKE, VARIANT_FALSE, VARIANT_FALSE, VARIANT_FALSE, VARIANT_TRUE  },
    { CCI_U_TYPE_INT,      DBTYPE_I4,           10, L&quot;&quot;,   L&quot;&quot;,  VARIANT_FALSE, DB_ALL_EXCEPT_LIKE, VARIANT_FALSE, VARIANT_TRUE,  VARIANT_FALSE, VARIANT_TRUE  },
    { CCI_U_TYPE_SHORT,    DBTYPE_I2,            5, L&quot;&quot;,   L&quot;&quot;,  VARIANT_FALSE, DB_ALL_EXCEPT_LIKE, VARIANT_FALSE, VARIANT_TRUE,  VARIANT_FALSE, VARIANT_TRUE  },
    { CCI_U_TYPE_MONETARY, DBTYPE_R8,           15, L&quot;&quot;,   L&quot;&quot;,  VARIANT_FALSE, DB_ALL_EXCEPT_LIKE, VARIANT_FALSE, VARIANT_TRUE,  VARIANT_FALSE, VARIANT_FALSE },
    { CCI_U_TYPE_FLOAT,    DBTYPE_R4,            7, L&quot;&quot;,   L&quot;&quot;,  VARIANT_FALSE, DB_ALL_EXCEPT_LIKE, VARIANT_FALSE, VARIANT_TRUE,  VARIANT_FALSE, VARIANT_FALSE },
    { CCI_U_TYPE_DOUBLE,   DBTYPE_R8,           15, L&quot;&quot;,   L&quot;&quot;,  VARIANT_FALSE, DB_ALL_EXCEPT_LIKE, VARIANT_FALSE, VARIANT_TRUE,  VARIANT_FALSE, VARIANT_FALSE },
    { CCI_U_TYPE_DATE,     DBTYPE_DBDATE,       10, L&quot;&#39;&quot;,  L&quot;&#39;&quot;, VARIANT_FALSE, DB_ALL_EXCEPT_LIKE, 1,             VARIANT_TRUE,  VARIANT_FALSE, VARIANT_TRUE  },
    // NOTE: time의 &#39;am&#39;, &#39;pm&#39; 자리까지 생각해서 size를 정하면
  //       LTM은 1/100초 자리로 생각을 함. 그래서 뺌
    { CCI_U_TYPE_TIME,     DBTYPE_DBTIME,        8, L&quot;&#39;&quot;,  L&quot;&#39;&quot;, VARIANT_FALSE, DB_ALL_EXCEPT_LIKE, 1,             VARIANT_TRUE,  VARIANT_FALSE, VARIANT_TRUE  },
    { CCI_U_TYPE_TIMESTAMP, DBTYPE_DBTIMESTAMP, 19, L&quot;&#39;&quot;,  L&quot;&#39;&quot;, VARIANT_FALSE, DB_ALL_EXCEPT_LIKE, 1,             VARIANT_TRUE,  VARIANT_FALSE, VARIANT_TRUE  },
    // TODO: mapping to DBTYPE_IUnknown?
    { CCI_U_TYPE_OBJECT,   DBTYPE_STR,  1073741823, L&quot;&#39;&quot;,  L&quot;&#39;&quot;, VARIANT_TRUE,  DB_SEARCHABLE,      1,             VARIANT_FALSE, VARIANT_TRUE,  VARIANT_TRUE  },
    { CCI_U_TYPE_MULTISET,   DBTYPE_STR,  1073741823, L&quot;&#39;&quot;,  L&quot;&#39;&quot;, VARIANT_TRUE,  DB_SEARCHABLE,      1,             VARIANT_FALSE, VARIANT_TRUE,  VARIANT_TRUE  },
    { CCI_U_TYPE_SET,   DBTYPE_STR,  1073741823, L&quot;&#39;&quot;,  L&quot;&#39;&quot;, VARIANT_TRUE,  DB_SEARCHABLE,      1,             VARIANT_FALSE, VARIANT_TRUE,  VARIANT_TRUE  },
};

const StaticTypeInfo &amp;GetStaticTypeInfo(T_CCI_U_TYPE nCCIUType)
{
    for(int i=1;i&lt;sizeof(static_type_infos)/sizeof(*static_type_infos);i++)
    {
        if(static_type_infos[i].nCCIUType==nCCIUType)
            return static_type_infos[i];
    }
    return static_type_infos[0];
}

DynamicTypeInfo GetDynamicTypeInfo(T_CCI_U_TYPE nCCIUType, int nPrecision, int nScale, bool bNullable)
{
    /* 스펙엔 &#39;this is the size of the data type&#39;라고 되어 있어서
     * ulColumnSize = StaticTypeInfo::ulSize (문자열로 봤을 때의 길이) 라고 생각했으나
     * LTM을 보니 저장공간의 크기를 말하는 것 같다.
     */
    DynamicTypeInfo dyn_info;
    const StaticTypeInfo &amp;sta_info = GetStaticTypeInfo(nCCIUType);

    dyn_info.ulFlags = 0;
    dyn_info.ulFlags |= DBCOLUMNFLAGS_WRITEUNKNOWN;
    dyn_info.ulFlags |= DBCOLUMNFLAGS_ISFIXEDLENGTH;
    if(bNullable)
        dyn_info.ulFlags |= DBCOLUMNFLAGS_ISNULLABLE | DBCOLUMNFLAGS_MAYBENULL;
    dyn_info.ulColumnSize = (ULONG)~0;
    dyn_info.bPrecision = ~0;
    dyn_info.bScale = ~0;
    dyn_info.ulCharMaxLength = (ULONG)~0;
    dyn_info.ulCharOctetLength = (ULONG)~0;
    dyn_info.nNumericPrecision = (USHORT)~0;
    dyn_info.nNumericScale = -1;
    dyn_info.ulDateTimePrecision = (ULONG)~0;

    switch(nCCIUType)
    {
    case CCI_U_TYPE_STRING:
    case CCI_U_TYPE_VARNCHAR:
        dyn_info.ulFlags &amp;= ~DBCOLUMNFLAGS_ISFIXEDLENGTH; // 주의 break 없음
    case CCI_U_TYPE_CHAR:
    case CCI_U_TYPE_NCHAR:
        if(nCCIUType==CCI_U_TYPE_VARNCHAR || nCCIUType==CCI_U_TYPE_NCHAR)
            dyn_info.ulColumnSize = nPrecision / 2;
        else
            dyn_info.ulColumnSize = nPrecision;

        dyn_info.ulCharMaxLength = dyn_info.ulColumnSize;
        dyn_info.ulCharOctetLength = dyn_info.ulCharMaxLength;
        if(nCCIUType==CCI_U_TYPE_VARNCHAR || nCCIUType==CCI_U_TYPE_NCHAR)
        {
            dyn_info.ulCharOctetLength *= 2; // TODO: 좀 다르긴 하지만 LTM을 위해 일단 2배를 한다.
        }
        break;

    case CCI_U_TYPE_VARBIT:
        dyn_info.ulFlags &amp;= ~DBCOLUMNFLAGS_ISFIXEDLENGTH; // 주의 break 없음
    case CCI_U_TYPE_BIT:
        // TODO: Maximum length니까 올림을 하는게 맞을 것 같은데, 하면 LTM은
        //       BYTE단위로 데이터를 만들어서 BIT로 보면 초과해서 에러가 난다.
        dyn_info.ulColumnSize = (int)(nPrecision/8);
        dyn_info.ulCharMaxLength = dyn_info.ulColumnSize;
        dyn_info.ulCharOctetLength = dyn_info.ulCharMaxLength;
        break;

    case CCI_U_TYPE_NUMERIC:
        dyn_info.ulColumnSize = sizeof(DB_NUMERIC);
        dyn_info.bPrecision = nPrecision;
        dyn_info.bScale = nScale;
        dyn_info.nNumericPrecision = dyn_info.bPrecision;
        dyn_info.nNumericScale = dyn_info.bScale;
        break;

    case CCI_U_TYPE_INT:
        dyn_info.ulColumnSize = 4;
        dyn_info.bPrecision = (BYTE)sta_info.ulSize;
        dyn_info.nNumericPrecision = dyn_info.bPrecision;
        break;

    case CCI_U_TYPE_SHORT:
        dyn_info.ulColumnSize = 2;
        dyn_info.bPrecision = (BYTE)sta_info.ulSize;
        dyn_info.nNumericPrecision = dyn_info.bPrecision;
        break;

    case CCI_U_TYPE_MONETARY:
        dyn_info.ulColumnSize = sizeof(double);
        dyn_info.bPrecision = (BYTE)sta_info.ulSize;
        dyn_info.nNumericPrecision = dyn_info.bPrecision;
        break;

    case CCI_U_TYPE_FLOAT:
        dyn_info.ulColumnSize = sizeof(float);
        dyn_info.bPrecision = (BYTE)sta_info.ulSize;
        dyn_info.nNumericPrecision = dyn_info.bPrecision;
        break;

    case CCI_U_TYPE_DOUBLE:
        dyn_info.ulColumnSize = sizeof(double);
        dyn_info.bPrecision = (BYTE)sta_info.ulSize;
        dyn_info.nNumericPrecision = dyn_info.bPrecision;
        break;

    case CCI_U_TYPE_DATE:
        dyn_info.ulColumnSize = sizeof(DBDATE);
        break;

    case CCI_U_TYPE_TIME:
        dyn_info.ulColumnSize = sizeof(DBTIME);
        break;

    case CCI_U_TYPE_TIMESTAMP:
        dyn_info.ulColumnSize = sizeof(DBTIMESTAMP);
        dyn_info.bPrecision = (BYTE)sta_info.ulSize;
        dyn_info.bScale = 0;
        dyn_info.ulDateTimePrecision = dyn_info.bScale;
        break;

    case CCI_U_TYPE_OBJECT:
        //dyn_info.ulColumnSize = nPrecision;
        //OID 스트링 max length를 15로 보고 수정
        dyn_info.ulColumnSize = 15;
        dyn_info.ulCharMaxLength = dyn_info.ulColumnSize;
        dyn_info.ulCharOctetLength = dyn_info.ulCharMaxLength;
        break;

    case CCI_U_TYPE_SET:
    case CCI_U_TYPE_MULTISET:
        ATLTRACE(atlTraceDBProvider, 2, _T(&quot;Here!!\n&quot;));
        dyn_info.ulColumnSize = nPrecision;
        dyn_info.ulCharMaxLength = dyn_info.ulColumnSize;
        dyn_info.ulCharOctetLength = dyn_info.ulCharMaxLength;
        break;
    default:
        dyn_info.ulColumnSize = sta_info.ulSize;
        dyn_info.ulCharMaxLength = sta_info.ulSize;
        dyn_info.ulCharOctetLength = sta_info.ulSize;
        break;
    }

    if(dyn_info.ulColumnSize&gt;8000) // 8000은 atldbcli.h의 CDynamicAccessor가 쓰는 값
        dyn_info.ulFlags |= DBCOLUMNFLAGS_ISLONG;

    return dyn_info;
}

static HRESULT GetTableInfo_FetchData(int hReq, TableInfo &amp;info)
{
    char *strval;
    int intval, ind, res;
    T_CCI_ERROR err_buf;

    res = cci_fetch(hReq, &amp;err_buf);
    if(res&lt;0) return E_FAIL;

    res = cci_get_data(hReq, 12, CCI_A_TYPE_STR, &amp;strval, &amp;ind);
    if(res&lt;0) return E_FAIL;
    info.strSourceClass = CA2W(strval);

    res = cci_get_data(hReq, 10, CCI_A_TYPE_INT, &amp;intval, &amp;ind);
    if(res&lt;0) return E_FAIL;
    info.iOrdinal = intval;

    res = cci_get_data(hReq, 8, CCI_A_TYPE_INT, &amp;intval, &amp;ind);
    if(res&lt;0) return E_FAIL;
    info.bIsUnique = (intval==1);
    ::VariantClear(&amp;info.varDefault);
    res = cci_get_data(hReq, 9, CCI_A_TYPE_STR, &amp;strval, &amp;ind);
    if(res&lt;0) return E_FAIL;
    if(ind!=-1)
    {
        CComVariant var = strval;
        var.Detach(&amp;info.varDefault);
    }

    return S_OK;
}

HRESULT GetTableInfo(int hConn, char *szTableName, CAtlArray&lt;TableInfo&gt; &amp;infos)
{
    // 기존의 데이터 모두 삭제
    infos.RemoveAll();

    T_CCI_ERROR err_buf;
    int hReq = cci_schema_info(hConn, CCI_SCH_ATTRIBUTE, szTableName, NULL,
                    CCI_CLASS_NAME_PATTERN_MATCH | CCI_ATTR_NAME_PATTERN_MATCH, &amp;err_buf);
    if(hReq&lt;0)
    {
        ATLTRACE2(&quot;GetTableInfo: cci_schema_info fail\n&quot;);
        return E_FAIL;
    }

    int res = cci_cursor(hReq, 1, CCI_CURSOR_FIRST, &amp;err_buf);
    if(res==CCI_ER_NO_MORE_DATA) goto done;
    if(res&lt;0) goto error;

    size_t cur = 0;
    while(1)
    {
        infos.SetCount(infos.GetCount()+1);
        HRESULT hr = GetTableInfo_FetchData(hReq, infos[cur]);
        if(FAILED(hr)) goto error;

        res = cci_cursor(hReq, 1, CCI_CURSOR_CURRENT, &amp;err_buf);
        if(res==CCI_ER_NO_MORE_DATA) goto done;
        if(res&lt;0) goto error;

        cur++;
    }

error:
    ATLTRACE2(&quot;GetTableInfo: fail to fetch data\n&quot;);
    cci_close_req_handle(hReq);
    infos.RemoveAll();
    return E_FAIL;
done:
    cci_close_req_handle(hReq);
    return S_OK;
}

}

/*
create table ztest (c1 char, c2 char(20), c3 varchar, c4 varchar(20), c5 nchar, c6 nchar(20),
c7 nchar varying, c8 nchar varying(20), c9 bit, c10 bit(20), c11 bit varying, c12 bit varying(20),
c13 numeric, c14 numeric(10), c15 numeric(15,8), c16 int, c17 smallint, c18 float, c19 float(5),
c20 float(14), c21 double, c22 monetary, c23 date, c24 time, c25 timestamp, c26 set(varchar(20), int),
c27 set(), c28 multiset(float, int), c29 list(float,int), c30 sequence())

***** cci_schema_info의 결과값 *****
name, domain, scale, precision, indexed, non_null, shared, unique, default, attr_order, class_name, source_class
c1  1   0   1           0   0   0   0   null    1   ztest   ztest   : character(1)
c2  1   0   20          0   0   0   0   null    2   ztest   ztest   : character(20)
c3  2   0   1073741823  0   0   0   0   null    3   ztest   ztest   : character varying(1073741823)
c4  2   0   20          0   0   0   0   null    4   ztest   ztest   : character varying(20)
c5  3   0   1           0   0   0   0   null    5   ztest   ztest   : national character(1)
c6  3   0   20          0   0   0   0   null    6   ztest   ztest   : national character(20)
c7  4   0   536870911   0   0   0   0   null    7   ztest   ztest   : national character varying(536870911)
c8  4   0   20          0   0   0   0   null    8   ztest   ztest   : national character varying(20)
c9  5   0   1           0   0   0   0   null    9   ztest   ztest   : bit(1)
c10 5   0   20          0   0   0   0   null    10  ztest   ztest   : bit(20)
c11 6   0   1073741823  0   0   0   0   null    11  ztest   ztest   : bit varying(1073741823)
c12 6   0   20          0   0   0   0   null    12  ztest   ztest   : bit varying(20)
c13 7   0   15          0   0   0   0   null    13  ztest   ztest   : numeric(15,0)
c14 7   0   10          0   0   0   0   null    14  ztest   ztest   : numeric(10,0)
c15 7   8   15          0   0   0   0   null    15  ztest   ztest   : numeric(15,8)
c16 8   0   0           0   0   0   0   null    16  ztest   ztest   : integer
c17 9   0   0           0   0   0   0   null    17  ztest   ztest   : smallint
c18 11  0   0           0   0   0   0   null    18  ztest   ztest   : float
c19 11  0   0           0   0   0   0   null    19  ztest   ztest   : float
c20 11  0   0           0   0   0   0   null    20  ztest   ztest   : float
c21 12  0   0           0   0   0   0   null    21  ztest   ztest   : double
c22 10  0   0           0   0   0   0   null    22  ztest   ztest   : monetary
c23 13  0   0           0   0   0   0   null    23  ztest   ztest   : date
c24 14  0   0           0   0   0   0   null    24  ztest   ztest   : time
c25 15  0   0           0   0   0   0   null    25  ztest   ztest   : timestamp
c26 -1  0   0           0   0   0   0   null    26  ztest   ztest   : set_of(character varying(20), integer)
c27 -1  0   0           0   0   0   0   null    27  ztest   ztest   : set_of()
c28 -1  0   0           0   0   0   0   null    28  ztest   ztest   : multiset_of(float, integer)
c29 -1  0   0           0   0   0   0   null    29  ztest   ztest   : sequence_of(float, integer)
c30 -1  0   0           0   0   0   0   null    30  ztest   ztest   : sequence_of()

***** cci_get_result_info의 결과값 *****
type, is_non_null, scale, precision, col_name, real_attr, class_name
1   0   0   1           c1  null    ztest
1   0   0   20          c2  null    ztest
2   0   0   1073741823  c3  null    ztest
2   0   0   20          c4  null    ztest
3   0   0   1           c5  null    ztest
3   0   0   20          c6  null    ztest
4   0   0   536870911   c7  null    ztest
4   0   0   20          c8  null    ztest
5   0   0   1           c9  null    ztest
5   0   0   20          c10 null    ztest
6   0   0   1073741823  c11 null    ztest
6   0   0   20          c12 null    ztest
7   0   0   15          c13 null    ztest
7   0   0   10          c14 null    ztest
7   0   8   15          c15 null    ztest
8   0   0   0           c16 null    ztest
9   0   0   0           c17 null    ztest
11  0   0   0           c18 null    ztest
11  0   0   0           c19 null    ztest
11  0   0   0           c20 null    ztest
12  0   0   0           c21 null    ztest
10  0   0   0           c22 null    ztest
13  0   0   0           c23 null    ztest
14  0   0   0           c24 null    ztest
15  0   0   0           c25 null    ztest
-1  0   0   0           c26 null    ztest
-1  0   0   0           c27 null    ztest
-1  0   0   0           c28 null    ztest
-1  0   0   0           c29 null    ztest
-1  0   0   0           c30 null    ztest
*/
</span></div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        <span class="keywordflow">if</span> (!colDesc.ulColumnSize)</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        {</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;            <a class="code" href="structType_1_1StaticTypeInfo.html">StaticTypeInfo</a> tInfo = <a class="code" href="namespaceType.html#a3f46b78f9ce3d04003861be8ab39eeec">GetStaticTypeInfo</a>(uType);</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;            <a class="code" href="atldb__cubrid_8h.html#a080c6299f67db3aab5e21e5e45f9e90f">colSize</a> = tInfo.<a class="code" href="structType_1_1StaticTypeInfo.html#a8016a345e7bd87d77131664400d01706">ulSize</a>;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        } <span class="keywordflow">else</span></div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;            <a class="code" href="atldb__cubrid_8h.html#a080c6299f67db3aab5e21e5e45f9e90f">colSize</a> = colDesc.ulColumnSize;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        <span class="keywordflow">switch</span> (uType)</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        {</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a0005b45612de0477eee20270f01e84be">CCI_U_TYPE_CHAR</a>: </div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;            sprintf(strColSize, <span class="stringliteral">&quot;(%ld)&quot;</span>, <a class="code" href="atldb__cubrid_8h.html#a080c6299f67db3aab5e21e5e45f9e90f">colSize</a>);</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;            strType.Append(strColSize);</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a17e9464e2c9d5dc2c753e99a4d1a0bd3">CCI_U_TYPE_STRING</a> : </div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;            <span class="keywordflow">if</span> (bIsFixedLength)</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                strType.Append(L<span class="stringliteral">&quot;Char&quot;</span>);</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                strType.Append(L<span class="stringliteral">&quot;Varchar&quot;</span>);</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;            sprintf(strColSize, <span class="stringliteral">&quot;(%ld)&quot;</span>, <a class="code" href="atldb__cubrid_8h.html#a080c6299f67db3aab5e21e5e45f9e90f">colSize</a>);</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;            strType.Append(strColSize);</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a2a9a7f31a26489fa99f9e188109ffbcd">CCI_U_TYPE_NCHAR</a> : </div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;            <span class="keywordflow">if</span> (bIsFixedLength)</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                strType.Append(L<span class="stringliteral">&quot;NChar&quot;</span>);</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;                strType.Append(L<span class="stringliteral">&quot;NChar Varying&quot;</span>);</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;            <span class="comment">//사용자가 원하는 길이의 두 배로 저장해야 한다            if (colDesc.ulColumnSize)
                colSize *= 2;

            sprintf(strColSize, &quot;(%ld)&quot;, colSize);
            strType.Append(strColSize);
            break;
        case CCI_U_TYPE_BIT : 
            if (bIsFixedLength)
                strType.Append(L&quot;Bit&quot;);
            else
                strType.Append(L&quot;Bit Varying&quot;);

            //사용자가 원하는 길이의 여덟 배로 저장해야 한다
         if (colDesc.ulColumnSize)
                colSize *= 8;

            sprintf(strColSize, &quot;(%u)&quot;, colSize);
            strType.Append(strColSize);
            break;
        case CCI_U_TYPE_NUMERIC : 
            if (colDesc.bPrecision &lt; 1 || colDesc.bPrecision &gt; 38)
                return DB_E_BADPRECISION;

            if (colDesc.bPrecision &lt; colDesc.bScale)
                return DB_E_BADSCALE;

            strType.Append(L&quot;Numeric&quot;);
            sprintf(strColSize, &quot;(%ld,%ld)&quot;, colDesc.bPrecision, colDesc.bScale);
            strType.Append(strColSize);
            break;
        case CCI_U_TYPE_INT : strType.Append(L&quot;Integer&quot;);
            break;
        case CCI_U_TYPE_SHORT : strType.Append(L&quot;Smallint&quot;);
            break;
        case CCI_U_TYPE_MONETARY : strType.Append(L&quot;Monetary&quot;);
            break;
        case CCI_U_TYPE_FLOAT : strType.Append(L&quot;Float&quot;);
            break;
        case CCI_U_TYPE_DOUBLE : strType.Append(L&quot;Double&quot;);
            break;
        case CCI_U_TYPE_DATE : strType.Append(L&quot;Date&quot;);
            break;
        case CCI_U_TYPE_TIME : strType.Append(L&quot;Time&quot;);
            break;
        case CCI_U_TYPE_TIMESTAMP : strType.Append(L&quot;Timestamp&quot;);
            break;
        case CCI_U_TYPE_SET : strType.Append(L&quot;SET&quot;);
            break;
        case CCI_U_TYPE_MULTISET : strType.Append(L&quot;Multiset&quot;);
            break;
        case CCI_U_TYPE_SEQUENCE : strType.Append(L&quot;Sequence&quot;);
            break;
        case CCI_U_TYPE_OBJECT : strType.Append(L&quot;Object&quot;);
            break;
        default : strType.Append(L&quot;&quot;);
        }
    }

    if (bHasDefault)
    {
        strType.Append(L&quot; DEFAULT &quot;);
        strType.Append(defaultVal);
    }
    if (bIsPrimaryKey)
        strType.Append(L&quot; PRIMARY KEY &quot;);
    if (!bIsNullable)
        strType.Append(L&quot; NOT NULL &quot;);
    if (bIsUnique)
        strType.Append(L&quot; UNIQUE &quot;);

    return hr;
}

T_CCI_A_TYPE GetCASTypeA(DBTYPE wType)
{
    switch(wType)
    {
    case DBTYPE_I1:
    case DBTYPE_I2:
    case DBTYPE_I4:
    case DBTYPE_UI1:
    case DBTYPE_UI2:
    case DBTYPE_UI4:
        return CCI_A_TYPE_INT;
    case DBTYPE_I8:
    case DBTYPE_UI8:
        return CCI_A_TYPE_BIGINT;
    case DBTYPE_R4:
        return CCI_A_TYPE_FLOAT;
    case DBTYPE_R8:
        return CCI_A_TYPE_DOUBLE;
    case DBTYPE_BOOL:
    case DBTYPE_BYTES:
        return CCI_A_TYPE_BIT;
    case DBTYPE_DECIMAL:
    case DBTYPE_NUMERIC: 
    case DBTYPE_WSTR:
    case DBTYPE_BSTR:
    case DBTYPE_STR:
        return CCI_A_TYPE_STR;
    case DBTYPE_DBDATE:
    case DBTYPE_DBTIME:
    case DBTYPE_DBTIMESTAMP:
        return CCI_A_TYPE_DATE;
    }
    return CCI_A_TYPE_FIRST;
}

T_CCI_U_TYPE GetCASTypeU(DBTYPE wType)
{
    switch(wType)
    {
    case DBTYPE_I1:
        return CCI_U_TYPE_CHAR;
    case DBTYPE_I2:
        return CCI_U_TYPE_SHORT;
    case DBTYPE_I4:
        return CCI_U_TYPE_INT;
    case DBTYPE_R4:
        return CCI_U_TYPE_FLOAT;
    case DBTYPE_R8:
        return CCI_U_TYPE_DOUBLE;
    case DBTYPE_BOOL:
    case DBTYPE_BYTES:
        return CCI_U_TYPE_BIT;
    case DBTYPE_UI2:
    case DBTYPE_UI4:
    case DBTYPE_UI8:
    case DBTYPE_DECIMAL:
    case DBTYPE_NUMERIC:
        return CCI_U_TYPE_NUMERIC;
    case DBTYPE_DBDATE:
        return CCI_U_TYPE_DATE;
    case DBTYPE_DBTIME:
        return CCI_U_TYPE_TIME;
    case DBTYPE_DBTIMESTAMP:
        return CCI_U_TYPE_TIMESTAMP;
    case DBTYPE_BSTR: 
    case DBTYPE_WSTR:
        return CCI_U_TYPE_NCHAR;
    case DBTYPE_STR:
        return CCI_U_TYPE_STRING;             
    }
    return CCI_U_TYPE_UNKNOWN;
}

HRESULT OLEDBValueToCCIValue(DBTYPE wType, T_CCI_A_TYPE* aType, T_CCI_U_TYPE* uType,
        void *pValue, DBLENGTH dwLength, void** dstValue, DBSTATUS* status, const CComPtr&lt;IDataConvert&gt; &amp;spConvert)
{
    if(pValue==NULL) return E_FAIL;
    
    switch(wType)
    {
    case DBTYPE_UI1:
    case DBTYPE_I1:
        *dstValue = CoTaskMemAlloc(sizeof(int));
        *(int*)*dstValue = *(BYTE*)pValue;
        break;
    case DBTYPE_I2: 
        *dstValue = CoTaskMemAlloc(sizeof(int));
        *(int*)*dstValue = *(short*)pValue;
        break;
    case DBTYPE_I4:
        *dstValue = CoTaskMemAlloc(sizeof(int));
        *(int*)*dstValue = *(int*)pValue;
        break;
    case DBTYPE_I8:
        /*
        value = CoTaskMemAlloc(sizeof(LONGLONG));
        *(LONGLONG*)value = *(LONGLONG*)pValue;
        break;  
        */
        *status = DBSTATUS_E_DATAOVERFLOW;
        return DB_E_ERRORSOCCURRED;
    case DBTYPE_R4: 
        *dstValue = CoTaskMemAlloc(sizeof(float));
        *(float*)*dstValue = *(float*)pValue;
        break;  
    case DBTYPE_R8:
        *dstValue = CoTaskMemAlloc(sizeof(double));
        *(double*)*dstValue = *(double*)pValue;
        break;
    case DBTYPE_BOOL:
        *dstValue = CoTaskMemAlloc(sizeof(VARIANT));
        ((VARIANT *)*dstValue)-&gt;boolVal = ((VARIANT *)pValue)-&gt;boolVal;
        break;
    case DBTYPE_BYTES:
        *dstValue = CoTaskMemAlloc(sizeof(T_CCI_BIT));
        ((T_CCI_BIT *)*dstValue)-&gt;size = (int)dwLength;
        ((T_CCI_BIT *)*dstValue)-&gt;buf = 0;
        if(pValue &amp;&amp; dwLength&gt;0)
        {
            ((T_CCI_BIT *)*dstValue)-&gt;buf = (char *)CoTaskMemAlloc(dwLength);
            memcpy(((T_CCI_BIT *)*dstValue)-&gt;buf, pValue, dwLength);
        }
        break;
    case DBTYPE_BSTR:
    case DBTYPE_WSTR:
        /*{
        WCHAR *src = (WCHAR *)pValue;
        DBLENGTH DstLen;
        DBSTATUS dbStat = DBSTATUS_S_OK;
        DBLENGTH cbMaxLen = dwLength + 1;
        *dstValue = CoTaskMemAlloc(cbMaxLen + 1);
        HRESULT hr = spConvert-&gt;DataConvert(wType, DBTYPE_STR, dwLength, &amp;DstLen,
            src, *dstValue, cbMaxLen, dbStat, &amp;dbStat, 0, 0, 0);
        if (FAILED(hr)) return hr;
        }*/
        *dstValue = CoTaskMemAlloc((dwLength + 1) * sizeof(wchar_t));
        strcpy((char *)*dstValue, CW2A((wchar_t *)pValue));
        break;
    case DBTYPE_STR:
        /*{
        char *src = (char *)pValue;
        DBLENGTH DstLen;
        DBSTATUS dbStat = DBSTATUS_S_OK;
        DBLENGTH cbMaxLen = dwLength + 1;
        *dstValue = CoTaskMemAlloc(cbMaxLen + 1);
        HRESULT hr = spConvert-&gt;DataConvert(wType, DBTYPE_STR, dwLength, &amp;DstLen,
            src, *dstValue, cbMaxLen, dbStat, &amp;dbStat, 0, 0, 0);
        if (FAILED(hr)) return hr;
        }*/
        *dstValue = CoTaskMemAlloc((dwLength + 1) * sizeof(char));
        strcpy((char *)*dstValue, (char *)pValue);
        break;
    case DBTYPE_DBDATE:
        *dstValue = CoTaskMemAlloc(sizeof(T_CCI_DATE));
        ((T_CCI_DATE *)*dstValue)-&gt;yr = ((DBDATE *)pValue)-&gt;year;
        ((T_CCI_DATE *)*dstValue)-&gt;mon = ((DBDATE *)pValue)-&gt;month;
        ((T_CCI_DATE *)*dstValue)-&gt;day = ((DBDATE *)pValue)-&gt;day;
        break;
    case DBTYPE_DBTIME: 
        *dstValue = CoTaskMemAlloc(sizeof(T_CCI_DATE));
        ((T_CCI_DATE *)*dstValue)-&gt;hh = ((DBTIME *)pValue)-&gt;hour;
        ((T_CCI_DATE *)*dstValue)-&gt;mm = ((DBTIME *)pValue)-&gt;minute;
        ((T_CCI_DATE *)*dstValue)-&gt;ss = ((DBTIME *)pValue)-&gt;second;
        break;
    case DBTYPE_DBTIMESTAMP:
        *dstValue = CoTaskMemAlloc(sizeof(T_CCI_DATE));
        ((T_CCI_DATE *)*dstValue)-&gt;yr = ((DBTIMESTAMP *)pValue)-&gt;year;
        ((T_CCI_DATE *)*dstValue)-&gt;mon = ((DBTIMESTAMP *)pValue)-&gt;month;
        ((T_CCI_DATE *)*dstValue)-&gt;day = ((DBTIMESTAMP *)pValue)-&gt;day;
        ((T_CCI_DATE *)*dstValue)-&gt;hh = ((DBTIMESTAMP *)pValue)-&gt;hour;
        ((T_CCI_DATE *)*dstValue)-&gt;mm = ((DBTIMESTAMP *)pValue)-&gt;minute;
        ((T_CCI_DATE *)*dstValue)-&gt;ss = ((DBTIMESTAMP *)pValue)-&gt;second;
        break;
    case DBTYPE_DECIMAL:
    case DBTYPE_NUMERIC:
        {
            DB_NUMERIC *src = (DB_NUMERIC *)pValue;
            DBLENGTH DstLen;
            DBSTATUS dbStat = DBSTATUS_S_OK;
            DBLENGTH cbMaxLen = 41;
            *dstValue = CoTaskMemAlloc(cbMaxLen + 1);
            spConvert-&gt;DataConvert(DBTYPE_NUMERIC, DBTYPE_STR, sizeof(DB_NUMERIC), &amp;DstLen,
                src, *dstValue, cbMaxLen, dbStat, &amp;dbStat, src-&gt;precision, src-&gt;scale, 0);
        }
        break;
    case DBTYPE_VARIANT:
        {
            VARIANT* var = (VARIANT *)pValue;
            DBTYPE targetType = var-&gt;vt;
            DBLENGTH SrcLen = dwLength, DstLen;
            DBSTATUS dbStat = DBSTATUS_S_OK;
            DBLENGTH cbMaxLen = 0;

            switch (targetType)
            {
            case VT_UI1:
            case VT_I1:   
            case VT_I2:   
                            *dstValue = CoTaskMemAlloc(sizeof(short));
                            *aType = CCI_A_TYPE_INT;
                            *uType = CCI_U_TYPE_SHORT;
                            break;
            case VT_I4:
            case VT_INT:
            case VT_UINT:
                            *dstValue = CoTaskMemAlloc(sizeof(int));
                            *aType = CCI_A_TYPE_INT;
                            *uType = CCI_U_TYPE_INT;
                            break;
            case VT_I8:
                            *dstValue = CoTaskMemAlloc(sizeof(__int64));
                            *aType = CCI_A_TYPE_BIGINT;
                            *uType = CCI_U_TYPE_BIGINT;
                            break;
            case VT_R4:
                            *dstValue = CoTaskMemAlloc(sizeof(float));
                            *aType = CCI_A_TYPE_FLOAT;
                            *uType = CCI_U_TYPE_FLOAT;
                            break;
            case VT_R8:
                            *dstValue = CoTaskMemAlloc(sizeof(double));
                            *aType = CCI_A_TYPE_DOUBLE;
                            *uType = CCI_U_TYPE_DOUBLE;
                            break;
            case VT_DATE:
                            *dstValue = CoTaskMemAlloc(sizeof(T_CCI_DATE));
                            ((T_CCI_DATE *)*dstValue)-&gt;yr = ((DBTIMESTAMP *)pValue)-&gt;year;
                            ((T_CCI_DATE *)*dstValue)-&gt;mon = ((DBTIMESTAMP *)pValue)-&gt;month;
                            ((T_CCI_DATE *)*dstValue)-&gt;day = ((DBTIMESTAMP *)pValue)-&gt;day;
                            ((T_CCI_DATE *)*dstValue)-&gt;hh = ((DBTIMESTAMP *)pValue)-&gt;hour;
                            ((T_CCI_DATE *)*dstValue)-&gt;mm = ((DBTIMESTAMP *)pValue)-&gt;minute;
                            ((T_CCI_DATE *)*dstValue)-&gt;ss = ((DBTIMESTAMP *)pValue)-&gt;second;
                            *aType = CCI_A_TYPE_DATE;
                            *uType = CCI_U_TYPE_TIMESTAMP;
                            break;
            case VT_BSTR:   targetType = DBTYPE_STR;
                            *dstValue = CoTaskMemAlloc((2*dwLength) * sizeof(char) + 1);
                            dwLength *= 2;
                            cbMaxLen = dwLength + 1;
                            *aType = CCI_A_TYPE_STR;
                            *uType = CCI_U_TYPE_STRING;
                            break;
            case VT_DECIMAL:
                            DB_NUMERIC *src = (DB_NUMERIC *)pValue;
                            SrcLen = sizeof(DB_NUMERIC);
                            cbMaxLen = 41;
                            *dstValue = CoTaskMemAlloc(cbMaxLen + 1);
                            targetType = DBTYPE_STR;
                            *aType = CCI_A_TYPE_STR;
                            *uType = CCI_U_TYPE_NUMERIC;
            }
            
            if (targetType != VT_DATE)
            {
                HRESULT hr = spConvert-&gt;DataConvert(DBTYPE_VARIANT, targetType, SrcLen, &amp;DstLen,
                    var, *dstValue, cbMaxLen, dbStat, &amp;dbStat, 0, 0, 0);
                if (FAILED(hr)) return hr;
            }
        }
        break;
    }

    return S_OK;
}

DBTYPE GetOledbTypeFromName(LPCWSTR pwszName)
{
    const struct
    {
        LPCWSTR pwszName;
        DBTYPE wType;
    } types[] = {
        { L&quot;DBTYPE_I1&quot;, DBTYPE_I1 },        { L&quot;INTEGER(1)&quot;, DBTYPE_I1 },
        { L&quot;TINYINT&quot;, DBTYPE_I1 },

        { L&quot;DBTYPE_I2&quot;, DBTYPE_I2 },        { L&quot;INTEGER(2)&quot;, DBTYPE_I2 },
        { L&quot;AUTOINC(2)&quot;, DBTYPE_I2 },       { L&quot;SMALLINT&quot;, DBTYPE_I2 },
        { L&quot;SMALLINDENTITY&quot;, DBTYPE_I2 },   { L&quot;YEAR&quot;, DBTYPE_I2 },

        { L&quot;DBTYPE_I4&quot;, DBTYPE_I4 },        { L&quot;INTEGER(4)&quot;, DBTYPE_I4 },
        { L&quot;AUTOINC(4)&quot;, DBTYPE_I4 },       { L&quot;INTEGER&quot;, DBTYPE_I4 },
        { L&quot;MEDIUMINT&quot;, DBTYPE_I4 },        { L&quot;INT&quot;, DBTYPE_I4 },
        { L&quot;IDENTITY&quot;, DBTYPE_I4 },

        { L&quot;DBTYPE_I8&quot;, DBTYPE_I8 },        { L&quot;INTEGER(8)&quot;, DBTYPE_I8 },
        { L&quot;BIGINT&quot;, DBTYPE_I8 },

        { L&quot;DBTYPE_R4&quot;, DBTYPE_R4 },        { L&quot;FLOAT(4)&quot;, DBTYPE_R4 },
        { L&quot;BFLOAT(4)&quot;, DBTYPE_R4 },        { L&quot;REAL&quot;, DBTYPE_R4 },
        { L&quot;FLOAT&quot;, DBTYPE_R4 },            { L&quot;FLOAT UNSIGNED&quot;, DBTYPE_R4 },

        { L&quot;DBTYPE_R8&quot;, DBTYPE_R8 },        { L&quot;FLOAT(8)&quot;, DBTYPE_R8 },
        { L&quot;BFLOAT(8)&quot;, DBTYPE_R8 },        { L&quot;MONEY&quot;, DBTYPE_R8 },
        { L&quot;DECIMAL&quot;, DBTYPE_R8 },          { L&quot;DOUBLE&quot;, DBTYPE_R8 },
        { L&quot;DOUBLE UNSIGNED&quot;, DBTYPE_R8 },  { L&quot;DOUBLE PRECISION&quot;, DBTYPE_R8 },
        { L&quot;NUMERIC&quot;, DBTYPE_R8 },          { L&quot;NUMERICSA&quot;, DBTYPE_R8 },
        { L&quot;NUMERICSTS&quot;, DBTYPE_R8 },       { L&quot;MONETARY&quot;, DBTYPE_R8 },

        { L&quot;DBTYPE_CY&quot;, DBTYPE_CY },        { L&quot;CURRENCY&quot;, DBTYPE_CY },

        { L&quot;DBTYPE_BOOL&quot;, DBTYPE_BOOL },    { L&quot;LOGICAL&quot;, DBTYPE_BOOL },
        //{ L&quot;BIT&quot;, DBTYPE_BOOL },

        { L&quot;DBTYPE_UI1&quot;, DBTYPE_UI1 },      { L&quot;UNSIGNED(1)&quot;, DBTYPE_UI1 },
        { L&quot;UTINYINT&quot;, DBTYPE_UI1 },        { L&quot;TINYINT UNSIGNED&quot;, DBTYPE_UI1 },

        { L&quot;DBTYPE_UI2&quot;, DBTYPE_UI2 },      { L&quot;UNSIGNED(2)&quot;, DBTYPE_UI2 },
        { L&quot;USMALLINT&quot;, DBTYPE_UI2 },       { L&quot;SMALLINT UNSIGNED&quot;, DBTYPE_UI2 },

        { L&quot;DBTYPE_UI4&quot;, DBTYPE_UI4 },      { L&quot;UNSIGNED(4)&quot;, DBTYPE_UI4 },
        { L&quot;UINTEGER&quot;, DBTYPE_UI4 },        { L&quot;INTEGER UNSIGNED&quot;, DBTYPE_UI4 },
        { L&quot;MEDIUMINT UNSIGNED&quot;, DBTYPE_UI4 },

        { L&quot;DBTYPE_UI8&quot;, DBTYPE_UI8 },      { L&quot;UNSIGNED(8)&quot;, DBTYPE_UI8 },
        { L&quot;BIGINT UNSIGNED&quot;, DBTYPE_UI8 }, { L&quot;UBIGINT&quot;, DBTYPE_UI8 },

        { L&quot;DBTYPE_STR&quot;, DBTYPE_STR },      { L&quot;CHARACTER&quot;, DBTYPE_STR },
        { L&quot;LSTRING&quot;, DBTYPE_STR },         { L&quot;ZSTRING&quot;, DBTYPE_STR },
        { L&quot;NOTE&quot;, DBTYPE_STR },            { L&quot;CHAR&quot;, DBTYPE_STR },
        { L&quot;VARCHAR&quot;, DBTYPE_STR },         { L&quot;LONGVARCHAR&quot;, DBTYPE_STR },
        { L&quot;BLOB&quot;, DBTYPE_STR },            { L&quot;TINYBLOB&quot;, DBTYPE_STR },
        { L&quot;MEDIUMBLOB&quot;, DBTYPE_STR },      { L&quot;LONGBLOB&quot;, DBTYPE_STR },
        { L&quot;TEXT&quot;, DBTYPE_STR },            { L&quot;TINYTEXT&quot;, DBTYPE_STR },
        { L&quot;MEDIUMTEXT&quot;, DBTYPE_STR },      { L&quot;LONGTEXT&quot;, DBTYPE_STR },
        { L&quot;NULL&quot;, DBTYPE_STR },            { L&quot;ENUM&quot;, DBTYPE_STR },
        { L&quot;SET&quot;, DBTYPE_STR },

        { L&quot;NCHAR&quot;, DBTYPE_WSTR },          { L&quot;NCHAR VARYING&quot;, DBTYPE_WSTR },

        { L&quot;DBTYPE_BYTES&quot;, DBTYPE_BYTES },  { L&quot;LVAR&quot;, DBTYPE_BYTES },
        { L&quot;LONG VARBINARY&quot;, DBTYPE_BYTES },{ L&quot;LONGVARBINARY&quot;, DBTYPE_BYTES },
        { L&quot;BINARY&quot;, DBTYPE_BYTES },        { L&quot;BIT&quot;, DBTYPE_BYTES },
        { L&quot;BIT VARYING&quot;, DBTYPE_BYTES },

        { L&quot;DBTYPE_DBDATE&quot;, DBTYPE_DBDATE },{ L&quot;DATE&quot;, DBTYPE_DBDATE },

        { L&quot;DBTYPE_DBTIME&quot;, DBTYPE_DBTIME },{ L&quot;TIME&quot;, DBTYPE_DBTIME },

        { L&quot;DBTYPE_DBTIMESTAMP&quot;, DBTYPE_DBTIMESTAMP },
        { L&quot;TIMESTAMP&quot;, DBTYPE_DBTIMESTAMP },
        { L&quot;DATETIME&quot;, DBTYPE_DBTIMESTAMP },
    };

    if(pwszName==NULL) return DBTYPE_WSTR;

    for(int i=1;i&lt;sizeof(types)/sizeof(*types);i++)
    {
        if(_wcsicmp(pwszName, types[i].pwszName)==0)
            return types[i].wType;
    }

    return DBTYPE_STR;
}

static HRESULT CompareSTR(DBCOMPAREOP CompareOp, const char *szRowValue, const char *szFindValue)
{
    DBCOMPAREOP LocalOp = CompareOp &amp; ~DBCOMPAREOPS_CASESENSITIVE &amp; ~DBCOMPAREOPS_CASEINSENSITIVE;

    switch(LocalOp)
    {
    case DBCOMPAREOPS_LT:
    case DBCOMPAREOPS_LE:
    case DBCOMPAREOPS_EQ:
    case DBCOMPAREOPS_GE:
    case DBCOMPAREOPS_GT:
    case DBCOMPAREOPS_NE:
        {
            // 디폴트는 case sensitive
            int res;
            if(CompareOp &amp; DBCOMPAREOPS_CASEINSENSITIVE)
                res = _stricmp(szRowValue, szFindValue);
            else
                res = strcmp(szRowValue, szFindValue);

            if( ( LocalOp==DBCOMPAREOPS_LT &amp;&amp; res&lt; 0 ) ||
                ( LocalOp==DBCOMPAREOPS_LE &amp;&amp; res&lt;=0 ) ||
                ( LocalOp==DBCOMPAREOPS_EQ &amp;&amp; res==0 ) ||
                ( LocalOp==DBCOMPAREOPS_GE &amp;&amp; res&gt;=0 ) ||
                ( LocalOp==DBCOMPAREOPS_GT &amp;&amp; res&gt; 0 ) ||
                ( LocalOp==DBCOMPAREOPS_NE &amp;&amp; res!=0 ) )
                return S_OK;

            return S_FALSE;
        }

    case DBCOMPAREOPS_BEGINSWITH:
        {
            int res;
            size_t len = strlen(szFindValue);
            if(CompareOp &amp; DBCOMPAREOPS_CASEINSENSITIVE)
                res = _strnicmp(szRowValue, szFindValue, len);
            else
                res = strncmp(szRowValue, szFindValue, len);
            return res==0 ? S_OK : S_FALSE;
        }
    case DBCOMPAREOPS_NOTBEGINSWITH:
        {
            int res;
            size_t len = strlen(szFindValue);
            if(CompareOp &amp; DBCOMPAREOPS_CASEINSENSITIVE)
                res = _strnicmp(szRowValue, szFindValue, len);
            else
                res = strncmp(szRowValue, szFindValue, len);
            return res!=0 ? S_OK : S_FALSE;
        }

    // TODO: case insensitive
    case DBCOMPAREOPS_CONTAINS:
        {
            const char *res;
            if(CompareOp &amp; DBCOMPAREOPS_CASEINSENSITIVE)
            {
                CStringA row(szRowValue), find(szFindValue);
                row.MakeUpper(); find.MakeUpper();
                res = strstr(row, find);
            }
            else
                res = strstr(szRowValue, szFindValue);
            return res!=0 ? S_OK : S_FALSE;
        }
    case DBCOMPAREOPS_NOTCONTAINS:
        {
            const char *res;
            if(CompareOp &amp; DBCOMPAREOPS_CASEINSENSITIVE)
            {
                CStringA row(szRowValue), find(szFindValue);
                row.MakeUpper(); find.MakeUpper();
                res = strstr(row, find);
            }
            else
                res = strstr(szRowValue, szFindValue);
            return res==0 ? S_OK : S_FALSE;
        }
    }

    return DB_E_BADCOMPAREOP;
}

static HRESULT CompareI4(DBCOMPAREOP CompareOp, const char *szRowValue, const char *szFindValue)
{
    if( CompareOp!=DBCOMPAREOPS_LT &amp;&amp; CompareOp!=DBCOMPAREOPS_LE &amp;&amp;
        CompareOp!=DBCOMPAREOPS_EQ &amp;&amp; CompareOp!=DBCOMPAREOPS_NE &amp;&amp;
        CompareOp!=DBCOMPAREOPS_GE &amp;&amp; CompareOp!=DBCOMPAREOPS_GT )
        return DB_E_BADCOMPAREOP;

    int nRowValue = atoi(szRowValue);
    int nFindValue = atoi(szFindValue);

    if( ( CompareOp==DBCOMPAREOPS_LT &amp;&amp; nRowValue&lt; nFindValue ) ||
        ( CompareOp==DBCOMPAREOPS_LE &amp;&amp; nRowValue&lt;=nFindValue ) ||
        ( CompareOp==DBCOMPAREOPS_EQ &amp;&amp; nRowValue==nFindValue ) ||
        ( CompareOp==DBCOMPAREOPS_GE &amp;&amp; nRowValue&gt;=nFindValue ) ||
        ( CompareOp==DBCOMPAREOPS_GT &amp;&amp; nRowValue&gt; nFindValue ) ||
        ( CompareOp==DBCOMPAREOPS_NE &amp;&amp; nRowValue!=nFindValue ) )
        return S_OK;
    return S_FALSE;
}

static HRESULT CompareI2(DBCOMPAREOP CompareOp, const char *szRowValue, const char *szFindValue)
{
    if( CompareOp!=DBCOMPAREOPS_LT &amp;&amp; CompareOp!=DBCOMPAREOPS_LE &amp;&amp;
        CompareOp!=DBCOMPAREOPS_EQ &amp;&amp; CompareOp!=DBCOMPAREOPS_NE &amp;&amp;
        CompareOp!=DBCOMPAREOPS_GE &amp;&amp; CompareOp!=DBCOMPAREOPS_GT )
        return DB_E_BADCOMPAREOP;

    short nRowValue = (short)atoi(szRowValue);
    short nFindValue = (short)atoi(szFindValue);

    if( ( CompareOp==DBCOMPAREOPS_LT &amp;&amp; nRowValue&lt; nFindValue ) ||
        ( CompareOp==DBCOMPAREOPS_LE &amp;&amp; nRowValue&lt;=nFindValue ) ||
        ( CompareOp==DBCOMPAREOPS_EQ &amp;&amp; nRowValue==nFindValue ) ||
        ( CompareOp==DBCOMPAREOPS_GE &amp;&amp; nRowValue&gt;=nFindValue ) ||
        ( CompareOp==DBCOMPAREOPS_GT &amp;&amp; nRowValue&gt; nFindValue ) ||
        ( CompareOp==DBCOMPAREOPS_NE &amp;&amp; nRowValue!=nFindValue ) )
        return S_OK;
    return S_FALSE;
}

static HRESULT CompareR4(DBCOMPAREOP CompareOp, const char *szRowValue, const char *szFindValue)
{
    if( CompareOp!=DBCOMPAREOPS_LT &amp;&amp; CompareOp!=DBCOMPAREOPS_LE &amp;&amp;
        CompareOp!=DBCOMPAREOPS_EQ &amp;&amp; CompareOp!=DBCOMPAREOPS_NE &amp;&amp;
        CompareOp!=DBCOMPAREOPS_GE &amp;&amp; CompareOp!=DBCOMPAREOPS_GT )
        return DB_E_BADCOMPAREOP;

    float fRowValue = (float)atof(szRowValue);
    float fFindValue = (float)atof(szFindValue);

    if( ( CompareOp==DBCOMPAREOPS_LT &amp;&amp; fRowValue&lt; fFindValue ) ||
        ( CompareOp==DBCOMPAREOPS_LE &amp;&amp; fRowValue&lt;=fFindValue ) ||
        ( CompareOp==DBCOMPAREOPS_EQ &amp;&amp; fRowValue==fFindValue ) ||
        ( CompareOp==DBCOMPAREOPS_GE &amp;&amp; fRowValue&gt;=fFindValue ) ||
        ( CompareOp==DBCOMPAREOPS_GT &amp;&amp; fRowValue&gt; fFindValue ) ||
        ( CompareOp==DBCOMPAREOPS_NE &amp;&amp; fRowValue!=fFindValue ) )
        return S_OK;
    return S_FALSE;
}

static HRESULT CompareR8(DBCOMPAREOP CompareOp, const char *szRowValue, const char *szFindValue)
{
    if( CompareOp!=DBCOMPAREOPS_LT &amp;&amp; CompareOp!=DBCOMPAREOPS_LE &amp;&amp;
        CompareOp!=DBCOMPAREOPS_EQ &amp;&amp; CompareOp!=DBCOMPAREOPS_NE &amp;&amp;
        CompareOp!=DBCOMPAREOPS_GE &amp;&amp; CompareOp!=DBCOMPAREOPS_GT )
        return DB_E_BADCOMPAREOP;

    double dRowValue = atof(szRowValue);
    double dFindValue = atof(szFindValue);

    if( ( CompareOp==DBCOMPAREOPS_LT &amp;&amp; dRowValue&lt; dFindValue ) ||
        ( CompareOp==DBCOMPAREOPS_LE &amp;&amp; dRowValue&lt;=dFindValue ) ||
        ( CompareOp==DBCOMPAREOPS_EQ &amp;&amp; dRowValue==dFindValue ) ||
        ( CompareOp==DBCOMPAREOPS_GE &amp;&amp; dRowValue&gt;=dFindValue ) ||
        ( CompareOp==DBCOMPAREOPS_GT &amp;&amp; dRowValue&gt; dFindValue ) ||
        ( CompareOp==DBCOMPAREOPS_NE &amp;&amp; dRowValue!=dFindValue ) )
        return S_OK;
    return S_FALSE;
}

HRESULT Compare(DBCOMPAREOP CompareOp, DBTYPE wType, const char *szRowValue, const char *szFindValue)
{
    switch(wType)
    {
    case DBTYPE_STR:
    case DBTYPE_WSTR:
        return CompareSTR(CompareOp, szRowValue, szFindValue);
        break;

    case DBTYPE_I4:
        return CompareI4(CompareOp, szRowValue, szFindValue);

    case DBTYPE_I2:
        return CompareI2(CompareOp, szRowValue, szFindValue);

    case DBTYPE_R4:
        return CompareR4(CompareOp, szRowValue, szFindValue);

    case DBTYPE_R8:
        return CompareR8(CompareOp, szRowValue, szFindValue);

    default:
        return DB_E_BADCOMPAREOP;
        break;
    }
}

long GetFindCompareOps(DBTYPE wType)
{
    switch(wType)
    {
    case DBTYPE_STR:
    case DBTYPE_WSTR:
        return DBPROPVAL_CO_EQUALITY | DBPROPVAL_CO_STRING | DBPROPVAL_CO_CONTAINS
                | DBPROPVAL_CO_BEGINSWITH | DBPROPVAL_CO_CASEINSENSITIVE;
    case DBTYPE_I4:
    case DBTYPE_I2:
    case DBTYPE_R4:
    case DBTYPE_R8:
        return DBPROPVAL_CO_EQUALITY;
    }
    return 0;
}

// 원래 VARIANT_BOOL은 VARIANT_TRUE와 VARIANT_FALSE만을 갖지만 1을 가지는 경우도 있다.
// 이경우 GetDBStatus에서 DBSTATUS_S_ISNULL을 반환하고, 값은 무시되므로 괜찮다.
static StaticTypeInfo static_type_infos[] = {
    // CCI type,           OLEDB type,     size, prefix, suffix, case sensitive, searchable,        unsigned,      fixed length,  long,          fixed p&amp;s
    { CCI_U_TYPE_UNKNOWN,  DBTYPE_STR,  4000, L&quot;&quot;,   L&quot;&quot;,  VARIANT_TRUE, DB_SEARCHABLE,    1,             VARIANT_FALSE, VARIANT_FALSE, VARIANT_TRUE  },
    { CCI_U_TYPE_CHAR,     DBTYPE_STR,  1073741823, L&quot;&#39;&quot;,  L&quot;&#39;&quot;, VARIANT_TRUE,  DB_SEARCHABLE,      1,             VARIANT_TRUE,  VARIANT_TRUE,  VARIANT_TRUE  },
    { CCI_U_TYPE_STRING,   DBTYPE_STR,  1073741823, L&quot;&#39;&quot;,  L&quot;&#39;&quot;, VARIANT_TRUE,  DB_SEARCHABLE,      1,             VARIANT_FALSE, VARIANT_TRUE,  VARIANT_TRUE  },
    // TODO: NCHAR와 WSTR은 좀 차이가 있다. 그래서 문제가 생길 여지가 좀 있는데
    //       그렇다고 STR으로 할 수는 없어서, WSTR으로 한다.
    { CCI_U_TYPE_NCHAR,    DBTYPE_WSTR,  536870911/2, L&quot;N&#39;&quot;, L&quot;&#39;&quot;, VARIANT_TRUE,  DB_SEARCHABLE,      1,             VARIANT_TRUE,  VARIANT_TRUE,  VARIANT_TRUE  },
    { CCI_U_TYPE_VARNCHAR, DBTYPE_WSTR,  536870911/2, L&quot;N&#39;&quot;, L&quot;&#39;&quot;, VARIANT_TRUE,  DB_SEARCHABLE,      1,             VARIANT_FALSE, VARIANT_TRUE,  VARIANT_TRUE  },
    // TODO: 크기를 1073741823로 해야 하는지, 268435455 또는 134217727으로 해야 하는지 모르겠음
    //       LTM에서는 &#39;F111...&#39;과 같은 데이터를 만들어서 prefix는 16진수를 쓰는 걸로 함
    { CCI_U_TYPE_BIT,     DBTYPE_BYTES, 1073741823, L&quot;X&#39;&quot;, L&quot;&#39;&quot;, VARIANT_FALSE, DB_ALL_EXCEPT_LIKE, 1,             VARIANT_TRUE,  VARIANT_TRUE,  VARIANT_TRUE  },
    { CCI_U_TYPE_VARBIT,  DBTYPE_BYTES, 1073741823, L&quot;X&#39;&quot;, L&quot;&#39;&quot;, VARIANT_FALSE, DB_ALL_EXCEPT_LIKE, 1,             VARIANT_FALSE, VARIANT_TRUE,  VARIANT_TRUE  },
    { CCI_U_TYPE_NUMERIC,  DBTYPE_NUMERIC,      38, L&quot;&quot;,   L&quot;&quot;,  VARIANT_FALSE, DB_ALL_EXCEPT_LIKE, VARIANT_FALSE, VARIANT_FALSE, VARIANT_FALSE, VARIANT_TRUE  },
    { CCI_U_TYPE_INT,      DBTYPE_I4,           10, L&quot;&quot;,   L&quot;&quot;,  VARIANT_FALSE, DB_ALL_EXCEPT_LIKE, VARIANT_FALSE, VARIANT_TRUE,  VARIANT_FALSE, VARIANT_TRUE  },
    { CCI_U_TYPE_SHORT,    DBTYPE_I2,            5, L&quot;&quot;,   L&quot;&quot;,  VARIANT_FALSE, DB_ALL_EXCEPT_LIKE, VARIANT_FALSE, VARIANT_TRUE,  VARIANT_FALSE, VARIANT_TRUE  },
    { CCI_U_TYPE_MONETARY, DBTYPE_R8,           15, L&quot;&quot;,   L&quot;&quot;,  VARIANT_FALSE, DB_ALL_EXCEPT_LIKE, VARIANT_FALSE, VARIANT_TRUE,  VARIANT_FALSE, VARIANT_FALSE },
    { CCI_U_TYPE_FLOAT,    DBTYPE_R4,            7, L&quot;&quot;,   L&quot;&quot;,  VARIANT_FALSE, DB_ALL_EXCEPT_LIKE, VARIANT_FALSE, VARIANT_TRUE,  VARIANT_FALSE, VARIANT_FALSE },
    { CCI_U_TYPE_DOUBLE,   DBTYPE_R8,           15, L&quot;&quot;,   L&quot;&quot;,  VARIANT_FALSE, DB_ALL_EXCEPT_LIKE, VARIANT_FALSE, VARIANT_TRUE,  VARIANT_FALSE, VARIANT_FALSE },
    { CCI_U_TYPE_DATE,     DBTYPE_DBDATE,       10, L&quot;&#39;&quot;,  L&quot;&#39;&quot;, VARIANT_FALSE, DB_ALL_EXCEPT_LIKE, 1,             VARIANT_TRUE,  VARIANT_FALSE, VARIANT_TRUE  },
    // NOTE: time의 &#39;am&#39;, &#39;pm&#39; 자리까지 생각해서 size를 정하면
  //       LTM은 1/100초 자리로 생각을 함. 그래서 뺌
    { CCI_U_TYPE_TIME,     DBTYPE_DBTIME,        8, L&quot;&#39;&quot;,  L&quot;&#39;&quot;, VARIANT_FALSE, DB_ALL_EXCEPT_LIKE, 1,             VARIANT_TRUE,  VARIANT_FALSE, VARIANT_TRUE  },
    { CCI_U_TYPE_TIMESTAMP, DBTYPE_DBTIMESTAMP, 19, L&quot;&#39;&quot;,  L&quot;&#39;&quot;, VARIANT_FALSE, DB_ALL_EXCEPT_LIKE, 1,             VARIANT_TRUE,  VARIANT_FALSE, VARIANT_TRUE  },
    // TODO: mapping to DBTYPE_IUnknown?
    { CCI_U_TYPE_OBJECT,   DBTYPE_STR,  1073741823, L&quot;&#39;&quot;,  L&quot;&#39;&quot;, VARIANT_TRUE,  DB_SEARCHABLE,      1,             VARIANT_FALSE, VARIANT_TRUE,  VARIANT_TRUE  },
    { CCI_U_TYPE_MULTISET,   DBTYPE_STR,  1073741823, L&quot;&#39;&quot;,  L&quot;&#39;&quot;, VARIANT_TRUE,  DB_SEARCHABLE,      1,             VARIANT_FALSE, VARIANT_TRUE,  VARIANT_TRUE  },
    { CCI_U_TYPE_SET,   DBTYPE_STR,  1073741823, L&quot;&#39;&quot;,  L&quot;&#39;&quot;, VARIANT_TRUE,  DB_SEARCHABLE,      1,             VARIANT_FALSE, VARIANT_TRUE,  VARIANT_TRUE  },
};

const StaticTypeInfo &amp;GetStaticTypeInfo(T_CCI_U_TYPE nCCIUType)
{
    for(int i=1;i&lt;sizeof(static_type_infos)/sizeof(*static_type_infos);i++)
    {
        if(static_type_infos[i].nCCIUType==nCCIUType)
            return static_type_infos[i];
    }
    return static_type_infos[0];
}

DynamicTypeInfo GetDynamicTypeInfo(T_CCI_U_TYPE nCCIUType, int nPrecision, int nScale, bool bNullable)
{
    /* 스펙엔 &#39;this is the size of the data type&#39;라고 되어 있어서
     * ulColumnSize = StaticTypeInfo::ulSize (문자열로 봤을 때의 길이) 라고 생각했으나
     * LTM을 보니 저장공간의 크기를 말하는 것 같다.
     */
    DynamicTypeInfo dyn_info;
    const StaticTypeInfo &amp;sta_info = GetStaticTypeInfo(nCCIUType);

    dyn_info.ulFlags = 0;
    dyn_info.ulFlags |= DBCOLUMNFLAGS_WRITEUNKNOWN;
    dyn_info.ulFlags |= DBCOLUMNFLAGS_ISFIXEDLENGTH;
    if(bNullable)
        dyn_info.ulFlags |= DBCOLUMNFLAGS_ISNULLABLE | DBCOLUMNFLAGS_MAYBENULL;
    dyn_info.ulColumnSize = (ULONG)~0;
    dyn_info.bPrecision = ~0;
    dyn_info.bScale = ~0;
    dyn_info.ulCharMaxLength = (ULONG)~0;
    dyn_info.ulCharOctetLength = (ULONG)~0;
    dyn_info.nNumericPrecision = (USHORT)~0;
    dyn_info.nNumericScale = -1;
    dyn_info.ulDateTimePrecision = (ULONG)~0;

    switch(nCCIUType)
    {
    case CCI_U_TYPE_STRING:
    case CCI_U_TYPE_VARNCHAR:
        dyn_info.ulFlags &amp;= ~DBCOLUMNFLAGS_ISFIXEDLENGTH; // 주의 break 없음
    case CCI_U_TYPE_CHAR:
    case CCI_U_TYPE_NCHAR:
        if(nCCIUType==CCI_U_TYPE_VARNCHAR || nCCIUType==CCI_U_TYPE_NCHAR)
            dyn_info.ulColumnSize = nPrecision / 2;
        else
            dyn_info.ulColumnSize = nPrecision;

        dyn_info.ulCharMaxLength = dyn_info.ulColumnSize;
        dyn_info.ulCharOctetLength = dyn_info.ulCharMaxLength;
        if(nCCIUType==CCI_U_TYPE_VARNCHAR || nCCIUType==CCI_U_TYPE_NCHAR)
        {
            dyn_info.ulCharOctetLength *= 2; // TODO: 좀 다르긴 하지만 LTM을 위해 일단 2배를 한다.
        }
        break;

    case CCI_U_TYPE_VARBIT:
        dyn_info.ulFlags &amp;= ~DBCOLUMNFLAGS_ISFIXEDLENGTH; // 주의 break 없음
    case CCI_U_TYPE_BIT:
        // TODO: Maximum length니까 올림을 하는게 맞을 것 같은데, 하면 LTM은
        //       BYTE단위로 데이터를 만들어서 BIT로 보면 초과해서 에러가 난다.
        dyn_info.ulColumnSize = (int)(nPrecision/8);
        dyn_info.ulCharMaxLength = dyn_info.ulColumnSize;
        dyn_info.ulCharOctetLength = dyn_info.ulCharMaxLength;
        break;

    case CCI_U_TYPE_NUMERIC:
        dyn_info.ulColumnSize = sizeof(DB_NUMERIC);
        dyn_info.bPrecision = nPrecision;
        dyn_info.bScale = nScale;
        dyn_info.nNumericPrecision = dyn_info.bPrecision;
        dyn_info.nNumericScale = dyn_info.bScale;
        break;

    case CCI_U_TYPE_INT:
        dyn_info.ulColumnSize = 4;
        dyn_info.bPrecision = (BYTE)sta_info.ulSize;
        dyn_info.nNumericPrecision = dyn_info.bPrecision;
        break;

    case CCI_U_TYPE_SHORT:
        dyn_info.ulColumnSize = 2;
        dyn_info.bPrecision = (BYTE)sta_info.ulSize;
        dyn_info.nNumericPrecision = dyn_info.bPrecision;
        break;

    case CCI_U_TYPE_MONETARY:
        dyn_info.ulColumnSize = sizeof(double);
        dyn_info.bPrecision = (BYTE)sta_info.ulSize;
        dyn_info.nNumericPrecision = dyn_info.bPrecision;
        break;

    case CCI_U_TYPE_FLOAT:
        dyn_info.ulColumnSize = sizeof(float);
        dyn_info.bPrecision = (BYTE)sta_info.ulSize;
        dyn_info.nNumericPrecision = dyn_info.bPrecision;
        break;

    case CCI_U_TYPE_DOUBLE:
        dyn_info.ulColumnSize = sizeof(double);
        dyn_info.bPrecision = (BYTE)sta_info.ulSize;
        dyn_info.nNumericPrecision = dyn_info.bPrecision;
        break;

    case CCI_U_TYPE_DATE:
        dyn_info.ulColumnSize = sizeof(DBDATE);
        break;

    case CCI_U_TYPE_TIME:
        dyn_info.ulColumnSize = sizeof(DBTIME);
        break;

    case CCI_U_TYPE_TIMESTAMP:
        dyn_info.ulColumnSize = sizeof(DBTIMESTAMP);
        dyn_info.bPrecision = (BYTE)sta_info.ulSize;
        dyn_info.bScale = 0;
        dyn_info.ulDateTimePrecision = dyn_info.bScale;
        break;

    case CCI_U_TYPE_OBJECT:
        //dyn_info.ulColumnSize = nPrecision;
        //OID 스트링 max length를 15로 보고 수정
        dyn_info.ulColumnSize = 15;
        dyn_info.ulCharMaxLength = dyn_info.ulColumnSize;
        dyn_info.ulCharOctetLength = dyn_info.ulCharMaxLength;
        break;

    case CCI_U_TYPE_SET:
    case CCI_U_TYPE_MULTISET:
        ATLTRACE(atlTraceDBProvider, 2, _T(&quot;Here!!\n&quot;));
        dyn_info.ulColumnSize = nPrecision;
        dyn_info.ulCharMaxLength = dyn_info.ulColumnSize;
        dyn_info.ulCharOctetLength = dyn_info.ulCharMaxLength;
        break;
    default:
        dyn_info.ulColumnSize = sta_info.ulSize;
        dyn_info.ulCharMaxLength = sta_info.ulSize;
        dyn_info.ulCharOctetLength = sta_info.ulSize;
        break;
    }

    if(dyn_info.ulColumnSize&gt;8000) // 8000은 atldbcli.h의 CDynamicAccessor가 쓰는 값
        dyn_info.ulFlags |= DBCOLUMNFLAGS_ISLONG;

    return dyn_info;
}

static HRESULT GetTableInfo_FetchData(int hReq, TableInfo &amp;info)
{
    char *strval;
    int intval, ind, res;
    T_CCI_ERROR err_buf;

    res = cci_fetch(hReq, &amp;err_buf);
    if(res&lt;0) return E_FAIL;

    res = cci_get_data(hReq, 12, CCI_A_TYPE_STR, &amp;strval, &amp;ind);
    if(res&lt;0) return E_FAIL;
    info.strSourceClass = CA2W(strval);

    res = cci_get_data(hReq, 10, CCI_A_TYPE_INT, &amp;intval, &amp;ind);
    if(res&lt;0) return E_FAIL;
    info.iOrdinal = intval;

    res = cci_get_data(hReq, 8, CCI_A_TYPE_INT, &amp;intval, &amp;ind);
    if(res&lt;0) return E_FAIL;
    info.bIsUnique = (intval==1);
    ::VariantClear(&amp;info.varDefault);
    res = cci_get_data(hReq, 9, CCI_A_TYPE_STR, &amp;strval, &amp;ind);
    if(res&lt;0) return E_FAIL;
    if(ind!=-1)
    {
        CComVariant var = strval;
        var.Detach(&amp;info.varDefault);
    }

    return S_OK;
}

HRESULT GetTableInfo(int hConn, char *szTableName, CAtlArray&lt;TableInfo&gt; &amp;infos)
{
    // 기존의 데이터 모두 삭제
    infos.RemoveAll();

    T_CCI_ERROR err_buf;
    int hReq = cci_schema_info(hConn, CCI_SCH_ATTRIBUTE, szTableName, NULL,
                    CCI_CLASS_NAME_PATTERN_MATCH | CCI_ATTR_NAME_PATTERN_MATCH, &amp;err_buf);
    if(hReq&lt;0)
    {
        ATLTRACE2(&quot;GetTableInfo: cci_schema_info fail\n&quot;);
        return E_FAIL;
    }

    int res = cci_cursor(hReq, 1, CCI_CURSOR_FIRST, &amp;err_buf);
    if(res==CCI_ER_NO_MORE_DATA) goto done;
    if(res&lt;0) goto error;

    size_t cur = 0;
    while(1)
    {
        infos.SetCount(infos.GetCount()+1);
        HRESULT hr = GetTableInfo_FetchData(hReq, infos[cur]);
        if(FAILED(hr)) goto error;

        res = cci_cursor(hReq, 1, CCI_CURSOR_CURRENT, &amp;err_buf);
        if(res==CCI_ER_NO_MORE_DATA) goto done;
        if(res&lt;0) goto error;

        cur++;
    }

error:
    ATLTRACE2(&quot;GetTableInfo: fail to fetch data\n&quot;);
    cci_close_req_handle(hReq);
    infos.RemoveAll();
    return E_FAIL;
done:
    cci_close_req_handle(hReq);
    return S_OK;
}

}

/*
create table ztest (c1 char, c2 char(20), c3 varchar, c4 varchar(20), c5 nchar, c6 nchar(20),
c7 nchar varying, c8 nchar varying(20), c9 bit, c10 bit(20), c11 bit varying, c12 bit varying(20),
c13 numeric, c14 numeric(10), c15 numeric(15,8), c16 int, c17 smallint, c18 float, c19 float(5),
c20 float(14), c21 double, c22 monetary, c23 date, c24 time, c25 timestamp, c26 set(varchar(20), int),
c27 set(), c28 multiset(float, int), c29 list(float,int), c30 sequence())

***** cci_schema_info의 결과값 *****
name, domain, scale, precision, indexed, non_null, shared, unique, default, attr_order, class_name, source_class
c1  1   0   1           0   0   0   0   null    1   ztest   ztest   : character(1)
c2  1   0   20          0   0   0   0   null    2   ztest   ztest   : character(20)
c3  2   0   1073741823  0   0   0   0   null    3   ztest   ztest   : character varying(1073741823)
c4  2   0   20          0   0   0   0   null    4   ztest   ztest   : character varying(20)
c5  3   0   1           0   0   0   0   null    5   ztest   ztest   : national character(1)
c6  3   0   20          0   0   0   0   null    6   ztest   ztest   : national character(20)
c7  4   0   536870911   0   0   0   0   null    7   ztest   ztest   : national character varying(536870911)
c8  4   0   20          0   0   0   0   null    8   ztest   ztest   : national character varying(20)
c9  5   0   1           0   0   0   0   null    9   ztest   ztest   : bit(1)
c10 5   0   20          0   0   0   0   null    10  ztest   ztest   : bit(20)
c11 6   0   1073741823  0   0   0   0   null    11  ztest   ztest   : bit varying(1073741823)
c12 6   0   20          0   0   0   0   null    12  ztest   ztest   : bit varying(20)
c13 7   0   15          0   0   0   0   null    13  ztest   ztest   : numeric(15,0)
c14 7   0   10          0   0   0   0   null    14  ztest   ztest   : numeric(10,0)
c15 7   8   15          0   0   0   0   null    15  ztest   ztest   : numeric(15,8)
c16 8   0   0           0   0   0   0   null    16  ztest   ztest   : integer
c17 9   0   0           0   0   0   0   null    17  ztest   ztest   : smallint
c18 11  0   0           0   0   0   0   null    18  ztest   ztest   : float
c19 11  0   0           0   0   0   0   null    19  ztest   ztest   : float
c20 11  0   0           0   0   0   0   null    20  ztest   ztest   : float
c21 12  0   0           0   0   0   0   null    21  ztest   ztest   : double
c22 10  0   0           0   0   0   0   null    22  ztest   ztest   : monetary
c23 13  0   0           0   0   0   0   null    23  ztest   ztest   : date
c24 14  0   0           0   0   0   0   null    24  ztest   ztest   : time
c25 15  0   0           0   0   0   0   null    25  ztest   ztest   : timestamp
c26 -1  0   0           0   0   0   0   null    26  ztest   ztest   : set_of(character varying(20), integer)
c27 -1  0   0           0   0   0   0   null    27  ztest   ztest   : set_of()
c28 -1  0   0           0   0   0   0   null    28  ztest   ztest   : multiset_of(float, integer)
c29 -1  0   0           0   0   0   0   null    29  ztest   ztest   : sequence_of(float, integer)
c30 -1  0   0           0   0   0   0   null    30  ztest   ztest   : sequence_of()

***** cci_get_result_info의 결과값 *****
type, is_non_null, scale, precision, col_name, real_attr, class_name
1   0   0   1           c1  null    ztest
1   0   0   20          c2  null    ztest
2   0   0   1073741823  c3  null    ztest
2   0   0   20          c4  null    ztest
3   0   0   1           c5  null    ztest
3   0   0   20          c6  null    ztest
4   0   0   536870911   c7  null    ztest
4   0   0   20          c8  null    ztest
5   0   0   1           c9  null    ztest
5   0   0   20          c10 null    ztest
6   0   0   1073741823  c11 null    ztest
6   0   0   20          c12 null    ztest
7   0   0   15          c13 null    ztest
7   0   0   10          c14 null    ztest
7   0   8   15          c15 null    ztest
8   0   0   0           c16 null    ztest
9   0   0   0           c17 null    ztest
11  0   0   0           c18 null    ztest
11  0   0   0           c19 null    ztest
11  0   0   0           c20 null    ztest
12  0   0   0           c21 null    ztest
10  0   0   0           c22 null    ztest
13  0   0   0           c23 null    ztest
14  0   0   0           c24 null    ztest
15  0   0   0           c25 null    ztest
-1  0   0   0           c26 null    ztest
-1  0   0   0           c27 null    ztest
-1  0   0   0           c28 null    ztest
-1  0   0   0           c29 null    ztest
-1  0   0   0           c30 null    ztest
*/
</span></div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;            <span class="keywordflow">if</span> (colDesc.ulColumnSize)</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                <a class="code" href="atldb__cubrid_8h.html#a080c6299f67db3aab5e21e5e45f9e90f">colSize</a> *= 2;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;            sprintf(strColSize, <span class="stringliteral">&quot;(%ld)&quot;</span>, <a class="code" href="atldb__cubrid_8h.html#a080c6299f67db3aab5e21e5e45f9e90f">colSize</a>);</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;            strType.Append(strColSize);</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a3331febb5322b5e1fc0b1aff9d4109c7">CCI_U_TYPE_BIT</a> : </div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;            <span class="keywordflow">if</span> (bIsFixedLength)</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                strType.Append(L<span class="stringliteral">&quot;Bit&quot;</span>);</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                strType.Append(L<span class="stringliteral">&quot;Bit Varying&quot;</span>);</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;            <span class="comment">//사용자가 원하는 길이의 여덟 배로 저장해야 한다          if (colDesc.ulColumnSize)
                colSize *= 8;

            sprintf(strColSize, &quot;(%u)&quot;, colSize);
            strType.Append(strColSize);
            break;
        case CCI_U_TYPE_NUMERIC : 
            if (colDesc.bPrecision &lt; 1 || colDesc.bPrecision &gt; 38)
                return DB_E_BADPRECISION;

            if (colDesc.bPrecision &lt; colDesc.bScale)
                return DB_E_BADSCALE;

            strType.Append(L&quot;Numeric&quot;);
            sprintf(strColSize, &quot;(%ld,%ld)&quot;, colDesc.bPrecision, colDesc.bScale);
            strType.Append(strColSize);
            break;
        case CCI_U_TYPE_INT : strType.Append(L&quot;Integer&quot;);
            break;
        case CCI_U_TYPE_SHORT : strType.Append(L&quot;Smallint&quot;);
            break;
        case CCI_U_TYPE_MONETARY : strType.Append(L&quot;Monetary&quot;);
            break;
        case CCI_U_TYPE_FLOAT : strType.Append(L&quot;Float&quot;);
            break;
        case CCI_U_TYPE_DOUBLE : strType.Append(L&quot;Double&quot;);
            break;
        case CCI_U_TYPE_DATE : strType.Append(L&quot;Date&quot;);
            break;
        case CCI_U_TYPE_TIME : strType.Append(L&quot;Time&quot;);
            break;
        case CCI_U_TYPE_TIMESTAMP : strType.Append(L&quot;Timestamp&quot;);
            break;
        case CCI_U_TYPE_SET : strType.Append(L&quot;SET&quot;);
            break;
        case CCI_U_TYPE_MULTISET : strType.Append(L&quot;Multiset&quot;);
            break;
        case CCI_U_TYPE_SEQUENCE : strType.Append(L&quot;Sequence&quot;);
            break;
        case CCI_U_TYPE_OBJECT : strType.Append(L&quot;Object&quot;);
            break;
        default : strType.Append(L&quot;&quot;);
        }
    }

    if (bHasDefault)
    {
        strType.Append(L&quot; DEFAULT &quot;);
        strType.Append(defaultVal);
    }
    if (bIsPrimaryKey)
        strType.Append(L&quot; PRIMARY KEY &quot;);
    if (!bIsNullable)
        strType.Append(L&quot; NOT NULL &quot;);
    if (bIsUnique)
        strType.Append(L&quot; UNIQUE &quot;);

    return hr;
}

T_CCI_A_TYPE GetCASTypeA(DBTYPE wType)
{
    switch(wType)
    {
    case DBTYPE_I1:
    case DBTYPE_I2:
    case DBTYPE_I4:
    case DBTYPE_UI1:
    case DBTYPE_UI2:
    case DBTYPE_UI4:
        return CCI_A_TYPE_INT;
    case DBTYPE_I8:
    case DBTYPE_UI8:
        return CCI_A_TYPE_BIGINT;
    case DBTYPE_R4:
        return CCI_A_TYPE_FLOAT;
    case DBTYPE_R8:
        return CCI_A_TYPE_DOUBLE;
    case DBTYPE_BOOL:
    case DBTYPE_BYTES:
        return CCI_A_TYPE_BIT;
    case DBTYPE_DECIMAL:
    case DBTYPE_NUMERIC: 
    case DBTYPE_WSTR:
    case DBTYPE_BSTR:
    case DBTYPE_STR:
        return CCI_A_TYPE_STR;
    case DBTYPE_DBDATE:
    case DBTYPE_DBTIME:
    case DBTYPE_DBTIMESTAMP:
        return CCI_A_TYPE_DATE;
    }
    return CCI_A_TYPE_FIRST;
}

T_CCI_U_TYPE GetCASTypeU(DBTYPE wType)
{
    switch(wType)
    {
    case DBTYPE_I1:
        return CCI_U_TYPE_CHAR;
    case DBTYPE_I2:
        return CCI_U_TYPE_SHORT;
    case DBTYPE_I4:
        return CCI_U_TYPE_INT;
    case DBTYPE_R4:
        return CCI_U_TYPE_FLOAT;
    case DBTYPE_R8:
        return CCI_U_TYPE_DOUBLE;
    case DBTYPE_BOOL:
    case DBTYPE_BYTES:
        return CCI_U_TYPE_BIT;
    case DBTYPE_UI2:
    case DBTYPE_UI4:
    case DBTYPE_UI8:
    case DBTYPE_DECIMAL:
    case DBTYPE_NUMERIC:
        return CCI_U_TYPE_NUMERIC;
    case DBTYPE_DBDATE:
        return CCI_U_TYPE_DATE;
    case DBTYPE_DBTIME:
        return CCI_U_TYPE_TIME;
    case DBTYPE_DBTIMESTAMP:
        return CCI_U_TYPE_TIMESTAMP;
    case DBTYPE_BSTR: 
    case DBTYPE_WSTR:
        return CCI_U_TYPE_NCHAR;
    case DBTYPE_STR:
        return CCI_U_TYPE_STRING;             
    }
    return CCI_U_TYPE_UNKNOWN;
}

HRESULT OLEDBValueToCCIValue(DBTYPE wType, T_CCI_A_TYPE* aType, T_CCI_U_TYPE* uType,
        void *pValue, DBLENGTH dwLength, void** dstValue, DBSTATUS* status, const CComPtr&lt;IDataConvert&gt; &amp;spConvert)
{
    if(pValue==NULL) return E_FAIL;
    
    switch(wType)
    {
    case DBTYPE_UI1:
    case DBTYPE_I1:
        *dstValue = CoTaskMemAlloc(sizeof(int));
        *(int*)*dstValue = *(BYTE*)pValue;
        break;
    case DBTYPE_I2: 
        *dstValue = CoTaskMemAlloc(sizeof(int));
        *(int*)*dstValue = *(short*)pValue;
        break;
    case DBTYPE_I4:
        *dstValue = CoTaskMemAlloc(sizeof(int));
        *(int*)*dstValue = *(int*)pValue;
        break;
    case DBTYPE_I8:
        /*
        value = CoTaskMemAlloc(sizeof(LONGLONG));
        *(LONGLONG*)value = *(LONGLONG*)pValue;
        break;  
        */
        *status = DBSTATUS_E_DATAOVERFLOW;
        return DB_E_ERRORSOCCURRED;
    case DBTYPE_R4: 
        *dstValue = CoTaskMemAlloc(sizeof(float));
        *(float*)*dstValue = *(float*)pValue;
        break;  
    case DBTYPE_R8:
        *dstValue = CoTaskMemAlloc(sizeof(double));
        *(double*)*dstValue = *(double*)pValue;
        break;
    case DBTYPE_BOOL:
        *dstValue = CoTaskMemAlloc(sizeof(VARIANT));
        ((VARIANT *)*dstValue)-&gt;boolVal = ((VARIANT *)pValue)-&gt;boolVal;
        break;
    case DBTYPE_BYTES:
        *dstValue = CoTaskMemAlloc(sizeof(T_CCI_BIT));
        ((T_CCI_BIT *)*dstValue)-&gt;size = (int)dwLength;
        ((T_CCI_BIT *)*dstValue)-&gt;buf = 0;
        if(pValue &amp;&amp; dwLength&gt;0)
        {
            ((T_CCI_BIT *)*dstValue)-&gt;buf = (char *)CoTaskMemAlloc(dwLength);
            memcpy(((T_CCI_BIT *)*dstValue)-&gt;buf, pValue, dwLength);
        }
        break;
    case DBTYPE_BSTR:
    case DBTYPE_WSTR:
        /*{
        WCHAR *src = (WCHAR *)pValue;
        DBLENGTH DstLen;
        DBSTATUS dbStat = DBSTATUS_S_OK;
        DBLENGTH cbMaxLen = dwLength + 1;
        *dstValue = CoTaskMemAlloc(cbMaxLen + 1);
        HRESULT hr = spConvert-&gt;DataConvert(wType, DBTYPE_STR, dwLength, &amp;DstLen,
            src, *dstValue, cbMaxLen, dbStat, &amp;dbStat, 0, 0, 0);
        if (FAILED(hr)) return hr;
        }*/
        *dstValue = CoTaskMemAlloc((dwLength + 1) * sizeof(wchar_t));
        strcpy((char *)*dstValue, CW2A((wchar_t *)pValue));
        break;
    case DBTYPE_STR:
        /*{
        char *src = (char *)pValue;
        DBLENGTH DstLen;
        DBSTATUS dbStat = DBSTATUS_S_OK;
        DBLENGTH cbMaxLen = dwLength + 1;
        *dstValue = CoTaskMemAlloc(cbMaxLen + 1);
        HRESULT hr = spConvert-&gt;DataConvert(wType, DBTYPE_STR, dwLength, &amp;DstLen,
            src, *dstValue, cbMaxLen, dbStat, &amp;dbStat, 0, 0, 0);
        if (FAILED(hr)) return hr;
        }*/
        *dstValue = CoTaskMemAlloc((dwLength + 1) * sizeof(char));
        strcpy((char *)*dstValue, (char *)pValue);
        break;
    case DBTYPE_DBDATE:
        *dstValue = CoTaskMemAlloc(sizeof(T_CCI_DATE));
        ((T_CCI_DATE *)*dstValue)-&gt;yr = ((DBDATE *)pValue)-&gt;year;
        ((T_CCI_DATE *)*dstValue)-&gt;mon = ((DBDATE *)pValue)-&gt;month;
        ((T_CCI_DATE *)*dstValue)-&gt;day = ((DBDATE *)pValue)-&gt;day;
        break;
    case DBTYPE_DBTIME: 
        *dstValue = CoTaskMemAlloc(sizeof(T_CCI_DATE));
        ((T_CCI_DATE *)*dstValue)-&gt;hh = ((DBTIME *)pValue)-&gt;hour;
        ((T_CCI_DATE *)*dstValue)-&gt;mm = ((DBTIME *)pValue)-&gt;minute;
        ((T_CCI_DATE *)*dstValue)-&gt;ss = ((DBTIME *)pValue)-&gt;second;
        break;
    case DBTYPE_DBTIMESTAMP:
        *dstValue = CoTaskMemAlloc(sizeof(T_CCI_DATE));
        ((T_CCI_DATE *)*dstValue)-&gt;yr = ((DBTIMESTAMP *)pValue)-&gt;year;
        ((T_CCI_DATE *)*dstValue)-&gt;mon = ((DBTIMESTAMP *)pValue)-&gt;month;
        ((T_CCI_DATE *)*dstValue)-&gt;day = ((DBTIMESTAMP *)pValue)-&gt;day;
        ((T_CCI_DATE *)*dstValue)-&gt;hh = ((DBTIMESTAMP *)pValue)-&gt;hour;
        ((T_CCI_DATE *)*dstValue)-&gt;mm = ((DBTIMESTAMP *)pValue)-&gt;minute;
        ((T_CCI_DATE *)*dstValue)-&gt;ss = ((DBTIMESTAMP *)pValue)-&gt;second;
        break;
    case DBTYPE_DECIMAL:
    case DBTYPE_NUMERIC:
        {
            DB_NUMERIC *src = (DB_NUMERIC *)pValue;
            DBLENGTH DstLen;
            DBSTATUS dbStat = DBSTATUS_S_OK;
            DBLENGTH cbMaxLen = 41;
            *dstValue = CoTaskMemAlloc(cbMaxLen + 1);
            spConvert-&gt;DataConvert(DBTYPE_NUMERIC, DBTYPE_STR, sizeof(DB_NUMERIC), &amp;DstLen,
                src, *dstValue, cbMaxLen, dbStat, &amp;dbStat, src-&gt;precision, src-&gt;scale, 0);
        }
        break;
    case DBTYPE_VARIANT:
        {
            VARIANT* var = (VARIANT *)pValue;
            DBTYPE targetType = var-&gt;vt;
            DBLENGTH SrcLen = dwLength, DstLen;
            DBSTATUS dbStat = DBSTATUS_S_OK;
            DBLENGTH cbMaxLen = 0;

            switch (targetType)
            {
            case VT_UI1:
            case VT_I1:   
            case VT_I2:   
                            *dstValue = CoTaskMemAlloc(sizeof(short));
                            *aType = CCI_A_TYPE_INT;
                            *uType = CCI_U_TYPE_SHORT;
                            break;
            case VT_I4:
            case VT_INT:
            case VT_UINT:
                            *dstValue = CoTaskMemAlloc(sizeof(int));
                            *aType = CCI_A_TYPE_INT;
                            *uType = CCI_U_TYPE_INT;
                            break;
            case VT_I8:
                            *dstValue = CoTaskMemAlloc(sizeof(__int64));
                            *aType = CCI_A_TYPE_BIGINT;
                            *uType = CCI_U_TYPE_BIGINT;
                            break;
            case VT_R4:
                            *dstValue = CoTaskMemAlloc(sizeof(float));
                            *aType = CCI_A_TYPE_FLOAT;
                            *uType = CCI_U_TYPE_FLOAT;
                            break;
            case VT_R8:
                            *dstValue = CoTaskMemAlloc(sizeof(double));
                            *aType = CCI_A_TYPE_DOUBLE;
                            *uType = CCI_U_TYPE_DOUBLE;
                            break;
            case VT_DATE:
                            *dstValue = CoTaskMemAlloc(sizeof(T_CCI_DATE));
                            ((T_CCI_DATE *)*dstValue)-&gt;yr = ((DBTIMESTAMP *)pValue)-&gt;year;
                            ((T_CCI_DATE *)*dstValue)-&gt;mon = ((DBTIMESTAMP *)pValue)-&gt;month;
                            ((T_CCI_DATE *)*dstValue)-&gt;day = ((DBTIMESTAMP *)pValue)-&gt;day;
                            ((T_CCI_DATE *)*dstValue)-&gt;hh = ((DBTIMESTAMP *)pValue)-&gt;hour;
                            ((T_CCI_DATE *)*dstValue)-&gt;mm = ((DBTIMESTAMP *)pValue)-&gt;minute;
                            ((T_CCI_DATE *)*dstValue)-&gt;ss = ((DBTIMESTAMP *)pValue)-&gt;second;
                            *aType = CCI_A_TYPE_DATE;
                            *uType = CCI_U_TYPE_TIMESTAMP;
                            break;
            case VT_BSTR:   targetType = DBTYPE_STR;
                            *dstValue = CoTaskMemAlloc((2*dwLength) * sizeof(char) + 1);
                            dwLength *= 2;
                            cbMaxLen = dwLength + 1;
                            *aType = CCI_A_TYPE_STR;
                            *uType = CCI_U_TYPE_STRING;
                            break;
            case VT_DECIMAL:
                            DB_NUMERIC *src = (DB_NUMERIC *)pValue;
                            SrcLen = sizeof(DB_NUMERIC);
                            cbMaxLen = 41;
                            *dstValue = CoTaskMemAlloc(cbMaxLen + 1);
                            targetType = DBTYPE_STR;
                            *aType = CCI_A_TYPE_STR;
                            *uType = CCI_U_TYPE_NUMERIC;
            }
            
            if (targetType != VT_DATE)
            {
                HRESULT hr = spConvert-&gt;DataConvert(DBTYPE_VARIANT, targetType, SrcLen, &amp;DstLen,
                    var, *dstValue, cbMaxLen, dbStat, &amp;dbStat, 0, 0, 0);
                if (FAILED(hr)) return hr;
            }
        }
        break;
    }

    return S_OK;
}

DBTYPE GetOledbTypeFromName(LPCWSTR pwszName)
{
    const struct
    {
        LPCWSTR pwszName;
        DBTYPE wType;
    } types[] = {
        { L&quot;DBTYPE_I1&quot;, DBTYPE_I1 },        { L&quot;INTEGER(1)&quot;, DBTYPE_I1 },
        { L&quot;TINYINT&quot;, DBTYPE_I1 },

        { L&quot;DBTYPE_I2&quot;, DBTYPE_I2 },        { L&quot;INTEGER(2)&quot;, DBTYPE_I2 },
        { L&quot;AUTOINC(2)&quot;, DBTYPE_I2 },       { L&quot;SMALLINT&quot;, DBTYPE_I2 },
        { L&quot;SMALLINDENTITY&quot;, DBTYPE_I2 },   { L&quot;YEAR&quot;, DBTYPE_I2 },

        { L&quot;DBTYPE_I4&quot;, DBTYPE_I4 },        { L&quot;INTEGER(4)&quot;, DBTYPE_I4 },
        { L&quot;AUTOINC(4)&quot;, DBTYPE_I4 },       { L&quot;INTEGER&quot;, DBTYPE_I4 },
        { L&quot;MEDIUMINT&quot;, DBTYPE_I4 },        { L&quot;INT&quot;, DBTYPE_I4 },
        { L&quot;IDENTITY&quot;, DBTYPE_I4 },

        { L&quot;DBTYPE_I8&quot;, DBTYPE_I8 },        { L&quot;INTEGER(8)&quot;, DBTYPE_I8 },
        { L&quot;BIGINT&quot;, DBTYPE_I8 },

        { L&quot;DBTYPE_R4&quot;, DBTYPE_R4 },        { L&quot;FLOAT(4)&quot;, DBTYPE_R4 },
        { L&quot;BFLOAT(4)&quot;, DBTYPE_R4 },        { L&quot;REAL&quot;, DBTYPE_R4 },
        { L&quot;FLOAT&quot;, DBTYPE_R4 },            { L&quot;FLOAT UNSIGNED&quot;, DBTYPE_R4 },

        { L&quot;DBTYPE_R8&quot;, DBTYPE_R8 },        { L&quot;FLOAT(8)&quot;, DBTYPE_R8 },
        { L&quot;BFLOAT(8)&quot;, DBTYPE_R8 },        { L&quot;MONEY&quot;, DBTYPE_R8 },
        { L&quot;DECIMAL&quot;, DBTYPE_R8 },          { L&quot;DOUBLE&quot;, DBTYPE_R8 },
        { L&quot;DOUBLE UNSIGNED&quot;, DBTYPE_R8 },  { L&quot;DOUBLE PRECISION&quot;, DBTYPE_R8 },
        { L&quot;NUMERIC&quot;, DBTYPE_R8 },          { L&quot;NUMERICSA&quot;, DBTYPE_R8 },
        { L&quot;NUMERICSTS&quot;, DBTYPE_R8 },       { L&quot;MONETARY&quot;, DBTYPE_R8 },

        { L&quot;DBTYPE_CY&quot;, DBTYPE_CY },        { L&quot;CURRENCY&quot;, DBTYPE_CY },

        { L&quot;DBTYPE_BOOL&quot;, DBTYPE_BOOL },    { L&quot;LOGICAL&quot;, DBTYPE_BOOL },
        //{ L&quot;BIT&quot;, DBTYPE_BOOL },

        { L&quot;DBTYPE_UI1&quot;, DBTYPE_UI1 },      { L&quot;UNSIGNED(1)&quot;, DBTYPE_UI1 },
        { L&quot;UTINYINT&quot;, DBTYPE_UI1 },        { L&quot;TINYINT UNSIGNED&quot;, DBTYPE_UI1 },

        { L&quot;DBTYPE_UI2&quot;, DBTYPE_UI2 },      { L&quot;UNSIGNED(2)&quot;, DBTYPE_UI2 },
        { L&quot;USMALLINT&quot;, DBTYPE_UI2 },       { L&quot;SMALLINT UNSIGNED&quot;, DBTYPE_UI2 },

        { L&quot;DBTYPE_UI4&quot;, DBTYPE_UI4 },      { L&quot;UNSIGNED(4)&quot;, DBTYPE_UI4 },
        { L&quot;UINTEGER&quot;, DBTYPE_UI4 },        { L&quot;INTEGER UNSIGNED&quot;, DBTYPE_UI4 },
        { L&quot;MEDIUMINT UNSIGNED&quot;, DBTYPE_UI4 },

        { L&quot;DBTYPE_UI8&quot;, DBTYPE_UI8 },      { L&quot;UNSIGNED(8)&quot;, DBTYPE_UI8 },
        { L&quot;BIGINT UNSIGNED&quot;, DBTYPE_UI8 }, { L&quot;UBIGINT&quot;, DBTYPE_UI8 },

        { L&quot;DBTYPE_STR&quot;, DBTYPE_STR },      { L&quot;CHARACTER&quot;, DBTYPE_STR },
        { L&quot;LSTRING&quot;, DBTYPE_STR },         { L&quot;ZSTRING&quot;, DBTYPE_STR },
        { L&quot;NOTE&quot;, DBTYPE_STR },            { L&quot;CHAR&quot;, DBTYPE_STR },
        { L&quot;VARCHAR&quot;, DBTYPE_STR },         { L&quot;LONGVARCHAR&quot;, DBTYPE_STR },
        { L&quot;BLOB&quot;, DBTYPE_STR },            { L&quot;TINYBLOB&quot;, DBTYPE_STR },
        { L&quot;MEDIUMBLOB&quot;, DBTYPE_STR },      { L&quot;LONGBLOB&quot;, DBTYPE_STR },
        { L&quot;TEXT&quot;, DBTYPE_STR },            { L&quot;TINYTEXT&quot;, DBTYPE_STR },
        { L&quot;MEDIUMTEXT&quot;, DBTYPE_STR },      { L&quot;LONGTEXT&quot;, DBTYPE_STR },
        { L&quot;NULL&quot;, DBTYPE_STR },            { L&quot;ENUM&quot;, DBTYPE_STR },
        { L&quot;SET&quot;, DBTYPE_STR },

        { L&quot;NCHAR&quot;, DBTYPE_WSTR },          { L&quot;NCHAR VARYING&quot;, DBTYPE_WSTR },

        { L&quot;DBTYPE_BYTES&quot;, DBTYPE_BYTES },  { L&quot;LVAR&quot;, DBTYPE_BYTES },
        { L&quot;LONG VARBINARY&quot;, DBTYPE_BYTES },{ L&quot;LONGVARBINARY&quot;, DBTYPE_BYTES },
        { L&quot;BINARY&quot;, DBTYPE_BYTES },        { L&quot;BIT&quot;, DBTYPE_BYTES },
        { L&quot;BIT VARYING&quot;, DBTYPE_BYTES },

        { L&quot;DBTYPE_DBDATE&quot;, DBTYPE_DBDATE },{ L&quot;DATE&quot;, DBTYPE_DBDATE },

        { L&quot;DBTYPE_DBTIME&quot;, DBTYPE_DBTIME },{ L&quot;TIME&quot;, DBTYPE_DBTIME },

        { L&quot;DBTYPE_DBTIMESTAMP&quot;, DBTYPE_DBTIMESTAMP },
        { L&quot;TIMESTAMP&quot;, DBTYPE_DBTIMESTAMP },
        { L&quot;DATETIME&quot;, DBTYPE_DBTIMESTAMP },
    };

    if(pwszName==NULL) return DBTYPE_WSTR;

    for(int i=1;i&lt;sizeof(types)/sizeof(*types);i++)
    {
        if(_wcsicmp(pwszName, types[i].pwszName)==0)
            return types[i].wType;
    }

    return DBTYPE_STR;
}

static HRESULT CompareSTR(DBCOMPAREOP CompareOp, const char *szRowValue, const char *szFindValue)
{
    DBCOMPAREOP LocalOp = CompareOp &amp; ~DBCOMPAREOPS_CASESENSITIVE &amp; ~DBCOMPAREOPS_CASEINSENSITIVE;

    switch(LocalOp)
    {
    case DBCOMPAREOPS_LT:
    case DBCOMPAREOPS_LE:
    case DBCOMPAREOPS_EQ:
    case DBCOMPAREOPS_GE:
    case DBCOMPAREOPS_GT:
    case DBCOMPAREOPS_NE:
        {
            // 디폴트는 case sensitive
            int res;
            if(CompareOp &amp; DBCOMPAREOPS_CASEINSENSITIVE)
                res = _stricmp(szRowValue, szFindValue);
            else
                res = strcmp(szRowValue, szFindValue);

            if( ( LocalOp==DBCOMPAREOPS_LT &amp;&amp; res&lt; 0 ) ||
                ( LocalOp==DBCOMPAREOPS_LE &amp;&amp; res&lt;=0 ) ||
                ( LocalOp==DBCOMPAREOPS_EQ &amp;&amp; res==0 ) ||
                ( LocalOp==DBCOMPAREOPS_GE &amp;&amp; res&gt;=0 ) ||
                ( LocalOp==DBCOMPAREOPS_GT &amp;&amp; res&gt; 0 ) ||
                ( LocalOp==DBCOMPAREOPS_NE &amp;&amp; res!=0 ) )
                return S_OK;

            return S_FALSE;
        }

    case DBCOMPAREOPS_BEGINSWITH:
        {
            int res;
            size_t len = strlen(szFindValue);
            if(CompareOp &amp; DBCOMPAREOPS_CASEINSENSITIVE)
                res = _strnicmp(szRowValue, szFindValue, len);
            else
                res = strncmp(szRowValue, szFindValue, len);
            return res==0 ? S_OK : S_FALSE;
        }
    case DBCOMPAREOPS_NOTBEGINSWITH:
        {
            int res;
            size_t len = strlen(szFindValue);
            if(CompareOp &amp; DBCOMPAREOPS_CASEINSENSITIVE)
                res = _strnicmp(szRowValue, szFindValue, len);
            else
                res = strncmp(szRowValue, szFindValue, len);
            return res!=0 ? S_OK : S_FALSE;
        }

    // TODO: case insensitive
    case DBCOMPAREOPS_CONTAINS:
        {
            const char *res;
            if(CompareOp &amp; DBCOMPAREOPS_CASEINSENSITIVE)
            {
                CStringA row(szRowValue), find(szFindValue);
                row.MakeUpper(); find.MakeUpper();
                res = strstr(row, find);
            }
            else
                res = strstr(szRowValue, szFindValue);
            return res!=0 ? S_OK : S_FALSE;
        }
    case DBCOMPAREOPS_NOTCONTAINS:
        {
            const char *res;
            if(CompareOp &amp; DBCOMPAREOPS_CASEINSENSITIVE)
            {
                CStringA row(szRowValue), find(szFindValue);
                row.MakeUpper(); find.MakeUpper();
                res = strstr(row, find);
            }
            else
                res = strstr(szRowValue, szFindValue);
            return res==0 ? S_OK : S_FALSE;
        }
    }

    return DB_E_BADCOMPAREOP;
}

static HRESULT CompareI4(DBCOMPAREOP CompareOp, const char *szRowValue, const char *szFindValue)
{
    if( CompareOp!=DBCOMPAREOPS_LT &amp;&amp; CompareOp!=DBCOMPAREOPS_LE &amp;&amp;
        CompareOp!=DBCOMPAREOPS_EQ &amp;&amp; CompareOp!=DBCOMPAREOPS_NE &amp;&amp;
        CompareOp!=DBCOMPAREOPS_GE &amp;&amp; CompareOp!=DBCOMPAREOPS_GT )
        return DB_E_BADCOMPAREOP;

    int nRowValue = atoi(szRowValue);
    int nFindValue = atoi(szFindValue);

    if( ( CompareOp==DBCOMPAREOPS_LT &amp;&amp; nRowValue&lt; nFindValue ) ||
        ( CompareOp==DBCOMPAREOPS_LE &amp;&amp; nRowValue&lt;=nFindValue ) ||
        ( CompareOp==DBCOMPAREOPS_EQ &amp;&amp; nRowValue==nFindValue ) ||
        ( CompareOp==DBCOMPAREOPS_GE &amp;&amp; nRowValue&gt;=nFindValue ) ||
        ( CompareOp==DBCOMPAREOPS_GT &amp;&amp; nRowValue&gt; nFindValue ) ||
        ( CompareOp==DBCOMPAREOPS_NE &amp;&amp; nRowValue!=nFindValue ) )
        return S_OK;
    return S_FALSE;
}

static HRESULT CompareI2(DBCOMPAREOP CompareOp, const char *szRowValue, const char *szFindValue)
{
    if( CompareOp!=DBCOMPAREOPS_LT &amp;&amp; CompareOp!=DBCOMPAREOPS_LE &amp;&amp;
        CompareOp!=DBCOMPAREOPS_EQ &amp;&amp; CompareOp!=DBCOMPAREOPS_NE &amp;&amp;
        CompareOp!=DBCOMPAREOPS_GE &amp;&amp; CompareOp!=DBCOMPAREOPS_GT )
        return DB_E_BADCOMPAREOP;

    short nRowValue = (short)atoi(szRowValue);
    short nFindValue = (short)atoi(szFindValue);

    if( ( CompareOp==DBCOMPAREOPS_LT &amp;&amp; nRowValue&lt; nFindValue ) ||
        ( CompareOp==DBCOMPAREOPS_LE &amp;&amp; nRowValue&lt;=nFindValue ) ||
        ( CompareOp==DBCOMPAREOPS_EQ &amp;&amp; nRowValue==nFindValue ) ||
        ( CompareOp==DBCOMPAREOPS_GE &amp;&amp; nRowValue&gt;=nFindValue ) ||
        ( CompareOp==DBCOMPAREOPS_GT &amp;&amp; nRowValue&gt; nFindValue ) ||
        ( CompareOp==DBCOMPAREOPS_NE &amp;&amp; nRowValue!=nFindValue ) )
        return S_OK;
    return S_FALSE;
}

static HRESULT CompareR4(DBCOMPAREOP CompareOp, const char *szRowValue, const char *szFindValue)
{
    if( CompareOp!=DBCOMPAREOPS_LT &amp;&amp; CompareOp!=DBCOMPAREOPS_LE &amp;&amp;
        CompareOp!=DBCOMPAREOPS_EQ &amp;&amp; CompareOp!=DBCOMPAREOPS_NE &amp;&amp;
        CompareOp!=DBCOMPAREOPS_GE &amp;&amp; CompareOp!=DBCOMPAREOPS_GT )
        return DB_E_BADCOMPAREOP;

    float fRowValue = (float)atof(szRowValue);
    float fFindValue = (float)atof(szFindValue);

    if( ( CompareOp==DBCOMPAREOPS_LT &amp;&amp; fRowValue&lt; fFindValue ) ||
        ( CompareOp==DBCOMPAREOPS_LE &amp;&amp; fRowValue&lt;=fFindValue ) ||
        ( CompareOp==DBCOMPAREOPS_EQ &amp;&amp; fRowValue==fFindValue ) ||
        ( CompareOp==DBCOMPAREOPS_GE &amp;&amp; fRowValue&gt;=fFindValue ) ||
        ( CompareOp==DBCOMPAREOPS_GT &amp;&amp; fRowValue&gt; fFindValue ) ||
        ( CompareOp==DBCOMPAREOPS_NE &amp;&amp; fRowValue!=fFindValue ) )
        return S_OK;
    return S_FALSE;
}

static HRESULT CompareR8(DBCOMPAREOP CompareOp, const char *szRowValue, const char *szFindValue)
{
    if( CompareOp!=DBCOMPAREOPS_LT &amp;&amp; CompareOp!=DBCOMPAREOPS_LE &amp;&amp;
        CompareOp!=DBCOMPAREOPS_EQ &amp;&amp; CompareOp!=DBCOMPAREOPS_NE &amp;&amp;
        CompareOp!=DBCOMPAREOPS_GE &amp;&amp; CompareOp!=DBCOMPAREOPS_GT )
        return DB_E_BADCOMPAREOP;

    double dRowValue = atof(szRowValue);
    double dFindValue = atof(szFindValue);

    if( ( CompareOp==DBCOMPAREOPS_LT &amp;&amp; dRowValue&lt; dFindValue ) ||
        ( CompareOp==DBCOMPAREOPS_LE &amp;&amp; dRowValue&lt;=dFindValue ) ||
        ( CompareOp==DBCOMPAREOPS_EQ &amp;&amp; dRowValue==dFindValue ) ||
        ( CompareOp==DBCOMPAREOPS_GE &amp;&amp; dRowValue&gt;=dFindValue ) ||
        ( CompareOp==DBCOMPAREOPS_GT &amp;&amp; dRowValue&gt; dFindValue ) ||
        ( CompareOp==DBCOMPAREOPS_NE &amp;&amp; dRowValue!=dFindValue ) )
        return S_OK;
    return S_FALSE;
}

HRESULT Compare(DBCOMPAREOP CompareOp, DBTYPE wType, const char *szRowValue, const char *szFindValue)
{
    switch(wType)
    {
    case DBTYPE_STR:
    case DBTYPE_WSTR:
        return CompareSTR(CompareOp, szRowValue, szFindValue);
        break;

    case DBTYPE_I4:
        return CompareI4(CompareOp, szRowValue, szFindValue);

    case DBTYPE_I2:
        return CompareI2(CompareOp, szRowValue, szFindValue);

    case DBTYPE_R4:
        return CompareR4(CompareOp, szRowValue, szFindValue);

    case DBTYPE_R8:
        return CompareR8(CompareOp, szRowValue, szFindValue);

    default:
        return DB_E_BADCOMPAREOP;
        break;
    }
}

long GetFindCompareOps(DBTYPE wType)
{
    switch(wType)
    {
    case DBTYPE_STR:
    case DBTYPE_WSTR:
        return DBPROPVAL_CO_EQUALITY | DBPROPVAL_CO_STRING | DBPROPVAL_CO_CONTAINS
                | DBPROPVAL_CO_BEGINSWITH | DBPROPVAL_CO_CASEINSENSITIVE;
    case DBTYPE_I4:
    case DBTYPE_I2:
    case DBTYPE_R4:
    case DBTYPE_R8:
        return DBPROPVAL_CO_EQUALITY;
    }
    return 0;
}

// 원래 VARIANT_BOOL은 VARIANT_TRUE와 VARIANT_FALSE만을 갖지만 1을 가지는 경우도 있다.
// 이경우 GetDBStatus에서 DBSTATUS_S_ISNULL을 반환하고, 값은 무시되므로 괜찮다.
static StaticTypeInfo static_type_infos[] = {
    // CCI type,           OLEDB type,     size, prefix, suffix, case sensitive, searchable,        unsigned,      fixed length,  long,          fixed p&amp;s
    { CCI_U_TYPE_UNKNOWN,  DBTYPE_STR,  4000, L&quot;&quot;,   L&quot;&quot;,  VARIANT_TRUE, DB_SEARCHABLE,    1,             VARIANT_FALSE, VARIANT_FALSE, VARIANT_TRUE  },
    { CCI_U_TYPE_CHAR,     DBTYPE_STR,  1073741823, L&quot;&#39;&quot;,  L&quot;&#39;&quot;, VARIANT_TRUE,  DB_SEARCHABLE,      1,             VARIANT_TRUE,  VARIANT_TRUE,  VARIANT_TRUE  },
    { CCI_U_TYPE_STRING,   DBTYPE_STR,  1073741823, L&quot;&#39;&quot;,  L&quot;&#39;&quot;, VARIANT_TRUE,  DB_SEARCHABLE,      1,             VARIANT_FALSE, VARIANT_TRUE,  VARIANT_TRUE  },
    // TODO: NCHAR와 WSTR은 좀 차이가 있다. 그래서 문제가 생길 여지가 좀 있는데
    //       그렇다고 STR으로 할 수는 없어서, WSTR으로 한다.
    { CCI_U_TYPE_NCHAR,    DBTYPE_WSTR,  536870911/2, L&quot;N&#39;&quot;, L&quot;&#39;&quot;, VARIANT_TRUE,  DB_SEARCHABLE,      1,             VARIANT_TRUE,  VARIANT_TRUE,  VARIANT_TRUE  },
    { CCI_U_TYPE_VARNCHAR, DBTYPE_WSTR,  536870911/2, L&quot;N&#39;&quot;, L&quot;&#39;&quot;, VARIANT_TRUE,  DB_SEARCHABLE,      1,             VARIANT_FALSE, VARIANT_TRUE,  VARIANT_TRUE  },
    // TODO: 크기를 1073741823로 해야 하는지, 268435455 또는 134217727으로 해야 하는지 모르겠음
    //       LTM에서는 &#39;F111...&#39;과 같은 데이터를 만들어서 prefix는 16진수를 쓰는 걸로 함
    { CCI_U_TYPE_BIT,     DBTYPE_BYTES, 1073741823, L&quot;X&#39;&quot;, L&quot;&#39;&quot;, VARIANT_FALSE, DB_ALL_EXCEPT_LIKE, 1,             VARIANT_TRUE,  VARIANT_TRUE,  VARIANT_TRUE  },
    { CCI_U_TYPE_VARBIT,  DBTYPE_BYTES, 1073741823, L&quot;X&#39;&quot;, L&quot;&#39;&quot;, VARIANT_FALSE, DB_ALL_EXCEPT_LIKE, 1,             VARIANT_FALSE, VARIANT_TRUE,  VARIANT_TRUE  },
    { CCI_U_TYPE_NUMERIC,  DBTYPE_NUMERIC,      38, L&quot;&quot;,   L&quot;&quot;,  VARIANT_FALSE, DB_ALL_EXCEPT_LIKE, VARIANT_FALSE, VARIANT_FALSE, VARIANT_FALSE, VARIANT_TRUE  },
    { CCI_U_TYPE_INT,      DBTYPE_I4,           10, L&quot;&quot;,   L&quot;&quot;,  VARIANT_FALSE, DB_ALL_EXCEPT_LIKE, VARIANT_FALSE, VARIANT_TRUE,  VARIANT_FALSE, VARIANT_TRUE  },
    { CCI_U_TYPE_SHORT,    DBTYPE_I2,            5, L&quot;&quot;,   L&quot;&quot;,  VARIANT_FALSE, DB_ALL_EXCEPT_LIKE, VARIANT_FALSE, VARIANT_TRUE,  VARIANT_FALSE, VARIANT_TRUE  },
    { CCI_U_TYPE_MONETARY, DBTYPE_R8,           15, L&quot;&quot;,   L&quot;&quot;,  VARIANT_FALSE, DB_ALL_EXCEPT_LIKE, VARIANT_FALSE, VARIANT_TRUE,  VARIANT_FALSE, VARIANT_FALSE },
    { CCI_U_TYPE_FLOAT,    DBTYPE_R4,            7, L&quot;&quot;,   L&quot;&quot;,  VARIANT_FALSE, DB_ALL_EXCEPT_LIKE, VARIANT_FALSE, VARIANT_TRUE,  VARIANT_FALSE, VARIANT_FALSE },
    { CCI_U_TYPE_DOUBLE,   DBTYPE_R8,           15, L&quot;&quot;,   L&quot;&quot;,  VARIANT_FALSE, DB_ALL_EXCEPT_LIKE, VARIANT_FALSE, VARIANT_TRUE,  VARIANT_FALSE, VARIANT_FALSE },
    { CCI_U_TYPE_DATE,     DBTYPE_DBDATE,       10, L&quot;&#39;&quot;,  L&quot;&#39;&quot;, VARIANT_FALSE, DB_ALL_EXCEPT_LIKE, 1,             VARIANT_TRUE,  VARIANT_FALSE, VARIANT_TRUE  },
    // NOTE: time의 &#39;am&#39;, &#39;pm&#39; 자리까지 생각해서 size를 정하면
  //       LTM은 1/100초 자리로 생각을 함. 그래서 뺌
    { CCI_U_TYPE_TIME,     DBTYPE_DBTIME,        8, L&quot;&#39;&quot;,  L&quot;&#39;&quot;, VARIANT_FALSE, DB_ALL_EXCEPT_LIKE, 1,             VARIANT_TRUE,  VARIANT_FALSE, VARIANT_TRUE  },
    { CCI_U_TYPE_TIMESTAMP, DBTYPE_DBTIMESTAMP, 19, L&quot;&#39;&quot;,  L&quot;&#39;&quot;, VARIANT_FALSE, DB_ALL_EXCEPT_LIKE, 1,             VARIANT_TRUE,  VARIANT_FALSE, VARIANT_TRUE  },
    // TODO: mapping to DBTYPE_IUnknown?
    { CCI_U_TYPE_OBJECT,   DBTYPE_STR,  1073741823, L&quot;&#39;&quot;,  L&quot;&#39;&quot;, VARIANT_TRUE,  DB_SEARCHABLE,      1,             VARIANT_FALSE, VARIANT_TRUE,  VARIANT_TRUE  },
    { CCI_U_TYPE_MULTISET,   DBTYPE_STR,  1073741823, L&quot;&#39;&quot;,  L&quot;&#39;&quot;, VARIANT_TRUE,  DB_SEARCHABLE,      1,             VARIANT_FALSE, VARIANT_TRUE,  VARIANT_TRUE  },
    { CCI_U_TYPE_SET,   DBTYPE_STR,  1073741823, L&quot;&#39;&quot;,  L&quot;&#39;&quot;, VARIANT_TRUE,  DB_SEARCHABLE,      1,             VARIANT_FALSE, VARIANT_TRUE,  VARIANT_TRUE  },
};

const StaticTypeInfo &amp;GetStaticTypeInfo(T_CCI_U_TYPE nCCIUType)
{
    for(int i=1;i&lt;sizeof(static_type_infos)/sizeof(*static_type_infos);i++)
    {
        if(static_type_infos[i].nCCIUType==nCCIUType)
            return static_type_infos[i];
    }
    return static_type_infos[0];
}

DynamicTypeInfo GetDynamicTypeInfo(T_CCI_U_TYPE nCCIUType, int nPrecision, int nScale, bool bNullable)
{
    /* 스펙엔 &#39;this is the size of the data type&#39;라고 되어 있어서
     * ulColumnSize = StaticTypeInfo::ulSize (문자열로 봤을 때의 길이) 라고 생각했으나
     * LTM을 보니 저장공간의 크기를 말하는 것 같다.
     */
    DynamicTypeInfo dyn_info;
    const StaticTypeInfo &amp;sta_info = GetStaticTypeInfo(nCCIUType);

    dyn_info.ulFlags = 0;
    dyn_info.ulFlags |= DBCOLUMNFLAGS_WRITEUNKNOWN;
    dyn_info.ulFlags |= DBCOLUMNFLAGS_ISFIXEDLENGTH;
    if(bNullable)
        dyn_info.ulFlags |= DBCOLUMNFLAGS_ISNULLABLE | DBCOLUMNFLAGS_MAYBENULL;
    dyn_info.ulColumnSize = (ULONG)~0;
    dyn_info.bPrecision = ~0;
    dyn_info.bScale = ~0;
    dyn_info.ulCharMaxLength = (ULONG)~0;
    dyn_info.ulCharOctetLength = (ULONG)~0;
    dyn_info.nNumericPrecision = (USHORT)~0;
    dyn_info.nNumericScale = -1;
    dyn_info.ulDateTimePrecision = (ULONG)~0;

    switch(nCCIUType)
    {
    case CCI_U_TYPE_STRING:
    case CCI_U_TYPE_VARNCHAR:
        dyn_info.ulFlags &amp;= ~DBCOLUMNFLAGS_ISFIXEDLENGTH; // 주의 break 없음
    case CCI_U_TYPE_CHAR:
    case CCI_U_TYPE_NCHAR:
        if(nCCIUType==CCI_U_TYPE_VARNCHAR || nCCIUType==CCI_U_TYPE_NCHAR)
            dyn_info.ulColumnSize = nPrecision / 2;
        else
            dyn_info.ulColumnSize = nPrecision;

        dyn_info.ulCharMaxLength = dyn_info.ulColumnSize;
        dyn_info.ulCharOctetLength = dyn_info.ulCharMaxLength;
        if(nCCIUType==CCI_U_TYPE_VARNCHAR || nCCIUType==CCI_U_TYPE_NCHAR)
        {
            dyn_info.ulCharOctetLength *= 2; // TODO: 좀 다르긴 하지만 LTM을 위해 일단 2배를 한다.
        }
        break;

    case CCI_U_TYPE_VARBIT:
        dyn_info.ulFlags &amp;= ~DBCOLUMNFLAGS_ISFIXEDLENGTH; // 주의 break 없음
    case CCI_U_TYPE_BIT:
        // TODO: Maximum length니까 올림을 하는게 맞을 것 같은데, 하면 LTM은
        //       BYTE단위로 데이터를 만들어서 BIT로 보면 초과해서 에러가 난다.
        dyn_info.ulColumnSize = (int)(nPrecision/8);
        dyn_info.ulCharMaxLength = dyn_info.ulColumnSize;
        dyn_info.ulCharOctetLength = dyn_info.ulCharMaxLength;
        break;

    case CCI_U_TYPE_NUMERIC:
        dyn_info.ulColumnSize = sizeof(DB_NUMERIC);
        dyn_info.bPrecision = nPrecision;
        dyn_info.bScale = nScale;
        dyn_info.nNumericPrecision = dyn_info.bPrecision;
        dyn_info.nNumericScale = dyn_info.bScale;
        break;

    case CCI_U_TYPE_INT:
        dyn_info.ulColumnSize = 4;
        dyn_info.bPrecision = (BYTE)sta_info.ulSize;
        dyn_info.nNumericPrecision = dyn_info.bPrecision;
        break;

    case CCI_U_TYPE_SHORT:
        dyn_info.ulColumnSize = 2;
        dyn_info.bPrecision = (BYTE)sta_info.ulSize;
        dyn_info.nNumericPrecision = dyn_info.bPrecision;
        break;

    case CCI_U_TYPE_MONETARY:
        dyn_info.ulColumnSize = sizeof(double);
        dyn_info.bPrecision = (BYTE)sta_info.ulSize;
        dyn_info.nNumericPrecision = dyn_info.bPrecision;
        break;

    case CCI_U_TYPE_FLOAT:
        dyn_info.ulColumnSize = sizeof(float);
        dyn_info.bPrecision = (BYTE)sta_info.ulSize;
        dyn_info.nNumericPrecision = dyn_info.bPrecision;
        break;

    case CCI_U_TYPE_DOUBLE:
        dyn_info.ulColumnSize = sizeof(double);
        dyn_info.bPrecision = (BYTE)sta_info.ulSize;
        dyn_info.nNumericPrecision = dyn_info.bPrecision;
        break;

    case CCI_U_TYPE_DATE:
        dyn_info.ulColumnSize = sizeof(DBDATE);
        break;

    case CCI_U_TYPE_TIME:
        dyn_info.ulColumnSize = sizeof(DBTIME);
        break;

    case CCI_U_TYPE_TIMESTAMP:
        dyn_info.ulColumnSize = sizeof(DBTIMESTAMP);
        dyn_info.bPrecision = (BYTE)sta_info.ulSize;
        dyn_info.bScale = 0;
        dyn_info.ulDateTimePrecision = dyn_info.bScale;
        break;

    case CCI_U_TYPE_OBJECT:
        //dyn_info.ulColumnSize = nPrecision;
        //OID 스트링 max length를 15로 보고 수정
        dyn_info.ulColumnSize = 15;
        dyn_info.ulCharMaxLength = dyn_info.ulColumnSize;
        dyn_info.ulCharOctetLength = dyn_info.ulCharMaxLength;
        break;

    case CCI_U_TYPE_SET:
    case CCI_U_TYPE_MULTISET:
        ATLTRACE(atlTraceDBProvider, 2, _T(&quot;Here!!\n&quot;));
        dyn_info.ulColumnSize = nPrecision;
        dyn_info.ulCharMaxLength = dyn_info.ulColumnSize;
        dyn_info.ulCharOctetLength = dyn_info.ulCharMaxLength;
        break;
    default:
        dyn_info.ulColumnSize = sta_info.ulSize;
        dyn_info.ulCharMaxLength = sta_info.ulSize;
        dyn_info.ulCharOctetLength = sta_info.ulSize;
        break;
    }

    if(dyn_info.ulColumnSize&gt;8000) // 8000은 atldbcli.h의 CDynamicAccessor가 쓰는 값
        dyn_info.ulFlags |= DBCOLUMNFLAGS_ISLONG;

    return dyn_info;
}

static HRESULT GetTableInfo_FetchData(int hReq, TableInfo &amp;info)
{
    char *strval;
    int intval, ind, res;
    T_CCI_ERROR err_buf;

    res = cci_fetch(hReq, &amp;err_buf);
    if(res&lt;0) return E_FAIL;

    res = cci_get_data(hReq, 12, CCI_A_TYPE_STR, &amp;strval, &amp;ind);
    if(res&lt;0) return E_FAIL;
    info.strSourceClass = CA2W(strval);

    res = cci_get_data(hReq, 10, CCI_A_TYPE_INT, &amp;intval, &amp;ind);
    if(res&lt;0) return E_FAIL;
    info.iOrdinal = intval;

    res = cci_get_data(hReq, 8, CCI_A_TYPE_INT, &amp;intval, &amp;ind);
    if(res&lt;0) return E_FAIL;
    info.bIsUnique = (intval==1);
    ::VariantClear(&amp;info.varDefault);
    res = cci_get_data(hReq, 9, CCI_A_TYPE_STR, &amp;strval, &amp;ind);
    if(res&lt;0) return E_FAIL;
    if(ind!=-1)
    {
        CComVariant var = strval;
        var.Detach(&amp;info.varDefault);
    }

    return S_OK;
}

HRESULT GetTableInfo(int hConn, char *szTableName, CAtlArray&lt;TableInfo&gt; &amp;infos)
{
    // 기존의 데이터 모두 삭제
    infos.RemoveAll();

    T_CCI_ERROR err_buf;
    int hReq = cci_schema_info(hConn, CCI_SCH_ATTRIBUTE, szTableName, NULL,
                    CCI_CLASS_NAME_PATTERN_MATCH | CCI_ATTR_NAME_PATTERN_MATCH, &amp;err_buf);
    if(hReq&lt;0)
    {
        ATLTRACE2(&quot;GetTableInfo: cci_schema_info fail\n&quot;);
        return E_FAIL;
    }

    int res = cci_cursor(hReq, 1, CCI_CURSOR_FIRST, &amp;err_buf);
    if(res==CCI_ER_NO_MORE_DATA) goto done;
    if(res&lt;0) goto error;

    size_t cur = 0;
    while(1)
    {
        infos.SetCount(infos.GetCount()+1);
        HRESULT hr = GetTableInfo_FetchData(hReq, infos[cur]);
        if(FAILED(hr)) goto error;

        res = cci_cursor(hReq, 1, CCI_CURSOR_CURRENT, &amp;err_buf);
        if(res==CCI_ER_NO_MORE_DATA) goto done;
        if(res&lt;0) goto error;

        cur++;
    }

error:
    ATLTRACE2(&quot;GetTableInfo: fail to fetch data\n&quot;);
    cci_close_req_handle(hReq);
    infos.RemoveAll();
    return E_FAIL;
done:
    cci_close_req_handle(hReq);
    return S_OK;
}

}

/*
create table ztest (c1 char, c2 char(20), c3 varchar, c4 varchar(20), c5 nchar, c6 nchar(20),
c7 nchar varying, c8 nchar varying(20), c9 bit, c10 bit(20), c11 bit varying, c12 bit varying(20),
c13 numeric, c14 numeric(10), c15 numeric(15,8), c16 int, c17 smallint, c18 float, c19 float(5),
c20 float(14), c21 double, c22 monetary, c23 date, c24 time, c25 timestamp, c26 set(varchar(20), int),
c27 set(), c28 multiset(float, int), c29 list(float,int), c30 sequence())

***** cci_schema_info의 결과값 *****
name, domain, scale, precision, indexed, non_null, shared, unique, default, attr_order, class_name, source_class
c1  1   0   1           0   0   0   0   null    1   ztest   ztest   : character(1)
c2  1   0   20          0   0   0   0   null    2   ztest   ztest   : character(20)
c3  2   0   1073741823  0   0   0   0   null    3   ztest   ztest   : character varying(1073741823)
c4  2   0   20          0   0   0   0   null    4   ztest   ztest   : character varying(20)
c5  3   0   1           0   0   0   0   null    5   ztest   ztest   : national character(1)
c6  3   0   20          0   0   0   0   null    6   ztest   ztest   : national character(20)
c7  4   0   536870911   0   0   0   0   null    7   ztest   ztest   : national character varying(536870911)
c8  4   0   20          0   0   0   0   null    8   ztest   ztest   : national character varying(20)
c9  5   0   1           0   0   0   0   null    9   ztest   ztest   : bit(1)
c10 5   0   20          0   0   0   0   null    10  ztest   ztest   : bit(20)
c11 6   0   1073741823  0   0   0   0   null    11  ztest   ztest   : bit varying(1073741823)
c12 6   0   20          0   0   0   0   null    12  ztest   ztest   : bit varying(20)
c13 7   0   15          0   0   0   0   null    13  ztest   ztest   : numeric(15,0)
c14 7   0   10          0   0   0   0   null    14  ztest   ztest   : numeric(10,0)
c15 7   8   15          0   0   0   0   null    15  ztest   ztest   : numeric(15,8)
c16 8   0   0           0   0   0   0   null    16  ztest   ztest   : integer
c17 9   0   0           0   0   0   0   null    17  ztest   ztest   : smallint
c18 11  0   0           0   0   0   0   null    18  ztest   ztest   : float
c19 11  0   0           0   0   0   0   null    19  ztest   ztest   : float
c20 11  0   0           0   0   0   0   null    20  ztest   ztest   : float
c21 12  0   0           0   0   0   0   null    21  ztest   ztest   : double
c22 10  0   0           0   0   0   0   null    22  ztest   ztest   : monetary
c23 13  0   0           0   0   0   0   null    23  ztest   ztest   : date
c24 14  0   0           0   0   0   0   null    24  ztest   ztest   : time
c25 15  0   0           0   0   0   0   null    25  ztest   ztest   : timestamp
c26 -1  0   0           0   0   0   0   null    26  ztest   ztest   : set_of(character varying(20), integer)
c27 -1  0   0           0   0   0   0   null    27  ztest   ztest   : set_of()
c28 -1  0   0           0   0   0   0   null    28  ztest   ztest   : multiset_of(float, integer)
c29 -1  0   0           0   0   0   0   null    29  ztest   ztest   : sequence_of(float, integer)
c30 -1  0   0           0   0   0   0   null    30  ztest   ztest   : sequence_of()

***** cci_get_result_info의 결과값 *****
type, is_non_null, scale, precision, col_name, real_attr, class_name
1   0   0   1           c1  null    ztest
1   0   0   20          c2  null    ztest
2   0   0   1073741823  c3  null    ztest
2   0   0   20          c4  null    ztest
3   0   0   1           c5  null    ztest
3   0   0   20          c6  null    ztest
4   0   0   536870911   c7  null    ztest
4   0   0   20          c8  null    ztest
5   0   0   1           c9  null    ztest
5   0   0   20          c10 null    ztest
6   0   0   1073741823  c11 null    ztest
6   0   0   20          c12 null    ztest
7   0   0   15          c13 null    ztest
7   0   0   10          c14 null    ztest
7   0   8   15          c15 null    ztest
8   0   0   0           c16 null    ztest
9   0   0   0           c17 null    ztest
11  0   0   0           c18 null    ztest
11  0   0   0           c19 null    ztest
11  0   0   0           c20 null    ztest
12  0   0   0           c21 null    ztest
10  0   0   0           c22 null    ztest
13  0   0   0           c23 null    ztest
14  0   0   0           c24 null    ztest
15  0   0   0           c25 null    ztest
-1  0   0   0           c26 null    ztest
-1  0   0   0           c27 null    ztest
-1  0   0   0           c28 null    ztest
-1  0   0   0           c29 null    ztest
-1  0   0   0           c30 null    ztest
*/
</span></div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;            <span class="keywordflow">if</span> (colDesc.ulColumnSize)</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                <a class="code" href="atldb__cubrid_8h.html#a080c6299f67db3aab5e21e5e45f9e90f">colSize</a> *= 8;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;            sprintf(strColSize, <span class="stringliteral">&quot;(%u)&quot;</span>, <a class="code" href="atldb__cubrid_8h.html#a080c6299f67db3aab5e21e5e45f9e90f">colSize</a>);</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;            strType.Append(strColSize);</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812adae048f88ebb3c044c91fbfc0fce2ae8">CCI_U_TYPE_NUMERIC</a> : </div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;            <span class="keywordflow">if</span> (colDesc.bPrecision &lt; 1 || colDesc.bPrecision &gt; 38)</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;                <span class="keywordflow">return</span> DB_E_BADPRECISION;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;            <span class="keywordflow">if</span> (colDesc.bPrecision &lt; colDesc.bScale)</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;                <span class="keywordflow">return</span> DB_E_BADSCALE;</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;            strType.Append(L<span class="stringliteral">&quot;Numeric&quot;</span>);</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;            sprintf(strColSize, <span class="stringliteral">&quot;(%ld,%ld)&quot;</span>, colDesc.bPrecision, colDesc.bScale);</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;            strType.Append(strColSize);</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a3bc19b2ce116ecd9d4a9414ba799bda9">CCI_U_TYPE_INT</a> : strType.Append(L<span class="stringliteral">&quot;Integer&quot;</span>);</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a7f999a2a5014fb266689822387d495e5">CCI_U_TYPE_SHORT</a> : strType.Append(L<span class="stringliteral">&quot;Smallint&quot;</span>);</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a7d4c7fb802ed00d6280958c5880dc581">CCI_U_TYPE_MONETARY</a> : strType.Append(L<span class="stringliteral">&quot;Monetary&quot;</span>);</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812ae68408a06508953230175cfcb233dfcc">CCI_U_TYPE_FLOAT</a> : strType.Append(L<span class="stringliteral">&quot;Float&quot;</span>);</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a4b1bb46374a90cd0fcef2e9bb58c7236">CCI_U_TYPE_DOUBLE</a> : strType.Append(L<span class="stringliteral">&quot;Double&quot;</span>);</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a7b4e84af853a62908e629d1fe0bbd848">CCI_U_TYPE_DATE</a> : strType.Append(L<span class="stringliteral">&quot;Date&quot;</span>);</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a61168c4c6258cdf63773f9e77bf6d197">CCI_U_TYPE_TIME</a> : strType.Append(L<span class="stringliteral">&quot;Time&quot;</span>);</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a932f0c01cf613a5e72bce5911f7ce901">CCI_U_TYPE_TIMESTAMP</a> : strType.Append(L<span class="stringliteral">&quot;Timestamp&quot;</span>);</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a98042c0341542eafa2cb8e644d423973">CCI_U_TYPE_SET</a> : strType.Append(L<span class="stringliteral">&quot;SET&quot;</span>);</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812af868ffbe4b6638c9cbf058f5579b9a65">CCI_U_TYPE_MULTISET</a> : strType.Append(L<span class="stringliteral">&quot;Multiset&quot;</span>);</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812aadd986d6f45d31a4397eafa4fe297516">CCI_U_TYPE_SEQUENCE</a> : strType.Append(L<span class="stringliteral">&quot;Sequence&quot;</span>);</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812ae726773d405bc8a26fb537773b00e02b">CCI_U_TYPE_OBJECT</a> : strType.Append(L<span class="stringliteral">&quot;Object&quot;</span>);</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;        <a class="code" href="namespacebroker__log__top.html#a983a0491908409a8bf5292f9efc2d5e1">default</a> : strType.Append(L<span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;        }</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    }</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <span class="keywordflow">if</span> (bHasDefault)</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    {</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        strType.Append(L<span class="stringliteral">&quot; DEFAULT &quot;</span>);</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        strType.Append(defaultVal);</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    }</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <span class="keywordflow">if</span> (bIsPrimaryKey)</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        strType.Append(L<span class="stringliteral">&quot; PRIMARY KEY &quot;</span>);</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <span class="keywordflow">if</span> (!bIsNullable)</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        strType.Append(L<span class="stringliteral">&quot; NOT NULL &quot;</span>);</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <span class="keywordflow">if</span> (bIsUnique)</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        strType.Append(L<span class="stringliteral">&quot; UNIQUE &quot;</span>);</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    <span class="keywordflow">return</span> hr;</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;}</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;</div><div class="line"><a name="l00438"></a><span class="lineno"><a class="line" href="namespaceType.html#afef88962c15aa3949731f76bbe6254c5">  438</a></span>&#160;<a class="code" href="cas__cci_8h.html#ad659fcbf8c66e3e426aa55d8577da6f5">T_CCI_A_TYPE</a> <a class="code" href="namespaceType.html#afef88962c15aa3949731f76bbe6254c5">GetCASTypeA</a>(DBTYPE wType)</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;{</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <span class="keywordflow">switch</span>(wType)</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    {</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <span class="keywordflow">case</span> DBTYPE_I1:</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <span class="keywordflow">case</span> DBTYPE_I2:</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <span class="keywordflow">case</span> DBTYPE_I4:</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    <span class="keywordflow">case</span> DBTYPE_UI1:</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    <span class="keywordflow">case</span> DBTYPE_UI2:</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <span class="keywordflow">case</span> DBTYPE_UI4:</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="cas__cci_8h.html#ad659fcbf8c66e3e426aa55d8577da6f5a17f3b4be4db3770daa1c83c719a76cec">CCI_A_TYPE_INT</a>;</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    <span class="keywordflow">case</span> DBTYPE_I8:</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <span class="keywordflow">case</span> DBTYPE_UI8:</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="cas__cci_8h.html#ad659fcbf8c66e3e426aa55d8577da6f5ac8162d53a1d0fe82da78875cbd3fc7f0">CCI_A_TYPE_BIGINT</a>;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <span class="keywordflow">case</span> DBTYPE_R4:</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="cas__cci_8h.html#ad659fcbf8c66e3e426aa55d8577da6f5a3294fd67e12fc92481b8fc2ce22f2e3b">CCI_A_TYPE_FLOAT</a>;</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <span class="keywordflow">case</span> DBTYPE_R8:</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="cas__cci_8h.html#ad659fcbf8c66e3e426aa55d8577da6f5a795cbed22300e9918d307c94a2c71a49">CCI_A_TYPE_DOUBLE</a>;</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="ColumnsRowset_8h.html#ab775cbed874dced0073d20da63c0b382">DBTYPE_BOOL</a>:</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <span class="keywordflow">case</span> DBTYPE_BYTES:</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="cas__cci_8h.html#ad659fcbf8c66e3e426aa55d8577da6f5a4a152bbfad8bdf2a7eb592748099c5a8">CCI_A_TYPE_BIT</a>;</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <span class="keywordflow">case</span> DBTYPE_DECIMAL:</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <span class="keywordflow">case</span> DBTYPE_NUMERIC: </div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="atldb__cubrid_8h.html#a4637765a8f83fd4fc2df8bf7d8ffd02e">DBTYPE_WSTR</a>:</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <span class="keywordflow">case</span> DBTYPE_BSTR:</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="atldb__cubrid_8h.html#a9480826662e54d0b6019f4f4d27ada10">DBTYPE_STR</a>:</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="cas__cci_8h.html#ad659fcbf8c66e3e426aa55d8577da6f5a34a5112b77b97538701e9f716888b5bd">CCI_A_TYPE_STR</a>;</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    <span class="keywordflow">case</span> DBTYPE_DBDATE:</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    <span class="keywordflow">case</span> DBTYPE_DBTIME:</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <span class="keywordflow">case</span> DBTYPE_DBTIMESTAMP:</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="cas__cci_8h.html#ad659fcbf8c66e3e426aa55d8577da6f5a0dce740f35c9d97e078de13c179e956f">CCI_A_TYPE_DATE</a>;</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    }</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="cas__cci_8h.html#ad659fcbf8c66e3e426aa55d8577da6f5afa47dcd5fe1782b18141f26f738d44c6">CCI_A_TYPE_FIRST</a>;</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;}</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;</div><div class="line"><a name="l00473"></a><span class="lineno"><a class="line" href="namespaceType.html#ac61886b1804c34091d0c90074fabe60a">  473</a></span>&#160;<a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812">T_CCI_U_TYPE</a> <a class="code" href="namespaceType.html#ac61886b1804c34091d0c90074fabe60a">GetCASTypeU</a>(DBTYPE wType)</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;{</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <span class="keywordflow">switch</span>(wType)</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    {</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <span class="keywordflow">case</span> DBTYPE_I1:</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a0005b45612de0477eee20270f01e84be">CCI_U_TYPE_CHAR</a>;</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <span class="keywordflow">case</span> DBTYPE_I2:</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a7f999a2a5014fb266689822387d495e5">CCI_U_TYPE_SHORT</a>;</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <span class="keywordflow">case</span> DBTYPE_I4:</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a3bc19b2ce116ecd9d4a9414ba799bda9">CCI_U_TYPE_INT</a>;</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    <span class="keywordflow">case</span> DBTYPE_R4:</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812ae68408a06508953230175cfcb233dfcc">CCI_U_TYPE_FLOAT</a>;</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    <span class="keywordflow">case</span> DBTYPE_R8:</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a4b1bb46374a90cd0fcef2e9bb58c7236">CCI_U_TYPE_DOUBLE</a>;</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="ColumnsRowset_8h.html#ab775cbed874dced0073d20da63c0b382">DBTYPE_BOOL</a>:</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <span class="keywordflow">case</span> DBTYPE_BYTES:</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a3331febb5322b5e1fc0b1aff9d4109c7">CCI_U_TYPE_BIT</a>;</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <span class="keywordflow">case</span> DBTYPE_UI2:</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    <span class="keywordflow">case</span> DBTYPE_UI4:</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <span class="keywordflow">case</span> DBTYPE_UI8:</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <span class="keywordflow">case</span> DBTYPE_DECIMAL:</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <span class="keywordflow">case</span> DBTYPE_NUMERIC:</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812adae048f88ebb3c044c91fbfc0fce2ae8">CCI_U_TYPE_NUMERIC</a>;</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    <span class="keywordflow">case</span> DBTYPE_DBDATE:</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a7b4e84af853a62908e629d1fe0bbd848">CCI_U_TYPE_DATE</a>;</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    <span class="keywordflow">case</span> DBTYPE_DBTIME:</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a61168c4c6258cdf63773f9e77bf6d197">CCI_U_TYPE_TIME</a>;</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    <span class="keywordflow">case</span> DBTYPE_DBTIMESTAMP:</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a932f0c01cf613a5e72bce5911f7ce901">CCI_U_TYPE_TIMESTAMP</a>;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    <span class="keywordflow">case</span> DBTYPE_BSTR: </div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="atldb__cubrid_8h.html#a4637765a8f83fd4fc2df8bf7d8ffd02e">DBTYPE_WSTR</a>:</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a2a9a7f31a26489fa99f9e188109ffbcd">CCI_U_TYPE_NCHAR</a>;</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="atldb__cubrid_8h.html#a9480826662e54d0b6019f4f4d27ada10">DBTYPE_STR</a>:</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a17e9464e2c9d5dc2c753e99a4d1a0bd3">CCI_U_TYPE_STRING</a>;             </div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    }</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a816edf276f251f83824d11e32785920b">CCI_U_TYPE_UNKNOWN</a>;</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;}</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;</div><div class="line"><a name="l00511"></a><span class="lineno"><a class="line" href="namespaceType.html#ac0f9f877460008beaa59662f660f67f3">  511</a></span>&#160;HRESULT <a class="code" href="namespaceType.html#ac0f9f877460008beaa59662f660f67f3">OLEDBValueToCCIValue</a>(DBTYPE wType, <a class="code" href="cas__cci_8h.html#ad659fcbf8c66e3e426aa55d8577da6f5">T_CCI_A_TYPE</a>* aType, <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812">T_CCI_U_TYPE</a>* uType,</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;        <span class="keywordtype">void</span> *pValue, DBLENGTH dwLength, <span class="keywordtype">void</span>** dstValue, DBSTATUS* <a class="code" href="expat_8h.html#ab89a24535d44e00f35e040a50104facf">status</a>, <span class="keyword">const</span> CComPtr&lt;IDataConvert&gt; &amp;spConvert)</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;{</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    <span class="keywordflow">if</span>(pValue==<a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) <span class="keywordflow">return</span> E_FAIL;</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    </div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    <span class="keywordflow">switch</span>(wType)</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    {</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    <span class="keywordflow">case</span> DBTYPE_UI1:</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    <span class="keywordflow">case</span> DBTYPE_I1:</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;        *dstValue = CoTaskMemAlloc(<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;        *(<span class="keywordtype">int</span>*)*dstValue = *(BYTE*)pValue;</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    <span class="keywordflow">case</span> DBTYPE_I2: </div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;        *dstValue = CoTaskMemAlloc(<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;        *(<span class="keywordtype">int</span>*)*dstValue = *(<span class="keywordtype">short</span>*)pValue;</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    <span class="keywordflow">case</span> DBTYPE_I4:</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;        *dstValue = CoTaskMemAlloc(<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;        *(<span class="keywordtype">int</span>*)*dstValue = *(<span class="keywordtype">int</span>*)pValue;</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    <span class="keywordflow">case</span> DBTYPE_I8:</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;        <span class="comment">/*</span></div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="comment">        value = CoTaskMemAlloc(sizeof(LONGLONG));</span></div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;<span class="comment">        *(LONGLONG*)value = *(LONGLONG*)pValue;</span></div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;<span class="comment">        break;  </span></div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="comment">        */</span></div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;        *<a class="code" href="expat_8h.html#ab89a24535d44e00f35e040a50104facf">status</a> = DBSTATUS_E_DATAOVERFLOW;</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;        <span class="keywordflow">return</span> DB_E_ERRORSOCCURRED;</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    <span class="keywordflow">case</span> DBTYPE_R4: </div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;        *dstValue = CoTaskMemAlloc(<span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;        *(<span class="keywordtype">float</span>*)*dstValue = *(<span class="keywordtype">float</span>*)pValue;</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;        <span class="keywordflow">break</span>;  </div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    <span class="keywordflow">case</span> DBTYPE_R8:</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;        *dstValue = CoTaskMemAlloc(<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;        *(<span class="keywordtype">double</span>*)*dstValue = *(<span class="keywordtype">double</span>*)pValue;</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="ColumnsRowset_8h.html#ab775cbed874dced0073d20da63c0b382">DBTYPE_BOOL</a>:</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;        *dstValue = CoTaskMemAlloc(<span class="keyword">sizeof</span>(VARIANT));</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;        ((VARIANT *)*dstValue)-&gt;boolVal = ((VARIANT *)pValue)-&gt;boolVal;</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    <span class="keywordflow">case</span> DBTYPE_BYTES:</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;        *dstValue = CoTaskMemAlloc(<span class="keyword">sizeof</span>(<a class="code" href="structT__CCI__BIT.html">T_CCI_BIT</a>));</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;        ((<a class="code" href="structT__CCI__BIT.html">T_CCI_BIT</a> *)*dstValue)-&gt;size = (<a class="code" href="mprec_8c.html#a61569f2965b7a369eb10b6d75d410d11">int</a>)dwLength;</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;        ((<a class="code" href="structT__CCI__BIT.html">T_CCI_BIT</a> *)*dstValue)-&gt;buf = 0;</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;        <span class="keywordflow">if</span>(pValue &amp;&amp; dwLength&gt;0)</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;        {</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;            ((<a class="code" href="structT__CCI__BIT.html">T_CCI_BIT</a> *)*dstValue)-&gt;buf = (<span class="keywordtype">char</span> *)CoTaskMemAlloc(dwLength);</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;            memcpy(((<a class="code" href="structT__CCI__BIT.html">T_CCI_BIT</a> *)*dstValue)-&gt;buf, pValue, dwLength);</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;        }</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    <span class="keywordflow">case</span> DBTYPE_BSTR:</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="atldb__cubrid_8h.html#a4637765a8f83fd4fc2df8bf7d8ffd02e">DBTYPE_WSTR</a>:</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;        <span class="comment">/*{</span></div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="comment">        WCHAR *src = (WCHAR *)pValue;</span></div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;<span class="comment">        DBLENGTH DstLen;</span></div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;<span class="comment">        DBSTATUS dbStat = DBSTATUS_S_OK;</span></div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="comment">        DBLENGTH cbMaxLen = dwLength + 1;</span></div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<span class="comment">        *dstValue = CoTaskMemAlloc(cbMaxLen + 1);</span></div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="comment">        HRESULT hr = spConvert-&gt;DataConvert(wType, DBTYPE_STR, dwLength, &amp;DstLen,</span></div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="comment">            src, *dstValue, cbMaxLen, dbStat, &amp;dbStat, 0, 0, 0);</span></div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="comment">        if (FAILED(hr)) return hr;</span></div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;<span class="comment">        }*/</span></div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;        *dstValue = CoTaskMemAlloc((dwLength + 1) * <span class="keyword">sizeof</span>(<span class="keywordtype">wchar_t</span>));</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;        strcpy((<span class="keywordtype">char</span> *)*dstValue, CW2A((<span class="keywordtype">wchar_t</span> *)pValue));</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="atldb__cubrid_8h.html#a9480826662e54d0b6019f4f4d27ada10">DBTYPE_STR</a>:</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;        <span class="comment">/*{</span></div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;<span class="comment">        char *src = (char *)pValue;</span></div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<span class="comment">        DBLENGTH DstLen;</span></div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;<span class="comment">        DBSTATUS dbStat = DBSTATUS_S_OK;</span></div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="comment">        DBLENGTH cbMaxLen = dwLength + 1;</span></div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="comment">        *dstValue = CoTaskMemAlloc(cbMaxLen + 1);</span></div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="comment">        HRESULT hr = spConvert-&gt;DataConvert(wType, DBTYPE_STR, dwLength, &amp;DstLen,</span></div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="comment">            src, *dstValue, cbMaxLen, dbStat, &amp;dbStat, 0, 0, 0);</span></div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="comment">        if (FAILED(hr)) return hr;</span></div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;<span class="comment">        }*/</span></div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;        *dstValue = CoTaskMemAlloc((dwLength + 1) * <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>));</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;        strcpy((<span class="keywordtype">char</span> *)*dstValue, (<span class="keywordtype">char</span> *)pValue);</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    <span class="keywordflow">case</span> DBTYPE_DBDATE:</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;        *dstValue = CoTaskMemAlloc(<span class="keyword">sizeof</span>(<a class="code" href="structT__CCI__DATE.html">T_CCI_DATE</a>));</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;        ((<a class="code" href="structT__CCI__DATE.html">T_CCI_DATE</a> *)*dstValue)-&gt;yr = ((DBDATE *)pValue)-&gt;year;</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;        ((<a class="code" href="structT__CCI__DATE.html">T_CCI_DATE</a> *)*dstValue)-&gt;mon = ((DBDATE *)pValue)-&gt;month;</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;        ((<a class="code" href="structT__CCI__DATE.html">T_CCI_DATE</a> *)*dstValue)-&gt;day = ((DBDATE *)pValue)-&gt;day;</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    <span class="keywordflow">case</span> DBTYPE_DBTIME: </div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;        *dstValue = CoTaskMemAlloc(<span class="keyword">sizeof</span>(<a class="code" href="structT__CCI__DATE.html">T_CCI_DATE</a>));</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;        ((<a class="code" href="structT__CCI__DATE.html">T_CCI_DATE</a> *)*dstValue)-&gt;hh = ((DBTIME *)pValue)-&gt;hour;</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;        ((<a class="code" href="structT__CCI__DATE.html">T_CCI_DATE</a> *)*dstValue)-&gt;mm = ((DBTIME *)pValue)-&gt;minute;</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;        ((<a class="code" href="structT__CCI__DATE.html">T_CCI_DATE</a> *)*dstValue)-&gt;ss = ((DBTIME *)pValue)-&gt;second;</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    <span class="keywordflow">case</span> DBTYPE_DBTIMESTAMP:</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        *dstValue = CoTaskMemAlloc(<span class="keyword">sizeof</span>(<a class="code" href="structT__CCI__DATE.html">T_CCI_DATE</a>));</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;        ((<a class="code" href="structT__CCI__DATE.html">T_CCI_DATE</a> *)*dstValue)-&gt;yr = ((DBTIMESTAMP *)pValue)-&gt;year;</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;        ((<a class="code" href="structT__CCI__DATE.html">T_CCI_DATE</a> *)*dstValue)-&gt;mon = ((DBTIMESTAMP *)pValue)-&gt;month;</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;        ((<a class="code" href="structT__CCI__DATE.html">T_CCI_DATE</a> *)*dstValue)-&gt;day = ((DBTIMESTAMP *)pValue)-&gt;day;</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;        ((<a class="code" href="structT__CCI__DATE.html">T_CCI_DATE</a> *)*dstValue)-&gt;hh = ((DBTIMESTAMP *)pValue)-&gt;hour;</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;        ((<a class="code" href="structT__CCI__DATE.html">T_CCI_DATE</a> *)*dstValue)-&gt;mm = ((DBTIMESTAMP *)pValue)-&gt;minute;</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;        ((<a class="code" href="structT__CCI__DATE.html">T_CCI_DATE</a> *)*dstValue)-&gt;ss = ((DBTIMESTAMP *)pValue)-&gt;second;</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    <span class="keywordflow">case</span> DBTYPE_DECIMAL:</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    <span class="keywordflow">case</span> DBTYPE_NUMERIC:</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;        {</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;            <a class="code" href="structdb__numeric.html">DB_NUMERIC</a> *src = (<a class="code" href="structdb__numeric.html">DB_NUMERIC</a> *)pValue;</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;            DBLENGTH DstLen;</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;            DBSTATUS dbStat = DBSTATUS_S_OK;</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;            DBLENGTH cbMaxLen = 41;</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;            *dstValue = CoTaskMemAlloc(cbMaxLen + 1);</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;            spConvert-&gt;DataConvert(DBTYPE_NUMERIC, <a class="code" href="atldb__cubrid_8h.html#a9480826662e54d0b6019f4f4d27ada10">DBTYPE_STR</a>, <span class="keyword">sizeof</span>(<a class="code" href="structdb__numeric.html">DB_NUMERIC</a>), &amp;DstLen,</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;                src, *dstValue, cbMaxLen, dbStat, &amp;dbStat, src-&gt;precision, src-&gt;scale, 0);</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;        }</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    <span class="keywordflow">case</span> DBTYPE_VARIANT:</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;        {</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;            VARIANT* var = (VARIANT *)pValue;</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;            DBTYPE targetType = var-&gt;vt;</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;            DBLENGTH SrcLen = dwLength, DstLen;</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;            DBSTATUS dbStat = DBSTATUS_S_OK;</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;            DBLENGTH cbMaxLen = 0;</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;            <span class="keywordflow">switch</span> (targetType)</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;            {</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;            <span class="keywordflow">case</span> VT_UI1:</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;            <span class="keywordflow">case</span> VT_I1:   </div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;            <span class="keywordflow">case</span> VT_I2:   </div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;                            *dstValue = CoTaskMemAlloc(<span class="keyword">sizeof</span>(<span class="keywordtype">short</span>));</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;                            *aType = <a class="code" href="cas__cci_8h.html#ad659fcbf8c66e3e426aa55d8577da6f5a17f3b4be4db3770daa1c83c719a76cec">CCI_A_TYPE_INT</a>;</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;                            *uType = <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a7f999a2a5014fb266689822387d495e5">CCI_U_TYPE_SHORT</a>;</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;                            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;            <span class="keywordflow">case</span> VT_I4:</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;            <span class="keywordflow">case</span> VT_INT:</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;            <span class="keywordflow">case</span> VT_UINT:</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;                            *dstValue = CoTaskMemAlloc(<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>));</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;                            *aType = <a class="code" href="cas__cci_8h.html#ad659fcbf8c66e3e426aa55d8577da6f5a17f3b4be4db3770daa1c83c719a76cec">CCI_A_TYPE_INT</a>;</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;                            *uType = <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a3bc19b2ce116ecd9d4a9414ba799bda9">CCI_U_TYPE_INT</a>;</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;                            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;            <span class="keywordflow">case</span> VT_I8:</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;                            *dstValue = CoTaskMemAlloc(<span class="keyword">sizeof</span>(__int64));</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;                            *aType = <a class="code" href="cas__cci_8h.html#ad659fcbf8c66e3e426aa55d8577da6f5ac8162d53a1d0fe82da78875cbd3fc7f0">CCI_A_TYPE_BIGINT</a>;</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;                            *uType = <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812aad8f57a1b6c63d33616ca89690db2193">CCI_U_TYPE_BIGINT</a>;</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;                            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;            <span class="keywordflow">case</span> VT_R4:</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;                            *dstValue = CoTaskMemAlloc(<span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;                            *aType = <a class="code" href="cas__cci_8h.html#ad659fcbf8c66e3e426aa55d8577da6f5a3294fd67e12fc92481b8fc2ce22f2e3b">CCI_A_TYPE_FLOAT</a>;</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;                            *uType = <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812ae68408a06508953230175cfcb233dfcc">CCI_U_TYPE_FLOAT</a>;</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;                            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;            <span class="keywordflow">case</span> VT_R8:</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;                            *dstValue = CoTaskMemAlloc(<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;                            *aType = <a class="code" href="cas__cci_8h.html#ad659fcbf8c66e3e426aa55d8577da6f5a795cbed22300e9918d307c94a2c71a49">CCI_A_TYPE_DOUBLE</a>;</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;                            *uType = <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a4b1bb46374a90cd0fcef2e9bb58c7236">CCI_U_TYPE_DOUBLE</a>;</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;                            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;            <span class="keywordflow">case</span> VT_DATE:</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;                            *dstValue = CoTaskMemAlloc(<span class="keyword">sizeof</span>(<a class="code" href="structT__CCI__DATE.html">T_CCI_DATE</a>));</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;                            ((<a class="code" href="structT__CCI__DATE.html">T_CCI_DATE</a> *)*dstValue)-&gt;yr = ((DBTIMESTAMP *)pValue)-&gt;year;</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;                            ((<a class="code" href="structT__CCI__DATE.html">T_CCI_DATE</a> *)*dstValue)-&gt;mon = ((DBTIMESTAMP *)pValue)-&gt;month;</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;                            ((<a class="code" href="structT__CCI__DATE.html">T_CCI_DATE</a> *)*dstValue)-&gt;day = ((DBTIMESTAMP *)pValue)-&gt;day;</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;                            ((<a class="code" href="structT__CCI__DATE.html">T_CCI_DATE</a> *)*dstValue)-&gt;hh = ((DBTIMESTAMP *)pValue)-&gt;hour;</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;                            ((<a class="code" href="structT__CCI__DATE.html">T_CCI_DATE</a> *)*dstValue)-&gt;mm = ((DBTIMESTAMP *)pValue)-&gt;minute;</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;                            ((<a class="code" href="structT__CCI__DATE.html">T_CCI_DATE</a> *)*dstValue)-&gt;ss = ((DBTIMESTAMP *)pValue)-&gt;second;</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;                            *aType = <a class="code" href="cas__cci_8h.html#ad659fcbf8c66e3e426aa55d8577da6f5a0dce740f35c9d97e078de13c179e956f">CCI_A_TYPE_DATE</a>;</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;                            *uType = <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a932f0c01cf613a5e72bce5911f7ce901">CCI_U_TYPE_TIMESTAMP</a>;</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;                            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;            <span class="keywordflow">case</span> VT_BSTR:   targetType = <a class="code" href="atldb__cubrid_8h.html#a9480826662e54d0b6019f4f4d27ada10">DBTYPE_STR</a>;</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;                            *dstValue = CoTaskMemAlloc((2*dwLength) * <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>) + 1);</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;                            dwLength *= 2;</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;                            cbMaxLen = dwLength + 1;</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;                            *aType = <a class="code" href="cas__cci_8h.html#ad659fcbf8c66e3e426aa55d8577da6f5a34a5112b77b97538701e9f716888b5bd">CCI_A_TYPE_STR</a>;</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;                            *uType = <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a17e9464e2c9d5dc2c753e99a4d1a0bd3">CCI_U_TYPE_STRING</a>;</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;                            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;            <span class="keywordflow">case</span> VT_DECIMAL:</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;                            <a class="code" href="structdb__numeric.html">DB_NUMERIC</a> *src = (<a class="code" href="structdb__numeric.html">DB_NUMERIC</a> *)pValue;</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;                            SrcLen = <span class="keyword">sizeof</span>(<a class="code" href="dbtype__def_8h.html#aa4cacd43872e590d486e2a06ed1ce007">DB_NUMERIC</a>);</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;                            cbMaxLen = 41;</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;                            *dstValue = CoTaskMemAlloc(cbMaxLen + 1);</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;                            targetType = <a class="code" href="atldb__cubrid_8h.html#a9480826662e54d0b6019f4f4d27ada10">DBTYPE_STR</a>;</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;                            *aType = <a class="code" href="cas__cci_8h.html#ad659fcbf8c66e3e426aa55d8577da6f5a34a5112b77b97538701e9f716888b5bd">CCI_A_TYPE_STR</a>;</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;                            *uType = <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812adae048f88ebb3c044c91fbfc0fce2ae8">CCI_U_TYPE_NUMERIC</a>;</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;            }</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;            </div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;            <span class="keywordflow">if</span> (targetType != VT_DATE)</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;            {</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;                HRESULT hr = spConvert-&gt;DataConvert(DBTYPE_VARIANT, targetType, SrcLen, &amp;DstLen,</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;                    var, *dstValue, cbMaxLen, dbStat, &amp;dbStat, 0, 0, 0);</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;                <span class="keywordflow">if</span> (FAILED(hr)) <span class="keywordflow">return</span> hr;</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;            }</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;        }</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;    }</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="atldb__cubrid_8h.html#a1c8f62bc38a50376a62d4dad41a5e2aa">S_OK</a>;</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;}</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;</div><div class="line"><a name="l00703"></a><span class="lineno"><a class="line" href="namespaceType.html#aa499185608fd079c05b367ff02696c0f">  703</a></span>&#160;DBTYPE <a class="code" href="namespaceType.html#aa499185608fd079c05b367ff02696c0f">GetOledbTypeFromName</a>(LPCWSTR <a class="code" href="atldb__cubrid_8h.html#a851aabdebc10ed6b7d279d768ed199ef">pwszName</a>)</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;{</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    <span class="keyword">const</span> <span class="keyword">struct</span></div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    {</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;        LPCWSTR <a class="code" href="atldb__cubrid_8h.html#a851aabdebc10ed6b7d279d768ed199ef">pwszName</a>;</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;        DBTYPE wType;</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    } types[] = {</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;        { L<span class="stringliteral">&quot;DBTYPE_I1&quot;</span>, DBTYPE_I1 },        { L<span class="stringliteral">&quot;INTEGER(1)&quot;</span>, DBTYPE_I1 },</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;        { L<span class="stringliteral">&quot;TINYINT&quot;</span>, DBTYPE_I1 },</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;        { L<span class="stringliteral">&quot;DBTYPE_I2&quot;</span>, DBTYPE_I2 },        { L<span class="stringliteral">&quot;INTEGER(2)&quot;</span>, DBTYPE_I2 },</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;        { L<span class="stringliteral">&quot;AUTOINC(2)&quot;</span>, DBTYPE_I2 },       { L<span class="stringliteral">&quot;SMALLINT&quot;</span>, DBTYPE_I2 },</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;        { L<span class="stringliteral">&quot;SMALLINDENTITY&quot;</span>, DBTYPE_I2 },   { L<span class="stringliteral">&quot;YEAR&quot;</span>, DBTYPE_I2 },</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;        { L<span class="stringliteral">&quot;DBTYPE_I4&quot;</span>, DBTYPE_I4 },        { L<span class="stringliteral">&quot;INTEGER(4)&quot;</span>, DBTYPE_I4 },</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;        { L<span class="stringliteral">&quot;AUTOINC(4)&quot;</span>, DBTYPE_I4 },       { L<span class="stringliteral">&quot;INTEGER&quot;</span>, DBTYPE_I4 },</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;        { L<span class="stringliteral">&quot;MEDIUMINT&quot;</span>, DBTYPE_I4 },        { L<span class="stringliteral">&quot;INT&quot;</span>, DBTYPE_I4 },</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;        { L<span class="stringliteral">&quot;IDENTITY&quot;</span>, DBTYPE_I4 },</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;        { L<span class="stringliteral">&quot;DBTYPE_I8&quot;</span>, DBTYPE_I8 },        { L<span class="stringliteral">&quot;INTEGER(8)&quot;</span>, DBTYPE_I8 },</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;        { L<span class="stringliteral">&quot;BIGINT&quot;</span>, DBTYPE_I8 },</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;        { L<span class="stringliteral">&quot;DBTYPE_R4&quot;</span>, DBTYPE_R4 },        { L<span class="stringliteral">&quot;FLOAT(4)&quot;</span>, DBTYPE_R4 },</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;        { L<span class="stringliteral">&quot;BFLOAT(4)&quot;</span>, DBTYPE_R4 },        { L<span class="stringliteral">&quot;REAL&quot;</span>, DBTYPE_R4 },</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;        { L<span class="stringliteral">&quot;FLOAT&quot;</span>, DBTYPE_R4 },            { L<span class="stringliteral">&quot;FLOAT UNSIGNED&quot;</span>, DBTYPE_R4 },</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;        { L<span class="stringliteral">&quot;DBTYPE_R8&quot;</span>, DBTYPE_R8 },        { L<span class="stringliteral">&quot;FLOAT(8)&quot;</span>, DBTYPE_R8 },</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;        { L<span class="stringliteral">&quot;BFLOAT(8)&quot;</span>, DBTYPE_R8 },        { L<span class="stringliteral">&quot;MONEY&quot;</span>, DBTYPE_R8 },</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;        { L<span class="stringliteral">&quot;DECIMAL&quot;</span>, DBTYPE_R8 },          { L<span class="stringliteral">&quot;DOUBLE&quot;</span>, DBTYPE_R8 },</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;        { L<span class="stringliteral">&quot;DOUBLE UNSIGNED&quot;</span>, DBTYPE_R8 },  { L<span class="stringliteral">&quot;DOUBLE PRECISION&quot;</span>, DBTYPE_R8 },</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;        { L<span class="stringliteral">&quot;NUMERIC&quot;</span>, DBTYPE_R8 },          { L<span class="stringliteral">&quot;NUMERICSA&quot;</span>, DBTYPE_R8 },</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;        { L<span class="stringliteral">&quot;NUMERICSTS&quot;</span>, DBTYPE_R8 },       { L<span class="stringliteral">&quot;MONETARY&quot;</span>, DBTYPE_R8 },</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;        { L<span class="stringliteral">&quot;DBTYPE_CY&quot;</span>, DBTYPE_CY },        { L<span class="stringliteral">&quot;CURRENCY&quot;</span>, DBTYPE_CY },</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;        { L<span class="stringliteral">&quot;DBTYPE_BOOL&quot;</span>, <a class="code" href="ColumnsRowset_8h.html#ab775cbed874dced0073d20da63c0b382">DBTYPE_BOOL</a> },    { L<span class="stringliteral">&quot;LOGICAL&quot;</span>, <a class="code" href="ColumnsRowset_8h.html#ab775cbed874dced0073d20da63c0b382">DBTYPE_BOOL</a> },</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;        <span class="comment">//{ L&quot;BIT&quot;, DBTYPE_BOOL },</span></div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;        { L<span class="stringliteral">&quot;DBTYPE_UI1&quot;</span>, DBTYPE_UI1 },      { L<span class="stringliteral">&quot;UNSIGNED(1)&quot;</span>, DBTYPE_UI1 },</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;        { L<span class="stringliteral">&quot;UTINYINT&quot;</span>, DBTYPE_UI1 },        { L<span class="stringliteral">&quot;TINYINT UNSIGNED&quot;</span>, DBTYPE_UI1 },</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;        { L<span class="stringliteral">&quot;DBTYPE_UI2&quot;</span>, DBTYPE_UI2 },      { L<span class="stringliteral">&quot;UNSIGNED(2)&quot;</span>, DBTYPE_UI2 },</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;        { L<span class="stringliteral">&quot;USMALLINT&quot;</span>, DBTYPE_UI2 },       { L<span class="stringliteral">&quot;SMALLINT UNSIGNED&quot;</span>, DBTYPE_UI2 },</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;        { L<span class="stringliteral">&quot;DBTYPE_UI4&quot;</span>, DBTYPE_UI4 },      { L<span class="stringliteral">&quot;UNSIGNED(4)&quot;</span>, DBTYPE_UI4 },</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;        { L<span class="stringliteral">&quot;UINTEGER&quot;</span>, DBTYPE_UI4 },        { L<span class="stringliteral">&quot;INTEGER UNSIGNED&quot;</span>, DBTYPE_UI4 },</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;        { L<span class="stringliteral">&quot;MEDIUMINT UNSIGNED&quot;</span>, DBTYPE_UI4 },</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;        { L<span class="stringliteral">&quot;DBTYPE_UI8&quot;</span>, DBTYPE_UI8 },      { L<span class="stringliteral">&quot;UNSIGNED(8)&quot;</span>, DBTYPE_UI8 },</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;        { L<span class="stringliteral">&quot;BIGINT UNSIGNED&quot;</span>, DBTYPE_UI8 }, { L<span class="stringliteral">&quot;UBIGINT&quot;</span>, DBTYPE_UI8 },</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;        { L<span class="stringliteral">&quot;DBTYPE_STR&quot;</span>, <a class="code" href="atldb__cubrid_8h.html#a9480826662e54d0b6019f4f4d27ada10">DBTYPE_STR</a> },      { L<span class="stringliteral">&quot;CHARACTER&quot;</span>, <a class="code" href="atldb__cubrid_8h.html#a9480826662e54d0b6019f4f4d27ada10">DBTYPE_STR</a> },</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;        { L<span class="stringliteral">&quot;LSTRING&quot;</span>, <a class="code" href="atldb__cubrid_8h.html#a9480826662e54d0b6019f4f4d27ada10">DBTYPE_STR</a> },         { L<span class="stringliteral">&quot;ZSTRING&quot;</span>, <a class="code" href="atldb__cubrid_8h.html#a9480826662e54d0b6019f4f4d27ada10">DBTYPE_STR</a> },</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;        { L<span class="stringliteral">&quot;NOTE&quot;</span>, <a class="code" href="atldb__cubrid_8h.html#a9480826662e54d0b6019f4f4d27ada10">DBTYPE_STR</a> },            { L<span class="stringliteral">&quot;CHAR&quot;</span>, <a class="code" href="atldb__cubrid_8h.html#a9480826662e54d0b6019f4f4d27ada10">DBTYPE_STR</a> },</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;        { L<span class="stringliteral">&quot;VARCHAR&quot;</span>, <a class="code" href="atldb__cubrid_8h.html#a9480826662e54d0b6019f4f4d27ada10">DBTYPE_STR</a> },         { L<span class="stringliteral">&quot;LONGVARCHAR&quot;</span>, <a class="code" href="atldb__cubrid_8h.html#a9480826662e54d0b6019f4f4d27ada10">DBTYPE_STR</a> },</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;        { L<span class="stringliteral">&quot;BLOB&quot;</span>, <a class="code" href="atldb__cubrid_8h.html#a9480826662e54d0b6019f4f4d27ada10">DBTYPE_STR</a> },            { L<span class="stringliteral">&quot;TINYBLOB&quot;</span>, <a class="code" href="atldb__cubrid_8h.html#a9480826662e54d0b6019f4f4d27ada10">DBTYPE_STR</a> },</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;        { L<span class="stringliteral">&quot;MEDIUMBLOB&quot;</span>, <a class="code" href="atldb__cubrid_8h.html#a9480826662e54d0b6019f4f4d27ada10">DBTYPE_STR</a> },      { L<span class="stringliteral">&quot;LONGBLOB&quot;</span>, <a class="code" href="atldb__cubrid_8h.html#a9480826662e54d0b6019f4f4d27ada10">DBTYPE_STR</a> },</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;        { L<span class="stringliteral">&quot;TEXT&quot;</span>, <a class="code" href="atldb__cubrid_8h.html#a9480826662e54d0b6019f4f4d27ada10">DBTYPE_STR</a> },            { L<span class="stringliteral">&quot;TINYTEXT&quot;</span>, <a class="code" href="atldb__cubrid_8h.html#a9480826662e54d0b6019f4f4d27ada10">DBTYPE_STR</a> },</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;        { L<span class="stringliteral">&quot;MEDIUMTEXT&quot;</span>, <a class="code" href="atldb__cubrid_8h.html#a9480826662e54d0b6019f4f4d27ada10">DBTYPE_STR</a> },      { L<span class="stringliteral">&quot;LONGTEXT&quot;</span>, <a class="code" href="atldb__cubrid_8h.html#a9480826662e54d0b6019f4f4d27ada10">DBTYPE_STR</a> },</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;        { L<span class="stringliteral">&quot;NULL&quot;</span>, <a class="code" href="atldb__cubrid_8h.html#a9480826662e54d0b6019f4f4d27ada10">DBTYPE_STR</a> },            { L<span class="stringliteral">&quot;ENUM&quot;</span>, <a class="code" href="atldb__cubrid_8h.html#a9480826662e54d0b6019f4f4d27ada10">DBTYPE_STR</a> },</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;        { L<span class="stringliteral">&quot;SET&quot;</span>, <a class="code" href="atldb__cubrid_8h.html#a9480826662e54d0b6019f4f4d27ada10">DBTYPE_STR</a> },</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;        { L<span class="stringliteral">&quot;NCHAR&quot;</span>, <a class="code" href="atldb__cubrid_8h.html#a4637765a8f83fd4fc2df8bf7d8ffd02e">DBTYPE_WSTR</a> },          { L<span class="stringliteral">&quot;NCHAR VARYING&quot;</span>, <a class="code" href="atldb__cubrid_8h.html#a4637765a8f83fd4fc2df8bf7d8ffd02e">DBTYPE_WSTR</a> },</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;        { L<span class="stringliteral">&quot;DBTYPE_BYTES&quot;</span>, DBTYPE_BYTES },  { L<span class="stringliteral">&quot;LVAR&quot;</span>, DBTYPE_BYTES },</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;        { L<span class="stringliteral">&quot;LONG VARBINARY&quot;</span>, DBTYPE_BYTES },{ L<span class="stringliteral">&quot;LONGVARBINARY&quot;</span>, DBTYPE_BYTES },</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;        { L<span class="stringliteral">&quot;BINARY&quot;</span>, DBTYPE_BYTES },        { L<span class="stringliteral">&quot;BIT&quot;</span>, DBTYPE_BYTES },</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;        { L<span class="stringliteral">&quot;BIT VARYING&quot;</span>, DBTYPE_BYTES },</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;        { L<span class="stringliteral">&quot;DBTYPE_DBDATE&quot;</span>, DBTYPE_DBDATE },{ L<span class="stringliteral">&quot;DATE&quot;</span>, DBTYPE_DBDATE },</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;        { L<span class="stringliteral">&quot;DBTYPE_DBTIME&quot;</span>, DBTYPE_DBTIME },{ L<span class="stringliteral">&quot;TIME&quot;</span>, DBTYPE_DBTIME },</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;        { L<span class="stringliteral">&quot;DBTYPE_DBTIMESTAMP&quot;</span>, DBTYPE_DBTIMESTAMP },</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;        { L<span class="stringliteral">&quot;TIMESTAMP&quot;</span>, DBTYPE_DBTIMESTAMP },</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;        { L<span class="stringliteral">&quot;DATETIME&quot;</span>, DBTYPE_DBTIMESTAMP },</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    };</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="atldb__cubrid_8h.html#a851aabdebc10ed6b7d279d768ed199ef">pwszName</a>==<a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>) <span class="keywordflow">return</span> <a class="code" href="atldb__cubrid_8h.html#a4637765a8f83fd4fc2df8bf7d8ffd02e">DBTYPE_WSTR</a>;</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>=1;<a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;<span class="keyword">sizeof</span>(types)/<span class="keyword">sizeof</span>(*types);<a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    {</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;        <span class="keywordflow">if</span>(_wcsicmp(<a class="code" href="atldb__cubrid_8h.html#a851aabdebc10ed6b7d279d768ed199ef">pwszName</a>, types[<a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="atldb__cubrid_8h.html#a851aabdebc10ed6b7d279d768ed199ef">pwszName</a>)==0)</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;            <span class="keywordflow">return</span> types[<a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>].wType;</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;    }</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="atldb__cubrid_8h.html#a9480826662e54d0b6019f4f4d27ada10">DBTYPE_STR</a>;</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;}</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;<span class="keyword">static</span> HRESULT CompareSTR(DBCOMPAREOP CompareOp, <span class="keyword">const</span> <span class="keywordtype">char</span> *szRowValue, <span class="keyword">const</span> <span class="keywordtype">char</span> *szFindValue)</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;{</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;    DBCOMPAREOP LocalOp = CompareOp &amp; ~DBCOMPAREOPS_CASESENSITIVE &amp; ~DBCOMPAREOPS_CASEINSENSITIVE;</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    <span class="keywordflow">switch</span>(LocalOp)</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;    {</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    <span class="keywordflow">case</span> DBCOMPAREOPS_LT:</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;    <span class="keywordflow">case</span> DBCOMPAREOPS_LE:</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;    <span class="keywordflow">case</span> DBCOMPAREOPS_EQ:</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    <span class="keywordflow">case</span> DBCOMPAREOPS_GE:</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    <span class="keywordflow">case</span> DBCOMPAREOPS_GT:</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    <span class="keywordflow">case</span> DBCOMPAREOPS_NE:</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;        {</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;            <span class="comment">// 디폴트는 case sensitive</span></div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;            <span class="keywordtype">int</span> res;</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;            <span class="keywordflow">if</span>(CompareOp &amp; DBCOMPAREOPS_CASEINSENSITIVE)</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;                res = _stricmp(szRowValue, szFindValue);</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;                res = strcmp(szRowValue, szFindValue);</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;            <span class="keywordflow">if</span>( ( LocalOp==DBCOMPAREOPS_LT &amp;&amp; res&lt; 0 ) ||</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;                ( LocalOp==DBCOMPAREOPS_LE &amp;&amp; res&lt;=0 ) ||</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;                ( LocalOp==DBCOMPAREOPS_EQ &amp;&amp; res==0 ) ||</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;                ( LocalOp==DBCOMPAREOPS_GE &amp;&amp; res&gt;=0 ) ||</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;                ( LocalOp==DBCOMPAREOPS_GT &amp;&amp; res&gt; 0 ) ||</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;                ( LocalOp==DBCOMPAREOPS_NE &amp;&amp; res!=0 ) )</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="atldb__cubrid_8h.html#a1c8f62bc38a50376a62d4dad41a5e2aa">S_OK</a>;</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="atldb__cubrid_8h.html#a12639216b34cff39e3f17c4798373779">S_FALSE</a>;</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;        }</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;    <span class="keywordflow">case</span> DBCOMPAREOPS_BEGINSWITH:</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;        {</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;            <span class="keywordtype">int</span> res;</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;            <span class="keywordtype">size_t</span> <a class="code" href="expat_8h.html#afed088663f8704004425cdae2120b9b3">len</a> = <a class="code" href="intl__support_8c.html#ab543901c3564a54b2450303d63374f55">strlen</a>(szFindValue);</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;            <span class="keywordflow">if</span>(CompareOp &amp; DBCOMPAREOPS_CASEINSENSITIVE)</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;                res = _strnicmp(szRowValue, szFindValue, <a class="code" href="expat_8h.html#afed088663f8704004425cdae2120b9b3">len</a>);</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;                res = strncmp(szRowValue, szFindValue, <a class="code" href="expat_8h.html#afed088663f8704004425cdae2120b9b3">len</a>);</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;            <span class="keywordflow">return</span> res==0 ? <a class="code" href="atldb__cubrid_8h.html#a1c8f62bc38a50376a62d4dad41a5e2aa">S_OK</a> : <a class="code" href="atldb__cubrid_8h.html#a12639216b34cff39e3f17c4798373779">S_FALSE</a>;</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;        }</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;    <span class="keywordflow">case</span> DBCOMPAREOPS_NOTBEGINSWITH:</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;        {</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;            <span class="keywordtype">int</span> res;</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;            <span class="keywordtype">size_t</span> <a class="code" href="expat_8h.html#afed088663f8704004425cdae2120b9b3">len</a> = <a class="code" href="intl__support_8c.html#ab543901c3564a54b2450303d63374f55">strlen</a>(szFindValue);</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;            <span class="keywordflow">if</span>(CompareOp &amp; DBCOMPAREOPS_CASEINSENSITIVE)</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;                res = _strnicmp(szRowValue, szFindValue, <a class="code" href="expat_8h.html#afed088663f8704004425cdae2120b9b3">len</a>);</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;                res = strncmp(szRowValue, szFindValue, <a class="code" href="expat_8h.html#afed088663f8704004425cdae2120b9b3">len</a>);</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;            <span class="keywordflow">return</span> res!=0 ? <a class="code" href="atldb__cubrid_8h.html#a1c8f62bc38a50376a62d4dad41a5e2aa">S_OK</a> : <a class="code" href="atldb__cubrid_8h.html#a12639216b34cff39e3f17c4798373779">S_FALSE</a>;</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;        }</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;    <span class="comment">// TODO: case insensitive</span></div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;    <span class="keywordflow">case</span> DBCOMPAREOPS_CONTAINS:</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;        {</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">char</span> *res;</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;            <span class="keywordflow">if</span>(CompareOp &amp; DBCOMPAREOPS_CASEINSENSITIVE)</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;            {</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;                CStringA <a class="code" href="namespacesample__cubrid.html#a27c7e3b540ffe07a400097340a612765">row</a>(szRowValue), find(szFindValue);</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;                <a class="code" href="namespacesample__cubrid.html#a27c7e3b540ffe07a400097340a612765">row</a>.MakeUpper(); find.MakeUpper();</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;                res = strstr(<a class="code" href="namespacesample__cubrid.html#a27c7e3b540ffe07a400097340a612765">row</a>, find);</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;            }</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;                res = strstr(szRowValue, szFindValue);</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;            <span class="keywordflow">return</span> res!=0 ? <a class="code" href="atldb__cubrid_8h.html#a1c8f62bc38a50376a62d4dad41a5e2aa">S_OK</a> : <a class="code" href="atldb__cubrid_8h.html#a12639216b34cff39e3f17c4798373779">S_FALSE</a>;</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;        }</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;    <span class="keywordflow">case</span> DBCOMPAREOPS_NOTCONTAINS:</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;        {</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">char</span> *res;</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;            <span class="keywordflow">if</span>(CompareOp &amp; DBCOMPAREOPS_CASEINSENSITIVE)</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;            {</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;                CStringA <a class="code" href="namespacesample__cubrid.html#a27c7e3b540ffe07a400097340a612765">row</a>(szRowValue), find(szFindValue);</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;                <a class="code" href="namespacesample__cubrid.html#a27c7e3b540ffe07a400097340a612765">row</a>.MakeUpper(); find.MakeUpper();</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;                res = strstr(<a class="code" href="namespacesample__cubrid.html#a27c7e3b540ffe07a400097340a612765">row</a>, find);</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;            }</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;                res = strstr(szRowValue, szFindValue);</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;            <span class="keywordflow">return</span> res==0 ? <a class="code" href="atldb__cubrid_8h.html#a1c8f62bc38a50376a62d4dad41a5e2aa">S_OK</a> : <a class="code" href="atldb__cubrid_8h.html#a12639216b34cff39e3f17c4798373779">S_FALSE</a>;</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;        }</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    }</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;    <span class="keywordflow">return</span> DB_E_BADCOMPAREOP;</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;}</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;<span class="keyword">static</span> HRESULT CompareI4(DBCOMPAREOP CompareOp, <span class="keyword">const</span> <span class="keywordtype">char</span> *szRowValue, <span class="keyword">const</span> <span class="keywordtype">char</span> *szFindValue)</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;{</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;    <span class="keywordflow">if</span>( CompareOp!=DBCOMPAREOPS_LT &amp;&amp; CompareOp!=DBCOMPAREOPS_LE &amp;&amp;</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;        CompareOp!=DBCOMPAREOPS_EQ &amp;&amp; CompareOp!=DBCOMPAREOPS_NE &amp;&amp;</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;        CompareOp!=DBCOMPAREOPS_GE &amp;&amp; CompareOp!=DBCOMPAREOPS_GT )</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;        <span class="keywordflow">return</span> DB_E_BADCOMPAREOP;</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;    <span class="keywordtype">int</span> nRowValue = atoi(szRowValue);</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;    <span class="keywordtype">int</span> nFindValue = atoi(szFindValue);</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;    <span class="keywordflow">if</span>( ( CompareOp==DBCOMPAREOPS_LT &amp;&amp; nRowValue&lt; nFindValue ) ||</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;        ( CompareOp==DBCOMPAREOPS_LE &amp;&amp; nRowValue&lt;=nFindValue ) ||</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;        ( CompareOp==DBCOMPAREOPS_EQ &amp;&amp; nRowValue==nFindValue ) ||</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;        ( CompareOp==DBCOMPAREOPS_GE &amp;&amp; nRowValue&gt;=nFindValue ) ||</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;        ( CompareOp==DBCOMPAREOPS_GT &amp;&amp; nRowValue&gt; nFindValue ) ||</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;        ( CompareOp==DBCOMPAREOPS_NE &amp;&amp; nRowValue!=nFindValue ) )</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="atldb__cubrid_8h.html#a1c8f62bc38a50376a62d4dad41a5e2aa">S_OK</a>;</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="atldb__cubrid_8h.html#a12639216b34cff39e3f17c4798373779">S_FALSE</a>;</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;}</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;<span class="keyword">static</span> HRESULT CompareI2(DBCOMPAREOP CompareOp, <span class="keyword">const</span> <span class="keywordtype">char</span> *szRowValue, <span class="keyword">const</span> <span class="keywordtype">char</span> *szFindValue)</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;{</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;    <span class="keywordflow">if</span>( CompareOp!=DBCOMPAREOPS_LT &amp;&amp; CompareOp!=DBCOMPAREOPS_LE &amp;&amp;</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;        CompareOp!=DBCOMPAREOPS_EQ &amp;&amp; CompareOp!=DBCOMPAREOPS_NE &amp;&amp;</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;        CompareOp!=DBCOMPAREOPS_GE &amp;&amp; CompareOp!=DBCOMPAREOPS_GT )</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;        <span class="keywordflow">return</span> DB_E_BADCOMPAREOP;</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;    <span class="keywordtype">short</span> nRowValue = (short)atoi(szRowValue);</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;    <span class="keywordtype">short</span> nFindValue = (short)atoi(szFindValue);</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;    <span class="keywordflow">if</span>( ( CompareOp==DBCOMPAREOPS_LT &amp;&amp; nRowValue&lt; nFindValue ) ||</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;        ( CompareOp==DBCOMPAREOPS_LE &amp;&amp; nRowValue&lt;=nFindValue ) ||</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;        ( CompareOp==DBCOMPAREOPS_EQ &amp;&amp; nRowValue==nFindValue ) ||</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;        ( CompareOp==DBCOMPAREOPS_GE &amp;&amp; nRowValue&gt;=nFindValue ) ||</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;        ( CompareOp==DBCOMPAREOPS_GT &amp;&amp; nRowValue&gt; nFindValue ) ||</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;        ( CompareOp==DBCOMPAREOPS_NE &amp;&amp; nRowValue!=nFindValue ) )</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="atldb__cubrid_8h.html#a1c8f62bc38a50376a62d4dad41a5e2aa">S_OK</a>;</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="atldb__cubrid_8h.html#a12639216b34cff39e3f17c4798373779">S_FALSE</a>;</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;}</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;<span class="keyword">static</span> HRESULT CompareR4(DBCOMPAREOP CompareOp, <span class="keyword">const</span> <span class="keywordtype">char</span> *szRowValue, <span class="keyword">const</span> <span class="keywordtype">char</span> *szFindValue)</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;{</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;    <span class="keywordflow">if</span>( CompareOp!=DBCOMPAREOPS_LT &amp;&amp; CompareOp!=DBCOMPAREOPS_LE &amp;&amp;</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;        CompareOp!=DBCOMPAREOPS_EQ &amp;&amp; CompareOp!=DBCOMPAREOPS_NE &amp;&amp;</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;        CompareOp!=DBCOMPAREOPS_GE &amp;&amp; CompareOp!=DBCOMPAREOPS_GT )</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;        <span class="keywordflow">return</span> DB_E_BADCOMPAREOP;</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;    <span class="keywordtype">float</span> fRowValue = (float)atof(szRowValue);</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;    <span class="keywordtype">float</span> fFindValue = (float)atof(szFindValue);</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;    <span class="keywordflow">if</span>( ( CompareOp==DBCOMPAREOPS_LT &amp;&amp; fRowValue&lt; fFindValue ) ||</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;        ( CompareOp==DBCOMPAREOPS_LE &amp;&amp; fRowValue&lt;=fFindValue ) ||</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;        ( CompareOp==DBCOMPAREOPS_EQ &amp;&amp; fRowValue==fFindValue ) ||</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;        ( CompareOp==DBCOMPAREOPS_GE &amp;&amp; fRowValue&gt;=fFindValue ) ||</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;        ( CompareOp==DBCOMPAREOPS_GT &amp;&amp; fRowValue&gt; fFindValue ) ||</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;        ( CompareOp==DBCOMPAREOPS_NE &amp;&amp; fRowValue!=fFindValue ) )</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="atldb__cubrid_8h.html#a1c8f62bc38a50376a62d4dad41a5e2aa">S_OK</a>;</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="atldb__cubrid_8h.html#a12639216b34cff39e3f17c4798373779">S_FALSE</a>;</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;}</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;<span class="keyword">static</span> HRESULT CompareR8(DBCOMPAREOP CompareOp, <span class="keyword">const</span> <span class="keywordtype">char</span> *szRowValue, <span class="keyword">const</span> <span class="keywordtype">char</span> *szFindValue)</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;{</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;    <span class="keywordflow">if</span>( CompareOp!=DBCOMPAREOPS_LT &amp;&amp; CompareOp!=DBCOMPAREOPS_LE &amp;&amp;</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;        CompareOp!=DBCOMPAREOPS_EQ &amp;&amp; CompareOp!=DBCOMPAREOPS_NE &amp;&amp;</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;        CompareOp!=DBCOMPAREOPS_GE &amp;&amp; CompareOp!=DBCOMPAREOPS_GT )</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;        <span class="keywordflow">return</span> DB_E_BADCOMPAREOP;</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;    <span class="keywordtype">double</span> dRowValue = atof(szRowValue);</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;    <span class="keywordtype">double</span> dFindValue = atof(szFindValue);</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;    <span class="keywordflow">if</span>( ( CompareOp==DBCOMPAREOPS_LT &amp;&amp; dRowValue&lt; dFindValue ) ||</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;        ( CompareOp==DBCOMPAREOPS_LE &amp;&amp; dRowValue&lt;=dFindValue ) ||</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;        ( CompareOp==DBCOMPAREOPS_EQ &amp;&amp; dRowValue==dFindValue ) ||</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;        ( CompareOp==DBCOMPAREOPS_GE &amp;&amp; dRowValue&gt;=dFindValue ) ||</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;        ( CompareOp==DBCOMPAREOPS_GT &amp;&amp; dRowValue&gt; dFindValue ) ||</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;        ( CompareOp==DBCOMPAREOPS_NE &amp;&amp; dRowValue!=dFindValue ) )</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="atldb__cubrid_8h.html#a1c8f62bc38a50376a62d4dad41a5e2aa">S_OK</a>;</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="atldb__cubrid_8h.html#a12639216b34cff39e3f17c4798373779">S_FALSE</a>;</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;}</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;</div><div class="line"><a name="l00956"></a><span class="lineno"><a class="line" href="namespaceType.html#ab492074b28f75cd9328b1fced30d3290">  956</a></span>&#160;HRESULT <a class="code" href="namespaceType.html#ab492074b28f75cd9328b1fced30d3290">Compare</a>(DBCOMPAREOP CompareOp, DBTYPE wType, <span class="keyword">const</span> <span class="keywordtype">char</span> *szRowValue, <span class="keyword">const</span> <span class="keywordtype">char</span> *szFindValue)</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;{</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;    <span class="keywordflow">switch</span>(wType)</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;    {</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="atldb__cubrid_8h.html#a9480826662e54d0b6019f4f4d27ada10">DBTYPE_STR</a>:</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="atldb__cubrid_8h.html#a4637765a8f83fd4fc2df8bf7d8ffd02e">DBTYPE_WSTR</a>:</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;        <span class="keywordflow">return</span> CompareSTR(CompareOp, szRowValue, szFindValue);</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;    <span class="keywordflow">case</span> DBTYPE_I4:</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;        <span class="keywordflow">return</span> CompareI4(CompareOp, szRowValue, szFindValue);</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;    <span class="keywordflow">case</span> DBTYPE_I2:</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;        <span class="keywordflow">return</span> CompareI2(CompareOp, szRowValue, szFindValue);</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;    <span class="keywordflow">case</span> DBTYPE_R4:</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;        <span class="keywordflow">return</span> CompareR4(CompareOp, szRowValue, szFindValue);</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;    <span class="keywordflow">case</span> DBTYPE_R8:</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;        <span class="keywordflow">return</span> CompareR8(CompareOp, szRowValue, szFindValue);</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;    <span class="keywordflow">default</span>:</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;        <span class="keywordflow">return</span> DB_E_BADCOMPAREOP;</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;    }</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;}</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;</div><div class="line"><a name="l00983"></a><span class="lineno"><a class="line" href="namespaceType.html#a5cbb0f735e4aa01dcae86f96d68bf699">  983</a></span>&#160;<span class="keywordtype">long</span> <a class="code" href="namespaceType.html#a5cbb0f735e4aa01dcae86f96d68bf699">GetFindCompareOps</a>(DBTYPE wType)</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;{</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;    <span class="keywordflow">switch</span>(wType)</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    {</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="atldb__cubrid_8h.html#a9480826662e54d0b6019f4f4d27ada10">DBTYPE_STR</a>:</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="atldb__cubrid_8h.html#a4637765a8f83fd4fc2df8bf7d8ffd02e">DBTYPE_WSTR</a>:</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;        <span class="keywordflow">return</span> DBPROPVAL_CO_EQUALITY | DBPROPVAL_CO_STRING | DBPROPVAL_CO_CONTAINS</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;                | DBPROPVAL_CO_BEGINSWITH | DBPROPVAL_CO_CASEINSENSITIVE;</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;    <span class="keywordflow">case</span> DBTYPE_I4:</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;    <span class="keywordflow">case</span> DBTYPE_I2:</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;    <span class="keywordflow">case</span> DBTYPE_R4:</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;    <span class="keywordflow">case</span> DBTYPE_R8:</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;        <span class="keywordflow">return</span> DBPROPVAL_CO_EQUALITY;</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;    }</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;}</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;<span class="comment">// 원래 VARIANT_BOOL은 VARIANT_TRUE와 VARIANT_FALSE만을 갖지만 1을 가지는 경우도 있다.</span></div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;<span class="comment">// 이경우 GetDBStatus에서 DBSTATUS_S_ISNULL을 반환하고, 값은 무시되므로 괜찮다.</span></div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;<span class="keyword">static</span> StaticTypeInfo static_type_infos[] = {</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;    <span class="comment">// CCI type,           OLEDB type,     size, prefix, suffix, case sensitive, searchable,        unsigned,      fixed length,  long,          fixed p&amp;s</span></div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;    { <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a816edf276f251f83824d11e32785920b">CCI_U_TYPE_UNKNOWN</a>,  <a class="code" href="atldb__cubrid_8h.html#a9480826662e54d0b6019f4f4d27ada10">DBTYPE_STR</a>,  4000, L<span class="stringliteral">&quot;&quot;</span>,   L<span class="stringliteral">&quot;&quot;</span>,  VARIANT_TRUE, DB_SEARCHABLE,    1,             VARIANT_FALSE, VARIANT_FALSE, VARIANT_TRUE  },</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;    { <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a0005b45612de0477eee20270f01e84be">CCI_U_TYPE_CHAR</a>,     <a class="code" href="atldb__cubrid_8h.html#a9480826662e54d0b6019f4f4d27ada10">DBTYPE_STR</a>,  1073741823, L<span class="stringliteral">&quot;&#39;&quot;</span>,  L<span class="stringliteral">&quot;&#39;&quot;</span>, VARIANT_TRUE,  DB_SEARCHABLE,      1,             VARIANT_TRUE,  VARIANT_TRUE,  VARIANT_TRUE  },</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;    { <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a17e9464e2c9d5dc2c753e99a4d1a0bd3">CCI_U_TYPE_STRING</a>,   <a class="code" href="atldb__cubrid_8h.html#a9480826662e54d0b6019f4f4d27ada10">DBTYPE_STR</a>,  1073741823, L<span class="stringliteral">&quot;&#39;&quot;</span>,  L<span class="stringliteral">&quot;&#39;&quot;</span>, VARIANT_TRUE,  DB_SEARCHABLE,      1,             VARIANT_FALSE, VARIANT_TRUE,  VARIANT_TRUE  },</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;    <span class="comment">// TODO: NCHAR와 WSTR은 좀 차이가 있다. 그래서 문제가 생길 여지가 좀 있는데</span></div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;    <span class="comment">//       그렇다고 STR으로 할 수는 없어서, WSTR으로 한다.</span></div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;    { <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a2a9a7f31a26489fa99f9e188109ffbcd">CCI_U_TYPE_NCHAR</a>,    <a class="code" href="atldb__cubrid_8h.html#a4637765a8f83fd4fc2df8bf7d8ffd02e">DBTYPE_WSTR</a>,  536870911/2, L<span class="stringliteral">&quot;N&#39;&quot;</span>, L<span class="stringliteral">&quot;&#39;&quot;</span>, VARIANT_TRUE,  DB_SEARCHABLE,      1,             VARIANT_TRUE,  VARIANT_TRUE,  VARIANT_TRUE  },</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;    { <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a1d55418f4dba6a23dd5da424c296eff1">CCI_U_TYPE_VARNCHAR</a>, <a class="code" href="atldb__cubrid_8h.html#a4637765a8f83fd4fc2df8bf7d8ffd02e">DBTYPE_WSTR</a>,  536870911/2, L<span class="stringliteral">&quot;N&#39;&quot;</span>, L<span class="stringliteral">&quot;&#39;&quot;</span>, VARIANT_TRUE,  DB_SEARCHABLE,      1,             VARIANT_FALSE, VARIANT_TRUE,  VARIANT_TRUE  },</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;    <span class="comment">// TODO: 크기를 1073741823로 해야 하는지, 268435455 또는 134217727으로 해야 하는지 모르겠음</span></div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;    <span class="comment">//       LTM에서는 &#39;F111...&#39;과 같은 데이터를 만들어서 prefix는 16진수를 쓰는 걸로 함</span></div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;    { <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a3331febb5322b5e1fc0b1aff9d4109c7">CCI_U_TYPE_BIT</a>,     DBTYPE_BYTES, 1073741823, L<span class="stringliteral">&quot;X&#39;&quot;</span>, L<span class="stringliteral">&quot;&#39;&quot;</span>, VARIANT_FALSE, DB_ALL_EXCEPT_LIKE, 1,             VARIANT_TRUE,  VARIANT_TRUE,  VARIANT_TRUE  },</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;    { <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a25875f983ab7c580ccdc55230fb27ce8">CCI_U_TYPE_VARBIT</a>,  DBTYPE_BYTES, 1073741823, L<span class="stringliteral">&quot;X&#39;&quot;</span>, L<span class="stringliteral">&quot;&#39;&quot;</span>, VARIANT_FALSE, DB_ALL_EXCEPT_LIKE, 1,             VARIANT_FALSE, VARIANT_TRUE,  VARIANT_TRUE  },</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;    { <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812adae048f88ebb3c044c91fbfc0fce2ae8">CCI_U_TYPE_NUMERIC</a>,  DBTYPE_NUMERIC,      38, L<span class="stringliteral">&quot;&quot;</span>,   L<span class="stringliteral">&quot;&quot;</span>,  VARIANT_FALSE, DB_ALL_EXCEPT_LIKE, VARIANT_FALSE, VARIANT_FALSE, VARIANT_FALSE, VARIANT_TRUE  },</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;    { <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a3bc19b2ce116ecd9d4a9414ba799bda9">CCI_U_TYPE_INT</a>,      DBTYPE_I4,           10, L<span class="stringliteral">&quot;&quot;</span>,   L<span class="stringliteral">&quot;&quot;</span>,  VARIANT_FALSE, DB_ALL_EXCEPT_LIKE, VARIANT_FALSE, VARIANT_TRUE,  VARIANT_FALSE, VARIANT_TRUE  },</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;    { <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a7f999a2a5014fb266689822387d495e5">CCI_U_TYPE_SHORT</a>,    DBTYPE_I2,            5, L<span class="stringliteral">&quot;&quot;</span>,   L<span class="stringliteral">&quot;&quot;</span>,  VARIANT_FALSE, DB_ALL_EXCEPT_LIKE, VARIANT_FALSE, VARIANT_TRUE,  VARIANT_FALSE, VARIANT_TRUE  },</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;    { <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a7d4c7fb802ed00d6280958c5880dc581">CCI_U_TYPE_MONETARY</a>, DBTYPE_R8,           15, L<span class="stringliteral">&quot;&quot;</span>,   L<span class="stringliteral">&quot;&quot;</span>,  VARIANT_FALSE, DB_ALL_EXCEPT_LIKE, VARIANT_FALSE, VARIANT_TRUE,  VARIANT_FALSE, VARIANT_FALSE },</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;    { <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812ae68408a06508953230175cfcb233dfcc">CCI_U_TYPE_FLOAT</a>,    DBTYPE_R4,            7, L<span class="stringliteral">&quot;&quot;</span>,   L<span class="stringliteral">&quot;&quot;</span>,  VARIANT_FALSE, DB_ALL_EXCEPT_LIKE, VARIANT_FALSE, VARIANT_TRUE,  VARIANT_FALSE, VARIANT_FALSE },</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;    { <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a4b1bb46374a90cd0fcef2e9bb58c7236">CCI_U_TYPE_DOUBLE</a>,   DBTYPE_R8,           15, L<span class="stringliteral">&quot;&quot;</span>,   L<span class="stringliteral">&quot;&quot;</span>,  VARIANT_FALSE, DB_ALL_EXCEPT_LIKE, VARIANT_FALSE, VARIANT_TRUE,  VARIANT_FALSE, VARIANT_FALSE },</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;    { <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a7b4e84af853a62908e629d1fe0bbd848">CCI_U_TYPE_DATE</a>,     DBTYPE_DBDATE,       10, L<span class="stringliteral">&quot;&#39;&quot;</span>,  L<span class="stringliteral">&quot;&#39;&quot;</span>, VARIANT_FALSE, DB_ALL_EXCEPT_LIKE, 1,             VARIANT_TRUE,  VARIANT_FALSE, VARIANT_TRUE  },</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;    <span class="comment">// NOTE: time의 &#39;am&#39;, &#39;pm&#39; 자리까지 생각해서 size를 정하면   //       LTM은 1/100초 자리로 생각을 함. 그래서 뺌
    { CCI_U_TYPE_TIME,     DBTYPE_DBTIME,        8, L&quot;&#39;&quot;,  L&quot;&#39;&quot;, VARIANT_FALSE, DB_ALL_EXCEPT_LIKE, 1,             VARIANT_TRUE,  VARIANT_FALSE, VARIANT_TRUE  },
    { CCI_U_TYPE_TIMESTAMP, DBTYPE_DBTIMESTAMP, 19, L&quot;&#39;&quot;,  L&quot;&#39;&quot;, VARIANT_FALSE, DB_ALL_EXCEPT_LIKE, 1,             VARIANT_TRUE,  VARIANT_FALSE, VARIANT_TRUE  },
    // TODO: mapping to DBTYPE_IUnknown?
    { CCI_U_TYPE_OBJECT,   DBTYPE_STR,  1073741823, L&quot;&#39;&quot;,  L&quot;&#39;&quot;, VARIANT_TRUE,  DB_SEARCHABLE,      1,             VARIANT_FALSE, VARIANT_TRUE,  VARIANT_TRUE  },
    { CCI_U_TYPE_MULTISET,   DBTYPE_STR,  1073741823, L&quot;&#39;&quot;,  L&quot;&#39;&quot;, VARIANT_TRUE,  DB_SEARCHABLE,      1,             VARIANT_FALSE, VARIANT_TRUE,  VARIANT_TRUE  },
    { CCI_U_TYPE_SET,   DBTYPE_STR,  1073741823, L&quot;&#39;&quot;,  L&quot;&#39;&quot;, VARIANT_TRUE,  DB_SEARCHABLE,      1,             VARIANT_FALSE, VARIANT_TRUE,  VARIANT_TRUE  },
};

const StaticTypeInfo &amp;GetStaticTypeInfo(T_CCI_U_TYPE nCCIUType)
{
    for(int i=1;i&lt;sizeof(static_type_infos)/sizeof(*static_type_infos);i++)
    {
        if(static_type_infos[i].nCCIUType==nCCIUType)
            return static_type_infos[i];
    }
    return static_type_infos[0];
}

DynamicTypeInfo GetDynamicTypeInfo(T_CCI_U_TYPE nCCIUType, int nPrecision, int nScale, bool bNullable)
{
    /* 스펙엔 &#39;this is the size of the data type&#39;라고 되어 있어서
     * ulColumnSize = StaticTypeInfo::ulSize (문자열로 봤을 때의 길이) 라고 생각했으나
     * LTM을 보니 저장공간의 크기를 말하는 것 같다.
     */
    DynamicTypeInfo dyn_info;
    const StaticTypeInfo &amp;sta_info = GetStaticTypeInfo(nCCIUType);

    dyn_info.ulFlags = 0;
    dyn_info.ulFlags |= DBCOLUMNFLAGS_WRITEUNKNOWN;
    dyn_info.ulFlags |= DBCOLUMNFLAGS_ISFIXEDLENGTH;
    if(bNullable)
        dyn_info.ulFlags |= DBCOLUMNFLAGS_ISNULLABLE | DBCOLUMNFLAGS_MAYBENULL;
    dyn_info.ulColumnSize = (ULONG)~0;
    dyn_info.bPrecision = ~0;
    dyn_info.bScale = ~0;
    dyn_info.ulCharMaxLength = (ULONG)~0;
    dyn_info.ulCharOctetLength = (ULONG)~0;
    dyn_info.nNumericPrecision = (USHORT)~0;
    dyn_info.nNumericScale = -1;
    dyn_info.ulDateTimePrecision = (ULONG)~0;

    switch(nCCIUType)
    {
    case CCI_U_TYPE_STRING:
    case CCI_U_TYPE_VARNCHAR:
        dyn_info.ulFlags &amp;= ~DBCOLUMNFLAGS_ISFIXEDLENGTH; // 주의 break 없음
    case CCI_U_TYPE_CHAR:
    case CCI_U_TYPE_NCHAR:
        if(nCCIUType==CCI_U_TYPE_VARNCHAR || nCCIUType==CCI_U_TYPE_NCHAR)
            dyn_info.ulColumnSize = nPrecision / 2;
        else
            dyn_info.ulColumnSize = nPrecision;

        dyn_info.ulCharMaxLength = dyn_info.ulColumnSize;
        dyn_info.ulCharOctetLength = dyn_info.ulCharMaxLength;
        if(nCCIUType==CCI_U_TYPE_VARNCHAR || nCCIUType==CCI_U_TYPE_NCHAR)
        {
            dyn_info.ulCharOctetLength *= 2; // TODO: 좀 다르긴 하지만 LTM을 위해 일단 2배를 한다.
        }
        break;

    case CCI_U_TYPE_VARBIT:
        dyn_info.ulFlags &amp;= ~DBCOLUMNFLAGS_ISFIXEDLENGTH; // 주의 break 없음
    case CCI_U_TYPE_BIT:
        // TODO: Maximum length니까 올림을 하는게 맞을 것 같은데, 하면 LTM은
        //       BYTE단위로 데이터를 만들어서 BIT로 보면 초과해서 에러가 난다.
        dyn_info.ulColumnSize = (int)(nPrecision/8);
        dyn_info.ulCharMaxLength = dyn_info.ulColumnSize;
        dyn_info.ulCharOctetLength = dyn_info.ulCharMaxLength;
        break;

    case CCI_U_TYPE_NUMERIC:
        dyn_info.ulColumnSize = sizeof(DB_NUMERIC);
        dyn_info.bPrecision = nPrecision;
        dyn_info.bScale = nScale;
        dyn_info.nNumericPrecision = dyn_info.bPrecision;
        dyn_info.nNumericScale = dyn_info.bScale;
        break;

    case CCI_U_TYPE_INT:
        dyn_info.ulColumnSize = 4;
        dyn_info.bPrecision = (BYTE)sta_info.ulSize;
        dyn_info.nNumericPrecision = dyn_info.bPrecision;
        break;

    case CCI_U_TYPE_SHORT:
        dyn_info.ulColumnSize = 2;
        dyn_info.bPrecision = (BYTE)sta_info.ulSize;
        dyn_info.nNumericPrecision = dyn_info.bPrecision;
        break;

    case CCI_U_TYPE_MONETARY:
        dyn_info.ulColumnSize = sizeof(double);
        dyn_info.bPrecision = (BYTE)sta_info.ulSize;
        dyn_info.nNumericPrecision = dyn_info.bPrecision;
        break;

    case CCI_U_TYPE_FLOAT:
        dyn_info.ulColumnSize = sizeof(float);
        dyn_info.bPrecision = (BYTE)sta_info.ulSize;
        dyn_info.nNumericPrecision = dyn_info.bPrecision;
        break;

    case CCI_U_TYPE_DOUBLE:
        dyn_info.ulColumnSize = sizeof(double);
        dyn_info.bPrecision = (BYTE)sta_info.ulSize;
        dyn_info.nNumericPrecision = dyn_info.bPrecision;
        break;

    case CCI_U_TYPE_DATE:
        dyn_info.ulColumnSize = sizeof(DBDATE);
        break;

    case CCI_U_TYPE_TIME:
        dyn_info.ulColumnSize = sizeof(DBTIME);
        break;

    case CCI_U_TYPE_TIMESTAMP:
        dyn_info.ulColumnSize = sizeof(DBTIMESTAMP);
        dyn_info.bPrecision = (BYTE)sta_info.ulSize;
        dyn_info.bScale = 0;
        dyn_info.ulDateTimePrecision = dyn_info.bScale;
        break;

    case CCI_U_TYPE_OBJECT:
        //dyn_info.ulColumnSize = nPrecision;
        //OID 스트링 max length를 15로 보고 수정
        dyn_info.ulColumnSize = 15;
        dyn_info.ulCharMaxLength = dyn_info.ulColumnSize;
        dyn_info.ulCharOctetLength = dyn_info.ulCharMaxLength;
        break;

    case CCI_U_TYPE_SET:
    case CCI_U_TYPE_MULTISET:
        ATLTRACE(atlTraceDBProvider, 2, _T(&quot;Here!!\n&quot;));
        dyn_info.ulColumnSize = nPrecision;
        dyn_info.ulCharMaxLength = dyn_info.ulColumnSize;
        dyn_info.ulCharOctetLength = dyn_info.ulCharMaxLength;
        break;
    default:
        dyn_info.ulColumnSize = sta_info.ulSize;
        dyn_info.ulCharMaxLength = sta_info.ulSize;
        dyn_info.ulCharOctetLength = sta_info.ulSize;
        break;
    }

    if(dyn_info.ulColumnSize&gt;8000) // 8000은 atldbcli.h의 CDynamicAccessor가 쓰는 값
        dyn_info.ulFlags |= DBCOLUMNFLAGS_ISLONG;

    return dyn_info;
}

static HRESULT GetTableInfo_FetchData(int hReq, TableInfo &amp;info)
{
    char *strval;
    int intval, ind, res;
    T_CCI_ERROR err_buf;

    res = cci_fetch(hReq, &amp;err_buf);
    if(res&lt;0) return E_FAIL;

    res = cci_get_data(hReq, 12, CCI_A_TYPE_STR, &amp;strval, &amp;ind);
    if(res&lt;0) return E_FAIL;
    info.strSourceClass = CA2W(strval);

    res = cci_get_data(hReq, 10, CCI_A_TYPE_INT, &amp;intval, &amp;ind);
    if(res&lt;0) return E_FAIL;
    info.iOrdinal = intval;

    res = cci_get_data(hReq, 8, CCI_A_TYPE_INT, &amp;intval, &amp;ind);
    if(res&lt;0) return E_FAIL;
    info.bIsUnique = (intval==1);
    ::VariantClear(&amp;info.varDefault);
    res = cci_get_data(hReq, 9, CCI_A_TYPE_STR, &amp;strval, &amp;ind);
    if(res&lt;0) return E_FAIL;
    if(ind!=-1)
    {
        CComVariant var = strval;
        var.Detach(&amp;info.varDefault);
    }

    return S_OK;
}

HRESULT GetTableInfo(int hConn, char *szTableName, CAtlArray&lt;TableInfo&gt; &amp;infos)
{
    // 기존의 데이터 모두 삭제
    infos.RemoveAll();

    T_CCI_ERROR err_buf;
    int hReq = cci_schema_info(hConn, CCI_SCH_ATTRIBUTE, szTableName, NULL,
                    CCI_CLASS_NAME_PATTERN_MATCH | CCI_ATTR_NAME_PATTERN_MATCH, &amp;err_buf);
    if(hReq&lt;0)
    {
        ATLTRACE2(&quot;GetTableInfo: cci_schema_info fail\n&quot;);
        return E_FAIL;
    }

    int res = cci_cursor(hReq, 1, CCI_CURSOR_FIRST, &amp;err_buf);
    if(res==CCI_ER_NO_MORE_DATA) goto done;
    if(res&lt;0) goto error;

    size_t cur = 0;
    while(1)
    {
        infos.SetCount(infos.GetCount()+1);
        HRESULT hr = GetTableInfo_FetchData(hReq, infos[cur]);
        if(FAILED(hr)) goto error;

        res = cci_cursor(hReq, 1, CCI_CURSOR_CURRENT, &amp;err_buf);
        if(res==CCI_ER_NO_MORE_DATA) goto done;
        if(res&lt;0) goto error;

        cur++;
    }

error:
    ATLTRACE2(&quot;GetTableInfo: fail to fetch data\n&quot;);
    cci_close_req_handle(hReq);
    infos.RemoveAll();
    return E_FAIL;
done:
    cci_close_req_handle(hReq);
    return S_OK;
}

}

/*
create table ztest (c1 char, c2 char(20), c3 varchar, c4 varchar(20), c5 nchar, c6 nchar(20),
c7 nchar varying, c8 nchar varying(20), c9 bit, c10 bit(20), c11 bit varying, c12 bit varying(20),
c13 numeric, c14 numeric(10), c15 numeric(15,8), c16 int, c17 smallint, c18 float, c19 float(5),
c20 float(14), c21 double, c22 monetary, c23 date, c24 time, c25 timestamp, c26 set(varchar(20), int),
c27 set(), c28 multiset(float, int), c29 list(float,int), c30 sequence())

***** cci_schema_info의 결과값 *****
name, domain, scale, precision, indexed, non_null, shared, unique, default, attr_order, class_name, source_class
c1  1   0   1           0   0   0   0   null    1   ztest   ztest   : character(1)
c2  1   0   20          0   0   0   0   null    2   ztest   ztest   : character(20)
c3  2   0   1073741823  0   0   0   0   null    3   ztest   ztest   : character varying(1073741823)
c4  2   0   20          0   0   0   0   null    4   ztest   ztest   : character varying(20)
c5  3   0   1           0   0   0   0   null    5   ztest   ztest   : national character(1)
c6  3   0   20          0   0   0   0   null    6   ztest   ztest   : national character(20)
c7  4   0   536870911   0   0   0   0   null    7   ztest   ztest   : national character varying(536870911)
c8  4   0   20          0   0   0   0   null    8   ztest   ztest   : national character varying(20)
c9  5   0   1           0   0   0   0   null    9   ztest   ztest   : bit(1)
c10 5   0   20          0   0   0   0   null    10  ztest   ztest   : bit(20)
c11 6   0   1073741823  0   0   0   0   null    11  ztest   ztest   : bit varying(1073741823)
c12 6   0   20          0   0   0   0   null    12  ztest   ztest   : bit varying(20)
c13 7   0   15          0   0   0   0   null    13  ztest   ztest   : numeric(15,0)
c14 7   0   10          0   0   0   0   null    14  ztest   ztest   : numeric(10,0)
c15 7   8   15          0   0   0   0   null    15  ztest   ztest   : numeric(15,8)
c16 8   0   0           0   0   0   0   null    16  ztest   ztest   : integer
c17 9   0   0           0   0   0   0   null    17  ztest   ztest   : smallint
c18 11  0   0           0   0   0   0   null    18  ztest   ztest   : float
c19 11  0   0           0   0   0   0   null    19  ztest   ztest   : float
c20 11  0   0           0   0   0   0   null    20  ztest   ztest   : float
c21 12  0   0           0   0   0   0   null    21  ztest   ztest   : double
c22 10  0   0           0   0   0   0   null    22  ztest   ztest   : monetary
c23 13  0   0           0   0   0   0   null    23  ztest   ztest   : date
c24 14  0   0           0   0   0   0   null    24  ztest   ztest   : time
c25 15  0   0           0   0   0   0   null    25  ztest   ztest   : timestamp
c26 -1  0   0           0   0   0   0   null    26  ztest   ztest   : set_of(character varying(20), integer)
c27 -1  0   0           0   0   0   0   null    27  ztest   ztest   : set_of()
c28 -1  0   0           0   0   0   0   null    28  ztest   ztest   : multiset_of(float, integer)
c29 -1  0   0           0   0   0   0   null    29  ztest   ztest   : sequence_of(float, integer)
c30 -1  0   0           0   0   0   0   null    30  ztest   ztest   : sequence_of()

***** cci_get_result_info의 결과값 *****
type, is_non_null, scale, precision, col_name, real_attr, class_name
1   0   0   1           c1  null    ztest
1   0   0   20          c2  null    ztest
2   0   0   1073741823  c3  null    ztest
2   0   0   20          c4  null    ztest
3   0   0   1           c5  null    ztest
3   0   0   20          c6  null    ztest
4   0   0   536870911   c7  null    ztest
4   0   0   20          c8  null    ztest
5   0   0   1           c9  null    ztest
5   0   0   20          c10 null    ztest
6   0   0   1073741823  c11 null    ztest
6   0   0   20          c12 null    ztest
7   0   0   15          c13 null    ztest
7   0   0   10          c14 null    ztest
7   0   8   15          c15 null    ztest
8   0   0   0           c16 null    ztest
9   0   0   0           c17 null    ztest
11  0   0   0           c18 null    ztest
11  0   0   0           c19 null    ztest
11  0   0   0           c20 null    ztest
12  0   0   0           c21 null    ztest
10  0   0   0           c22 null    ztest
13  0   0   0           c23 null    ztest
14  0   0   0           c24 null    ztest
15  0   0   0           c25 null    ztest
-1  0   0   0           c26 null    ztest
-1  0   0   0           c27 null    ztest
-1  0   0   0           c28 null    ztest
-1  0   0   0           c29 null    ztest
-1  0   0   0           c30 null    ztest
*/
</span></div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;    <span class="comment">//       LTM은 1/100초 자리로 생각을 함. 그래서 뺌</span></div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;    { <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a61168c4c6258cdf63773f9e77bf6d197">CCI_U_TYPE_TIME</a>,     DBTYPE_DBTIME,        8, L<span class="stringliteral">&quot;&#39;&quot;</span>,  L<span class="stringliteral">&quot;&#39;&quot;</span>, VARIANT_FALSE, DB_ALL_EXCEPT_LIKE, 1,             VARIANT_TRUE,  VARIANT_FALSE, VARIANT_TRUE  },</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;    { <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a932f0c01cf613a5e72bce5911f7ce901">CCI_U_TYPE_TIMESTAMP</a>, DBTYPE_DBTIMESTAMP, 19, L<span class="stringliteral">&quot;&#39;&quot;</span>,  L<span class="stringliteral">&quot;&#39;&quot;</span>, VARIANT_FALSE, DB_ALL_EXCEPT_LIKE, 1,             VARIANT_TRUE,  VARIANT_FALSE, VARIANT_TRUE  },</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;    <span class="comment">// TODO: mapping to DBTYPE_IUnknown?</span></div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;    { <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812ae726773d405bc8a26fb537773b00e02b">CCI_U_TYPE_OBJECT</a>,   <a class="code" href="atldb__cubrid_8h.html#a9480826662e54d0b6019f4f4d27ada10">DBTYPE_STR</a>,  1073741823, L<span class="stringliteral">&quot;&#39;&quot;</span>,  L<span class="stringliteral">&quot;&#39;&quot;</span>, VARIANT_TRUE,  DB_SEARCHABLE,      1,             VARIANT_FALSE, VARIANT_TRUE,  VARIANT_TRUE  },</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;    { <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812af868ffbe4b6638c9cbf058f5579b9a65">CCI_U_TYPE_MULTISET</a>,   <a class="code" href="atldb__cubrid_8h.html#a9480826662e54d0b6019f4f4d27ada10">DBTYPE_STR</a>,  1073741823, L<span class="stringliteral">&quot;&#39;&quot;</span>,  L<span class="stringliteral">&quot;&#39;&quot;</span>, VARIANT_TRUE,  DB_SEARCHABLE,      1,             VARIANT_FALSE, VARIANT_TRUE,  VARIANT_TRUE  },</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;    { <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a98042c0341542eafa2cb8e644d423973">CCI_U_TYPE_SET</a>,   <a class="code" href="atldb__cubrid_8h.html#a9480826662e54d0b6019f4f4d27ada10">DBTYPE_STR</a>,  1073741823, L<span class="stringliteral">&quot;&#39;&quot;</span>,  L<span class="stringliteral">&quot;&#39;&quot;</span>, VARIANT_TRUE,  DB_SEARCHABLE,      1,             VARIANT_FALSE, VARIANT_TRUE,  VARIANT_TRUE  },</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;};</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;</div><div class="line"><a name="l01032"></a><span class="lineno"><a class="line" href="namespaceType.html#a3f46b78f9ce3d04003861be8ab39eeec"> 1032</a></span>&#160;<span class="keyword">const</span> <a class="code" href="structType_1_1StaticTypeInfo.html">StaticTypeInfo</a> &amp;<a class="code" href="namespaceType.html#a3f46b78f9ce3d04003861be8ab39eeec">GetStaticTypeInfo</a>(<a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812">T_CCI_U_TYPE</a> nCCIUType)</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;{</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>=1;<a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;<span class="keyword">sizeof</span>(static_type_infos)/<span class="keyword">sizeof</span>(*static_type_infos);<a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;    {</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;        <span class="keywordflow">if</span>(static_type_infos[<a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>].nCCIUType==nCCIUType)</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;            <span class="keywordflow">return</span> static_type_infos[<a class="code" href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;    }</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;    <span class="keywordflow">return</span> static_type_infos[0];</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;}</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;</div><div class="line"><a name="l01042"></a><span class="lineno"><a class="line" href="namespaceType.html#a82d7f12f8c8f2fd5a68dbc0b5c9d1738"> 1042</a></span>&#160;<a class="code" href="structType_1_1DynamicTypeInfo.html">DynamicTypeInfo</a> <a class="code" href="namespaceType.html#a82d7f12f8c8f2fd5a68dbc0b5c9d1738">GetDynamicTypeInfo</a>(<a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812">T_CCI_U_TYPE</a> nCCIUType, <span class="keywordtype">int</span> nPrecision, <span class="keywordtype">int</span> nScale, <span class="keywordtype">bool</span> bNullable)</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;{</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;    <span class="comment">/* 스펙엔 &#39;this is the size of the data type&#39;라고 되어 있어서</span></div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;<span class="comment">     * ulColumnSize = StaticTypeInfo::ulSize (문자열로 봤을 때의 길이) 라고 생각했으나</span></div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;<span class="comment">     * LTM을 보니 저장공간의 크기를 말하는 것 같다.</span></div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;<span class="comment">     */</span></div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;    <a class="code" href="structType_1_1DynamicTypeInfo.html">DynamicTypeInfo</a> dyn_info;</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;    <span class="keyword">const</span> <a class="code" href="structType_1_1StaticTypeInfo.html">StaticTypeInfo</a> &amp;sta_info = <a class="code" href="namespaceType.html#a3f46b78f9ce3d04003861be8ab39eeec">GetStaticTypeInfo</a>(nCCIUType);</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;    dyn_info.<a class="code" href="structType_1_1DynamicTypeInfo.html#a02610b829d246ba46973e385f17840d2">ulFlags</a> = 0;</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;    dyn_info.<a class="code" href="structType_1_1DynamicTypeInfo.html#a02610b829d246ba46973e385f17840d2">ulFlags</a> |= DBCOLUMNFLAGS_WRITEUNKNOWN;</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;    dyn_info.<a class="code" href="structType_1_1DynamicTypeInfo.html#a02610b829d246ba46973e385f17840d2">ulFlags</a> |= <a class="code" href="atldb__cubrid_8h.html#a209f0db5070f6edb92e5e3b84741e6b5">DBCOLUMNFLAGS_ISFIXEDLENGTH</a>;</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;    <span class="keywordflow">if</span>(bNullable)</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;        dyn_info.<a class="code" href="structType_1_1DynamicTypeInfo.html#a02610b829d246ba46973e385f17840d2">ulFlags</a> |= DBCOLUMNFLAGS_ISNULLABLE | <a class="code" href="atldb__cubrid_8h.html#a9570fcf0fd5a37676b4f3eff57dde96f">DBCOLUMNFLAGS_MAYBENULL</a>;</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;    dyn_info.<a class="code" href="structType_1_1DynamicTypeInfo.html#a4831076e9a9767ec9787bd133a4a8805">ulColumnSize</a> = (ULONG)~0;</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;    dyn_info.<a class="code" href="structType_1_1DynamicTypeInfo.html#a1129b8a8a419c5b5f455448cb2a307cc">bPrecision</a> = ~0;</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;    dyn_info.<a class="code" href="structType_1_1DynamicTypeInfo.html#ab0cbf58063bc7c3a79391ca18df77bcd">bScale</a> = ~0;</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;    dyn_info.<a class="code" href="structType_1_1DynamicTypeInfo.html#a830a11de4cc891d4dba250dbf81a1295">ulCharMaxLength</a> = (ULONG)~0;</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;    dyn_info.<a class="code" href="structType_1_1DynamicTypeInfo.html#aa95cc75e6a816fac618782abdf0a6008">ulCharOctetLength</a> = (ULONG)~0;</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;    dyn_info.<a class="code" href="structType_1_1DynamicTypeInfo.html#aba16d07c0930f07ba672062a4548ac6b">nNumericPrecision</a> = (USHORT)~0;</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;    dyn_info.<a class="code" href="structType_1_1DynamicTypeInfo.html#ac710ee548f9d21460a11a8f8225d09e2">nNumericScale</a> = -1;</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;    dyn_info.<a class="code" href="structType_1_1DynamicTypeInfo.html#af98bbce5f7a283d5790ad066b5d89533">ulDateTimePrecision</a> = (ULONG)~0;</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;    <span class="keywordflow">switch</span>(nCCIUType)</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;    {</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a17e9464e2c9d5dc2c753e99a4d1a0bd3">CCI_U_TYPE_STRING</a>:</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a1d55418f4dba6a23dd5da424c296eff1">CCI_U_TYPE_VARNCHAR</a>:</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;        dyn_info.<a class="code" href="structType_1_1DynamicTypeInfo.html#a02610b829d246ba46973e385f17840d2">ulFlags</a> &amp;= ~<a class="code" href="atldb__cubrid_8h.html#a209f0db5070f6edb92e5e3b84741e6b5">DBCOLUMNFLAGS_ISFIXEDLENGTH</a>; <span class="comment">// 주의 break 없음</span></div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a0005b45612de0477eee20270f01e84be">CCI_U_TYPE_CHAR</a>:</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a2a9a7f31a26489fa99f9e188109ffbcd">CCI_U_TYPE_NCHAR</a>:</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;        <span class="keywordflow">if</span>(nCCIUType==<a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a1d55418f4dba6a23dd5da424c296eff1">CCI_U_TYPE_VARNCHAR</a> || nCCIUType==<a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a2a9a7f31a26489fa99f9e188109ffbcd">CCI_U_TYPE_NCHAR</a>)</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;            dyn_info.<a class="code" href="structType_1_1DynamicTypeInfo.html#a4831076e9a9767ec9787bd133a4a8805">ulColumnSize</a> = nPrecision / 2;</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;            dyn_info.<a class="code" href="structType_1_1DynamicTypeInfo.html#a4831076e9a9767ec9787bd133a4a8805">ulColumnSize</a> = nPrecision;</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;        dyn_info.<a class="code" href="structType_1_1DynamicTypeInfo.html#a830a11de4cc891d4dba250dbf81a1295">ulCharMaxLength</a> = dyn_info.<a class="code" href="structType_1_1DynamicTypeInfo.html#a4831076e9a9767ec9787bd133a4a8805">ulColumnSize</a>;</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;        dyn_info.<a class="code" href="structType_1_1DynamicTypeInfo.html#aa95cc75e6a816fac618782abdf0a6008">ulCharOctetLength</a> = dyn_info.<a class="code" href="structType_1_1DynamicTypeInfo.html#a830a11de4cc891d4dba250dbf81a1295">ulCharMaxLength</a>;</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;        <span class="keywordflow">if</span>(nCCIUType==<a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a1d55418f4dba6a23dd5da424c296eff1">CCI_U_TYPE_VARNCHAR</a> || nCCIUType==<a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a2a9a7f31a26489fa99f9e188109ffbcd">CCI_U_TYPE_NCHAR</a>)</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;        {</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;            dyn_info.<a class="code" href="structType_1_1DynamicTypeInfo.html#aa95cc75e6a816fac618782abdf0a6008">ulCharOctetLength</a> *= 2; <span class="comment">// TODO: 좀 다르긴 하지만 LTM을 위해 일단 2배를 한다.</span></div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;        }</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a25875f983ab7c580ccdc55230fb27ce8">CCI_U_TYPE_VARBIT</a>:</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;        dyn_info.<a class="code" href="structType_1_1DynamicTypeInfo.html#a02610b829d246ba46973e385f17840d2">ulFlags</a> &amp;= ~<a class="code" href="atldb__cubrid_8h.html#a209f0db5070f6edb92e5e3b84741e6b5">DBCOLUMNFLAGS_ISFIXEDLENGTH</a>; <span class="comment">// 주의 break 없음</span></div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a3331febb5322b5e1fc0b1aff9d4109c7">CCI_U_TYPE_BIT</a>:</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;        <span class="comment">// TODO: Maximum length니까 올림을 하는게 맞을 것 같은데, 하면 LTM은</span></div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;        <span class="comment">//       BYTE단위로 데이터를 만들어서 BIT로 보면 초과해서 에러가 난다.</span></div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;        dyn_info.<a class="code" href="structType_1_1DynamicTypeInfo.html#a4831076e9a9767ec9787bd133a4a8805">ulColumnSize</a> = (<a class="code" href="mprec_8c.html#a61569f2965b7a369eb10b6d75d410d11">int</a>)(nPrecision/8);</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;        dyn_info.<a class="code" href="structType_1_1DynamicTypeInfo.html#a830a11de4cc891d4dba250dbf81a1295">ulCharMaxLength</a> = dyn_info.<a class="code" href="structType_1_1DynamicTypeInfo.html#a4831076e9a9767ec9787bd133a4a8805">ulColumnSize</a>;</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;        dyn_info.<a class="code" href="structType_1_1DynamicTypeInfo.html#aa95cc75e6a816fac618782abdf0a6008">ulCharOctetLength</a> = dyn_info.<a class="code" href="structType_1_1DynamicTypeInfo.html#a830a11de4cc891d4dba250dbf81a1295">ulCharMaxLength</a>;</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812adae048f88ebb3c044c91fbfc0fce2ae8">CCI_U_TYPE_NUMERIC</a>:</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;        dyn_info.<a class="code" href="structType_1_1DynamicTypeInfo.html#a4831076e9a9767ec9787bd133a4a8805">ulColumnSize</a> = <span class="keyword">sizeof</span>(<a class="code" href="dbtype__def_8h.html#aa4cacd43872e590d486e2a06ed1ce007">DB_NUMERIC</a>);</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;        dyn_info.<a class="code" href="structType_1_1DynamicTypeInfo.html#a1129b8a8a419c5b5f455448cb2a307cc">bPrecision</a> = nPrecision;</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;        dyn_info.<a class="code" href="structType_1_1DynamicTypeInfo.html#ab0cbf58063bc7c3a79391ca18df77bcd">bScale</a> = nScale;</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;        dyn_info.<a class="code" href="structType_1_1DynamicTypeInfo.html#aba16d07c0930f07ba672062a4548ac6b">nNumericPrecision</a> = dyn_info.<a class="code" href="structType_1_1DynamicTypeInfo.html#a1129b8a8a419c5b5f455448cb2a307cc">bPrecision</a>;</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;        dyn_info.<a class="code" href="structType_1_1DynamicTypeInfo.html#ac710ee548f9d21460a11a8f8225d09e2">nNumericScale</a> = dyn_info.<a class="code" href="structType_1_1DynamicTypeInfo.html#ab0cbf58063bc7c3a79391ca18df77bcd">bScale</a>;</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a3bc19b2ce116ecd9d4a9414ba799bda9">CCI_U_TYPE_INT</a>:</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;        dyn_info.<a class="code" href="structType_1_1DynamicTypeInfo.html#a4831076e9a9767ec9787bd133a4a8805">ulColumnSize</a> = 4;</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;        dyn_info.<a class="code" href="structType_1_1DynamicTypeInfo.html#a1129b8a8a419c5b5f455448cb2a307cc">bPrecision</a> = (BYTE)sta_info.<a class="code" href="structType_1_1StaticTypeInfo.html#a8016a345e7bd87d77131664400d01706">ulSize</a>;</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;        dyn_info.<a class="code" href="structType_1_1DynamicTypeInfo.html#aba16d07c0930f07ba672062a4548ac6b">nNumericPrecision</a> = dyn_info.<a class="code" href="structType_1_1DynamicTypeInfo.html#a1129b8a8a419c5b5f455448cb2a307cc">bPrecision</a>;</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a7f999a2a5014fb266689822387d495e5">CCI_U_TYPE_SHORT</a>:</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;        dyn_info.<a class="code" href="structType_1_1DynamicTypeInfo.html#a4831076e9a9767ec9787bd133a4a8805">ulColumnSize</a> = 2;</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;        dyn_info.<a class="code" href="structType_1_1DynamicTypeInfo.html#a1129b8a8a419c5b5f455448cb2a307cc">bPrecision</a> = (BYTE)sta_info.<a class="code" href="structType_1_1StaticTypeInfo.html#a8016a345e7bd87d77131664400d01706">ulSize</a>;</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;        dyn_info.<a class="code" href="structType_1_1DynamicTypeInfo.html#aba16d07c0930f07ba672062a4548ac6b">nNumericPrecision</a> = dyn_info.<a class="code" href="structType_1_1DynamicTypeInfo.html#a1129b8a8a419c5b5f455448cb2a307cc">bPrecision</a>;</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a7d4c7fb802ed00d6280958c5880dc581">CCI_U_TYPE_MONETARY</a>:</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;        dyn_info.<a class="code" href="structType_1_1DynamicTypeInfo.html#a4831076e9a9767ec9787bd133a4a8805">ulColumnSize</a> = <span class="keyword">sizeof</span>(double);</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;        dyn_info.<a class="code" href="structType_1_1DynamicTypeInfo.html#a1129b8a8a419c5b5f455448cb2a307cc">bPrecision</a> = (BYTE)sta_info.<a class="code" href="structType_1_1StaticTypeInfo.html#a8016a345e7bd87d77131664400d01706">ulSize</a>;</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;        dyn_info.<a class="code" href="structType_1_1DynamicTypeInfo.html#aba16d07c0930f07ba672062a4548ac6b">nNumericPrecision</a> = dyn_info.<a class="code" href="structType_1_1DynamicTypeInfo.html#a1129b8a8a419c5b5f455448cb2a307cc">bPrecision</a>;</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812ae68408a06508953230175cfcb233dfcc">CCI_U_TYPE_FLOAT</a>:</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;        dyn_info.<a class="code" href="structType_1_1DynamicTypeInfo.html#a4831076e9a9767ec9787bd133a4a8805">ulColumnSize</a> = <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>);</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;        dyn_info.<a class="code" href="structType_1_1DynamicTypeInfo.html#a1129b8a8a419c5b5f455448cb2a307cc">bPrecision</a> = (BYTE)sta_info.<a class="code" href="structType_1_1StaticTypeInfo.html#a8016a345e7bd87d77131664400d01706">ulSize</a>;</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;        dyn_info.<a class="code" href="structType_1_1DynamicTypeInfo.html#aba16d07c0930f07ba672062a4548ac6b">nNumericPrecision</a> = dyn_info.<a class="code" href="structType_1_1DynamicTypeInfo.html#a1129b8a8a419c5b5f455448cb2a307cc">bPrecision</a>;</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a4b1bb46374a90cd0fcef2e9bb58c7236">CCI_U_TYPE_DOUBLE</a>:</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;        dyn_info.<a class="code" href="structType_1_1DynamicTypeInfo.html#a4831076e9a9767ec9787bd133a4a8805">ulColumnSize</a> = <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>);</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;        dyn_info.<a class="code" href="structType_1_1DynamicTypeInfo.html#a1129b8a8a419c5b5f455448cb2a307cc">bPrecision</a> = (BYTE)sta_info.<a class="code" href="structType_1_1StaticTypeInfo.html#a8016a345e7bd87d77131664400d01706">ulSize</a>;</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;        dyn_info.<a class="code" href="structType_1_1DynamicTypeInfo.html#aba16d07c0930f07ba672062a4548ac6b">nNumericPrecision</a> = dyn_info.<a class="code" href="structType_1_1DynamicTypeInfo.html#a1129b8a8a419c5b5f455448cb2a307cc">bPrecision</a>;</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a7b4e84af853a62908e629d1fe0bbd848">CCI_U_TYPE_DATE</a>:</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;        dyn_info.<a class="code" href="structType_1_1DynamicTypeInfo.html#a4831076e9a9767ec9787bd133a4a8805">ulColumnSize</a> = <span class="keyword">sizeof</span>(DBDATE);</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a61168c4c6258cdf63773f9e77bf6d197">CCI_U_TYPE_TIME</a>:</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;        dyn_info.<a class="code" href="structType_1_1DynamicTypeInfo.html#a4831076e9a9767ec9787bd133a4a8805">ulColumnSize</a> = <span class="keyword">sizeof</span>(DBTIME);</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a932f0c01cf613a5e72bce5911f7ce901">CCI_U_TYPE_TIMESTAMP</a>:</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;        dyn_info.<a class="code" href="structType_1_1DynamicTypeInfo.html#a4831076e9a9767ec9787bd133a4a8805">ulColumnSize</a> = <span class="keyword">sizeof</span>(DBTIMESTAMP);</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;        dyn_info.<a class="code" href="structType_1_1DynamicTypeInfo.html#a1129b8a8a419c5b5f455448cb2a307cc">bPrecision</a> = (BYTE)sta_info.<a class="code" href="structType_1_1StaticTypeInfo.html#a8016a345e7bd87d77131664400d01706">ulSize</a>;</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;        dyn_info.<a class="code" href="structType_1_1DynamicTypeInfo.html#ab0cbf58063bc7c3a79391ca18df77bcd">bScale</a> = 0;</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;        dyn_info.<a class="code" href="structType_1_1DynamicTypeInfo.html#af98bbce5f7a283d5790ad066b5d89533">ulDateTimePrecision</a> = dyn_info.<a class="code" href="structType_1_1DynamicTypeInfo.html#ab0cbf58063bc7c3a79391ca18df77bcd">bScale</a>;</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812ae726773d405bc8a26fb537773b00e02b">CCI_U_TYPE_OBJECT</a>:</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;        <span class="comment">//dyn_info.ulColumnSize = nPrecision;</span></div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;        <span class="comment">//OID 스트링 max length를 15로 보고 수정</span></div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;        dyn_info.<a class="code" href="structType_1_1DynamicTypeInfo.html#a4831076e9a9767ec9787bd133a4a8805">ulColumnSize</a> = 15;</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;        dyn_info.<a class="code" href="structType_1_1DynamicTypeInfo.html#a830a11de4cc891d4dba250dbf81a1295">ulCharMaxLength</a> = dyn_info.<a class="code" href="structType_1_1DynamicTypeInfo.html#a4831076e9a9767ec9787bd133a4a8805">ulColumnSize</a>;</div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;        dyn_info.<a class="code" href="structType_1_1DynamicTypeInfo.html#aa95cc75e6a816fac618782abdf0a6008">ulCharOctetLength</a> = dyn_info.<a class="code" href="structType_1_1DynamicTypeInfo.html#a830a11de4cc891d4dba250dbf81a1295">ulCharMaxLength</a>;</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;</div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a98042c0341542eafa2cb8e644d423973">CCI_U_TYPE_SET</a>:</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812af868ffbe4b6638c9cbf058f5579b9a65">CCI_U_TYPE_MULTISET</a>:</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;        ATLTRACE(atlTraceDBProvider, 2, _T(<span class="stringliteral">&quot;Here!!\n&quot;</span>));</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;        dyn_info.<a class="code" href="structType_1_1DynamicTypeInfo.html#a4831076e9a9767ec9787bd133a4a8805">ulColumnSize</a> = nPrecision;</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;        dyn_info.<a class="code" href="structType_1_1DynamicTypeInfo.html#a830a11de4cc891d4dba250dbf81a1295">ulCharMaxLength</a> = dyn_info.<a class="code" href="structType_1_1DynamicTypeInfo.html#a4831076e9a9767ec9787bd133a4a8805">ulColumnSize</a>;</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;        dyn_info.<a class="code" href="structType_1_1DynamicTypeInfo.html#aa95cc75e6a816fac618782abdf0a6008">ulCharOctetLength</a> = dyn_info.<a class="code" href="structType_1_1DynamicTypeInfo.html#a830a11de4cc891d4dba250dbf81a1295">ulCharMaxLength</a>;</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;    <span class="keywordflow">default</span>:</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;        dyn_info.<a class="code" href="structType_1_1DynamicTypeInfo.html#a4831076e9a9767ec9787bd133a4a8805">ulColumnSize</a> = sta_info.<a class="code" href="structType_1_1StaticTypeInfo.html#a8016a345e7bd87d77131664400d01706">ulSize</a>;</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;        dyn_info.<a class="code" href="structType_1_1DynamicTypeInfo.html#a830a11de4cc891d4dba250dbf81a1295">ulCharMaxLength</a> = sta_info.<a class="code" href="structType_1_1StaticTypeInfo.html#a8016a345e7bd87d77131664400d01706">ulSize</a>;</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;        dyn_info.<a class="code" href="structType_1_1DynamicTypeInfo.html#aa95cc75e6a816fac618782abdf0a6008">ulCharOctetLength</a> = sta_info.<a class="code" href="structType_1_1StaticTypeInfo.html#a8016a345e7bd87d77131664400d01706">ulSize</a>;</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;    }</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;    <span class="keywordflow">if</span>(dyn_info.<a class="code" href="structType_1_1DynamicTypeInfo.html#a4831076e9a9767ec9787bd133a4a8805">ulColumnSize</a>&gt;8000) <span class="comment">// 8000은 atldbcli.h의 CDynamicAccessor가 쓰는 값</span></div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;        dyn_info.<a class="code" href="structType_1_1DynamicTypeInfo.html#a02610b829d246ba46973e385f17840d2">ulFlags</a> |= DBCOLUMNFLAGS_ISLONG;</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;    <span class="keywordflow">return</span> dyn_info;</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;}</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;<span class="keyword">static</span> HRESULT GetTableInfo_FetchData(<span class="keywordtype">int</span> hReq, TableInfo &amp;<a class="code" href="namespacebroker__log__top.html#a507e86f36aac24149f6038d40412d19f">info</a>)</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;{</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;    <span class="keywordtype">char</span> *strval;</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;    <span class="keywordtype">int</span> intval, ind, res;</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;    <a class="code" href="structT__CCI__ERROR.html">T_CCI_ERROR</a> err_buf;</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;    res = <a class="code" href="cas__cci_8c.html#a9300cdeccb86944e6e299fadb4e7451e">cci_fetch</a>(hReq, &amp;err_buf);</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;    <span class="keywordflow">if</span>(res&lt;0) <span class="keywordflow">return</span> E_FAIL;</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;    res = <a class="code" href="cas__cci_8c.html#aa8519705be600e6cec5693d853f9981b">cci_get_data</a>(hReq, 12, <a class="code" href="cas__cci_8h.html#ad659fcbf8c66e3e426aa55d8577da6f5a34a5112b77b97538701e9f716888b5bd">CCI_A_TYPE_STR</a>, &amp;strval, &amp;ind);</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;    <span class="keywordflow">if</span>(res&lt;0) <span class="keywordflow">return</span> E_FAIL;</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;    <a class="code" href="namespacebroker__log__top.html#a507e86f36aac24149f6038d40412d19f">info</a>.strSourceClass = CA2W(strval);</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;    res = <a class="code" href="cas__cci_8c.html#aa8519705be600e6cec5693d853f9981b">cci_get_data</a>(hReq, 10, <a class="code" href="cas__cci_8h.html#ad659fcbf8c66e3e426aa55d8577da6f5a17f3b4be4db3770daa1c83c719a76cec">CCI_A_TYPE_INT</a>, &amp;intval, &amp;ind);</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;    <span class="keywordflow">if</span>(res&lt;0) <span class="keywordflow">return</span> E_FAIL;</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;    <a class="code" href="namespacebroker__log__top.html#a507e86f36aac24149f6038d40412d19f">info</a>.iOrdinal = intval;</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;    res = <a class="code" href="cas__cci_8c.html#aa8519705be600e6cec5693d853f9981b">cci_get_data</a>(hReq, 8, <a class="code" href="cas__cci_8h.html#ad659fcbf8c66e3e426aa55d8577da6f5a17f3b4be4db3770daa1c83c719a76cec">CCI_A_TYPE_INT</a>, &amp;intval, &amp;ind);</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;    <span class="keywordflow">if</span>(res&lt;0) <span class="keywordflow">return</span> E_FAIL;</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;    <a class="code" href="namespacebroker__log__top.html#a507e86f36aac24149f6038d40412d19f">info</a>.bIsUnique = (intval==1);</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;    ::VariantClear(&amp;<a class="code" href="namespacebroker__log__top.html#a507e86f36aac24149f6038d40412d19f">info</a>.varDefault);</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;    res = <a class="code" href="cas__cci_8c.html#aa8519705be600e6cec5693d853f9981b">cci_get_data</a>(hReq, 9, <a class="code" href="cas__cci_8h.html#ad659fcbf8c66e3e426aa55d8577da6f5a34a5112b77b97538701e9f716888b5bd">CCI_A_TYPE_STR</a>, &amp;strval, &amp;ind);</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;    <span class="keywordflow">if</span>(res&lt;0) <span class="keywordflow">return</span> E_FAIL;</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;    <span class="keywordflow">if</span>(ind!=-1)</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;    {</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;        CComVariant var = strval;</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;        var.Detach(&amp;<a class="code" href="namespacebroker__log__top.html#a507e86f36aac24149f6038d40412d19f">info</a>.varDefault);</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;    }</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="atldb__cubrid_8h.html#a1c8f62bc38a50376a62d4dad41a5e2aa">S_OK</a>;</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;}</div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;</div><div class="line"><a name="l01208"></a><span class="lineno"><a class="line" href="namespaceType.html#adfbf50343169f8b0a937a003d36558a9"> 1208</a></span>&#160;HRESULT <a class="code" href="namespaceType.html#adfbf50343169f8b0a937a003d36558a9">GetTableInfo</a>(<span class="keywordtype">int</span> hConn, <span class="keywordtype">char</span> *szTableName, CAtlArray&lt;TableInfo&gt; &amp;infos)</div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;{</div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;    <span class="comment">// 기존의 데이터 모두 삭제</span></div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;    infos.RemoveAll();</div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;</div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;    <a class="code" href="structT__CCI__ERROR.html">T_CCI_ERROR</a> err_buf;</div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;    <span class="keywordtype">int</span> hReq = <a class="code" href="cas__cci_8c.html#a2d968c1c9ed34b2fda93eecbe301cd22">cci_schema_info</a>(hConn, <a class="code" href="cas__cci_8h.html#a3878d967402500602b5b0535abdfa456ac05d1bad5a97d3f31405b02fe71817bf">CCI_SCH_ATTRIBUTE</a>, szTableName, <a class="code" href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a>,</div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;                    <a class="code" href="cas__cci_8h.html#af59fe9420dd3f884d80236962d675368">CCI_CLASS_NAME_PATTERN_MATCH</a> | <a class="code" href="cas__cci_8h.html#aa5708c021db0356d3d693b56883e0e81">CCI_ATTR_NAME_PATTERN_MATCH</a>, &amp;err_buf);</div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;    <span class="keywordflow">if</span>(hReq&lt;0)</div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;    {</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;        ATLTRACE2(<span class="stringliteral">&quot;GetTableInfo: cci_schema_info fail\n&quot;</span>);</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;        <span class="keywordflow">return</span> E_FAIL;</div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;    }</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;</div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;    <span class="keywordtype">int</span> res = <a class="code" href="cas__cci_8c.html#a799ad92039cf120b0985c2db5abb0721">cci_cursor</a>(hReq, 1, <a class="code" href="cas__cci_8h.html#a11f9a221823aedf7edc644f3d5984fefab3d70b1e695493b7f502fe2dd2bafbc7">CCI_CURSOR_FIRST</a>, &amp;err_buf);</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;    <span class="keywordflow">if</span>(res==<a class="code" href="cas__cci_8h.html#ad021d99d0eff7e3b483debe7ae0a67b0ad88f8f9eaf2d041544518a5a08f74642">CCI_ER_NO_MORE_DATA</a>) <span class="keywordflow">goto</span> done;</div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;    <span class="keywordflow">if</span>(res&lt;0) <span class="keywordflow">goto</span> <a class="code" href="run-tests_8php.html#aaa193b0c1c2b93841472b26e2e281751">error</a>;</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="namespacesample__cubrid.html#a831f98428be9c8f5aa247d7e775eff03">cur</a> = 0;</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;    <span class="keywordflow">while</span>(1)</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;    {</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;        infos.SetCount(infos.GetCount()+1);</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;        HRESULT hr = GetTableInfo_FetchData(hReq, infos[<a class="code" href="namespacesample__cubrid.html#a831f98428be9c8f5aa247d7e775eff03">cur</a>]);</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;        <span class="keywordflow">if</span>(FAILED(hr)) <span class="keywordflow">goto</span> <a class="code" href="run-tests_8php.html#aaa193b0c1c2b93841472b26e2e281751">error</a>;</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;        res = <a class="code" href="cas__cci_8c.html#a799ad92039cf120b0985c2db5abb0721">cci_cursor</a>(hReq, 1, <a class="code" href="cas__cci_8h.html#a11f9a221823aedf7edc644f3d5984fefa978b92aeac59fea9390ab01b26dc99d4">CCI_CURSOR_CURRENT</a>, &amp;err_buf);</div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;        <span class="keywordflow">if</span>(res==<a class="code" href="cas__cci_8h.html#ad021d99d0eff7e3b483debe7ae0a67b0ad88f8f9eaf2d041544518a5a08f74642">CCI_ER_NO_MORE_DATA</a>) <span class="keywordflow">goto</span> done;</div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;        <span class="keywordflow">if</span>(res&lt;0) <span class="keywordflow">goto</span> <a class="code" href="run-tests_8php.html#aaa193b0c1c2b93841472b26e2e281751">error</a>;</div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;</div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;        <a class="code" href="namespacesample__cubrid.html#a831f98428be9c8f5aa247d7e775eff03">cur</a>++;</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;    }</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;<a class="code" href="run-tests_8php.html#aaa193b0c1c2b93841472b26e2e281751">error</a>:</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;    ATLTRACE2(<span class="stringliteral">&quot;GetTableInfo: fail to fetch data\n&quot;</span>);</div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;    <a class="code" href="cas__cci_8c.html#ad9edd91b31fad7894b0a5f03b12874fc">cci_close_req_handle</a>(hReq);</div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;    infos.RemoveAll();</div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;    <span class="keywordflow">return</span> E_FAIL;</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;done:</div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;    <a class="code" href="cas__cci_8c.html#ad9edd91b31fad7894b0a5f03b12874fc">cci_close_req_handle</a>(hReq);</div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="atldb__cubrid_8h.html#a1c8f62bc38a50376a62d4dad41a5e2aa">S_OK</a>;</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;}</div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;</div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;}</div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;</div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;<span class="comment">create table ztest (c1 char, c2 char(20), c3 varchar, c4 varchar(20), c5 nchar, c6 nchar(20),</span></div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;<span class="comment">c7 nchar varying, c8 nchar varying(20), c9 bit, c10 bit(20), c11 bit varying, c12 bit varying(20),</span></div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;<span class="comment">c13 numeric, c14 numeric(10), c15 numeric(15,8), c16 int, c17 smallint, c18 float, c19 float(5),</span></div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;<span class="comment">c20 float(14), c21 double, c22 monetary, c23 date, c24 time, c25 timestamp, c26 set(varchar(20), int),</span></div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;<span class="comment">c27 set(), c28 multiset(float, int), c29 list(float,int), c30 sequence())</span></div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;<span class="comment">***** cci_schema_info의 결과값 *****</span></div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;<span class="comment">name, domain, scale, precision, indexed, non_null, shared, unique, default, attr_order, class_name, source_class</span></div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;<span class="comment">c1  1   0   1           0   0   0   0   null    1   ztest   ztest   : character(1)</span></div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;<span class="comment">c2  1   0   20          0   0   0   0   null    2   ztest   ztest   : character(20)</span></div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;<span class="comment">c3  2   0   1073741823  0   0   0   0   null    3   ztest   ztest   : character varying(1073741823)</span></div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;<span class="comment">c4  2   0   20          0   0   0   0   null    4   ztest   ztest   : character varying(20)</span></div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;<span class="comment">c5  3   0   1           0   0   0   0   null    5   ztest   ztest   : national character(1)</span></div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;<span class="comment">c6  3   0   20          0   0   0   0   null    6   ztest   ztest   : national character(20)</span></div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;<span class="comment">c7  4   0   536870911   0   0   0   0   null    7   ztest   ztest   : national character varying(536870911)</span></div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;<span class="comment">c8  4   0   20          0   0   0   0   null    8   ztest   ztest   : national character varying(20)</span></div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;<span class="comment">c9  5   0   1           0   0   0   0   null    9   ztest   ztest   : bit(1)</span></div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;<span class="comment">c10 5   0   20          0   0   0   0   null    10  ztest   ztest   : bit(20)</span></div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;<span class="comment">c11 6   0   1073741823  0   0   0   0   null    11  ztest   ztest   : bit varying(1073741823)</span></div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;<span class="comment">c12 6   0   20          0   0   0   0   null    12  ztest   ztest   : bit varying(20)</span></div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;<span class="comment">c13 7   0   15          0   0   0   0   null    13  ztest   ztest   : numeric(15,0)</span></div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;<span class="comment">c14 7   0   10          0   0   0   0   null    14  ztest   ztest   : numeric(10,0)</span></div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;<span class="comment">c15 7   8   15          0   0   0   0   null    15  ztest   ztest   : numeric(15,8)</span></div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;<span class="comment">c16 8   0   0           0   0   0   0   null    16  ztest   ztest   : integer</span></div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;<span class="comment">c17 9   0   0           0   0   0   0   null    17  ztest   ztest   : smallint</span></div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;<span class="comment">c18 11  0   0           0   0   0   0   null    18  ztest   ztest   : float</span></div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;<span class="comment">c19 11  0   0           0   0   0   0   null    19  ztest   ztest   : float</span></div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;<span class="comment">c20 11  0   0           0   0   0   0   null    20  ztest   ztest   : float</span></div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;<span class="comment">c21 12  0   0           0   0   0   0   null    21  ztest   ztest   : double</span></div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;<span class="comment">c22 10  0   0           0   0   0   0   null    22  ztest   ztest   : monetary</span></div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;<span class="comment">c23 13  0   0           0   0   0   0   null    23  ztest   ztest   : date</span></div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;<span class="comment">c24 14  0   0           0   0   0   0   null    24  ztest   ztest   : time</span></div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;<span class="comment">c25 15  0   0           0   0   0   0   null    25  ztest   ztest   : timestamp</span></div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;<span class="comment">c26 -1  0   0           0   0   0   0   null    26  ztest   ztest   : set_of(character varying(20), integer)</span></div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;<span class="comment">c27 -1  0   0           0   0   0   0   null    27  ztest   ztest   : set_of()</span></div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;<span class="comment">c28 -1  0   0           0   0   0   0   null    28  ztest   ztest   : multiset_of(float, integer)</span></div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;<span class="comment">c29 -1  0   0           0   0   0   0   null    29  ztest   ztest   : sequence_of(float, integer)</span></div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;<span class="comment">c30 -1  0   0           0   0   0   0   null    30  ztest   ztest   : sequence_of()</span></div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;<span class="comment">***** cci_get_result_info의 결과값 *****</span></div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;<span class="comment">type, is_non_null, scale, precision, col_name, real_attr, class_name</span></div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;<span class="comment">1   0   0   1           c1  null    ztest</span></div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;<span class="comment">1   0   0   20          c2  null    ztest</span></div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;<span class="comment">2   0   0   1073741823  c3  null    ztest</span></div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;<span class="comment">2   0   0   20          c4  null    ztest</span></div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;<span class="comment">3   0   0   1           c5  null    ztest</span></div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;<span class="comment">3   0   0   20          c6  null    ztest</span></div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;<span class="comment">4   0   0   536870911   c7  null    ztest</span></div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;<span class="comment">4   0   0   20          c8  null    ztest</span></div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;<span class="comment">5   0   0   1           c9  null    ztest</span></div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;<span class="comment">5   0   0   20          c10 null    ztest</span></div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;<span class="comment">6   0   0   1073741823  c11 null    ztest</span></div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;<span class="comment">6   0   0   20          c12 null    ztest</span></div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;<span class="comment">7   0   0   15          c13 null    ztest</span></div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;<span class="comment">7   0   0   10          c14 null    ztest</span></div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;<span class="comment">7   0   8   15          c15 null    ztest</span></div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;<span class="comment">8   0   0   0           c16 null    ztest</span></div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;<span class="comment">9   0   0   0           c17 null    ztest</span></div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;<span class="comment">11  0   0   0           c18 null    ztest</span></div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;<span class="comment">11  0   0   0           c19 null    ztest</span></div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;<span class="comment">11  0   0   0           c20 null    ztest</span></div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;<span class="comment">12  0   0   0           c21 null    ztest</span></div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;<span class="comment">10  0   0   0           c22 null    ztest</span></div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;<span class="comment">13  0   0   0           c23 null    ztest</span></div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;<span class="comment">14  0   0   0           c24 null    ztest</span></div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;<span class="comment">15  0   0   0           c25 null    ztest</span></div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;<span class="comment">-1  0   0   0           c26 null    ztest</span></div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;<span class="comment">-1  0   0   0           c27 null    ztest</span></div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;<span class="comment">-1  0   0   0           c28 null    ztest</span></div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;<span class="comment">-1  0   0   0           c29 null    ztest</span></div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;<span class="comment">-1  0   0   0           c30 null    ztest</span></div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;<span class="comment">*/</span></div><div class="ttc" id="namespacebroker__log__top_html_a507e86f36aac24149f6038d40412d19f"><div class="ttname"><a href="namespacebroker__log__top.html#a507e86f36aac24149f6038d40412d19f">broker_log_top.info</a></div><div class="ttdeci">info</div><div class="ttdef"><b>Definition:</b> <a href="broker__log__top_8py_source.html#l00360">broker_log_top.py:360</a></div></div>
<div class="ttc" id="namespacebroker__log__top_html_a983a0491908409a8bf5292f9efc2d5e1"><div class="ttname"><a href="namespacebroker__log__top.html#a983a0491908409a8bf5292f9efc2d5e1">broker_log_top.default</a></div><div class="ttdeci">default</div><div class="ttdef"><b>Definition:</b> <a href="broker__log__top_8py_source.html#l00346">broker_log_top.py:346</a></div></div>
<div class="ttc" id="structType_1_1DynamicTypeInfo_html_a4831076e9a9767ec9787bd133a4a8805"><div class="ttname"><a href="structType_1_1DynamicTypeInfo.html#a4831076e9a9767ec9787bd133a4a8805">Type::DynamicTypeInfo::ulColumnSize</a></div><div class="ttdeci">ULONG ulColumnSize</div><div class="ttdef"><b>Definition:</b> <a href="type_8h_source.html#l00122">type.h:122</a></div></div>
<div class="ttc" id="mprec_8c_html_abf2bc2545a4a5f5683d9ef3ed0d977e0"><div class="ttname"><a href="mprec_8c.html#abf2bc2545a4a5f5683d9ef3ed0d977e0">j</a></div><div class="ttdeci">int j</div><div class="ttdef"><b>Definition:</b> <a href="mprec_8c_source.html#l00540">mprec.c:540</a></div></div>
<div class="ttc" id="cas__cci_8c_html_a799ad92039cf120b0985c2db5abb0721"><div class="ttname"><a href="cas__cci_8c.html#a799ad92039cf120b0985c2db5abb0721">cci_cursor</a></div><div class="ttdeci">int cci_cursor(int mapped_stmt_id, int offset, T_CCI_CURSOR_POS origin, T_CCI_ERROR *err_buf)</div><div class="ttdef"><b>Definition:</b> <a href="cas__cci_8c_source.html#l02265">cas_cci.c:2265</a></div></div>
<div class="ttc" id="structType_1_1DynamicTypeInfo_html_ac710ee548f9d21460a11a8f8225d09e2"><div class="ttname"><a href="structType_1_1DynamicTypeInfo.html#ac710ee548f9d21460a11a8f8225d09e2">Type::DynamicTypeInfo::nNumericScale</a></div><div class="ttdeci">short nNumericScale</div><div class="ttdef"><b>Definition:</b> <a href="type_8h_source.html#l00136">type.h:136</a></div></div>
<div class="ttc" id="cas__cci_8h_html_a82f46f9c5f9169125d15abe0ebcc3812a4b1bb46374a90cd0fcef2e9bb58c7236"><div class="ttname"><a href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a4b1bb46374a90cd0fcef2e9bb58c7236">CCI_U_TYPE_DOUBLE</a></div><div class="ttdef"><b>Definition:</b> <a href="cas__cci_8h_source.html#l00333">cas_cci.h:333</a></div></div>
<div class="ttc" id="namespaceType_html_aa499185608fd079c05b367ff02696c0f"><div class="ttname"><a href="namespaceType.html#aa499185608fd079c05b367ff02696c0f">Type::GetOledbTypeFromName</a></div><div class="ttdeci">DBTYPE GetOledbTypeFromName(LPCWSTR pwszName)</div><div class="ttdef"><b>Definition:</b> <a href="type_8cpp_source.html#l00703">type.cpp:703</a></div></div>
<div class="ttc" id="cas__cci_8c_html_ad9edd91b31fad7894b0a5f03b12874fc"><div class="ttname"><a href="cas__cci_8c.html#ad9edd91b31fad7894b0a5f03b12874fc">cci_close_req_handle</a></div><div class="ttdeci">int cci_close_req_handle(int mapped_stmt_id)</div><div class="ttdef"><b>Definition:</b> <a href="cas__cci_8c_source.html#l02194">cas_cci.c:2194</a></div></div>
<div class="ttc" id="mprec_8c_html_a61569f2965b7a369eb10b6d75d410d11"><div class="ttname"><a href="mprec_8c.html#a61569f2965b7a369eb10b6d75d410d11">int</a></div><div class="ttdeci">int</div><div class="ttdef"><b>Definition:</b> <a href="mprec_8c_source.html#l00252">mprec.c:252</a></div></div>
<div class="ttc" id="namespaceType_html_ab492074b28f75cd9328b1fced30d3290"><div class="ttname"><a href="namespaceType.html#ab492074b28f75cd9328b1fced30d3290">Type::Compare</a></div><div class="ttdeci">HRESULT Compare(DBCOMPAREOP CompareOp, DBTYPE wType, const char *szRowValue, const char *szFindValue)</div><div class="ttdef"><b>Definition:</b> <a href="type_8cpp_source.html#l00956">type.cpp:956</a></div></div>
<div class="ttc" id="cas__cci_8c_html_aa8519705be600e6cec5693d853f9981b"><div class="ttname"><a href="cas__cci_8c.html#aa8519705be600e6cec5693d853f9981b">cci_get_data</a></div><div class="ttdeci">int cci_get_data(int mapped_stmt_id, int col_no, int a_type, void *value, int *indicator)</div><div class="ttdef"><b>Definition:</b> <a href="cas__cci_8c_source.html#l02340">cas_cci.c:2340</a></div></div>
<div class="ttc" id="cas__cci_8h_html_af59fe9420dd3f884d80236962d675368"><div class="ttname"><a href="cas__cci_8h.html#af59fe9420dd3f884d80236962d675368">CCI_CLASS_NAME_PATTERN_MATCH</a></div><div class="ttdeci">#define CCI_CLASS_NAME_PATTERN_MATCH</div><div class="ttdef"><b>Definition:</b> <a href="cas__cci_8h_source.html#l00161">cas_cci.h:161</a></div></div>
<div class="ttc" id="structT__CCI__DATE_html"><div class="ttname"><a href="structT__CCI__DATE.html">T_CCI_DATE</a></div><div class="ttdef"><b>Definition:</b> <a href="cas__cci_8h_source.html#l00283">cas_cci.h:283</a></div></div>
<div class="ttc" id="cas__cci_8h_html_ad659fcbf8c66e3e426aa55d8577da6f5a34a5112b77b97538701e9f716888b5bd"><div class="ttname"><a href="cas__cci_8h.html#ad659fcbf8c66e3e426aa55d8577da6f5a34a5112b77b97538701e9f716888b5bd">CCI_A_TYPE_STR</a></div><div class="ttdef"><b>Definition:</b> <a href="cas__cci_8h_source.html#l00367">cas_cci.h:367</a></div></div>
<div class="ttc" id="namespaceType_html_a78f493b8bf8743a2fdc9a0e1b0bdb06b"><div class="ttname"><a href="namespaceType.html#a78f493b8bf8743a2fdc9a0e1b0bdb06b">Type::GetColumnDefinitionString</a></div><div class="ttdeci">HRESULT GetColumnDefinitionString(DBCOLUMNDESC colDesc, CComBSTR &amp;strType)</div><div class="ttdef"><b>Definition:</b> <a href="type_8cpp_source.html#l00050">type.cpp:50</a></div></div>
<div class="ttc" id="cas__cci_8h_html_ad659fcbf8c66e3e426aa55d8577da6f5a0dce740f35c9d97e078de13c179e956f"><div class="ttname"><a href="cas__cci_8h.html#ad659fcbf8c66e3e426aa55d8577da6f5a0dce740f35c9d97e078de13c179e956f">CCI_A_TYPE_DATE</a></div><div class="ttdef"><b>Definition:</b> <a href="cas__cci_8h_source.html#l00372">cas_cci.h:372</a></div></div>
<div class="ttc" id="structType_1_1DynamicTypeInfo_html_aa95cc75e6a816fac618782abdf0a6008"><div class="ttname"><a href="structType_1_1DynamicTypeInfo.html#aa95cc75e6a816fac618782abdf0a6008">Type::DynamicTypeInfo::ulCharOctetLength</a></div><div class="ttdeci">ULONG ulCharOctetLength</div><div class="ttdef"><b>Definition:</b> <a href="type_8h_source.html#l00132">type.h:132</a></div></div>
<div class="ttc" id="cas__cci_8h_html_a3878d967402500602b5b0535abdfa456ac05d1bad5a97d3f31405b02fe71817bf"><div class="ttname"><a href="cas__cci_8h.html#a3878d967402500602b5b0535abdfa456ac05d1bad5a97d3f31405b02fe71817bf">CCI_SCH_ATTRIBUTE</a></div><div class="ttdef"><b>Definition:</b> <a href="cas__cci_8h_source.html#l00410">cas_cci.h:410</a></div></div>
<div class="ttc" id="cas__cci_8h_html_a82f46f9c5f9169125d15abe0ebcc3812a1d55418f4dba6a23dd5da424c296eff1"><div class="ttname"><a href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a1d55418f4dba6a23dd5da424c296eff1">CCI_U_TYPE_VARNCHAR</a></div><div class="ttdef"><b>Definition:</b> <a href="cas__cci_8h_source.html#l00325">cas_cci.h:325</a></div></div>
<div class="ttc" id="cas__cci_8h_html_a82f46f9c5f9169125d15abe0ebcc3812a25875f983ab7c580ccdc55230fb27ce8"><div class="ttname"><a href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a25875f983ab7c580ccdc55230fb27ce8">CCI_U_TYPE_VARBIT</a></div><div class="ttdef"><b>Definition:</b> <a href="cas__cci_8h_source.html#l00327">cas_cci.h:327</a></div></div>
<div class="ttc" id="structType_1_1DynamicTypeInfo_html_ab0cbf58063bc7c3a79391ca18df77bcd"><div class="ttname"><a href="structType_1_1DynamicTypeInfo.html#ab0cbf58063bc7c3a79391ca18df77bcd">Type::DynamicTypeInfo::bScale</a></div><div class="ttdeci">BYTE bScale</div><div class="ttdef"><b>Definition:</b> <a href="type_8h_source.html#l00128">type.h:128</a></div></div>
<div class="ttc" id="structType_1_1StaticTypeInfo_html_a8016a345e7bd87d77131664400d01706"><div class="ttname"><a href="structType_1_1StaticTypeInfo.html#a8016a345e7bd87d77131664400d01706">Type::StaticTypeInfo::ulSize</a></div><div class="ttdeci">ULONG ulSize</div><div class="ttdef"><b>Definition:</b> <a href="type_8h_source.html#l00075">type.h:75</a></div></div>
<div class="ttc" id="cas__cci_8h_html_ad659fcbf8c66e3e426aa55d8577da6f5a795cbed22300e9918d307c94a2c71a49"><div class="ttname"><a href="cas__cci_8h.html#ad659fcbf8c66e3e426aa55d8577da6f5a795cbed22300e9918d307c94a2c71a49">CCI_A_TYPE_DOUBLE</a></div><div class="ttdef"><b>Definition:</b> <a href="cas__cci_8h_source.html#l00370">cas_cci.h:370</a></div></div>
<div class="ttc" id="cas__cci_8h_html_ad021d99d0eff7e3b483debe7ae0a67b0ad88f8f9eaf2d041544518a5a08f74642"><div class="ttname"><a href="cas__cci_8h.html#ad021d99d0eff7e3b483debe7ae0a67b0ad88f8f9eaf2d041544518a5a08f74642">CCI_ER_NO_MORE_DATA</a></div><div class="ttdef"><b>Definition:</b> <a href="cas__cci_8h_source.html#l00436">cas_cci.h:436</a></div></div>
<div class="ttc" id="cas__cci_8h_html_ad659fcbf8c66e3e426aa55d8577da6f5a4a152bbfad8bdf2a7eb592748099c5a8"><div class="ttname"><a href="cas__cci_8h.html#ad659fcbf8c66e3e426aa55d8577da6f5a4a152bbfad8bdf2a7eb592748099c5a8">CCI_A_TYPE_BIT</a></div><div class="ttdef"><b>Definition:</b> <a href="cas__cci_8h_source.html#l00371">cas_cci.h:371</a></div></div>
<div class="ttc" id="namespaceType_html_abce8b84baded7c05d4dabb3072d6f327"><div class="ttname"><a href="namespaceType.html#abce8b84baded7c05d4dabb3072d6f327">Type::GetCASTypeUFromProviderType</a></div><div class="ttdeci">T_CCI_U_TYPE GetCASTypeUFromProviderType(LPOLESTR provType)</div><div class="ttdef"><b>Definition:</b> <a href="type_8cpp_source.html#l00042">type.cpp:42</a></div></div>
<div class="ttc" id="structType_1_1DynamicTypeInfo_html_a1129b8a8a419c5b5f455448cb2a307cc"><div class="ttname"><a href="structType_1_1DynamicTypeInfo.html#a1129b8a8a419c5b5f455448cb2a307cc">Type::DynamicTypeInfo::bPrecision</a></div><div class="ttdeci">BYTE bPrecision</div><div class="ttdef"><b>Definition:</b> <a href="type_8h_source.html#l00126">type.h:126</a></div></div>
<div class="ttc" id="cas__cci_8h_html_a82f46f9c5f9169125d15abe0ebcc3812a7b4e84af853a62908e629d1fe0bbd848"><div class="ttname"><a href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a7b4e84af853a62908e629d1fe0bbd848">CCI_U_TYPE_DATE</a></div><div class="ttdef"><b>Definition:</b> <a href="cas__cci_8h_source.html#l00334">cas_cci.h:334</a></div></div>
<div class="ttc" id="namespaceProvInfo_html_a85427466c835b24ce2bf55ae6a5ccc23"><div class="ttname"><a href="namespaceProvInfo.html#a85427466c835b24ce2bf55ae6a5ccc23">ProvInfo::size_provider_types</a></div><div class="ttdeci">int size_provider_types</div><div class="ttdef"><b>Definition:</b> <a href="ProviderInfo_8cpp_source.html#l00107">ProviderInfo.cpp:107</a></div></div>
<div class="ttc" id="cas__cci_8h_html_a82f46f9c5f9169125d15abe0ebcc3812a17e9464e2c9d5dc2c753e99a4d1a0bd3"><div class="ttname"><a href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a17e9464e2c9d5dc2c753e99a4d1a0bd3">CCI_U_TYPE_STRING</a></div><div class="ttdef"><b>Definition:</b> <a href="cas__cci_8h_source.html#l00323">cas_cci.h:323</a></div></div>
<div class="ttc" id="cas__cci_8h_html_a82f46f9c5f9169125d15abe0ebcc3812a3bc19b2ce116ecd9d4a9414ba799bda9"><div class="ttname"><a href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a3bc19b2ce116ecd9d4a9414ba799bda9">CCI_U_TYPE_INT</a></div><div class="ttdef"><b>Definition:</b> <a href="cas__cci_8h_source.html#l00329">cas_cci.h:329</a></div></div>
<div class="ttc" id="structType_1_1StaticTypeInfo_html"><div class="ttname"><a href="structType_1_1StaticTypeInfo.html">Type::StaticTypeInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="type_8h_source.html#l00068">type.h:68</a></div></div>
<div class="ttc" id="namespaceType_html_ac61886b1804c34091d0c90074fabe60a"><div class="ttname"><a href="namespaceType.html#ac61886b1804c34091d0c90074fabe60a">Type::GetCASTypeU</a></div><div class="ttdeci">T_CCI_U_TYPE GetCASTypeU(DBTYPE wType)</div><div class="ttdef"><b>Definition:</b> <a href="type_8cpp_source.html#l00473">type.cpp:473</a></div></div>
<div class="ttc" id="namespacebroker__log__top_html_a53d103cb6308629a5314cd78fa0a68b7"><div class="ttname"><a href="namespacebroker__log__top.html#a53d103cb6308629a5314cd78fa0a68b7">broker_log_top.options</a></div><div class="ttdeci">options</div><div class="ttdef"><b>Definition:</b> <a href="broker__log__top_8py_source.html#l00354">broker_log_top.py:354</a></div></div>
<div class="ttc" id="namespaceType_html"><div class="ttname"><a href="namespaceType.html">Type</a></div><div class="ttdef"><b>Definition:</b> <a href="type_8cpp_source.html#l00036">type.cpp:36</a></div></div>
<div class="ttc" id="cas__cci_8h_html_a82f46f9c5f9169125d15abe0ebcc3812adae048f88ebb3c044c91fbfc0fce2ae8"><div class="ttname"><a href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812adae048f88ebb3c044c91fbfc0fce2ae8">CCI_U_TYPE_NUMERIC</a></div><div class="ttdef"><b>Definition:</b> <a href="cas__cci_8h_source.html#l00328">cas_cci.h:328</a></div></div>
<div class="ttc" id="cas__cci_8h_html_a11f9a221823aedf7edc644f3d5984fefa978b92aeac59fea9390ab01b26dc99d4"><div class="ttname"><a href="cas__cci_8h.html#a11f9a221823aedf7edc644f3d5984fefa978b92aeac59fea9390ab01b26dc99d4">CCI_CURSOR_CURRENT</a></div><div class="ttdef"><b>Definition:</b> <a href="cas__cci_8h_source.html#l00655">cas_cci.h:655</a></div></div>
<div class="ttc" id="cas__cci_8h_html_a82f46f9c5f9169125d15abe0ebcc3812a3331febb5322b5e1fc0b1aff9d4109c7"><div class="ttname"><a href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a3331febb5322b5e1fc0b1aff9d4109c7">CCI_U_TYPE_BIT</a></div><div class="ttdef"><b>Definition:</b> <a href="cas__cci_8h_source.html#l00326">cas_cci.h:326</a></div></div>
<div class="ttc" id="cas__cci_8h_html_a82f46f9c5f9169125d15abe0ebcc3812ae726773d405bc8a26fb537773b00e02b"><div class="ttname"><a href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812ae726773d405bc8a26fb537773b00e02b">CCI_U_TYPE_OBJECT</a></div><div class="ttdef"><b>Definition:</b> <a href="cas__cci_8h_source.html#l00340">cas_cci.h:340</a></div></div>
<div class="ttc" id="cas__cci_8c_html_a9300cdeccb86944e6e299fadb4e7451e"><div class="ttname"><a href="cas__cci_8c.html#a9300cdeccb86944e6e299fadb4e7451e">cci_fetch</a></div><div class="ttdeci">int cci_fetch(int mapped_stmt_id, T_CCI_ERROR *err_buf)</div><div class="ttdef"><b>Definition:</b> <a href="cas__cci_8c_source.html#l02320">cas_cci.c:2320</a></div></div>
<div class="ttc" id="cas__cci_8h_html_a82f46f9c5f9169125d15abe0ebcc3812a7d4c7fb802ed00d6280958c5880dc581"><div class="ttname"><a href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a7d4c7fb802ed00d6280958c5880dc581">CCI_U_TYPE_MONETARY</a></div><div class="ttdef"><b>Definition:</b> <a href="cas__cci_8h_source.html#l00331">cas_cci.h:331</a></div></div>
<div class="ttc" id="namespaceType_html_a5cbb0f735e4aa01dcae86f96d68bf699"><div class="ttname"><a href="namespaceType.html#a5cbb0f735e4aa01dcae86f96d68bf699">Type::GetFindCompareOps</a></div><div class="ttdeci">long GetFindCompareOps(DBTYPE wType)</div><div class="ttdef"><b>Definition:</b> <a href="type_8cpp_source.html#l00983">type.cpp:983</a></div></div>
<div class="ttc" id="structType_1_1DynamicTypeInfo_html_a02610b829d246ba46973e385f17840d2"><div class="ttname"><a href="structType_1_1DynamicTypeInfo.html#a02610b829d246ba46973e385f17840d2">Type::DynamicTypeInfo::ulFlags</a></div><div class="ttdeci">ULONG ulFlags</div><div class="ttdef"><b>Definition:</b> <a href="type_8h_source.html#l00124">type.h:124</a></div></div>
<div class="ttc" id="namespaceType_html_ac0f9f877460008beaa59662f660f67f3"><div class="ttname"><a href="namespaceType.html#ac0f9f877460008beaa59662f660f67f3">Type::OLEDBValueToCCIValue</a></div><div class="ttdeci">HRESULT OLEDBValueToCCIValue(DBTYPE wType, T_CCI_A_TYPE *aType, T_CCI_U_TYPE *uType, void *pValue, DBLENGTH dwLength, void **dstValue, DBSTATUS *status, const CComPtr&lt; IDataConvert &gt; &amp;spConvert)</div><div class="ttdef"><b>Definition:</b> <a href="type_8cpp_source.html#l00511">type.cpp:511</a></div></div>
<div class="ttc" id="cas__cci_8h_html_a82f46f9c5f9169125d15abe0ebcc3812af868ffbe4b6638c9cbf058f5579b9a65"><div class="ttname"><a href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812af868ffbe4b6638c9cbf058f5579b9a65">CCI_U_TYPE_MULTISET</a></div><div class="ttdef"><b>Definition:</b> <a href="cas__cci_8h_source.html#l00338">cas_cci.h:338</a></div></div>
<div class="ttc" id="freelistheap_8h_html_a070d2ce7b6bb7e5c05602aa8c308d0c4"><div class="ttname"><a href="freelistheap_8h.html#a070d2ce7b6bb7e5c05602aa8c308d0c4">NULL</a></div><div class="ttdeci">#define NULL</div><div class="ttdef"><b>Definition:</b> <a href="freelistheap_8h_source.html#l00019">freelistheap.h:19</a></div></div>
<div class="ttc" id="cas__cci_8h_html_a82f46f9c5f9169125d15abe0ebcc3812aad8f57a1b6c63d33616ca89690db2193"><div class="ttname"><a href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812aad8f57a1b6c63d33616ca89690db2193">CCI_U_TYPE_BIGINT</a></div><div class="ttdef"><b>Definition:</b> <a href="cas__cci_8h_source.html#l00342">cas_cci.h:342</a></div></div>
<div class="ttc" id="atldb__cubrid_8h_html_a12639216b34cff39e3f17c4798373779"><div class="ttname"><a href="atldb__cubrid_8h.html#a12639216b34cff39e3f17c4798373779">S_FALSE</a></div><div class="ttdeci">return S_FALSE</div><div class="ttdef"><b>Definition:</b> <a href="atldb__cubrid_8h_source.html#l02232">atldb_cubrid.h:2232</a></div></div>
<div class="ttc" id="cas__cci_8h_html_a82f46f9c5f9169125d15abe0ebcc3812a7f999a2a5014fb266689822387d495e5"><div class="ttname"><a href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a7f999a2a5014fb266689822387d495e5">CCI_U_TYPE_SHORT</a></div><div class="ttdef"><b>Definition:</b> <a href="cas__cci_8h_source.html#l00330">cas_cci.h:330</a></div></div>
<div class="ttc" id="structdb__numeric_html"><div class="ttname"><a href="structdb__numeric.html">db_numeric</a></div><div class="ttdef"><b>Definition:</b> <a href="dbtype__def_8h_source.html#l00814">dbtype_def.h:814</a></div></div>
<div class="ttc" id="cas__cci_8h_html_a82f46f9c5f9169125d15abe0ebcc3812a98042c0341542eafa2cb8e644d423973"><div class="ttname"><a href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a98042c0341542eafa2cb8e644d423973">CCI_U_TYPE_SET</a></div><div class="ttdef"><b>Definition:</b> <a href="cas__cci_8h_source.html#l00337">cas_cci.h:337</a></div></div>
<div class="ttc" id="cas__cci_8h_html_aa5708c021db0356d3d693b56883e0e81"><div class="ttname"><a href="cas__cci_8h.html#aa5708c021db0356d3d693b56883e0e81">CCI_ATTR_NAME_PATTERN_MATCH</a></div><div class="ttdeci">#define CCI_ATTR_NAME_PATTERN_MATCH</div><div class="ttdef"><b>Definition:</b> <a href="cas__cci_8h_source.html#l00162">cas_cci.h:162</a></div></div>
<div class="ttc" id="cas__cci_8h_html_a82f46f9c5f9169125d15abe0ebcc3812"><div class="ttname"><a href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812">T_CCI_U_TYPE</a></div><div class="ttdeci">T_CCI_U_TYPE</div><div class="ttdef"><b>Definition:</b> <a href="cas__cci_8h_source.html#l00316">cas_cci.h:316</a></div></div>
<div class="ttc" id="namespaceProvInfo_html_a9de8dfa82da6330548d128dce1a11c7a"><div class="ttname"><a href="namespaceProvInfo.html#a9de8dfa82da6330548d128dce1a11c7a">ProvInfo::provider_types</a></div><div class="ttdeci">_ptypes provider_types[]</div><div class="ttdef"><b>Definition:</b> <a href="ProviderInfo_8cpp_source.html#l00090">ProviderInfo.cpp:90</a></div></div>
<div class="ttc" id="structType_1_1DynamicTypeInfo_html_a830a11de4cc891d4dba250dbf81a1295"><div class="ttname"><a href="structType_1_1DynamicTypeInfo.html#a830a11de4cc891d4dba250dbf81a1295">Type::DynamicTypeInfo::ulCharMaxLength</a></div><div class="ttdeci">ULONG ulCharMaxLength</div><div class="ttdef"><b>Definition:</b> <a href="type_8h_source.html#l00130">type.h:130</a></div></div>
<div class="ttc" id="ProviderInfo_8h_html"><div class="ttname"><a href="ProviderInfo_8h.html">ProviderInfo.h</a></div></div>
<div class="ttc" id="cas__cci_8h_html_a82f46f9c5f9169125d15abe0ebcc3812a2a9a7f31a26489fa99f9e188109ffbcd"><div class="ttname"><a href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a2a9a7f31a26489fa99f9e188109ffbcd">CCI_U_TYPE_NCHAR</a></div><div class="ttdef"><b>Definition:</b> <a href="cas__cci_8h_source.html#l00324">cas_cci.h:324</a></div></div>
<div class="ttc" id="namespacesample__cubrid_html_a27c7e3b540ffe07a400097340a612765"><div class="ttname"><a href="namespacesample__cubrid.html#a27c7e3b540ffe07a400097340a612765">sample_cubrid.row</a></div><div class="ttdeci">row</div><div class="ttdef"><b>Definition:</b> <a href="sample__cubrid_8py_source.html#l00051">sample_cubrid.py:51</a></div></div>
<div class="ttc" id="run-tests_8php_html_aaa193b0c1c2b93841472b26e2e281751"><div class="ttname"><a href="run-tests_8php.html#aaa193b0c1c2b93841472b26e2e281751">error</a></div><div class="ttdeci">error($message)</div><div class="ttdef"><b>Definition:</b> <a href="run-tests_8php_source.html#l02122">run-tests.php:2122</a></div></div>
<div class="ttc" id="cas__cci_8h_html_ad659fcbf8c66e3e426aa55d8577da6f5a17f3b4be4db3770daa1c83c719a76cec"><div class="ttname"><a href="cas__cci_8h.html#ad659fcbf8c66e3e426aa55d8577da6f5a17f3b4be4db3770daa1c83c719a76cec">CCI_A_TYPE_INT</a></div><div class="ttdef"><b>Definition:</b> <a href="cas__cci_8h_source.html#l00368">cas_cci.h:368</a></div></div>
<div class="ttc" id="cas__cci_8h_html_ad659fcbf8c66e3e426aa55d8577da6f5ac8162d53a1d0fe82da78875cbd3fc7f0"><div class="ttname"><a href="cas__cci_8h.html#ad659fcbf8c66e3e426aa55d8577da6f5ac8162d53a1d0fe82da78875cbd3fc7f0">CCI_A_TYPE_BIGINT</a></div><div class="ttdef"><b>Definition:</b> <a href="cas__cci_8h_source.html#l00374">cas_cci.h:374</a></div></div>
<div class="ttc" id="atldb__cubrid_8h_html_a9570fcf0fd5a37676b4f3eff57dde96f"><div class="ttname"><a href="atldb__cubrid_8h.html#a9570fcf0fd5a37676b4f3eff57dde96f">DBCOLUMNFLAGS_MAYBENULL</a></div><div class="ttdeci">LPOLESTR DBORDINAL flags DBCOLUMNFLAGS_MAYBENULL</div><div class="ttdef"><b>Definition:</b> <a href="atldb__cubrid_8h_source.html#l19305">atldb_cubrid.h:19305</a></div></div>
<div class="ttc" id="atldb__cubrid_8h_html_a1c8f62bc38a50376a62d4dad41a5e2aa"><div class="ttname"><a href="atldb__cubrid_8h.html#a1c8f62bc38a50376a62d4dad41a5e2aa">S_OK</a></div><div class="ttdeci">return S_OK</div><div class="ttdef"><b>Definition:</b> <a href="atldb__cubrid_8h_source.html#l02236">atldb_cubrid.h:2236</a></div></div>
<div class="ttc" id="cas__cci_8h_html_ad659fcbf8c66e3e426aa55d8577da6f5a3294fd67e12fc92481b8fc2ce22f2e3b"><div class="ttname"><a href="cas__cci_8h.html#ad659fcbf8c66e3e426aa55d8577da6f5a3294fd67e12fc92481b8fc2ce22f2e3b">CCI_A_TYPE_FLOAT</a></div><div class="ttdef"><b>Definition:</b> <a href="cas__cci_8h_source.html#l00369">cas_cci.h:369</a></div></div>
<div class="ttc" id="intl__support_8c_html_ab543901c3564a54b2450303d63374f55"><div class="ttname"><a href="intl__support_8c.html#ab543901c3564a54b2450303d63374f55">strlen</a></div><div class="ttdeci">#define strlen(s1)</div><div class="ttdef"><b>Definition:</b> <a href="intl__support_8c_source.html#l00045">intl_support.c:45</a></div></div>
<div class="ttc" id="cas__cci_8h_html_a82f46f9c5f9169125d15abe0ebcc3812a0005b45612de0477eee20270f01e84be"><div class="ttname"><a href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a0005b45612de0477eee20270f01e84be">CCI_U_TYPE_CHAR</a></div><div class="ttdef"><b>Definition:</b> <a href="cas__cci_8h_source.html#l00322">cas_cci.h:322</a></div></div>
<div class="ttc" id="namespaceType_html_a82d7f12f8c8f2fd5a68dbc0b5c9d1738"><div class="ttname"><a href="namespaceType.html#a82d7f12f8c8f2fd5a68dbc0b5c9d1738">Type::GetDynamicTypeInfo</a></div><div class="ttdeci">DynamicTypeInfo GetDynamicTypeInfo(T_CCI_U_TYPE nCCIUType, int nPrecision, int nScale, bool bNullable)</div><div class="ttdef"><b>Definition:</b> <a href="type_8cpp_source.html#l01042">type.cpp:1042</a></div></div>
<div class="ttc" id="atldb__cubrid_8h_html_a851aabdebc10ed6b7d279d768ed199ef"><div class="ttname"><a href="atldb__cubrid_8h.html#a851aabdebc10ed6b7d279d768ed199ef">pwszName</a></div><div class="ttdeci">&lt;&lt; DBKIND_GUID \|1&lt;&lt; DBKIND_GUID_NAME \|1&lt;&lt; DBKIND_GUID_PROPID \|1&lt;&lt; DBKIND_PGUID_NAME \|1&lt;&lt; DBKIND_PGUID_PROPID)) #define DBID_USE_GUID(e)(1&lt;&lt; DBKIND_GUID \|1&lt;&lt; DBKIND_GUID_NAME \|1&lt;&lt; DBKIND_GUID_PROPID)) #define DBID_USE_PGUID(e)(1&lt;&lt; DBKIND_PGUID_NAME \|1&lt;&lt; DBKIND_PGUID_PROPID)) #define DBID_USE_NAME(e)(1&lt;&lt; DBKIND_NAME \|1&lt;&lt; DBKIND_GUID_NAME \|1&lt;&lt; DBKIND_PGUID_NAME)) #define DBID_USE_PROPID(e)(1&lt;&lt; DBKIND_PROPID \|1&lt;&lt; DBKIND_GUID_PROPID \|1&lt;&lt; DBKIND_PGUID_PROPID)) #define DBID_IS_BOOKMARK(dbid)(dbid.eKind) &amp;&amp;dbid. uGuid.guid==DBCOL_SPECIALCOL||DBID_USE_PGUID(dbid.eKind) &amp;&amp;*dbid. uGuid. pguid==DBCOL_SPECIALCOL) #define DivDword(dw) #define ModDword(dw) #define DwordSizeofBits(nBits) #define CLEARBITARRAY(rgdwFlags) template&lt; class T &gt; BOOL InRange(const T &amp;val, const T &amp;valMin, const T &amp;valMax) { return(valMin&lt;=val &amp;&amp;val&lt;=valMax);} class CBitFieldOps { public:void SETBIT(DWORD rgdwFlags [], const DWORD dwBit) { rgdwFlags [DivDword(dwBit)]|=1&lt;&lt; ModDword(dwBit);} void CLEARBIT(DWORD rgdwFlags[], const DWORD dwBit) { rgdwFlags [DivDword(dwBit)] &amp;=~(1&lt;&lt; ModDword(dwBit));} DWORD TESTBIT(const DWORD rgdwFlags [], const DWORD dwBit) { return(rgdwFlags [DivDword(dwBit)] &amp;(1&lt;&lt; ModDword(dwBit))) !=0;} };class CDBIDOps { public:HRESULT CompareDBIDs(const DBID *pdbid1, const DBID *pdbid2) { static const BYTE s_rgbKind[]={ DBKIND_PGUID_NAME, DBKIND_PGUID_PROPID, DBKIND_NAME, DBKIND_GUID_NAME, DBKIND_GUID_PROPID, DBKIND_PROPID, DBKIND_GUID };if(!pdbid1||!pdbid2) return S_FALSE;DBKIND tmp1=0;DBKIND tmp2=(DBKIND)(sizeof(s_rgbKind)/sizeof(*s_rgbKind));if(!InRange(pdbid2-&gt; eKind, tmp1, tmp2)) { ATLTRACE(atlTraceDBProvider, 0, _T(&quot;Column ID out of Range\&quot;));return E_FAIL;} if(pdbid1-&gt; eKind !=pdbid2-&gt; eKind &amp;&amp;pdbid1-&gt; eKind !=s_rgbKind [pdbid2-&gt; eKind]) return S_FALSE;if(DBID_USE_GUID_OR_PGUID(pdbid1-&gt; eKind)) { if(!DBID_USE_GUID_OR_PGUID(pdbid2-&gt; eKind)) return S_FALSE;if(!InlineIsEqualGUID(DBID_USE_PGUID(pdbid1-&gt; eKind) ? *(pdbid1-&gt; uGuid. pguid) :pdbid1-&gt; uGuid.guid, DBID_USE_PGUID(pdbid2-&gt; eKind) ? *(pdbid2-&gt; uGuid. pguid) :pdbid2-&gt; uGuid. guid)) return S_FALSE;} if(DBID_USE_NAME(pdbid1-&gt; eKind)) { if(!DBID_USE_NAME(pdbid2-&gt; eKind)) return S_FALSE;if((pdbid1-&gt; uName. pwszName==NULL) !=(pdbid2-&gt; uName. pwszName==NULL)) return S_FALSE;if(pdbid1-&gt; uName. pwszName &amp;&amp;pdbid2-&gt; uName. pwszName) { if(wcscmp(pdbid1-&gt; uName. pwszName, pdbid2-&gt; uName. pwszName) !=0) return S_FALSE;} } if(DBID_USE_PROPID(pdbid1-&gt; eKind)) { if(!DBID_USE_PROPID(pdbid2-&gt; eKind)) return S_FALSE;if(pdbid1-&gt; uName. ulPropid !=pdbid2-&gt; uName. ulPropid) return S_FALSE;} return S_OK;} static HRESULT IsValidDBID(const DBID *pdbid1) { ATLASSERT(pdbid1);if(pdbid1 &amp;&amp;((pdbid1-&gt;eKind==DBKIND_GUID_NAME)||(pdbid1-&gt;eKind==DBKIND_GUID_PROPID)||(pdbid1-&gt;eKind==DBKIND_NAME)||(pdbid1-&gt;eKind==DBKIND_PGUID_NAME)||(pdbid1-&gt;eKind==DBKIND_PGUID_PROPID)||(pdbid1-&gt;eKind==DBKIND_PROPID)||(pdbid1-&gt;eKind==DBKIND_GUID))) return S_OK;else return S_FALSE;} HRESULT CopyDBIDs(DBID *pdbidDest, const DBID *pdbidSrc) { size_t cwchBuffer;ATLASSERT(pdbidDest||pdbidSrc);if(!pdbidDest||!pdbidSrc) return S_FALSE;pdbidDest-&gt; eKind=pdbidSrc-&gt; eKind;switch(pdbidSrc-&gt; eKind) { case DBKIND_GUID_NAME:pdbidDest-&gt; uGuid.guid=pdbidSrc-&gt; uGuid.guid;cwchBuffer=ocslen(pdbidSrc-&gt; uName. pwszName);cwchBuffer++;pdbidDest-&gt; uName pwszName</div><div class="ttdef"><b>Definition:</b> <a href="atldb__cubrid_8h_source.html#l02051">atldb_cubrid.h:2051</a></div></div>
<div class="ttc" id="cas__cci_8h_html_a82f46f9c5f9169125d15abe0ebcc3812aadd986d6f45d31a4397eafa4fe297516"><div class="ttname"><a href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812aadd986d6f45d31a4397eafa4fe297516">CCI_U_TYPE_SEQUENCE</a></div><div class="ttdef"><b>Definition:</b> <a href="cas__cci_8h_source.html#l00339">cas_cci.h:339</a></div></div>
<div class="ttc" id="structT__CCI__BIT_html"><div class="ttname"><a href="structT__CCI__BIT.html">T_CCI_BIT</a></div><div class="ttdef"><b>Definition:</b> <a href="cas__cci_8h_source.html#l00277">cas_cci.h:277</a></div></div>
<div class="ttc" id="dynamic__load_8c_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="dynamic__load_8c.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="dynamic__load_8c_source.html#l00955">dynamic_load.c:955</a></div></div>
<div class="ttc" id="oledb_2stdafx_8h_html"><div class="ttname"><a href="oledb_2stdafx_8h.html">stdafx.h</a></div></div>
<div class="ttc" id="namespaceType_html_a3f46b78f9ce3d04003861be8ab39eeec"><div class="ttname"><a href="namespaceType.html#a3f46b78f9ce3d04003861be8ab39eeec">Type::GetStaticTypeInfo</a></div><div class="ttdeci">const StaticTypeInfo &amp; GetStaticTypeInfo(T_CCI_U_TYPE nCCIUType)</div><div class="ttdef"><b>Definition:</b> <a href="type_8cpp_source.html#l01032">type.cpp:1032</a></div></div>
<div class="ttc" id="structType_1_1DynamicTypeInfo_html_af98bbce5f7a283d5790ad066b5d89533"><div class="ttname"><a href="structType_1_1DynamicTypeInfo.html#af98bbce5f7a283d5790ad066b5d89533">Type::DynamicTypeInfo::ulDateTimePrecision</a></div><div class="ttdeci">ULONG ulDateTimePrecision</div><div class="ttdef"><b>Definition:</b> <a href="type_8h_source.html#l00138">type.h:138</a></div></div>
<div class="ttc" id="cas__cci_8h_html_a11f9a221823aedf7edc644f3d5984fefab3d70b1e695493b7f502fe2dd2bafbc7"><div class="ttname"><a href="cas__cci_8h.html#a11f9a221823aedf7edc644f3d5984fefab3d70b1e695493b7f502fe2dd2bafbc7">CCI_CURSOR_FIRST</a></div><div class="ttdef"><b>Definition:</b> <a href="cas__cci_8h_source.html#l00654">cas_cci.h:654</a></div></div>
<div class="ttc" id="atldb__cubrid_8h_html_a080c6299f67db3aab5e21e5e45f9e90f"><div class="ttname"><a href="atldb__cubrid_8h.html#a080c6299f67db3aab5e21e5e45f9e90f">colSize</a></div><div class="ttdeci">LPOLESTR DBORDINAL flags colSize</div><div class="ttdef"><b>Definition:</b> <a href="atldb__cubrid_8h_source.html#l19305">atldb_cubrid.h:19305</a></div></div>
<div class="ttc" id="structType_1_1DynamicTypeInfo_html_aba16d07c0930f07ba672062a4548ac6b"><div class="ttname"><a href="structType_1_1DynamicTypeInfo.html#aba16d07c0930f07ba672062a4548ac6b">Type::DynamicTypeInfo::nNumericPrecision</a></div><div class="ttdeci">USHORT nNumericPrecision</div><div class="ttdef"><b>Definition:</b> <a href="type_8h_source.html#l00134">type.h:134</a></div></div>
<div class="ttc" id="cas__cci_8h_html_a82f46f9c5f9169125d15abe0ebcc3812ae68408a06508953230175cfcb233dfcc"><div class="ttname"><a href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812ae68408a06508953230175cfcb233dfcc">CCI_U_TYPE_FLOAT</a></div><div class="ttdef"><b>Definition:</b> <a href="cas__cci_8h_source.html#l00332">cas_cci.h:332</a></div></div>
<div class="ttc" id="cas__cci_8h_html_ad659fcbf8c66e3e426aa55d8577da6f5afa47dcd5fe1782b18141f26f738d44c6"><div class="ttname"><a href="cas__cci_8h.html#ad659fcbf8c66e3e426aa55d8577da6f5afa47dcd5fe1782b18141f26f738d44c6">CCI_A_TYPE_FIRST</a></div><div class="ttdef"><b>Definition:</b> <a href="cas__cci_8h_source.html#l00366">cas_cci.h:366</a></div></div>
<div class="ttc" id="cas__cci_8h_html_a82f46f9c5f9169125d15abe0ebcc3812a816edf276f251f83824d11e32785920b"><div class="ttname"><a href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a816edf276f251f83824d11e32785920b">CCI_U_TYPE_UNKNOWN</a></div><div class="ttdef"><b>Definition:</b> <a href="cas__cci_8h_source.html#l00319">cas_cci.h:319</a></div></div>
<div class="ttc" id="namespaceType_html_afef88962c15aa3949731f76bbe6254c5"><div class="ttname"><a href="namespaceType.html#afef88962c15aa3949731f76bbe6254c5">Type::GetCASTypeA</a></div><div class="ttdeci">T_CCI_A_TYPE GetCASTypeA(DBTYPE wType)</div><div class="ttdef"><b>Definition:</b> <a href="type_8cpp_source.html#l00438">type.cpp:438</a></div></div>
<div class="ttc" id="expat_8h_html_ab89a24535d44e00f35e040a50104facf"><div class="ttname"><a href="expat_8h.html#ab89a24535d44e00f35e040a50104facf">status</a></div><div class="ttdeci">XML_ParsingStatus * status</div><div class="ttdef"><b>Definition:</b> <a href="expat_8h_source.html#l00785">expat.h:785</a></div></div>
<div class="ttc" id="namespacesample__cubrid_html_a831f98428be9c8f5aa247d7e775eff03"><div class="ttname"><a href="namespacesample__cubrid.html#a831f98428be9c8f5aa247d7e775eff03">sample_cubrid.cur</a></div><div class="ttdeci">cur</div><div class="ttdef"><b>Definition:</b> <a href="sample__cubrid_8py_source.html#l00015">sample_cubrid.py:15</a></div></div>
<div class="ttc" id="structType_1_1DynamicTypeInfo_html"><div class="ttname"><a href="structType_1_1DynamicTypeInfo.html">Type::DynamicTypeInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="type_8h_source.html#l00119">type.h:119</a></div></div>
<div class="ttc" id="ColumnsRowset_8h_html_ab775cbed874dced0073d20da63c0b382"><div class="ttname"><a href="ColumnsRowset_8h.html#ab775cbed874dced0073d20da63c0b382">DBTYPE_BOOL</a></div><div class="ttdeci">DBTYPE_BOOL</div><div class="ttdef"><b>Definition:</b> <a href="ColumnsRowset_8h_source.html#l00077">ColumnsRowset.h:77</a></div></div>
<div class="ttc" id="atldb__cubrid_8h_html_a209f0db5070f6edb92e5e3b84741e6b5"><div class="ttname"><a href="atldb__cubrid_8h.html#a209f0db5070f6edb92e5e3b84741e6b5">DBCOLUMNFLAGS_ISFIXEDLENGTH</a></div><div class="ttdeci">DBCOLUMNFLAGS_ISFIXEDLENGTH</div><div class="ttdef"><b>Definition:</b> <a href="atldb__cubrid_8h_source.html#l19344">atldb_cubrid.h:19344</a></div></div>
<div class="ttc" id="atldb__cubrid_8h_html_a9480826662e54d0b6019f4f4d27ada10"><div class="ttname"><a href="atldb__cubrid_8h.html#a9480826662e54d0b6019f4f4d27ada10">DBTYPE_STR</a></div><div class="ttdeci">DBLENGTH DBTYPE_STR</div><div class="ttdef"><b>Definition:</b> <a href="atldb__cubrid_8h_source.html#l19451">atldb_cubrid.h:19451</a></div></div>
<div class="ttc" id="namespaceType_html_adfbf50343169f8b0a937a003d36558a9"><div class="ttname"><a href="namespaceType.html#adfbf50343169f8b0a937a003d36558a9">Type::GetTableInfo</a></div><div class="ttdeci">HRESULT GetTableInfo(int hConn, char *szTableName, CAtlArray&lt; TableInfo &gt; &amp;infos)</div><div class="ttdef"><b>Definition:</b> <a href="type_8cpp_source.html#l01208">type.cpp:1208</a></div></div>
<div class="ttc" id="atldb__cubrid_8h_html_a4637765a8f83fd4fc2df8bf7d8ffd02e"><div class="ttname"><a href="atldb__cubrid_8h.html#a4637765a8f83fd4fc2df8bf7d8ffd02e">DBTYPE_WSTR</a></div><div class="ttdeci">DBLENGTH DBTYPE_WSTR</div><div class="ttdef"><b>Definition:</b> <a href="atldb__cubrid_8h_source.html#l19464">atldb_cubrid.h:19464</a></div></div>
<div class="ttc" id="structProvInfo_1_1__ptypes_html_ad7755f56868a8d44eff186977fec07d5"><div class="ttname"><a href="structProvInfo_1_1__ptypes.html#ad7755f56868a8d44eff186977fec07d5">ProvInfo::_ptypes::nCCIUType</a></div><div class="ttdeci">T_CCI_U_TYPE nCCIUType</div><div class="ttdef"><b>Definition:</b> <a href="ProviderInfo_8h_source.html#l00077">ProviderInfo.h:77</a></div></div>
<div class="ttc" id="atldb__cubrid_8h_html_ad939da76b5d12fca40de18001582d63a"><div class="ttname"><a href="atldb__cubrid_8h.html#ad939da76b5d12fca40de18001582d63a">type</a></div><div class="ttdeci">type</div><div class="ttdef"><b>Definition:</b> <a href="atldb__cubrid_8h_source.html#l19394">atldb_cubrid.h:19394</a></div></div>
<div class="ttc" id="cas__cci_8h_html_a82f46f9c5f9169125d15abe0ebcc3812a932f0c01cf613a5e72bce5911f7ce901"><div class="ttname"><a href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a932f0c01cf613a5e72bce5911f7ce901">CCI_U_TYPE_TIMESTAMP</a></div><div class="ttdef"><b>Definition:</b> <a href="cas__cci_8h_source.html#l00336">cas_cci.h:336</a></div></div>
<div class="ttc" id="cas__cci_8h_html_ad659fcbf8c66e3e426aa55d8577da6f5"><div class="ttname"><a href="cas__cci_8h.html#ad659fcbf8c66e3e426aa55d8577da6f5">T_CCI_A_TYPE</a></div><div class="ttdeci">T_CCI_A_TYPE</div><div class="ttdef"><b>Definition:</b> <a href="cas__cci_8h_source.html#l00364">cas_cci.h:364</a></div></div>
<div class="ttc" id="cas__cci_8c_html_a2d968c1c9ed34b2fda93eecbe301cd22"><div class="ttname"><a href="cas__cci_8c.html#a2d968c1c9ed34b2fda93eecbe301cd22">cci_schema_info</a></div><div class="ttdeci">int cci_schema_info(int mapped_conn_id, T_CCI_SCH_TYPE type, char *arg1, char *arg2, char flag, T_CCI_ERROR *err_buf)</div><div class="ttdef"><b>Definition:</b> <a href="cas__cci_8c_source.html#l02442">cas_cci.c:2442</a></div></div>
<div class="ttc" id="structT__CCI__ERROR_html"><div class="ttname"><a href="structT__CCI__ERROR.html">T_CCI_ERROR</a></div><div class="ttdef"><b>Definition:</b> <a href="cas__cci_8h_source.html#l00271">cas_cci.h:271</a></div></div>
<div class="ttc" id="cas__cci_8h_html_a82f46f9c5f9169125d15abe0ebcc3812a61168c4c6258cdf63773f9e77bf6d197"><div class="ttname"><a href="cas__cci_8h.html#a82f46f9c5f9169125d15abe0ebcc3812a61168c4c6258cdf63773f9e77bf6d197">CCI_U_TYPE_TIME</a></div><div class="ttdef"><b>Definition:</b> <a href="cas__cci_8h_source.html#l00335">cas_cci.h:335</a></div></div>
<div class="ttc" id="dbtype__def_8h_html_aa4cacd43872e590d486e2a06ed1ce007"><div class="ttname"><a href="dbtype__def_8h.html#aa4cacd43872e590d486e2a06ed1ce007">DB_NUMERIC</a></div><div class="ttdeci">struct db_numeric DB_NUMERIC</div><div class="ttdef"><b>Definition:</b> <a href="dbtype__def_8h_source.html#l00813">dbtype_def.h:813</a></div></div>
<div class="ttc" id="type_8h_html"><div class="ttname"><a href="type_8h.html">type.h</a></div></div>
<div class="ttc" id="expat_8h_html_afed088663f8704004425cdae2120b9b3"><div class="ttname"><a href="expat_8h.html#afed088663f8704004425cdae2120b9b3">len</a></div><div class="ttdeci">const char int len</div><div class="ttdef"><b>Definition:</b> <a href="expat_8h_source.html#l00713">expat.h:713</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_2c7dae788c48670d44a2add3356c436e.html">oledb</a></li><li class="navelem"><a class="el" href="type_8cpp.html">type.cpp</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.14 </li>
  </ul>
</div>
</body>
</html>
